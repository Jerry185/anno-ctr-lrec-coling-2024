<?xml version="1.0"?>
<TimeML xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://timeml.org/timeMLdocs/TimeML_1.2.1.xsd">
<DCT><TIMEX3 functionInDocument="CREATION_TIME" temporalFunction="false" tid="t0" type="DATE" value="2020-09-24">2020-09-24</TIMEX3></DCT>
<TEXT>
Joker Playing Hide-and-Seek with Google Play   September 24, 2020       Joker is one of the most prominent malware families that continually targets Android devices.  Despite awareness of this particular malware, it keeps finding its way into Google’s official application market by employing changes in its code, execution methods, or payload-retrieving techniques.  This spyware is designed to steal SMS messages, contact lists, and device information along with silently signing up the victim for premium wireless application protocol (WAP) services.  Our Zscaler ThreatLabZ research team has been constantly monitoring the Joker malware.  Recently, we have seen regular uploads of it onto the Google Play store.  Once notified by us, the Google Android Security team took prompt action to remove the suspicious apps (listed below) from the Google Play store.  This prompted us to evaluate how Joker is so successful at getting around the Google Play vetting process.  We identified 17 different samples regularly uploaded to Google Play in September 2020.  There were a total of around 120,000 downloads for the identified malicious apps.  ![](https://lh3.googleusercontent.com/Omu57LifqnSv_ydMyTVeUJYBC8MTwogGxk76_AxuO4GpZBslG94LhrxDeWYuBpMDXLLGTofZjLAMG7DSIdYMEkbaP41iD7IGEe4YTrw1m8QToueCDXuRga33HWCJ8Y0T6b8k9qL4)![](https://lh3.googleusercontent.com/gy1S2kl4ne6t0rGx48W7b-wRzRObDz78IMR22eX58kVuSLbhBOIGMhXxh4awl-7GqgYSKpoRaOqALeAGVMSA_-xsXneiIEF6k-qZ_d6_27Pad0JvouEH5UBgWYDf7ceM-8zGIJu9)![](https://lh4.googleusercontent.com/DbKDNtgFGHjBJRjEqan9fitlb1VcfD3RA8Qi8Ps0oGhhJw6ECBRkERXtAaLV19A3za6FJlyEcfMqfOFs4CqOa9tjoDwMC4KJCln3iZwB2q8vJrWYW6JffhE1pkamDB_4kgMkr-JU)![](https://lh3.googleusercontent.com/Z4yFowLNn2c8BeaE4L5QhfEyKt8uPVY2qSLEoAy7ug9JijHPOvvymd1PqzO9sZ2N3AaEEGQHrVjJ9wlIgwpd4mak6pbWkKPQ16rfrLF01C9KIvMHutyH8aSQunqipfmU-a2Z8BHF)![](https://lh6.googleusercontent.com/peI3qpVitwHaVQdZgzJu5M3Azwh2SFI71KYqFX75uMANcCvtPgQ-Cjd-Jks9DIZVVFaz8Njl2k0M8U9v7brzp04Rhp-HtxlcUMoknYsZU7CP6dJi_OgMB5M72UNEcCkG3it1prwc)  ![](https://lh6.googleusercontent.com/ycSXfM3Jfhiodji0puoUnIrSqIg5vUqLAD7YlTZ3SxqfGAiz_qaypoX0SjOuK2UtfvQsTVYYw0kW80loSR92I7pHGIE3RSufvt4kusVYxN3D9CtzC67f_okpzzOY-qBIKjESQrZ_)![](https://lh5.googleusercontent.com/uPhmpYACyfkyB6IdARauXJkgvUIrzjjrM_YjT6PVyS_oAFI_6wcZSpiAFwPMnM-0irStIb4_MXvVZCIkNFEVahEIaRn5BqgpETkDnn6HdnOEI1pAzzb_SUhutxXsNLSz2lbHrZ_i)![](https://lh4.googleusercontent.com/C6d7ZMJOFJhglTtAoV-QTFgioZnuLReCWKzTN2Jo2tbOVn_vNVH1bGDxE1UWdj7Z9UpZWK1goKhN5WATKFN4DqheHLz6AahX0FMgCKpwgrhnXiiQDAmPJ0Uy9p8zccUGt32XtQc_)![](https://lh5.googleusercontent.com/N_F99jk3jCwTfvJWaN_l9OV2uw-7pMFjrXOZVJ6Sruq6-AKQcnlO-aOkse98Iar1E3Lp9bCLMpnDIcuf-vUfWFNBBFNJUPJVKk-7hHsTqD6kTQd6IM4S4LRS3f9dFT8qdzv224Gy)![](https://lh6.googleusercontent.com/ogRX3z-sHS8sQ6LBDbLNgZ8y9FrLmPsjdfBaASjN_g_Upd76Av3VMX2TnL5F_YSmoMp3Fobo4nZWegC21Tq8OheqtmnmdcHSEzlVGjtUSfZDIuoABXZMDYvgCGt6sqQwiV0cQKDe)  ![](https://lh3.googleusercontent.com/aCjp2FdxNmLEv6DaJOkD_SHei5LElQUf9Q3Dl_P7kf4xe78hKZT6QwEHQsUBzyoGi_v6st7DS8j8G-wbXt1DZnlNxqoLAd9hg9w_izxmwEZRSSgOvbWu_05D2IIS6Zt2l1V6hDvh)![](https://lh6.googleusercontent.com/TQwtcp5beg3YLKuxkdT1dQZkXS0W97QoApnucVs7FfLpihmYd7X-TIoSMXjZYQiGqyDXPvOVJTdXuaCOvUhMQfA9vUJANsfyaFa27quz7yqQLSvQ9JQpES8bAufr4DmvcDjVLau5)![](https://lh5.googleusercontent.com/V89X6UVx3mNdJ0raFlHOUCsqeBy7pApmkCCY3uJJH9hWore1b70wT338L-8iwIuPq1cr2H5BXywtXZzhPVq_H7Yl4F2mf71BGp8kh--8vS4-RI3nJC3QzZYw-s1CjCBkscywUqOb)![](https://lh5.googleusercontent.com/qH88WBQfPldtm0__s4lhT_Uc5V4Yf81fE1MMbG462Si6YcS41GgQNeOtJj6Qn8UOB8IckXsxutVvsArXhY1j-2PwiWqtEMz3dmAEGuKPgl_ajUb2mXi3KCZZcC-xRTP61LynHklE)![](https://lh3.googleusercontent.com/csivLzdrD-_iyHcBlFQBtj_cZV_-9lkV31z8XCrBjLv_xlQoZwTvCL3NtVIgxzam7VrWDjfZ7PGis1LmBGsl3VpKkK74BEjum7DcO-sATai04xlRZyl7ND6LkDg-1NRFc06xBcgJ)  **The following are the names of the infected apps we discovered on the Google Play store:**  * All Good PDF Scanner  * Mint Leaf Message-Your Private Message  * Unique Keyboard - Fancy Fonts & Free Emoticons  * Tangram App Lock  * Direct Messenger  * Private SMS  * One Sentence Translator - Multifunctional Translator  * Style Photo Collage  * Meticulous Scanner  * Desire Translate  * Talent Photo Editor - Blur focus  * Care Message  * Part Message  * Paper Doc Scanner  * Blue Scanner  * Hummingbird PDF Converter - Photo to PDF  * Powerful Cleaner  (As of this writing, all of these apps have been removed from the Google Play store.  In this blog, we will discuss the tactics used by the Joker malware author to bypass the Google Play vetting process.  **Scenario 1: Direct download**  -------------------------------  In some of the Joker variants, we saw the final payload delivered via a direct URL received from the command and control (C&C) server.  In this variant, the infected Google Play store app has the C&C address hidden in the code itself with string obfuscation.  We observed the string “sticker” was used to break the C&C address to hide it from the simple grep or string search, as shown in Figure 1.  ![](https://lh3.googleusercontent.com/ajSH7eQN1DEcSxBlif0dKdo4raKhNikZVSVpiRyRW0d_Ic3GiFUzrPYS7GPX-U9U1gh2HMWnrBroaNMmb7R2PVXy0kNJgNAzagMJzDjQIdSeQ-Qn1B1DboV7lJ1LpPrzxNNJG1GF)  *Figure 1: The C&C address string obfuscation.*  Once installed, the infected app contacts the C&C server, which then responds with the URL of a final payload.  This JSON file also has the information related to the class name that needs to be executed from the final payload to do all the malicious activities.  ![](https://lh4.googleusercontent.com/-TojUAinL1n0oFQTnL5WQUQaf-IhcyB5Cc4iKPcidy5BUOsRXRCQePNEESJ4sohW5i1GHXgZ0kQZV8a8UZxm9Xv41MHlR62VIZ15LYzP_3bubz0G2A5gK0LkW6M1-DJZI_MHapds)  *Figure 2: The C&C JSON response.*  Upon receiving the JSON configuration from the C&C, the infected app downloads the payload from the received location and executes it.  ![](https://lh5.googleusercontent.com/Du7CvZw02t8jk1wZO4eWC9-ClPq9BExFC6D8ke4zTL8NFOha-BX8KADVTZYgY5PKld4kBhvj7mE9rDkxvC4IzYdJ1giQUxNpYRiGyJsAA3-eobMrm0H6m1DehYccEz--kRkG6BCq)  *Figure 3: The final payload download.*  **Scenario 2: One-stage download**  ----------------------------------  In some apps, we observed that for retrieving the final payload, the infected Google Play app uses a stager payload.  Here the infected Google Play store app has the stager payload URL encoded in the code itself encrypted using Advanced Encryption Standard (AES).  Upon infection, unlike scenario 1, it downloads the stager payload rather than a final payload, as seen in Figure 4 and Figure 5.  We also saw two varieties of the stager payload—an Android Package (APK) or a Dalvik executable file.  ![](https://lh4.googleusercontent.com/ZModASnHZp8fQD-bvdj0vcrETAlI54ef09sis3mkpE3fM8_xW32nT47VLKWoOWywWlsbEM_9Age-nrxWZmFRnZhWeuPXK28HCxE-fzxQyD0-zJzpAtBMY7eKYWZI3Csuz29Jfa0y)  *Figure 4: The Dalvik executable stager payload download.*  ![](https://lh5.googleusercontent.com/SugClxlO6bfTcQB_y0NAKxcItcxpZkBoU-iF1wJCvjIveCv3DgQ3y_vAPKYtsFcu95-ROqF6mKLYZxHhkc9RxBrZiGdVJh9kpEMSIxemSdCzlEsGRzbRz9AdFRSvCtqdZfwvnnKd)  *Figure 5: The APK stager payload download.*  The job of this stager payload is to simply retrieve the final payload URL from the code and download it.  Along with the payload download, it is responsible for executing the final payload as well.  In the stager payload, we also saw some different tactics used by the malware author to hide the final payload URL.   We saw instances where the final payload is obfuscated with AES and, in some cases, we saw simple shift operation was used to obfuscate the final payload URL.  In some cases, the final payload URL was also in plain text.  ![](https://lh5.googleusercontent.com/q8gzm6sPggGeKWtbRV6_T3fAQ6lr8qkLMGnlU-k71YhBJB_nNqm5dwTQjCPPhVp5DT87DtuFgioyPYBbHXnTuEq29lw2ESY0SYIj1euxT-SlYanPHrg4c9XyFSJRL5s4PXhL9RMT)  *Figure 6: AES encryption for the end payload URL.*  ![](https://lh3.googleusercontent.com/qLM6-vYQGwSl25B5o6UyOqZn19-UFmJbNx8iO3FycTfilwJELSVwJxWbgcQuFxzwEj_m2lOJJ89HrY4jLIfsbG6dhLMYDc4tHC370COr9DHsYO8MJPODVfX-j-htiV7bgYn1JWvT)  *Figure 7: The plain text end payload URL.*  ![](https://lh6.googleusercontent.com/L83ygFgYJ47JaYe9Com3GjQnzRjQ5TpgL3qeJcCsjXz5LljACXmVH-MI4NB02M2epFy7oNNsK6wzwhXnH-RjDJM7637xS9yKrPQYNDTx2h-IPNIK_TgnT7Qv_0H0GCjP5gls1eV4)  *Figure 8: The plain text end payload URL.*  ![](https://lh4.googleusercontent.com/d7sRI5o6tUb3SwmoNia5GFhx0_KcbzK3vp7HetvhsQnJTPfORs3FP6ympYTPQvF44RgfgV8lKgLohA7csMHPAjuQCOCa4aCrojfQoYj8tncMcoQ49sitmWHg2bbZuIsNdafM1Mzy)![](https://lh5.googleusercontent.com/VXD8KkjkEexdeNo4Q2YWFIXJcdOH5c7zjt1fZ9KHdXK3sSA_QlDlHOlU1HHKEvM8rwEAJ4zdbRmskxEIMNa9rvubnMuWcKBMigckKhC9CnJj9Popgmoh6KLImCDIfi-fFAeIQFdy)  *Figure 9: The obfuscated end payload URL with Shift encoding*  Upon execution, it downloads the final stage payload, which is the core Joker malware doing all the infection activities ranging from premium SMS subscription scam to spyware activities, as seen in Figure 10.  ![](https://lh5.googleusercontent.com/6JdDBQk-elIsH6l6iIjiP3ciqS3UeOFY_OGY8vZhZPT-dme2IuO1eHHm7V30A_ehSh4abti6ND0yScBVj_isY_ZwpnYU4JbSiogHwduwuYSGLhTRgwekhh64QEmnmE6Q6Y9yA5Au)  ![](https://lh4.googleusercontent.com/jocl3w_n4Giy5PJQsOiyJm8MT-QS9o6VM0l1HfqpDMQoxedpVRkifO-OQZjYIqgc3zTkYWbhCYigzNZgh314sQjHQCr9qPOnWKHs4-k8JhCT9WCzUqUQrcszy_QIuiVx9m0zrZLC)  *Figure 10: The end payload download.*  **Scenario 3 : Two-stage download**  -----------------------------------  In some groups of infected Google Play store apps, we saw two-stager payload downloads used to retrieve the final payload.  Here, the Google Play infected app downloads the stage one payload, which downloads the stage two payload, which finally loads the end Joker payload.  Interestingly, unlike previous two scenarios, the infected app contacts the C&C server for the stage one payload URL, which hides it in response location header.  ![](https://lh6.googleusercontent.com/jijMYDsHQ9Mv0OdEcwy889_wnaZeD8uxr5Qek7pvblVy9Qj60c2Ype1uiR7m2mZV6hJGG6v0ODo3atecD-arFlkfhYw9bq2FcMRNILRWSsw_JxuRF7Tb4Ek0RGpa0Xkzr5ab_HAX)  *Figure 11: The C&C response for the stage one payload URL.*  Upon infecting the device, the infected app downloads the stage one payload from the received URL from the C&C in the response header.  Like scenario two, the job of this payload is to simply download another payload but this time it won't be the final payload.  Observe the below screenshot for the same activity.  ![](https://lh4.googleusercontent.com/q-pc2m1bmSeFfyjb9SIv0wuz7uCUA5fk3--JVbMXL_CBvWsej55SbrKPed38GV0Nzri8T9G-8rv9ZY0Kc-3ZMNmoyvBu4D0Hg_4LdIWO-9cdtL0x-1juJEl0w-Zh7AaDHredjEXh)  *Figure 12: The stage two URL in stage one code.*  Upon execution of the stage one payload, it downloads the stage two payload.  The stage two payload exhibits the same behavior as the stage one payload.  It includes the hard-coded URL, which retrieves the final payload as shown in Figure 13.  ![](https://lh3.googleusercontent.com/bExa6sBh_vhNi3jqWGJVOIwT-0w-NhL10KBHKmfGMVA6pVLfVUeV1WRTIjj4dI4AHKUBlrmCgJFf8UKRZpRPnKj7I2ZrkgnuRvdXagb7Ryi_9tJdq6jzzah7TMki4QVXHXh0XAU8)  Figure 13: The final payload URL in the stage two code.  **Final payload details**  -------------------------  Although these variations were used by Joker to reach the end payload, we saw the same end payload downloaded in all the cases.  Here are some highlights of the final payload activities.  The final payload employs DES encryption to execute the C&C activities.  ![](https://lh3.googleusercontent.com/HzTDPQkonqTn2HwspE0eRQGR_qbOTeIWQWkVOkUyrfvX8UtXVai_XdG5UcEM1P2sJNz2DP0McFdwvHOb0quYqhcDwQr7Ii93rJPFmeQKvULlWcrWnOq2dStK1r54rbx6bYHqLv_y)  *Figure 14: The DES encryption for the C&C post request.*  Figure 15 shows the network patterns used by Joker to execute the C&C activities.  ![](https://lh3.googleusercontent.com/sncdZrPyScupUKV8HyQnvB9Gxotr5hn5izcIS-jK5WzRfLiT25raBYy0q5IAAgAAgoIRs2Q4NYUkxw7E1RwsaG8uijC0q5xcSCNlpO20IkDe7dWk8BW6rmj8e87lKhShzveENZ4h)  *Figure 15: The C&C pattern for the post request.*  The end payload also employs string obfuscation to hide all the important strings.  It uses string “nus106ba” to break all the important strings to hide it from simple string search.  ![](https://lh3.googleusercontent.com/YaGXhi6eHYeNmNppLEVwffYqX2Fjmttzw5hXuHlVaZ4aNcbuVP0NN11ORXWGn22ngpfpupBfKuGpml6QmBmyfdz5rFCDcJDR7TJJ1LB2CNq7ZMlPFMAByBCmrcz30e1KIniEk0tF)  *Figure 16: The string obfuscation.*  Figure 17 shows the SMS harvesting and WAP fraud done by Joker.  ![](https://lh4.googleusercontent.com/S2e7eOYjZj7vdHWX0B7s1Y5fcqy5CLflDUZJPgcalejFlVzW5PJtSEhtCNUmmafuWijTo98yTt8Q2MWvoPS9mWHJ47YU0Oc8urQdYnfzEHP19z56H1OlLXPGf39LSQ-aOK2o95Qp)  ![](https://lh5.googleusercontent.com/eMXsJl0CtMisCHemo8C50S1YDR7y68o_ZTzdPeLSGfyKEEcPXcXMYwHlMy2aeIY2DDStANSIKjQGpfmMynYjnX8MY6ZLAIoy4rd1R546LT6_S1u1m-JIMOW2A6p0oLs1Zqp2NP3s)![](https://lh3.googleusercontent.com/CdkRXreUiZJjj2LLoP8GoB52ZPtKaJjsAyHTEHOBB2QrH086FyG6zBEQJY-6sCty_eUW1Ar63SBqLYdivkSU4aTncxl5p-hMoDZuo3ceidTwcokFZ2SRUWMlRi6UdYm9ot4D16Iw)  *Figure 17: The WAP fraud.*  This [post](https://www.anquanke.com/post/id/211978) provides in-depth details related to end payload activities done by Joker.  **Recommandation**  ------------------  We recommend paying close attention to the permission list in the apps that you install on your Android device.  Always watch out for the risky permissions related to SMS, call logs, contacts, and more.  Reading the comment or reviews on the app page aslo helps identify compromised apps.  **IOCs**  --------  ### **Infected Apps on GooglePlay:**  | **MD5s** | **Package Name** |  | 2086f0d40e611c25357e8906ebb10cd1 | com.carefrendly.message.chat |  | b8dea8e30c9f8dc5d81a5c205ef6547b | com.docscannercamscanpaper |  | 5a5756e394d751fae29fada67d498db3 | com.focusphoto.talent.editor |  | 8dca20f649f4326fb4449e99f7823a85 | com.language.translate.desire.voicetranlate |  | 6c34f9d6264e4c3ec2ef846d0badc9bd | com.nightsapp.translate.sentence |  | 04b22ab4921d01199c9a578d723dc6d6 | com.password.quickly.applock |  | b488c44a30878b10f78d674fc98714b0 | com.styles.simple.photocollage.photos |  | a6c412c2e266039f2d4a8096b7013f77 | com.unique.input.style.my.keyboard |  | 4c5461634ee23a4ca4884fc9f9ddb348 | dirsms.welcome.android.dir.messenger |  | e4065f0f5e3a1be6a56140ed6ef73df7 | pdf.converter.image.scanner.files |  | bfd2708725bd22ca748140961b5bfa2a | message.standardsms.partmessenger |  | 164322de2c46d4244341e250a3d44165 | mintleaf.message.messenger.tosms.ml |  | 88ed9afb4e532601729aab511c474e9a | omg.documents.blue.pdfscanner |  | 27e01dd651cf6d3362e28b7628fe65a4 | pdf.maker.scan.image.phone.scanner |  | e7b8f388051a0172846d3b3f7a3abd64 | prisms.texting.messenger.coolsms |  | 0ab0eca13d1c17e045a649be27927864 | com.gooders.pdfscanner.gp |  | bfbe04fd0dd4fa593bc3df65a831c1be | com.powerful.phone.android.cleaner |  ### **URLs of payload distribution**  blackdragon[.]oss-ap-southeast-5[.]aliyuncs[.]com/privateSMS\_ba[.]htm  blackdragon03[.]oss-ap-southeast-5[.]aliyuncs[.]com/partMessage\_base[.]css  blackdragon03[.]oss-ap-southeast-5[.]aliyuncs[.]com/partMessage\_config[.]json  nineth03[.]oss-ap-southeast-5[.]aliyuncs[.]com/MeticulousScanner\_bs[.]mp3  sahar[.]oss-us-east-1[.]aliyuncs[.]com/care[.]asf  sahar[.]oss-us-east-1[.]aliyuncs[.]com/onesentence[.]asf  sahar[.]oss-us-east-1[.]aliyuncs[.]com/onesentence2[.]asf  sahar[.]oss-us-east-1[.]aliyuncs[.]com/saiks[.]asf  sahar[.]oss-us-east-1[.]aliyuncs[.]com/tangram[.]asf  sahar[.]oss-us-east-1[.]aliyuncs[.]com/tangram2[.]asf  sahar[.]oss-us-east-1[.]aliyuncs[.]com/twinkle[.]asf  2j1i9uqw[.]oss-eu-central-1[.]aliyuncs[.]com/328718737/armeabi-v7a/ihuq[.]sky  blackdragon[.]oss-ap-southeast-5[.]aliyuncs[.]com/blackdragon[.]html  blackdragon[.]oss-ap-southeast-5[.]aliyuncs[.]com/privateSMS[.]json  fgcxweasqw[.]oss-eu-central-1[.]aliyuncs[.]com/fdcxqewsswq/dir[.]png  jk8681oy[.]oss-eu-central-1[.]aliyuncs[.]com/fsaxaweqwa/amly[.]art  n47n[.]oss-ap-southeast-5[.]aliyuncs[.]com/H20PDF29[.]txt  n47n[.]oss-ap-southeast-5[.]aliyuncs[.]com/font106[.]ttf  nineth03[.]oss-ap-southeast-5[.]aliyuncs[.]com/blackdragon[.]html  proxy48[.]oss-eu-central-1[.]aliyuncs[.]com/m94[.]dir  proxy48[.]oss-eu-central-1[.]aliyuncs[.]com/response[.]js  laodaoo[.]oss-ap-southeast-5.aliyuncs[.]com/allgood2[.]webp  laodaoo[.]oss-ap-southeast-5[.]aliyuncs[.]com/flower[.]webp  rinimae[.]oss-ap-southeast-5[.]aliyuncs.com/powerful[.]mov  rinimae[.]oss-ap-southeast-5[.]aliyuncs.com/powerful2[.]mov  rinimae[.]oss-ap-southeast-5[.]aliyuncs.com//intro[.]mov  ### **Final C&C:**  161[.]117[.]229[.]58  161[.]117[.]83[.]26  47[.]74[.]179[.]177  **References:**  ---------------  **https://twitter.com/ReBensk**  **https://www.anquanke.com/post/id/211978**  
</TEXT>
</TimeML>