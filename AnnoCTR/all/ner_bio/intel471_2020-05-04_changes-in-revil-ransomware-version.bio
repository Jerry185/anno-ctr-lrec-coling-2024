<DOCSTART>	O	O	O	O	O	O

Changes	O	O	O	O	O	O
in	O	O	O	O	O	O
REvil	O	O	O	B-MALWARE	O	B-MALWARE
ransomware	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
version	O	O	O	O	O	O
2.2	O	O	O	O	O	O

May	O	O	B-DATE	O	O	B-DATE
04	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2020	O	O	I-DATE	O	O	I-DATE

By	O	O	O	O	O	O
the	O	O	O	O	O	O
Intel	B-ORG	O	O	O	O	B-ORG
471	I-ORG	O	O	O	O	I-ORG
Malware	O	O	O	B-CON	O	B-CON
Intelligence	O	O	O	O	O	O
team	O	O	O	O	O	O
.	O	O	O	O	O	O

#	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
Summary	O	O	O	O	O	O

The	O	O	O	O	O	O
REvil	O	O	O	B-MALWARE	O	B-MALWARE
ransomware-as-a-service	O	O	O	O	B-TECHNIQUE	O
(	O	O	O	O	O	O
RaaS	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
)	O	O	O	O	O	O
operation	O	O	O	O	O	O
continues	O	O	O	O	O	O
to	O	O	O	O	O	O
impact	O	O	O	O	O	O
businesses	O	O	O	O	O	O
worldwide	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
threat	O	O	O	O	O	O
actors	O	O	O	O	O	O
responsible	O	O	O	O	O	O
for	O	O	O	O	O	O
developing	O	O	O	O	O	O
and	O	O	O	O	O	O
maintaining	O	O	O	O	O	O
the	O	O	O	O	O	O
malware	O	O	O	O	O	O
have	O	O	O	O	O	O
released	O	O	O	O	O	O
an	O	O	O	O	O	O
updated	O	O	O	O	O	O
ransomware	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
,	O	O	O	O	O	O
namely	O	O	O	O	O	O
version	O	O	O	O	O	O
2.2	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
this	O	O	O	O	O	O
short	O	O	O	O	O	O
blog	O	O	O	O	O	O
post	O	O	O	O	O	O
,	O	O	O	O	O	O
we	O	O	O	O	O	O
will	O	O	O	O	O	O
cover	O	O	O	O	O	O
the	O	O	O	O	O	O
significant	O	O	O	O	O	O
changes	O	O	O	O	O	O
from	O	O	O	O	O	O
the	O	O	O	O	O	O
previous	O	O	O	O	O	O
version	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
we	O	O	O	O	O	O
covered	O	O	O	O	O	O
in	O	O	O	O	O	O
detail	O	O	O	O	O	O
in	O	O	O	O	O	O
an	O	O	O	O	O	O
earlier	O	O	O	O	O	O
blog	O	O	O	O	O	O
post	O	O	O	O	O	O
(	O	O	O	O	O	O
see	O	O	O	O	O	O
:	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
blog.intel471	O	O	O	O	O	O
.	O	O	O	O	O	O
com	O	O	O	O	O	O
/	O	O	O	O	O	O
2020	O	O	O	O	O	O
/	O	O	O	O	O	O
03	O	O	O	O	O	O
/	O	O	O	O	O	O
31	O	O	O	O	O	O
/	O	O	O	O	O	O
revil-ransomware-as-a-service-an-analysis-of-a-ransomware-affiliate-operation	O	O	O	O	O	O
/	O	O	O	O	O	O
)	O	O	O	O	O	O
.	O	O	O	O	O	O

#	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
Persistence	O	O	O	B-TACTIC	O	B-TACTIC
mechanism	O	O	O	O	O	O

REvil	O	O	O	B-MALWARE	O	B-MALWARE
ransomware	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
persists	O	O	O	O	O	O
on	O	O	O	O	O	O
a	O	O	O	O	O	O
machine	O	O	O	O	O	O
if	O	O	O	O	O	O
the	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
arn	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
configuration	O	O	O	O	O	O
field	O	O	O	O	O	O
is	O	O	O	O	O	O
set	O	O	O	O	O	O
to	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
true	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
.	O	O	O	O	O	O

It	O	O	O	O	O	O
writes	O	O	O	O	B-TECHNIQUE	O
its	O	O	O	O	I-TECHNIQUE	O
path	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
registry	O	O	O	O	I-TECHNIQUE	O
key	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
SOFTWARE	O	O	O	O	I-TECHNIQUE	O
\	O	O	O	O	I-TECHNIQUE	O
Microsoft	O	O	O	O	I-TECHNIQUE	O
\	O	O	O	O	I-TECHNIQUE	O
Windows	O	O	O	O	I-TECHNIQUE	O
\	O	O	O	O	I-TECHNIQUE	O
CurrentVersion	O	O	O	O	I-TECHNIQUE	O
\	O	O	O	O	I-TECHNIQUE	O
Run	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
.	O	O	O	O	I-TECHNIQUE	O

An	O	O	O	O	B-TECHNIQUE	O
example	O	O	O	O	I-TECHNIQUE	O
of	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
value	O	O	O	O	I-TECHNIQUE	O
name	O	O	O	O	I-TECHNIQUE	O
of	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
registry	O	O	O	O	I-TECHNIQUE	O
key	O	O	O	O	I-TECHNIQUE	O
entry	O	O	O	O	I-TECHNIQUE	O
is	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
mjOObKp0yy	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
d39ec1uo9ktrut.cloudfront.net	O	O	O	O	O	O
/	O	O	O	O	O	O
revil.png	O	O	O	O	O	O
)	O	O	O	O	O	O

In	O	O	O	O	O	O
version	O	O	O	O	O	O
2.1	O	O	O	O	O	O
,	O	O	O	O	O	O
first	O	O	O	O	O	O
collected	O	O	O	O	O	O
by	O	O	O	O	O	O
our	O	O	O	O	O	O
systems	O	O	O	O	O	O
March	O	O	B-DATE	O	O	B-DATE
15	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2020	O	O	I-DATE	O	O	I-DATE
,	O	O	O	O	O	O
this	O	O	O	O	O	O
persistence	O	O	O	B-TACTIC	O	B-TACTIC
mechanism	O	O	O	I-TACTIC	O	I-TACTIC
was	O	O	O	O	O	O
removed	O	O	O	O	O	O
.	O	O	O	O	O	O

It	O	O	O	O	O	O
seems	O	O	O	O	O	O
this	O	O	O	O	O	O
little	O	O	O	O	O	O
experiment	O	O	O	O	O	O
didn	O	O	O	O	O	O
’	O	O	O	O	O	O
t	O	O	O	O	O	O
go	O	O	O	O	O	O
as	O	O	O	O	O	O
planned	O	O	O	O	O	O
,	O	O	O	O	O	O
because	O	O	O	O	O	O
the	O	O	O	O	O	O
new	O	O	O	O	O	O
version	O	O	O	O	O	O
2.2	O	O	O	O	O	O
brings	O	O	O	O	O	O
the	O	O	O	O	O	O
same	O	O	O	O	O	O
persistence	O	O	O	B-TACTIC	O	B-TACTIC
mechanism	O	O	O	I-TACTIC	O	I-TACTIC
back	O	O	O	O	O	O
.	O	O	O	O	O	O

#	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
Restart	O	O	O	O	B-TECHNIQUE	O
Manager	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
terminate	O	O	O	O	I-TECHNIQUE	O
processes	O	O	O	O	I-TECHNIQUE	O

One	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
more	O	O	O	O	O	O
interesting	O	O	O	O	O	O
new	O	O	O	O	O	O
features	O	O	O	O	O	O
of	O	O	O	O	O	O
REvil	O	O	O	B-MALWARE	O	B-MALWARE
version	O	O	O	O	O	O
2.2	O	O	O	O	O	O
is	O	O	O	O	O	O
the	O	O	O	O	O	O
use	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
Windows	O	O	O	O	B-TECHNIQUE	O
Restart	O	O	O	O	I-TECHNIQUE	O
Manager	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
terminate	O	O	O	O	I-TECHNIQUE	O
processes	O	O	O	O	I-TECHNIQUE	O
and	O	O	O	O	I-TECHNIQUE	O
services	O	O	O	O	I-TECHNIQUE	O
that	O	O	O	O	I-TECHNIQUE	O
can	O	O	O	O	I-TECHNIQUE	O
lock	O	O	O	O	I-TECHNIQUE	O
files	O	O	O	O	I-TECHNIQUE	O
targeted	O	O	O	O	I-TECHNIQUE	O
for	O	O	O	O	I-TECHNIQUE	O
encryption	O	O	O	O	I-TECHNIQUE	O
.	O	O	O	O	I-TECHNIQUE	O

If	O	O	O	O	O	O
a	O	O	O	O	O	O
process	O	O	O	O	O	O
has	O	O	O	O	O	O
an	O	O	O	O	O	O
open	O	O	O	O	O	O
file	O	O	O	O	O	O
handle	O	O	O	O	O	O
for	O	O	O	O	O	O
a	O	O	O	O	O	O
specific	O	O	O	O	O	O
file	O	O	O	O	O	O
,	O	O	O	O	O	O
then	O	O	O	O	O	O
writes	O	O	O	O	O	O
to	O	O	O	O	O	O
that	O	O	O	O	O	O
file	O	O	O	O	O	O
by	O	O	O	O	O	O
another	O	O	O	O	O	O
process	O	O	O	O	O	O
(	O	O	O	O	O	O
in	O	O	O	O	O	O
this	O	O	O	O	O	O
case	O	O	O	O	O	O
,	O	O	O	O	O	O
a	O	O	O	O	O	O
ransomware	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
)	O	O	O	O	O	O
it	O	O	O	O	O	O
will	O	O	O	O	O	O
be	O	O	O	O	O	O
prevented	O	O	O	O	O	O
by	O	O	O	O	O	O
the	O	O	O	O	O	O
Windows	O	O	O	O	O	O
operating	O	O	O	O	O	O
system	O	O	O	O	O	O
(	O	O	O	O	O	O
OS	O	O	O	O	O	O
)	O	O	O	O	O	O
.	O	O	O	O	O	O

To	O	O	O	O	B-TECHNIQUE	O
circumvent	O	O	O	O	I-TECHNIQUE	O
this	O	O	O	O	I-TECHNIQUE	O
,	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
REvil	O	O	O	B-MALWARE	I-TECHNIQUE	B-MALWARE
developers	O	O	O	O	I-TECHNIQUE	O
have	O	O	O	O	I-TECHNIQUE	O
implemented	O	O	O	O	I-TECHNIQUE	O
a	O	O	O	O	I-TECHNIQUE	O
technique	O	O	O	O	I-TECHNIQUE	O
using	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
Windows	O	O	O	O	I-TECHNIQUE	O
Restart	O	O	O	O	I-TECHNIQUE	O
Manager	O	O	O	O	I-TECHNIQUE	O
also	O	O	O	O	O	O
used	O	O	O	O	O	O
by	O	O	O	O	O	O
other	O	O	O	O	O	O
ransomware	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
such	O	O	O	O	O	O
as	O	O	O	O	O	O
SamSam	O	O	O	B-MALWARE	O	B-MALWARE
and	O	O	O	O	O	O
LockerGoga	O	O	O	B-MALWARE	O	B-MALWARE
(	O	O	O	O	O	O
see	O	O	O	O	O	O
:	O	O	O	O	O	O
)	O	O	O	O	O	O
.	O	O	O	O	O	O

REvil	O	O	O	B-MALWARE	O	B-MALWARE
ransomware	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
opens	O	O	O	O	O	O
files	O	O	O	O	O	O
for	O	O	O	O	O	O
encryption	O	O	O	O	O	O
with	O	O	O	O	O	O
no	O	O	O	O	O	O
sharing	O	O	O	O	O	O
(	O	O	O	O	O	O
dwShareMode	O	O	O	O	O	O
equals	O	O	O	O	O	O
0	O	O	O	O	O	O
)	O	O	O	O	O	O
.	O	O	O	O	O	O

As	O	O	O	O	O	O
a	O	O	O	O	O	O
result	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
Restart	O	O	O	O	O	O
Manager	O	O	O	O	O	O
is	O	O	O	O	O	O
invoked	O	O	O	O	O	O
whenever	O	O	O	O	O	O
a	O	O	O	O	O	O
sharing	O	O	O	O	O	O
violation	O	O	O	O	O	O
occurs	O	O	O	O	O	O
when	O	O	O	O	O	O
opening	O	O	O	O	O	O
an	O	O	O	O	O	O
already	O	O	O	O	O	O
opened	O	O	O	O	O	O
file	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
d39ec1uo9ktrut.cloudfront.net	O	O	O	O	O	O
/	O	O	O	O	O	O
pasted-image	O	O	O	O	O	O
-	O	O	O	O	O	O
0	O	O	O	O	O	O
-	O	O	O	O	O	O
6	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O

The	O	O	O	O	O	O
function	O	O	O	O	O	O
prototype	O	O	O	O	O	O
for	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
rvl	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
restart	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
manager	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
is	O	O	O	O	O	O
:	O	O	O	O	O	O

`	O	O	O	O	O	O
`	O	O	O	O	O	O
`	O	O	O	O	O	O

VOID	O	B-CLICommand/CodeSnippet	O	O	O	B-CLICommand/CodeSnippet
rvl	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
\	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
\	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
_	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
restart	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
\	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
\	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
_	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
manager	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
(	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
LPCWSTR	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
Filename	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
,	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
BOOL	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
DoEndSession	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
)	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet

`	O	O	O	O	O	O
`	O	O	O	O	O	O
`	O	O	O	O	O	O

The	O	O	O	O	O	O
following	O	O	O	O	O	O
explains	O	O	O	O	O	O
how	O	O	O	O	O	O
REvil	O	O	O	B-MALWARE	O	B-MALWARE
employs	O	O	O	O	O	O
this	O	O	O	O	O	O
technique	O	O	O	O	O	O
:	O	O	O	O	O	O

*	O	O	O	O	O	O
Call	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
OpenSCManagerW	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
to	O	O	O	O	O	O
open	O	O	O	O	O	O
the	O	O	O	O	O	O
“	O	O	O	O	O	O
ServicesActive	O	O	O	O	O	O
”	O	O	O	O	O	O
database	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
Start	O	O	O	O	O	O
a	O	O	O	O	O	O
new	O	O	O	O	O	O
Restart	O	O	O	O	O	O
Manager	O	O	O	O	O	O
session	O	O	O	O	O	O
by	O	O	O	O	O	O
calling	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
RmStartSession	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
and	O	O	O	O	O	O
save	O	O	O	O	O	O
the	O	O	O	O	O	O
returned	O	O	O	O	O	O
handle	O	O	O	O	O	O
in	O	O	O	O	O	O
a	O	O	O	O	O	O
global	O	O	O	O	O	O
variable	O	O	O	O	O	O
for	O	O	O	O	O	O
future	O	O	O	O	O	O
calls	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
Invoke	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
RmRegisterResources	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
target	O	O	O	O	O	O
file	O	O	O	O	O	O
name	O	O	O	O	O	O
to	O	O	O	O	O	O
register	O	O	O	O	O	O
it	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
Restart	O	O	O	O	O	O
Manager	O	O	O	O	O	O
session	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
Retrieve	O	O	O	O	O	O
the	O	O	O	O	O	O
list	O	O	O	O	O	O
of	O	O	O	O	O	O
all	O	O	O	O	O	O
applications	O	O	O	O	O	O
currently	O	O	O	O	O	O
using	O	O	O	O	O	O
the	O	O	O	O	O	O
file	O	O	O	O	O	O
by	O	O	O	O	O	O
calling	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
RmGetList	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
.	O	O	O	O	O	O

This	O	O	O	O	O	O
application	O	O	O	O	O	O
programming	O	O	O	O	O	O
interface	O	O	O	O	O	O
(	O	O	O	O	O	O
API	O	O	O	O	O	O
)	O	O	O	O	O	O
returns	O	O	O	O	O	O
an	O	O	O	O	O	O
array	O	O	O	O	O	O
of	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
RM	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
PROCESS	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
INFO	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
structures	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
If	O	O	O	O	B-TECHNIQUE	O
a	O	O	O	O	I-TECHNIQUE	O
normal	O	O	O	O	I-TECHNIQUE	O
process	O	O	O	O	I-TECHNIQUE	O
is	O	O	O	O	I-TECHNIQUE	O
using	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
file	O	O	O	O	I-TECHNIQUE	O
,	O	O	O	O	I-TECHNIQUE	O
it	O	O	O	O	I-TECHNIQUE	O
is	O	O	O	O	I-TECHNIQUE	O
terminated	O	O	O	O	I-TECHNIQUE	O
by	O	O	O	O	I-TECHNIQUE	O
a	O	O	O	O	I-TECHNIQUE	O
call	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
TerminateProcess	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
If	O	O	O	O	O	O
a	O	O	O	O	O	O
service	O	O	O	O	O	O
is	O	O	O	O	O	O
encountered	O	O	O	O	O	O
,	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
ControlService	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
is	O	O	O	O	O	O
invoked	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
SERVICE	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
CONTROL	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
STOP	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
control	O	O	O	O	B-TECHNIQUE	O
code	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
stop	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
service	O	O	O	O	I-TECHNIQUE	O
followed	O	O	O	O	I-TECHNIQUE	O
by	O	O	O	O	I-TECHNIQUE	O
a	O	O	O	O	I-TECHNIQUE	O
call	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
DeleteService	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
If	O	O	O	O	B-TECHNIQUE	O
a	O	O	O	O	I-TECHNIQUE	O
critical	O	O	O	O	I-TECHNIQUE	O
process	O	O	O	O	I-TECHNIQUE	O
is	O	O	O	O	I-TECHNIQUE	O
encountered	O	O	O	O	I-TECHNIQUE	O
,	O	O	O	O	I-TECHNIQUE	O
its	O	O	O	O	I-TECHNIQUE	O
critical	O	O	O	O	I-TECHNIQUE	O
status	O	O	O	O	I-TECHNIQUE	O
is	O	O	O	O	I-TECHNIQUE	O
removed	O	O	O	O	I-TECHNIQUE	O
by	O	O	O	O	I-TECHNIQUE	O
calling	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
ZwSetInformationProcess	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
with	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
information	O	O	O	O	I-TECHNIQUE	O
class	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
ProcessBreakOnTermination	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	I-TECHNIQUE	O
before	O	O	O	O	I-TECHNIQUE	O
terminating	O	O	O	O	I-TECHNIQUE	O
it	O	O	O	O	I-TECHNIQUE	O
.	O	O	O	O	O	O

This	O	O	O	O	O	O
may	O	O	O	O	O	O
lead	O	O	O	O	O	O
to	O	O	O	O	O	O
undefined	O	O	O	O	O	O
behavior	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
system	O	O	O	O	O	O
.	O	O	O	O	O	O

#	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
New	O	O	O	O	O	O
‘	O	O	O	O	O	O
-	O	O	O	O	O	O
silent	O	O	O	O	O	O
’	O	O	O	O	O	O
flag	O	O	O	O	O	O

A	O	O	O	O	O	O
new	O	O	O	O	O	O
command-line	O	O	O	O	O	O
option	O	O	O	O	O	O
-	O	O	O	O	B-TECHNIQUE	O
silent	O	O	O	O	I-TECHNIQUE	O
was	O	O	O	O	I-TECHNIQUE	O
added	O	O	O	O	I-TECHNIQUE	O
that	O	O	O	O	I-TECHNIQUE	O
skips	O	O	O	O	I-TECHNIQUE	O
termination	O	O	O	O	I-TECHNIQUE	O
of	O	O	O	O	I-TECHNIQUE	O
blacklisted	O	O	O	O	I-TECHNIQUE	O
processes	O	O	O	O	I-TECHNIQUE	O
,	O	O	O	O	I-TECHNIQUE	O
services	O	O	O	O	I-TECHNIQUE	O
and	O	O	O	O	I-TECHNIQUE	O
shadow	O	O	O	O	I-TECHNIQUE	O
copy	O	O	O	O	I-TECHNIQUE	O
deletion	O	O	O	O	I-TECHNIQUE	O
.	O	O	O	O	I-TECHNIQUE	O

However	O	O	O	O	O	O
,	O	O	O	O	O	O
this	O	O	O	O	O	O
flag	O	O	O	O	O	O
does	O	O	O	O	O	O
not	O	O	O	O	O	O
impact	O	O	O	O	O	O
the	O	O	O	O	O	O
new	O	O	O	O	O	O
Restart	O	O	O	O	O	O
Manager	O	O	O	O	O	O
functionality	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
d39ec1uo9ktrut.cloudfront.net	O	O	O	O	O	O
/	O	O	O	O	O	O
pasted-image	O	O	O	O	O	O
-	O	O	O	O	O	O
0	O	O	O	O	O	O
-	O	O	O	O	O	O
7	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
Indicators	O	O	O	O	O	O
of	O	O	O	O	O	O
compromise	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
d39ec1uo9ktrut.cloudfront.net	O	O	O	O	O	O
/	O	O	O	O	O	O
Screen-Shot	O	O	O	O	O	O
-	O	O	O	O	O	O
2020	O	O	O	O	O	O
-	O	O	O	O	O	O
09	O	O	O	O	O	O
-	O	O	O	O	O	O
03	O	O	O	O	O	O
-	O	O	O	O	O	O
at	O	O	O	O	O	O
-	O	O	O	O	O	O
11.48.30	O	O	O	O	O	O
-	O	O	O	O	O	O
am.png	O	O	O	O	O	O
)	O	O	O	O	O	O

