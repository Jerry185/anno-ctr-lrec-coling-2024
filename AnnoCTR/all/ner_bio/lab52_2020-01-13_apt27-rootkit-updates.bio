<DOCSTART>	O	O	O	O	O	O

APT27	O	O	O	B-GROUP	O	B-GROUP
ZxShell	O	O	O	B-MALWARE	O	B-MALWARE
RootKit	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
module	O	O	O	O	O	O
updates	O	O	O	O	O	O

January	O	O	B-DATE	O	O	B-DATE
13	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2020	O	O	I-DATE	O	O	I-DATE

Within	O	O	O	O	O	O
the	O	O	O	O	O	O
toolset	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
different	O	O	O	O	O	O
APT	O	O	O	B-CON	O	B-CON
groups	O	O	O	O	O	O
,	O	O	O	O	O	O
one	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
most	O	O	O	O	O	O
interesting	O	O	O	O	O	O
elements	O	O	O	O	O	O
and	O	O	O	O	O	O
the	O	O	O	O	O	O
one	O	O	O	O	O	O
that	O	O	O	O	O	O
generally	O	O	O	O	O	O
worries	O	O	O	O	O	O
the	O	O	O	O	O	O
most	O	O	O	O	O	O
,	O	O	O	O	O	O
are	O	O	O	O	O	O
their	O	O	O	O	O	O
capabilities	O	O	O	O	O	O
in	O	O	O	O	O	O
Ring0	O	O	O	O	O	O
,	O	O	O	O	O	O
generally	O	O	O	O	O	O
RootKit	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
/	O	O	O	O	O	O
Bootkit	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
type	O	O	O	O	O	O
threats	O	O	O	O	O	O
that	O	O	O	O	O	O
act	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
maximum	O	O	O	O	O	O
level	O	O	O	O	O	O
of	O	O	O	O	O	O
privileges	O	O	O	O	O	O
.	O	O	O	O	O	O

An	O	O	O	O	O	O
example	O	O	O	O	O	O
of	O	O	O	O	O	O
this	O	O	O	O	O	O
type	O	O	O	O	O	O
of	O	O	O	O	O	O
threats	O	O	O	O	O	O
is	O	O	O	O	O	O
the	O	O	O	O	O	O
RootKit	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
module	O	O	O	O	O	O
of	O	O	O	O	O	O
ZxShell	O	O	O	B-MALWARE	O	B-MALWARE
RAT	O	O	O	O	O	O
used	O	O	O	O	O	O
by	O	O	O	O	O	O
Emissary	O	O	O	B-GROUP	O	B-GROUP
Panda	O	O	O	I-GROUP	O	I-GROUP
(	O	O	O	O	O	O
APT27	O	O	O	B-GROUP	O	B-GROUP
)	O	O	O	O	O	O
,	O	O	O	O	O	O
of	O	O	O	O	O	O
which	O	O	O	O	O	O
there	O	O	O	O	O	O
is	O	O	O	O	O	O
a	O	O	O	O	O	O
relatively	O	O	O	O	O	O
recent	O	O	O	O	O	O
sample	O	O	O	O	O	O
(	O	O	O	O	O	O
Uploaded	O	O	O	O	O	O
to	O	O	O	O	O	O
Virustotal	O	O	O	O	O	O
since	O	O	O	O	O	O
2019	O	O	B-DATE	O	O	B-DATE
-	O	O	I-DATE	O	O	I-DATE
09	O	O	I-DATE	O	O	I-DATE
-	O	O	I-DATE	O	O	I-DATE
21	O	O	I-DATE	O	O	I-DATE
17	O	O	O	O	O	O
:	O	O	O	O	O	O
59	O	O	O	O	O	O
:	O	O	O	O	O	O
39	O	O	O	O	O	O
)	O	O	O	O	O	O
that	O	O	O	O	O	O
is	O	O	O	O	O	O
also	O	O	O	O	O	O
correctly	O	O	O	O	O	O
signed	O	O	O	O	O	O
,	O	O	O	O	O	O
so	O	O	O	O	O	O
it	O	O	O	O	O	O
can	O	O	O	O	O	O
be	O	O	O	O	O	O
loaded	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
latest	O	O	O	O	O	O
version	O	O	O	O	O	O
of	O	O	O	O	O	O
Windows	O	O	O	O	O	O
10	O	O	O	O	O	O
and	O	O	O	O	O	O
is	O	O	O	O	O	O
perfectly	O	O	O	O	O	O
functional	O	O	O	O	O	O
as	O	O	O	O	O	O
far	O	O	O	O	O	O
as	O	O	O	O	O	O
we	O	O	O	O	O	O
have	O	O	O	O	O	O
been	O	O	O	O	O	O
able	O	O	O	O	O	O
to	O	O	O	O	O	O
check	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lab52	B-ORG	O	O	O	O	B-ORG
.	O	O	O	O	O	O
io	O	O	O	O	O	O
/	O	O	O	O	O	O
blog	O	O	O	O	O	O
/	O	O	O	O	O	O
wp-content	O	O	O	O	O	O
/	O	O	O	O	O	O
uploads	O	O	O	O	O	O
/	O	O	O	O	O	O
2020	O	O	O	O	O	O
/	O	O	O	O	O	O
01	O	O	O	O	O	O
/	O	O	O	O	O	O
Captura-de-pantalla-de	O	O	O	O	O	O
-	O	O	O	O	O	O
2020	O	O	O	O	O	O
-	O	O	O	O	O	O
01	O	O	O	O	O	O
-	O	O	O	O	O	O
13	O	O	O	O	O	O
-	O	O	O	O	O	O
11	O	O	O	O	O	O
-	O	O	O	O	O	O
32	O	O	O	O	O	O
-	O	O	O	O	O	O
47	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O

Sysmon	O	O	O	O	O	O
DriverLoaded	O	O	O	O	O	O
event	O	O	O	O	O	O

A	O	O	O	O	O	O
complete	O	O	O	O	O	O
analysis	O	O	O	O	O	O
of	O	O	O	O	O	O
this	O	O	O	O	O	O
threat	O	O	O	O	O	O
can	O	O	O	O	O	O
be	O	O	O	O	O	O
found	O	O	O	O	O	O
made	O	O	O	O	O	O
by	O	O	O	O	O	O
the	O	O	O	O	O	O
analyst	O	O	O	O	O	O
Ori	O	O	O	O	O	O
Damari	O	O	O	O	O	O
(	O	O	O	O	O	O
@	O	O	O	O	O	O
0xrepnz	O	O	O	O	O	O
)	O	O	O	O	O	O
in	O	O	O	O	O	O
his	O	O	O	O	O	O
blog	O	O	O	O	O	O
(	O	O	O	O	O	O
<	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
repnz.github.io	O	O	O	O	O	O
/	O	O	O	O	O	O
posts	O	O	O	O	O	O
/	O	O	O	O	O	O
autochk-rootkit-analysis	O	O	O	O	O	O
/	O	O	O	O	O	O
>	O	O	O	O	O	O
)	O	O	O	O	O	O
.	O	O	O	O	O	O

After	O	O	O	O	O	O
analyzing	O	O	O	O	O	O
this	O	O	O	O	O	O
threat	O	O	O	O	O	O
and	O	O	O	O	O	O
describing	O	O	O	O	O	O
its	O	O	O	O	O	O
capabilities	O	O	O	O	O	O
,	O	O	O	O	O	O
he	O	O	O	O	O	O
has	O	O	O	O	O	O
rewritten	O	O	O	O	O	O
the	O	O	O	O	O	O
source	O	O	O	O	O	O
code	O	O	O	O	O	O
from	O	O	O	O	O	O
a	O	O	O	O	O	O
sample	O	O	O	O	O	O
of	O	O	O	O	O	O
this	O	O	O	O	O	O
threat	O	O	O	O	O	O
uploaded	O	O	O	O	O	O
in	O	O	O	O	O	O
2018	O	O	B-DATE	O	O	B-DATE
to	O	O	O	O	O	O
Virustotal	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
published	O	O	O	O	O	O
it	O	O	O	O	O	O
in	O	O	O	O	O	O
GitHub	B-ORG	O	O	O	O	B-ORG
,	O	O	O	O	O	O
which	O	O	O	O	O	O
greatly	O	O	O	O	O	O
facilitates	O	O	O	O	O	O
the	O	O	O	O	O	O
analysis	O	O	O	O	O	O
of	O	O	O	O	O	O
newer	O	O	O	O	O	O
versions	O	O	O	O	O	O
.	O	O	O	O	O	O

As	O	O	O	O	O	O
he	O	O	O	O	O	O
describes	O	O	O	O	O	O
in	O	O	O	O	O	O
his	O	O	O	O	O	O
blog	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
capabilities	O	O	O	O	O	O
of	O	O	O	O	O	O
this	O	O	O	O	O	O
Rootkit	O	O	O	B-TECHNIQUE	O	B-TECHNIQUE
are	O	O	O	O	O	O
basically	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
:	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
File	O	O	O	O	O	O
Redirection	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

–	O	O	O	O	O	O
Redirect	O	O	O	O	B-TECHNIQUE	O
malicious	O	O	O	O	I-TECHNIQUE	O
files	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
benign	O	O	O	O	I-TECHNIQUE	O
files	O	O	O	O	I-TECHNIQUE	O
.	O	O	O	O	O	O

If	O	O	O	O	O	O
you	O	O	O	O	B-TECHNIQUE	O
try	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
call	O	O	O	O	I-TECHNIQUE	O
CreateFile	O	O	O	O	I-TECHNIQUE	O
(	O	O	O	O	I-TECHNIQUE	O
)	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
open	O	O	O	O	I-TECHNIQUE	O
a	O	O	O	O	I-TECHNIQUE	O
malicious	O	O	O	O	I-TECHNIQUE	O
file	O	O	O	O	I-TECHNIQUE	O
you	O	O	O	O	I-TECHNIQUE	O
’	O	O	O	O	I-TECHNIQUE	O
ll	O	O	O	O	I-TECHNIQUE	O
get	O	O	O	O	I-TECHNIQUE	O
a	O	O	O	O	I-TECHNIQUE	O
handle	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
a	O	O	O	O	I-TECHNIQUE	O
benign	O	O	O	O	I-TECHNIQUE	O
file	O	O	O	O	I-TECHNIQUE	O
.	O	O	O	O	I-TECHNIQUE	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lab52	B-ORG	O	O	O	O	B-ORG
.	O	O	O	O	O	O
io	O	O	O	O	O	O
/	O	O	O	O	O	O
blog	O	O	O	O	O	O
/	O	O	O	O	O	O
wp-content	O	O	O	O	O	O
/	O	O	O	O	O	O
uploads	O	O	O	O	O	O
/	O	O	O	O	O	O
2020	O	O	O	O	O	O
/	O	O	O	O	O	O
01	O	O	O	O	O	O
/	O	O	O	O	O	O
Captura-de-pantalla-de	O	O	O	O	O	O
-	O	O	O	O	O	O
2020	O	O	O	O	O	O
-	O	O	O	O	O	O
01	O	O	O	O	O	O
-	O	O	O	O	O	O
13	O	O	O	O	O	O
-	O	O	O	O	O	O
11	O	O	O	O	O	O
-	O	O	O	O	O	O
39	O	O	O	O	O	O
-	O	O	O	O	O	O
50	O	O	O	O	O	O
_	O	O	O	O	O	O
arrows	O	O	O	O	O	O
-	O	O	O	O	O	O
1024x435	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
Network	O	O	O	O	B-TECHNIQUE	O
Connection	O	O	O	O	I-TECHNIQUE	O
Hiding	O	O	O	O	I-TECHNIQUE	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

–	O	O	O	O	O	O
Hide	O	O	O	O	B-TECHNIQUE	O
network	O	O	O	O	I-TECHNIQUE	O
connections	O	O	O	O	I-TECHNIQUE	O
from	O	O	O	O	O	O
tools	O	O	O	O	O	O
like	O	O	O	O	O	O
netstat	O	O	O	O	O	O
,	O	O	O	O	O	O
proceshacker	O	O	O	O	O	O
…	O	O	O	O	O	O

We	O	O	O	O	O	O
found	O	O	O	O	O	O
interesting	O	O	O	O	O	O
to	O	O	O	O	O	O
analyze	O	O	O	O	O	O
the	O	O	O	O	O	O
differences	O	O	O	O	O	O
between	O	O	O	O	O	O
the	O	O	O	O	O	O
2018	O	O	B-DATE	O	O	B-DATE
version	O	O	O	O	O	O
and	O	O	O	O	O	O
the	O	O	O	O	O	O
most	O	O	O	O	O	O
recent	O	O	O	O	O	O
2019	O	O	B-DATE	O	O	B-DATE
version	O	O	O	O	O	O
in	O	O	O	O	O	O
order	O	O	O	O	O	O
to	O	O	O	O	O	O
try	O	O	O	O	O	O
to	O	O	O	O	O	O
identify	O	O	O	O	O	O
new	O	O	O	O	O	O
capabilities	O	O	O	O	O	O
or	O	O	O	O	O	O
changes	O	O	O	O	O	O
in	O	O	O	O	O	O
its	O	O	O	O	O	O
capabilities	O	O	O	O	O	O
.	O	O	O	O	O	O

After	O	O	O	O	O	O
comparing	O	O	O	O	O	O
both	O	O	O	O	O	O
samples	O	O	O	O	O	O
using	O	O	O	O	O	O
the	O	O	O	O	O	O
GitHub	B-ORG	O	O	O	O	B-ORG
source	O	O	O	O	O	O
code	O	O	O	O	O	O
,	O	O	O	O	O	O
we	O	O	O	O	O	O
have	O	O	O	O	O	O
been	O	O	O	O	O	O
able	O	O	O	O	O	O
to	O	O	O	O	O	O
see	O	O	O	O	O	O
that	O	O	O	O	O	O
most	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
functions	O	O	O	O	O	O
are	O	O	O	O	O	O
identical	O	O	O	O	O	O
,	O	O	O	O	O	O
except	O	O	O	O	O	O
for	O	O	O	O	O	O
5	O	O	O	O	O	O
of	O	O	O	O	O	O
them	O	O	O	O	O	O
(	O	O	O	O	O	O
including	O	O	O	O	O	O
the	O	O	O	O	O	O
Driver	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
entrypoint	O	O	O	O	O	O
)	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lab52	B-ORG	O	O	O	O	B-ORG
.	O	O	O	O	O	O
io	O	O	O	O	O	O
/	O	O	O	O	O	O
blog	O	O	O	O	O	O
/	O	O	O	O	O	O
wp-content	O	O	O	O	O	O
/	O	O	O	O	O	O
uploads	O	O	O	O	O	O
/	O	O	O	O	O	O
2020	O	O	O	O	O	O
/	O	O	O	O	O	O
01	O	O	O	O	O	O
/	O	O	O	O	O	O
Captura-de-pantalla-de	O	O	O	O	O	O
-	O	O	O	O	O	O
2020	O	O	O	O	O	O
-	O	O	O	O	O	O
01	O	O	O	O	O	O
-	O	O	O	O	O	O
10	O	O	O	O	O	O
-	O	O	O	O	O	O
14	O	O	O	O	O	O
-	O	O	O	O	O	O
25	O	O	O	O	O	O
-	O	O	O	O	O	O
57	O	O	O	O	O	O
-	O	O	O	O	O	O
1024x188	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O

Identical	O	O	O	O	O	O
functions	O	O	O	O	O	O
in	O	O	O	O	O	O
both	O	O	O	O	O	O
versions	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lab52	B-ORG	O	O	O	O	B-ORG
.	O	O	O	O	O	O
io	O	O	O	O	O	O
/	O	O	O	O	O	O
blog	O	O	O	O	O	O
/	O	O	O	O	O	O
wp-content	O	O	O	O	O	O
/	O	O	O	O	O	O
uploads	O	O	O	O	O	O
/	O	O	O	O	O	O
2020	O	O	O	O	O	O
/	O	O	O	O	O	O
01	O	O	O	O	O	O
/	O	O	O	O	O	O
Captura-de-pantalla-de	O	O	O	O	O	O
-	O	O	O	O	O	O
2020	O	O	O	O	O	O
-	O	O	O	O	O	O
01	O	O	O	O	O	O
-	O	O	O	O	O	O
10	O	O	O	O	O	O
-	O	O	O	O	O	O
14	O	O	O	O	O	O
-	O	O	O	O	O	O
25	O	O	O	O	O	O
-	O	O	O	O	O	O
24	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O

Different	O	O	O	O	O	O
functions	O	O	O	O	O	O

After	O	O	O	O	O	O
analyzing	O	O	O	O	O	O
the	O	O	O	O	O	O
differences	O	O	O	O	O	O
between	O	O	O	O	O	O
this	O	O	O	O	O	O
5	O	O	O	O	O	O
funtcions	O	O	O	O	O	O
,	O	O	O	O	O	O
we	O	O	O	O	O	O
have	O	O	O	O	O	O
been	O	O	O	O	O	O
able	O	O	O	O	O	O
to	O	O	O	O	O	O
observe	O	O	O	O	O	O
that	O	O	O	O	O	O
all	O	O	O	O	O	O
the	O	O	O	O	O	O
changes	O	O	O	O	O	O
are	O	O	O	O	O	O
focused	O	O	O	O	B-TECHNIQUE	O
on	O	O	O	O	I-TECHNIQUE	O
avoiding	O	O	O	O	I-TECHNIQUE	O
detections	O	O	O	O	I-TECHNIQUE	O
by	O	O	O	O	I-TECHNIQUE	O
slightly	O	O	O	O	I-TECHNIQUE	O
“	O	O	O	O	I-TECHNIQUE	O
obfuscating	O	O	O	O	I-TECHNIQUE	O
”	O	O	O	O	I-TECHNIQUE	O
some	O	O	O	O	I-TECHNIQUE	O
IOCs	O	O	O	O	I-TECHNIQUE	O
hardcoded	O	O	O	O	I-TECHNIQUE	O
as	O	O	O	O	I-TECHNIQUE	O
strings	O	O	O	O	I-TECHNIQUE	O
and	O	O	O	O	I-TECHNIQUE	O
code	O	O	O	O	I-TECHNIQUE	O
modification	O	O	O	O	I-TECHNIQUE	O
without	O	O	O	O	I-TECHNIQUE	O
impact	O	O	O	O	I-TECHNIQUE	O
in	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
capabilities	O	O	O	O	I-TECHNIQUE	O
on	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
driver	O	O	O	O	I-TECHNIQUE	O
…	O	O	O	O	O	O

In	O	O	O	O	O	O
total	O	O	O	O	O	O
,	O	O	O	O	O	O
there	O	O	O	O	O	O
are	O	O	O	O	O	O
three	O	O	O	O	O	O
notable	O	O	O	O	O	O
changes	O	O	O	O	O	O
between	O	O	O	O	O	O
the	O	O	O	O	O	O
two	O	O	O	O	O	O
versions	O	O	O	O	O	O
:	O	O	O	O	O	O

*	O	O	O	O	O	O
The	O	O	O	O	O	O
first	O	O	O	O	O	O
one	O	O	O	O	O	O
basically	O	O	O	O	O	O
consists	O	O	O	O	O	O
in	O	O	O	O	O	O
that	O	O	O	O	O	O
they	O	O	O	O	O	O
have	O	O	O	O	O	O
reversed	O	O	O	O	O	O
the	O	O	O	O	O	O
list	O	O	O	O	O	O
of	O	O	O	O	O	O
strings	O	O	O	O	O	O
that	O	O	O	O	O	O
identify	O	O	O	O	O	O
the	O	O	O	O	O	O
files	O	O	O	O	O	O
that	O	O	O	O	O	O
the	O	O	O	O	O	O
Driver	O	O	O	O	O	O
hides	O	O	O	O	O	O
by	O	O	O	O	O	O
default	O	O	O	O	O	O
when	O	O	O	O	O	O
it	O	O	O	O	O	O
is	O	O	O	O	O	O
loaded	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lab52	B-ORG	O	O	O	O	B-ORG
.	O	O	O	O	O	O
io	O	O	O	O	O	O
/	O	O	O	O	O	O
blog	O	O	O	O	O	O
/	O	O	O	O	O	O
wp-content	O	O	O	O	O	O
/	O	O	O	O	O	O
uploads	O	O	O	O	O	O
/	O	O	O	O	O	O
2020	O	O	O	O	O	O
/	O	O	O	O	O	O
01	O	O	O	O	O	O
/	O	O	O	O	O	O
Captura-de-pantalla-de	O	O	O	O	O	O
-	O	O	O	O	O	O
2020	O	O	O	O	O	O
-	O	O	O	O	O	O
01	O	O	O	O	O	O
-	O	O	O	O	O	O
13	O	O	O	O	O	O
-	O	O	O	O	O	O
12	O	O	O	O	O	O
-	O	O	O	O	O	O
48	O	O	O	O	O	O
-	O	O	O	O	O	O
53	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O
Old	O	O	O	O	O	O
and	O	O	O	O	O	O
New	O	O	O	O	O	O
list	O	O	O	O	O	O
of	O	O	O	O	O	O
file	O	O	O	O	O	O
names	O	O	O	O	O	O

At	O	O	O	O	O	O
code	O	O	O	O	O	O
level	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
impact	O	O	O	O	O	O
this	O	O	O	O	O	O
has	O	O	O	O	O	O
had	O	O	O	O	O	O
is	O	O	O	O	O	O
that	O	O	O	O	O	O
the	O	O	O	O	O	O
function	O	O	O	O	O	O
that	O	O	O	O	O	O
redirects	O	O	O	O	O	O
these	O	O	O	O	O	O
files	O	O	O	O	O	O
,	O	O	O	O	O	O
now	O	O	O	O	O	O
uses	O	O	O	O	O	O
the	O	O	O	O	O	O
“	O	O	O	O	O	O
wcrev	O	O	O	O	O	O
”	O	O	O	O	O	O
function	O	O	O	O	O	O
that	O	O	O	O	O	O
flips	O	O	O	O	B-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
strings	O	O	O	O	I-TECHNIQUE	O
before	O	O	O	O	I-TECHNIQUE	O
passing	O	O	O	O	I-TECHNIQUE	O
them	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
function	O	O	O	O	I-TECHNIQUE	O
that	O	O	O	O	I-TECHNIQUE	O
hides	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
files	O	O	O	O	I-TECHNIQUE	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lab52	B-ORG	O	O	O	O	B-ORG
.	O	O	O	O	O	O
io	O	O	O	O	O	O
/	O	O	O	O	O	O
blog	O	O	O	O	O	O
/	O	O	O	O	O	O
wp-content	O	O	O	O	O	O
/	O	O	O	O	O	O
uploads	O	O	O	O	O	O
/	O	O	O	O	O	O
2020	O	O	O	O	O	O
/	O	O	O	O	O	O
01	O	O	O	O	O	O
/	O	O	O	O	O	O
Captura-de-pantalla-de	O	O	O	O	O	O
-	O	O	O	O	O	O
2020	O	O	O	O	O	O
-	O	O	O	O	O	O
01	O	O	O	O	O	O
-	O	O	O	O	O	O
13	O	O	O	O	O	O
-	O	O	O	O	O	O
11	O	O	O	O	O	O
-	O	O	O	O	O	O
19	O	O	O	O	O	O
-	O	O	O	O	O	O
52Arrows	O	O	O	O	O	O
-	O	O	O	O	O	O
1024x346	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O

New	O	O	O	O	O	O
code	O	O	O	O	O	O
(	O	O	O	O	O	O
Red	O	O	O	O	O	O
)	O	O	O	O	O	O
and	O	O	O	O	O	O
old	O	O	O	O	O	O
code	O	O	O	O	O	O
(	O	O	O	O	O	O
Green	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Secondly	O	O	O	O	O	O
,	O	O	O	O	O	O
they	O	O	O	O	O	O
have	O	O	O	O	O	O
tried	O	O	O	O	O	O
to	O	O	O	O	O	O
disguise	O	O	O	O	O	O
their	O	O	O	O	O	O
use	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
undocumented	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
API	O	O	O	O	O	O
“	O	O	O	O	O	O
ObReferenceObjectByName	O	O	O	O	O	O
”	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
is	O	O	O	O	O	O
used	O	O	O	O	O	O
to	O	O	O	O	O	O
get	O	O	O	O	O	O
the	O	O	O	O	O	O
pointer	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
different	O	O	O	O	O	O
Driver	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
Object	O	O	O	O	O	O
drivers	O	O	O	O	O	O
they	O	O	O	O	O	O
intend	O	O	O	O	O	O
to	O	O	O	O	O	O
hook	O	O	O	O	O	O
in	O	O	O	O	O	O
each	O	O	O	O	O	O
case	O	O	O	O	O	O
.	O	O	O	O	O	O

Until	O	O	O	O	O	O
now	O	O	O	O	O	O
,	O	O	O	O	O	O
they	O	O	O	O	O	O
had	O	O	O	O	O	O
the	O	O	O	O	O	O
name	O	O	O	O	O	O
of	O	O	O	O	O	O
this	O	O	O	O	O	O
function	O	O	O	O	O	O
in	O	O	O	O	O	O
their	O	O	O	O	O	O
strings	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
used	O	O	O	O	O	O
it	O	O	O	O	O	O
to	O	O	O	O	O	O
resolve	O	O	O	O	O	O
it	O	O	O	O	O	O
by	O	O	O	O	O	O
passing	O	O	O	O	O	O
its	O	O	O	O	O	O
name	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
MmGetSystemRoutineAddress	O	O	O	O	O	O
API	O	O	O	O	O	O
which	O	O	O	O	O	O
returns	O	O	O	O	O	O
a	O	O	O	O	O	O
pointer	O	O	O	O	O	O
to	O	O	O	O	O	O
it	O	O	O	O	O	O
.	O	O	O	O	O	O

Now	O	O	O	O	O	O
they	O	O	O	O	O	O
only	O	O	O	O	O	O
keep	O	O	O	O	O	O
part	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
name	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
complete	O	O	O	O	O	O
the	O	O	O	O	O	O
rest	O	O	O	O	O	O
in	O	O	O	O	O	O
a	O	O	O	O	O	O
slightly	O	O	O	O	O	O
more	O	O	O	O	O	O
complex	O	O	O	O	O	O
way	O	O	O	O	O	O
before	O	O	O	O	O	O
calling	O	O	O	O	O	O
MmGetSystemRoutineAddress	O	O	O	O	O	O
by	O	O	O	O	O	O
building	O	O	O	O	O	O
it	O	O	O	O	O	O
from	O	O	O	O	O	O
characters	O	O	O	O	O	O
they	O	O	O	O	O	O
store	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
registers	O	O	O	O	O	O
and	O	O	O	O	O	O
other	O	O	O	O	O	O
areas	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
binary	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lab52	B-ORG	O	O	O	O	B-ORG
.	O	O	O	O	O	O
io	O	O	O	O	O	O
/	O	O	O	O	O	O
blog	O	O	O	O	O	O
/	O	O	O	O	O	O
wp-content	O	O	O	O	O	O
/	O	O	O	O	O	O
uploads	O	O	O	O	O	O
/	O	O	O	O	O	O
2020	O	O	O	O	O	O
/	O	O	O	O	O	O
01	O	O	O	O	O	O
/	O	O	O	O	O	O
Captura-de-pantalla-de	O	O	O	O	O	O
-	O	O	O	O	O	O
2020	O	O	O	O	O	O
-	O	O	O	O	O	O
01	O	O	O	O	O	O
-	O	O	O	O	O	O
13	O	O	O	O	O	O
-	O	O	O	O	O	O
11	O	O	O	O	O	O
-	O	O	O	O	O	O
34	O	O	O	O	O	O
-	O	O	O	O	O	O
49	O	O	O	O	O	O
-	O	O	O	O	O	O
1	O	O	O	O	O	O
-	O	O	O	O	O	O
1024x564	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
New	O	O	O	O	O	O
code	O	O	O	O	O	O
(	O	O	O	O	O	O
Red	O	O	O	O	O	O
)	O	O	O	O	O	O
and	O	O	O	O	O	O
old	O	O	O	O	O	O
code	O	O	O	O	O	O
(	O	O	O	O	O	O
Green	O	O	O	O	O	O
)	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
Finally	O	O	O	O	B-TECHNIQUE	O
,	O	O	O	O	I-TECHNIQUE	O
they	O	O	O	O	I-TECHNIQUE	O
have	O	O	O	O	I-TECHNIQUE	O
moved	O	O	O	O	I-TECHNIQUE	O
part	O	O	O	O	I-TECHNIQUE	O
of	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
logic	O	O	O	O	I-TECHNIQUE	O
of	O	O	O	O	I-TECHNIQUE	O
some	O	O	O	O	I-TECHNIQUE	O
functions	O	O	O	O	I-TECHNIQUE	O
to	O	O	O	O	I-TECHNIQUE	O
another	O	O	O	O	I-TECHNIQUE	O
point	O	O	O	O	I-TECHNIQUE	O
,	O	O	O	O	I-TECHNIQUE	O
maintaining	O	O	O	O	I-TECHNIQUE	O
the	O	O	O	O	I-TECHNIQUE	O
same	O	O	O	O	I-TECHNIQUE	O
functionality	O	O	O	O	I-TECHNIQUE	O
.	O	O	O	O	O	O

An	O	O	O	O	O	O
example	O	O	O	O	O	O
is	O	O	O	O	O	O
the	O	O	O	O	O	O
end	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
driver	O	O	O	O	O	O
entry	O	O	O	O	O	O
function	O	O	O	O	O	O
,	O	O	O	O	O	O
where	O	O	O	O	O	O
untill	O	O	O	O	O	O
now	O	O	O	O	O	O
,	O	O	O	O	O	O
at	O	O	O	O	O	O
the	O	O	O	O	O	O
end	O	O	O	O	O	O
they	O	O	O	O	O	O
only	O	O	O	O	O	O
called	O	O	O	O	O	O
two	O	O	O	O	O	O
functions	O	O	O	O	O	O
that	O	O	O	O	O	O
initialized	O	O	O	O	O	O
the	O	O	O	O	O	O
logic	O	O	O	O	O	O
of	O	O	O	O	O	O
hiding	O	O	O	O	O	O
connections	O	O	O	O	O	O
and	O	O	O	O	O	O
redirecting	O	O	O	O	O	O
files	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
now	O	O	O	O	O	O
,	O	O	O	O	O	O
they	O	O	O	O	O	O
have	O	O	O	O	O	O
extracted	O	O	O	O	O	O
part	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
logic	O	O	O	O	O	O
of	O	O	O	O	O	O
these	O	O	O	O	O	O
functions	O	O	O	O	O	O
and	O	O	O	O	O	O
moved	O	O	O	O	O	O
it	O	O	O	O	O	O
right	O	O	O	O	O	O
after	O	O	O	O	O	O
each	O	O	O	O	O	O
one	O	O	O	O	O	O
of	O	O	O	O	O	O
them	O	O	O	O	O	O
,	O	O	O	O	O	O
but	O	O	O	O	O	O
without	O	O	O	O	O	O
any	O	O	O	O	O	O
impact	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
capabilities	O	O	O	O	O	O
and	O	O	O	O	O	O
behavior	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
Driver	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lab52	B-ORG	O	O	O	O	B-ORG
.	O	O	O	O	O	O
io	O	O	O	O	O	O
/	O	O	O	O	O	O
blog	O	O	O	O	O	O
/	O	O	O	O	O	O
wp-content	O	O	O	O	O	O
/	O	O	O	O	O	O
uploads	O	O	O	O	O	O
/	O	O	O	O	O	O
2020	O	O	O	O	O	O
/	O	O	O	O	O	O
01	O	O	O	O	O	O
/	O	O	O	O	O	O
Captura-de-pantalla-de	O	O	O	O	O	O
-	O	O	O	O	O	O
2020	O	O	O	O	O	O
-	O	O	O	O	O	O
01	O	O	O	O	O	O
-	O	O	O	O	O	O
10	O	O	O	O	O	O
-	O	O	O	O	O	O
14	O	O	O	O	O	O
-	O	O	O	O	O	O
49	O	O	O	O	O	O
-	O	O	O	O	O	O
10	O	O	O	O	O	O
-	O	O	O	O	O	O
1024x130	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
New	O	O	O	O	O	O
code	O	O	O	O	O	O
(	O	O	O	O	O	O
Red	O	O	O	O	O	O
)	O	O	O	O	O	O
and	O	O	O	O	O	O
old	O	O	O	O	O	O
code	O	O	O	O	O	O
(	O	O	O	O	O	O
Green	O	O	O	O	O	O
)﻿	O	O	O	O	O	O
*	O	O	O	O	O	O

|	O	O	O	O	O	O
x64	O	O	O	O	O	O
Sample	O	O	O	O	O	O
|	O	O	O	O	O	O
42eab05c611bf24d86bb6c985caa2ad7380ed7d98340c7f08de9361be14dc244	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
x86	O	O	O	O	O	O
Sample	O	O	O	O	O	O
|	O	O	O	O	O	O
9b7c1e37d5f56cc0b5e5e22ce9805e237a189297e78405b9c392a0953b6e0321	O	O	O	O	O	O
|	O	O	O	O	O	O

