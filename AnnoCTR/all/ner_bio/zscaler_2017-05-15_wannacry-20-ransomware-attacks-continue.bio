<DOCSTART>	O	O	O	O	O	O

WannaCry	O	O	O	O	O	O
2.0	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
attacks	O	O	O	O	O	O
continue	O	O	O	O	O	O
.	O	O	O	O	O	O
.	O	O	O	O	O	O
.	O	O	O	O	O	O

May	O	O	B-DATE	O	O	B-DATE
15	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2017	O	O	I-DATE	O	O	I-DATE

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Introduction	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

An	O	O	O	O	O	O
aggressive	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
 	O	O	O	O	O	O
campaign	O	O	O	O	O	O
went	O	O	O	O	O	O
viral	O	O	O	O	O	O
on	O	O	O	O	O	O
May	O	O	B-DATE	O	O	B-DATE
12	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2017	O	O	I-DATE	O	O	I-DATE
,	O	O	O	O	O	O
that	O	O	O	O	O	O
impacted	O	O	O	O	O	O
over	O	O	O	O	O	O
200,000	O	O	O	O	O	O
systems	O	O	O	O	O	O
worldwide	O	O	O	O	O	O
and	O	O	O	O	O	O
the	O	O	O	O	O	O
attack	O	O	O	O	O	O
remains	O	O	O	O	O	O
active	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
use	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
leaked	O	O	O	O	O	O
NSA	O	O	O	O	O	O
"	O	O	O	O	O	O
ETERNALBLUE	O	O	O	O	O	O
"	O	O	O	O	O	O
 	O	O	O	O	O	O
SMB	O	O	O	O	O	O
exploit	O	O	O	O	O	O
by	O	O	O	O	O	O
the	O	O	O	O	O	O
dropper	O	O	O	O	O	O
payloads	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
target	O	O	O	O	O	O
a	O	O	O	O	O	O
 	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Windows	O	O	O	O	O	O
vulnerability	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
 	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Server	O	O	O	O	O	O
Message	O	O	O	O	O	O
Block	O	O	O	O	O	O
(	O	O	O	O	O	O
SMB	O	O	O	O	O	O
)	O	O	O	O	O	O
v1.0	O	O	O	O	O	O
protocol	O	O	O	O	O	O
,	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
made	O	O	O	O	O	O
this	O	O	O	O	O	O
campaign	O	O	O	O	O	O
virulent	O	O	O	O	O	O
.	O	O	O	O	O	O

Microsoft	B-ORG	O	O	O	O	B-ORG
released	O	O	O	O	O	O
a	O	O	O	O	O	O
patch	O	O	O	O	O	O
for	O	O	O	O	O	O
this	O	O	O	O	O	O
vulnerability	O	O	O	O	O	O
in	O	O	O	O	O	O
[	O	O	O	O	O	O
March	O	O	B-DATE	O	O	B-DATE
2017	O	O	I-DATE	O	O	I-DATE
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
technet.microsoft.com	O	O	O	O	O	O
/	O	O	O	O	O	O
en-us	O	O	O	O	O	O
/	O	O	O	O	O	O
library	O	O	O	O	O	O
/	O	O	O	O	O	O
security	O	O	O	O	O	O
/	O	O	O	O	O	O
ms17	O	O	O	O	O	O
-	O	O	O	O	O	O
010	O	O	O	O	O	O
.	O	O	O	O	O	O
aspx	O	O	O	O	O	O
)	O	O	O	O	O	O
for	O	O	O	O	O	O
all	O	O	O	O	O	O
the	O	O	O	O	O	O
supported	O	O	O	O	O	O
operating	O	O	O	O	O	O
systems	O	O	O	O	O	O
;	O	O	O	O	O	O
however	O	O	O	O	O	O
,	O	O	O	O	O	O
there	O	O	O	O	O	O
are	O	O	O	O	O	O
still	O	O	O	O	O	O
organizations	O	O	O	O	O	O
with	O	O	O	O	O	O
legacy	O	O	O	O	O	O
systems	O	O	O	O	O	O
running	O	O	O	O	O	O
older	O	O	O	O	O	O
and	O	O	O	O	O	O
now	O	O	O	O	O	O
unsupported	O	O	O	O	O	O
operating	O	O	O	O	O	O
systems	O	O	O	O	O	O
like	O	O	O	O	O	O
Windows	O	O	O	O	O	O
XP	O	O	O	O	O	O
for	O	O	O	O	O	O
which	O	O	O	O	O	O
the	O	O	O	O	O	O
patch	O	O	O	O	O	O
was	O	O	O	O	O	O
not	O	O	O	O	O	O
available	O	O	O	O	O	O
in	O	O	O	O	O	O
March	O	O	B-DATE	O	O	B-DATE
.	O	O	O	O	O	O

Microsoft	B-ORG	O	O	O	O	B-ORG
released	O	O	O	O	O	O
an	O	O	O	O	O	O
[	O	O	O	O	O	O
emergency	O	O	O	O	O	O
patch	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs.technet.microsoft.com	O	O	O	O	O	O
/	O	O	O	O	O	O
msrc	O	O	O	O	O	O
/	O	O	O	O	O	O
2017	O	O	O	O	O	O
/	O	O	O	O	O	O
05	O	O	O	O	O	O
/	O	O	O	O	O	O
12	O	O	O	O	O	O
/	O	O	O	O	O	O
customer-guidance-for-wannacrypt-attacks	O	O	O	O	O	O
/	O	O	O	O	O	O
)	O	O	O	O	O	O
over	O	O	O	O	O	O
the	O	O	O	O	O	O
weekend	O	O	O	O	O	O
for	O	O	O	O	O	O
the	O	O	O	O	O	O
unsupported	O	O	O	O	O	O
operating	O	O	O	O	O	O
systems	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
wake	O	O	O	O	O	O
of	O	O	O	O	O	O
this	O	O	O	O	O	O
attack	O	O	O	O	O	O
.	O	O	O	O	O	O

As	O	O	O	O	O	O
predicted	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
 	O	O	O	O	O	O
[	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
Zscaler	B-ORG	O	O	O	O	B-ORG
Security	O	O	O	O	O	O
advisory	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
research	O	O	O	O	O	O
/	O	O	O	O	O	O
wannacry-ransomware-what-you-need-know	O	O	O	O	O	O
)	O	O	O	O	O	O
,	O	O	O	O	O	O
we	O	O	O	O	O	O
are	O	O	O	O	O	O
now	O	O	O	O	O	O
seeing	O	O	O	O	O	O
different	O	O	O	O	O	O
variants	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
initial	O	O	O	O	O	O
dropper	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
wild	O	O	O	O	O	O
that	O	O	O	O	O	O
are	O	O	O	O	O	O
leading	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
WannaCrypt	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
infection	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
this	O	O	O	O	O	O
blog	O	O	O	O	O	O
,	O	O	O	O	O	O
we	O	O	O	O	O	O
will	O	O	O	O	O	O
provide	O	O	O	O	O	O
a	O	O	O	O	O	O
technical	O	O	O	O	O	O
analysis	O	O	O	O	O	O
of	O	O	O	O	O	O
different	O	O	O	O	O	O
dropper	O	O	O	O	O	O
variants	O	O	O	O	O	O
we	O	O	O	O	O	O
have	O	O	O	O	O	O
seen	O	O	O	O	O	O
till	O	O	O	O	O	O
now	O	O	O	O	O	O
,	O	O	O	O	O	O
propagation	O	O	O	O	O	O
vectors	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
the	O	O	O	O	O	O
final	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
payload	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
wannacrypt	O	O	O	O	O	O
/	O	O	O	O	O	O
WannaCrypt_infection.PNG	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
1	O	O	O	O	O	O
:	O	O	O	O	O	O
WannaCrypt	O	O	O	O	O	O
infection	O	O	O	O	O	O
vectors	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
1	O	O	O	O	O	O
.	O	O	O	O	O	O
Initial	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
Dropper	O	O	O	O	O	O
Variants	O	O	O	O	O	O
–	O	O	O	O	O	O
May	O	O	B-DATE	O	O	B-DATE
12	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2017	O	O	I-DATE	O	O	I-DATE
onwards	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
dropper	O	O	O	O	O	O
 	O	O	O	O	O	O
variants	O	O	O	O	O	O
that	O	O	O	O	O	O
we	O	O	O	O	O	O
saw	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
first	O	O	O	O	O	O
24	O	O	O	O	O	O
hours	O	O	O	O	O	O
were	O	O	O	O	O	O
all	O	O	O	O	O	O
performing	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
activities	O	O	O	O	O	O
:	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
a	O	O	O	O	O	O
.	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
Killswitch	O	O	O	O	O	O
domain	O	O	O	O	O	O
 	O	O	O	O	O	O
check	O	O	O	O	O	O
before	O	O	O	O	O	O
starting	O	O	O	O	O	O
the	O	O	O	O	O	O
infection	O	O	O	O	O	O
cycle	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
dropper	O	O	O	O	O	O
payload	O	O	O	O	O	O
will	O	O	O	O	O	O
attempt	O	O	O	O	O	O
to	O	O	O	O	O	O
make	O	O	O	O	O	O
a	O	O	O	O	O	O
direct	O	O	O	O	O	O
connection	O	O	O	O	O	O
to	O	O	O	O	O	O
a	O	O	O	O	O	O
hardcoded	O	O	O	O	O	O
domain	O	O	O	O	O	O
over	O	O	O	O	O	O
HTTP	O	O	O	O	O	O
and	O	O	O	O	O	O
,	O	O	O	O	O	O
if	O	O	O	O	O	O
the	O	O	O	O	O	O
connection	O	O	O	O	O	O
is	O	O	O	O	O	O
successful	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
malware	O	O	O	O	O	O
will	O	O	O	O	O	O
terminate	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
malware	O	O	O	O	O	O
payload	O	O	O	O	O	O
will	O	O	O	O	O	O
begin	O	O	O	O	O	O
the	O	O	O	O	O	O
infection	O	O	O	O	O	O
cycle	O	O	O	O	O	O
if	O	O	O	O	O	O
the	O	O	O	O	O	O
connection	O	O	O	O	O	O
is	O	O	O	O	O	O
not	O	O	O	O	O	O
successful	O	O	O	O	O	O
.	O	O	O	O	O	O

There	O	O	O	O	O	O
have	O	O	O	O	O	O
been	O	O	O	O	O	O
more	O	O	O	O	O	O
variants	O	O	O	O	O	O
seen	O	O	O	O	O	O
in	O	O	O	O	O	O
past	O	O	O	O	O	O
72	O	O	O	O	O	O
hours	O	O	O	O	O	O
with	O	O	O	O	O	O
different	O	O	O	O	O	O
killswitch	O	O	O	O	O	O
domains	O	O	O	O	O	O
that	O	O	O	O	O	O
include	O	O	O	O	O	O
:	O	O	O	O	O	O

*	O	O	O	O	O	O
iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O

*	O	O	O	O	O	O
ifferfsodp9ifjaposdfjhgosurijfaewrwergwea	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O

*	O	O	O	O	O	O
iuqerssodp9ifjaposdfjhgosurijfaewrwergwea	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O

*	O	O	O	O	O	O
ayylmaotjhsstasdfasdfasdfasdfasdfasdfasdf	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O

Organizations	O	O	O	O	O	O
 	O	O	O	O	O	O
can	O	O	O	O	O	O
locally	O	O	O	O	O	O
resolve	O	O	O	O	O	O
these	O	O	O	O	O	O
domains	O	O	O	O	O	O
to	O	O	O	O	O	O
a	O	O	O	O	O	O
local	O	O	O	O	O	O
webserver	O	O	O	O	O	O
as	O	O	O	O	O	O
an	O	O	O	O	O	O
additional	O	O	O	O	O	O
safeguard	O	O	O	O	O	O
mechanism	O	O	O	O	O	O
to	O	O	O	O	O	O
mitigate	O	O	O	O	O	O
infection	O	O	O	O	O	O
from	O	O	O	O	O	O
these	O	O	O	O	O	O
dropper	O	O	O	O	O	O
variants	O	O	O	O	O	O
.	O	O	O	O	O	O

It	O	O	O	O	O	O
is	O	O	O	O	O	O
also	O	O	O	O	O	O
important	O	O	O	O	O	O
to	O	O	O	O	O	O
monitor	O	O	O	O	O	O
the	O	O	O	O	O	O
logs	O	O	O	O	O	O
to	O	O	O	O	O	O
identify	O	O	O	O	O	O
systems	O	O	O	O	O	O
that	O	O	O	O	O	O
hit	O	O	O	O	O	O
this	O	O	O	O	O	O
local	O	O	O	O	O	O
webserver	O	O	O	O	O	O
to	O	O	O	O	O	O
perform	O	O	O	O	O	O
isolation	O	O	O	O	O	O
and	O	O	O	O	O	O
remediation	O	O	O	O	O	O
activity	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
following	O	O	O	O	O	O
is	O	O	O	O	O	O
a	O	O	O	O	O	O
screenshot	O	O	O	O	O	O
showing	O	O	O	O	O	O
the	O	O	O	O	O	O
killswitch	O	O	O	O	O	O
domain	O	O	O	O	O	O
check	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
wannacrypt	O	O	O	O	O	O
/	O	O	O	O	O	O
Dropper1	O	O	O	O	O	O
_	O	O	O	O	O	O
killswitch_domain.png	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
2	O	O	O	O	O	O
:	O	O	O	O	O	O
Killswitch	O	O	O	O	O	O
domain	O	O	O	O	O	O
check	O	O	O	O	O	O
from	O	O	O	O	O	O
a	O	O	O	O	O	O
sample	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
b.Network	O	O	O	O	O	O
propagation	O	O	O	O	O	O
using	O	O	O	O	O	O
the	O	O	O	O	O	O
MS17	O	O	O	O	O	O
-	O	O	O	O	O	O
010	O	O	O	O	O	O
exploit	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
dropper	O	O	O	O	O	O
variant	O	O	O	O	O	O
will	O	O	O	O	O	O
spawn	O	O	O	O	O	O
multiple	O	O	O	O	O	O
threads	O	O	O	O	O	O
to	O	O	O	O	O	O
scan	O	O	O	O	O	O
for	O	O	O	O	O	O
internal	O	O	O	O	O	O
as	O	O	O	O	O	O
well	O	O	O	O	O	O
as	O	O	O	O	O	O
external	O	O	O	O	O	O
IP	O	O	O	O	O	O
addresses	O	O	O	O	O	O
on	O	O	O	O	O	O
ports	O	O	O	O	O	O
139	O	O	O	O	O	O
and	O	O	O	O	O	O
445	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
/	O	O	O	O	O	O
24	O	O	O	O	O	O
subnet	O	O	O	O	O	O
range	O	O	O	O	O	O
.	O	O	O	O	O	O

If	O	O	O	O	O	O
the	O	O	O	O	O	O
malware	O	O	O	O	O	O
finds	O	O	O	O	O	O
any	O	O	O	O	O	O
IP	O	O	O	O	O	O
address	O	O	O	O	O	O
with	O	O	O	O	O	O
active	O	O	O	O	O	O
SMB	O	O	O	O	O	O
ports	O	O	O	O	O	O
,	O	O	O	O	O	O
it	O	O	O	O	O	O
will	O	O	O	O	O	O
attempt	O	O	O	O	O	O
to	O	O	O	O	O	O
trigger	O	O	O	O	O	O
the	O	O	O	O	O	O
MS17	O	O	O	O	O	O
-	O	O	O	O	O	O
010	O	O	O	O	O	O
exploit	O	O	O	O	O	O
and	O	O	O	O	O	O
perform	O	O	O	O	O	O
remote	O	O	O	O	O	O
code	O	O	O	O	O	O
execution	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
target	O	O	O	O	O	O
system	O	O	O	O	O	O
.	O	O	O	O	O	O

Upon	O	O	O	O	O	O
a	O	O	O	O	O	O
successful	O	O	O	O	O	O
exploit	O	O	O	O	O	O
run	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
malware	O	O	O	O	O	O
will	O	O	O	O	O	O
copy	O	O	O	O	O	O
the	O	O	O	O	O	O
dropper	O	O	O	O	O	O
variant	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
target	O	O	O	O	O	O
system	O	O	O	O	O	O
and	O	O	O	O	O	O
execute	O	O	O	O	O	O
it	O	O	O	O	O	O
to	O	O	O	O	O	O
perform	O	O	O	O	O	O
a	O	O	O	O	O	O
similar	O	O	O	O	O	O
activity	O	O	O	O	O	O
.	O	O	O	O	O	O

Several	O	O	O	O	O	O
factors	O	O	O	O	O	O
made	O	O	O	O	O	O
this	O	O	O	O	O	O
attack	O	O	O	O	O	O
extremely	O	O	O	O	O	O
virulent	O	O	O	O	O	O
.	O	O	O	O	O	O

They	O	O	O	O	O	O
include	O	O	O	O	O	O
the	O	O	O	O	O	O
use	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
recent	O	O	O	O	O	O
 	O	O	O	O	O	O
SMB	O	O	O	O	O	O
exploit	O	O	O	O	O	O
to	O	O	O	O	O	O
perform	O	O	O	O	O	O
lateral	O	O	O	O	O	O
movement	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
delay	O	O	O	O	O	O
that	O	O	O	O	O	O
exists	O	O	O	O	O	O
in	O	O	O	O	O	O
most	O	O	O	O	O	O
enterprise	O	O	O	O	O	O
environments	O	O	O	O	O	O
to	O	O	O	O	O	O
apply	O	O	O	O	O	O
security	O	O	O	O	O	O
patches	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
 	O	O	O	O	O	O
the	O	O	O	O	O	O
fact	O	O	O	O	O	O
that	O	O	O	O	O	O
there	O	O	O	O	O	O
are	O	O	O	O	O	O
still	O	O	O	O	O	O
thousands	O	O	O	O	O	O
of	O	O	O	O	O	O
legacy	O	O	O	O	O	O
systems	O	O	O	O	O	O
running	O	O	O	O	O	O
older	O	O	O	O	O	O
operating	O	O	O	O	O	O
systems	O	O	O	O	O	O
that	O	O	O	O	O	O
had	O	O	O	O	O	O
no	O	O	O	O	O	O
security	O	O	O	O	O	O
patch	O	O	O	O	O	O
availability	O	O	O	O	O	O
until	O	O	O	O	O	O
May	O	O	B-DATE	O	O	B-DATE
13	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2017	O	O	I-DATE	O	O	I-DATE
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
c.Embedded	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
2.0	O	O	O	O	O	O
payload	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
dropper	O	O	O	O	O	O
payloads	O	O	O	O	O	O
contain	O	O	O	O	O	O
 	O	O	O	O	O	O
a	O	O	O	O	O	O
 	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
2.0	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
executable	O	O	O	O	O	O
embedded	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
resource	O	O	O	O	O	O
section	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
executable	O	O	O	O	O	O
will	O	O	O	O	O	O
be	O	O	O	O	O	O
installed	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
target	O	O	O	O	O	O
system	O	O	O	O	O	O
once	O	O	O	O	O	O
the	O	O	O	O	O	O
SMB	O	O	O	O	O	O
exploit	O	O	O	O	O	O
is	O	O	O	O	O	O
successful	O	O	O	O	O	O
,	O	O	O	O	O	O
effectively	O	O	O	O	O	O
encrypting	O	O	O	O	O	O
all	O	O	O	O	O	O
the	O	O	O	O	O	O
user	O	O	O	O	O	O
documents	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
wannacrypt	O	O	O	O	O	O
/	O	O	O	O	O	O
Dropper1	O	O	O	O	O	O
_	O	O	O	O	O	O
embeddedpayload.PNG	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
3	O	O	O	O	O	O
:	O	O	O	O	O	O
Embedded	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
2.0	O	O	O	O	O	O
payload	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
dropper	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
2	O	O	O	O	O	O
.	O	O	O	O	O	O
New	O	O	O	O	O	O
downloader	O	O	O	O	O	O
variant	O	O	O	O	O	O
using	O	O	O	O	O	O
web	O	O	O	O	O	O
channel	O	O	O	O	O	O
(	O	O	O	O	O	O
HTTP	O	O	O	O	O	O
)	O	O	O	O	O	O
–	O	O	O	O	O	O
May	O	O	B-DATE	O	O	B-DATE
15	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2017	O	O	I-DATE	O	O	I-DATE
*	O	O	O	O	O	O
*	O	O	O	O	O	O

Earlier	O	O	O	O	O	O
today	O	O	O	O	O	O
(	O	O	O	O	O	O
May	O	O	B-DATE	O	O	B-DATE
15	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2017	O	O	I-DATE	O	O	I-DATE
)	O	O	O	O	O	O
,	O	O	O	O	O	O
 	O	O	O	O	O	O
we	O	O	O	O	O	O
saw	O	O	O	O	O	O
a	O	O	O	O	O	O
new	O	O	O	O	O	O
downloader	O	O	O	O	O	O
variant	O	O	O	O	O	O
that	O	O	O	O	O	O
had	O	O	O	O	O	O
an	O	O	O	O	O	O
embedded	O	O	O	O	O	O
link	O	O	O	O	O	O
pointing	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
2.0	O	O	O	O	O	O
payload	O	O	O	O	O	O
hosted	O	O	O	O	O	O
on	O	O	O	O	O	O
a	O	O	O	O	O	O
compromised	O	O	O	O	O	O
server	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
downloader	O	O	O	O	O	O
payload	O	O	O	O	O	O
is	O	O	O	O	O	O
packed	O	O	O	O	O	O
using	O	O	O	O	O	O
UPX	O	O	O	O	O	O
packer	O	O	O	O	O	O
and	O	O	O	O	O	O
is	O	O	O	O	O	O
compiled	O	O	O	O	O	O
using	O	O	O	O	O	O
a	O	O	O	O	O	O
"	O	O	O	O	O	O
*	O	O	O	O	O	O
php2exe	O	O	O	O	O	O
"	O	O	O	O	O	O
*	O	O	O	O	O	O
tool	O	O	O	O	O	O
that	O	O	O	O	O	O
converts	O	O	O	O	O	O
PHP	O	O	O	O	O	O
code	O	O	O	O	O	O
into	O	O	O	O	O	O
a	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Windows	O	O	O	O	O	O
Executable	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
Filename	O	O	O	O	O	O
-	O	O	O	O	O	O
wcrydl.exe	O	O	O	O	O	O

*	O	O	O	O	O	O
MD5	O	O	O	O	O	O
-	O	O	O	O	O	O
2788541f68a8bf3f9f8405bf6fdcd033	O	O	O	O	O	O

The	O	O	O	O	O	O
code	O	O	O	O	O	O
responsible	O	O	O	O	O	O
for	O	O	O	O	O	O
downloading	O	O	O	O	O	O
and	O	O	O	O	O	O
executing	O	O	O	O	O	O
the	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
2.0	O	O	O	O	O	O
payload	O	O	O	O	O	O
is	O	O	O	O	O	O
present	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
resource	O	O	O	O	O	O
section	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
main	O	O	O	O	O	O
executable	O	O	O	O	O	O
as	O	O	O	O	O	O
seen	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
screenshot	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
wannacrypt	O	O	O	O	O	O
/	O	O	O	O	O	O
Dropper2	O	O	O	O	O	O
_	O	O	O	O	O	O
resource.PNG	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
4	O	O	O	O	O	O
:	O	O	O	O	O	O
Resource	O	O	O	O	O	O
section	O	O	O	O	O	O
containing	O	O	O	O	O	O
downloader	O	O	O	O	O	O
PHP	O	O	O	O	O	O
scripts	O	O	O	O	O	O
*	O	O	O	O	O	O

Here	O	O	O	O	O	O
is	O	O	O	O	O	O
a	O	O	O	O	O	O
screenshot	O	O	O	O	O	O
showing	O	O	O	O	O	O
the	O	O	O	O	O	O
decompiled	O	O	O	O	O	O
PHP	O	O	O	O	O	O
version	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
dropper	O	O	O	O	O	O
executable	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
wannacrypt	O	O	O	O	O	O
/	O	O	O	O	O	O
Dropper2	O	O	O	O	O	O
_	O	O	O	O	O	O
decompiled_php.png	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
5	O	O	O	O	O	O
:	O	O	O	O	O	O
Decompiled	O	O	O	O	O	O
downloader	O	O	O	O	O	O
PHP	O	O	O	O	O	O
code	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
remote	O	O	O	O	O	O
server	O	O	O	O	O	O
hosting	O	O	O	O	O	O
the	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
payload	O	O	O	O	O	O
appears	O	O	O	O	O	O
to	O	O	O	O	O	O
be	O	O	O	O	O	O
compromised	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
executable	O	O	O	O	O	O
is	O	O	O	O	O	O
hosted	O	O	O	O	O	O
at	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
location	O	O	O	O	O	O
:	O	O	O	O	O	O

*	O	O	O	O	O	O
neiscoegypt	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O
/	O	O	O	O	O	O
ajax	O	O	O	O	O	O
/	O	O	O	O	O	O
wanacry.exe	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
2.0	O	O	O	O	O	O
payload	O	O	O	O	O	O
analysis	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
executables	O	O	O	O	O	O
seen	O	O	O	O	O	O
in	O	O	O	O	O	O
all	O	O	O	O	O	O
the	O	O	O	O	O	O
campaigns	O	O	O	O	O	O
appear	O	O	O	O	O	O
 	O	O	O	O	O	O
to	O	O	O	O	O	O
be	O	O	O	O	O	O
similar	O	O	O	O	O	O
,	O	O	O	O	O	O
as	O	O	O	O	O	O
we	O	O	O	O	O	O
have	O	O	O	O	O	O
been	O	O	O	O	O	O
able	O	O	O	O	O	O
to	O	O	O	O	O	O
flag	O	O	O	O	O	O
all	O	O	O	O	O	O
of	O	O	O	O	O	O
them	O	O	O	O	O	O
using	O	O	O	O	O	O
the	O	O	O	O	O	O
first	O	O	O	O	O	O
set	O	O	O	O	O	O
of	O	O	O	O	O	O
signatures	O	O	O	O	O	O
 	O	O	O	O	O	O
deployed	O	O	O	O	O	O
on	O	O	O	O	O	O
Friday	O	O	O	O	O	O
(	O	O	O	O	O	O
May	O	O	B-DATE	O	O	B-DATE
12	O	O	I-DATE	O	O	I-DATE
)	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
executable	O	O	O	O	O	O
contains	O	O	O	O	O	O
a	O	O	O	O	O	O
password-protected	O	O	O	O	O	O
resource	O	O	O	O	O	O
section	O	O	O	O	O	O
containing	O	O	O	O	O	O
configuration	O	O	O	O	O	O
data	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
payload	O	O	O	O	O	O
performs	O	O	O	O	O	O
following	O	O	O	O	O	O
activity	O	O	O	O	O	O
when	O	O	O	O	O	O
executed	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
system	O	O	O	O	O	O
:	O	O	O	O	O	O

-	O	O	O	O	O	O
It	O	O	O	O	O	O
uses	O	O	O	O	O	O
a	O	O	O	O	O	O
random	O	O	O	O	O	O
string	O	O	O	O	O	O
,	O	O	O	O	O	O
referred	O	O	O	O	O	O
here	O	O	O	O	O	O
as	O	O	O	O	O	O
RAND	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
Install	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
STRING	O	O	O	O	O	O
(	O	O	O	O	O	O
e.g	O	O	O	O	O	O
-	O	O	O	O	O	O
bcjlwytjyjlj255	O	O	O	O	O	O
)	O	O	O	O	O	O
,	O	O	O	O	O	O
created	O	O	O	O	O	O
based	O	O	O	O	O	O
on	O	O	O	O	O	O
computer	O	O	O	O	O	O
name	O	O	O	O	O	O
and	O	O	O	O	O	O
random	O	O	O	O	O	O
values	O	O	O	O	O	O
 	O	O	O	O	O	O
for	O	O	O	O	O	O
installation	O	O	O	O	O	O
folder	O	O	O	O	O	O
and	O	O	O	O	O	O
service	O	O	O	O	O	O
name	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
!	O	O	O	O	O	O
[	O	O	O	O	O	O
arg_i.PNG	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
downloads	O	O	O	O	O	O
/	O	O	O	O	O	O
blog-image	O	O	O	O	O	O
-	O	O	O	O	O	O
0	O	O	O	O	O	O
-	O	O	O	O	O	O
1501493042	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
6	O	O	O	O	O	O
:	O	O	O	O	O	O
Installation	O	O	O	O	O	O
folder	O	O	O	O	O	O
and	O	O	O	O	O	O
service	O	O	O	O	O	O
name	O	O	O	O	O	O
*	O	O	O	O	O	O

-	O	O	O	O	O	O
If	O	O	O	O	O	O
C	O	O	O	O	O	O
:	O	O	O	O	O	O
\	O	O	O	O	O	O
ProgramData	O	O	O	O	O	O
folder	O	O	O	O	O	O
exists	O	O	O	O	O	O
,	O	O	O	O	O	O
it	O	O	O	O	O	O
creates	O	O	O	O	O	O
a	O	O	O	O	O	O
new	O	O	O	O	O	O
folder	O	O	O	O	O	O
with	O	O	O	O	O	O
name	O	O	O	O	O	O
as	O	O	O	O	O	O
RAND	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
Install	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
STRING	O	O	O	O	O	O
inside	O	O	O	O	O	O
ProgramData	O	O	O	O	O	O
folder	O	O	O	O	O	O
.	O	O	O	O	O	O

Otherwise	O	O	O	O	O	O
,	O	O	O	O	O	O
it	O	O	O	O	O	O
creates	O	O	O	O	O	O
a	O	O	O	O	O	O
folder	O	O	O	O	O	O
"	O	O	O	O	O	O
Intel	B-ORG	O	O	O	O	B-ORG
"	O	O	O	O	O	O
in	O	O	O	O	O	O
<	O	O	O	O	O	O
Window	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
InstallationDrive	O	O	O	O	O	O
>	O	O	O	O	O	O
and	O	O	O	O	O	O
a	O	O	O	O	O	O
sub-folder	O	O	O	O	O	O
with	O	O	O	O	O	O
a	O	O	O	O	O	O
random	O	O	O	O	O	O
name	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
both	O	O	O	O	O	O
cases	O	O	O	O	O	O
it	O	O	O	O	O	O
copies	O	O	O	O	O	O
itself	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
name	O	O	O	O	O	O
*	O	O	O	O	O	O
tasksche.exe	O	O	O	O	O	O
*	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
!	O	O	O	O	O	O
[	O	O	O	O	O	O
copy_itself.PNG	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
downloads	O	O	O	O	O	O
/	O	O	O	O	O	O
blog-image	O	O	O	O	O	O
-	O	O	O	O	O	O
1	O	O	O	O	O	O
-	O	O	O	O	O	O
1501493042	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
7	O	O	O	O	O	O
:	O	O	O	O	O	O
Installation	O	O	O	O	O	O
folder	O	O	O	O	O	O
and	O	O	O	O	O	O
payload	O	O	O	O	O	O
*	O	O	O	O	O	O

-	O	O	O	O	O	O
It	O	O	O	O	O	O
checks	O	O	O	O	O	O
if	O	O	O	O	O	O
there	O	O	O	O	O	O
is	O	O	O	O	O	O
a	O	O	O	O	O	O
service	O	O	O	O	O	O
with	O	O	O	O	O	O
name	O	O	O	O	O	O
RAND	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
Install	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
STRING	O	O	O	O	O	O
;	O	O	O	O	O	O
 	O	O	O	O	O	O
if	O	O	O	O	O	O
not	O	O	O	O	O	O
it	O	O	O	O	O	O
creates	O	O	O	O	O	O
a	O	O	O	O	O	O
 	O	O	O	O	O	O
service	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
name	O	O	O	O	O	O
RAND	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
Install	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
STRING	O	O	O	O	O	O
and	O	O	O	O	O	O
starts	O	O	O	O	O	O
it	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
!	O	O	O	O	O	O
[	O	O	O	O	O	O
creating_service.PNG	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
downloads	O	O	O	O	O	O
/	O	O	O	O	O	O
blog-image	O	O	O	O	O	O
-	O	O	O	O	O	O
2	O	O	O	O	O	O
-	O	O	O	O	O	O
1501493043	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
8	O	O	O	O	O	O
:	O	O	O	O	O	O
New	O	O	O	O	O	O
process	O	O	O	O	O	O
to	O	O	O	O	O	O
run	O	O	O	O	O	O
the	O	O	O	O	O	O
dropped	O	O	O	O	O	O
executable	O	O	O	O	O	O
*	O	O	O	O	O	O

-	O	O	O	O	O	O
 	O	O	O	O	O	O
CIt	O	O	O	O	O	O
creates	O	O	O	O	O	O
a	O	O	O	O	O	O
registry	O	O	O	O	O	O
key	O	O	O	O	O	O
with	O	O	O	O	O	O
name	O	O	O	O	O	O
"	O	O	O	O	O	O
WanaCrypt0r	O	O	O	O	O	O
"	O	O	O	O	O	O
to	O	O	O	O	O	O
store	O	O	O	O	O	O
the	O	O	O	O	O	O
installation	O	O	O	O	O	O
path	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
!	O	O	O	O	O	O
[	O	O	O	O	O	O
wd_regkey.PNG	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
downloads	O	O	O	O	O	O
/	O	O	O	O	O	O
blog-image	O	O	O	O	O	O
-	O	O	O	O	O	O
3	O	O	O	O	O	O
-	O	O	O	O	O	O
1501493043	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
9	O	O	O	O	O	O
:	O	O	O	O	O	O
Registry	O	O	O	O	O	O
entry	O	O	O	O	O	O
to	O	O	O	O	O	O
store	O	O	O	O	O	O
installation	O	O	O	O	O	O
path	O	O	O	O	O	O
*	O	O	O	O	O	O

-	O	O	O	O	O	O
The	O	O	O	O	O	O
malware	O	O	O	O	O	O
has	O	O	O	O	O	O
all	O	O	O	O	O	O
its	O	O	O	O	O	O
config	O	O	O	O	O	O
data	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
resource	O	O	O	O	O	O
section	O	O	O	O	O	O
and	O	O	O	O	O	O
the	O	O	O	O	O	O
password	O	O	O	O	O	O
is	O	O	O	O	O	O
“	O	O	O	O	O	O
[	O	O	O	O	O	O
[	O	O	O	O	O	O
email	O	O	O	O	O	O
 	O	O	O	O	O	O
protected	O	O	O	O	O	O
]	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
l	O	O	O	O	O	O
/	O	O	O	O	O	O
email-protection	O	O	O	O	O	O
)	O	O	O	O	O	O
”	O	O	O	O	O	O
 	O	O	O	O	O	O
These	O	O	O	O	O	O
additional	O	O	O	O	O	O
components	O	O	O	O	O	O
are	O	O	O	O	O	O
extracted	O	O	O	O	O	O
from	O	O	O	O	O	O
resource	O	O	O	O	O	O
section	O	O	O	O	O	O
"	O	O	O	O	O	O
XIA	O	O	O	O	O	O
"	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
current	O	O	O	O	O	O
execution	O	O	O	O	O	O
path	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
!	O	O	O	O	O	O
[	O	O	O	O	O	O
dropped_files.PNG	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
downloads	O	O	O	O	O	O
/	O	O	O	O	O	O
blog-image	O	O	O	O	O	O
-	O	O	O	O	O	O
4	O	O	O	O	O	O
-	O	O	O	O	O	O
1501493043	O	O	O	O	O	O
.	O	O	O	O	O	O
png	O	O	O	O	O	O
)	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
10	O	O	O	O	O	O
:	O	O	O	O	O	O
Additional	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
resources	O	O	O	O	O	O
including	O	O	O	O	O	O
ransom	O	O	O	O	O	O
note	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
-	O	O	O	O	O	O
*	O	O	O	O	O	O
 	O	O	O	O	O	O
The	O	O	O	O	O	O
ransom	O	O	O	O	O	O
note	O	O	O	O	O	O
is	O	O	O	O	O	O
embedded	O	O	O	O	O	O
in	O	O	O	O	O	O
28	O	O	O	O	O	O
different	O	O	O	O	O	O
languages	O	O	O	O	O	O
inside	O	O	O	O	O	O
the	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
payload	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
wannacrypt	O	O	O	O	O	O
/	O	O	O	O	O	O
WannaCry_multiplelanguage_support.PNG	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
11	O	O	O	O	O	O
:	O	O	O	O	O	O
Ransom	O	O	O	O	O	O
note	O	O	O	O	O	O
in	O	O	O	O	O	O
multiple	O	O	O	O	O	O
languages	O	O	O	O	O	O
*	O	O	O	O	O	O

-	O	O	O	O	O	O
It	O	O	O	O	O	O
loads	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
DLL	O	O	O	O	O	O
and	O	O	O	O	O	O
starts	O	O	O	O	O	O
the	O	O	O	O	O	O
file	O	O	O	O	O	O
encryption	O	O	O	O	O	O
process	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
victim's	O	O	O	O	O	O
machine	O	O	O	O	O	O
.	O	O	O	O	O	O

It	O	O	O	O	O	O
will	O	O	O	O	O	O
look	O	O	O	O	O	O
for	O	O	O	O	O	O
user	O	O	O	O	O	O
files	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
extensions	O	O	O	O	O	O
to	O	O	O	O	O	O
encrypt	O	O	O	O	O	O
:	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
.	O	O	O	O	O	O
lay6	O	O	O	O	O	O
.	O	O	O	O	O	O
sqlite3	O	O	O	O	O	O
.	O	O	O	O	O	O
sqlitedb	O	O	O	O	O	O
.	O	O	O	O	O	O
accdb	O	O	O	O	O	O
.	O	O	O	O	O	O
java	O	O	O	O	O	O
.	O	O	O	O	O	O
class	O	O	O	O	O	O
.	O	O	O	O	O	O
mpeg	O	O	O	O	O	O
.	O	O	O	O	O	O
djvu	O	O	O	O	O	O
.	O	O	O	O	O	O
tiff	O	O	O	O	O	O
.	O	O	O	O	O	O
jpeg	O	O	O	O	O	O
.	O	O	O	O	O	O
backup	O	O	O	O	O	O
.	O	O	O	O	O	O
vmdk	O	O	O	O	O	O
.	O	O	O	O	O	O
sldm	O	O	O	O	O	O
.	O	O	O	O	O	O
sldx	O	O	O	O	O	O
.	O	O	O	O	O	O
onetoc2	O	O	O	O	O	O
.	O	O	O	O	O	O
vsdx	O	O	O	O	O	O
.	O	O	O	O	O	O
potm	O	O	O	O	O	O
.	O	O	O	O	O	O
potx	O	O	O	O	O	O
.	O	O	O	O	O	O
ppam	O	O	O	O	O	O
.	O	O	O	O	O	O
ppsx	O	O	O	O	O	O
.	O	O	O	O	O	O
ppsm	O	O	O	O	O	O

.	O	O	O	O	O	O
pptm	O	O	O	O	O	O
.	O	O	O	O	O	O
pptx	O	O	O	O	O	O
.	O	O	O	O	O	O
xltm	O	O	O	O	O	O
.	O	O	O	O	O	O
xltx	O	O	O	O	O	O
.	O	O	O	O	O	O
xlsb	O	O	O	O	O	O
.	O	O	O	O	O	O
xlsm	O	O	O	O	O	O
.	O	O	O	O	O	O
xlsx	O	O	O	O	O	O
.	O	O	O	O	O	O
dotx	O	O	O	O	O	O
.	O	O	O	O	O	O
dotm	O	O	O	O	O	O
.	O	O	O	O	O	O
docm	O	O	O	O	O	O
.	O	O	O	O	O	O
docb	O	O	O	O	O	O
.	O	O	O	O	O	O
docx	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
files	O	O	O	O	O	O
are	O	O	O	O	O	O
renamed	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
 	O	O	O	O	O	O
*	O	O	O	O	O	O
“	O	O	O	O	O	O
.	O	O	O	O	O	O
wnry	O	O	O	O	O	O
”	O	O	O	O	O	O
*	O	O	O	O	O	O
extension	O	O	O	O	O	O
and	O	O	O	O	O	O
the	O	O	O	O	O	O
ransom	O	O	O	O	O	O
instructions	O	O	O	O	O	O
are	O	O	O	O	O	O
in	O	O	O	O	O	O
text	O	O	O	O	O	O
file	O	O	O	O	O	O
name	O	O	O	O	O	O
*	O	O	O	O	O	O
“	O	O	O	O	O	O
@	O	O	O	O	O	O
[	O	O	O	O	O	O
[	O	O	O	O	O	O
email	O	O	O	O	O	O
 	O	O	O	O	O	O
protected	O	O	O	O	O	O
]	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
l	O	O	O	O	O	O
/	O	O	O	O	O	O
email-protection	O	O	O	O	O	O
)	O	O	O	O	O	O
”	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
downloads	O	O	O	O	O	O
/	O	O	O	O	O	O
blog-image	O	O	O	O	O	O
-	O	O	O	O	O	O
5	O	O	O	O	O	O
-	O	O	O	O	O	O
1501493043	O	O	O	O	O	O
.	O	O	O	O	O	O
jpeg	O	O	O	O	O	O
)	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
12	O	O	O	O	O	O
:	O	O	O	O	O	O
WannaCry	O	O	O	O	O	O
ransom	O	O	O	O	O	O
note	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Conclusion	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

Several	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
outbreaks	O	O	O	O	O	O
started	O	O	O	O	O	O
in	O	O	O	O	O	O
2016	O	O	B-DATE	O	O	B-DATE
and	O	O	O	O	O	O
we	O	O	O	O	O	O
have	O	O	O	O	O	O
seen	O	O	O	O	O	O
dozens	O	O	O	O	O	O
of	O	O	O	O	O	O
new	O	O	O	O	O	O
strains	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
past	O	O	B-DATE	O	O	B-DATE
year	O	O	I-DATE	O	O	I-DATE
and	O	O	O	O	O	O
a	O	O	O	O	O	O
half	O	O	O	O	O	O
.	O	O	O	O	O	O

However	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
delivery	O	O	O	O	O	O
vector	O	O	O	O	O	O
seen	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
case	O	O	O	O	O	O
of	O	O	O	O	O	O
WannaCrypt	O	O	O	O	O	O
2.0	O	O	O	O	O	O
makes	O	O	O	O	O	O
it	O	O	O	O	O	O
highly	O	O	O	O	O	O
virulent	O	O	O	O	O	O
and	O	O	O	O	O	O
successful	O	O	O	O	O	O
in	O	O	O	O	O	O
impacting	O	O	O	O	O	O
thousands	O	O	O	O	O	O
of	O	O	O	O	O	O
users	O	O	O	O	O	O
in	O	O	O	O	O	O
a	O	O	O	O	O	O
short	O	O	O	O	O	O
time	O	O	O	O	O	O
frame	O	O	O	O	O	O
.	O	O	O	O	O	O

We	O	O	O	O	O	O
will	O	O	O	O	O	O
continue	O	O	O	O	O	O
to	O	O	O	O	O	O
see	O	O	O	O	O	O
newer	O	O	O	O	O	O
delivery	O	O	O	O	O	O
vectors	O	O	O	O	O	O
and	O	O	O	O	O	O
various	O	O	O	O	O	O
copy-cat	O	O	O	O	O	O
strains	O	O	O	O	O	O
of	O	O	O	O	O	O
this	O	O	O	O	O	O
malware	O	O	O	O	O	O
 	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
coming	O	O	O	O	O	O
weeks	O	O	O	O	O	O
,	O	O	O	O	O	O
given	O	O	O	O	O	O
the	O	O	O	O	O	O
global	O	O	O	O	O	O
impact	O	O	O	O	O	O
this	O	O	O	O	O	O
has	O	O	O	O	O	O
had	O	O	O	O	O	O
.	O	O	O	O	O	O

Zscaler	B-ORG	O	O	O	O	B-ORG
ThreatLabZ	O	O	O	O	O	O
is	O	O	O	O	O	O
actively	O	O	O	O	O	O
monitoring	O	O	O	O	O	O
this	O	O	O	O	O	O
threat	O	O	O	O	O	O
and	O	O	O	O	O	O
will	O	O	O	O	O	O
continue	O	O	O	O	O	O
to	O	O	O	O	O	O
ensure	O	O	O	O	O	O
coverage	O	O	O	O	O	O
for	O	O	O	O	O	O
Zscaler	B-ORG	O	O	O	O	B-ORG
customers	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Acknowledgement	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

Abhaykant	O	O	O	O	O	O
Yadav	O	O	O	O	O	O
,	O	O	O	O	O	O
Amandeep	O	O	O	O	O	O
Kumar	O	O	O	O	O	O
,	O	O	O	O	O	O
Nirmal	O	O	O	O	O	O
Singh	O	O	O	O	O	O
for	O	O	O	O	O	O
helping	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
analysis	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Indicators	O	O	O	O	O	O
of	O	O	O	O	O	O
compromise	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
MD5	O	O	O	O	O	O
hash	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

84c82835a5d21bbcf75a61706d8ab549	O	O	O	O	O	O

7f7ccaa16fb15eb1c7399d422f8363e8	O	O	O	O	O	O

2b4e8612d9f8cdcf520a8b2e42779ffa	O	O	O	O	O	O

509c41ec97bb81b0567b059aa2f50fe8	O	O	O	O	O	O

835fff032c51075c0c27946f6ebd64a3	O	O	O	O	O	O

86721e64ffbd69aa6944b9672bcabb6d	O	O	O	O	O	O

f9cee5e75b7f1298aece9145ea80a1d2	O	O	O	O	O	O

b7f7ad4970506e8547e0f493c80ba441	O	O	O	O	O	O

c61256583c6569ac13a136bfd440ca09	O	O	O	O	O	O

f9992dfb56a9c6c20eb727e6a26b0172	O	O	O	O	O	O

d6114ba5f10ad67a4131ab72531f02da	O	O	O	O	O	O

