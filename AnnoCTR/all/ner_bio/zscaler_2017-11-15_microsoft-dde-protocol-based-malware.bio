<DOCSTART>	O	O	O	O	O	O

Microsoft	B-ORG	O	O	O	O	B-ORG
DDE	O	O	O	O	O	O
protocol	O	O	O	O	O	O
based	O	O	O	O	O	O
malware	O	O	O	O	O	O
attacks	O	O	O	O	O	O

November	O	O	B-DATE	O	O	B-DATE
15	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2017	O	O	I-DATE	O	O	I-DATE

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Introduction	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

Over	O	O	O	O	O	O
the	O	O	O	O	O	O
past	O	O	O	O	O	O
few	O	O	O	O	O	O
weeks	O	O	O	O	O	O
,	O	O	O	O	O	O
there	O	O	O	O	O	O
have	O	O	O	O	O	O
been	O	O	O	O	O	O
several	O	O	O	O	O	O
reports	O	O	O	O	O	O
about	O	O	O	O	O	O
the	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Dynamic	O	O	O	O	O	O
Data	O	O	O	O	O	O
Exchange	O	O	O	O	O	O
(	O	O	O	O	O	O
DDE	O	O	O	O	O	O
)	O	O	O	O	O	O
vulnerability	O	O	O	O	O	O
.	O	O	O	O	O	O

To	O	O	O	O	O	O
no	O	O	O	O	O	O
one's	O	O	O	O	O	O
surprise	O	O	O	O	O	O
,	O	O	O	O	O	O
hackers	O	O	O	O	O	O
have	O	O	O	O	O	O
been	O	O	O	O	O	O
quick	O	O	O	O	O	O
to	O	O	O	O	O	O
exploit	O	O	O	O	O	O
this	O	O	O	O	O	O
vulnerability	O	O	O	O	O	O
to	O	O	O	O	O	O
spread	O	O	O	O	O	O
malware	O	O	O	O	O	O
through	O	O	O	O	O	O
rigged	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Word	O	O	O	O	O	O
documents	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
this	O	O	O	O	O	O
same	O	O	O	O	O	O
timeframe	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
Zscaler	B-ORG	O	O	O	O	B-ORG
ThreatLabZ	O	O	O	O	O	O
team	O	O	O	O	O	O
has	O	O	O	O	O	O
seen	O	O	O	O	O	O
a	O	O	O	O	O	O
number	O	O	O	O	O	O
of	O	O	O	O	O	O
these	O	O	O	O	O	O
malicious	O	O	O	O	O	O
documents	O	O	O	O	O	O
using	O	O	O	O	O	O
the	O	O	O	O	O	O
DDE	O	O	O	O	O	O
vulnerability	O	O	O	O	O	O
to	O	O	O	O	O	O
download	O	O	O	O	O	O
and	O	O	O	O	O	O
execute	O	O	O	O	O	O
malware	O	O	O	O	O	O
.	O	O	O	O	O	O

Most	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
payloads	O	O	O	O	O	O
we	O	O	O	O	O	O
saw	O	O	O	O	O	O
were	O	O	O	O	O	O
Remote	O	O	O	O	O	O
Access	O	O	O	O	O	O
Trojans	O	O	O	O	O	O
(	O	O	O	O	O	O
RATs	O	O	O	O	O	O
)	O	O	O	O	O	O
,	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
backdoors	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
this	O	O	O	O	O	O
blog	O	O	O	O	O	O
,	O	O	O	O	O	O
we	O	O	O	O	O	O
will	O	O	O	O	O	O
share	O	O	O	O	O	O
a	O	O	O	O	O	O
detailed	O	O	O	O	O	O
technical	O	O	O	O	O	O
analysis	O	O	O	O	O	O
of	O	O	O	O	O	O
a	O	O	O	O	O	O
few	O	O	O	O	O	O
of	O	O	O	O	O	O
these	O	O	O	O	O	O
exploitations	O	O	O	O	O	O
and	O	O	O	O	O	O
their	O	O	O	O	O	O
payloads	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Background	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Dynamic	O	O	O	O	O	O
Data	O	O	O	O	O	O
Exchange	O	O	O	O	O	O
(	O	O	O	O	O	O
DDE	O	O	O	O	O	O
)	O	O	O	O	O	O
protocol	O	O	O	O	O	O
allows	O	O	O	O	O	O
data	O	O	O	O	O	O
to	O	O	O	O	O	O
be	O	O	O	O	O	O
transferred	O	O	O	O	O	O
between	O	O	O	O	O	O
applications	O	O	O	O	O	O
.	O	O	O	O	O	O

These	O	O	O	O	O	O
applications	O	O	O	O	O	O
can	O	O	O	O	O	O
use	O	O	O	O	O	O
DDE	O	O	O	O	O	O
for	O	O	O	O	O	O
one-time	O	O	O	O	O	O
data	O	O	O	O	O	O
transfers	O	O	O	O	O	O
or	O	O	O	O	O	O
for	O	O	O	O	O	O
continuous	O	O	O	O	O	O
exchanges	O	O	O	O	O	O
;	O	O	O	O	O	O
for	O	O	O	O	O	O
example	O	O	O	O	O	O
,	O	O	O	O	O	O
a	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Word	O	O	O	O	O	O
document	O	O	O	O	O	O
that	O	O	O	O	O	O
uses	O	O	O	O	O	O
data	O	O	O	O	O	O
from	O	O	O	O	O	O
an	O	O	O	O	O	O
Excel	O	O	O	O	O	O
spreadsheet	O	O	O	O	O	O
is	O	O	O	O	O	O
updated	O	O	O	O	O	O
automatically	O	O	O	O	O	O
through	O	O	O	O	O	O
DDE	O	O	O	O	O	O
as	O	O	O	O	O	O
the	O	O	O	O	O	O
spreadsheet	O	O	O	O	O	O
data	O	O	O	O	O	O
is	O	O	O	O	O	O
updated	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
DDE	O	O	O	O	O	O
protocol	O	O	O	O	O	O
sends	O	O	O	O	O	O
messages	O	O	O	O	O	O
between	O	O	O	O	O	O
applications	O	O	O	O	O	O
that	O	O	O	O	O	O
share	O	O	O	O	O	O
data	O	O	O	O	O	O
and	O	O	O	O	O	O
uses	O	O	O	O	O	O
shared	O	O	O	O	O	O
memory	O	O	O	O	O	O
to	O	O	O	O	O	O
exchange	O	O	O	O	O	O
data	O	O	O	O	O	O
between	O	O	O	O	O	O
the	O	O	O	O	O	O
applications	O	O	O	O	O	O
.	O	O	O	O	O	O

Microsoft	B-ORG	O	O	O	O	B-ORG
Word	O	O	O	O	O	O
documents	O	O	O	O	O	O
have	O	O	O	O	O	O
been	O	O	O	O	O	O
used	O	O	O	O	O	O
before	O	O	O	O	O	O
to	O	O	O	O	O	O
spread	O	O	O	O	O	O
malware	O	O	O	O	O	O
,	O	O	O	O	O	O
but	O	O	O	O	O	O
in	O	O	O	O	O	O
those	O	O	O	O	O	O
cases	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
would	O	O	O	O	O	O
have	O	O	O	O	O	O
to	O	O	O	O	O	O
manually	O	O	O	O	O	O
enable	O	O	O	O	O	O
macros	O	O	O	O	O	O
for	O	O	O	O	O	O
the	O	O	O	O	O	O
payload	O	O	O	O	O	O
to	O	O	O	O	O	O
be	O	O	O	O	O	O
downloaded	O	O	O	O	O	O
onto	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
system	O	O	O	O	O	O
.	O	O	O	O	O	O

With	O	O	O	O	O	O
the	O	O	O	O	O	O
DDE	O	O	O	O	O	O
vulnerability	O	O	O	O	O	O
(	O	O	O	O	O	O
feature	O	O	O	O	O	O
)	O	O	O	O	O	O
in	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Word	O	O	O	O	O	O
,	O	O	O	O	O	O
attackers	O	O	O	O	O	O
can	O	O	O	O	O	O
embed	O	O	O	O	O	O
a	O	O	O	O	O	O
malicious	O	O	O	O	O	O
script	O	O	O	O	O	O
that	O	O	O	O	O	O
can	O	O	O	O	O	O
download	O	O	O	O	O	O
and	O	O	O	O	O	O
execute	O	O	O	O	O	O
malware	O	O	O	O	O	O
without	O	O	O	O	O	O
the	O	O	O	O	O	O
use	O	O	O	O	O	O
of	O	O	O	O	O	O
macros	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Case	O	O	O	O	O	O
I	O	O	O	O	O	O
:	O	O	O	O	O	O
DDE	O	O	O	O	O	O
protocol	O	O	O	O	O	O
abuse	O	O	O	O	O	O
leads	O	O	O	O	O	O
to	O	O	O	O	O	O
post-exploitation	O	O	O	O	O	O
using	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

One	O	O	O	O	O	O
Word	O	O	O	O	O	O
file	O	O	O	O	O	O
we	O	O	O	O	O	O
analyzed	O	O	O	O	O	O
exploited	O	O	O	O	O	O
the	O	O	O	O	O	O
DDE	O	O	O	O	O	O
vulnerability	O	O	O	O	O	O
to	O	O	O	O	O	O
download	O	O	O	O	O	O
and	O	O	O	O	O	O
execute	O	O	O	O	O	O
a	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
script	O	O	O	O	O	O
using	O	O	O	O	O	O
a	O	O	O	O	O	O
post-exploitation	O	O	O	O	O	O
framework	O	O	O	O	O	O
.	O	O	O	O	O	O

Filename	O	O	O	O	O	O
-	O	O	O	O	O	O
Communications	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
Suggestions	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
by	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
Press	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
Office	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
Director.docx	O	O	O	O	O	O

The	O	O	O	O	O	O
document	O	O	O	O	O	O
looks	O	O	O	O	O	O
like	O	O	O	O	O	O
this	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh6	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
uCLxeiNYMIPGj-B8GH-f	O	O	O	O	O	O
_	O	O	O	O	O	O
2pme5oHFmd3mKIgAt_EIKpFJARXF3JeVEipsMtfbDy92yjxQw0	O	O	O	O	O	O
-	O	O	O	O	O	O
wJzRzpYK0Qp2JdgoHFsvINJ4twkbJhOzB-Q75ra2YQARFwx6Gm7	O	O	O	O	O	O
_	O	O	O	O	O	O
a1akywEV40k	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig1	O	O	O	O	O	O
:	O	O	O	O	O	O
 	O	O	O	O	O	O
Malicious	O	O	O	O	O	O
document	O	O	O	O	O	O

Generally	O	O	O	O	O	O
,	O	O	O	O	O	O
fake	O	O	O	O	O	O
documents	O	O	O	O	O	O
like	O	O	O	O	O	O
this	O	O	O	O	O	O
are	O	O	O	O	O	O
spread	O	O	O	O	O	O
via	O	O	O	O	O	O
an	O	O	O	O	O	O
email	O	O	O	O	O	O
campaign	O	O	O	O	O	O
targeting	O	O	O	O	O	O
small	O	O	O	O	O	O
and	O	O	O	O	O	O
large	O	O	O	O	O	O
groups	O	O	O	O	O	O
of	O	O	O	O	O	O
businesses	O	O	O	O	O	O
in	O	O	O	O	O	O
numerous	O	O	O	O	O	O
industry	B-SECTOR	O	O	O	O	B-SECTOR
sectors	I-SECTOR	O	O	O	O	I-SECTOR
.	O	O	O	O	O	O

The	O	O	O	O	O	O
workflow	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
document	O	O	O	O	O	O
is	O	O	O	O	O	O
as	O	O	O	O	O	O
follows	O	O	O	O	O	O
:	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh3	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
krH7IKZGmdxp4OOl1tBa7qowcbjW20ib9UPVWiBh_R-yqsS	O	O	O	O	O	O
_	O	O	O	O	O	O
_	O	O	O	O	O	O
jKjeASGyoT3vPkIDeqzYNZLg95QWN6nRd8mdZPtSRDCcSxLBoDC1zld278	O	O	O	O	O	O
_	O	O	O	O	O	O
vhkusZAZyXI6FOng-IGZPeL_Pxk	O	O	O	O	O	O
)	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

Fig2	O	O	O	O	O	O
:	O	O	O	O	O	O
 	O	O	O	O	O	O
Document	O	O	O	O	O	O
Workflow	O	O	O	O	O	O
(	O	O	O	O	O	O
case	O	O	O	O	O	O
I	O	O	O	O	O	O
)	O	O	O	O	O	O

In	O	O	O	O	O	O
this	O	O	O	O	O	O
document	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
attacker	O	O	O	O	O	O
uses	O	O	O	O	O	O
the	O	O	O	O	O	O
DDE	O	O	O	O	O	O
protocol	O	O	O	O	O	O
to	O	O	O	O	O	O
launch	O	O	O	O	O	O
a	O	O	O	O	O	O
Windows	O	O	O	O	O	O
command	O	O	O	O	O	O
line	O	O	O	O	O	O
tool	O	O	O	O	O	O
(	O	O	O	O	O	O
cmd.exe	O	O	O	O	O	O
)	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
uses	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
to	O	O	O	O	O	O
download	O	O	O	O	O	O
and	O	O	O	O	O	O
execute	O	O	O	O	O	O
the	O	O	O	O	O	O
malware	O	O	O	O	O	O
from	O	O	O	O	O	O
a	O	O	O	O	O	O
given	O	O	O	O	O	O
URL	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
field	O	O	O	O	O	O
content	O	O	O	O	O	O
looks	O	O	O	O	O	O
like	O	O	O	O	O	O
this	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh6	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
4VDkc22sGvTQpWpo786	O	O	O	O	O	O
-	O	O	O	O	O	O
RVjI2DIm_NzLdzqgFMxdg2gMgKBtQbqZi_hbv8VyTaA2O6jrvmuDJakZ48YBsS0tk7Xe2snExOVOYbF5YeamZ_UH9jJYyExnc9utRrXhhEUOQ2Yg8dE	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig3	O	O	O	O	O	O
:	O	O	O	O	O	O
DDE	O	O	O	O	O	O
field	O	O	O	O	O	O
code	O	O	O	O	O	O

It	O	O	O	O	O	O
downloads	O	O	O	O	O	O
and	O	O	O	O	O	O
executes	O	O	O	O	O	O
a	O	O	O	O	O	O
file	O	O	O	O	O	O
using	O	O	O	O	O	O
cmd.exe	O	O	O	O	O	O
and	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
is	O	O	O	O	O	O
present	O	O	O	O	O	O
at	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
URL	O	O	O	O	O	O
:	O	O	O	O	O	O
hxxp	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
citycarpark	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
my	O	O	O	O	O	O
/	O	O	O	O	O	O
components	O	O	O	O	O	O
/	O	O	O	O	O	O
com	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
admintools	O	O	O	O	O	O
/	O	O	O	O	O	O
mscorier	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
downloaded	O	O	O	O	O	O
data	O	O	O	O	O	O
(	O	O	O	O	O	O
mscorier	O	O	O	O	O	O
)	O	O	O	O	O	O
is	O	O	O	O	O	O
an	O	O	O	O	O	O
obfuscated	O	O	O	O	O	O
batch	O	O	O	O	O	O
script	O	O	O	O	O	O
that	O	O	O	O	O	O
creates	O	O	O	O	O	O
a	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
script	O	O	O	O	O	O
and	O	O	O	O	O	O
executes	O	O	O	O	O	O
it	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh5	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
mlyiDsXz_S	O	O	O	O	O	O
-	O	O	O	O	O	O
0kmf1mbvYJ6mnAIZ3	O	O	O	O	O	O
-	O	O	O	O	O	O
ylhnFWYDUI91MpYvikRxn1LPfJoM2BrpbWAjnmGcVO8Yo0BYVQlWpEucbBRL46rXOzmXrLhtjf4gLpxqXGGkm6gdK_Jc0GHUoglzqKAszc	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig4	O	O	O	O	O	O
:	O	O	O	O	O	O
Obfuscated	O	O	O	O	O	O
batch	O	O	O	O	O	O
script	O	O	O	O	O	O
(	O	O	O	O	O	O
payload	O	O	O	O	O	O
1	O	O	O	O	O	O
)	O	O	O	O	O	O

This	O	O	O	O	O	O
script	O	O	O	O	O	O
downloads	O	O	O	O	O	O
another	O	O	O	O	O	O
payload	O	O	O	O	O	O
(	O	O	O	O	O	O
wsdprintproxy	O	O	O	O	O	O
)	O	O	O	O	O	O
from	O	O	O	O	O	O
hxxp	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
185.128.42	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
194	O	O	O	O	O	O
/	O	O	O	O	O	O
wsdprintproxy	O	O	O	O	O	O
and	O	O	O	O	O	O
stores	O	O	O	O	O	O
it	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
registry	O	O	O	O	O	O
to	O	O	O	O	O	O
make	O	O	O	O	O	O
itself	O	O	O	O	O	O
persistent	O	O	O	O	O	O
:	O	O	O	O	O	O

HKCU	O	O	O	O	O	O
:	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
Software	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
Microsoft	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
Windows	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
CurrentVersion	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
Themes	O	O	O	O	O	O
\	O	O	O	O	O	O
\	O	O	O	O	O	O
ThemeVersion	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh4	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
B8GIYsv5Oom42gSKm91q26SVur5jpL1Wr4iLqKCjhprzmBUkBArvc1jWM_Me52VycWNclo7gHXLNTvFSVb2JDONqWIJ9UahOmm5Yw6F5QmvsweWWs5voCEj70787LFT315ifdMs	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig5	O	O	O	O	O	O
:	O	O	O	O	O	O
Storing	O	O	O	O	O	O
payload	O	O	O	O	O	O
2	O	O	O	O	O	O
in	O	O	O	O	O	O
registry	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh3	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
cn7W6Ak640ZwgLQVBLZT3bzZM6XHWaHW0PdMScrpv-RfWqkoPj8h8KVCh0DpaMhwGiPHoY0	O	O	O	O	O	O
_	O	O	O	O	O	O
P9ozXetVBBYgzg7uSw_gngHKdPM-WqHqsCHmW07DuyckKULcri92hTsff5n7IRc	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig6	O	O	O	O	O	O
:	O	O	O	O	O	O
Registry	O	O	O	O	O	O
entry	O	O	O	O	O	O
of	O	O	O	O	O	O
payload	O	O	O	O	O	O
2	O	O	O	O	O	O

For	O	O	O	O	O	O
persistence	O	O	O	O	O	O
,	O	O	O	O	O	O
payload	O	O	O	O	O	O
1	O	O	O	O	O	O
also	O	O	O	O	O	O
creates	O	O	O	O	O	O
two	O	O	O	O	O	O
scheduled	O	O	O	O	O	O
tasks	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
execute	O	O	O	O	O	O
the	O	O	O	O	O	O
obfuscated	O	O	O	O	O	O
script	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh4	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
N2m-Z	O	O	O	O	O	O
_	O	O	O	O	O	O
27Qcb_ztuAn6tw48MAIFx3jSDPju4V7oO4ItJMSQ4Dx-WK2s5155VNCxPhN2CkM3bC6TslIP9Yfrb7CH	O	O	O	O	O	O
_	O	O	O	O	O	O
4HNp4BbxkeRMtCzSRIVc143L0BFGN7HBePdfcUiT-YMTKKfQ	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig7	O	O	O	O	O	O
:	O	O	O	O	O	O
Code	O	O	O	O	O	O
for	O	O	O	O	O	O
persistence	O	O	O	O	O	O

One	O	O	O	O	O	O
scheduled	O	O	O	O	O	O
task	O	O	O	O	O	O
is	O	O	O	O	O	O
created	O	O	O	O	O	O
with	O	O	O	O	O	O
name	O	O	O	O	O	O
FlashUpdateServiceInit	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
runs	O	O	O	O	O	O
daily	O	O	O	O	O	O
at	O	O	O	O	O	O
11	O	O	O	O	O	O
:	O	O	O	O	O	O
00	O	O	O	O	O	O
a.m	O	O	O	O	O	O
.	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
another	O	O	O	O	O	O
task	O	O	O	O	O	O
with	O	O	O	O	O	O
name	O	O	O	O	O	O
FlashUpdateService	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
runs	O	O	O	O	O	O
daily	O	O	O	O	O	O
at	O	O	O	O	O	O
3	O	O	O	O	O	O
:	O	O	O	O	O	O
00	O	O	O	O	O	O
p.m	O	O	O	O	O	O
.	O	O	O	O	O	O

After	O	O	O	O	O	O
these	O	O	O	O	O	O
tasks	O	O	O	O	O	O
run	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
script	O	O	O	O	O	O
bypasses	O	O	O	O	O	O
the	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
ScriptBlock	O	O	O	O	O	O
logging	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
means	O	O	O	O	O	O
that	O	O	O	O	O	O
the	O	O	O	O	O	O
first	O	O	O	O	O	O
execution	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
malicious	O	O	O	O	O	O
script	O	O	O	O	O	O
will	O	O	O	O	O	O
turn	O	O	O	O	O	O
off	O	O	O	O	O	O
all	O	O	O	O	O	O
further	O	O	O	O	O	O
logging	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh6	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
5LauSa8UPsGMAJup_pHw0KaX3rOQmflYFtPS1GyfiBhSd_stu3gGPdb5O_EOBPpTlavvTsT9	O	O	O	O	O	O
-	O	O	O	O	O	O
rFJUQ	O	O	O	O	O	O
_	O	O	O	O	O	O
_	O	O	O	O	O	O
7Y_FbiOhgH1Rt8yifaHC_p7ph-Wqpxiab_TqeMVhkA9FhIcjzvUFlrM	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig8	O	O	O	O	O	O
:	O	O	O	O	O	O
Enabling	O	O	O	O	O	O
script	O	O	O	O	O	O
block	O	O	O	O	O	O
logging	O	O	O	O	O	O

To	O	O	O	O	O	O
download	O	O	O	O	O	O
its	O	O	O	O	O	O
next	O	O	O	O	O	O
payload	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
malware	O	O	O	O	O	O
initiates	O	O	O	O	O	O
a	O	O	O	O	O	O
GET	O	O	O	O	O	O
request	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
cookie	O	O	O	O	O	O
“	O	O	O	O	O	O
session	O	O	O	O	O	O
=	O	O	O	O	O	O
j4ppw	O	O	O	O	O	O
/	O	O	O	O	O	O
hpWdU	O	O	O	O	O	O
/	O	O	O	O	O	O
l5V3v9eymlAYxmE	O	O	O	O	O	O
=	O	O	O	O	O	O
”	O	O	O	O	O	O
and	O	O	O	O	O	O
downloads	O	O	O	O	O	O
payload	O	O	O	O	O	O
3	O	O	O	O	O	O
from	O	O	O	O	O	O
hxxps	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
185.128.42	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
194	O	O	O	O	O	O
:	O	O	O	O	O	O
8080	O	O	O	O	O	O
/	O	O	O	O	O	O
news.php	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh3	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
-	O	O	O	O	O	O
Zu9eujWTnU3gKxmMOCbMS6G9Yzqis8WgjyRRRQfqqbKZFLpd2e1	O	O	O	O	O	O
-	O	O	O	O	O	O
KOyMlngetLG0lfo0eHSlVVXQKgIIIksm4VDQ1LXsF0I30FjM	O	O	O	O	O	O
_	O	O	O	O	O	O
2lmt6ptJ5C5211ui-jnhWgpTHUbeW2GrA	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig9	O	O	O	O	O	O
:	O	O	O	O	O	O
Downloading	O	O	O	O	O	O
payload	O	O	O	O	O	O
3	O	O	O	O	O	O
from	O	O	O	O	O	O
server	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh5	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
7wlNFcWnZTJd4F6PNMglqXjVhF1kl0iMQmOCvRuJnvVs683giigAuid7EZyKs3GxYAswKsQoeeUA6R7FeZmujLpMgR_FZudspGdJTZiOzCK1OiLAzoexl23uQYujVA33GKxjMxM	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig10	O	O	O	O	O	O
:	O	O	O	O	O	O
Downloaded	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
payload	O	O	O	O	O	O
3	O	O	O	O	O	O

The	O	O	O	O	O	O
downloaded	O	O	O	O	O	O
data	O	O	O	O	O	O
is	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
with	O	O	O	O	O	O
RC4	O	O	O	O	O	O
.	O	O	O	O	O	O

Data	O	O	O	O	O	O
[	O	O	O	O	O	O
0	O	O	O	O	O	O
:	O	O	O	O	O	O
4	O	O	O	O	O	O
]	O	O	O	O	O	O
=	O	O	O	O	O	O
IV	O	O	O	O	O	O

Data	O	O	O	O	O	O
[	O	O	O	O	O	O
4	O	O	O	O	O	O
:	O	O	O	O	O	O
length	O	O	O	O	O	O
(	O	O	O	O	O	O
Data	O	O	O	O	O	O
)	O	O	O	O	O	O
]	O	O	O	O	O	O
=	O	O	O	O	O	O
Encrypted	O	O	O	O	O	O
data	O	O	O	O	O	O

Key	O	O	O	O	O	O
is	O	O	O	O	O	O
hardcoded	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
script	O	O	O	O	O	O
which	O	O	O	O	O	O
is	O	O	O	O	O	O
:	O	O	O	O	O	O

Key	O	O	O	O	O	O
=	O	O	O	O	O	O
“	O	O	O	O	O	O
a231fe7690a85f02eb147f53229c8e02	O	O	O	O	O	O
”	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh3	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
9Ogh_evxYr2HW8ASKyBuddYF48gKDDLR9Ky6vQFe2FNzN7xvWmdF9GR1b-ljFd4W6uo4tGA-GXTnn7MzLOBYWXhQz01FQIjtITo5	O	O	O	O	O	O
_	O	O	O	O	O	O
SUPbvQFfBcze5HmcjqrFJ22Jv9CmlLUO0M	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig11	O	O	O	O	O	O
:	O	O	O	O	O	O
RC4	O	O	O	O	O	O
algorithm	O	O	O	O	O	O

The	O	O	O	O	O	O
script	O	O	O	O	O	O
will	O	O	O	O	O	O
decrypt	O	O	O	O	O	O
the	O	O	O	O	O	O
downloaded	O	O	O	O	O	O
data	O	O	O	O	O	O
.	O	O	O	O	O	O

It	O	O	O	O	O	O
is	O	O	O	O	O	O
,	O	O	O	O	O	O
again	O	O	O	O	O	O
,	O	O	O	O	O	O
a	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
script	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
is	O	O	O	O	O	O
executed	O	O	O	O	O	O
after	O	O	O	O	O	O
decryption	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
decrypted	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
script	O	O	O	O	O	O
sends	O	O	O	O	O	O
the	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
RSA	O	O	O	O	O	O
key	O	O	O	O	O	O
with	O	O	O	O	O	O
“	O	O	O	O	O	O
IV	O	O	O	O	O	O
”	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
server	O	O	O	O	O	O
at	O	O	O	O	O	O
:	O	O	O	O	O	O
hxxps	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
185.128.42	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
194	O	O	O	O	O	O
:	O	O	O	O	O	O
8080	O	O	O	O	O	O
/	O	O	O	O	O	O
news.php	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
response	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
server	O	O	O	O	O	O
sends	O	O	O	O	O	O
the	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
AES	O	O	O	O	O	O
key	O	O	O	O	O	O
to	O	O	O	O	O	O
victim	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
script	O	O	O	O	O	O
fetches	O	O	O	O	O	O
information	O	O	O	O	O	O
from	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
machine	O	O	O	O	O	O
,	O	O	O	O	O	O
encrypts	O	O	O	O	O	O
it	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
AES	O	O	O	O	O	O
key	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
sends	O	O	O	O	O	O
it	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
server	O	O	O	O	O	O
at	O	O	O	O	O	O
:	O	O	O	O	O	O
hxxps	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
185.128.42	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
194	O	O	O	O	O	O
:	O	O	O	O	O	O
8080	O	O	O	O	O	O
/	O	O	O	O	O	O
process.php	O	O	O	O	O	O
.	O	O	O	O	O	O

Nonce	O	O	O	O	O	O
|	O	O	O	O	O	O
Server	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
URL	O	O	O	O	O	O
|	O	O	O	O	O	O
UserDomainName	O	O	O	O	O	O
|	O	O	O	O	O	O
UserName	O	O	O	O	O	O
|	O	O	O	O	O	O
Machine	O	O	O	O	O	O
|	O	O	O	O	O	O
IPAddress	O	O	O	O	O	O
|	O	O	O	O	O	O
OperatingSystem	O	O	O	O	O	O
|	O	O	O	O	O	O
True	O	O	O	O	O	O
(	O	O	O	O	O	O
if	O	O	O	O	O	O
UserName	O	O	O	O	O	O
=	O	O	O	O	O	O
”	O	O	O	O	O	O
system	O	O	O	O	O	O
”	O	O	O	O	O	O
)	O	O	O	O	O	O
Otherwise	O	O	O	O	O	O
False	O	O	O	O	O	O
|	O	O	O	O	O	O
CurrentProcessName	O	O	O	O	O	O
|	O	O	O	O	O	O
ProcessID	O	O	O	O	O	O
|	O	O	O	O	O	O
powershell	O	O	O	O	O	O
|	O	O	O	O	O	O
PowershellVersion	O	O	O	O	O	O

The	O	O	O	O	O	O
server	O	O	O	O	O	O
responds	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
final	O	O	O	O	O	O
payload	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
script	O	O	O	O	O	O
which	O	O	O	O	O	O
appears	O	O	O	O	O	O
to	O	O	O	O	O	O
be	O	O	O	O	O	O
a	O	O	O	O	O	O
part	O	O	O	O	O	O
of	O	O	O	O	O	O
 	O	O	O	O	O	O
the	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
empire	O	O	O	O	O	O
framework	O	O	O	O	O	O
post-exploitation	O	O	O	O	O	O
.	O	O	O	O	O	O

Transactions	O	O	O	O	O	O
of	O	O	O	O	O	O
this	O	O	O	O	O	O
post-exploitation	O	O	O	O	O	O
framework	O	O	O	O	O	O
look	O	O	O	O	O	O
like	O	O	O	O	O	O
this	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh4	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
x6GoPq1sdJUa3kohx-fuUu6LHbhToi20RzeZMbSe0qMOvwMBH3Nu0VMb8aSpdE9xgaJhtDqC64ROLZXuTlhIsl4uJwBWQ-rzuP1QWzN8OxO2fsTEWs7	O	O	O	O	O	O
_	O	O	O	O	O	O
Rxv2	O	O	O	O	O	O
_	O	O	O	O	O	O
uKGyIUYSs8R8QY	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig12	O	O	O	O	O	O
:	O	O	O	O	O	O
Network	O	O	O	O	O	O
transactions	O	O	O	O	O	O

The	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
empire	O	O	O	O	O	O
is	O	O	O	O	O	O
a	O	O	O	O	O	O
post-exploitation	O	O	O	O	O	O
framework	O	O	O	O	O	O
that	O	O	O	O	O	O
provides	O	O	O	O	O	O
a	O	O	O	O	O	O
Metasploit-like	O	O	O	O	O	O
framework	O	O	O	O	O	O
in	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
and	O	O	O	O	O	O
Python	O	O	O	O	O	O
.	O	O	O	O	O	O

It	O	O	O	O	O	O
includes	O	O	O	O	O	O
different	O	O	O	O	O	O
types	O	O	O	O	O	O
of	O	O	O	O	O	O
backdoors	O	O	O	O	O	O
with	O	O	O	O	O	O
multiple	O	O	O	O	O	O
modules	O	O	O	O	O	O
.	O	O	O	O	O	O

It	O	O	O	O	O	O
deals	O	O	O	O	O	O
strictly	O	O	O	O	O	O
with	O	O	O	O	O	O
Windows	O	O	O	O	O	O
machines	O	O	O	O	O	O
and	O	O	O	O	O	O
is	O	O	O	O	O	O
extremely	O	O	O	O	O	O
useful	O	O	O	O	O	O
in	O	O	O	O	O	O
penetration	O	O	O	O	O	O
testing	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
some	O	O	O	O	O	O
cases	O	O	O	O	O	O
,	O	O	O	O	O	O
however	O	O	O	O	O	O
,	O	O	O	O	O	O
attackers	O	O	O	O	O	O
use	O	O	O	O	O	O
this	O	O	O	O	O	O
framework	O	O	O	O	O	O
to	O	O	O	O	O	O
hijack	O	O	O	O	O	O
a	O	O	O	O	O	O
user	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
system	O	O	O	O	O	O
and	O	O	O	O	O	O
perform	O	O	O	O	O	O
malicious	O	O	O	O	O	O
activities	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Case	O	O	O	O	O	O
II	O	O	O	O	O	O
:	O	O	O	O	O	O
DDE	O	O	O	O	O	O
protocol	O	O	O	O	O	O
abuse	O	O	O	O	O	O
leads	O	O	O	O	O	O
to	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

In	O	O	O	O	O	O
another	O	O	O	O	O	O
recent	O	O	O	O	O	O
case	O	O	O	O	O	O
,	O	O	O	O	O	O
a	O	O	O	O	O	O
campaign	O	O	O	O	O	O
of	O	O	O	O	O	O
spam	O	O	O	O	O	O
emails	O	O	O	O	O	O
was	O	O	O	O	O	O
delivering	O	O	O	O	O	O
a	O	O	O	O	O	O
Word	O	O	O	O	O	O
document	O	O	O	O	O	O
attachment	O	O	O	O	O	O
that	O	O	O	O	O	O
used	O	O	O	O	O	O
the	O	O	O	O	O	O
DDE	O	O	O	O	O	O
technique	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
the	O	O	O	O	O	O
final	O	O	O	O	O	O
payload	O	O	O	O	O	O
of	O	O	O	O	O	O
that	O	O	O	O	O	O
campaign	O	O	O	O	O	O
is	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh6	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
6kwyNdLTAxfAGBUjv7LqW3X4dEv6uONGsp_peb	O	O	O	O	O	O
-	O	O	O	O	O	O
3fdZpANt9	O	O	O	O	O	O
-	O	O	O	O	O	O
lWsTga_uNSS60BSZ1ABIdZ6R5jK	O	O	O	O	O	O
-	O	O	O	O	O	O
7d4OkPBrVNk8ynbY4dWnSZmb4M2rw8	O	O	O	O	O	O
-	O	O	O	O	O	O
t3W7T6TvfAP8C-GYo0L0qxeoP1M	O	O	O	O	O	O
)	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

Fig	O	O	O	O	O	O
13	O	O	O	O	O	O
:	O	O	O	O	O	O
DDE	O	O	O	O	O	O
protocol	O	O	O	O	O	O
abuse	O	O	O	O	O	O
leads	O	O	O	O	O	O
to	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
(	O	O	O	O	O	O
case	O	O	O	O	O	O
II	O	O	O	O	O	O
)	O	O	O	O	O	O

In	O	O	O	O	O	O
this	O	O	O	O	O	O
case	O	O	O	O	O	O
,	O	O	O	O	O	O
attackers	O	O	O	O	O	O
are	O	O	O	O	O	O
writing	O	O	O	O	O	O
obfuscated	O	O	O	O	O	O
malicious	O	O	O	O	O	O
field	O	O	O	O	O	O
code	O	O	O	O	O	O
in	O	O	O	O	O	O
Word	O	O	O	O	O	O
documents	O	O	O	O	O	O
to	O	O	O	O	O	O
evade	O	O	O	O	O	O
detection	O	O	O	O	O	O
;	O	O	O	O	O	O
this	O	O	O	O	O	O
code	O	O	O	O	O	O
can	O	O	O	O	O	O
be	O	O	O	O	O	O
found	O	O	O	O	O	O
in	O	O	O	O	O	O
word-document.xml	O	O	O	O	O	O
after	O	O	O	O	O	O
extraction	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh5	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
1fJKfeXFlDnjMvrvqek2gou7LWfKlfdio9Cj94QVD7mdOlYWBEGZQz-b0vRyfa9ybUIOaZi3b3BZ8JEfSdrCViDMtsMXRTtt7BsCj4yYuykg3r7DPqPbif9UEhumfGcWW3pFN7w	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig14	O	O	O	O	O	O
:	O	O	O	O	O	O
Field	O	O	O	O	O	O
word-document.xml	O	O	O	O	O	O
obfuscated	O	O	O	O	O	O
code	O	O	O	O	O	O

The	O	O	O	O	O	O
exploit	O	O	O	O	O	O
downloads	O	O	O	O	O	O
the	O	O	O	O	O	O
encoded	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
script	O	O	O	O	O	O
from	O	O	O	O	O	O
:	O	O	O	O	O	O
 	O	O	O	O	O	O
hxxp	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lestrangeresearch	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O
/	O	O	O	O	O	O
kdjsw23FGS	O	O	O	O	O	O
.	O	O	O	O	O	O
It	O	O	O	O	O	O
then	O	O	O	O	O	O
decodes	O	O	O	O	O	O
and	O	O	O	O	O	O
executes	O	O	O	O	O	O
it	O	O	O	O	O	O
through	O	O	O	O	O	O
cmd	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh5	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
4FqVGLhN9fZ1	O	O	O	O	O	O
_	O	O	O	O	O	O
U3L70kJLGfJ4IlBWl-dbZFxWiapZeZeLSjnpKiaVkm4BlTOod-s2Sk46DNPf39	O	O	O	O	O	O
_	O	O	O	O	O	O
Pd6r3imZ8iikWaiFjO1VUsjvdO2VenBKXToyug3BbgxgrkLZd0b2cgqv2aM	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig15	O	O	O	O	O	O
:	O	O	O	O	O	O
Encoded	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
(	O	O	O	O	O	O
payload	O	O	O	O	O	O
1	O	O	O	O	O	O
)	O	O	O	O	O	O

The	O	O	O	O	O	O
decoded	O	O	O	O	O	O
script	O	O	O	O	O	O
look	O	O	O	O	O	O
like	O	O	O	O	O	O
this	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh3	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
3t9ib3JirvBHIv2y0jFQa9P9JTOfxf_yUsysF7troOm9OrSkw3lBtQ4IA6vYYDTaYF6LR2Y_e1QJLuykECBc8lGAbhN7u8AwL_vGY8POWPwmGXgtUMeV3crORjBjBgsDkeSn8g8	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig16	O	O	O	O	O	O
:	O	O	O	O	O	O
Decoded	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
script	O	O	O	O	O	O
(	O	O	O	O	O	O
payload	O	O	O	O	O	O
1	O	O	O	O	O	O
)	O	O	O	O	O	O

The	O	O	O	O	O	O
decoded	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
script	O	O	O	O	O	O
has	O	O	O	O	O	O
six	O	O	O	O	O	O
hardcoded	O	O	O	O	O	O
malicious	O	O	O	O	O	O
URLs	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
script	O	O	O	O	O	O
will	O	O	O	O	O	O
try	O	O	O	O	O	O
to	O	O	O	O	O	O
download	O	O	O	O	O	O
the	O	O	O	O	O	O
content	O	O	O	O	O	O
from	O	O	O	O	O	O
a	O	O	O	O	O	O
URL	O	O	O	O	O	O
and	O	O	O	O	O	O
store	O	O	O	O	O	O
it	O	O	O	O	O	O
in	O	O	O	O	O	O
%	O	O	O	O	O	O
temp	O	O	O	O	O	O
%	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
name	O	O	O	O	O	O
hti4	O	O	O	O	O	O
.	O	O	O	O	O	O
exe	O	O	O	O	O	O
.	O	O	O	O	O	O

Upon	O	O	O	O	O	O
successful	O	O	O	O	O	O
download	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
script	O	O	O	O	O	O
executes	O	O	O	O	O	O
the	O	O	O	O	O	O
downloaded	O	O	O	O	O	O
file	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh4	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
AjHP7MPA0o6czB0cp5V48iOyowc4	O	O	O	O	O	O
-	O	O	O	O	O	O
jOAYl4SxHgXt373ASZzzvrTtU-UGQtpJE	O	O	O	O	O	O
_	O	O	O	O	O	O
1BQqAuu9K0pKNAFep8pa1q2TuW2QQZhAFBTXU7DTNEtlBH8NhxqKAAmdP92T6HGV-icDaA-g	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig17	O	O	O	O	O	O
:	O	O	O	O	O	O
Downloaded	O	O	O	O	O	O
payload	O	O	O	O	O	O
2	O	O	O	O	O	O

Payload	O	O	O	O	O	O
2	O	O	O	O	O	O
is	O	O	O	O	O	O
the	O	O	O	O	O	O
intermediate	O	O	O	O	O	O
payload	O	O	O	O	O	O
.	O	O	O	O	O	O

Its	O	O	O	O	O	O
function	O	O	O	O	O	O
is	O	O	O	O	O	O
to	O	O	O	O	O	O
check	O	O	O	O	O	O
the	O	O	O	O	O	O
system	O	O	O	O	O	O
for	O	O	O	O	O	O
specified	O	O	O	O	O	O
parameters	O	O	O	O	O	O
.	O	O	O	O	O	O

If	O	O	O	O	O	O
it	O	O	O	O	O	O
satisfies	O	O	O	O	O	O
specific	O	O	O	O	O	O
criteria	O	O	O	O	O	O
,	O	O	O	O	O	O
it	O	O	O	O	O	O
then	O	O	O	O	O	O
downloads	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
data	O	O	O	O	O	O
from	O	O	O	O	O	O
:	O	O	O	O	O	O
 	O	O	O	O	O	O
hxxp	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
spooner-motorsport	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh4	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
wCm-o5mvaauZJcmgmldsX8nnRNLDGadKyz9ecBoYuOKbdu7N6YBx-SegasQ5ajXjlvUfXnyoZafXc6LyLclvg_SJIMCP5Qq75kq3nldMsjaPNYeRPWREHdP7794ztPpnuNo5L08	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig18	O	O	O	O	O	O
:	O	O	O	O	O	O
Encrypted	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
(	O	O	O	O	O	O
payload	O	O	O	O	O	O
3	O	O	O	O	O	O
)	O	O	O	O	O	O

This	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
data	O	O	O	O	O	O
is	O	O	O	O	O	O
decrypted	O	O	O	O	O	O
and	O	O	O	O	O	O
launched	O	O	O	O	O	O
by	O	O	O	O	O	O
the	O	O	O	O	O	O
intermediate	O	O	O	O	O	O
payload	O	O	O	O	O	O
(	O	O	O	O	O	O
payload	O	O	O	O	O	O
2	O	O	O	O	O	O
)	O	O	O	O	O	O
.	O	O	O	O	O	O

After	O	O	O	O	O	O
decryption	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
final	O	O	O	O	O	O
payload	O	O	O	O	O	O
is	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
encrypts	O	O	O	O	O	O
the	O	O	O	O	O	O
files	O	O	O	O	O	O
,	O	O	O	O	O	O
appends	O	O	O	O	O	O
the	O	O	O	O	O	O
.	O	O	O	O	O	O
asasin	O	O	O	O	O	O
extension	O	O	O	O	O	O
after	O	O	O	O	O	O
encryption	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
demands	O	O	O	O	O	O
ransom	O	O	O	O	O	O
in	O	O	O	O	O	O
Bitcoin	O	O	O	O	O	O
for	O	O	O	O	O	O
decryption	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh5	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
nmEozTANcicUraZwRLSLAqXbdPgjUJAmtAZWd83iRKREu8	O	O	O	O	O	O
_	O	O	O	O	O	O
xqfoGmHcGdUoO0t9nSRFXm3dgvM4BllT4py2Tzm0GtWxuOq0pxN1xo3XQ9yMsmlWmb3gLgDl4SJlC2PuM4NO-Vg8	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig19	O	O	O	O	O	O
:	O	O	O	O	O	O
Ransom	O	O	O	O	O	O
note	O	O	O	O	O	O
(	O	O	O	O	O	O
asasin.bmp	O	O	O	O	O	O
)	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh6	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
GrxUobFrNEH2QbKFPRW1EFE9izoD7MpViryuR0q	O	O	O	O	O	O
_	O	O	O	O	O	O
4fsQ5Lm0dLq77oEGQcUWqVbFX1OVUZq9M0g3CHI63rpDOIBGWuBOyxld-SE2RwX5UPKtQu_AC1ONvDzf_OXmSdPE16UAcqg	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig20	O	O	O	O	O	O
:	O	O	O	O	O	O
Locky	O	O	O	O	O	O
payment	O	O	O	O	O	O
site	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Case	O	O	O	O	O	O
III	O	O	O	O	O	O
:	O	O	O	O	O	O
Attack	O	O	O	O	O	O
in	O	O	O	O	O	O
New	B-LOC	O	O	O	O	B-LOC
York	I-LOC	O	O	O	O	I-LOC
*	O	O	O	O	O	O
*	O	O	O	O	O	O

Recently	O	O	O	O	O	O
,	O	O	O	O	O	O
researchers	O	O	O	O	O	O
at	O	O	O	O	O	O
McAfee	B-ORG	O	O	O	O	B-ORG
found	O	O	O	O	O	O
a	O	O	O	O	O	O
new	O	O	O	O	O	O
phishing	O	O	O	O	O	O
campaign	O	O	O	O	O	O
from	O	O	O	O	O	O
Russia's	B-LOC	O	O	O	O	B-LOC
hacking	O	O	O	O	O	O
group	O	O	O	O	O	O
APT28	O	O	O	O	O	O
known	O	O	O	O	O	O
as	O	O	O	O	O	O
“	O	O	O	O	O	O
Fancy	O	O	O	O	O	O
Bear	O	O	O	O	O	O
.	O	O	O	O	O	O

APT28	O	O	O	O	O	O
capitalized	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
recent	O	O	O	O	O	O
terror	O	O	O	O	O	O
attack	O	O	O	O	O	O
in	O	O	O	O	O	O
New	B-LOC	O	O	O	O	B-LOC
York	I-LOC	O	O	O	O	I-LOC
City	I-LOC	O	O	O	O	I-LOC
by	O	O	O	O	O	O
spreading	O	O	O	O	O	O
email	O	O	O	O	O	O
with	O	O	O	O	O	O
an	O	O	O	O	O	O
attached	O	O	O	O	O	O
malicious	O	O	O	O	O	O
Word	O	O	O	O	O	O
document	O	O	O	O	O	O
named	O	O	O	O	O	O
IsisAttackInNewYork.docx	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
the	O	O	O	O	O	O
document	O	O	O	O	O	O
appears	O	O	O	O	O	O
to	O	O	O	O	O	O
leverage	O	O	O	O	O	O
the	O	O	O	O	O	O
DDE	O	O	O	O	O	O
technique	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
this	O	O	O	O	O	O
case	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
first-stage	O	O	O	O	O	O
payload	O	O	O	O	O	O
was	O	O	O	O	O	O
a	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
script	O	O	O	O	O	O
that	O	O	O	O	O	O
downloads	O	O	O	O	O	O
another	O	O	O	O	O	O
base64	O	O	O	O	O	O
encoded	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
script	O	O	O	O	O	O
.	O	O	O	O	O	O

After	O	O	O	O	O	O
that	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
second-stage	O	O	O	O	O	O
payload	O	O	O	O	O	O
script	O	O	O	O	O	O
downloads	O	O	O	O	O	O
a	O	O	O	O	O	O
new	O	O	O	O	O	O
variant	O	O	O	O	O	O
of	O	O	O	O	O	O
Seduploader	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
is	O	O	O	O	O	O
spyware	O	O	O	O	O	O
capable	O	O	O	O	O	O
of	O	O	O	O	O	O
taking	O	O	O	O	O	O
screenshots	O	O	O	O	O	O
,	O	O	O	O	O	O
gathering	O	O	O	O	O	O
sensitive	O	O	O	O	O	O
data	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
other	O	O	O	O	O	O
intrusive	O	O	O	O	O	O
activities	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Preventions	O	O	O	O	O	O
:	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

If	O	O	O	O	O	O
a	O	O	O	O	O	O
document	O	O	O	O	O	O
contains	O	O	O	O	O	O
embedded	O	O	O	O	O	O
malicious	O	O	O	O	O	O
DDE	O	O	O	O	O	O
code	O	O	O	O	O	O
,	O	O	O	O	O	O
it	O	O	O	O	O	O
shows	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
warning	O	O	O	O	O	O
to	O	O	O	O	O	O
users	O	O	O	O	O	O
as	O	O	O	O	O	O
they	O	O	O	O	O	O
open	O	O	O	O	O	O
it	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
lh3	O	O	O	O	O	O
.	O	O	O	O	O	O
googleusercontent.com	O	O	O	O	O	O
/	O	O	O	O	O	O
3jugSSfVleOicMVInEEeKAZNPHwZN2sXnYUsnNhYW0LnezxSp_AEuPVCMFPtMOp5pZWFQFr61OcM-Cn-G0VY3TEb4cUseVD6XjdZ60s0gSURne8yBiCsZr66NXsgh2mVTRcnIv8	O	O	O	O	O	O
)	O	O	O	O	O	O

Fig	O	O	O	O	O	O
21	O	O	O	O	O	O
:	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Word	O	O	O	O	O	O
warning	O	O	O	O	O	O

The	O	O	O	O	O	O
best	O	O	O	O	O	O
way	O	O	O	O	O	O
to	O	O	O	O	O	O
prevent	O	O	O	O	O	O
this	O	O	O	O	O	O
DDE	O	O	O	O	O	O
attack	O	O	O	O	O	O
vector	O	O	O	O	O	O
is	O	O	O	O	O	O
to	O	O	O	O	O	O
click	O	O	O	O	O	O
“	O	O	O	O	O	O
No	O	O	O	O	O	O
”	O	O	O	O	O	O
when	O	O	O	O	O	O
this	O	O	O	O	O	O
dialog	O	O	O	O	O	O
box	O	O	O	O	O	O
appears	O	O	O	O	O	O
;	O	O	O	O	O	O
this	O	O	O	O	O	O
will	O	O	O	O	O	O
stop	O	O	O	O	O	O
further	O	O	O	O	O	O
execution	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
malware	O	O	O	O	O	O
.	O	O	O	O	O	O

Another	O	O	O	O	O	O
way	O	O	O	O	O	O
to	O	O	O	O	O	O
prevent	O	O	O	O	O	O
this	O	O	O	O	O	O
attack	O	O	O	O	O	O
is	O	O	O	O	O	O
to	O	O	O	O	O	O
disable	O	O	O	O	O	O
it	O	O	O	O	O	O
by	O	O	O	O	O	O
modifying	O	O	O	O	O	O
the	O	O	O	O	O	O
[	O	O	O	O	O	O
registry	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
gist.github.com	O	O	O	O	O	O
/	O	O	O	O	O	O
wdormann	O	O	O	O	O	O
/	O	O	O	O	O	O
732bb88d9b5dd5a66c9f1e1498f31a1b	O	O	O	O	O	O
)	O	O	O	O	O	O
.	O	O	O	O	O	O

Microsoft	B-ORG	O	O	O	O	B-ORG
has	O	O	O	O	O	O
also	O	O	O	O	O	O
 	O	O	O	O	O	O
published	O	O	O	O	O	O
[	O	O	O	O	O	O
security	O	O	O	O	O	O
advisory	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
https	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
technet.microsoft.com	O	O	O	O	O	O
/	O	O	O	O	O	O
en-us	O	O	O	O	O	O
/	O	O	O	O	O	O
library	O	O	O	O	O	O
/	O	O	O	O	O	O
security	O	O	O	O	O	O
/	O	O	O	O	O	O
4053440	O	O	O	O	O	O
.	O	O	O	O	O	O
aspx	O	O	O	O	O	O
)	O	O	O	O	O	O
for	O	O	O	O	O	O
securely	O	O	O	O	O	O
opening	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
documents	O	O	O	O	O	O
that	O	O	O	O	O	O
contain	O	O	O	O	O	O
a	O	O	O	O	O	O
DDE	O	O	O	O	O	O
field	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Conclusion	O	O	O	O	O	O
:	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

Attackers	O	O	O	O	O	O
are	O	O	O	O	O	O
abusing	O	O	O	O	O	O
the	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
DDE	O	O	O	O	O	O
protocol	O	O	O	O	O	O
to	O	O	O	O	O	O
download	O	O	O	O	O	O
and	O	O	O	O	O	O
execute	O	O	O	O	O	O
malware	O	O	O	O	O	O
using	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
an	O	O	O	O	O	O
earlier	O	O	O	O	O	O
case	O	O	O	O	O	O
,	O	O	O	O	O	O
PowerShell	O	O	O	O	O	O
led	O	O	O	O	O	O
to	O	O	O	O	O	O
an	O	O	O	O	O	O
entire	O	O	O	O	O	O
post-exploitation	O	O	O	O	O	O
framework	O	O	O	O	O	O
used	O	O	O	O	O	O
for	O	O	O	O	O	O
penetration	O	O	O	O	O	O
testing	O	O	O	O	O	O
.	O	O	O	O	O	O

But	O	O	O	O	O	O
attackers	O	O	O	O	O	O
are	O	O	O	O	O	O
using	O	O	O	O	O	O
the	O	O	O	O	O	O
framework	O	O	O	O	O	O
for	O	O	O	O	O	O
malicious	O	O	O	O	O	O
purposes	O	O	O	O	O	O
,	O	O	O	O	O	O
such	O	O	O	O	O	O
as	O	O	O	O	O	O
stealing	O	O	O	O	O	O
a	O	O	O	O	O	O
user	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
sensitive	O	O	O	O	O	O
information	O	O	O	O	O	O
,	O	O	O	O	O	O
uploading	O	O	O	O	O	O
and	O	O	O	O	O	O
executing	O	O	O	O	O	O
malware	O	O	O	O	O	O
on	O	O	O	O	O	O
a	O	O	O	O	O	O
user	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
machine	O	O	O	O	O	O
,	O	O	O	O	O	O
altering	O	O	O	O	O	O
the	O	O	O	O	O	O
user	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
data	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
so	O	O	O	O	O	O
on	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
recent	O	O	O	O	O	O
cases	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
DDE	O	O	O	O	O	O
protocol	O	O	O	O	O	O
led	O	O	O	O	O	O
to	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
,	O	O	O	O	O	O
including	O	O	O	O	O	O
Locky	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
encrypts	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
data	O	O	O	O	O	O
and	O	O	O	O	O	O
demands	O	O	O	O	O	O
ransom	O	O	O	O	O	O
for	O	O	O	O	O	O
the	O	O	O	O	O	O
decryption	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
malware	O	O	O	O	O	O
analyzed	O	O	O	O	O	O
in	O	O	O	O	O	O
this	O	O	O	O	O	O
blog	O	O	O	O	O	O
is	O	O	O	O	O	O
detected	O	O	O	O	O	O
as	O	O	O	O	O	O
COM.Downloader.DDE	O	O	O	O	O	O

