<DOCSTART>	O	O	O	O	O	O

Agent	O	O	O	O	O	O
Tesla	O	O	O	O	O	O
Keylogger	O	O	O	O	O	O
delivered	O	O	O	O	O	O
using	O	O	O	O	O	O
cybersquatting	O	O	O	O	O	O

August	O	O	B-DATE	O	O	B-DATE
25	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2016	O	O	I-DATE	O	O	I-DATE

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Introduction	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

Zscaler	B-ORG	O	O	O	O	B-ORG
ThreatLabZ	O	O	O	O	O	O
recently	O	O	O	O	O	O
came	O	O	O	O	O	O
across	O	O	O	O	O	O
an	O	O	O	O	O	O
attack	O	O	O	O	O	O
chain	O	O	O	O	O	O
in	O	O	O	O	O	O
which	O	O	O	O	O	O
cybersquatting	O	O	O	O	O	O
was	O	O	O	O	O	O
being	O	O	O	O	O	O
used	O	O	O	O	O	O
to	O	O	O	O	O	O
deliver	O	O	O	O	O	O
a	O	O	O	O	O	O
commercial	O	O	O	O	O	O
keylogger	O	O	O	O	O	O
,	O	O	O	O	O	O
called	O	O	O	O	O	O
“	O	O	O	O	O	O
AgentTesla	O	O	O	O	O	O
,	O	O	O	O	O	O
”	O	O	O	O	O	O
with	O	O	O	O	O	O
an	O	O	O	O	O	O
intent	O	O	O	O	O	O
to	O	O	O	O	O	O
steal	O	O	O	O	O	O
confidential	O	O	O	O	O	O
information	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
keylogger	O	O	O	O	O	O
payload	O	O	O	O	O	O
was	O	O	O	O	O	O
configured	O	O	O	O	O	O
to	O	O	O	O	O	O
relay	O	O	O	O	O	O
the	O	O	O	O	O	O
stolen	O	O	O	O	O	O
information	O	O	O	O	O	O
back	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
cyber-squatted	O	O	O	O	O	O
domain	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
had	O	O	O	O	O	O
been	O	O	O	O	O	O
registered	O	O	O	O	O	O
two	O	O	O	O	O	O
months	O	O	O	O	O	O
prior	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
attack	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
malicious	O	O	O	O	O	O
domain	O	O	O	O	O	O
in	O	O	O	O	O	O
this	O	O	O	O	O	O
case	O	O	O	O	O	O
was	O	O	O	O	O	O
“	O	O	O	O	O	O
diodetechs	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O
”	O	O	O	O	O	O
trying	O	O	O	O	O	O
to	O	O	O	O	O	O
imitate	O	O	O	O	O	O
diodetech	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
belongs	O	O	O	O	O	O
to	O	O	O	O	O	O
a	O	O	O	O	O	O
legitimate	O	O	O	O	O	O
consulting	O	O	O	O	O	O
firm	O	O	O	O	O	O
that	O	O	O	O	O	O
offers	O	O	O	O	O	O
a	O	O	O	O	O	O
variety	O	O	O	O	O	O
of	O	O	O	O	O	O
services	O	O	O	O	O	O
to	O	O	O	O	O	O
global	O	O	O	O	O	O
enterprises	O	O	O	O	O	O
.	O	O	O	O	O	O

We	O	O	O	O	O	O
notified	O	O	O	O	O	O
Diode	O	O	O	O	O	O
technologies	O	O	O	O	O	O
about	O	O	O	O	O	O
the	O	O	O	O	O	O
attack	O	O	O	O	O	O
earlier	O	O	O	O	O	O
this	O	O	B-DATE	O	O	B-DATE
month	O	O	I-DATE	O	O	I-DATE
and	O	O	O	O	O	O
the	O	O	O	O	O	O
offending	O	O	O	O	O	O
domain	O	O	O	O	O	O
has	O	O	O	O	O	O
been	O	O	O	O	O	O
suspended	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
AgentTesla	O	O	O	O	O	O
keylogger	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

AgentTesla	O	O	O	O	O	O
is	O	O	O	O	O	O
an	O	O	O	O	O	O
advanced	O	O	O	O	O	O
keylogger	O	O	O	O	O	O
with	O	O	O	O	O	O
features	O	O	O	O	O	O
like	O	O	O	O	O	O
clipboard	O	O	O	O	O	O
logging	O	O	O	O	O	O
,	O	O	O	O	O	O
screen	O	O	O	O	O	O
keylogging	O	O	O	O	O	O
,	O	O	O	O	O	O
screen	O	O	O	O	O	O
capturing	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
extracting	O	O	O	O	O	O
stored	O	O	O	O	O	O
passwords	O	O	O	O	O	O
from	O	O	O	O	O	O
different	O	O	O	O	O	O
web	O	O	O	O	O	O
browsers	O	O	O	O	O	O
.	O	O	O	O	O	O

It	O	O	O	O	O	O
is	O	O	O	O	O	O
written	O	O	O	O	O	O
in	O	O	O	O	O	O
.	O	O	O	O	O	O
NET	O	O	O	O	O	O
and	O	O	O	O	O	O
supports	O	O	O	O	O	O
all	O	O	O	O	O	O
versions	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
Windows	O	O	O	O	O	O
operating	O	O	O	O	O	O
system	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
this	O	O	O	O	O	O
blog	O	O	O	O	O	O
,	O	O	O	O	O	O
we	O	O	O	O	O	O
will	O	O	O	O	O	O
analyze	O	O	O	O	O	O
the	O	O	O	O	O	O
AgentTesla	O	O	O	O	O	O
payload	O	O	O	O	O	O
that	O	O	O	O	O	O
was	O	O	O	O	O	O
used	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
attacks	O	O	O	O	O	O
involving	O	O	O	O	O	O
cyber-squatted	O	O	O	O	O	O
domain	O	O	O	O	O	O
‘	O	O	O	O	O	O
diodetechs	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O
’	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
2	O	O	O	O	O	O
.	O	O	O	O	O	O
PNG	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
1	O	O	O	O	O	O
:	O	O	O	O	O	O
Subscription	O	O	O	O	O	O
packages	O	O	O	O	O	O
 	O	O	O	O	O	O
of	O	O	O	O	O	O
AgentTesla	O	O	O	O	O	O
keylogger	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
The	O	O	O	O	O	O
Infection	O	O	O	O	O	O
cycle	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
infection	O	O	O	O	O	O
cycle	O	O	O	O	O	O
typically	O	O	O	O	O	O
starts	O	O	O	O	O	O
with	O	O	O	O	O	O
a	O	O	O	O	O	O
malicious	O	O	O	O	O	O
office	O	O	O	O	O	O
document	O	O	O	O	O	O
that	O	O	O	O	O	O
arrives	O	O	O	O	O	O
as	O	O	O	O	O	O
an	O	O	O	O	O	O
e-mail	O	O	O	O	O	O
attachment	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
 	O	O	O	O	O	O
document	O	O	O	O	O	O
uses	O	O	O	O	O	O
the	O	O	O	O	O	O
social	O	O	O	O	O	O
engineering	O	O	O	O	O	O
tactics	O	O	O	O	O	O
covered	O	O	O	O	O	O
[	O	O	O	O	O	O
here	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
research	O	O	O	O	O	O
/	O	O	O	O	O	O
malicious-documents-leveraging-new-anti-vm-anti-sandbox-techniques	O	O	O	O	O	O
)	O	O	O	O	O	O
to	O	O	O	O	O	O
lure	O	O	O	O	O	O
the	O	O	O	O	O	O
user	O	O	O	O	O	O
into	O	O	O	O	O	O
running	O	O	O	O	O	O
the	O	O	O	O	O	O
embedded	O	O	O	O	O	O
macro	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
will	O	O	O	O	O	O
download	O	O	O	O	O	O
and	O	O	O	O	O	O
install	O	O	O	O	O	O
the	O	O	O	O	O	O
malware	O	O	O	O	O	O
executable	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
malware	O	O	O	O	O	O
executable	O	O	O	O	O	O
is	O	O	O	O	O	O
the	O	O	O	O	O	O
AgentTesla	O	O	O	O	O	O
keylogger	O	O	O	O	O	O
that	O	O	O	O	O	O
was	O	O	O	O	O	O
hosted	O	O	O	O	O	O
at	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
location	O	O	O	O	O	O
:	O	O	O	O	O	O

*	O	O	O	O	O	O
diodetechs	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O
/	O	O	O	O	O	O
bless	O	O	O	O	O	O
/	O	O	O	O	O	O
cc.exe	O	O	O	O	O	O
[	O	O	O	O	O	O
cyber-squatted	O	O	O	O	O	O
domain	O	O	O	O	O	O
]	O	O	O	O	O	O

*	O	O	O	O	O	O
MD5	O	O	O	O	O	O
-	O	O	O	O	O	O
e4117e6974363cac8b37e5e3ff5d07a6	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
Agent-Tesla-keylogger.png	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
2	O	O	O	O	O	O
:	O	O	O	O	O	O
AgentTesla	O	O	O	O	O	O
configuration	O	O	O	O	O	O
panel	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Installation	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
AgentTesla	O	O	O	O	O	O
payload	O	O	O	O	O	O
gets	O	O	O	O	O	O
downloaded	O	O	O	O	O	O
and	O	O	O	O	O	O
executed	O	O	O	O	O	O
from	O	O	O	O	O	O
location	O	O	O	O	O	O
“	O	O	O	O	O	O
%	O	O	O	O	O	O
temp	O	O	O	O	O	O
%	O	O	O	O	O	O
\	O	O	O	O	O	O
cc.exe	O	O	O	O	O	O
”	O	O	O	O	O	O
.	O	O	O	O	O	O

It	O	O	O	O	O	O
makes	O	O	O	O	O	O
a	O	O	O	O	O	O
copy	O	O	O	O	O	O
of	O	O	O	O	O	O
itself	O	O	O	O	O	O
as	O	O	O	O	O	O
“	O	O	O	O	O	O
JavaUpdtr.exe	O	O	O	O	O	O
”	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
“	O	O	O	O	O	O
%	O	O	O	O	O	O
Application	O	O	O	O	O	O
Data	O	O	O	O	O	O
%	O	O	O	O	O	O
\	O	O	O	O	O	O
Java	O	O	O	O	O	O
\	O	O	O	O	O	O
”	O	O	O	O	O	O
directory	O	O	O	O	O	O
,	O	O	O	O	O	O
pretending	O	O	O	O	O	O
to	O	O	O	O	O	O
be	O	O	O	O	O	O
a	O	O	O	O	O	O
Java	O	O	O	O	O	O
updater	O	O	O	O	O	O
.	O	O	O	O	O	O

It	O	O	O	O	O	O
also	O	O	O	O	O	O
creates	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
registry	O	O	O	O	O	O
entry	O	O	O	O	O	O
to	O	O	O	O	O	O
remain	O	O	O	O	O	O
persistent	O	O	O	O	O	O
upon	O	O	O	O	O	O
system	O	O	O	O	O	O
reboot	O	O	O	O	O	O
:	O	O	O	O	O	O

*	O	O	O	O	O	O
HKEY	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
USERS	O	O	O	O	O	O
\	O	O	O	O	O	O
Software	O	O	O	O	O	O
\	O	O	O	O	O	O
Microsoft	O	O	O	O	O	O
\	O	O	O	O	O	O
Windows	O	O	O	O	O	O
\	O	O	O	O	O	O
CurrentVersion	O	O	O	O	O	O
\	O	O	O	O	O	O
Run	O	O	O	O	O	O
@	O	O	O	O	O	O
Java	O	O	O	O	O	O
Updtr	O	O	O	O	O	O

The	O	O	O	O	O	O
installer	O	O	O	O	O	O
then	O	O	O	O	O	O
starts	O	O	O	O	O	O
a	O	O	O	O	O	O
new	O	O	O	O	O	O
process	O	O	O	O	O	O
‘	O	O	O	O	O	O
MSBuild.exe	O	O	O	O	O	O
’	O	O	O	O	O	O
in	O	O	O	O	O	O
suspended	O	O	O	O	O	O
mode	O	O	O	O	O	O
,	O	O	O	O	O	O
injects	O	O	O	O	O	O
itself	O	O	O	O	O	O
into	O	O	O	O	O	O
this	O	O	O	O	O	O
new	O	O	O	O	O	O
process	O	O	O	O	O	O
before	O	O	O	O	O	O
resuming	O	O	O	O	O	O
execution	O	O	O	O	O	O
.	O	O	O	O	O	O

This	O	O	O	O	O	O
is	O	O	O	O	O	O
where	O	O	O	O	O	O
the	O	O	O	O	O	O
keylogging	O	O	O	O	O	O
,	O	O	O	O	O	O
screen	O	O	O	O	O	O
capturing	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
other	O	O	O	O	O	O
information	O	O	O	O	O	O
collection	O	O	O	O	O	O
modules	O	O	O	O	O	O
are	O	O	O	O	O	O
started	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
author	O	O	O	O	O	O
leveraged	O	O	O	O	O	O
 	O	O	O	O	O	O
legitimate	O	O	O	O	O	O
password	O	O	O	O	O	O
recovery	O	O	O	O	O	O
tools	O	O	O	O	O	O
like	O	O	O	O	O	O
[	O	O	O	O	O	O
IEPasswordDump	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
http	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
securityxploded.com	O	O	O	O	O	O
/	O	O	O	O	O	O
internet-explorer-password-dump.php	O	O	O	O	O	O
)	O	O	O	O	O	O
and	O	O	O	O	O	O
[	O	O	O	O	O	O
MailPassView	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
http	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
www.nirsoft.net	O	O	O	O	O	O
/	O	O	O	O	O	O
utils	O	O	O	O	O	O
/	O	O	O	O	O	O
mailpv.html	O	O	O	O	O	O
)	O	O	O	O	O	O
 	O	O	O	O	O	O
to	O	O	O	O	O	O
steal	O	O	O	O	O	O
user	O	O	O	O	O	O
credentials	O	O	O	O	O	O
from	O	O	O	O	O	O
Internet	O	O	O	O	O	O
Explorer	O	O	O	O	O	O
&	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Outlook	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
18	O	O	O	O	O	O
.	O	O	O	O	O	O
PNG	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
3	O	O	O	O	O	O
:	O	O	O	O	O	O
Embedded	O	O	O	O	O	O
IEPasswordDump	O	O	O	O	O	O
utility	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
logged	O	O	O	O	O	O
keystroke	O	O	O	O	O	O
information	O	O	O	O	O	O
is	O	O	O	O	O	O
saved	O	O	O	O	O	O
at	O	O	O	O	O	O
“	O	O	O	O	O	O
%	O	O	O	O	O	O
temp	O	O	O	O	O	O
%	O	O	O	O	O	O
\	O	O	O	O	O	O
log.tmp	O	O	O	O	O	O
”	O	O	O	O	O	O
in	O	O	O	O	O	O
plain-text	O	O	O	O	O	O
and	O	O	O	O	O	O
the	O	O	O	O	O	O
screenshots	O	O	O	O	O	O
are	O	O	O	O	O	O
saved	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
folder	O	O	O	O	O	O
“	O	O	O	O	O	O
%	O	O	O	O	O	O
appdata	O	O	O	O	O	O
%	O	O	O	O	O	O
\	O	O	O	O	O	O
ScreenShot	O	O	O	O	O	O
\	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
information	O	O	O	O	O	O
collected	O	O	O	O	O	O
from	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
machine	O	O	O	O	O	O
is	O	O	O	O	O	O
relayed	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
remote	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
server	O	O	O	O	O	O
every	O	O	O	O	O	O
20	O	O	O	O	O	O
minutes	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Bot	O	O	O	O	O	O
configuration	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
configuration	O	O	O	O	O	O
file	O	O	O	O	O	O
contains	O	O	O	O	O	O
a	O	O	O	O	O	O
full	O	O	O	O	O	O
list	O	O	O	O	O	O
of	O	O	O	O	O	O
modules	O	O	O	O	O	O
that	O	O	O	O	O	O
were	O	O	O	O	O	O
configured	O	O	O	O	O	O
by	O	O	O	O	O	O
the	O	O	O	O	O	O
attacker	O	O	O	O	O	O
.	O	O	O	O	O	O

This	O	O	O	O	O	O
version	O	O	O	O	O	O
has	O	O	O	O	O	O
multiple	O	O	O	O	O	O
modules	O	O	O	O	O	O
,	O	O	O	O	O	O
including	O	O	O	O	O	O
keylogging	O	O	O	O	O	O
,	O	O	O	O	O	O
screenshot	O	O	O	O	O	O
capturing	O	O	O	O	O	O
,	O	O	O	O	O	O
password	O	O	O	O	O	O
stealing	O	O	O	O	O	O
,	O	O	O	O	O	O
etc	O	O	O	O	O	O
.	O	O	O	O	O	O
,	O	O	O	O	O	O
enabled	O	O	O	O	O	O
as	O	O	O	O	O	O
shown	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
7	O	O	O	O	O	O
.	O	O	O	O	O	O
PNG	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
4	O	O	O	O	O	O
:	O	O	O	O	O	O
AgentTesla	O	O	O	O	O	O
bot	O	O	O	O	O	O
configuration	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Module	O	O	O	O	O	O
information	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

What	O	O	O	O	O	O
follows	O	O	O	O	O	O
is	O	O	O	O	O	O
a	O	O	O	O	O	O
brief	O	O	O	O	O	O
overview	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
modules	O	O	O	O	O	O
that	O	O	O	O	O	O
are	O	O	O	O	O	O
supported	O	O	O	O	O	O
by	O	O	O	O	O	O
this	O	O	O	O	O	O
payload	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
USB	O	O	O	O	O	O
Spreader	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
–	O	O	O	O	O	O
Capable	O	O	O	O	O	O
of	O	O	O	O	O	O
spreading	O	O	O	O	O	O
through	O	O	O	O	O	O
USB	O	O	O	O	O	O
drives	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Melt	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
–	O	O	O	O	O	O
Capable	O	O	O	O	O	O
of	O	O	O	O	O	O
uninstalling	O	O	O	O	O	O
itself	O	O	O	O	O	O
from	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
machine	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Webcam	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
–	O	O	O	O	O	O
Capable	O	O	O	O	O	O
of	O	O	O	O	O	O
taking	O	O	O	O	O	O
screenshots	O	O	O	O	O	O
through	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
machine	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
webcam	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
ScreenShot	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
–	O	O	O	O	O	O
Capable	O	O	O	O	O	O
of	O	O	O	O	O	O
taking	O	O	O	O	O	O
screenshots	O	O	O	O	O	O
capturing	O	O	O	O	O	O
user	O	O	O	O	O	O
activity	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Keylogger	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
–	O	O	O	O	O	O
 	O	O	O	O	O	O
Capable	O	O	O	O	O	O
of	O	O	O	O	O	O
logging	O	O	O	O	O	O
keystrokes	O	O	O	O	O	O
from	O	O	O	O	O	O
traditional	O	O	O	O	O	O
as	O	O	O	O	O	O
well	O	O	O	O	O	O
as	O	O	O	O	O	O
virtual	O	O	O	O	O	O
keyboard	O	O	O	O	O	O
;	O	O	O	O	O	O
it	O	O	O	O	O	O
can	O	O	O	O	O	O
also	O	O	O	O	O	O
log	O	O	O	O	O	O
data	O	O	O	O	O	O
from	O	O	O	O	O	O
the	O	O	O	O	O	O
clipboard	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Password	O	O	O	O	O	O
stealing	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
–	O	O	O	O	O	O
Capable	O	O	O	O	O	O
of	O	O	O	O	O	O
stealing	O	O	O	O	O	O
stored	O	O	O	O	O	O
password	O	O	O	O	O	O
from	O	O	O	O	O	O
various	O	O	O	O	O	O
applications	O	O	O	O	O	O
,	O	O	O	O	O	O
like	O	O	O	O	O	O
Chrome	O	O	O	O	O	O
,	O	O	O	O	O	O
Opera	O	O	O	O	O	O
,	O	O	O	O	O	O
Yandex	B-ORG	O	O	O	O	B-ORG
,	O	O	O	O	O	O
Firefox	O	O	O	O	O	O
,	O	O	O	O	O	O
IE	O	O	O	O	O	O
,	O	O	O	O	O	O
SeaMonkey	O	O	O	O	O	O
,	O	O	O	O	O	O
Comodo	O	O	O	O	O	O
,	O	O	O	O	O	O
Chromium	O	O	O	O	O	O
,	O	O	O	O	O	O
dyndns	O	O	O	O	O	O
,	O	O	O	O	O	O
Filezilla	O	O	O	O	O	O
,	O	O	O	O	O	O
FlashFXP	O	O	O	O	O	O
,	O	O	O	O	O	O
Outlook	O	O	O	O	O	O
,	O	O	O	O	O	O
Netscape	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
others	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Anti-Analysis	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
–	O	O	O	O	O	O
Capable	O	O	O	O	O	O
of	O	O	O	O	O	O
terminating	O	O	O	O	O	O
multiple	O	O	O	O	O	O
antivirus	O	O	O	O	O	O
,	O	O	O	O	O	O
security	O	O	O	O	O	O
,	O	O	O	O	O	O
and	O	O	O	O	O	O
analysis	O	O	O	O	O	O
programs	O	O	O	O	O	O
running	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
machine	O	O	O	O	O	O
;	O	O	O	O	O	O
it	O	O	O	O	O	O
is	O	O	O	O	O	O
also	O	O	O	O	O	O
capable	O	O	O	O	O	O
of	O	O	O	O	O	O
detecting	O	O	O	O	O	O
popular	O	O	O	O	O	O
sandboxes	O	O	O	O	O	O
and	O	O	O	O	O	O
virtual	O	O	O	O	O	O
environments	O	O	O	O	O	O
 	O	O	O	O	O	O

Additionally	O	O	O	O	O	O
,	O	O	O	O	O	O
AgentTesla	O	O	O	O	O	O
is	O	O	O	O	O	O
capable	O	O	O	O	O	O
of	O	O	O	O	O	O
disabling	O	O	O	O	O	O
UAC	O	O	O	O	O	O
,	O	O	O	O	O	O
Taskmgr	O	O	O	O	O	O
,	O	O	O	O	O	O
CMD	O	O	O	O	O	O
,	O	O	O	O	O	O
Run	O	O	O	O	O	O
,	O	O	O	O	O	O
Control	O	O	O	O	O	O
Panel	O	O	O	O	O	O
,	O	O	O	O	O	O
Regedit	O	O	O	O	O	O
,	O	O	O	O	O	O
SystemRestore	O	O	O	O	O	O
,	O	O	O	O	O	O
etc	O	O	O	O	O	O
.	O	O	O	O	O	O
,	O	O	O	O	O	O
on	O	O	O	O	O	O
a	O	O	O	O	O	O
victim	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
machine	O	O	O	O	O	O
.	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
24	O	O	O	O	O	O
.	O	O	O	O	O	O
PNG	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
5	O	O	O	O	O	O
:	O	O	O	O	O	O
AgentTesla	O	O	O	O	O	O
disabling	O	O	O	O	O	O
system	O	O	O	O	O	O
features	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Network	O	O	O	O	O	O
activity	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
payloads	O	O	O	O	O	O
that	O	O	O	O	O	O
we	O	O	O	O	O	O
analyzed	O	O	O	O	O	O
were	O	O	O	O	O	O
all	O	O	O	O	O	O
connecting	O	O	O	O	O	O
to	O	O	O	O	O	O
agenttesla	O	O	O	O	O	O
[	O	O	O	O	O	O
.	O	O	O	O	O	O
]	O	O	O	O	O	O
com	O	O	O	O	O	O
upon	O	O	O	O	O	O
successful	O	O	O	O	O	O
installation	O	O	O	O	O	O
to	O	O	O	O	O	O
check	O	O	O	O	O	O
for	O	O	O	O	O	O
keylogger	O	O	O	O	O	O
software	O	O	O	O	O	O
update	O	O	O	O	O	O
as	O	O	O	O	O	O
seen	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O
 	O	O	O	O	O	O

!	O	O	O	O	O	O
[	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
/	O	O	O	O	O	O
cdn-cgi	O	O	O	O	O	O
/	O	O	O	O	O	O
image	O	O	O	O	O	O
/	O	O	O	O	O	O
format	O	O	O	O	O	O
=	O	O	O	O	O	O
auto	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
default	O	O	O	O	O	O
/	O	O	O	O	O	O
files	O	O	O	O	O	O
/	O	O	O	O	O	O
images	O	O	O	O	O	O
/	O	O	O	O	O	O
blogs	O	O	O	O	O	O
/	O	O	O	O	O	O
22	O	O	O	O	O	O
.	O	O	O	O	O	O
PNG	O	O	O	O	O	O
)	O	O	O	O	O	O

*	O	O	O	O	O	O
Figure	O	O	O	O	O	O
6	O	O	O	O	O	O
:	O	O	O	O	O	O
AgentTesla	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
activity	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
malware	O	O	O	O	O	O
then	O	O	O	O	O	O
starts	O	O	O	O	O	O
sending	O	O	O	O	O	O
collected	O	O	O	O	O	O
information	O	O	O	O	O	O
and	O	O	O	O	O	O
screenshots	O	O	O	O	O	O
to	O	O	O	O	O	O
the	O	O	O	O	O	O
remote	O	O	O	O	O	O
server	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Format	O	O	O	O	O	O
of	O	O	O	O	O	O
data	O	O	O	O	O	O
it	O	O	O	O	O	O
sends	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
type	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
0	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
hwid	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
1	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
time	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
2	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
pcname	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
3	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
logdata	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
4	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
screen	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
5	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
ipadd	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
6	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
wbscreen	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
7	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
client	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
8	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
link	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
9	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
username	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
10	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
password	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
11	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
screen	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
name	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
12	O	O	O	O	O	O
}	O	O	O	O	O	O
&	O	O	O	O	O	O
site	O	O	O	O	O	O
\	O	O	O	O	O	O
_	O	O	O	O	O	O
username	O	O	O	O	O	O
=	O	O	O	O	O	O
{	O	O	O	O	O	O
13	O	O	O	O	O	O
}	O	O	O	O	O	O
*	O	O	O	O	O	O

|	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
Command	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
|	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
Description	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
webcam	O	O	O	O	O	O
|	O	O	O	O	O	O
Send	O	O	O	O	O	O
images	O	O	O	O	O	O
collected	O	O	O	O	O	O
via	O	O	O	O	O	O
webcam	O	O	O	O	O	O
to	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
server	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
screenshots	O	O	O	O	O	O
|	O	O	O	O	O	O
Send	O	O	O	O	O	O
screenshots	O	O	O	O	O	O
to	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
keylog	O	O	O	O	O	O
|	O	O	O	O	O	O
Send	O	O	O	O	O	O
keystroke	O	O	O	O	O	O
logs	O	O	O	O	O	O
to	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
update	O	O	O	O	O	O
|	O	O	O	O	O	O
Update	O	O	O	O	O	O
keylogger	O	O	O	O	O	O
binary	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
info	O	O	O	O	O	O
|	O	O	O	O	O	O
Send	O	O	O	O	O	O
victim	O	O	O	O	O	O
’	O	O	O	O	O	O
s	O	O	O	O	O	O
machine	O	O	O	O	O	O
information	O	O	O	O	O	O
to	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
uninstall	O	O	O	O	O	O
|	O	O	O	O	O	O
Uninstall	O	O	O	O	O	O
binary	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
passwords	O	O	O	O	O	O
|	O	O	O	O	O	O
Send	O	O	O	O	O	O
stolen	O	O	O	O	O	O
password	O	O	O	O	O	O
to	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
|	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Conclusion	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

Our	O	O	O	O	O	O
investigation	O	O	O	O	O	O
of	O	O	O	O	O	O
this	O	O	O	O	O	O
attack	O	O	O	O	O	O
chain	O	O	O	O	O	O
started	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
keylogger	O	O	O	O	O	O
payload	O	O	O	O	O	O
getting	O	O	O	O	O	O
flagged	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
cloud	O	O	O	O	O	O
sandbox	O	O	O	O	O	O
for	O	O	O	O	O	O
an	O	O	O	O	O	O
enterprise	O	O	O	O	O	O
customer	O	O	O	O	O	O
.	O	O	O	O	O	O

Further	O	O	O	O	O	O
analysis	O	O	O	O	O	O
revealed	O	O	O	O	O	O
usage	O	O	O	O	O	O
of	O	O	O	O	O	O
cybersquatting	O	O	O	O	O	O
for	O	O	O	O	O	O
delivering	O	O	O	O	O	O
the	O	O	O	O	O	O
malware	O	O	O	O	O	O
executable	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
malicious	O	O	O	O	O	O
domain	O	O	O	O	O	O
was	O	O	O	O	O	O
registered	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
same	O	O	O	O	O	O
day	O	O	O	O	O	O
that	O	O	O	O	O	O
the	O	O	O	O	O	O
malicious	O	O	O	O	O	O
documents	O	O	O	O	O	O
,	O	O	O	O	O	O
which	O	O	O	O	O	O
were	O	O	O	O	O	O
claiming	O	O	O	O	O	O
to	O	O	O	O	O	O
be	O	O	O	O	O	O
“	O	O	O	O	O	O
Purchase	O	O	O	O	O	O
Orders	O	O	O	O	O	O
,	O	O	O	O	O	O
”	O	O	O	O	O	O
were	O	O	O	O	O	O
modified	O	O	O	O	O	O
for	O	O	O	O	O	O
the	O	O	O	O	O	O
attack	O	O	O	O	O	O
.	O	O	O	O	O	O

Zscaler	B-ORG	O	O	O	O	B-ORG
ThreatLabZ	O	O	O	O	O	O
will	O	O	O	O	O	O
continue	O	O	O	O	O	O
to	O	O	O	O	O	O
monitor	O	O	O	O	O	O
and	O	O	O	O	O	O
ensure	O	O	O	O	O	O
coverage	O	O	O	O	O	O
against	O	O	O	O	O	O
these	O	O	O	O	O	O
malware	O	O	O	O	O	O
payloads	O	O	O	O	O	O
.	O	O	O	O	O	O

Blog	O	O	O	O	O	O
by	O	O	O	O	O	O
:	O	O	O	O	O	O
Abhaykant	O	O	O	O	O	O
Yadav	O	O	O	O	O	O
,	O	O	O	O	O	O
Deepen	O	O	O	O	O	O
Desai	O	O	O	O	O	O

