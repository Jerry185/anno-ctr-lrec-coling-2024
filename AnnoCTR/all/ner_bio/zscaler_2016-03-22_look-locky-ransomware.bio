<DOCSTART>	O	O	O	O	O	O

A	O	O	O	O	O	O
look	O	O	O	O	O	O
at	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O

March	O	O	B-DATE	O	O	B-DATE
22	O	O	I-DATE	O	O	I-DATE
,	O	O	I-DATE	O	O	I-DATE
2016	O	O	I-DATE	O	O	I-DATE

#	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
Introduction	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
was	O	O	O	O	O	O
first	O	O	O	O	O	O
spotted	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
wild	O	O	O	O	O	O
in	O	O	O	O	O	O
February	O	O	B-DATE	O	O	B-DATE
2016	O	O	I-DATE	O	O	I-DATE
.	O	O	O	O	O	O

Locky	O	O	O	O	O	O
came	O	O	O	O	O	O
into	O	O	O	O	O	O
the	O	O	O	O	O	O
limelight	O	O	O	O	O	O
when	O	O	O	O	O	O
it	O	O	O	O	O	O
hit	O	O	O	O	O	O
the	O	O	O	O	O	O
[	O	O	O	O	O	O
Hollywood	O	O	O	O	O	O
Hospital	O	O	O	O	O	O
]	O	O	O	O	O	O
(	O	O	O	O	O	O
http	O	O	O	O	O	O
:	O	O	O	O	O	O
/	O	O	O	O	O	O
/	O	O	O	O	O	O
www.forbes.com	O	O	O	O	O	O
/	O	O	O	O	O	O
sites	O	O	O	O	O	O
/	O	O	O	O	O	O
thomasbrewster	O	O	O	O	O	O
/	O	O	O	O	O	O
2016	O	O	O	O	O	O
/	O	O	O	O	O	O
02	O	O	O	O	O	O
/	O	O	O	O	O	O
18	O	O	O	O	O	O
/	O	O	O	O	O	O
ransomware-hollywood-payment-locky-menace	O	O	O	O	O	O
/	O	O	O	O	O	O
)	O	O	O	O	O	O
last	O	O	O	O	O	O
month	O	O	O	O	O	O
causing	O	O	O	O	O	O
the	O	O	O	O	O	O
hospital	O	O	O	O	O	O
to	O	O	O	O	O	O
pay	O	O	O	O	O	O
Bitcoins	O	O	O	O	O	O
worth	O	O	O	O	O	O
$17,000	O	O	O	O	O	O
in	O	O	O	O	O	O
ransom	O	O	O	O	O	O
.	O	O	O	O	O	O

Locky	O	O	O	O	O	O
is	O	O	O	O	O	O
known	O	O	O	O	O	O
to	O	O	O	O	O	O
arrive	O	O	O	O	O	O
via	O	O	O	O	O	O
spam	O	O	O	O	O	O
e-mails	O	O	O	O	O	O
containing	O	O	O	O	O	O
malicious	O	O	O	O	O	O
attachments	O	O	O	O	O	O
.	O	O	O	O	O	O

Zscaler	B-ORG	O	O	O	O	B-ORG
has	O	O	O	O	O	O
blocked	O	O	O	O	O	O
over	O	O	O	O	O	O
75	O	O	O	O	O	O
unique	O	O	O	O	O	O
&	O	O	O	O	O	O
new	O	O	O	O	O	O
payloads	O	O	O	O	O	O
from	O	O	O	O	O	O
this	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
family	O	O	O	O	O	O
,	O	O	O	O	O	O
targeting	O	O	O	O	O	O
our	O	O	O	O	O	O
customers	O	O	O	O	O	O
,	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
last	O	O	O	O	O	O
month	O	O	O	O	O	O
as	O	O	O	O	O	O
shown	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
unique	O	O	O	O	O	O
payloads	O	O	O	O	O	O
blocked	O	O	O	O	O	O
|	O	O	O	O	O	O

#	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
The	O	O	O	O	O	O
Locky	O	O	O	O	O	O
payload	O	O	O	O	O	O
delivery	O	O	O	O	O	O
mechanism	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

The	O	O	O	O	O	O
initial	O	O	O	O	O	O
wave	O	O	O	O	O	O
of	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
spam	O	O	O	O	O	O
involved	O	O	O	O	O	O
malicious	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Office	O	O	O	O	O	O
documents	O	O	O	O	O	O
containing	O	O	O	O	O	O
VBA	O	O	O	O	O	O
macro	O	O	O	O	O	O
to	O	O	O	O	O	O
download	O	O	O	O	O	O
and	O	O	O	O	O	O
execute	O	O	O	O	O	O
binary	O	O	O	O	O	O
payload	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
machine	O	O	O	O	O	O
.	O	O	O	O	O	O

Locky	O	O	O	O	O	O
authors	O	O	O	O	O	O
have	O	O	O	O	O	O
since	O	O	O	O	O	O
switched	O	O	O	O	O	O
to	O	O	O	O	O	O
spamming	O	O	O	O	O	O
a	O	O	O	O	O	O
Zip	O	O	O	O	O	O
archive	O	O	O	O	O	O
containing	O	O	O	O	O	O
malicious	O	O	O	O	O	O
JavaScript	O	O	O	O	O	O
to	O	O	O	O	O	O
download	O	O	O	O	O	O
and	O	O	O	O	O	O
execute	O	O	O	O	O	O
the	O	O	O	O	O	O
Locky	O	O	O	O	O	O
payload	O	O	O	O	O	O

A	O	O	O	O	O	O
sample	O	O	O	O	O	O
malicious	O	O	O	O	O	O
document	O	O	O	O	O	O
from	O	O	O	O	O	O
a	O	O	O	O	O	O
Locky	O	O	O	O	O	O
spam	O	O	O	O	O	O
campaign	O	O	O	O	O	O
that	O	O	O	O	O	O
contains	O	O	O	O	O	O
VBA	O	O	O	O	O	O
macro	O	O	O	O	O	O
designed	O	O	O	O	O	O
to	O	O	O	O	O	O
download	O	O	O	O	O	O
the	O	O	O	O	O	O
Locky	O	O	O	O	O	O
payload	O	O	O	O	O	O
from	O	O	O	O	O	O
a	O	O	O	O	O	O
predetermined	O	O	O	O	O	O
remote	O	O	O	O	O	O
location	O	O	O	O	O	O
can	O	O	O	O	O	O
be	O	O	O	O	O	O
seen	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
Malicious	O	O	O	O	O	O
Document	O	O	O	O	O	O
|	O	O	O	O	O	O

A	O	O	O	O	O	O
second	O	O	O	O	O	O
delivery	O	O	O	O	O	O
mechanism	O	O	O	O	O	O
involves	O	O	O	O	O	O
a	O	O	O	O	O	O
heavily	O	O	O	O	O	O
obfuscated	O	O	O	O	O	O
JavaScript	O	O	O	O	O	O
files	O	O	O	O	O	O
in	O	O	O	O	O	O
a	O	O	O	O	O	O
Zip	O	O	O	O	O	O
attachment	O	O	O	O	O	O
.	O	O	O	O	O	O

These	O	O	O	O	O	O
JavaScript	O	O	O	O	O	O
payloads	O	O	O	O	O	O
are	O	O	O	O	O	O
highly	O	O	O	O	O	O
obfuscated	O	O	O	O	O	O
and	O	O	O	O	O	O
leverages	O	O	O	O	O	O
UTF	O	O	O	O	O	O
-	O	O	O	O	O	O
16	O	O	O	O	O	O
encoding	O	O	O	O	O	O
to	O	O	O	O	O	O
hide	O	O	O	O	O	O
the	O	O	O	O	O	O
download	O	O	O	O	O	O
URL	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
authors	O	O	O	O	O	O
are	O	O	O	O	O	O
also	O	O	O	O	O	O
changing	O	O	O	O	O	O
the	O	O	O	O	O	O
obfuscated	O	O	O	O	O	O
payload	O	O	O	O	O	O
regularly	O	O	O	O	O	O
in	O	O	O	O	O	O
order	O	O	O	O	O	O
to	O	O	O	O	O	O
evade	O	O	O	O	O	O
AV	O	O	O	O	O	O
detection	O	O	O	O	O	O
,	O	O	O	O	O	O
a	O	O	O	O	O	O
technique	O	O	O	O	O	O
commonly	O	O	O	O	O	O
used	O	O	O	O	O	O
by	O	O	O	O	O	O
Exploit	O	O	O	O	O	O
Kit	O	O	O	O	O	O
(	O	O	O	O	O	O
EK	O	O	O	O	O	O
)	O	O	O	O	O	O
authors	O	O	O	O	O	O
to	O	O	O	O	O	O
protect	O	O	O	O	O	O
the	O	O	O	O	O	O
EK	O	O	O	O	O	O
landing	O	O	O	O	O	O
pages	O	O	O	O	O	O
.	O	O	O	O	O	O

A	O	O	O	O	O	O
sample	O	O	O	O	O	O
malicious	O	O	O	O	O	O
JavaScript	O	O	O	O	O	O
code	O	O	O	O	O	O
delivering	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
can	O	O	O	O	O	O
be	O	O	O	O	O	O
seen	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
Obfuscated	O	O	O	O	O	O
JavaScript	O	O	O	O	O	O
to	O	O	O	O	O	O
deliver	O	O	O	O	O	O
Locky	O	O	O	O	O	O
|	O	O	O	O	O	O

The	O	O	O	O	O	O
JavaScript	O	O	O	O	O	O
uses	O	O	O	O	O	O
ActiveX	O	O	O	O	O	O
objects	O	O	O	O	O	O
to	O	O	O	O	O	O
download	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
on	O	O	O	O	O	O
victim's	O	O	O	O	O	O
machine	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
decoded	O	O	O	O	O	O
JavaScript	O	O	O	O	O	O
is	O	O	O	O	O	O
shown	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
Decoded	O	O	O	O	O	O
JavaScript	O	O	O	O	O	O
|	O	O	O	O	O	O

#	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
Payload	O	O	O	O	O	O
Analysis	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

We	O	O	O	O	O	O
have	O	O	O	O	O	O
seen	O	O	O	O	O	O
a	O	O	O	O	O	O
large	O	O	O	O	O	O
uptick	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
delivery	O	O	O	O	O	O
of	O	O	O	O	O	O
Locky	O	O	O	O	O	O
payloads	O	O	O	O	O	O
during	O	O	O	O	O	O
the	O	O	O	O	O	O
month	O	O	O	O	O	O
of	O	O	O	O	O	O
March	O	O	B-DATE	O	O	B-DATE
2016	O	O	I-DATE	O	O	I-DATE
.	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
Uptick	O	O	O	O	O	O
in	O	O	O	O	O	O
Locky	O	O	O	O	O	O
payloads	O	O	O	O	O	O
getting	O	O	O	O	O	O
blocked	O	O	O	O	O	O
|	O	O	O	O	O	O

We	O	O	O	O	O	O
looked	O	O	O	O	O	O
at	O	O	O	O	O	O
one	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
newer	O	O	O	O	O	O
Locky	O	O	O	O	O	O
variant	O	O	O	O	O	O
that	O	O	O	O	O	O
was	O	O	O	O	O	O
seen	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
wild	O	O	O	O	O	O
recently	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
analyzed	O	O	O	O	O	O
Locky	O	O	O	O	O	O
payload	O	O	O	O	O	O
is	O	O	O	O	O	O
a	O	O	O	O	O	O
32	O	O	O	O	O	O
-	O	O	O	O	O	O
bit	O	O	O	O	O	O
Microsoft	B-ORG	O	O	O	O	B-ORG
Visual	O	O	O	O	O	O
C	O	O	O	O	O	O
+	O	O	O	O	O	O
+	O	O	O	O	O	O
compiled	O	O	O	O	O	O
Windows	O	O	O	O	O	O
executable	O	O	O	O	O	O
packed	O	O	O	O	O	O
using	O	O	O	O	O	O
custom	O	O	O	O	O	O
packer	O	O	O	O	O	O
routine	O	O	O	O	O	O
.	O	O	O	O	O	O

Upon	O	O	O	O	O	O
execution	O	O	O	O	O	O
,	O	O	O	O	O	O
the	O	O	O	O	O	O
malware	O	O	O	O	O	O
first	O	O	O	O	O	O
checks	O	O	O	O	O	O
for	O	O	O	O	O	O
the	O	O	O	O	O	O
user	O	O	O	O	O	O
&	O	O	O	O	O	O
system	O	O	O	O	O	O
default	O	O	O	O	O	O
language	O	O	O	O	O	O
preferences	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
infected	O	O	O	O	O	O
system	O	O	O	O	O	O
and	O	O	O	O	O	O
terminates	O	O	O	O	O	O
itself	O	O	O	O	O	O
if	O	O	O	O	O	O
the	O	O	O	O	O	O
language	O	O	O	O	O	O
is	O	O	O	O	O	O
Russian	B-LOC	O	O	O	O	B-LOC
.	O	O	O	O	O	O

Locky	O	O	O	O	O	O
creates	O	O	O	O	O	O
a	O	O	O	O	O	O
copy	O	O	O	O	O	O
of	O	O	O	O	O	O
itself	O	O	O	O	O	O
as	O	O	O	O	O	O
"	O	O	O	O	O	O
%	O	O	O	O	O	O
TEMP	O	O	O	O	O	O
%	O	O	O	O	O	O
/	O	O	O	O	O	O
svchost.exe	O	O	O	O	O	O
"	O	O	O	O	O	O
and	O	O	O	O	O	O
an	O	O	O	O	O	O
auto	O	O	O	O	O	O
start	O	O	O	O	O	O
registry	O	O	O	O	O	O
key	O	O	O	O	O	O
entry	O	O	O	O	O	O
to	O	O	O	O	O	O
ensure	O	O	O	O	O	O
persistence	O	O	O	O	O	O
upon	O	O	O	O	O	O
system	O	O	O	O	O	O
reboot	O	O	O	O	O	O
.	O	O	O	O	O	O

In	O	O	O	O	O	O
order	O	O	O	O	O	O
to	O	O	O	O	O	O
mark	O	O	O	O	O	O
a	O	O	O	O	O	O
successful	O	O	O	O	O	O
infection	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
system	O	O	O	O	O	O
,	O	O	O	O	O	O
Locky	O	O	O	O	O	O
creates	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
registry	O	O	O	O	O	O
keys	O	O	O	O	O	O
with	O	O	O	O	O	O
value	O	O	O	O	O	O
name	O	O	O	O	O	O
"	O	O	O	O	O	O
pubkey	O	O	O	O	O	O
"	O	O	O	O	O	O
and	O	O	O	O	O	O
"	O	O	O	O	O	O
paytext	O	O	O	O	O	O
"	O	O	O	O	O	O
as	O	O	O	O	O	O
seen	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
Locky	O	O	O	O	O	O
registry	O	O	O	O	O	O
key	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
"	O	O	O	O	O	O
pubkey	O	O	O	O	O	O
"	O	O	O	O	O	O
is	O	O	O	O	O	O
used	O	O	O	O	O	O
to	O	O	O	O	O	O
store	O	O	O	O	O	O
the	O	O	O	O	O	O
RSA	O	O	O	O	O	O
key	O	O	O	O	O	O
used	O	O	O	O	O	O
for	O	O	O	O	O	O
encryption"paytext	O	O	O	O	O	O
"	O	O	O	O	O	O
is	O	O	O	O	O	O
used	O	O	O	O	O	O
to	O	O	O	O	O	O
store	O	O	O	O	O	O
the	O	O	O	O	O	O
payment	O	O	O	O	O	O
related	O	O	O	O	O	O
information	O	O	O	O	O	O
|	O	O	O	O	O	O

Upon	O	O	O	O	O	O
successful	O	O	O	O	O	O
infection	O	O	O	O	O	O
,	O	O	O	O	O	O
Locky	O	O	O	O	O	O
will	O	O	O	O	O	O
encrypt	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
file	O	O	O	O	O	O
types	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
machine	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
File	O	O	O	O	O	O
types	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
|	O	O	O	O	O	O

These	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
files	O	O	O	O	O	O
are	O	O	O	O	O	O
renamed	O	O	O	O	O	O
to	O	O	O	O	O	O
unique	O	O	O	O	O	O
ID	O	O	O	O	O	O
generated	O	O	O	O	O	O
for	O	O	O	O	O	O
the	O	O	O	O	O	O
victim's	O	O	O	O	O	O
machine	O	O	O	O	O	O
followed	O	O	O	O	O	O
by	O	O	O	O	O	O
unique	O	O	O	O	O	O
file	O	O	O	O	O	O
ID	O	O	O	O	O	O
and	O	O	O	O	O	O
a	O	O	O	O	O	O
"	O	O	O	O	O	O
.	O	O	O	O	O	O
locky	O	O	O	O	O	O
"	O	O	O	O	O	O
extension	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
ransom	O	O	O	O	O	O
note	O	O	O	O	O	O
is	O	O	O	O	O	O
displayed	O	O	O	O	O	O
in	O	O	O	O	O	O
a	O	O	O	O	O	O
bitmap	O	O	O	O	O	O
image	O	O	O	O	O	O
that	O	O	O	O	O	O
is	O	O	O	O	O	O
also	O	O	O	O	O	O
set	O	O	O	O	O	O
as	O	O	O	O	O	O
a	O	O	O	O	O	O
wallpaper	O	O	O	O	O	O
for	O	O	O	O	O	O
the	O	O	O	O	O	O
infected	O	O	O	O	O	O
user's	O	O	O	O	O	O
desktop	O	O	O	O	O	O
as	O	O	O	O	O	O
seen	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
Ransom	O	O	O	O	O	O
note	O	O	O	O	O	O
|	O	O	O	O	O	O

As	O	O	O	O	O	O
seen	O	O	O	O	O	O
in	O	O	O	O	O	O
case	O	O	O	O	O	O
of	O	O	O	O	O	O
other	O	O	O	O	O	O
crypto	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
families	O	O	O	O	O	O
,	O	O	O	O	O	O
victim's	O	O	O	O	O	O
files	O	O	O	O	O	O
are	O	O	O	O	O	O
held	O	O	O	O	O	O
as	O	O	O	O	O	O
hostage	O	O	O	O	O	O
for	O	O	O	O	O	O
a	O	O	O	O	O	O
ransom	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
ransom	O	O	O	O	O	O
payment	O	O	O	O	O	O
instructions	O	O	O	O	O	O
for	O	O	O	O	O	O
receiving	O	O	O	O	O	O
the	O	O	O	O	O	O
private	O	O	O	O	O	O
RSA	O	O	O	O	O	O
key	O	O	O	O	O	O
required	O	O	O	O	O	O
to	O	O	O	O	O	O
decrypt	O	O	O	O	O	O
the	O	O	O	O	O	O
user	O	O	O	O	O	O
files	O	O	O	O	O	O
is	O	O	O	O	O	O
readily	O	O	O	O	O	O
available	O	O	O	O	O	O
through	O	O	O	O	O	O
the	O	O	O	O	O	O
URLs	O	O	O	O	O	O
mentioned	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
ransom	O	O	O	O	O	O
note	O	O	O	O	O	O
.	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
Payment	O	O	O	O	O	O
instructions	O	O	O	O	O	O
|	O	O	O	O	O	O

#	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
Command	O	O	O	O	O	O
&	O	O	O	O	O	O
Control	O	O	O	O	O	O
communication	O	O	O	O	O	O

The	O	O	O	O	O	O
Locky	O	O	O	O	O	O
payload	O	O	O	O	O	O
contains	O	O	O	O	O	O
a	O	O	O	O	O	O
list	O	O	O	O	O	O
of	O	O	O	O	O	O
hardcoded	O	O	O	O	O	O
Command	O	O	O	O	O	O
&	O	O	O	O	O	O
Control	O	O	O	O	O	O
(	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
)	O	O	O	O	O	O
server	O	O	O	O	O	O
IP	O	O	O	O	O	O
addresses	O	O	O	O	O	O
that	O	O	O	O	O	O
appear	O	O	O	O	O	O
in	O	O	O	O	O	O
plain	O	O	O	O	O	O
text	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
unpacked	O	O	O	O	O	O
binary	O	O	O	O	O	O
as	O	O	O	O	O	O
seen	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
Hardcoded	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
IPs	O	O	O	O	O	O
|	O	O	O	O	O	O

In	O	O	O	O	O	O
addition	O	O	O	O	O	O
,	O	O	O	O	O	O
Locky	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
also	O	O	O	O	O	O
leverages	O	O	O	O	O	O
a	O	O	O	O	O	O
custom	O	O	O	O	O	O
Domain	O	O	O	O	O	O
Generation	O	O	O	O	O	O
Algorithm	O	O	O	O	O	O
(	O	O	O	O	O	O
DGA	O	O	O	O	O	O
)	O	O	O	O	O	O
for	O	O	O	O	O	O
hiding	O	O	O	O	O	O
its	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
server	O	O	O	O	O	O
location	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
DGA	O	O	O	O	O	O
algorithm	O	O	O	O	O	O
used	O	O	O	O	O	O
for	O	O	O	O	O	O
generating	O	O	O	O	O	O
possible	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
domains	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
payload	O	O	O	O	O	O
that	O	O	O	O	O	O
we	O	O	O	O	O	O
analyzed	O	O	O	O	O	O
can	O	O	O	O	O	O
be	O	O	O	O	O	O
seen	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
Domain	O	O	O	O	O	O
Generation	O	O	O	O	O	O
Algorithm	O	O	O	O	O	O
|	O	O	O	O	O	O

Locky	O	O	O	O	O	O
communicates	O	O	O	O	O	O
with	O	O	O	O	O	O
the	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
server	O	O	O	O	O	O
using	O	O	O	O	O	O
custom	O	O	O	O	O	O
encryption	O	O	O	O	O	O
and	O	O	O	O	O	O
the	O	O	O	O	O	O
following	O	O	O	O	O	O
HTTP	O	O	O	O	O	O
request	O	O	O	O	O	O
format	O	O	O	O	O	O
:	O	O	O	O	O	O

*	O	O	O	O	O	O
POST	O	B-CLICommand/CodeSnippet	O	O	O	B-CLICommand/CodeSnippet
 	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
http	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
:	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
/	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
/	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
[	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
hardcoded	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
IP	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
 	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
or	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
DGA	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
domain	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
]	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
/	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
main.php	O	I-CLICommand/CodeSnippet	O	O	O	I-CLICommand/CodeSnippet
*	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
Sample	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
communication	O	O	O	O	O	O
|	O	O	O	O	O	O

The	O	O	O	O	O	O
initial	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
communication	O	O	O	O	O	O
typically	O	O	O	O	O	O
consists	O	O	O	O	O	O
of	O	O	O	O	O	O
three	O	O	O	O	O	O
HTTP	O	O	O	O	O	O
POST	O	O	O	O	O	O
requests	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Request	O	O	O	O	O	O
#1	O	O	O	O	O	O
:	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
Register	O	O	O	O	O	O
the	O	O	O	O	O	O
infected	O	O	O	O	O	O
system's	O	O	O	O	O	O
unique	O	O	O	O	O	O
ID	O	O	O	O	O	O
and	O	O	O	O	O	O
request	O	O	O	O	O	O
RSA	O	O	O	O	O	O
key	O	O	O	O	O	O
to	O	O	O	O	O	O
be	O	O	O	O	O	O
used	O	O	O	O	O	O
for	O	O	O	O	O	O
encrypting	O	O	O	O	O	O
user	O	O	O	O	O	O
files	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
figure	O	O	O	O	O	O
below	O	O	O	O	O	O
shows	O	O	O	O	O	O
the	O	O	O	O	O	O
content	O	O	O	O	O	O
of	O	O	O	O	O	O
this	O	O	O	O	O	O
POST	O	O	O	O	O	O
request	O	O	O	O	O	O
in	O	O	O	O	O	O
plain	O	O	O	O	O	O
text	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
request	O	O	O	O	O	O
#1	O	O	O	O	O	O
|	O	O	O	O	O	O

The	O	O	O	O	O	O
server	O	O	O	O	O	O
responds	O	O	O	O	O	O
back	O	O	O	O	O	O
with	O	O	O	O	O	O
a	O	O	O	O	O	O
RSA	O	O	O	O	O	O
key	O	O	O	O	O	O
that	O	O	O	O	O	O
is	O	O	O	O	O	O
used	O	O	O	O	O	O
by	O	O	O	O	O	O
Locky	O	O	O	O	O	O
to	O	O	O	O	O	O
encrypt	O	O	O	O	O	O
all	O	O	O	O	O	O
the	O	O	O	O	O	O
user's	O	O	O	O	O	O
files	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
victim	O	O	O	O	O	O
machine	O	O	O	O	O	O
.	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Request	O	O	O	O	O	O
#2	O	O	O	O	O	O
:	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
Request	O	O	O	O	O	O
the	O	O	O	O	O	O
content	O	O	O	O	O	O
of	O	O	O	O	O	O
ransom	O	O	O	O	O	O
note	O	O	O	O	O	O
to	O	O	O	O	O	O
be	O	O	O	O	O	O
displayed	O	O	O	O	O	O
on	O	O	O	O	O	O
the	O	O	O	O	O	O
infected	O	O	O	O	O	O
system	O	O	O	O	O	O
asking	O	O	O	O	O	O
for	O	O	O	O	O	O
payment	O	O	O	O	O	O
.	O	O	O	O	O	O

Below	O	O	O	O	O	O
is	O	O	O	O	O	O
the	O	O	O	O	O	O
content	O	O	O	O	O	O
of	O	O	O	O	O	O
this	O	O	O	O	O	O
POST	O	O	O	O	O	O
request	O	O	O	O	O	O
as	O	O	O	O	O	O
well	O	O	O	O	O	O
as	O	O	O	O	O	O
the	O	O	O	O	O	O
response	O	O	O	O	O	O
from	O	O	O	O	O	O
the	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
server	O	O	O	O	O	O
in	O	O	O	O	O	O
decoded	O	O	O	O	O	O
form	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
request	O	O	O	O	O	O
#2	O	O	O	O	O	O
&	O	O	O	O	O	O
response	O	O	O	O	O	O
|	O	O	O	O	O	O

*	O	O	O	O	O	O
*	O	O	O	O	O	O
Request	O	O	O	O	O	O
#3	O	O	O	O	O	O
:	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
The	O	O	O	O	O	O
final	O	O	O	O	O	O
request	O	O	O	O	O	O
sends	O	O	O	O	O	O
the	O	O	O	O	O	O
statistics	O	O	O	O	O	O
about	O	O	O	O	O	O
successfully	O	O	O	O	O	O
encrypted	O	O	O	O	O	O
files	O	O	O	O	O	O
as	O	O	O	O	O	O
seen	O	O	O	O	O	O
below	O	O	O	O	O	O
:	O	O	O	O	O	O

|	O	O	O	O	O	O
|	O	O	O	O	O	O

|	O	O	O	O	O	O
C	O	O	O	O	O	O
&	O	O	O	O	O	O
C	O	O	O	O	O	O
request	O	O	O	O	O	O
#3	O	O	O	O	O	O
|	O	O	O	O	O	O

#	O	O	O	O	O	O
#	O	O	O	O	O	O
#	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O
Conclusion	O	O	O	O	O	O
*	O	O	O	O	O	O
*	O	O	O	O	O	O

Locky	O	O	O	O	O	O
is	O	O	O	O	O	O
the	O	O	O	O	O	O
latest	O	O	O	O	O	O
addition	O	O	O	O	O	O
to	O	O	O	O	O	O
Ransomware	O	O	O	O	O	O
,	O	O	O	O	O	O
one	O	O	O	O	O	O
of	O	O	O	O	O	O
the	O	O	O	O	O	O
most	O	O	O	O	O	O
active	O	O	O	O	O	O
&	O	O	O	O	O	O
lucrative	O	O	O	O	O	O
malware	O	O	O	O	O	O
strains	O	O	O	O	O	O
seen	O	O	O	O	O	O
in	O	O	O	O	O	O
past	O	O	O	O	O	O
three	O	O	O	O	O	O
years	O	O	O	O	O	O
.	O	O	O	O	O	O

This	O	O	O	O	O	O
new	O	O	O	O	O	O
ransomware	O	O	O	O	O	O
family	O	O	O	O	O	O
follows	O	O	O	O	O	O
the	O	O	O	O	O	O
same	O	O	O	O	O	O
model	O	O	O	O	O	O
of	O	O	O	O	O	O
using	O	O	O	O	O	O
asymmetric	O	O	O	O	O	O
(	O	O	O	O	O	O
public	O	O	O	O	O	O
key	O	O	O	O	O	O
)	O	O	O	O	O	O
encryption	O	O	O	O	O	O
to	O	O	O	O	O	O
lock	O	O	O	O	O	O
user	O	O	O	O	O	O
documents	O	O	O	O	O	O
and	O	O	O	O	O	O
demand	O	O	O	O	O	O
ransom	O	O	O	O	O	O
for	O	O	O	O	O	O
the	O	O	O	O	O	O
decryption	O	O	O	O	O	O
key	O	O	O	O	O	O
.	O	O	O	O	O	O

The	O	O	O	O	O	O
delivery	O	O	O	O	O	O
vector	O	O	O	O	O	O
has	O	O	O	O	O	O
been	O	O	O	O	O	O
primarily	O	O	O	O	O	O
spammed	O	O	O	O	O	O
e-mail	O	O	O	O	O	O
attachments	O	O	O	O	O	O
that	O	O	O	O	O	O
are	O	O	O	O	O	O
responsible	O	O	O	O	O	O
for	O	O	O	O	O	O
downloading	O	O	O	O	O	O
the	O	O	O	O	O	O
Locky	O	O	O	O	O	O
payload	O	O	O	O	O	O
.	O	O	O	O	O	O

We	O	O	O	O	O	O
also	O	O	O	O	O	O
noticed	O	O	O	O	O	O
an	O	O	O	O	O	O
interesting	O	O	O	O	O	O
overlap	O	O	O	O	O	O
in	O	O	O	O	O	O
the	O	O	O	O	O	O
recent	O	O	O	O	O	O
campaigns	O	O	O	O	O	O
where	O	O	O	O	O	O
same	O	O	O	O	O	O
URLs	O	O	O	O	O	O
were	O	O	O	O	O	O
being	O	O	O	O	O	O
used	O	O	O	O	O	O
to	O	O	O	O	O	O
deliver	O	O	O	O	O	O
both	O	O	O	O	O	O
Dridex	O	O	O	O	O	O
&	O	O	O	O	O	O
Locky	O	O	O	O	O	O
payloads	O	O	O	O	O	O
.	O	O	O	O	O	O

Zscaler	B-ORG	O	O	O	O	B-ORG
’	O	O	O	O	O	O
s	O	O	O	O	O	O
ThreatLabZ	O	O	O	O	O	O
has	O	O	O	O	O	O
confirmed	O	O	O	O	O	O
coverage	O	O	O	O	O	O
for	O	O	O	O	O	O
the	O	O	O	O	O	O
initial	O	O	O	O	O	O
downloader	O	O	O	O	O	O
and	O	O	O	O	O	O
Locky	O	O	O	O	O	O
payloads	O	O	O	O	O	O
,	O	O	O	O	O	O
ensuring	O	O	O	O	O	O
protection	O	O	O	O	O	O
for	O	O	O	O	O	O
organizations	O	O	O	O	O	O
using	O	O	O	O	O	O
Zscaler	B-ORG	O	O	O	O	B-ORG
’	O	O	O	O	O	O
s	O	O	O	O	O	O
Internet	O	O	O	O	O	O
security	O	O	O	O	O	O
platform	O	O	O	O	O	O
.	O	O	O	O	O	O

Research	O	O	O	O	O	O
by	O	O	O	O	O	O
:	O	O	O	O	O	O
Deepen	O	O	O	O	O	O
Desai	O	O	O	O	O	O
,	O	O	O	O	O	O
Dhanalakshmi	O	O	O	O	O	O
PK	O	O	O	O	O	O

