{"mention": "APT-C-36", "context_left": "", "context_right": "new anti-detection tricks March 23, 2020", "_context_left": "", "_context_right": " new anti-detection tricks", "sentence_left": "", "sentence_right": "March 23, 2020", "label": "[APT-C-36](https://attack.mitre.org/groups/G0099) is a suspected South America espionage group that has been active since at least 2018. The group mainly targets Colombian government institutions as well as important corporations in the financial sector, petroleum industry, and professional manufacturing.(Citation: QiAnXin APT-C-36 Feb2019)", "label_id": 1251, "label_title": "APT-C-36", "label_link": "https://attack.mitre.org/groups/G0099", "entity_class": "CE", "entity_type": "GROUP", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "Lab52", "context_left": "March 23, 2020", "context_right": "has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti Malware software, using a more complex infection chain than a simple packer, as they have been doing so far. The sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group.", "_context_left": "", "_context_right": " has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti Malware software, using a more complex infection chain than a simple packer, as they have been doing so far.", "sentence_left": "March 23, 2020", "sentence_right": "The sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "APT-C-36", "context_left": "March 23, 2020 Lab52 has recently detected an increase in the efforts carried out by", "context_right": "to improve their capabilities to remain undetected by Anti Malware software, using a more complex infection chain than a simple packer, as they have been doing so far. The sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group.", "_context_left": "Lab52 has recently detected an increase in the efforts carried out by ", "_context_right": " to improve their capabilities to remain undetected by Anti Malware software, using a more complex infection chain than a simple packer, as they have been doing so far.", "sentence_left": "March 23, 2020", "sentence_right": "The sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group.", "label": "[APT-C-36](https://attack.mitre.org/groups/G0099) is a suspected South America espionage group that has been active since at least 2018. The group mainly targets Colombian government institutions as well as important corporations in the financial sector, petroleum industry, and professional manufacturing.(Citation: QiAnXin APT-C-36 Feb2019)", "label_id": 1251, "label_title": "APT-C-36", "label_link": "https://attack.mitre.org/groups/G0099", "entity_class": "CE", "entity_type": "GROUP", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "Malware", "context_left": "March 23, 2020 Lab52 has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti", "context_right": "software, using a more complex infection chain than a simple packer, as they have been doing so far. The sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group.", "_context_left": "Lab52 has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti ", "_context_right": " software, using a more complex infection chain than a simple packer, as they have been doing so far.", "sentence_left": "March 23, 2020", "sentence_right": "The sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group.", "label": "Malware (a portmanteau for malicious software) is any software intentionally designed to cause damage to a computer, server, client, or computer network. Malware does the damage after it is implanted or introduced in some way into a target's computer and can take the form of executable code, scripts, active content, and other software. The code is described as computer viruses, worms, Trojan horses, ransomware, spyware, adware, and scareware, among other terms. Malware has a malicious intent, acting against the interest of the computer user—and so does not include software that causes unintentional harm due to some deficiency, which is typically described as a software bug.  Programs officially supplied by companies can be considered malware if they secretly act against the interests of the computer user. For example, at one point Sony music Compact discs silently installed a rootkit on purchasers' computers with the intention of preventing illicit copying; but which also reported on users' listening habits, and unintentionally created extra security vulnerabilities.  One strategy for protecting against malware is to prevent the harmful software from gaining access to the target computer. For this reason, antivirus software, firewalls and other strategies are used to help protect against the introduction of malware, in addition to checking for the presence of malware and malicious activity and recovering from attacks.", "label_id": 10247, "label_title": "Malware", "label_link": "https://en.wikipedia.org/wiki?curid=20901", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "using a more complex infection chain than a simple packer, as they have been doing so far", "context_left": "March 23, 2020 Lab52 has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti Malware software,", "context_right": ". The sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group.", "_context_left": "Lab52 has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti Malware software, ", "_context_right": ".", "sentence_left": "March 23, 2020", "sentence_right": "The sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group.", "label": "Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. Payloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as JavaScript. Portions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016) Adversaries may also obfuscate commands executed from payloads or directly via a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017)(Citation: PaloAlto EncodedCommand March 2017)", "label_id": 544, "label_title": "Obfuscated Files or Information", "label_link": "https://attack.mitre.org/techniques/T1027", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "lab52", "context_left": "The sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group. ![](https://", "context_right": ".io/blog/wp-content/uploads/2020/03/1.png) Until now, these binaries were executables packed with common anti-virus circumvention software, but in this case it is an “SFX", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2020/03/1.png)", "sentence_left": "The sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group.", "sentence_right": "Until now, these binaries were executables packed with common anti-virus circumvention software, but in this case it is an “SFX", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "executables packed", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/1.png) Until now, these binaries were", "context_right": "with common anti-virus circumvention software, but in this case it is an “SFX Installer” that contains a bunch of files, including some that are simply trash and others that are part of the infection chain:", "_context_left": "Until now, these binaries were ", "_context_right": " with common anti-virus circumvention software, but in this case it is an “SFX", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/1.png)", "sentence_right": "Installer” that contains a bunch of files, including some that are simply trash and others that are part of the infection chain:", "label": "Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. Payloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as JavaScript. Portions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016) Adversaries may also obfuscate commands executed from payloads or directly via a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017)(Citation: PaloAlto EncodedCommand March 2017)", "label_id": 544, "label_title": "Obfuscated Files or Information", "label_link": "https://attack.mitre.org/techniques/T1027", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "lab52", "context_left": "Installer” that contains a bunch of files, including some that are simply trash and others that are part of the infection chain: ![](https://", "context_right": ".io/blog/wp-content/uploads/2020/03/2.png) When these installers are executed, they create a temporary folder on the system, where they dump all the files they contain, and then execute one of them as an “Entry Point” in the execution/infection chain.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2020/03/2.png)", "sentence_left": "Installer” that contains a bunch of files, including some that are simply trash and others that are part of the infection chain:", "sentence_right": "When these installers are executed, they create a temporary folder on the system, where they dump all the files they contain, and then execute one of them as an “Entry Point” in the execution/infection chain.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "execute one of them as an “Entry Point” in the execution/infection chain", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/2.png) When these installers are executed, they create a temporary folder on the system, where they dump all the files they contain, and then", "context_right": ". In this case, it is called gospels.exe:", "_context_left": "When these installers are executed, they create a temporary folder on the system, where they dump all the files they contain, and then ", "_context_right": ".", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/2.png)", "sentence_right": "In this case, it is called gospels.exe:", "label": "The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery.", "label_id": 588, "label_title": "Execution", "label_link": "https://attack.mitre.org/tactics/TA0002", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "they create a temporary folder on the system, where they dump all the files they contain", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/2.png) When these installers are executed,", "context_right": ", and then execute one of them as an “Entry Point” in the execution/infection chain. In this case, it is called gospels.exe:", "_context_left": "When these installers are executed, ", "_context_right": ", and then execute one of them as an “Entry Point” in the execution/infection chain.", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/2.png)", "sentence_right": "In this case, it is called gospels.exe:", "label": "Adversaries may stage collected data in a central location or directory prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells may be used, and common functionality within [cmd](https://attack.mitre.org/software/S0106) and bash may be used to copy data into a staging location.(Citation: PWC Cloud Hopper April 2017) In cloud environments, adversaries may stage data within a particular instance or virtual machine before exfiltration. An adversary may [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002) and stage data in that instance.(Citation: Mandiant M-Trends 2020) Adversaries may choose to stage data from a victim network in a centralized location prior to Exfiltration to minimize the number of connections made to their C2 server and better evade detection.", "label_id": 420, "label_title": "Data Staged", "label_link": "https://attack.mitre.org/techniques/T1074", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "lab52", "context_left": "In this case, it is called gospels.exe: ![](https://", "context_right": ".io/blog/wp-content/uploads/2020/03/3.png) ![](https://lab52.io/blog/wp-content/uploads/2020/03/4.png)", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2020/03/3.png)", "sentence_left": "In this case, it is called gospels.exe:", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/4.png)", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "lab52", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/3.png) ![](https://", "context_right": ".io/blog/wp-content/uploads/2020/03/4.png) This executable consists of a very small program that simply loads dynamically the library “Quoteworthy.dll” that is near the binary, and calls its exported function “Excluders”, passing as parameters some system APIs resolved by the original executable:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2020/03/4.png)", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/3.png)", "sentence_right": "This executable consists of a very small program that simply loads dynamically the library “Quoteworthy.dll” that is near the binary, and calls its exported function “Excluders”, passing as parameters some system APIs resolved by the original executable:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "executable", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/4.png) This", "context_right": "consists of a very small program that simply loads dynamically the library “Quoteworthy.dll” that is near the binary, and calls its exported function “Excluders”, passing as parameters some system APIs resolved by the original executable: ![](https://lab52.io/blog/wp-content/uploads/2020/03/5.png)", "_context_left": "This ", "_context_right": " consists of a very small program that simply loads dynamically the library “Quoteworthy.dll” that is near the binary, and calls its exported function “Excluders”, passing as parameters some system APIs resolved by the original executable:", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/4.png)", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/5.png)", "label": "An adversary may rely upon specific actions by a user in order to gain execution. Users may be subjected to social engineering to get them to execute malicious code by, for example, opening a malicious document file or link. These user actions will typically be observed as follow-on behavior from forms of [Phishing](https://attack.mitre.org/techniques/T1566). While [User Execution](https://attack.mitre.org/techniques/T1204) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).", "label_id": 260, "label_title": "User Execution", "label_link": "https://attack.mitre.org/techniques/T1204", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "small program that simply loads dynamically the library “Quoteworthy.dll” that is near the binary", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/4.png) This executable consists of a very", "context_right": ", and calls its exported function “Excluders”, passing as parameters some system APIs resolved by the original executable: ![](https://lab52.io/blog/wp-content/uploads/2020/03/5.png)", "_context_left": "This executable consists of a very ", "_context_right": ", and calls its exported function “Excluders”, passing as parameters some system APIs resolved by the original executable:", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/4.png)", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/5.png)", "label": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "label_id": 318, "label_title": "Process Injection", "label_link": "https://attack.mitre.org/techniques/T1055", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "lab52", "context_left": "This executable consists of a very small program that simply loads dynamically the library “Quoteworthy.dll” that is near the binary, and calls its exported function “Excluders”, passing as parameters some system APIs resolved by the original executable: ![](https://", "context_right": ".io/blog/wp-content/uploads/2020/03/5.png) The DLL’s Excluders function simply calls two internal functions:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2020/03/5.png)", "sentence_left": "This executable consists of a very small program that simply loads dynamically the library “Quoteworthy.dll” that is near the binary, and calls its exported function “Excluders”, passing as parameters some system APIs resolved by the original executable:", "sentence_right": "The DLL’s Excluders function simply calls two internal functions:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "lab52", "context_left": "The DLL’s Excluders function simply calls two internal functions: ![](https://", "context_right": ".io/blog/wp-content/uploads/2020/03/6.png) The first one (unk\\_6D321170), consists of code that is part of the DLL, and that is in charge of deciphering (with an XOR algorithm) a buffer contained in the .data section of the library.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2020/03/6.png)", "sentence_left": "The DLL’s Excluders function simply calls two internal functions:", "sentence_right": "The first one (unk\\_6D321170), consists of code that is part of the DLL, and that is in charge of deciphering (with an XOR algorithm) a buffer contained in the .data section of the library.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "charge of deciphering (with an XOR algorithm) a buffer contained in the .data section of the library", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/6.png) The first one (unk\\_6D321170), consists of code that is part of the DLL, and that is in", "context_right": ". Inside this buffer, the function ignores out of every 4 bytes (since they are zeros).", "_context_left": "The first one (unk\\_6D321170), consists of code that is part of the DLL, and that is in ", "_context_right": ".", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/6.png)", "sentence_right": "Inside this buffer, the function ignores out of every 4 bytes (since they are zeros).", "label": "Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system. One such example is use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file. (Citation: Malwarebytes Targeted Attack against Saudi Arabia) Another example is using the Windows <code>copy /b</code> command to reassemble binary fragments into a malicious payload. (Citation: Carbon Black Obfuscation Sept 2016) Sometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016)", "label_id": 514, "label_title": "Deobfuscate/Decode Files or Information", "label_link": "https://attack.mitre.org/techniques/T1140", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "Inside this buffer, the function ignores out of every 4 bytes (since they are zeros)", "context_left": "The first one (unk\\_6D321170), consists of code that is part of the DLL, and that is in charge of deciphering (with an XOR algorithm) a buffer contained in the .data section of the library.", "context_right": ". After building this buffer, it reserves a memory area with execution permissions and copies there the decoded content.", "_context_left": "", "_context_right": ".", "sentence_left": "The first one (unk\\_6D321170), consists of code that is part of the DLL, and that is in charge of deciphering (with an XOR algorithm) a buffer contained in the .data section of the library.", "sentence_right": "After building this buffer, it reserves a memory area with execution permissions and copies there the decoded content.", "label": "Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system. One such example is use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file. (Citation: Malwarebytes Targeted Attack against Saudi Arabia) Another example is using the Windows <code>copy /b</code> command to reassemble binary fragments into a malicious payload. (Citation: Carbon Black Obfuscation Sept 2016) Sometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016)", "label_id": 514, "label_title": "Deobfuscate/Decode Files or Information", "label_link": "https://attack.mitre.org/techniques/T1140", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "reserves a memory area with execution permissions and copies there the decoded content", "context_left": "Inside this buffer, the function ignores out of every 4 bytes (since they are zeros). After building this buffer, it", "context_right": ". Then it creates an array of 7 elements in which it stores the string “Boondoggle” (which corresponds to a binary file inside the temporary folder), 4 numbers, and the pointers to the functions “GetProcAddres” and “GetModuleHandleA” that match with the ones received as parameters by this DLL:", "_context_left": "After building this buffer, it ", "_context_right": ".", "sentence_left": "Inside this buffer, the function ignores out of every 4 bytes (since they are zeros).", "sentence_right": "Then it creates an array of 7 elements in which it stores the string “Boondoggle” (which corresponds to a binary file inside the temporary folder), 4 numbers, and the pointers to the functions “GetProcAddres” and “GetModuleHandleA” that match with the ones received as parameters by this DLL:", "label": "Adversaries may reflectively load code into a process in order to conceal the execution of malicious payloads. Reflective loading involves allocating then executing payloads directly within the memory of the process, vice creating a thread or process backed by a file path on disk. Reflectively loaded payloads may be compiled binaries, anonymous files (only present in RAM), or just snubs of fileless executable code (ex: position-independent shellcode).(Citation: Introducing Donut)(Citation: S1 Custom Shellcode Tool)(Citation: Stuart ELF Memory)(Citation: 00sec Droppers)(Citation: Mandiant BYOL) Reflective code injection is very similar to [Process Injection](https://attack.mitre.org/techniques/T1055) except that the “injection” loads code into the processes’ own memory instead of that of a separate process. Reflective loading may evade process-based detections since the execution of the arbitrary code may be masked within a legitimate or otherwise benign process. Reflectively loading payloads directly into memory may also avoid creating files or other artifacts on disk, while also enabling malware to keep these payloads encrypted (or otherwise obfuscated) until execution.(Citation: Stuart ELF Memory)(Citation: 00sec Droppers)(Citation: Intezer ACBackdoor)(Citation: S1 Old Rat New Tricks)", "label_id": 501, "label_title": "Reflective Code Loading", "label_link": "https://attack.mitre.org/techniques/T1620", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "lab52", "context_left": "Then it creates an array of 7 elements in which it stores the string “Boondoggle” (which corresponds to a binary file inside the temporary folder), 4 numbers, and the pointers to the functions “GetProcAddres” and “GetModuleHandleA” that match with the ones received as parameters by this DLL: ![](https://", "context_right": ".io/blog/wp-content/uploads/2020/03/7.png) ![](https://lab52.io/blog/wp-content/uploads/2020/03/8.png)", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2020/03/7.png)", "sentence_left": "Then it creates an array of 7 elements in which it stores the string “Boondoggle” (which corresponds to a binary file inside the temporary folder), 4 numbers, and the pointers to the functions “GetProcAddres” and “GetModuleHandleA” that match with the ones received as parameters by this DLL:", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/8.png)", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "lab52", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/7.png) ![](https://", "context_right": ".io/blog/wp-content/uploads/2020/03/8.png) After that, the first function of this DLL ends and calls the second one, which, at this point of the execution, points to the memory area where it was written the decoded shellcode, and to which it passes as parameter the before mentioned 7-element array.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2020/03/8.png)", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/7.png)", "sentence_right": "After that, the first function of this DLL ends and calls the second one, which, at this point of the execution, points to the memory area where it was written the decoded shellcode, and to which it passes as parameter the before mentioned 7-element array.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "decoded shellcode", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/8.png) After that, the first function of this DLL ends and calls the second one, which, at this point of the execution, points to the memory area where it was written the", "context_right": ", and to which it passes as parameter the before mentioned 7-element array. Once it jumps to that shellcode, using GetProcAddres and GetModuleHandle, it extracts a list of Kernel32 Functions that are “hardcoded”:", "_context_left": "After that, the first function of this DLL ends and calls the second one, which, at this point of the execution, points to the memory area where it was written the ", "_context_right": ", and to which it passes as parameter the before mentioned 7-element array.", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/8.png)", "sentence_right": "Once it jumps to that shellcode, using GetProcAddres and GetModuleHandle, it extracts a list of Kernel32 Functions that are “hardcoded”:", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "to that shellcode", "context_left": "After that, the first function of this DLL ends and calls the second one, which, at this point of the execution, points to the memory area where it was written the decoded shellcode, and to which it passes as parameter the before mentioned 7-element array. Once it jumps", "context_right": ", using GetProcAddres and GetModuleHandle, it extracts a list of Kernel32 Functions that are “hardcoded”: ![](https://lab52.io/blog/wp-content/uploads/2020/03/9.png)", "_context_left": "Once it jumps ", "_context_right": ", using GetProcAddres and GetModuleHandle, it extracts a list of Kernel32 Functions that are “hardcoded”:", "sentence_left": "After that, the first function of this DLL ends and calls the second one, which, at this point of the execution, points to the memory area where it was written the decoded shellcode, and to which it passes as parameter the before mentioned 7-element array.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/9.png)", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "lab52", "context_left": "Once it jumps to that shellcode, using GetProcAddres and GetModuleHandle, it extracts a list of Kernel32 Functions that are “hardcoded”: ![](https://", "context_right": ".io/blog/wp-content/uploads/2020/03/9.png) It loads the “Boondoggle” file with the CreateFile API and makes a decode with the same XOR key as before, from which it decodes a new complete executable and a small “PE Loader” that allows it to load the executable into memory using the technique known as “ReflectivePEInjection” either in the process itself or in a remote process.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2020/03/9.png)", "sentence_left": "Once it jumps to that shellcode, using GetProcAddres and GetModuleHandle, it extracts a list of Kernel32 Functions that are “hardcoded”:", "sentence_right": "It loads the “Boondoggle” file with the CreateFile API and makes a decode with the same XOR key as before, from which it decodes a new complete executable and a small “PE Loader” that allows it to load the executable into memory using the technique known as “ReflectivePEInjection” either in the process itself or in a remote process.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "from which it decodes a new complete executable", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/9.png) It loads the “Boondoggle” file with the CreateFile API and makes a decode with the same XOR key as before,", "context_right": "and a small “PE Loader” that allows it to load the executable into memory using the technique known as “ReflectivePEInjection” either in the process itself or in a remote process. After this, it runs the decrypted binary, which repeats the same logic over another section of the “Boondoggle” from which it extracts a second executable, this time consisting of a copy of the “OllyDBG” plug-in called “OllyDBG PE Dumper” which contains overwritten malicious code that is called.", "_context_left": "It loads the “Boondoggle” file with the CreateFile API and makes a decode with the same XOR key as before, ", "_context_right": " and a small “PE Loader” that allows it to load the executable into memory using the technique known as “ReflectivePEInjection” either in the process itself or in a remote process.", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/9.png)", "sentence_right": "After this, it runs the decrypted binary, which repeats the same logic over another section of the “Boondoggle” from which it extracts a second executable, this time consisting of a copy of the “OllyDBG” plug-in called “OllyDBG PE Dumper” which contains overwritten malicious code that is called.", "label": "Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system. One such example is use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file. (Citation: Malwarebytes Targeted Attack against Saudi Arabia) Another example is using the Windows <code>copy /b</code> command to reassemble binary fragments into a malicious payload. (Citation: Carbon Black Obfuscation Sept 2016) Sometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016)", "label_id": 514, "label_title": "Deobfuscate/Decode Files or Information", "label_link": "https://attack.mitre.org/techniques/T1140", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "“PE Loader” that allows it to load the executable into memory using the technique known as “ReflectivePEInjection” either in the process itself or in a remote process", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/9.png) It loads the “Boondoggle” file with the CreateFile API and makes a decode with the same XOR key as before, from which it decodes a new complete executable and a small", "context_right": ". After this, it runs the decrypted binary, which repeats the same logic over another section of the “Boondoggle” from which it extracts a second executable, this time consisting of a copy of the “OllyDBG” plug-in called “OllyDBG PE Dumper” which contains overwritten malicious code that is called.", "_context_left": "It loads the “Boondoggle” file with the CreateFile API and makes a decode with the same XOR key as before, from which it decodes a new complete executable and a small ", "_context_right": ".", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/9.png)", "sentence_right": "After this, it runs the decrypted binary, which repeats the same logic over another section of the “Boondoggle” from which it extracts a second executable, this time consisting of a copy of the “OllyDBG” plug-in called “OllyDBG PE Dumper” which contains overwritten malicious code that is called.", "label": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "label_id": 318, "label_title": "Process Injection", "label_link": "https://attack.mitre.org/techniques/T1055", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "makes a decode with the same XOR key", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/9.png) It loads the “Boondoggle” file with the CreateFile API and", "context_right": "as before, from which it decodes a new complete executable and a small “PE Loader” that allows it to load the executable into memory using the technique known as “ReflectivePEInjection” either in the process itself or in a remote process. After this, it runs the decrypted binary, which repeats the same logic over another section of the “Boondoggle” from which it extracts a second executable, this time consisting of a copy of the “OllyDBG” plug-in called “OllyDBG PE Dumper” which contains overwritten malicious code that is called.", "_context_left": "It loads the “Boondoggle” file with the CreateFile API and ", "_context_right": " as before, from which it decodes a new complete executable and a small “PE Loader” that allows it to load the executable into memory using the technique known as “ReflectivePEInjection” either in the process itself or in a remote process.", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/9.png)", "sentence_right": "After this, it runs the decrypted binary, which repeats the same logic over another section of the “Boondoggle” from which it extracts a second executable, this time consisting of a copy of the “OllyDBG” plug-in called “OllyDBG PE Dumper” which contains overwritten malicious code that is called.", "label": "Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system. One such example is use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file. (Citation: Malwarebytes Targeted Attack against Saudi Arabia) Another example is using the Windows <code>copy /b</code> command to reassemble binary fragments into a malicious payload. (Citation: Carbon Black Obfuscation Sept 2016) Sometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016)", "label_id": 514, "label_title": "Deobfuscate/Decode Files or Information", "label_link": "https://attack.mitre.org/techniques/T1140", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "runs the decrypted binary", "context_left": "It loads the “Boondoggle” file with the CreateFile API and makes a decode with the same XOR key as before, from which it decodes a new complete executable and a small “PE Loader” that allows it to load the executable into memory using the technique known as “ReflectivePEInjection” either in the process itself or in a remote process. After this, it", "context_right": ", which repeats the same logic over another section of the “Boondoggle” from which it extracts a second executable, this time consisting of a copy of the “OllyDBG” plug-in called “OllyDBG PE Dumper” which contains overwritten malicious code that is called. ![](https://lab52.io/blog/wp-content/uploads/2020/03/10.png)", "_context_left": "After this, it ", "_context_right": ", which repeats the same logic over another section of the “Boondoggle” from which it extracts a second executable, this time consisting of a copy of the “OllyDBG” plug-in called “OllyDBG PE Dumper” which contains overwritten malicious code that is called.", "sentence_left": "It loads the “Boondoggle” file with the CreateFile API and makes a decode with the same XOR key as before, from which it decodes a new complete executable and a small “PE Loader” that allows it to load the executable into memory using the technique known as “ReflectivePEInjection” either in the process itself or in a remote process.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/10.png)", "label": "Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system. One such example is use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file. (Citation: Malwarebytes Targeted Attack against Saudi Arabia) Another example is using the Windows <code>copy /b</code> command to reassemble binary fragments into a malicious payload. (Citation: Carbon Black Obfuscation Sept 2016) Sometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016)", "label_id": 514, "label_title": "Deobfuscate/Decode Files or Information", "label_link": "https://attack.mitre.org/techniques/T1140", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "lab52", "context_left": "After this, it runs the decrypted binary, which repeats the same logic over another section of the “Boondoggle” from which it extracts a second executable, this time consisting of a copy of the “OllyDBG” plug-in called “OllyDBG PE Dumper” which contains overwritten malicious code that is called. ![](https://", "context_right": ".io/blog/wp-content/uploads/2020/03/10.png) This dll extracts the final threat and in case the initial binary “gospels.exe” had been executed from the installer arriving by mail, it has been observed that it is injected in a legitimate new process “cmd.exe”.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2020/03/10.png)", "sentence_left": "After this, it runs the decrypted binary, which repeats the same logic over another section of the “Boondoggle” from which it extracts a second executable, this time consisting of a copy of the “OllyDBG” plug-in called “OllyDBG PE Dumper” which contains overwritten malicious code that is called.", "sentence_right": "This dll extracts the final threat and in case the initial binary “gospels.exe” had been executed from the installer arriving by mail, it has been observed that it is injected in a legitimate new process “cmd.exe”.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "injected in a legitimate new process “cmd.exe”", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/10.png) This dll extracts the final threat and in case the initial binary “gospels.exe” had been executed from the installer arriving by mail, it has been observed that it is", "context_right": ". On the other hand, in case it is loaded through its persistence in the registry, it is injected in the process “gospels.exe” itself.", "_context_left": "This dll extracts the final threat and in case the initial binary “gospels.exe” had been executed from the installer arriving by mail, it has been observed that it is ", "_context_right": ".", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/10.png)", "sentence_right": "On the other hand, in case it is loaded through its persistence in the registry, it is injected in the process “gospels.exe” itself.", "label": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "label_id": 318, "label_title": "Process Injection", "label_link": "https://attack.mitre.org/techniques/T1055", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "executed from the installer arriving by mail", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/10.png) This dll extracts the final threat and in case the initial binary “gospels.exe” had been", "context_right": ", it has been observed that it is injected in a legitimate new process “cmd.exe”. On the other hand, in case it is loaded through its persistence in the registry, it is injected in the process “gospels.exe” itself.", "_context_left": "This dll extracts the final threat and in case the initial binary “gospels.exe” had been ", "_context_right": ", it has been observed that it is injected in a legitimate new process “cmd.exe”.", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/10.png)", "sentence_right": "On the other hand, in case it is loaded through its persistence in the registry, it is injected in the process “gospels.exe” itself.", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "it is loaded through its persistence in the registry", "context_left": "This dll extracts the final threat and in case the initial binary “gospels.exe” had been executed from the installer arriving by mail, it has been observed that it is injected in a legitimate new process “cmd.exe”. On the other hand, in case", "context_right": ", it is injected in the process “gospels.exe” itself. An interesting point of this stage of infection is that it tries to remove a file called “turpitude.exe” that should be located in the user’s %APPDATA% folder, but no trace has been observed at any point of the analysis, thus it could be an attempt to clean up tools from previous campaigns of this group, although it has not been able to confirm this fact through the analysis of the threat.", "_context_left": "On the other hand, in case ", "_context_right": ", it is injected in the process “gospels.exe” itself.", "sentence_left": "This dll extracts the final threat and in case the initial binary “gospels.exe” had been executed from the installer arriving by mail, it has been observed that it is injected in a legitimate new process “cmd.exe”.", "sentence_right": "An interesting point of this stage of infection is that it tries to remove a file called “turpitude.exe” that should be located in the user’s %APPDATA% folder, but no trace has been observed at any point of the analysis, thus it could be an attempt to clean up tools from previous campaigns of this group, although it has not been able to confirm this fact through the analysis of the threat.", "label": "Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution. Access to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility [Reg](https://attack.mitre.org/software/S0075) may be used for local or remote Registry modification. (Citation: Microsoft Reg) Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API. Registry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via [Reg](https://attack.mitre.org/software/S0075) or other utilities using the Win32 API. (Citation: Microsoft Reghide NOV 2006) Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence. (Citation: TrendMicro POWELIKS AUG 2014) (Citation: SpectorOps Hiding Reg Jul 2017) The Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. (Citation: Microsoft Remote) Often [Valid Accounts](https://attack.mitre.org/techniques/T1078) are required, along with access to the remote system's [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) for RPC communication.", "label_id": 238, "label_title": "Modify Registry", "label_link": "https://attack.mitre.org/techniques/T1112", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "injected in the process “gospels.exe”", "context_left": "This dll extracts the final threat and in case the initial binary “gospels.exe” had been executed from the installer arriving by mail, it has been observed that it is injected in a legitimate new process “cmd.exe”. On the other hand, in case it is loaded through its persistence in the registry, it is", "context_right": "itself. An interesting point of this stage of infection is that it tries to remove a file called “turpitude.exe” that should be located in the user’s %APPDATA% folder, but no trace has been observed at any point of the analysis, thus it could be an attempt to clean up tools from previous campaigns of this group, although it has not been able to confirm this fact through the analysis of the threat.", "_context_left": "On the other hand, in case it is loaded through its persistence in the registry, it is ", "_context_right": " itself.", "sentence_left": "This dll extracts the final threat and in case the initial binary “gospels.exe” had been executed from the installer arriving by mail, it has been observed that it is injected in a legitimate new process “cmd.exe”.", "sentence_right": "An interesting point of this stage of infection is that it tries to remove a file called “turpitude.exe” that should be located in the user’s %APPDATA% folder, but no trace has been observed at any point of the analysis, thus it could be an attempt to clean up tools from previous campaigns of this group, although it has not been able to confirm this fact through the analysis of the threat.", "label": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "label_id": 318, "label_title": "Process Injection", "label_link": "https://attack.mitre.org/techniques/T1055", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "clean up tools from previous campaigns", "context_left": "On the other hand, in case it is loaded through its persistence in the registry, it is injected in the process “gospels.exe” itself. An interesting point of this stage of infection is that it tries to remove a file called “turpitude.exe” that should be located in the user’s %APPDATA% folder, but no trace has been observed at any point of the analysis, thus it could be an attempt to", "context_right": "of this group, although it has not been able to confirm this fact through the analysis of the threat. Eventually, the final threat remains completely deployed in the memory of the machine, which in this case consists on the “Remcos” remote acces trojan.", "_context_left": "An interesting point of this stage of infection is that it tries to remove a file called “turpitude.exe” that should be located in the user’s %APPDATA% folder, but no trace has been observed at any point of the analysis, thus it could be an attempt to ", "_context_right": " of this group, although it has not been able to confirm this fact through the analysis of the threat.", "sentence_left": "On the other hand, in case it is loaded through its persistence in the registry, it is injected in the process “gospels.exe” itself.", "sentence_right": "Eventually, the final threat remains completely deployed in the memory of the machine, which in this case consists on the “Remcos” remote acces trojan.", "label": "Adversaries may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined malware. Locations and format of logs are platform or product-specific, however standard operating system logs are captured as Windows events or Linux/macOS files such as [Bash History](https://attack.mitre.org/techniques/T1552/003) and /var/log/*. These actions may interfere with event collection, reporting, or other notifications used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.", "label_id": 327, "label_title": "Indicator Removal on Host", "label_link": "https://attack.mitre.org/techniques/T1070", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "Remcos", "context_left": "An interesting point of this stage of infection is that it tries to remove a file called “turpitude.exe” that should be located in the user’s %APPDATA% folder, but no trace has been observed at any point of the analysis, thus it could be an attempt to clean up tools from previous campaigns of this group, although it has not been able to confirm this fact through the analysis of the threat. Eventually, the final threat remains completely deployed in the memory of the machine, which in this case consists on the “", "context_right": "” remote acces trojan. ![](https://lab52.io/blog/wp-content/uploads/2020/03/11.png)", "_context_left": "Eventually, the final threat remains completely deployed in the memory of the machine, which in this case consists on the “", "_context_right": "” remote acces trojan.", "sentence_left": "An interesting point of this stage of infection is that it tries to remove a file called “turpitude.exe” that should be located in the user’s %APPDATA% folder, but no trace has been observed at any point of the analysis, thus it could be an attempt to clean up tools from previous campaigns of this group, although it has not been able to confirm this fact through the analysis of the threat.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/11.png)", "label": "[Remcos](https://attack.mitre.org/software/S0332) is a closed-source tool that is marketed as a remote control and surveillance software by a company called Breaking Security. [Remcos](https://attack.mitre.org/software/S0332) has been observed being used in malware campaigns.(Citation: Riskiq Remcos Jan 2018)(Citation: Talos Remcos Aug 2018)", "label_id": 713, "label_title": "Remcos", "label_link": "https://attack.mitre.org/software/S0332", "entity_class": "CE", "entity_type": "MALWARE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "lab52", "context_left": "Eventually, the final threat remains completely deployed in the memory of the machine, which in this case consists on the “Remcos” remote acces trojan. ![](https://", "context_right": ".io/blog/wp-content/uploads/2020/03/11.png) This threat contacts the command and control domain “pruebaremc.]duckdns.org” through port “1010”.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2020/03/11.png)", "sentence_left": "Eventually, the final threat remains completely deployed in the memory of the machine, which in this case consists on the “Remcos” remote acces trojan.", "sentence_right": "This threat contacts the command and control domain “pruebaremc.]duckdns.org” through port “1010”.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "In this case, it is called gospels.exe:", "context_left": "When these installers are executed, they create a temporary folder on the system, where they dump all the files they contain, and then execute one of them as an “Entry Point” in the execution/infection chain.", "context_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/3.png)", "_context_left": "", "_context_right": "", "sentence_left": "When these installers are executed, they create a temporary folder on the system, where they dump all the files they contain, and then execute one of them as an “Entry Point” in the execution/infection chain.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/3.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "| SHA256 |  E03903AFC4DC4A9DEEDF5442B6D1C8319194F57F1D7620A9C4EBC7D61C436B70  |", "context_left": "IOCS:", "context_right": "| DNS |  pruebaremc.duckdns.]org  |", "_context_left": "", "_context_right": "", "sentence_left": "IOCS:", "sentence_right": "| DNS |  pruebaremc.duckdns.]org  |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "March 23, 2020", "context_left": "APT-C-36 new anti-detection tricks", "context_right": "Lab52 has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti Malware software, using a more complex infection chain than a simple packer, as they have been doing so far.", "_context_left": "", "_context_right": "", "sentence_left": "APT-C-36 new anti-detection tricks", "sentence_right": "Lab52 has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti Malware software, using a more complex infection chain than a simple packer, as they have been doing so far.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "Installer” that contains a bunch of files, including some that are simply trash and others that are part of the infection chain:", "context_left": "Until now, these binaries were executables packed with common anti-virus circumvention software, but in this case it is an “SFX", "context_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/2.png)", "_context_left": "", "_context_right": "", "sentence_left": "Until now, these binaries were executables packed with common anti-virus circumvention software, but in this case it is an “SFX", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/2.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "Then it creates an array of 7 elements in which it stores the string “Boondoggle” (which corresponds to a binary file inside the temporary folder), 4 numbers, and the pointers to the functions “GetProcAddres” and “GetModuleHandleA” that match with the ones received as parameters by this DLL:", "context_left": "After building this buffer, it reserves a memory area with execution permissions and copies there the decoded content.", "context_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/7.png)", "_context_left": "", "_context_right": "", "sentence_left": "After building this buffer, it reserves a memory area with execution permissions and copies there the decoded content.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/7.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "IOCS:", "context_left": "This threat contacts the command and control domain “pruebaremc.]duckdns.org” through port “1010”.", "context_right": "| SHA256 |  E03903AFC4DC4A9DEEDF5442B6D1C8319194F57F1D7620A9C4EBC7D61C436B70  |", "_context_left": "", "_context_right": "", "sentence_left": "This threat contacts the command and control domain “pruebaremc.]duckdns.org” through port “1010”.", "sentence_right": "| SHA256 |  E03903AFC4DC4A9DEEDF5442B6D1C8319194F57F1D7620A9C4EBC7D61C436B70  |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "The sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group.", "context_left": "Lab52 has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti Malware software, using a more complex infection chain than a simple packer, as they have been doing so far.", "context_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/1.png)", "_context_left": "", "_context_right": "", "sentence_left": "Lab52 has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti Malware software, using a more complex infection chain than a simple packer, as they have been doing so far.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/1.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "The DLL’s Excluders function simply calls two internal functions:", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/5.png)", "context_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/6.png)", "_context_left": "", "_context_right": "", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/5.png)", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2020/03/6.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "This threat contacts the command and control domain “pruebaremc.]duckdns.org” through port “1010”.", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/11.png)", "context_right": "IOCS:", "_context_left": "", "_context_right": "", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/03/11.png)", "sentence_right": "IOCS:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}
{"mention": "| DNS |  pruebaremc.duckdns.]org  |", "context_left": "| SHA256 |  E03903AFC4DC4A9DEEDF5442B6D1C8319194F57F1D7620A9C4EBC7D61C436B70  |", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "| SHA256 |  E03903AFC4DC4A9DEEDF5442B6D1C8319194F57F1D7620A9C4EBC7D61C436B70  |", "sentence_right": "", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-03-23_apt-c-36-new-anti"}