{"mention": "Symantec", "context_left": "The OrangeWorm group was named and described by the", "context_right": "Company in different blog entries", "_context_left": "The OrangeWorm group was named and described by the ", "_context_right": " Company in different blog entries", "sentence_left": "April 02, 2019", "sentence_right": "[[1]](https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia)", "label": "Symantec Corporation (; commonly known as Symantec) is an American software company headquartered in Mountain View, California, United States. The company provides cybersecurity software and services. Symantec is a Fortune 500 company and a member of the S&P 500 stock-market index. The company also has development centers in Pune, Chennai and Bengaluru (India).  On October 9, 2014, Symantec declared it would split into two independent publicly traded companies by the end of 2015. One company would focus on security, the other on information management. On January 29, 2016, Symantec sold its information-management subsidiary, named Veritas Technologies (which Symantec had acquired in 2004) to The Carlyle Group.  The name \"\"Symantec\"\" is a portmanteau of the words \"syntax\" and \"semantics\" with \"technology\".", "label_id": 156916, "label_title": "Symantec", "label_link": "https://en.wikipedia.org/wiki?curid=354414", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Symantec", "context_left": "The sector most affected is **healthcare** as described by", "context_right": ".", "_context_left": "The sector most affected is **healthcare** as described by ", "_context_right": ".", "sentence_left": "We would highlight from these entries that it is a group that has been operational since 2015 and is focused on attacking the **health**, pharmaceutical, technological, manufacturing and logistics sectors.", "sentence_right": "Based on this information, Lab52 has carried out an in-depth study of the Kwampirs tool (OrangeWorm’s main tool) used by this group.", "label": "Symantec Corporation (; commonly known as Symantec) is an American software company headquartered in Mountain View, California, United States. The company provides cybersecurity software and services. Symantec is a Fortune 500 company and a member of the S&P 500 stock-market index. The company also has development centers in Pune, Chennai and Bengaluru (India).  On October 9, 2014, Symantec declared it would split into two independent publicly traded companies by the end of 2015. One company would focus on security, the other on information management. On January 29, 2016, Symantec sold its information-management subsidiary, named Veritas Technologies (which Symantec had acquired in 2004) to The Carlyle Group.  The name \"\"Symantec\"\" is a portmanteau of the words \"syntax\" and \"semantics\" with \"technology\".", "label_id": 156916, "label_title": "Symantec", "label_link": "https://en.wikipedia.org/wiki?curid=354414", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Lab52", "context_left": "Based on this information,", "context_right": "has carried out an in-depth study of the Kwampirs tool (OrangeWorm’s main tool) used by this group.", "_context_left": "Based on this information, ", "_context_right": " has carried out an in-depth study of the Kwampirs tool (OrangeWorm’s main tool) used by this group.", "sentence_left": "The sector most affected is **healthcare** as described by Symantec.", "sentence_right": "Next, the RAT (Remote Administration Tool) in Dll format and the main binary or orchestrator of the infection will be analyzed.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img01.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img01.png)", "sentence_left": "One of which consists of the DLL with RAT capabilities encrypted with an XOR key that in each execution extracts, decrypts and executes:", "sentence_right": "This threat has a first execution block, in charge of decrypting all the text strings that it will use and which are encrypted in its “.data” section with a relatively obfuscated XOR algorithm in order to make detection and decryption difficult.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img02.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img02.png)", "sentence_left": "If it does not exist and has sufficient privileges, it creates the persistence service.", "sentence_right": "This service generates it with a hardcoded name and data in the strings that it has decrypted at the beginning of its execution, and emphasizes that it points to an executable with the name it has at that moment, but in %System32% even though it has not been observed that it copies itself to that route at any time.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img03.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img03.png)", "sentence_left": "Finally, it creates the file called ie11.PNF in which it writes 66 random bytes:", "sentence_right": "In the previous capture, you can see how it creates a buffer of 66Bytes, which it fills with random bytes, and passes it as a parameter to a function that we have called “CreateFileWith2tmp” along with a string, which in this case contains “C:\\Windows\\inf\\ie11.PNF”.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img04-1.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img04-1.png)", "sentence_left": "The function “CreateFileWith2tmp” uses it constantly for the creation of each one of the files related to this threat, and is in charge of generating two temporary files, in one it stores the first Byte of the buffer it receives as the second parameter, in the second file it stores the rest of the buffer, after which, it executes the following command to concatenate the content of both, and store it in a new file with the name that it has received as the third parameter.", "sentence_right": "After generating this file, it finishes its execution, having started another instance of its own, as a service, and without parameters.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Microsoft", "context_left": "When the threat starts without parameters, after its first string decryption block and collection of system information, it makes a call to the", "context_right": "API “StartServiceCtrlDispatcherW” responsible for initiating the logic of a Windows service, after which it ends.", "_context_left": "When the threat starts without parameters, after its first string decryption block and collection of system information, it makes a call to the ", "_context_right": " API “StartServiceCtrlDispatcherW” responsible for initiating the logic of a Windows service, after which it ends.", "sentence_left": "**Execution without parameters**", "sentence_right": "Therefore, if it is not started as a service, it is not able to perform any action.", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img05.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img05.png)", "sentence_left": "Therefore, if it is not started as a service, it is not able to perform any action.", "sentence_right": "If it is loaded as a service, after a first execution of its binary with a parameter, for example, the API “StartServiceCtrlDispatcherW” passes the execution flow of the application to a function of the binary.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img06.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img06.png)", "sentence_left": "This function consists in a first verification of the existence and capacity of access to the file “C:\\Windows\\inf\\mtmndkb32.PNF” if it finds a recent and accessible version of this one, it continues its normal execution, in case of not finding it or having problems of access to it, it goes through the processes in search of the copies of itself that it generates to run with 2 and 3 parameters, and in search of its modules to finish these processes and later, to eliminate these executables, as a cleanup.", "sentence_right": "Regardless of whether it finds the PNF file or not, it enters an infinite “while (.0)” loop, which is in charge of keeping its module in DLL format running and maintaining a copy of itself, running with two parameters, which is in charge of the lateral movement by SMB of the threat.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img07.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img07.png)", "sentence_left": "Regardless of whether it finds the PNF file or not, it enters an infinite “while (.0)” loop, which is in charge of keeping its module in DLL format running and maintaining a copy of itself, running with two parameters, which is in charge of the lateral movement by SMB of the threat.", "sentence_right": "The infinite loop, first, looks for instances of its module in DLL format in execution, in case of not finding it, it calls a function that takes charge of extracting from its resources the image mentioned at the beginning of the report, trimming the corrupt section, decrypting it with an XOR key of 16Bytes, using the following algorithm:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img08.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img08.png)", "sentence_left": "The infinite loop, first, looks for instances of its module in DLL format in execution, in case of not finding it, it calls a function that takes charge of extracting from its resources the image mentioned at the beginning of the report, trimming the corrupt section, decrypting it with an XOR key of 16Bytes, using the following algorithm:", "sentence_right": "and store the result in System32 with one of the following names with extension “.dll”:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img09.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img09.png)", "sentence_left": "and store the result in System32 with one of the following names with extension “.dll”:", "sentence_right": "Once you have the module on disk, run it through Microsoft executable “rundll32.exe” passing the following parameters:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Microsoft", "context_left": "Once you have the module on disk, run it through", "context_right": "executable “rundll32.exe” passing the following parameters:", "_context_left": "Once you have the module on disk, run it through ", "_context_right": " executable “rundll32.exe” passing the following parameters:", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img09.png)", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img10.png)", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img10.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img10.png)", "sentence_left": "Once you have the module on disk, run it through Microsoft executable “rundll32.exe” passing the following parameters:", "sentence_right": "It then calls a function whose sole purpose is to call a one-minute “Sleep” 20 times, causing his execution to pause for a period of 20 minutes.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img01-1.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img01-1.png)", "sentence_left": "After 20 minutes, it makes a call to a function that if it does not find an instance of itself running with 2 parameters, it makes a copy of its own binary with one of the following names:", "sentence_right": "And it executes it with two parameters using the Microsoft API CreateProcessAsUserW, which allows it to add the token of the current user as the creator of the process, so that the process is executed in its session:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Microsoft", "context_left": "And it executes it with two parameters using the", "context_right": "API CreateProcessAsUserW, which allows it to add the token of the current user as the creator of the process, so that the process is executed in its session:", "_context_left": "And it executes it with two parameters using the ", "_context_right": " API CreateProcessAsUserW, which allows it to add the token of the current user as the creator of the process, so that the process is executed in its session:", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img01-1.png)", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img12.png)", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img12.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img12.png)", "sentence_left": "And it executes it with two parameters using the Microsoft API CreateProcessAsUserW, which allows it to add the token of the current user as the creator of the process, so that the process is executed in its session:", "sentence_right": "After this, it performs a Sleep with a random value between 1 and 3 minutes, and repeats the same execution flow, thus ensuring that both its module in DLL format and its replica running with two parameters are kept running.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img13-1024x280.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img13-1024x280.png)", "sentence_left": "At this point, we are running the process of the main Kwampirs dropper, loaded as System by the persistence service, an instance of rundll32, also as System generated by the process itself without parameters, and a second instance of the executable, this time with the credentials of the user who has logged in, thanks to the use of the “CreateProcessAsUserW” API for its creation:", "sentence_right": "**Execution with 2 parameters**", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Microsoft", "context_left": "To do this, it first generates a Thread, which through the", "context_right": "API “GetTcpTable” obtains the list of IPv4 connections of the system, from which it filters all those that are through ports 445 and 138, so it is able to isolate those related to SMB traffic, afterwards it tries to infect these IPs directly.", "_context_left": "To do this, it first generates a Thread, which through the ", "_context_right": " API “GetTcpTable” obtains the list of IPv4 connections of the system, from which it filters all those that are through ports 445 and 138, so it is able to isolate those related to SMB traffic, afterwards it tries to infect these IPs directly.", "sentence_left": "When the threat is executed with two parameters, after its first string decryption block and collection of system information, it goes directly to a function in charge of scanning private IPs, which it tries to access by SMB in order to check its access and infection capacity.", "sentence_right": "To make sure it does not miss any computer to which the user has access, but which is not found on the table, the main thread of the threat scans the entire subnet of the computer, trying to infect all its possible IP addresses.", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img14.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img14.png)", "sentence_left": "To do this, it makes a call to the “CreateFile” API, passing as the file path the IP address to be infected with the following path “[IP]\\ ADMIN $ \\ system32 \\ csrss.exe” replacing the first element after the IP address for each of the strings of the previous list, generating the following network traffic:", "sentence_right": "If it gets access to this file on any computer, it checks the existence of ie11.PNF, to see if it is already infected, otherwise it creates a new one on that computer and gives the date and time extracted from User32.dll :", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img15.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img15.png)", "sentence_left": "If it gets access to this file on any computer, it checks the existence of ie11.PNF, to see if it is already infected, otherwise it creates a new one on that computer and gives the date and time extracted from User32.dll :", "sentence_right": "If it is able to create that file, it tries to copy itself, for which it chooses some of the hardcoded names it has in its strings:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img16-1024x315.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img16-1024x315.png)", "sentence_left": "And it generates a copy of itself with that name, on the remote computer through SMB:", "sentence_right": "Each time it is able to create both ie11.PNF and the Kwampirs executable, it calls a function that, depending on the SMB scanning routine used to generate it, passes a number to it as a parameter.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img17.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img17.png)", "sentence_left": "With this, and the address of the remote computer that has as its first parameter, tries to create and start the service “WmiApSrvEx” on the remote computer, generating traffic like the following:", "sentence_right": "Depending on whether it is capable of generating and executing the service or not, it makes a call to the registration function in the “Lb978YTy.tmp” log of infected remote computers, but this time, the parameter can be a 3 if everything went well, or a 4 if it has not been able to generate or initiate persistence.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_cod01.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_cod01.png)", "sentence_left": "This device has the following static characteristics:", "sentence_right": "In all the samples analyzed the ControlTrace () function is exported.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Symantec", "context_left": "This has not changed since the", "context_right": "report.", "_context_left": "This has not changed since the ", "_context_right": " report.", "sentence_left": "In all the samples analyzed the ControlTrace () function is exported.", "sentence_right": "Kwampirs RAT depending on the number of parameters will have a different behavior.", "label": "Symantec Corporation (; commonly known as Symantec) is an American software company headquartered in Mountain View, California, United States. The company provides cybersecurity software and services. Symantec is a Fortune 500 company and a member of the S&P 500 stock-market index. The company also has development centers in Pune, Chennai and Bengaluru (India).  On October 9, 2014, Symantec declared it would split into two independent publicly traded companies by the end of 2015. One company would focus on security, the other on information management. On January 29, 2016, Symantec sold its information-management subsidiary, named Veritas Technologies (which Symantec had acquired in 2004) to The Carlyle Group.  The name \"\"Symantec\"\" is a portmanteau of the words \"syntax\" and \"semantics\" with \"technology\".", "label_id": 156916, "label_title": "Symantec", "label_link": "https://en.wikipedia.org/wiki?curid=354414", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_cod02.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_cod02.png)", "sentence_left": "The possibilities implemented on this occasion are two, when **three** parameters and when **four** parameters are passed to the function.", "sentence_right": "The analysis will describe the behavior of Kwampirs RAT in each of the two existing execution branches:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Symantec", "context_left": "This is already described by", "context_right": "in its report and the “current” samples have not changed their behavior.", "_context_left": "This is already described by ", "_context_right": " in its report and the “current” samples have not changed their behavior.", "sentence_left": "In each execution (Kwampirs Dropper as Kwampirs RAT) it checks the exact date the file was created and if not enough time has passed since the file was created, it does not run again.", "sentence_right": "4.In the event that Kwampirs RAT is downloaded, a module interacts with the **mkdiawb3.PNF** file before entering the network communication execution flow.", "label": "Symantec Corporation (; commonly known as Symantec) is an American software company headquartered in Mountain View, California, United States. The company provides cybersecurity software and services. Symantec is a Fortune 500 company and a member of the S&P 500 stock-market index. The company also has development centers in Pune, Chennai and Bengaluru (India).  On October 9, 2014, Symantec declared it would split into two independent publicly traded companies by the end of 2015. One company would focus on security, the other on information management. On January 29, 2016, Symantec sold its information-management subsidiary, named Veritas Technologies (which Symantec had acquired in 2004) to The Carlyle Group.  The name \"\"Symantec\"\" is a portmanteau of the words \"syntax\" and \"semantics\" with \"technology\".", "label_id": 156916, "label_title": "Symantec", "label_link": "https://en.wikipedia.org/wiki?curid=354414", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img34.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img34.png)", "sentence_left": "In this case Kwampirs RAT will try to boot the malware with the CreateProcessAsUser () function as follows:", "sentence_right": "It looks like there are two instances of Kwampirs, but one with the user SYSTEM and another with the user Lucas.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img35.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img35.png)", "sentence_left": "The pipe handlers (in decimal) are stored in a file created in C:\\Windows\\Temp:", "sentence_right": "* 232 = E8", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img36.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img36.png)", "sentence_left": "The handles of the process show that e8 and e4 are File handles:", "sentence_right": "This mode of operation, as seen during the analysis, is used to communicate the Kwampirs RAT process started as SYSTEM (starting with the service) with the process started as the user owner of the current session of the machine.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img37.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img37.png)", "sentence_left": "This mode of operation, as seen during the analysis, is used to communicate the Kwampirs RAT process started as SYSTEM (starting with the service) with the process started as the user owner of the current session of the machine.", "sentence_right": "In the previous screenshot you can see how the process rundll32.exe (starting with SYSTEM, in this case it would be the master) that could not go to the internet is about to write in a pipe to send the data to the process that has been created with the CreateProcessAsUser () function.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img38.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img38.png)", "sentence_left": "Named Pipe:", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img39.png)", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img39.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img39.png)", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img38.png)", "sentence_right": "If the handles of the rundll32 master process are opened with a tool like ProcessHacker, it will be seen how it has an open handle on the rundll32 process, created with the user without privileges (from now on rundll32 slave):", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img40.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img40.png)", "sentence_left": "This is done with the OpenProcess () api and then OpenProcessToken () in order to obtain the token from the explorer.exe process (normally the owner of this process is the authenticated user and is the one most likely to have the configured proxy):", "sentence_right": "The following is a description of the entire sequence of actions carried out for the rundll32 master process to send information to the rundll32 slave after having seen some peculiarities previously.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img41.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img41.png)", "sentence_left": "The following image shows the master process rundll32.exe that just opened the slave process with the OpenProcess and will open a temporary file with wfopen:", "sentence_right": "The temporary file contains the identifiers of the handles created in the rundll32 SLAVE process:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img42.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img42.png)", "sentence_left": "The temporary file contains the identifiers of the handles created in the rundll32 SLAVE process:", "sentence_right": "In memory of the master process we will find those handles in their hexadecimal value:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img43.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img43.png)", "sentence_left": "In memory of the master process we will find those handles in their hexadecimal value:", "sentence_right": "Once these handles are located, the master intends to duplicate them in order to obtain access to those handles in their process and that correspond to those of the slave process to communicate with each other:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img44.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img44.png)", "sentence_left": "Once these handles are located, the master intends to duplicate them in order to obtain access to those handles in their process and that correspond to those of the slave process to communicate with each other:", "sentence_right": "In this execution, the value of lpTargetHandle was 0x290 and it is linked (or duplicated) with one of the rundll32.exe slave processes that it just read from the temporary file.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img45.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img45.png)", "sentence_left": "In this execution, the value of lpTargetHandle was 0x290 and it is linked (or duplicated) with one of the rundll32.exe slave processes that it just read from the temporary file.", "sentence_right": "Summing up the operation, the master rundll32.exe opens the slave process.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "At this point, we are running the process of the main Kwampirs dropper, loaded as System by the persistence service, an instance of rundll32, also as System generated by the process itself without parameters, and a second instance of the executable, this time with the credentials of the user who has logged in, thanks to the use of the “CreateProcessAsUserW” API for its creation:", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "After this, it performs a Sleep with a random value between 1 and 3 minutes, and repeats the same execution flow, thus ensuring that both its module in DLL format and its replica running with two parameters are kept running.", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img13-1024x280.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "The second parameter, can be a value between 0 and 3, (if it is something different, its execution ends).", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "To do this, it first extracts the last character from its second and third parameters, and passes it from “char” to “int”.", "sentence_right": "This value corresponds to the remote directory to which it has been able to access its replica of two parameters, thus obtaining the accessible remote path:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "2.The next step is to obtain the MACTimes of the user32.dll Dll.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "To decipher the IOCs the malware uses the following logic:", "sentence_right": "This group modifies the times of certain files that it creates on the disk and fixes the times of the user32.dll Dll, as already mentioned “Kwampirs Dropper”.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "And the following screenshot shows the part of the network that sends the POST request of the module whose capture of the network traffic was seen before:", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "Next you can see the module’s loop that reads the .data section with the commands and that will be launched with cmd.exe:", "sentence_right": "7.After exiting the thread, the Sleep () function is executed with a random time and returns to point 5 to repeat the process.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "| **07f5fa96d31ed75edba8699f53a75502ade214b34469163011ced5b94e393f32**", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "| **IOC** | **Tipo** |", "sentence_right": "**12c6c48e1e52ebca20f4b890922fb31965317865d35ac04d216ad8b78f866999**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "If it is not able to infect the computer, it tries to eliminate the remote ie11.PNF file, obtaining in this way for it to try again to infect said computer in a future execution.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "Thus leaving in the “.tmp” file registry a record of the computers to which he has had access (logs with 0.1 or 2) and if it has been able to infect them or not with (3 or 4) logs.", "sentence_right": "### Technical analysis of Kwampirs RAT", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "**ced9a61ebaa8de7aa360ad2d24be26e2474fa4164118f8e32f4e2b2aba6ce511**", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "**cade857aa5735467a69af2267f6c6179286bd5d1ad61b60332a21527b69d9736**", "sentence_right": "**d1953d2c07d0572063364f34de99950407d07bd376dd9817ac799d5628ae5339**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "**e3bc08f7a12f9b68a73de99ecd0aaef1447bbbba9e35f518d42fd0e751be858f**", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "**d881198d26d10fc3a3ace876d4ef0db373b586de28a8b489248f3ea1840ba683**", "sentence_right": "**f8eb3a2054d6bc51fc0a127f9c01c4aaf238c0c681c36164a716268dc452ff91** |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Therefore, if it is not started as a service, it is not able to perform any action.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "When the threat starts without parameters, after its first string decryption block and collection of system information, it makes a call to the Microsoft API “StartServiceCtrlDispatcherW” responsible for initiating the logic of a Windows service, after which it ends.", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img05.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "* 228 = E4", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "* 232 = E8", "sentence_right": "The handles of the process show that e8 and e4 are File handles:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Within its arsenal, OrangeWorm has a RAT in DLL format whose execution and lateral movement is carried out by an executable together with the one that composes the threat known as Kwampirs.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "### Technical analysis of Kwampirs Dropper", "sentence_right": "Regarding the executable, which we will call “Kwampirs Dropper” initially highlight its resources, among which are two images with corrupt sections.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "It then calls a function whose sole purpose is to call a one-minute “Sleep” 20 times, causing his execution to pause for a period of 20 minutes.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img10.png)", "sentence_right": "After 20 minutes, it makes a call to a function that if it does not find an instance of itself running with 2 parameters, it makes a copy of its own binary with one of the following names:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "If it is able to create that file, it tries to copy itself, for which it chooses some of the hardcoded names it has in its strings:", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img15.png)", "sentence_right": "* wmiapsrvce.exe", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "The logic that contains the section of code that is executed when it receives a single parameter, is that of a hypothetical installation of the threat, manually, or through a dropper.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "**Execution with a parameter**", "sentence_right": "It should be noted that this section is completely dependent on having administrator privileges, and in case of not having them, in many points of the execution jumps directly to the end of the logic, thus ending its execution.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "**a2d2584e1c46bc2954aaf47957f7fb48bc8209cdf04c1ccd226d689094a2b761**", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "**97dd250670cef14e04db0145efe7fcfc945018b681e87e48a6f012fd7f79d02e**", "sentence_right": "**b489e5469938f1410a955ab26dc2cb2c81923c75f545df3c351767d5f13b728d**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "This is done with the OpenProcess () api and then OpenProcessToken () in order to obtain the token from the explorer.exe process (normally the owner of this process is the authenticated user and is the one most likely to have the configured proxy):", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "Another similar situation that occurs during execution to the previous one is when the master rundll32.exe opens the explorer.exe process.", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img40.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "[[2]](https://content.connect.symantec.com/sites/default/files/2018-04/Orangeworm%20IOCs.pdf).", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "[[1]](https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia)", "sentence_right": "We would highlight from these entries that it is a group that has been operational since 2015 and is focused on attacking the **health**, pharmaceutical, technological, manufacturing and logistics sectors.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "* [3] https://www.ccn-cert.cni.es/ca/seguretat-al-dia/noticies-d-actualitat/6156-orangeworm-apt-orientada-al-sector-medico.html", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "* [2] <https://content.connect.symantec.com/sites/default/files/2018-04/Orangeworm%20IOCs.pdf>", "sentence_right": "### Compromise indicators", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "**d1953d2c07d0572063364f34de99950407d07bd376dd9817ac799d5628ae5339**", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "**ced9a61ebaa8de7aa360ad2d24be26e2474fa4164118f8e32f4e2b2aba6ce511**", "sentence_right": "**d881198d26d10fc3a3ace876d4ef0db373b586de28a8b489248f3ea1840ba683**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "**768fab04b19c18e375183bd762eda75359da3a964aa97000639cdfdd066f6edd**", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "**75d93cd55d54a38a9ec47efe26f4a2c4c8c14328175fdd8d69efc0187cef6a2e**", "sentence_right": "**7f9531e47146095f681564cfd5d322af3def6468202f62c6215af29c0453fb0a**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "After deciphering its strings, it extracts the creation and modification dates from User32.dll and collects information about the operating system it is on.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "This threat has a first execution block, in charge of decrypting all the text strings that it will use and which are encrypted in its “.data” section with a relatively obfuscated XOR algorithm in order to make detection and decryption difficult.", "sentence_right": "From this point, its logic can be divided into 4 different paths, depending on the number of parameters, which provide different functionalities for each stage of infection of the threat.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Then it reads the temporary one where the handles are (in decimal) of type pipe that the slave has created.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "Summing up the operation, the master rundll32.exe opens the slave process.", "sentence_right": "The master makes a duplicate handle of the two pipes of the slave in its process and thus pass all the information through these pipes.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "In this execution, the value of lpTargetHandle was 0x290 and it is linked (or duplicated) with one of the rundll32.exe slave processes that it just read from the temporary file.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img44.png)", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img45.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "and store the result in System32 with one of the following names with extension “.dll”:", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img08.png)", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img09.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "### **References**", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "In this case, it creates the slave with the token of the user who owns the explorer.exe and tries to navigate with the URIs provided by the master due to the pipes created.", "sentence_right": "* [1] <https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia>", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "**12c6c48e1e52ebca20f4b890922fb31965317865d35ac04d216ad8b78f866999**", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "| **07f5fa96d31ed75edba8699f53a75502ade214b34469163011ced5b94e393f32**", "sentence_right": "**1486746bdba1161cfc15f37011c815911c33a2abd657198b835ac5f8eede663c**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Kwampirs RAT depending on the number of parameters will have a different behavior.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "This has not changed since the Symantec report.", "sentence_right": "The possibilities implemented on this occasion are two, when **three** parameters and when **four** parameters are passed to the function.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "“Lucas-PC\\Lucas\\192.168.19.2\\0\\Mon Dec 03 17:38:27 2018”", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "This function generates a string like the following:", "sentence_right": "The string consists of the user and domain with which the other system has been infected, the IP address of the infected victim computer, the number that it has received as a parameter and that identifies the SMB scanning algorithm that detected the victim, and the date and time of infection.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "[[1]](https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia)", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "The OrangeWorm group was named and described by the Symantec Company in different blog entries", "sentence_right": "[[2]](https://content.connect.symantec.com/sites/default/files/2018-04/Orangeworm%20IOCs.pdf).", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "This string encrypts it with an XOR algorithm using a 203-byte hardcoded key and adds it to a temporary file called “Lb978YTy.tmp”", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "The string consists of the user and domain with which the other system has been infected, the IP address of the infected victim computer, the number that it has received as a parameter and that identifies the SMB scanning algorithm that detected the victim, and the date and time of infection.", "sentence_right": "Finally, it creates a new copy of itself in System32 of the local computer, and executes it this time with 3 parameters, to which it passes, firstly the IP address of the computer it has just infected, and then two more parameters, similar to those it has received in its execution.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "First, check the existence of the file “C:\\Windows\\inf\\IE11.PNF”, its size (66Bytes) and if it has enough privileges to access it.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "It should be noted that this section is completely dependent on having administrator privileges, and in case of not having them, in many points of the execution jumps directly to the end of the logic, thus ending its execution.", "sentence_right": "If it detects that it already exists (which would indicate that the computer is already infected) or that it does not have enough privileges (which would prevent it from performing the rest of the logic) it ends  the execution.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "After generating this file, it finishes its execution, having started another instance of its own, as a service, and without parameters.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img04-1.png)", "sentence_right": "**Execution without parameters**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "* wmiapsvre.exe", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "* wmiapsvrce.exe", "sentence_right": "* wmiapvsre.exe", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "This device has the following static characteristics:", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "OrangeWorm within its arsenal has a RAT in Dll format (from now on Kwampirs) that is executed by “Kwampirs Dropper”.", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_cod01.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "* 3 = E$\\WINDOWS", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "* 2 = D$\\WINDOWS", "sentence_right": "The third parameter, can be a number between 0 and 6, and corresponds to the name that has put the copy of itself in the remote computer, as follows:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Once deciphered we will see them reflected in memory:In the image above you can see the memory segment with all the URIs that the malware will try in order to communicate.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "1.The first thing it does is to decipher the compromise indicators (IOCs from now on).", "sentence_right": "To decipher the IOCs the malware uses the following logic:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "In this case, it creates the slave with the token of the user who owns the explorer.exe and tries to navigate with the URIs provided by the master due to the pipes created.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "A situation where this logic is used is when the master process initiated by the service cannot navigate.", "sentence_right": "### **References**", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "With this, and the address of the remote computer that has as its first parameter, tries to create and start the service “WmiApSrvEx” on the remote computer, generating traffic like the following:", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "* 6 = wmiapsrvcx.exe", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img17.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "It looks like there are two instances of Kwampirs, but one with the user SYSTEM and another with the user Lucas.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img34.png)", "sentence_right": "This makes sense since there are occasions where the user SYSTEM cannot exit through the proxy of the organization and with this technique aims to take the user who may have configured the proxy and thus exit.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "It is seen in the image how the handler where you write WriteFile () is 0x240 (it is seen at the top of the stack) that if we open the handles of the rundll32 master process we see that it is a", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "This data as you can see in the image is a numerical value and a URI.", "sentence_right": "Named Pipe:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}