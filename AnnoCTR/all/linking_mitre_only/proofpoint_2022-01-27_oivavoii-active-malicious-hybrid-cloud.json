{"mention": "malicious OAuth apps and targeted phishing threats.", "context_left": "* This campaign uses hijacked Office 365 tenants and a sophisticated combination of cleverly-crafted lures,", "context_right": "", "_context_left": "* This campaign uses hijacked Office 365 tenants and a sophisticated combination of cleverly-crafted lures, ", "_context_right": "", "sentence_left": "* Beginning January 18, 2022, Proofpoint researchers observed a new malicious hybrid cloud campaign named OiVaVoii.", "sentence_right": "**Potential Impact:** We have seen account takeovers (through malicious OAuth apps stealing OAuth tokens and through credential theft).", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "hijacked Office 365 tenants and a sophisticated combination of cleverly-crafted lures", "context_left": "* This campaign uses", "context_right": ", malicious OAuth apps and targeted phishing threats.", "_context_left": "* This campaign uses ", "_context_right": ", malicious OAuth apps and targeted phishing threats.", "sentence_left": "* Beginning January 18, 2022, Proofpoint researchers observed a new malicious hybrid cloud campaign named OiVaVoii.", "sentence_right": "**Potential Impact:** We have seen account takeovers (through malicious OAuth apps stealing OAuth tokens and through credential theft).", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "malicious OAuth apps", "context_left": "* This campaign uses hijacked Office 365 tenants and a sophisticated combination of cleverly-crafted lures,", "context_right": "and targeted phishing threats.", "_context_left": "* This campaign uses hijacked Office 365 tenants and a sophisticated combination of cleverly-crafted lures, ", "_context_right": " and targeted phishing threats.", "sentence_left": "* Beginning January 18, 2022, Proofpoint researchers observed a new malicious hybrid cloud campaign named OiVaVoii.", "sentence_right": "**Potential Impact:** We have seen account takeovers (through malicious OAuth apps stealing OAuth tokens and through credential theft).", "label": "Adversaries can steal user application access tokens as a means of acquiring credentials to access remote systems and resources. This can occur through social engineering and typically requires user action to grant access. Application access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. An application desiring access to cloud-based services or protected APIs can gain entry using OAuth 2.0 through a variety of authorization protocols. An example commonly-used sequence is Microsoft's Authorization Code Grant flow.(Citation: Microsoft Identity Platform Protocols May 2019)(Citation: Microsoft - OAuth Code Authorization flow - June 2019) An OAuth access token enables a third-party application to interact with resources containing user data in the ways requested by the application without obtaining user credentials. Adversaries can leverage OAuth authorization by constructing a malicious application designed to be granted access to resources with the target user's OAuth token. The adversary will need to complete registration of their application with the authorization server, for example Microsoft Identity Platform using Azure Portal, the Visual Studio IDE, the command-line interface, PowerShell, or REST API calls.(Citation: Microsoft - Azure AD App Registration - May 2019) Then, they can send a link through [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) to the target user to entice them to grant access to the application.", "label_id": 424, "label_title": "Steal Application Access Token", "label_link": "https://attack.mitre.org/techniques/T1528", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "malicious OAuth apps stealing OAuth tokens and through credential theft).", "context_left": "**Potential Impact:** We have seen account takeovers (through", "context_right": "", "_context_left": "**Potential Impact:** We have seen account takeovers (through ", "_context_right": "", "sentence_left": "* This campaign uses hijacked Office 365 tenants and a sophisticated combination of cleverly-crafted lures, malicious OAuth apps and targeted phishing threats.", "sentence_right": "There are other potential risks after account takeovers, chiefly: persistent DLP risks, continued phishing, lateral movement, brand abuse and malware proliferation.", "label": "Adversaries can steal user application access tokens as a means of acquiring credentials to access remote systems and resources. This can occur through social engineering and typically requires user action to grant access. Application access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. An application desiring access to cloud-based services or protected APIs can gain entry using OAuth 2.0 through a variety of authorization protocols. An example commonly-used sequence is Microsoft's Authorization Code Grant flow.(Citation: Microsoft Identity Platform Protocols May 2019)(Citation: Microsoft - OAuth Code Authorization flow - June 2019) An OAuth access token enables a third-party application to interact with resources containing user data in the ways requested by the application without obtaining user credentials. Adversaries can leverage OAuth authorization by constructing a malicious application designed to be granted access to resources with the target user's OAuth token. The adversary will need to complete registration of their application with the authorization server, for example Microsoft Identity Platform using Azure Portal, the Visual Studio IDE, the command-line interface, PowerShell, or REST API calls.(Citation: Microsoft - Azure AD App Registration - May 2019) Then, they can send a link through [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) to the target user to entice them to grant access to the application.", "label_id": 424, "label_title": "Steal Application Access Token", "label_link": "https://attack.mitre.org/techniques/T1528", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "continued phishing", "context_left": "There are other potential risks after account takeovers, chiefly: persistent DLP risks,", "context_right": ", lateral movement, brand abuse and malware proliferation.", "_context_left": "There are other potential risks after account takeovers, chiefly: persistent DLP risks, ", "_context_right": ", lateral movement, brand abuse and malware proliferation.", "sentence_left": "**Potential Impact:** We have seen account takeovers (through malicious OAuth apps stealing OAuth tokens and through credential theft).", "sentence_right": "**People impact:** Successfully taken over many C-level executives’ accounts, including CEOs, general managers, former board members and presidents.", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "lateral movement", "context_left": "There are other potential risks after account takeovers, chiefly: persistent DLP risks, continued phishing,", "context_right": ", brand abuse and malware proliferation.", "_context_left": "There are other potential risks after account takeovers, chiefly: persistent DLP risks, continued phishing, ", "_context_right": ", brand abuse and malware proliferation.", "sentence_left": "**Potential Impact:** We have seen account takeovers (through malicious OAuth apps stealing OAuth tokens and through credential theft).", "sentence_right": "**People impact:** Successfully taken over many C-level executives’ accounts, including CEOs, general managers, former board members and presidents.", "label": "The adversary is trying to move through your environment. Lateral Movement consists of techniques that adversaries use to enter and control remote systems on a network. Following through on their primary objective often requires exploring the network to find their target and subsequently gaining access to it. Reaching their objective often involves pivoting through multiple systems and accounts to gain. Adversaries might install their own remote access tools to accomplish Lateral Movement or use legitimate credentials with native network and operating system tools, which may be stealthier.", "label_id": 580, "label_title": "Lateral Movement", "label_link": "https://attack.mitre.org/tactics/TA0008", "entity_class": "CE", "entity_type": "TACTIC", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "five malicious OAuth applications", "context_left": "By analyzing monitored email traffic and cloud users’ activities, Proofpoint researchers have so far uncovered", "context_right": "attributed to the campaign (nicknamed “*OiVaVoii*” by analysts due to its associated domain).", "_context_left": "By analyzing monitored email traffic and cloud users’ activities, Proofpoint researchers have so far uncovered ", "_context_right": " attributed to the campaign (nicknamed “*OiVaVoii*” by analysts due to its associated domain).", "sentence_left": "### **Attack Chain of OiVaVoii Campaign**", "sentence_right": "Below are examples of malicious apps created by a “verified” organization (\"Yuma Counseling Services\") and by a non-verified organization as part of the same campaign.", "label": "Adversaries can steal user application access tokens as a means of acquiring credentials to access remote systems and resources. This can occur through social engineering and typically requires user action to grant access. Application access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. An application desiring access to cloud-based services or protected APIs can gain entry using OAuth 2.0 through a variety of authorization protocols. An example commonly-used sequence is Microsoft's Authorization Code Grant flow.(Citation: Microsoft Identity Platform Protocols May 2019)(Citation: Microsoft - OAuth Code Authorization flow - June 2019) An OAuth access token enables a third-party application to interact with resources containing user data in the ways requested by the application without obtaining user credentials. Adversaries can leverage OAuth authorization by constructing a malicious application designed to be granted access to resources with the target user's OAuth token. The adversary will need to complete registration of their application with the authorization server, for example Microsoft Identity Platform using Azure Portal, the Visual Studio IDE, the command-line interface, PowerShell, or REST API calls.(Citation: Microsoft - Azure AD App Registration - May 2019) Then, they can send a link through [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) to the target user to entice them to grant access to the application.", "label_id": 424, "label_title": "Steal Application Access Token", "label_link": "https://attack.mitre.org/techniques/T1528", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "dedicated malicious Office tenant.", "context_left": "Out of the remaining two apps, at least one was created by a non-verified organization, which could imply leveraging a (third) hijacked cloud environment or using a", "context_right": "", "_context_left": "Out of the remaining two apps, at least one was created by a non-verified organization, which could imply leveraging a (third) hijacked cloud environment or using a ", "_context_right": "", "sentence_left": "At least three of these condemned third-party apps were created by two different “verified publishers,” meaning the app’s owner was likely a compromised admin user-account within a legitimate Office tenant.", "sentence_right": "Once these apps were created, authorization requests were then sent, via email, to numerous targeted users, including high-level executives.", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "enables the attackers to generate OAuth tokens on the compromised user’s behalf and complete the account takeover", "context_left": "This", "context_right": ".", "_context_left": "This ", "_context_right": ".", "sentence_left": "The seemingly benign identity of the publishing organization was a substantial advantage, causing multiple unsuspecting victims to authorize these applications.", "sentence_right": "This modus-operandi is similar to the one previously covered in our [recent blog](/us/blog/email-and-cloud-threats/how-attackers-use-compromised-accounts-create-and-distribute-malicious \"How Attackers Use Compromised Accounts to Create and Distribute Malicious OAuth Apps\").", "label": "Adversaries can steal user application access tokens as a means of acquiring credentials to access remote systems and resources. This can occur through social engineering and typically requires user action to grant access. Application access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. An application desiring access to cloud-based services or protected APIs can gain entry using OAuth 2.0 through a variety of authorization protocols. An example commonly-used sequence is Microsoft's Authorization Code Grant flow.(Citation: Microsoft Identity Platform Protocols May 2019)(Citation: Microsoft - OAuth Code Authorization flow - June 2019) An OAuth access token enables a third-party application to interact with resources containing user data in the ways requested by the application without obtaining user credentials. Adversaries can leverage OAuth authorization by constructing a malicious application designed to be granted access to resources with the target user's OAuth token. The adversary will need to complete registration of their application with the authorization server, for example Microsoft Identity Platform using Azure Portal, the Visual Studio IDE, the command-line interface, PowerShell, or REST API calls.(Citation: Microsoft - Azure AD App Registration - May 2019) Then, they can send a link through [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) to the target user to entice them to grant access to the application.", "label_id": 424, "label_title": "Steal Application Access Token", "label_link": "https://attack.mitre.org/techniques/T1528", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "Malicious OAuth Apps\"", "context_left": "This modus-operandi is similar to the one previously covered in our [recent blog](/us/blog/email-and-cloud-threats/how-attackers-use-compromised-accounts-create-and-distribute-malicious \"How Attackers Use Compromised Accounts to Create and Distribute", "context_right": ").", "_context_left": "This modus-operandi is similar to the one previously covered in our [recent blog](/us/blog/email-and-cloud-threats/how-attackers-use-compromised-accounts-create-and-distribute-malicious \"How Attackers Use Compromised Accounts to Create and Distribute ", "_context_right": ").", "sentence_left": "This enables the attackers to generate OAuth tokens on the compromised user’s behalf and complete the account takeover.", "sentence_right": "### **Highlights from this campaign**", "label": "Adversaries can steal user application access tokens as a means of acquiring credentials to access remote systems and resources. This can occur through social engineering and typically requires user action to grant access. Application access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. An application desiring access to cloud-based services or protected APIs can gain entry using OAuth 2.0 through a variety of authorization protocols. An example commonly-used sequence is Microsoft's Authorization Code Grant flow.(Citation: Microsoft Identity Platform Protocols May 2019)(Citation: Microsoft - OAuth Code Authorization flow - June 2019) An OAuth access token enables a third-party application to interact with resources containing user data in the ways requested by the application without obtaining user credentials. Adversaries can leverage OAuth authorization by constructing a malicious application designed to be granted access to resources with the target user's OAuth token. The adversary will need to complete registration of their application with the authorization server, for example Microsoft Identity Platform using Azure Portal, the Visual Studio IDE, the command-line interface, PowerShell, or REST API calls.(Citation: Microsoft - Azure AD App Registration - May 2019) Then, they can send a link through [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) to the target user to entice them to grant access to the application.", "label_id": 424, "label_title": "Steal Application Access Token", "label_link": "https://attack.mitre.org/techniques/T1528", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "Some apps impersonate Microsoft software, using icon impersonation.", "context_left": "* **Microsoft logo:**", "context_right": "", "_context_left": "* **Microsoft logo:**", "_context_right": "", "sentence_left": "This means that clicking “Cancel” simply reloads the same page, keeping the user in a loop.", "sentence_right": "* **MITM:** apps potentially use MITM proxy attacks.", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "MITM", "context_left": "* **", "context_right": ":** apps potentially use MITM proxy attacks.", "_context_left": "* **", "_context_right": ":** apps potentially use MITM proxy attacks.", "sentence_left": "* **Microsoft logo:**Some apps impersonate Microsoft software, using icon impersonation.", "sentence_right": "This means that credential theft could take place as part of the attack flow, greatly increasing the risk of a complete account takeover and prolonged persistency.", "label": "Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.(Citation: Rapid7 MiTM Basics) Adversaries may leverage the AiTM position to attempt to modify traffic, such as in [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). Adversaries can also stop traffic from flowing to the appropriate destination, causing denial of service.", "label_id": 304, "label_title": "Adversary-in-the-Middle", "label_link": "https://attack.mitre.org/techniques/T1557", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "MITM", "context_left": "* **MITM:** apps potentially use", "context_right": "proxy attacks.", "_context_left": "* **MITM:** apps potentially use ", "_context_right": " proxy attacks.", "sentence_left": "* **Microsoft logo:**Some apps impersonate Microsoft software, using icon impersonation.", "sentence_right": "This means that credential theft could take place as part of the attack flow, greatly increasing the risk of a complete account takeover and prolonged persistency.", "label": "Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.(Citation: Rapid7 MiTM Basics) Adversaries may leverage the AiTM position to attempt to modify traffic, such as in [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). Adversaries can also stop traffic from flowing to the appropriate destination, causing denial of service.", "label_id": 304, "label_title": "Adversary-in-the-Middle", "label_link": "https://attack.mitre.org/techniques/T1557", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "credential theft", "context_left": "This means that", "context_right": "could take place as part of the attack flow, greatly increasing the risk of a complete account takeover and prolonged persistency.", "_context_left": "This means that ", "_context_right": " could take place as part of the attack flow, greatly increasing the risk of a complete account takeover and prolonged persistency.", "sentence_left": "* **MITM:** apps potentially use MITM proxy attacks.", "sentence_right": "* **C-level executives targeted:**a high percentage of targeted and compromised C-level executives was seen.", "label": "The adversary is trying to steal account names and passwords. Credential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.", "label_id": 585, "label_title": "Credential Access", "label_link": "https://attack.mitre.org/tactics/TA0006", "entity_class": "CE", "entity_type": "TACTIC", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "complete account takeover and prolonged persistency.", "context_left": "This means that credential theft could take place as part of the attack flow, greatly increasing the risk of a", "context_right": "", "_context_left": "This means that credential theft could take place as part of the attack flow, greatly increasing the risk of a ", "_context_right": "", "sentence_left": "* **MITM:** apps potentially use MITM proxy attacks.", "sentence_right": "* **C-level executives targeted:**a high percentage of targeted and compromised C-level executives was seen.", "label": "Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence. The overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise. (Citation: TechNet Credential Theft)", "label_id": 4, "label_title": "Valid Accounts", "label_link": "https://attack.mitre.org/techniques/T1078", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "allowing them to send internal and external malicious email messages, steal valuable information, and create mailbox rules (applied for data leakage and persistency purposes).", "context_left": "* **Application scopes:** all detected apps requested similar permissions, pertaining mainly to mailbox access (read and write),", "context_right": "", "_context_left": "* **Application scopes:** all detected apps requested similar permissions, pertaining mainly to mailbox access (read and write), ", "_context_right": "", "sentence_left": "Amongst detected affected titleholders are CEOs, presidents, board members, VPs and other high-profile users.", "sentence_right": "### **Detected malicious applications**", "label": "The adversary is trying to steal data. Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.", "label_id": 583, "label_title": "Exfiltration", "label_link": "https://attack.mitre.org/tactics/TA0010", "entity_class": "CE", "entity_type": "TACTIC", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}
{"mention": "malicious third party OAuth apps", "context_left": "### **Screenshots of", "context_right": "used in this campaign**", "_context_left": "### **Screenshots of ", "_context_right": " used in this campaign**", "sentence_left": "* hxxps://viox[.]dev/callback", "sentence_right": "![MSFT](/sites/default/files/inline-images/Screen%20Shot%202022-01-27%20at%204.33.19%20PM.png)", "label": "Adversaries can steal user application access tokens as a means of acquiring credentials to access remote systems and resources. This can occur through social engineering and typically requires user action to grant access. Application access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. An application desiring access to cloud-based services or protected APIs can gain entry using OAuth 2.0 through a variety of authorization protocols. An example commonly-used sequence is Microsoft's Authorization Code Grant flow.(Citation: Microsoft Identity Platform Protocols May 2019)(Citation: Microsoft - OAuth Code Authorization flow - June 2019) An OAuth access token enables a third-party application to interact with resources containing user data in the ways requested by the application without obtaining user credentials. Adversaries can leverage OAuth authorization by constructing a malicious application designed to be granted access to resources with the target user's OAuth token. The adversary will need to complete registration of their application with the authorization server, for example Microsoft Identity Platform using Azure Portal, the Visual Studio IDE, the command-line interface, PowerShell, or REST API calls.(Citation: Microsoft - Azure AD App Registration - May 2019) Then, they can send a link through [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) to the target user to entice them to grant access to the application.", "label_id": 424, "label_title": "Steal Application Access Token", "label_link": "https://attack.mitre.org/techniques/T1528", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}