{"mention": "FK_Undead", "context_left": "Recent", "context_right": "rootkit samples found in the wild June 09, 2020", "_context_left": "Recent ", "_context_right": " rootkit samples found in the wild", "sentence_left": "", "sentence_right": "June 09, 2020", "label": "FK_Undead", "label_id": 1285, "label_title": "FK_Undead", "label_link": "http://www.bosch.com#node1fvup9pj1x42", "entity_class": "CE", "entity_type": "MALWARE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "rootkit", "context_left": "Recent FK_Undead", "context_right": "samples found in the wild June 09, 2020", "_context_left": "Recent FK_Undead ", "_context_right": " samples found in the wild", "sentence_left": "", "sentence_right": "June 09, 2020", "label": "Adversaries may use rootkits to hide the presence of programs, files, network connections, services, drivers, and other system components. Rootkits are programs that hide the existence of malware by intercepting/hooking and modifying operating system API calls that supply system information. (Citation: Symantec Windows Rootkits) Rootkits or rootkit enabling functionality may reside at the user or kernel level in the operating system or lower, to include a hypervisor, Master Boot Record, or [System Firmware](https://attack.mitre.org/techniques/T1542/001). (Citation: Wikipedia Rootkit) Rootkits have been seen for Windows, Linux, and Mac OS X systems. (Citation: CrowdStrike Linux Rootkit) (Citation: BlackHat Mac OSX Rootkit)", "label_id": 57, "label_title": "Rootkit", "label_link": "https://attack.mitre.org/techniques/T1014", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "rootkit", "context_left": "June 09, 2020 Malware that works at Ring0, generally known as", "context_right": ", is one of the most concerning in many environments because it shares privileges and capabilities with antivirus and EDR solutions, which greatly complicates its detection as far as they can tamper and/or hide the data that allows its detection with relative ease. One of these examples is a threat Known FK\\_Undead, which among its multiple stages of infection and modules, has at least 3 different Rootkit modules.", "_context_left": "Malware that works at Ring0, generally known as ", "_context_right": ", is one of the most concerning in many environments because it shares privileges and capabilities with antivirus and EDR solutions, which greatly complicates its detection as far as they can tamper and/or hide the data that allows its detection with relative ease.", "sentence_left": "June 09, 2020", "sentence_right": "One of these examples is a threat Known FK\\_Undead, which among its multiple stages of infection and modules, has at least 3 different Rootkit modules.", "label": "Adversaries may use rootkits to hide the presence of programs, files, network connections, services, drivers, and other system components. Rootkits are programs that hide the existence of malware by intercepting/hooking and modifying operating system API calls that supply system information. (Citation: Symantec Windows Rootkits) Rootkits or rootkit enabling functionality may reside at the user or kernel level in the operating system or lower, to include a hypervisor, Master Boot Record, or [System Firmware](https://attack.mitre.org/techniques/T1542/001). (Citation: Wikipedia Rootkit) Rootkits have been seen for Windows, Linux, and Mac OS X systems. (Citation: CrowdStrike Linux Rootkit) (Citation: BlackHat Mac OSX Rootkit)", "label_id": 57, "label_title": "Rootkit", "label_link": "https://attack.mitre.org/techniques/T1014", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "it shares privileges and capabilities with antivirus and EDR solutions, which greatly complicates its detection as far as they can tamper and/or hide the data that allows its detection with relative ease.", "context_left": "June 09, 2020 Malware that works at Ring0, generally known as rootkit, is one of the most concerning in many environments because", "context_right": "One of these examples is a threat Known FK\\_Undead, which among its multiple stages of infection and modules, has at least 3 different Rootkit modules.", "_context_left": "Malware that works at Ring0, generally known as rootkit, is one of the most concerning in many environments because ", "_context_right": "", "sentence_left": "June 09, 2020", "sentence_right": "One of these examples is a threat Known FK\\_Undead, which among its multiple stages of infection and modules, has at least 3 different Rootkit modules.", "label": "Adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools. Masquerading occurs when the name or location of an object, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. This may include manipulating file metadata, tricking users into misidentifying the file type, and giving legitimate task or service names. Renaming abusable system utilities to evade security monitoring is also a form of [Masquerading](https://attack.mitre.org/techniques/T1036).(Citation: LOLBAS Main Site)", "label_id": 142, "label_title": "Masquerading", "label_link": "https://attack.mitre.org/techniques/T1036", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "Rootkit", "context_left": "Malware that works at Ring0, generally known as rootkit, is one of the most concerning in many environments because it shares privileges and capabilities with antivirus and EDR solutions, which greatly complicates its detection as far as they can tamper and/or hide the data that allows its detection with relative ease. One of these examples is a threat Known FK\\_Undead, which among its multiple stages of infection and modules, has at least 3 different", "context_right": "modules. This malware family [was detected](https://www.freebuf.com/articles/system/198869.html) for the first time in November 2018 and has remained active and in continuous evolution.", "_context_left": "One of these examples is a threat Known FK\\_Undead, which among its multiple stages of infection and modules, has at least 3 different ", "_context_right": " modules.", "sentence_left": "Malware that works at Ring0, generally known as rootkit, is one of the most concerning in many environments because it shares privileges and capabilities with antivirus and EDR solutions, which greatly complicates its detection as far as they can tamper and/or hide the data that allows its detection with relative ease.", "sentence_right": "This malware family [was detected](https://www.freebuf.com/articles/system/198869.html) for the first time in November 2018 and has remained active and in continuous evolution.", "label": "Adversaries may use rootkits to hide the presence of programs, files, network connections, services, drivers, and other system components. Rootkits are programs that hide the existence of malware by intercepting/hooking and modifying operating system API calls that supply system information. (Citation: Symantec Windows Rootkits) Rootkits or rootkit enabling functionality may reside at the user or kernel level in the operating system or lower, to include a hypervisor, Master Boot Record, or [System Firmware](https://attack.mitre.org/techniques/T1542/001). (Citation: Wikipedia Rootkit) Rootkits have been seen for Windows, Linux, and Mac OS X systems. (Citation: CrowdStrike Linux Rootkit) (Citation: BlackHat Mac OSX Rootkit)", "label_id": 57, "label_title": "Rootkit", "label_link": "https://attack.mitre.org/techniques/T1014", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "It check’s the victim’s location", "context_left": "Regarding it’s infecction chain, from what has been observed to date, the first element with which it infects a system is a dropper that renames itself as “ntprint.exe” and copies itself to the %TEMP% folder.", "context_right": "by contacting to “http://pv.sohu.]com/cityjson” after which downloads an executable protected with VMProtect that is stored in the %programdata% folder with a random name and executes it. If this executable does not detect a virtualized environment, it downloads several malicious drivers of type Rootkit:", "_context_left": "", "_context_right": " by contacting to “http://pv.sohu.]com/cityjson” after which downloads an executable protected with VMProtect that is stored in the %programdata% folder with a random name and executes it.", "sentence_left": "Regarding it’s infecction chain, from what has been observed to date, the first element with which it infects a system is a dropper that renames itself as “ntprint.exe” and copies itself to the %TEMP% folder.", "sentence_right": "If this executable does not detect a virtualized environment, it downloads several malicious drivers of type Rootkit:", "label": "Adversaries may gather information in an attempt to calculate the geographical location of a victim host. Adversaries may use the information from [System Location Discovery](https://attack.mitre.org/techniques/T1614) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Adversaries may attempt to infer the location of a system using various system checks, such as time zone, keyboard layout, and/or language settings.(Citation: FBI Ragnar Locker 2020)(Citation: Sophos Geolocation 2016)(Citation: Bleepingcomputer RAT malware 2020) Windows API functions such as <code>GetLocaleInfoW</code> can also be used to determine the locale of the host.(Citation: FBI Ragnar Locker 2020) In cloud environments, an instance's availability zone may also be discovered by accessing the instance metadata service from the instance.(Citation: AWS Instance Identity Documents)(Citation: Microsoft Azure Instance Metadata 2021) Adversaries may also attempt to infer the location of a victim host using IP addressing, such as via online geolocation IP-lookup services.(Citation: Securelist Trasparent Tribe 2020)(Citation: Sophos Geolocation 2016)", "label_id": 179, "label_title": "System Location Discovery", "label_link": "https://attack.mitre.org/techniques/T1614", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "which downloads an executable protected with VMProtect that is stored in the %programdata% folder with a random name and executes it", "context_left": "Regarding it’s infecction chain, from what has been observed to date, the first element with which it infects a system is a dropper that renames itself as “ntprint.exe” and copies itself to the %TEMP% folder. It check’s the victim’s location by contacting to “http://pv.sohu.]com/cityjson” after", "context_right": ". If this executable does not detect a virtualized environment, it downloads several malicious drivers of type Rootkit:", "_context_left": "It check’s the victim’s location by contacting to “http://pv.sohu.]com/cityjson” after ", "_context_right": ".", "sentence_left": "Regarding it’s infecction chain, from what has been observed to date, the first element with which it infects a system is a dropper that renames itself as “ntprint.exe” and copies itself to the %TEMP% folder.", "sentence_right": "If this executable does not detect a virtualized environment, it downloads several malicious drivers of type Rootkit:", "label": "Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.", "label_id": 202, "label_title": "Ingress Tool Transfer", "label_link": "https://attack.mitre.org/techniques/T1105", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "Rootkit", "context_left": "It check’s the victim’s location by contacting to “http://pv.sohu.]com/cityjson” after which downloads an executable protected with VMProtect that is stored in the %programdata% folder with a random name and executes it. If this executable does not detect a virtualized environment, it downloads several malicious drivers of type", "context_right": ": The first of this drivers, the most complete, is in charge of:", "_context_left": "If this executable does not detect a virtualized environment, it downloads several malicious drivers of type ", "_context_right": ":", "sentence_left": "It check’s the victim’s location by contacting to “http://pv.sohu.]com/cityjson” after which downloads an executable protected with VMProtect that is stored in the %programdata% folder with a random name and executes it.", "sentence_right": "The first of this drivers, the most complete, is in charge of:", "label": "Adversaries may use rootkits to hide the presence of programs, files, network connections, services, drivers, and other system components. Rootkits are programs that hide the existence of malware by intercepting/hooking and modifying operating system API calls that supply system information. (Citation: Symantec Windows Rootkits) Rootkits or rootkit enabling functionality may reside at the user or kernel level in the operating system or lower, to include a hypervisor, Master Boot Record, or [System Firmware](https://attack.mitre.org/techniques/T1542/001). (Citation: Wikipedia Rootkit) Rootkits have been seen for Windows, Linux, and Mac OS X systems. (Citation: CrowdStrike Linux Rootkit) (Citation: BlackHat Mac OSX Rootkit)", "label_id": 57, "label_title": "Rootkit", "label_link": "https://attack.mitre.org/techniques/T1014", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "executable does not detect a virtualized environment", "context_left": "It check’s the victim’s location by contacting to “http://pv.sohu.]com/cityjson” after which downloads an executable protected with VMProtect that is stored in the %programdata% folder with a random name and executes it. If this", "context_right": ", it downloads several malicious drivers of type Rootkit: The first of this drivers, the most complete, is in charge of:", "_context_left": "If this ", "_context_right": ", it downloads several malicious drivers of type Rootkit:", "sentence_left": "It check’s the victim’s location by contacting to “http://pv.sohu.]com/cityjson” after which downloads an executable protected with VMProtect that is stored in the %programdata% folder with a random name and executes it.", "sentence_right": "The first of this drivers, the most complete, is in charge of:", "label": "Adversaries may employ various means to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness) Adversaries may use several methods to accomplish [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) such as checking for security monitoring tools (e.g., Sysinternals, Wireshark, etc.) or other system artifacts associated with analysis or virtualization. Adversaries may also check for legitimate user activity to help determine if it is in an analysis environment. Additional methods include use of sleep timers or loops within malware code to avoid operating within a temporary sandbox.(Citation: Unit 42 Pirpi July 2015)", "label_id": 291, "label_title": "Virtualization/Sandbox Evasion", "label_link": "https://attack.mitre.org/techniques/T1497", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "downloads several malicious drivers of type Rootkit", "context_left": "It check’s the victim’s location by contacting to “http://pv.sohu.]com/cityjson” after which downloads an executable protected with VMProtect that is stored in the %programdata% folder with a random name and executes it. If this executable does not detect a virtualized environment, it", "context_right": ": The first of this drivers, the most complete, is in charge of:", "_context_left": "If this executable does not detect a virtualized environment, it ", "_context_right": ":", "sentence_left": "It check’s the victim’s location by contacting to “http://pv.sohu.]com/cityjson” after which downloads an executable protected with VMProtect that is stored in the %programdata% folder with a random name and executes it.", "sentence_right": "The first of this drivers, the most complete, is in charge of:", "label": "Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.", "label_id": 202, "label_title": "Ingress Tool Transfer", "label_link": "https://attack.mitre.org/techniques/T1105", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "Monitoring all computer traffic,", "context_left": "The first of this drivers, the most complete, is in charge of: 1.", "context_right": "blocking access to anti-virus solution websites and modifying the content of some websites by injecting it’s own code into the traffic results. 2.Adding a proxy to the browsers that routes all the victim’s traffic through a server controlled by the actors behind this threat.", "_context_left": "1.", "_context_right": " blocking access to anti-virus solution websites and modifying the content of some websites by injecting it’s own code into the traffic results.", "sentence_left": "The first of this drivers, the most complete, is in charge of:", "sentence_right": "2.Adding a proxy to the browsers that routes all the victim’s traffic through a server controlled by the actors behind this threat.", "label": "Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. An adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate.(Citation: Amazon AWS VPC Guide)(Citation: Microsoft Azure Virtual Network Overview)(Citation: Google VPC Overview) Utilities and commands that acquire this information include [netstat](https://attack.mitre.org/software/S0104), \"net use,\" and \"net session\" with [Net](https://attack.mitre.org/software/S0039). In Mac and Linux, [netstat](https://attack.mitre.org/software/S0104) and <code>lsof</code> can be used to list current connections. <code>who -a</code> and <code>w</code> can be used to show which users are currently logged in, similar to \"net session\".", "label_id": 242, "label_title": "System Network Connections Discovery", "label_link": "https://attack.mitre.org/techniques/T1049", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "blocking access to anti-virus solution", "context_left": "The first of this drivers, the most complete, is in charge of: 1.Monitoring all computer traffic,", "context_right": "websites and modifying the content of some websites by injecting it’s own code into the traffic results. 2.Adding a proxy to the browsers that routes all the victim’s traffic through a server controlled by the actors behind this threat.", "_context_left": "1.Monitoring all computer traffic, ", "_context_right": " websites and modifying the content of some websites by injecting it’s own code into the traffic results.", "sentence_left": "The first of this drivers, the most complete, is in charge of:", "sentence_right": "2.Adding a proxy to the browsers that routes all the victim’s traffic through a server controlled by the actors behind this threat.", "label": "Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as firewalls and anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may also span both native defenses as well as supplemental capabilities installed by users and administrators. Adversaries could also target event aggregation and analysis mechanisms, or otherwise disrupt these procedures by altering other system components.", "label_id": 147, "label_title": "Impair Defenses", "label_link": "https://attack.mitre.org/techniques/T1562", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "modifying the content of some websites by injecting it’s own code into the traffic results.", "context_left": "The first of this drivers, the most complete, is in charge of: 1.Monitoring all computer traffic, blocking access to anti-virus solution websites and", "context_right": "2.Adding a proxy to the browsers that routes all the victim’s traffic through a server controlled by the actors behind this threat.", "_context_left": "1.Monitoring all computer traffic, blocking access to anti-virus solution websites and ", "_context_right": "", "sentence_left": "The first of this drivers, the most complete, is in charge of:", "sentence_right": "2.Adding a proxy to the browsers that routes all the victim’s traffic through a server controlled by the actors behind this threat.", "label": "Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.(Citation: Rapid7 MiTM Basics) Adversaries may leverage the AiTM position to attempt to modify traffic, such as in [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). Adversaries can also stop traffic from flowing to the appropriate destination, causing denial of service.", "label_id": 304, "label_title": "Adversary-in-the-Middle", "label_link": "https://attack.mitre.org/techniques/T1557", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "Adding a proxy to the browsers that routes all the victim’s traffic through a server controlled by the actors behind this threat", "context_left": "1.Monitoring all computer traffic, blocking access to anti-virus solution websites and modifying the content of some websites by injecting it’s own code into the traffic results. 2.", "context_right": ". 3.Protect the registry entry of it’s own installation from being deleted from the system.", "_context_left": "2.", "_context_right": ".", "sentence_left": "1.Monitoring all computer traffic, blocking access to anti-virus solution websites and modifying the content of some websites by injecting it’s own code into the traffic results.", "sentence_right": "3.Protect the registry entry of it’s own installation from being deleted from the system.", "label": "Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.(Citation: Rapid7 MiTM Basics) Adversaries may leverage the AiTM position to attempt to modify traffic, such as in [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). Adversaries can also stop traffic from flowing to the appropriate destination, causing denial of service.", "label_id": 304, "label_title": "Adversary-in-the-Middle", "label_link": "https://attack.mitre.org/techniques/T1557", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "Protect the registry entry of it’s own installation from being deleted from the system.", "context_left": "2.Adding a proxy to the browsers that routes all the victim’s traffic through a server controlled by the actors behind this threat. 3.", "context_right": "4.Avoid loading drivers with certain signatures to protect itself from other malware of the same kind.", "_context_left": "3.", "_context_right": "", "sentence_left": "2.Adding a proxy to the browsers that routes all the victim’s traffic through a server controlled by the actors behind this threat.", "sentence_right": "4.Avoid loading drivers with certain signatures to protect itself from other malware of the same kind.", "label": "Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may span both native defenses as well as supplemental capabilities installed by users or mobile endpoint administrators.", "label_id": 1653, "label_title": "Impair Defenses", "label_link": "https://attack.mitre.org/techniques/T1629", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "command and control server", "context_left": "4.Avoid loading drivers with certain signatures to protect itself from other malware of the same kind. It downloads a list of signatures from it’s", "context_right": "every few seconds and prevents any driver with one of this signatures of being loaded. This is the updated list at the moment:", "_context_left": "It downloads a list of signatures from it’s ", "_context_right": " every few seconds and prevents any driver with one of this signatures of being loaded.", "sentence_left": "4.Avoid loading drivers with certain signatures to protect itself from other malware of the same kind.", "sentence_right": "This is the updated list at the moment:", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CI", "entity_type": "TACTIC", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "Callback Technologies” which offers an API for applications to control access to files on the disk by any program and even falsify the result.", "context_left": "| 北京新锐视锋科技有限公司 | The second driver is part of the framework of the company “", "context_right": "In particular, they only control when the process “svchost.exe” accesses the “HOSTS” file and serve to this process another file in its place, thus controlling the DNS resolutions of the victim without attracting attention, as far as when other software accesses the “HOSTS” file, it is the real one, which is clean, thus avoiding raising suspicion.", "_context_left": "The second driver is part of the framework of the company “", "_context_right": "", "sentence_left": "| 北京新锐视锋科技有限公司 |", "sentence_right": "In particular, they only control when the process “svchost.exe” accesses the “HOSTS” file and serve to this process another file in its place, thus controlling the DNS resolutions of the victim without attracting attention, as far as when other software accesses the “HOSTS” file, it is the real one, which is clean, thus avoiding raising suspicion.", "label": "Adversaries may steal data by exfiltrating it over an existing command and control channel. Stolen data is encoded into the normal communications channel using the same protocol as command and control communications.", "label_id": 195, "label_title": "Exfiltration Over C2 Channel", "label_link": "https://attack.mitre.org/techniques/T1041", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "downloading and installing certificates in the victim machine", "context_left": "In particular, they only control when the process “svchost.exe” accesses the “HOSTS” file and serve to this process another file in its place, thus controlling the DNS resolutions of the victim without attracting attention, as far as when other software accesses the “HOSTS” file, it is the real one, which is clean, thus avoiding raising suspicion. The third one is in charge of", "context_right": ", so that they can also control the victim’s SSL traffic completely, redirecting it to other sites or breaking the encryption on this legitimate traffic. It should be noted that these are the modules currently known, but they probably have more modules from which no information has been obtained to date as this threat has been active for over a year and has a lot of new activity.", "_context_left": "The third one is in charge of ", "_context_right": ", so that they can also control the victim’s SSL traffic completely, redirecting it to other sites or breaking the encryption on this legitimate traffic.", "sentence_left": "In particular, they only control when the process “svchost.exe” accesses the “HOSTS” file and serve to this process another file in its place, thus controlling the DNS resolutions of the victim without attracting attention, as far as when other software accesses the “HOSTS” file, it is the real one, which is clean, thus avoiding raising suspicion.", "sentence_right": "It should be noted that these are the modules currently known, but they probably have more modules from which no information has been obtained to date as this threat has been active for over a year and has a lot of new activity.", "label": "Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.", "label_id": 202, "label_title": "Ingress Tool Transfer", "label_link": "https://attack.mitre.org/techniques/T1105", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "that they can also control the victim’s SSL traffic completely, redirecting it to other sites or breaking the encryption on this legitimate traffic", "context_left": "In particular, they only control when the process “svchost.exe” accesses the “HOSTS” file and serve to this process another file in its place, thus controlling the DNS resolutions of the victim without attracting attention, as far as when other software accesses the “HOSTS” file, it is the real one, which is clean, thus avoiding raising suspicion. The third one is in charge of downloading and installing certificates in the victim machine, so", "context_right": ". It should be noted that these are the modules currently known, but they probably have more modules from which no information has been obtained to date as this threat has been active for over a year and has a lot of new activity.", "_context_left": "The third one is in charge of downloading and installing certificates in the victim machine, so ", "_context_right": ".", "sentence_left": "In particular, they only control when the process “svchost.exe” accesses the “HOSTS” file and serve to this process another file in its place, thus controlling the DNS resolutions of the victim without attracting attention, as far as when other software accesses the “HOSTS” file, it is the real one, which is clean, thus avoiding raising suspicion.", "sentence_right": "It should be noted that these are the modules currently known, but they probably have more modules from which no information has been obtained to date as this threat has been active for over a year and has a lot of new activity.", "label": "Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.(Citation: Rapid7 MiTM Basics) Adversaries may leverage the AiTM position to attempt to modify traffic, such as in [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). Adversaries can also stop traffic from flowing to the appropriate destination, causing denial of service.", "label_id": 304, "label_title": "Adversary-in-the-Middle", "label_link": "https://attack.mitre.org/techniques/T1557", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "majority of the downloads related to this malware are done over HTTP", "context_left": "It should be noted that these are the modules currently known, but they probably have more modules from which no information has been obtained to date as this threat has been active for over a year and has a lot of new activity. The", "context_right": "directly against IP addresses generally located in China and using relatively high ports. Some of the names of the threats at the time of download are as follows:", "_context_left": "The ", "_context_right": " directly against IP addresses generally located in China and using relatively high ports.", "sentence_left": "It should be noted that these are the modules currently known, but they probably have more modules from which no information has been obtained to date as this threat has been active for over a year and has a lot of new activity.", "sentence_right": "Some of the names of the threats at the time of download are as follows:", "label": "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Adversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP.", "label_id": 452, "label_title": "Application Layer Protocol", "label_link": "https://attack.mitre.org/techniques/T1071", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "contents are base64 encoded.", "context_left": "* “msadapdlx32.dat” Regarding the different configurations of each driver, the download is identical, but with a different name structure, since in this case they contain the word “list” in it’s name and it’s", "context_right": "* “paclist.dat”", "_context_left": "Regarding the different configurations of each driver, the download is identical, but with a different name structure, since in this case they contain the word “list” in it’s name and it’s ", "_context_right": "", "sentence_left": "* “msadapdlx32.dat”", "sentence_right": "* “paclist.dat”", "label": "Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. Payloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as JavaScript. Portions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016) Adversaries may also obfuscate commands executed from payloads or directly via a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017)(Citation: PaloAlto EncodedCommand March 2017)", "label_id": 544, "label_title": "Obfuscated Files or Information", "label_link": "https://attack.mitre.org/techniques/T1027", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "C2", "context_left": "IOCs", "context_right": "IP List | 106.]14.47.210  |", "_context_left": "", "_context_right": " IP List", "sentence_left": "IOCs", "sentence_right": "| 106.]14.47.210  |", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| 金华米粒网络技术服务有限公司 |", "context_left": "| Haining shengdun Network Information Technology Co., Ltd |", "context_right": "| 梁富庆上海天游软件有限公司 |", "_context_left": "", "_context_right": "", "sentence_left": "| Haining shengdun Network Information Technology Co., Ltd |", "sentence_right": "| 梁富庆上海天游软件有限公司 |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| 115].231.218.133 | 182].61.182.114 |", "context_left": "Redirect Servers", "context_right": "| 115].231.218.86 | 182].61.182.123 |", "_context_left": "", "_context_right": "", "sentence_left": "Redirect Servers", "sentence_right": "| 115].231.218.86 | 182].61.182.123 |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "June 09, 2020", "context_left": "Recent FK_Undead rootkit samples found in the wild", "context_right": "Malware that works at Ring0, generally known as rootkit, is one of the most concerning in many environments because it shares privileges and capabilities with antivirus and EDR solutions, which greatly complicates its detection as far as they can tamper and/or hide the data that allows its detection with relative ease.", "_context_left": "", "_context_right": "", "sentence_left": "Recent FK_Undead rootkit samples found in the wild", "sentence_right": "Malware that works at Ring0, generally known as rootkit, is one of the most concerning in many environments because it shares privileges and capabilities with antivirus and EDR solutions, which greatly complicates its detection as far as they can tamper and/or hide the data that allows its detection with relative ease.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| Zhou Donghang |", "context_left": "This is the updated list at the moment:", "context_right": "| Yuchengxian Feiwu service Co.,ltd |", "_context_left": "", "_context_right": "", "sentence_left": "This is the updated list at the moment:", "sentence_right": "| Yuchengxian Feiwu service Co.,ltd |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| fk\\_svcsdll.pdb | fk\\_adsexdrv32.pdb |", "context_left": "| fk\\_maindrv.pdb | fk\\_adswindll32.pdb |", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "| fk\\_maindrv.pdb | fk\\_adswindll32.pdb |", "sentence_right": "", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "Specifically, the volatility plugin in charge of doing this is “poolpeek” and requires as a parameter this PoolTag but reversed, since in memory, it is stored this way:", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2020/06/Captura-de-pantalla-de-2020-06-09-09-17-34.png)", "context_right": "* “poolpeek -t gtkf”", "_context_left": "", "_context_right": "", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2020/06/Captura-de-pantalla-de-2020-06-09-09-17-34.png)", "sentence_right": "* “poolpeek -t gtkf”", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "In particular, they only control when the process “svchost.exe” accesses the “HOSTS” file and serve to this process another file in its place, thus controlling the DNS resolutions of the victim without attracting attention, as far as when other software accesses the “HOSTS” file, it is the real one, which is clean, thus avoiding raising suspicion.", "context_left": "The second driver is part of the framework of the company “Callback Technologies” which offers an API for applications to control access to files on the disk by any program and even falsify the result.", "context_right": "The third one is in charge of downloading and installing certificates in the victim machine, so that they can also control the victim’s SSL traffic completely, redirecting it to other sites or breaking the encryption on this legitimate traffic.", "_context_left": "", "_context_right": "", "sentence_left": "The second driver is part of the framework of the company “Callback Technologies” which offers an API for applications to control access to files on the disk by any program and even falsify the result.", "sentence_right": "The third one is in charge of downloading and installing certificates in the victim machine, so that they can also control the victim’s SSL traffic completely, redirecting it to other sites or breaking the encryption on this legitimate traffic.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "This malware family [was detected](https://www.freebuf.com/articles/system/198869.html) for the first time in November 2018 and has remained active and in continuous evolution.", "context_left": "One of these examples is a threat Known FK\\_Undead, which among its multiple stages of infection and modules, has at least 3 different Rootkit modules.", "context_right": "Regarding it’s infecction chain, from what has been observed to date, the first element with which it infects a system is a dropper that renames itself as “ntprint.exe” and copies itself to the %TEMP% folder.", "_context_left": "", "_context_right": "", "sentence_left": "One of these examples is a threat Known FK\\_Undead, which among its multiple stages of infection and modules, has at least 3 different Rootkit modules.", "sentence_right": "Regarding it’s infecction chain, from what has been observed to date, the first element with which it infects a system is a dropper that renames itself as “ntprint.exe” and copies itself to the %TEMP% folder.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "* “poolpeek -t shkf”", "context_left": "* “poolpeek -t gtkf”", "context_right": "IOCs", "_context_left": "", "_context_right": "", "sentence_left": "* “poolpeek -t gtkf”", "sentence_right": "IOCs", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "Redirect Servers", "context_left": "| 45.]113.201.205 |", "context_right": "| 115].231.218.133 | 182].61.182.114 |", "_context_left": "", "_context_right": "", "sentence_left": "| 45.]113.201.205 |", "sentence_right": "| 115].231.218.133 | 182].61.182.114 |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| 姚秋玲 |", "context_left": "| 梁富庆上海天游软件有限公司 |", "context_right": "| 上海域联软件技术有限公司 |", "_context_left": "", "_context_right": "", "sentence_left": "| 梁富庆上海天游软件有限公司 |", "sentence_right": "| 上海域联软件技术有限公司 |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| 139.]196.228.142 |", "context_left": "| 103.]216.154.25 |", "context_right": "| 45.]113.201.205 |", "_context_left": "", "_context_right": "", "sentence_left": "| 103.]216.154.25 |", "sentence_right": "| 45.]113.201.205 |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| 115].231.218.86 | 182].61.182.123 |", "context_left": "| 115].231.218.133 | 182].61.182.114 |", "context_right": "| 182].61.164.201 | 182].61.182.97 |", "_context_left": "", "_context_right": "", "sentence_left": "| 115].231.218.133 | 182].61.182.114 |", "sentence_right": "| 182].61.164.201 | 182].61.182.97 |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| 北京新锐视锋科技有限公司 |", "context_left": "| 上海域联软件技术有限公司 |", "context_right": "The second driver is part of the framework of the company “Callback Technologies” which offers an API for applications to control access to files on the disk by any program and even falsify the result.", "_context_left": "", "_context_right": "", "sentence_left": "| 上海域联软件技术有限公司 |", "sentence_right": "The second driver is part of the framework of the company “Callback Technologies” which offers an API for applications to control access to files on the disk by any program and even falsify the result.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "This is the updated list at the moment:", "context_left": "It downloads a list of signatures from it’s command and control server every few seconds and prevents any driver with one of this signatures of being loaded.", "context_right": "| Zhou Donghang |", "_context_left": "", "_context_right": "", "sentence_left": "It downloads a list of signatures from it’s command and control server every few seconds and prevents any driver with one of this signatures of being loaded.", "sentence_right": "| Zhou Donghang |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "It should be noted that these are the modules currently known, but they probably have more modules from which no information has been obtained to date as this threat has been active for over a year and has a lot of new activity.", "context_left": "The third one is in charge of downloading and installing certificates in the victim machine, so that they can also control the victim’s SSL traffic completely, redirecting it to other sites or breaking the encryption on this legitimate traffic.", "context_right": "The majority of the downloads related to this malware are done over HTTP directly against IP addresses generally located in China and using relatively high ports.", "_context_left": "", "_context_right": "", "sentence_left": "The third one is in charge of downloading and installing certificates in the victim machine, so that they can also control the victim’s SSL traffic completely, redirecting it to other sites or breaking the encryption on this legitimate traffic.", "sentence_right": "The majority of the downloads related to this malware are done over HTTP directly against IP addresses generally located in China and using relatively high ports.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| 106.]14.47.210  |", "context_left": "C2 IP List", "context_right": "| 120.]77.36.184 |", "_context_left": "", "_context_right": "", "sentence_left": "C2 IP List", "sentence_right": "| 120.]77.36.184 |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "* “msdvdlx32.dat”", "context_left": "* “msdvdlx64.dat”", "context_right": "* “mshsdlx64.dat”", "_context_left": "", "_context_right": "", "sentence_left": "* “msdvdlx64.dat”", "sentence_right": "* “mshsdlx64.dat”", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| 182].61.180.119 | 182].61.188.252 |", "context_left": "| 182].61.177.37 | 182].61.183.215 |", "context_right": "| 182].61.180.134 | 192].126.127.199 |", "_context_left": "", "_context_right": "", "sentence_left": "| 182].61.177.37 | 182].61.183.215 |", "sentence_right": "| 182].61.180.134 | 192].126.127.199 |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| 上海域联软件技术有限公司 |", "context_left": "| 姚秋玲 |", "context_right": "| 北京新锐视锋科技有限公司 |", "_context_left": "", "_context_right": "", "sentence_left": "| 姚秋玲 |", "sentence_right": "| 北京新锐视锋科技有限公司 |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "| 梁富庆上海天游软件有限公司 |", "context_left": "| 金华米粒网络技术服务有限公司 |", "context_right": "| 姚秋玲 |", "_context_left": "", "_context_right": "", "sentence_left": "| 金华米粒网络技术服务有限公司 |", "sentence_right": "| 姚秋玲 |", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}
{"mention": "Some of the names of the threats at the time of download are as follows:", "context_left": "The majority of the downloads related to this malware are done over HTTP directly against IP addresses generally located in China and using relatively high ports.", "context_right": "* “msdvdlx64.dat”", "_context_left": "", "_context_right": "", "sentence_left": "The majority of the downloads related to this malware are done over HTTP directly against IP addresses generally located in China and using relatively high ports.", "sentence_right": "* “msdvdlx64.dat”", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}