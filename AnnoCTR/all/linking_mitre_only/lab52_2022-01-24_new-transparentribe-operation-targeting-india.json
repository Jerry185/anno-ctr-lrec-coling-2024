{"mention": "Transparent Tribe", "context_left": "Furthermore, some of the artifacts and infrastructure used to carry out the novel infection campaign are strongly related to the threat group", "context_right": ".", "_context_left": "Furthermore, some of the artifacts and infrastructure used to carry out the novel infection campaign are strongly related to the threat group ", "_context_right": ".", "sentence_left": "In fact, targeting the Indian government seems to be one of the key indicators of the group that may be behind this attack.", "sentence_right": "Initially, Lab52 detected a suspicious IMG file (Covid\\_Letter.img – 948dffef9a11c11a6d81905e59ca1882) that was uploaded in VirusTotal via the web site from India, with upload date 09-06-2021.", "label": "[Transparent Tribe](https://attack.mitre.org/groups/G0134) is a suspected Pakistan-based threat group that has been active since at least 2013, primarily targeting diplomatic, defense, and research organizations in India and Afghanistan.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Talos Transparent Tribe May 2021)", "label_id": 1182, "label_title": "Transparent Tribe", "label_link": "https://attack.mitre.org/groups/G0134", "entity_class": "CE", "entity_type": "GROUP", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "sent attached to an email and contains a PDF document and some artifacts in order to display a decoy PDF to the user and initiate the infection process in the background.", "context_left": "This file may have been", "context_right": "", "_context_left": "This file may have been ", "_context_right": "", "sentence_left": "Initially, Lab52 detected a suspicious IMG file (Covid\\_Letter.img – 948dffef9a11c11a6d81905e59ca1882) that was uploaded in VirusTotal via the web site from India, with upload date 09-06-2021.", "sentence_right": "The PDF is named Vaccination06042021.pdf and its contents are related to COVID vaccination for employees over 45 years of age at the Central Administration of the Government of India.", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "The PDF is named Vaccination06042021.pdf and its contents are related to COVID vaccination for employees over 45 years of age at the Central Administration of the", "context_left": "", "context_right": "Government of India.", "_context_left": "", "_context_right": " Government of India.", "sentence_left": "This file may have been sent attached to an email and contains a PDF document and some artifacts in order to display a decoy PDF to the user and initiate the infection process in the background.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/1-2-810x1024.png)", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "the IMG file contains some other artifacts that will carry out the infection.", "context_left": "Although this decoy PDF document is harmless,", "context_right": "", "_context_left": "Although this decoy PDF document is harmless, ", "_context_right": "", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/1-2-810x1024.png)", "sentence_right": "Firstly, the IMG file contains a shortcut with the same name as the PDF document, which will be in charge of starting the infection by launching a Visual Basic script called doc.vbs.", "label": "An adversary may rely upon specific actions by a user in order to gain execution. Users may be subjected to social engineering to get them to execute malicious code by, for example, opening a malicious document file or link. These user actions will typically be observed as follow-on behavior from forms of [Phishing](https://attack.mitre.org/techniques/T1566). While [User Execution](https://attack.mitre.org/techniques/T1204) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).", "label_id": 260, "label_title": "User Execution", "label_link": "https://attack.mitre.org/techniques/T1204", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Firstly, the IMG file contains a shortcut with the same name as the PDF document, which will be in charge of starting the infection by launching a Visual Basic script called doc.vbs.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "Although this decoy PDF document is harmless, the IMG file contains some other artifacts that will carry out the infection.", "sentence_right": "The infection chain continues executing both the decoy PDF document and a Windows PE (ServiceHub.MsDetouredHost.exe – 68d73d596a7103e517967f7f4e22cecb) which after being analyzed, we have been able to identify it as a Python/PeppyRAT.", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Python/PeppyRAT", "context_left": "The infection chain continues executing both the decoy PDF document and a Windows PE (ServiceHub.MsDetouredHost.exe – 68d73d596a7103e517967f7f4e22cecb) which after being analyzed, we have been able to identify it as a", "context_right": ".", "_context_left": "The infection chain continues executing both the decoy PDF document and a Windows PE (ServiceHub.MsDetouredHost.exe – 68d73d596a7103e517967f7f4e22cecb) which after being analyzed, we have been able to identify it as a ", "_context_right": ".", "sentence_left": "Firstly, the IMG file contains a shortcut with the same name as the PDF document, which will be in charge of starting the infection by launching a Visual Basic script called doc.vbs.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/2v2-2-1024x843.jpg)", "label": "[Peppy](https://attack.mitre.org/software/S0643) is a Python-based remote access Trojan, active since at least 2012, with similarities to [Crimson](https://attack.mitre.org/software/S0115).(Citation: Proofpoint Operation Transparent Tribe March 2016)", "label_id": 770, "label_title": "Peppy", "label_link": "https://attack.mitre.org/software/S0643", "entity_class": "CE", "entity_type": "MALWARE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Windows PE", "context_left": "The infection chain continues executing both the decoy PDF document and a", "context_right": "(ServiceHub.MsDetouredHost.exe – 68d73d596a7103e517967f7f4e22cecb) which after being analyzed, we have been able to identify it as a Python/PeppyRAT.", "_context_left": "The infection chain continues executing both the decoy PDF document and a ", "_context_right": " (ServiceHub.MsDetouredHost.exe – 68d73d596a7103e517967f7f4e22cecb) which after being analyzed, we have been able to identify it as a Python/PeppyRAT.", "sentence_left": "Firstly, the IMG file contains a shortcut with the same name as the PDF document, which will be in charge of starting the infection by launching a Visual Basic script called doc.vbs.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/2v2-2-1024x843.jpg)", "label": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "label_id": 318, "label_title": "Process Injection", "label_link": "https://attack.mitre.org/techniques/T1055", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "embedded Python commands from itself", "context_left": "The main feature of this Windows executable is the ability to run", "context_right": ".", "_context_left": "The main feature of this Windows executable is the ability to run ", "_context_right": ".", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/2v2-2-1024x843.jpg)", "sentence_right": "For this, the threat firstly relaunches itself and then starts building a new IAT (*Import Address Table*) referencing a large number of Python functions contained in the Python27.dll library that will be executed later.", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Python functions contained in the Python27.dll library that will be executed later", "context_left": "For this, the threat firstly relaunches itself and then starts building a new IAT (*Import Address Table*) referencing a large number of", "context_right": ".", "_context_left": "For this, the threat firstly relaunches itself and then starts building a new IAT (*Import Address Table*) referencing a large number of ", "_context_right": ".", "sentence_left": "The main feature of this Windows executable is the ability to run embedded Python commands from itself.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/3-2-1024x413.png)", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "dropping all python compiled objects", "context_left": "The crux of the matter is that by", "context_right": "and dynamic-link libraries required into %TEMP% directory, it makes this python command execution technique possible through a Windows PE file.", "_context_left": "The crux of the matter is that by ", "_context_right": " and dynamic-link libraries required into %TEMP% directory, it makes this python command execution technique possible through a Windows PE file.", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/4-1-1024x604.png)", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/5-2.png)", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "execution technique possible through a Windows PE file.", "context_left": "The crux of the matter is that by dropping all python compiled objects and dynamic-link libraries required into %TEMP% directory, it makes this python command", "context_right": "", "_context_left": "The crux of the matter is that by dropping all python compiled objects and dynamic-link libraries required into %TEMP% directory, it makes this python command ", "_context_right": "", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/4-1-1024x604.png)", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/5-2.png)", "label": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "label_id": 318, "label_title": "Process Injection", "label_link": "https://attack.mitre.org/techniques/T1055", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "python command execution though a", "context_left": "An example of", "context_right": "Windows PE can be seen below:", "_context_left": "An example of ", "_context_right": " Windows PE can be seen below:", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/5-2.png)", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/6-2.png)", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Windows PE", "context_left": "An example of python command execution though a", "context_right": "can be seen below:", "_context_left": "An example of python command execution though a ", "_context_right": " can be seen below:", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/5-2.png)", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/6-2.png)", "label": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "label_id": 318, "label_title": "Process Injection", "label_link": "https://attack.mitre.org/techniques/T1055", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "loads into memory a Python script", "context_left": "Once the threat gets its environment all set, it builds and", "context_right": "that will be in charge of obtaining the list of running processes and notifying the command-and-control server through an HTTP POST request.", "_context_left": "Once the threat gets its environment all set, it builds and ", "_context_right": " that will be in charge of obtaining the list of running processes and notifying the command-and-control server through an HTTP POST request.", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/6-2.png)", "sentence_right": "Next, in the following code block it is shown the script load by iterations:", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "notifying the command-and-control server through an HTTP POST request.", "context_left": "Once the threat gets its environment all set, it builds and loads into memory a Python script that will be in charge of obtaining the list of running processes and", "context_right": "", "_context_left": "Once the threat gets its environment all set, it builds and loads into memory a Python script that will be in charge of obtaining the list of running processes and ", "_context_right": "", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/6-2.png)", "sentence_right": "Next, in the following code block it is shown the script load by iterations:", "label": "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Adversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP.", "label_id": 452, "label_title": "Application Layer Protocol", "label_link": "https://attack.mitre.org/techniques/T1071", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "python script", "context_left": "As a result, we have a", "context_right": "composed by seven functions plus its main function.", "_context_left": "As a result, we have a ", "_context_right": " composed by seven functions plus its main function.", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/8-2.png)", "sentence_right": "This script will notify to the C2C the extracted computer info and also set persistence into the victim machine.", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "C2C", "context_left": "This script will notify to the", "context_right": "the extracted computer info and also set persistence into the victim machine.", "_context_left": "This script will notify to the ", "_context_right": " the extracted computer info and also set persistence into the victim machine.", "sentence_left": "As a result, we have a python script composed by seven functions plus its main function.", "sentence_right": "Most important python functions are the following:", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "set persistence into the victim machine.", "context_left": "This script will notify to the C2C the extracted computer info and also", "context_right": "", "_context_left": "This script will notify to the C2C the extracted computer info and also ", "_context_right": "", "sentence_left": "As a result, we have a python script composed by seven functions plus its main function.", "sentence_right": "Most important python functions are the following:", "label": "The adversary is trying to maintain their foothold. Persistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code.", "label_id": 579, "label_title": "Persistence", "label_link": "https://attack.mitre.org/tactics/TA0003", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "notify to the C2C", "context_left": "This script will", "context_right": "the extracted computer info and also set persistence into the victim machine.", "_context_left": "This script will ", "_context_right": " the extracted computer info and also set persistence into the victim machine.", "sentence_left": "As a result, we have a python script composed by seven functions plus its main function.", "sentence_right": "Most important python functions are the following:", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CI", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "extracted computer info", "context_left": "This script will notify to the C2C the", "context_right": "and also set persistence into the victim machine.", "_context_left": "This script will notify to the C2C the ", "_context_right": " and also set persistence into the victim machine.", "sentence_left": "As a result, we have a python script composed by seven functions plus its main function.", "sentence_right": "Most important python functions are the following:", "label": "Adversaries may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration. Adversaries may do this using a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), such as [cmd](https://attack.mitre.org/software/S0106), which has functionality to interact with the file system to gather information. Some adversaries may also use [Automated Collection](https://attack.mitre.org/techniques/T1119) on the local system.", "label_id": 326, "label_title": "Data from Local System", "label_link": "https://attack.mitre.org/techniques/T1005", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "python functions", "context_left": "Most important", "context_right": "are the following:", "_context_left": "Most important ", "_context_right": " are the following:", "sentence_left": "This script will notify to the C2C the extracted computer info and also set persistence into the victim machine.", "sentence_right": "**Function 1 – Name:***setdelimeters*", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Collect computer data: Get list of running processes", "context_left": "**Description:**", "context_right": "", "_context_left": "**Description:** ", "_context_right": "", "sentence_left": "**Function 1 – Name:***setdelimeters*", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/9-1.png)", "label": "Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. In Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via /proc.", "label_id": 20, "label_title": "Process Discovery", "label_link": "https://attack.mitre.org/techniques/T1057", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Collect computer data: Get OS version and machine name", "context_left": "**Description:**", "context_right": "", "_context_left": "**Description:** ", "_context_right": "", "sentence_left": "**Function 2 – Name:** *getallusready*", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/10-2.png)", "label": "Adversaries may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration. Adversaries may do this using a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), such as [cmd](https://attack.mitre.org/software/S0106), which has functionality to interact with the file system to gather information. Some adversaries may also use [Automated Collection](https://attack.mitre.org/techniques/T1119) on the local system.", "label_id": 326, "label_title": "Data from Local System", "label_link": "https://attack.mitre.org/techniques/T1005", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Set persistence mechanism through Windows startup folders", "context_left": "**Description:**", "context_right": "in the current user context", "_context_left": "**Description:** ", "_context_right": " in the current user context", "sentence_left": "**Function 3 – Name:** *simplify*", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/11-2.png)", "label": "Adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems. Operating systems may have mechanisms for automatically running a program on system boot or account logon.(Citation: Microsoft Run Key)(Citation: MSDN Authentication Packages)(Citation: Microsoft TimeProvider)(Citation: Cylance Reg Persistence Sept 2013)(Citation: Linux Kernel Programming) These mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information, such as the Windows Registry. An adversary may achieve the same goal by modifying or extending features of the kernel. Since some boot or logon autostart programs run with higher privileges, an adversary may leverage these to elevate privileges.", "label_id": 330, "label_title": "Boot or Logon Autostart Execution", "label_link": "https://attack.mitre.org/techniques/T1547", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Send collected information to the command-and-control server", "context_left": "**Description:**", "context_right": "", "_context_left": "**Description:** ", "_context_right": "", "sentence_left": "**Function 4 – Name:** *synchronize*", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/12-2.png)", "label": "Adversaries may steal data by exfiltrating it over an existing command and control channel. Stolen data is encoded into the normal communications channel using the same protocol as command and control communications.", "label_id": 195, "label_title": "Exfiltration Over C2 Channel", "label_link": "https://attack.mitre.org/techniques/T1041", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "threat sends the list of running processes obtained, the OS version and the username through an HTTP request.", "context_left": "As for network communications, as seen in the synchronize python function, the", "context_right": "", "_context_left": "As for network communications, as seen in the synchronize python function, the ", "_context_right": "", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/12-2.png)", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/13-2-1024x211.png)", "label": "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Adversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP.", "label_id": 452, "label_title": "Application Layer Protocol", "label_link": "https://attack.mitre.org/techniques/T1071", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "C2C", "context_left": "This domain, where the", "context_right": "is hosted, resolves to an IP address that belongs to Digital Ocean VPS service.", "_context_left": "This domain, where the ", "_context_right": " is hosted, resolves to an IP address that belongs to Digital Ocean VPS service.", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/13-2-1024x211.png)", "sentence_right": "So, the threat actors make use of this infrastructure to take control of compromised computers and carry out actions from their C2C.", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "C2C", "context_left": "So, the threat actors make use of this infrastructure to take control of compromised computers and carry out actions from their", "context_right": ".", "_context_left": "So, the threat actors make use of this infrastructure to take control of compromised computers and carry out actions from their ", "_context_right": ".", "sentence_left": "This domain, where the C2C is hosted, resolves to an IP address that belongs to Digital Ocean VPS service.", "sentence_right": "Resolution history:", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "persistence mechanism", "context_left": "Finally, as a", "context_right": ", *simplify* function drops a new Windows PE file into the current user startup folder: (%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).", "_context_left": "Finally, as a ", "_context_right": ", *simplify* function drops a new Windows PE file into the current user startup folder: (%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/14-2.png)", "sentence_right": "This later artifact has been developed in .NET framework and its purpose is very simple: waiting to receive a new infection module from the C2C, which is a DLL file named mscontainer.dll:", "label": "The adversary is trying to maintain their foothold. Persistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code.", "label_id": 579, "label_title": "Persistence", "label_link": "https://attack.mitre.org/tactics/TA0003", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Windows PE", "context_left": "Finally, as a persistence mechanism, *simplify* function drops a new", "context_right": "file into the current user startup folder: (%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).", "_context_left": "Finally, as a persistence mechanism, *simplify* function drops a new ", "_context_right": " file into the current user startup folder: (%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/14-2.png)", "sentence_right": "This later artifact has been developed in .NET framework and its purpose is very simple: waiting to receive a new infection module from the C2C, which is a DLL file named mscontainer.dll:", "label": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "label_id": 318, "label_title": "Process Injection", "label_link": "https://attack.mitre.org/techniques/T1055", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "into the current user startup folder", "context_left": "Finally, as a persistence mechanism, *simplify* function drops a new Windows PE file", "context_right": ": (%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).", "_context_left": "Finally, as a persistence mechanism, *simplify* function drops a new Windows PE file ", "_context_right": ": (%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/14-2.png)", "sentence_right": "This later artifact has been developed in .NET framework and its purpose is very simple: waiting to receive a new infection module from the C2C, which is a DLL file named mscontainer.dll:", "label": "Adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems. Operating systems may have mechanisms for automatically running a program on system boot or account logon.(Citation: Microsoft Run Key)(Citation: MSDN Authentication Packages)(Citation: Microsoft TimeProvider)(Citation: Cylance Reg Persistence Sept 2013)(Citation: Linux Kernel Programming) These mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information, such as the Windows Registry. An adversary may achieve the same goal by modifying or extending features of the kernel. Since some boot or logon autostart programs run with higher privileges, an adversary may leverage these to elevate privileges.", "label_id": 330, "label_title": "Boot or Logon Autostart Execution", "label_link": "https://attack.mitre.org/techniques/T1547", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "(%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).", "context_left": "Finally, as a persistence mechanism, *simplify* function drops a new Windows PE file into the current user startup folder:", "context_right": "", "_context_left": "Finally, as a persistence mechanism, *simplify* function drops a new Windows PE file into the current user startup folder: ", "_context_right": "", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/14-2.png)", "sentence_right": "This later artifact has been developed in .NET framework and its purpose is very simple: waiting to receive a new infection module from the C2C, which is a DLL file named mscontainer.dll:", "label": "Adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems. Operating systems may have mechanisms for automatically running a program on system boot or account logon.(Citation: Microsoft Run Key)(Citation: MSDN Authentication Packages)(Citation: Microsoft TimeProvider)(Citation: Cylance Reg Persistence Sept 2013)(Citation: Linux Kernel Programming) These mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information, such as the Windows Registry. An adversary may achieve the same goal by modifying or extending features of the kernel. Since some boot or logon autostart programs run with higher privileges, an adversary may leverage these to elevate privileges.", "label_id": 330, "label_title": "Boot or Logon Autostart Execution", "label_link": "https://attack.mitre.org/techniques/T1547", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "C2C", "context_left": "This later artifact has been developed in .NET framework and its purpose is very simple: waiting to receive a new infection module from the", "context_right": ", which is a DLL file named mscontainer.dll:", "_context_left": "This later artifact has been developed in .NET framework and its purpose is very simple: waiting to receive a new infection module from the ", "_context_right": ", which is a DLL file named mscontainer.dll:", "sentence_left": "Finally, as a persistence mechanism, *simplify* function drops a new Windows PE file into the current user startup folder: (%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/15-2.png)", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "waiting to receive a new infection module from the C2C", "context_left": "This later artifact has been developed in .NET framework and its purpose is very simple:", "context_right": ", which is a DLL file named mscontainer.dll:", "_context_left": "This later artifact has been developed in .NET framework and its purpose is very simple: ", "_context_right": ", which is a DLL file named mscontainer.dll:", "sentence_left": "Finally, as a persistence mechanism, *simplify* function drops a new Windows PE file into the current user startup folder: (%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/15-2.png)", "label": "Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.", "label_id": 202, "label_title": "Ingress Tool Transfer", "label_link": "https://attack.mitre.org/techniques/T1105", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "initial access", "context_left": "So far, we analyzed a threat whose main capabilities are for", "context_right": "and recognition of the compromised computer as a common operational characteristic of the threat group, in order to detect if the malware was executed in a sandbox or others analysis environments.", "_context_left": "So far, we analyzed a threat whose main capabilities are for ", "_context_right": " and recognition of the compromised computer as a common operational characteristic of the threat group, in order to detect if the malware was executed in a sandbox or others analysis environments.", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/15-2.png)", "sentence_right": "Therefore, we could consider it as the first stage and wait for new artifacts from the command-and-control server.", "label": "The adversary is trying to get into your network. Initial Access consists of techniques that use various entry vectors to gain their initial foothold within a network. Techniques used to gain a foothold include targeted spearphishing and exploiting weaknesses on public-facing web servers. Footholds gained through initial access may allow for continued access, like valid accounts and use of external remote services, or may be limited-use due to changing passwords.", "label_id": 584, "label_title": "Initial Access", "label_link": "https://attack.mitre.org/tactics/TA0001", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "detect if the malware was executed in a sandbox or others analysis environments.", "context_left": "So far, we analyzed a threat whose main capabilities are for initial access and recognition of the compromised computer as a common operational characteristic of the threat group, in order to", "context_right": "", "_context_left": "So far, we analyzed a threat whose main capabilities are for initial access and recognition of the compromised computer as a common operational characteristic of the threat group, in order to ", "_context_right": "", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/15-2.png)", "sentence_right": "Therefore, we could consider it as the first stage and wait for new artifacts from the command-and-control server.", "label": "Adversaries may employ various means to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness) Adversaries may use several methods to accomplish [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) such as checking for security monitoring tools (e.g., Sysinternals, Wireshark, etc.) or other system artifacts associated with analysis or virtualization. Adversaries may also check for legitimate user activity to help determine if it is in an analysis environment. Additional methods include use of sleep timers or loops within malware code to avoid operating within a temporary sandbox.(Citation: Unit 42 Pirpi July 2015)", "label_id": 291, "label_title": "Virtualization/Sandbox Evasion", "label_link": "https://attack.mitre.org/techniques/T1497", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "new artifacts from the command-and-control server.", "context_left": "Therefore, we could consider it as the first stage and wait for", "context_right": "", "_context_left": "Therefore, we could consider it as the first stage and wait for ", "_context_right": "", "sentence_left": "So far, we analyzed a threat whose main capabilities are for initial access and recognition of the compromised computer as a common operational characteristic of the threat group, in order to detect if the malware was executed in a sandbox or others analysis environments.", "sentence_right": "The Windows DLL *mscontainer.dll* sent afterwards by the C2C seems to be the next stage of infection.", "label": "Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.", "label_id": 202, "label_title": "Ingress Tool Transfer", "label_link": "https://attack.mitre.org/techniques/T1105", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "C2C", "context_left": "The Windows DLL *mscontainer.dll* sent afterwards by the", "context_right": "seems to be the next stage of infection.", "_context_left": "The Windows DLL *mscontainer.dll* sent afterwards by the ", "_context_right": " seems to be the next stage of infection.", "sentence_left": "Therefore, we could consider it as the first stage and wait for new artifacts from the command-and-control server.", "sentence_right": "Remember that this artifact is expected by the last analyzed PE devenv.defender.scr which persists on the Windows startup folders.", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Windows DLL *mscontainer.dll* sent afterwards by the C2C seems to be the next stage of infection.", "context_left": "The", "context_right": "", "_context_left": "The ", "_context_right": "", "sentence_left": "Therefore, we could consider it as the first stage and wait for new artifacts from the command-and-control server.", "sentence_right": "Remember that this artifact is expected by the last analyzed PE devenv.defender.scr which persists on the Windows startup folders.", "label": "Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.", "label_id": 202, "label_title": "Ingress Tool Transfer", "label_link": "https://attack.mitre.org/techniques/T1105", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "persists on the Windows startup folders.", "context_left": "Remember that this artifact is expected by the last analyzed PE devenv.defender.scr which", "context_right": "", "_context_left": "Remember that this artifact is expected by the last analyzed PE devenv.defender.scr which ", "_context_right": "", "sentence_left": "The Windows DLL *mscontainer.dll* sent afterwards by the C2C seems to be the next stage of infection.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/16-2.png)", "label": "Adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems. Operating systems may have mechanisms for automatically running a program on system boot or account logon.(Citation: Microsoft Run Key)(Citation: MSDN Authentication Packages)(Citation: Microsoft TimeProvider)(Citation: Cylance Reg Persistence Sept 2013)(Citation: Linux Kernel Programming) These mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information, such as the Windows Registry. An adversary may achieve the same goal by modifying or extending features of the kernel. Since some boot or logon autostart programs run with higher privileges, an adversary may leverage these to elevate privileges.", "label_id": 330, "label_title": "Boot or Logon Autostart Execution", "label_link": "https://attack.mitre.org/techniques/T1547", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "C2C", "context_left": "The threat-analysis has allowed us to obtain 37 decrypted strings, the commands accepted by the", "context_right": "and its hosted domain and others related to their capabilities, etc.", "_context_left": "The threat-analysis has allowed us to obtain 37 decrypted strings, the commands accepted by the ", "_context_right": " and its hosted domain and others related to their capabilities, etc.", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/17-3-1024x336.png)", "sentence_right": "The most outstanding ones being considered:", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "C2C", "context_left": "For the time being, no new infection scenarios and/or modules implemented by the", "context_right": "server have been obtained.", "_context_left": "For the time being, no new infection scenarios and/or modules implemented by the ", "_context_right": " server have been obtained.", "sentence_left": "* done", "sentence_right": "However, variations in the names of the artifacts that keeps the same infection chain have been detected.", "label": "The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "label_id": 581, "label_title": "Command and Control", "label_link": "https://attack.mitre.org/tactics/TA0011", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Transparent Tribe", "context_left": "On the whole, this infection campaign seems to be related to the threat group", "context_right": ", trying to compromise Indian government once again.", "_context_left": "On the whole, this infection campaign seems to be related to the threat group ", "_context_right": ", trying to compromise Indian government once again.", "sentence_left": "However, variations in the names of the artifacts that keeps the same infection chain have been detected.", "sentence_right": "This assumption is based on the fact that the PDF content targeted to the government of India and the TTPs employed during the infection process are common on this group.", "label": "[Transparent Tribe](https://attack.mitre.org/groups/G0134) is a suspected Pakistan-based threat group that has been active since at least 2013, primarily targeting diplomatic, defense, and research organizations in India and Afghanistan.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Talos Transparent Tribe May 2021)", "label_id": 1182, "label_title": "Transparent Tribe", "label_link": "https://attack.mitre.org/groups/G0134", "entity_class": "CE", "entity_type": "GROUP", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "the PDF content targeted to", "context_left": "This assumption is based on the fact that", "context_right": "the government of India and the TTPs employed during the infection process are common on this group.", "_context_left": "This assumption is based on the fact that ", "_context_right": " the government of India and the TTPs employed during the infection process are common on this group.", "sentence_left": "On the whole, this infection campaign seems to be related to the threat group Transparent Tribe, trying to compromise Indian government once again.", "sentence_right": "Even though this threat group usually deploys CrimsonRAT as an initial access threat, this time they have deployed PeppyRAT.", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "CrimsonRAT", "context_left": "Even though this threat group usually deploys", "context_right": "as an initial access threat, this time they have deployed PeppyRAT.", "_context_left": "Even though this threat group usually deploys ", "_context_right": " as an initial access threat, this time they have deployed PeppyRAT.", "sentence_left": "This assumption is based on the fact that the PDF content targeted to the government of India and the TTPs employed during the infection process are common on this group.", "sentence_right": "So, it could be considered a variation of the TTPs related to the APT group Transparent Tribe.", "label": "[Crimson](https://attack.mitre.org/software/S0115) is a remote access Trojan that has been used by [Transparent Tribe](https://attack.mitre.org/groups/G0134) since at least 2016.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)", "label_id": 1036, "label_title": "Crimson", "label_link": "https://attack.mitre.org/software/S0115", "entity_class": "CE", "entity_type": "MALWARE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "initial access", "context_left": "Even though this threat group usually deploys CrimsonRAT as an", "context_right": "threat, this time they have deployed PeppyRAT.", "_context_left": "Even though this threat group usually deploys CrimsonRAT as an ", "_context_right": " threat, this time they have deployed PeppyRAT.", "sentence_left": "This assumption is based on the fact that the PDF content targeted to the government of India and the TTPs employed during the infection process are common on this group.", "sentence_right": "So, it could be considered a variation of the TTPs related to the APT group Transparent Tribe.", "label": "The adversary is trying to get into your network. Initial Access consists of techniques that use various entry vectors to gain their initial foothold within a network. Techniques used to gain a foothold include targeted spearphishing and exploiting weaknesses on public-facing web servers. Footholds gained through initial access may allow for continued access, like valid accounts and use of external remote services, or may be limited-use due to changing passwords.", "label_id": 584, "label_title": "Initial Access", "label_link": "https://attack.mitre.org/tactics/TA0001", "entity_class": "CE", "entity_type": "TACTIC", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "PeppyRAT", "context_left": "Even though this threat group usually deploys CrimsonRAT as an initial access threat, this time they have deployed", "context_right": ".", "_context_left": "Even though this threat group usually deploys CrimsonRAT as an initial access threat, this time they have deployed ", "_context_right": ".", "sentence_left": "This assumption is based on the fact that the PDF content targeted to the government of India and the TTPs employed during the infection process are common on this group.", "sentence_right": "So, it could be considered a variation of the TTPs related to the APT group Transparent Tribe.", "label": "[Peppy](https://attack.mitre.org/software/S0643) is a Python-based remote access Trojan, active since at least 2012, with similarities to [Crimson](https://attack.mitre.org/software/S0115).(Citation: Proofpoint Operation Transparent Tribe March 2016)", "label_id": 770, "label_title": "Peppy", "label_link": "https://attack.mitre.org/software/S0643", "entity_class": "CE", "entity_type": "MALWARE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "Transparent Tribe", "context_left": "So, it could be considered a variation of the TTPs related to the APT group", "context_right": ".", "_context_left": "So, it could be considered a variation of the TTPs related to the APT group ", "_context_right": ".", "sentence_left": "Even though this threat group usually deploys CrimsonRAT as an initial access threat, this time they have deployed PeppyRAT.", "sentence_right": "Furthermore, no similarities have been found to any know malware in the mscontainer.dll artifact.", "label": "[Transparent Tribe](https://attack.mitre.org/groups/G0134) is a suspected Pakistan-based threat group that has been active since at least 2013, primarily targeting diplomatic, defense, and research organizations in India and Afghanistan.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Talos Transparent Tribe May 2021)", "label_id": 1182, "label_title": "Transparent Tribe", "label_link": "https://attack.mitre.org/groups/G0134", "entity_class": "CE", "entity_type": "GROUP", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "T1547.001 | Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder", "context_left": "|", "context_right": "|", "_context_left": "| ", "_context_right": " |", "sentence_left": "| **TECHNIQUE ID** | **Name** |", "sentence_right": "| T1566.001 | Phishing: Spearphishing Attachment |", "label": "Adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems. Operating systems may have mechanisms for automatically running a program on system boot or account logon.(Citation: Microsoft Run Key)(Citation: MSDN Authentication Packages)(Citation: Microsoft TimeProvider)(Citation: Cylance Reg Persistence Sept 2013)(Citation: Linux Kernel Programming) These mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information, such as the Windows Registry. An adversary may achieve the same goal by modifying or extending features of the kernel. Since some boot or logon autostart programs run with higher privileges, an adversary may leverage these to elevate privileges.", "label_id": 330, "label_title": "Boot or Logon Autostart Execution", "label_link": "https://attack.mitre.org/techniques/T1547", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "T1566.001 | Phishing: Spearphishing Attachment", "context_left": "|", "context_right": "|", "_context_left": "| ", "_context_right": " |", "sentence_left": "| T1547.001 | Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder |", "sentence_right": "| T1059.006 | Command and Scripting Interpreter: Python |", "label": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "label_id": 161, "label_title": "Phishing", "label_link": "https://attack.mitre.org/techniques/T1566", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "T1059.006 | Command and Scripting Interpreter: Python", "context_left": "|", "context_right": "|", "_context_left": "| ", "_context_right": " |", "sentence_left": "| T1566.001 | Phishing: Spearphishing Attachment |", "sentence_right": "| T1057 | Process discovery |", "label": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "label_id": 368, "label_title": "Command and Scripting Interpreter", "label_link": "https://attack.mitre.org/techniques/T1059", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "T1057 | Process discovery", "context_left": "|", "context_right": "|", "_context_left": "| ", "_context_right": " |", "sentence_left": "| T1059.006 | Command and Scripting Interpreter: Python |", "sentence_right": "| T1046 | Network Service Scanning |", "label": "Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. In Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via /proc.", "label_id": 20, "label_title": "Process Discovery", "label_link": "https://attack.mitre.org/techniques/T1057", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "T1041 | Exfiltration Over C2 Channel", "context_left": "|", "context_right": "|", "_context_left": "| ", "_context_right": " |", "sentence_left": "| T1046 | Network Service Scanning |", "sentence_right": "| T1568 | Dynamic Resolution |", "label": "Adversaries may steal data by exfiltrating it over an existing command and control channel. Stolen data is encoded into the normal communications channel using the same protocol as command and control communications.", "label_id": 195, "label_title": "Exfiltration Over C2 Channel", "label_link": "https://attack.mitre.org/techniques/T1041", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "T1568 | Dynamic Resolution", "context_left": "|", "context_right": "|", "_context_left": "| ", "_context_right": " |", "sentence_left": "| T1041 | Exfiltration Over C2 Channel |", "sentence_right": "| T1005 | Data from Local System |", "label": "Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. These calculations can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control. Adversaries may use dynamic resolution for the purpose of [Fallback Channels](https://attack.mitre.org/techniques/T1008). When contact is lost with the primary command and control server malware may employ dynamic resolution as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)", "label_id": 7, "label_title": "Dynamic Resolution", "label_link": "https://attack.mitre.org/techniques/T1568", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}
{"mention": "T1005 | Data from Local System", "context_left": "|", "context_right": "|", "_context_left": "| ", "_context_right": " |", "sentence_left": "| T1568 | Dynamic Resolution |", "sentence_right": "Customers with Lab52’s APT intelligence private feed service already have more tools and means of detection for this campaign.", "label": "Adversaries may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration. Adversaries may do this using a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), such as [cmd](https://attack.mitre.org/software/S0106), which has functionality to interact with the file system to gather information. Some adversaries may also use [Automated Collection](https://attack.mitre.org/techniques/T1119) on the local system.", "label_id": 326, "label_title": "Data from Local System", "label_link": "https://attack.mitre.org/techniques/T1005", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}