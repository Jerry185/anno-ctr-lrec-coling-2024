{"mention": "REvil", "context_left": "Changes in", "context_right": "ransomware version 2.2", "_context_left": "Changes in ", "_context_right": " ransomware version 2.2", "sentence_left": "", "sentence_right": "May 04, 2020", "label": "[REvil](https://attack.mitre.org/software/S0496) is a ransomware family that has been linked to the [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) group and operated as ransomware-as-a-service (RaaS) since at least April 2019. [REvil](https://attack.mitre.org/software/S0496) is highly configurable and shares code similarities with the GandCrab RaaS.(Citation: Secureworks REvil September 2019)(Citation: Intel 471 REvil March 2020)(Citation: Group IB Ransomware May 2020)", "label_id": 763, "label_title": "REvil", "label_link": "https://attack.mitre.org/software/S0496", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "ransomware", "context_left": "Changes in REvil", "context_right": "version 2.2", "_context_left": "Changes in REvil ", "_context_right": " version 2.2", "sentence_left": "", "sentence_right": "May 04, 2020", "label": "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018) In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted. In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) In cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1)", "label_id": 467, "label_title": "Data Encrypted for Impact", "label_link": "https://attack.mitre.org/techniques/T1486", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "REvil", "context_left": "The", "context_right": "ransomware-as-a-service (RaaS) operation continues to impact businesses worldwide.", "_context_left": "The ", "_context_right": " ransomware-as-a-service (RaaS) operation continues to impact businesses worldwide.", "sentence_left": "### Summary", "sentence_right": "The threat actors responsible for developing and maintaining the malware have released an updated ransomware, namely version 2.2.", "label": "[REvil](https://attack.mitre.org/software/S0496) is a ransomware family that has been linked to the [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) group and operated as ransomware-as-a-service (RaaS) since at least April 2019. [REvil](https://attack.mitre.org/software/S0496) is highly configurable and shares code similarities with the GandCrab RaaS.(Citation: Secureworks REvil September 2019)(Citation: Intel 471 REvil March 2020)(Citation: Group IB Ransomware May 2020)", "label_id": 763, "label_title": "REvil", "label_link": "https://attack.mitre.org/software/S0496", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "RaaS", "context_left": "The REvil ransomware-as-a-service (", "context_right": ") operation continues to impact businesses worldwide.", "_context_left": "The REvil ransomware-as-a-service (", "_context_right": ") operation continues to impact businesses worldwide.", "sentence_left": "### Summary", "sentence_right": "The threat actors responsible for developing and maintaining the malware have released an updated ransomware, namely version 2.2.", "label": "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018) In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted. In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) In cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1)", "label_id": 467, "label_title": "Data Encrypted for Impact", "label_link": "https://attack.mitre.org/techniques/T1486", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "ransomware-as-a-service", "context_left": "The REvil", "context_right": "(RaaS) operation continues to impact businesses worldwide.", "_context_left": "The REvil ", "_context_right": " (RaaS) operation continues to impact businesses worldwide.", "sentence_left": "### Summary", "sentence_right": "The threat actors responsible for developing and maintaining the malware have released an updated ransomware, namely version 2.2.", "label": "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018) In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted. In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) In cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1)", "label_id": 467, "label_title": "Data Encrypted for Impact", "label_link": "https://attack.mitre.org/techniques/T1486", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "ransomware", "context_left": "The threat actors responsible for developing and maintaining the malware have released an updated", "context_right": ", namely version 2.2.", "_context_left": "The threat actors responsible for developing and maintaining the malware have released an updated ", "_context_right": ", namely version 2.2.", "sentence_left": "The REvil ransomware-as-a-service (RaaS) operation continues to impact businesses worldwide.", "sentence_right": "In this short blog post, we will cover the significant changes from the previous version, which we covered in detail in an earlier blog post (see: https://blog.intel471.com/2020/03/31/revil-ransomware-as-a-service-an-analysis-of-a-ransomware-affiliate-operation/).", "label": "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018) In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted. In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) In cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1)", "label_id": 467, "label_title": "Data Encrypted for Impact", "label_link": "https://attack.mitre.org/techniques/T1486", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "Persistence", "context_left": "###", "context_right": "mechanism", "_context_left": "### ", "_context_right": " mechanism", "sentence_left": "In this short blog post, we will cover the significant changes from the previous version, which we covered in detail in an earlier blog post (see: https://blog.intel471.com/2020/03/31/revil-ransomware-as-a-service-an-analysis-of-a-ransomware-affiliate-operation/).", "sentence_right": "REvil ransomware persists on a machine if the **arn** configuration field is set to **true**.", "label": "The adversary is trying to maintain their foothold. Persistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code.", "label_id": 579, "label_title": "Persistence", "label_link": "https://attack.mitre.org/tactics/TA0003", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "REvil", "context_left": "", "context_right": "ransomware persists on a machine if the **arn** configuration field is set to **true**.", "_context_left": "", "_context_right": " ransomware persists on a machine if the **arn** configuration field is set to **true**.", "sentence_left": "### Persistence mechanism", "sentence_right": "It writes its path to the registry key **SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run**.", "label": "[REvil](https://attack.mitre.org/software/S0496) is a ransomware family that has been linked to the [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) group and operated as ransomware-as-a-service (RaaS) since at least April 2019. [REvil](https://attack.mitre.org/software/S0496) is highly configurable and shares code similarities with the GandCrab RaaS.(Citation: Secureworks REvil September 2019)(Citation: Intel 471 REvil March 2020)(Citation: Group IB Ransomware May 2020)", "label_id": 763, "label_title": "REvil", "label_link": "https://attack.mitre.org/software/S0496", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "ransomware", "context_left": "REvil", "context_right": "persists on a machine if the **arn** configuration field is set to **true**.", "_context_left": "REvil ", "_context_right": " persists on a machine if the **arn** configuration field is set to **true**.", "sentence_left": "### Persistence mechanism", "sentence_right": "It writes its path to the registry key **SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run**.", "label": "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018) In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted. In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) In cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1)", "label_id": 467, "label_title": "Data Encrypted for Impact", "label_link": "https://attack.mitre.org/techniques/T1486", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "writes its path to the registry key **SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run**.", "context_left": "It", "context_right": "", "_context_left": "It ", "_context_right": "", "sentence_left": "REvil ransomware persists on a machine if the **arn** configuration field is set to **true**.", "sentence_right": "An example of the value name of the registry key entry is **mjOObKp0yy**.", "label": "Adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems. Operating systems may have mechanisms for automatically running a program on system boot or account logon.(Citation: Microsoft Run Key)(Citation: MSDN Authentication Packages)(Citation: Microsoft TimeProvider)(Citation: Cylance Reg Persistence Sept 2013)(Citation: Linux Kernel Programming) These mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information, such as the Windows Registry. An adversary may achieve the same goal by modifying or extending features of the kernel. Since some boot or logon autostart programs run with higher privileges, an adversary may leverage these to elevate privileges.", "label_id": 330, "label_title": "Boot or Logon Autostart Execution", "label_link": "https://attack.mitre.org/techniques/T1547", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "An example of the value name of the registry key entry is", "context_left": "", "context_right": "**mjOObKp0yy**.", "_context_left": "", "_context_right": " **mjOObKp0yy**.", "sentence_left": "It writes its path to the registry key **SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run**.", "sentence_right": "![](https://d39ec1uo9ktrut.cloudfront.net/revil.png)", "label": "Adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems. Operating systems may have mechanisms for automatically running a program on system boot or account logon.(Citation: Microsoft Run Key)(Citation: MSDN Authentication Packages)(Citation: Microsoft TimeProvider)(Citation: Cylance Reg Persistence Sept 2013)(Citation: Linux Kernel Programming) These mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information, such as the Windows Registry. An adversary may achieve the same goal by modifying or extending features of the kernel. Since some boot or logon autostart programs run with higher privileges, an adversary may leverage these to elevate privileges.", "label_id": 330, "label_title": "Boot or Logon Autostart Execution", "label_link": "https://attack.mitre.org/techniques/T1547", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "persistence mechanism", "context_left": "In version 2.1, first collected by our systems March 15, 2020, this", "context_right": "was removed.", "_context_left": "In version 2.1, first collected by our systems March 15, 2020, this ", "_context_right": " was removed.", "sentence_left": "![](https://d39ec1uo9ktrut.cloudfront.net/revil.png)", "sentence_right": "It seems this little experiment didn’t go as planned, because the new version 2.2 brings the same persistence mechanism back.", "label": "The adversary is trying to maintain their foothold. Persistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code.", "label_id": 579, "label_title": "Persistence", "label_link": "https://attack.mitre.org/tactics/TA0003", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "persistence mechanism", "context_left": "It seems this little experiment didn’t go as planned, because the new version 2.2 brings the same", "context_right": "back.", "_context_left": "It seems this little experiment didn’t go as planned, because the new version 2.2 brings the same ", "_context_right": " back.", "sentence_left": "In version 2.1, first collected by our systems March 15, 2020, this persistence mechanism was removed.", "sentence_right": "### Restart Manager to terminate processes", "label": "The adversary is trying to maintain their foothold. Persistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code.", "label_id": 579, "label_title": "Persistence", "label_link": "https://attack.mitre.org/tactics/TA0003", "entity_class": "CE", "entity_type": "TACTIC", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "Restart Manager to terminate processes", "context_left": "###", "context_right": "", "_context_left": "### ", "_context_right": "", "sentence_left": "It seems this little experiment didn’t go as planned, because the new version 2.2 brings the same persistence mechanism back.", "sentence_right": "One of the more interesting new features of REvil version 2.2 is the use of the Windows Restart Manager to terminate processes and services that can lock files targeted for encryption.", "label": "Adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. When operating systems boot up, they can start processes that perform background system functions. On Windows and Linux, these system processes are referred to as services. (Citation: TechNet Services) On macOS, launchd processes known as [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) and [Launch Agent](https://attack.mitre.org/techniques/T1543/001) are run to finish system initialization and load user specific parameters.(Citation: AppleDocs Launch Agent Daemons) Adversaries may install new services, daemons, or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence. Similarly, adversaries may modify existing services, daemons, or agents to achieve the same effect. Services, daemons, or agents may be created with administrator privileges but executed under root/SYSTEM privileges. Adversaries may leverage this functionality to create or modify system processes in order to escalate privileges. (Citation: OSX Malware Detection).", "label_id": 484, "label_title": "Create or Modify System Process", "label_link": "https://attack.mitre.org/techniques/T1543", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "REvil", "context_left": "One of the more interesting new features of", "context_right": "version 2.2 is the use of the Windows Restart Manager to terminate processes and services that can lock files targeted for encryption.", "_context_left": "One of the more interesting new features of ", "_context_right": " version 2.2 is the use of the Windows Restart Manager to terminate processes and services that can lock files targeted for encryption.", "sentence_left": "### Restart Manager to terminate processes", "sentence_right": "If a process has an open file handle for a specific file, then writes to that file by another process (in this case, a ransomware) it will be prevented by the Windows operating system (OS).", "label": "[REvil](https://attack.mitre.org/software/S0496) is a ransomware family that has been linked to the [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) group and operated as ransomware-as-a-service (RaaS) since at least April 2019. [REvil](https://attack.mitre.org/software/S0496) is highly configurable and shares code similarities with the GandCrab RaaS.(Citation: Secureworks REvil September 2019)(Citation: Intel 471 REvil March 2020)(Citation: Group IB Ransomware May 2020)", "label_id": 763, "label_title": "REvil", "label_link": "https://attack.mitre.org/software/S0496", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "Windows Restart Manager to terminate processes and services that can lock files targeted for encryption.", "context_left": "One of the more interesting new features of REvil version 2.2 is the use of the", "context_right": "", "_context_left": "One of the more interesting new features of REvil version 2.2 is the use of the ", "_context_right": "", "sentence_left": "### Restart Manager to terminate processes", "sentence_right": "If a process has an open file handle for a specific file, then writes to that file by another process (in this case, a ransomware) it will be prevented by the Windows operating system (OS).", "label": "Adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. When operating systems boot up, they can start processes that perform background system functions. On Windows and Linux, these system processes are referred to as services. (Citation: TechNet Services) On macOS, launchd processes known as [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) and [Launch Agent](https://attack.mitre.org/techniques/T1543/001) are run to finish system initialization and load user specific parameters.(Citation: AppleDocs Launch Agent Daemons) Adversaries may install new services, daemons, or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence. Similarly, adversaries may modify existing services, daemons, or agents to achieve the same effect. Services, daemons, or agents may be created with administrator privileges but executed under root/SYSTEM privileges. Adversaries may leverage this functionality to create or modify system processes in order to escalate privileges. (Citation: OSX Malware Detection).", "label_id": 484, "label_title": "Create or Modify System Process", "label_link": "https://attack.mitre.org/techniques/T1543", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "ransomware", "context_left": "If a process has an open file handle for a specific file, then writes to that file by another process (in this case, a", "context_right": ") it will be prevented by the Windows operating system (OS).", "_context_left": "If a process has an open file handle for a specific file, then writes to that file by another process (in this case, a ", "_context_right": ") it will be prevented by the Windows operating system (OS).", "sentence_left": "One of the more interesting new features of REvil version 2.2 is the use of the Windows Restart Manager to terminate processes and services that can lock files targeted for encryption.", "sentence_right": "To circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager also used by other ransomware such as SamSam and LockerGoga (see: ).", "label": "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018) In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted. In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) In cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1)", "label_id": 467, "label_title": "Data Encrypted for Impact", "label_link": "https://attack.mitre.org/techniques/T1486", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "REvil", "context_left": "To circumvent this, the", "context_right": "developers have implemented a technique using the Windows Restart Manager also used by other ransomware such as SamSam and LockerGoga (see: ).", "_context_left": "To circumvent this, the ", "_context_right": " developers have implemented a technique using the Windows Restart Manager also used by other ransomware such as SamSam and LockerGoga (see: ).", "sentence_left": "If a process has an open file handle for a specific file, then writes to that file by another process (in this case, a ransomware) it will be prevented by the Windows operating system (OS).", "sentence_right": "REvil ransomware opens files for encryption with no sharing (dwShareMode equals 0).", "label": "[REvil](https://attack.mitre.org/software/S0496) is a ransomware family that has been linked to the [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) group and operated as ransomware-as-a-service (RaaS) since at least April 2019. [REvil](https://attack.mitre.org/software/S0496) is highly configurable and shares code similarities with the GandCrab RaaS.(Citation: Secureworks REvil September 2019)(Citation: Intel 471 REvil March 2020)(Citation: Group IB Ransomware May 2020)", "label_id": 763, "label_title": "REvil", "label_link": "https://attack.mitre.org/software/S0496", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "ransomware", "context_left": "To circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager also used by other", "context_right": "such as SamSam and LockerGoga (see: ).", "_context_left": "To circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager also used by other ", "_context_right": " such as SamSam and LockerGoga (see: ).", "sentence_left": "If a process has an open file handle for a specific file, then writes to that file by another process (in this case, a ransomware) it will be prevented by the Windows operating system (OS).", "sentence_right": "REvil ransomware opens files for encryption with no sharing (dwShareMode equals 0).", "label": "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018) In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted. In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) In cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1)", "label_id": 467, "label_title": "Data Encrypted for Impact", "label_link": "https://attack.mitre.org/techniques/T1486", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "SamSam", "context_left": "To circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager also used by other ransomware such as", "context_right": "and LockerGoga (see: ).", "_context_left": "To circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager also used by other ransomware such as ", "_context_right": " and LockerGoga (see: ).", "sentence_left": "If a process has an open file handle for a specific file, then writes to that file by another process (in this case, a ransomware) it will be prevented by the Windows operating system (OS).", "sentence_right": "REvil ransomware opens files for encryption with no sharing (dwShareMode equals 0).", "label": "[SamSam](https://attack.mitre.org/software/S0370) is ransomware that appeared in early 2016. Unlike some ransomware, its variants have required operators to manually interact with the malware to execute some of its core components.(Citation: US-CERT SamSam 2018)(Citation: Talos SamSam Jan 2018)(Citation: Sophos SamSam Apr 2018)(Citation: Symantec SamSam Oct 2018)", "label_id": 726, "label_title": "SamSam", "label_link": "https://attack.mitre.org/software/S0370", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "LockerGoga", "context_left": "To circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager also used by other ransomware such as SamSam and", "context_right": "(see: ).", "_context_left": "To circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager also used by other ransomware such as SamSam and ", "_context_right": " (see: ).", "sentence_left": "If a process has an open file handle for a specific file, then writes to that file by another process (in this case, a ransomware) it will be prevented by the Windows operating system (OS).", "sentence_right": "REvil ransomware opens files for encryption with no sharing (dwShareMode equals 0).", "label": "[LockerGoga](https://attack.mitre.org/software/S0372) is ransomware that has been tied to various attacks on European companies. It was first reported upon in January 2019.(Citation: Unit42 LockerGoga 2019)(Citation: CarbonBlack LockerGoga 2019)", "label_id": 1007, "label_title": "LockerGoga", "label_link": "https://attack.mitre.org/software/S0372", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "To circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager", "context_left": "", "context_right": "also used by other ransomware such as SamSam and LockerGoga (see: ).", "_context_left": "", "_context_right": " also used by other ransomware such as SamSam and LockerGoga (see: ).", "sentence_left": "If a process has an open file handle for a specific file, then writes to that file by another process (in this case, a ransomware) it will be prevented by the Windows operating system (OS).", "sentence_right": "REvil ransomware opens files for encryption with no sharing (dwShareMode equals 0).", "label": "Adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. When operating systems boot up, they can start processes that perform background system functions. On Windows and Linux, these system processes are referred to as services. (Citation: TechNet Services) On macOS, launchd processes known as [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) and [Launch Agent](https://attack.mitre.org/techniques/T1543/001) are run to finish system initialization and load user specific parameters.(Citation: AppleDocs Launch Agent Daemons) Adversaries may install new services, daemons, or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence. Similarly, adversaries may modify existing services, daemons, or agents to achieve the same effect. Services, daemons, or agents may be created with administrator privileges but executed under root/SYSTEM privileges. Adversaries may leverage this functionality to create or modify system processes in order to escalate privileges. (Citation: OSX Malware Detection).", "label_id": 484, "label_title": "Create or Modify System Process", "label_link": "https://attack.mitre.org/techniques/T1543", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "REvil", "context_left": "", "context_right": "ransomware opens files for encryption with no sharing (dwShareMode equals 0).", "_context_left": "", "_context_right": " ransomware opens files for encryption with no sharing (dwShareMode equals 0).", "sentence_left": "To circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager also used by other ransomware such as SamSam and LockerGoga (see: ).", "sentence_right": "As a result, the Restart Manager is invoked whenever a sharing violation occurs when opening an already opened file.", "label": "[REvil](https://attack.mitre.org/software/S0496) is a ransomware family that has been linked to the [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) group and operated as ransomware-as-a-service (RaaS) since at least April 2019. [REvil](https://attack.mitre.org/software/S0496) is highly configurable and shares code similarities with the GandCrab RaaS.(Citation: Secureworks REvil September 2019)(Citation: Intel 471 REvil March 2020)(Citation: Group IB Ransomware May 2020)", "label_id": 763, "label_title": "REvil", "label_link": "https://attack.mitre.org/software/S0496", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "ransomware", "context_left": "REvil", "context_right": "opens files for encryption with no sharing (dwShareMode equals 0).", "_context_left": "REvil ", "_context_right": " opens files for encryption with no sharing (dwShareMode equals 0).", "sentence_left": "To circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager also used by other ransomware such as SamSam and LockerGoga (see: ).", "sentence_right": "As a result, the Restart Manager is invoked whenever a sharing violation occurs when opening an already opened file.", "label": "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018) In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted. In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) In cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1)", "label_id": 467, "label_title": "Data Encrypted for Impact", "label_link": "https://attack.mitre.org/techniques/T1486", "entity_class": "CE", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "REvil", "context_left": "The following explains how", "context_right": "employs this technique:", "_context_left": "The following explains how ", "_context_right": " employs this technique:", "sentence_left": "```", "sentence_right": "* Call **OpenSCManagerW** to open the “ServicesActive” database.", "label": "[REvil](https://attack.mitre.org/software/S0496) is a ransomware family that has been linked to the [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) group and operated as ransomware-as-a-service (RaaS) since at least April 2019. [REvil](https://attack.mitre.org/software/S0496) is highly configurable and shares code similarities with the GandCrab RaaS.(Citation: Secureworks REvil September 2019)(Citation: Intel 471 REvil March 2020)(Citation: Group IB Ransomware May 2020)", "label_id": 763, "label_title": "REvil", "label_link": "https://attack.mitre.org/software/S0496", "entity_class": "CE", "entity_type": "MALWARE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "If a normal process is using the file, it is terminated by a call to **TerminateProcess", "context_left": "*", "context_right": "**.", "_context_left": "* ", "_context_right": "**.", "sentence_left": "This application programming interface (API) returns an array of **RM\\\\_PROCESS\\\\_INFO** structures.", "sentence_right": "* If a service is encountered, **ControlService** is invoked with the **SERVICE\\\\_CONTROL\\\\_STOP** control code to stop the service followed by a call to **DeleteService**.", "label": "Adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. When operating systems boot up, they can start processes that perform background system functions. On Windows and Linux, these system processes are referred to as services. (Citation: TechNet Services) On macOS, launchd processes known as [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) and [Launch Agent](https://attack.mitre.org/techniques/T1543/001) are run to finish system initialization and load user specific parameters.(Citation: AppleDocs Launch Agent Daemons) Adversaries may install new services, daemons, or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence. Similarly, adversaries may modify existing services, daemons, or agents to achieve the same effect. Services, daemons, or agents may be created with administrator privileges but executed under root/SYSTEM privileges. Adversaries may leverage this functionality to create or modify system processes in order to escalate privileges. (Citation: OSX Malware Detection).", "label_id": 484, "label_title": "Create or Modify System Process", "label_link": "https://attack.mitre.org/techniques/T1543", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "control code to stop the service followed by a call to **DeleteService**", "context_left": "* If a service is encountered, **ControlService** is invoked with the **SERVICE\\\\_CONTROL\\\\_STOP**", "context_right": ".", "_context_left": "* If a service is encountered, **ControlService** is invoked with the **SERVICE\\\\_CONTROL\\\\_STOP** ", "_context_right": ".", "sentence_left": "* If a normal process is using the file, it is terminated by a call to **TerminateProcess**.", "sentence_right": "* If a critical process is encountered, its critical status is removed by calling **ZwSetInformationProcess** with the information class **ProcessBreakOnTermination** before terminating it.", "label": "Adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. When operating systems boot up, they can start processes that perform background system functions. On Windows and Linux, these system processes are referred to as services. (Citation: TechNet Services) On macOS, launchd processes known as [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) and [Launch Agent](https://attack.mitre.org/techniques/T1543/001) are run to finish system initialization and load user specific parameters.(Citation: AppleDocs Launch Agent Daemons) Adversaries may install new services, daemons, or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence. Similarly, adversaries may modify existing services, daemons, or agents to achieve the same effect. Services, daemons, or agents may be created with administrator privileges but executed under root/SYSTEM privileges. Adversaries may leverage this functionality to create or modify system processes in order to escalate privileges. (Citation: OSX Malware Detection).", "label_id": 484, "label_title": "Create or Modify System Process", "label_link": "https://attack.mitre.org/techniques/T1543", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "If a critical process is encountered, its critical status is removed by calling **ZwSetInformationProcess** with the information class **ProcessBreakOnTermination** before terminating it", "context_left": "*", "context_right": ".", "_context_left": "* ", "_context_right": ".", "sentence_left": "* If a service is encountered, **ControlService** is invoked with the **SERVICE\\\\_CONTROL\\\\_STOP** control code to stop the service followed by a call to **DeleteService**.", "sentence_right": "This may lead to undefined behavior on the victim system.", "label": "Adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. When operating systems boot up, they can start processes that perform background system functions. On Windows and Linux, these system processes are referred to as services. (Citation: TechNet Services) On macOS, launchd processes known as [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) and [Launch Agent](https://attack.mitre.org/techniques/T1543/001) are run to finish system initialization and load user specific parameters.(Citation: AppleDocs Launch Agent Daemons) Adversaries may install new services, daemons, or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence. Similarly, adversaries may modify existing services, daemons, or agents to achieve the same effect. Services, daemons, or agents may be created with administrator privileges but executed under root/SYSTEM privileges. Adversaries may leverage this functionality to create or modify system processes in order to escalate privileges. (Citation: OSX Malware Detection).", "label_id": 484, "label_title": "Create or Modify System Process", "label_link": "https://attack.mitre.org/techniques/T1543", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "-silent was added that skips termination of blacklisted processes, services and shadow copy deletion.", "context_left": "A new command-line option", "context_right": "", "_context_left": "A new command-line option ", "_context_right": "", "sentence_left": "#### New ‘-silent’ flag", "sentence_right": "However, this flag does not impact the new Restart Manager functionality.", "label": "Adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. When operating systems boot up, they can start processes that perform background system functions. On Windows and Linux, these system processes are referred to as services. (Citation: TechNet Services) On macOS, launchd processes known as [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) and [Launch Agent](https://attack.mitre.org/techniques/T1543/001) are run to finish system initialization and load user specific parameters.(Citation: AppleDocs Launch Agent Daemons) Adversaries may install new services, daemons, or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence. Similarly, adversaries may modify existing services, daemons, or agents to achieve the same effect. Services, daemons, or agents may be created with administrator privileges but executed under root/SYSTEM privileges. Adversaries may leverage this functionality to create or modify system processes in order to escalate privileges. (Citation: OSX Malware Detection).", "label_id": 484, "label_title": "Create or Modify System Process", "label_link": "https://attack.mitre.org/techniques/T1543", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "The function prototype for **rvl\\\\_restart\\\\_manager** is:", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-6.png)", "sentence_right": "```", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "```", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "The function prototype for **rvl\\\\_restart\\\\_manager** is:", "sentence_right": "VOID rvl\\\\_restart\\\\_manager(LPCWSTR Filename, BOOL DoEndSession)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "* Call **OpenSCManagerW** to open the “ServicesActive” database.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "The following explains how REvil employs this technique:", "sentence_right": "* Start a new Restart Manager session by calling **RmStartSession** and save the returned handle in a global variable for future calls.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "#### New ‘-silent’ flag", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "This may lead to undefined behavior on the victim system.", "sentence_right": "A new command-line option -silent was added that skips termination of blacklisted processes, services and shadow copy deletion.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "* Start a new Restart Manager session by calling **RmStartSession** and save the returned handle in a global variable for future calls.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "* Call **OpenSCManagerW** to open the “ServicesActive” database.", "sentence_right": "* Invoke **RmRegisterResources** with the target file name to register it to the Restart Manager session.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-6.png)", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "As a result, the Restart Manager is invoked whenever a sharing violation occurs when opening an already opened file.", "sentence_right": "The function prototype for **rvl\\\\_restart\\\\_manager** is:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "### Summary", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "By the Intel 471 Malware Intelligence team.", "sentence_right": "The REvil ransomware-as-a-service (RaaS) operation continues to impact businesses worldwide.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "May 04, 2020", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "Changes in REvil ransomware version 2.2", "sentence_right": "By the Intel 471 Malware Intelligence team.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "In this short blog post, we will cover the significant changes from the previous version, which we covered in detail in an earlier blog post (see: https://blog.intel471.com/2020/03/31/revil-ransomware-as-a-service-an-analysis-of-a-ransomware-affiliate-operation/).", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "The threat actors responsible for developing and maintaining the malware have released an updated ransomware, namely version 2.2.", "sentence_right": "### Persistence mechanism", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "However, this flag does not impact the new Restart Manager functionality.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "A new command-line option -silent was added that skips termination of blacklisted processes, services and shadow copy deletion.", "sentence_right": "![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-7.png)### Indicators of compromise", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "```", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "VOID rvl\\\\_restart\\\\_manager(LPCWSTR Filename, BOOL DoEndSession)", "sentence_right": "The following explains how REvil employs this technique:", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "* Invoke **RmRegisterResources** with the target file name to register it to the Restart Manager session.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "* Start a new Restart Manager session by calling **RmStartSession** and save the returned handle in a global variable for future calls.", "sentence_right": "* Retrieve the list of all applications currently using the file by calling **RmGetList**.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "![](https://d39ec1uo9ktrut.cloudfront.net/revil.png)", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "An example of the value name of the registry key entry is **mjOObKp0yy**.", "sentence_right": "In version 2.1, first collected by our systems March 15, 2020, this persistence mechanism was removed.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "VOID rvl\\\\_restart\\\\_manager(LPCWSTR Filename, BOOL DoEndSession)", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "```", "sentence_right": "```", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "This may lead to undefined behavior on the victim system.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "* If a critical process is encountered, its critical status is removed by calling **ZwSetInformationProcess** with the information class **ProcessBreakOnTermination** before terminating it.", "sentence_right": "#### New ‘-silent’ flag", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "* Retrieve the list of all applications currently using the file by calling **RmGetList**.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "* Invoke **RmRegisterResources** with the target file name to register it to the Restart Manager session.", "sentence_right": "This application programming interface (API) returns an array of **RM\\\\_PROCESS\\\\_INFO** structures.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "![](https://d39ec1uo9ktrut.cloudfront.net/Screen-Shot-2020-09-03-at-11.48.30-am.png)", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-7.png)### Indicators of compromise", "sentence_right": "", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "As a result, the Restart Manager is invoked whenever a sharing violation occurs when opening an already opened file.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "REvil ransomware opens files for encryption with no sharing (dwShareMode equals 0).", "sentence_right": "![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-6.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "This application programming interface (API) returns an array of **RM\\\\_PROCESS\\\\_INFO** structures.", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "* Retrieve the list of all applications currently using the file by calling **RmGetList**.", "sentence_right": "* If a normal process is using the file, it is terminated by a call to **TerminateProcess**.", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}
{"mention": "![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-7.png)### Indicators of compromise", "context_left": "", "context_right": "", "_context_left": "", "_context_right": "", "sentence_left": "However, this flag does not impact the new Restart Manager functionality.", "sentence_right": "![](https://d39ec1uo9ktrut.cloudfront.net/Screen-Shot-2020-09-03-at-11.48.30-am.png)", "label": "No Annotation", "label_id": 1906, "label_title": "No Annotation", "label_link": "No Annotation", "entity_class": "CI", "entity_type": "TECHNIQUE", "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}