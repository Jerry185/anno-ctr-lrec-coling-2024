{"mention": "Lab52", "context_left": "January 10, 2022 During Christmas holidays,", "context_right": "has been analyzing a sample which loads an artifact that we have decided to refer to as “TokyoX” since no similarities have been found as to any known malware, which we usually detect in open sources. However, we cannot confirm so far that it is indeed a new family of malware.", "_context_left": "During Christmas holidays, ", "_context_right": " has been analyzing a sample which loads an artifact that we have decided to refer to as “TokyoX” since no similarities have been found as to any known malware, which we usually detect in open sources.", "sentence_left": "January 10, 2022", "sentence_right": "However, we cannot confirm so far that it is indeed a new family of malware.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "Russia", "context_left": "The first thing we identified was a DLL (382b3d3bb1be4f14dbc1e82a34946a52795288867ed86c6c43e4f981729be4fc) which had the following timestamps in VirusTotal at the time of the current analysis, and was uploaded from", "context_right": "via web site: Creation Time 2021-12-09 02:46:43", "_context_left": "(382b3d3bb1be4f14dbc1e82a34946a52795288867ed86c6c43e4f981729be4fc) which had the following timestamps in VirusTotal at the time of the current analysis, and was uploaded from ", "_context_right": " via web site:", "sentence_left": "The first thing we identified was a DLL", "sentence_right": "Creation Time 2021-12-09 02:46:43", "label": "Russia (), or the Russian Federation (), is a transcontinental country in Eastern Europe and North Asia. At , Russia is by a considerable margin the largest country in the world by area, covering more than one-eighth of the Earth's inhabited land area, and the ninth most populous, with about 146.79 million people , including Crimea. About 77% of the population live in the western, European part of the country. Russia's capital, Moscow, is one of the largest cities in the world and the second largest city in Europe; other major cities include Saint Petersburg, Novosibirsk, Yekaterinburg and Nizhny Novgorod. Extending across the entirety of Northern Asia and much of Eastern Europe, Russia spans eleven time zones and incorporates a wide range of environments and landforms. From northwest to southeast, Russia shares land borders with Norway, Finland, Estonia, Latvia, Lithuania and Poland (both with Kaliningrad Oblast), Belarus, Ukraine, Georgia, Azerbaijan, Kazakhstan, China, Mongolia and North Korea. It shares maritime borders with Japan by the Sea of Okhotsk and the U.S. state of Alaska across the Bering Strait. However, Russia recognises two more countries that border it, Abkhazia and South Ossetia, both of which are internationally recognized as parts of Georgia.  The East Slavs emerged as a recognizable group in Europe between the 3rd and 8th centuries AD. Founded and ruled by a Varangian warrior elite and their descendants, the medieval state of Rus arose in the 9th century. In 988 it adopted Orthodox Christianity from the Byzantine Empire, beginning the synthesis of Byzantine and Slavic", "label_id": 12594, "label_title": "Russia", "label_link": "https://en.wikipedia.org/wiki?curid=25391", "entity_class": "NE", "entity_type": "LOC", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "payload", "context_left": "Last Analysis 2021-12-23 23:38:08 Some antivirus engines tagged the sample as PlugX, but it seems that the attribution might be due to the final", "context_right": "’s loading mechanism: DLL sideloading with an encrypted payload in the same directory. After analyzing the final payload we could not find any similarities with other known samples from PlugX other than the loading TTPs.", "_context_left": "Some antivirus engines tagged the sample as PlugX, but it seems that the attribution might be due to the final ", "_context_right": "’s loading mechanism: DLL sideloading with an encrypted payload in the same directory.", "sentence_left": "Last Analysis 2021-12-23 23:38:08", "sentence_right": "After analyzing the final payload we could not find any similarities with other known samples from PlugX other than the loading TTPs.", "label": "Payload is the carrying capacity of an aircraft or launch vehicle, usually measured in terms of weight. Depending on the nature of the flight or mission, the payload of a vehicle may include cargo, passengers, flight crew, munitions, scientific instruments or experiments, or other equipment. Extra fuel, when optionally carried, is also considered part of the payload. In a commercial context (i.e., an airline or air freight carrier), payload may refer only to revenue-generating cargo or paying passengers.  For a rocket, the payload can be a satellite, space probe, or spacecraft carrying humans, animals, or cargo. For a ballistic missile, the payload is one or more warheads and related systems; the total weight of these systems is referred to as the throw-weight.  The fraction of payload to the total liftoff weight of the air or spacecraft is known as the \"payload fraction\". When the weight of the payload and fuel are considered together, it is known as the \"useful load fraction\". In spacecraft, \"mass fraction\" is normally used, which is the ratio of payload to everything else, including the rocket structure.", "label_id": 21301, "label_title": "Payload", "label_link": "https://en.wikipedia.org/wiki?curid=41495", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "payload", "context_left": "Some antivirus engines tagged the sample as PlugX, but it seems that the attribution might be due to the final payload’s loading mechanism: DLL sideloading with an encrypted payload in the same directory. After analyzing the final", "context_right": "we could not find any similarities with other known samples from PlugX other than the loading TTPs. This DLL had a related .zip file with the name планирование.zip (translated to as planning.zip).", "_context_left": "After analyzing the final ", "_context_right": " we could not find any similarities with other known samples from PlugX other than the loading TTPs.", "sentence_left": "Some antivirus engines tagged the sample as PlugX, but it seems that the attribution might be due to the final payload’s loading mechanism: DLL sideloading with an encrypted payload in the same directory.", "sentence_right": "This DLL had a related .zip file with the name планирование.zip (translated to as planning.zip).", "label": "Payload is the carrying capacity of an aircraft or launch vehicle, usually measured in terms of weight. Depending on the nature of the flight or mission, the payload of a vehicle may include cargo, passengers, flight crew, munitions, scientific instruments or experiments, or other equipment. Extra fuel, when optionally carried, is also considered part of the payload. In a commercial context (i.e., an airline or air freight carrier), payload may refer only to revenue-generating cargo or paying passengers.  For a rocket, the payload can be a satellite, space probe, or spacecraft carrying humans, animals, or cargo. For a ballistic missile, the payload is one or more warheads and related systems; the total weight of these systems is referred to as the throw-weight.  The fraction of payload to the total liftoff weight of the air or spacecraft is known as the \"payload fraction\". When the weight of the payload and fuel are considered together, it is known as the \"useful load fraction\". In spacecraft, \"mass fraction\" is normally used, which is the ratio of payload to everything else, including the rocket structure.", "label_id": 21301, "label_title": "Payload", "label_link": "https://en.wikipedia.org/wiki?curid=41495", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "When unzipping, the following files are observed: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/00.png) The legitimate file Creative.exe, an encrypted Data file and the version.dll DLL, which implements the loader function for the Data file, and therefore responsible of mapping the “TokyoX”.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/00.png)", "sentence_left": "When unzipping, the following files are observed:", "sentence_right": "The legitimate file Creative.exe, an encrypted Data file and the version.dll DLL, which implements the loader function for the Data file, and therefore responsible of mapping the “TokyoX”.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "If we execute it from a path which is not final or the expected by the malware, it replicates to another path and executes from there, which is something it does have in common with some PlugX dll loaders: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/01.png) Once executed, we observe how the netsh.exe process tries to establish connections with port 443 of the IP address 31.192.107[.]187.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/01.png)", "sentence_left": "If we execute it from a path which is not final or the expected by the malware, it replicates to another path and executes from there, which is something it does have in common with some PlugX dll loaders:", "sentence_right": "Once executed, we observe how the netsh.exe process tries to establish connections with port 443 of the IP address 31.192.107[.]187.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "payload", "context_left": "In this analysis we will focus on different aspects about the process; from double-clicking the binary 123.exe process (which is a copy of Creative.exe but in another path) to the execution of “TokyoX” already decrypted in memory. The first thing we observe within the process is how the version.dll library prepares the decryption and the final", "context_right": "’s loading in the remote process: In fact, we can see how the content of the Data file is read in the code section of version.dll:", "_context_left": "The first thing we observe within the process is how the version.dll library prepares the decryption and the final ", "_context_right": "’s loading in the remote process:", "sentence_left": "In this analysis we will focus on different aspects about the process; from double-clicking the binary 123.exe process (which is a copy of Creative.exe but in another path) to the execution of “TokyoX” already decrypted in memory.", "sentence_right": "In fact, we can see how the content of the Data file is read in the code section of version.dll:", "label": "Payload is the carrying capacity of an aircraft or launch vehicle, usually measured in terms of weight. Depending on the nature of the flight or mission, the payload of a vehicle may include cargo, passengers, flight crew, munitions, scientific instruments or experiments, or other equipment. Extra fuel, when optionally carried, is also considered part of the payload. In a commercial context (i.e., an airline or air freight carrier), payload may refer only to revenue-generating cargo or paying passengers.  For a rocket, the payload can be a satellite, space probe, or spacecraft carrying humans, animals, or cargo. For a ballistic missile, the payload is one or more warheads and related systems; the total weight of these systems is referred to as the throw-weight.  The fraction of payload to the total liftoff weight of the air or spacecraft is known as the \"payload fraction\". When the weight of the payload and fuel are considered together, it is known as the \"useful load fraction\". In spacecraft, \"mass fraction\" is normally used, which is the ratio of payload to everything else, including the rocket structure.", "label_id": 21301, "label_title": "Payload", "label_link": "https://en.wikipedia.org/wiki?curid=41495", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "In fact, we can see how the content of the Data file is read in the code section of version.dll: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/02-1024x387.png) If we edit the Data file with a hexadecimal editor we will see their values, which will help us to identify it in memory later (beginning with E3 84):", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/02-1024x387.png)", "sentence_left": "In fact, we can see how the content of the Data file is read in the code section of version.dll:", "sentence_right": "If we edit the Data file with a hexadecimal editor we will see their values, which will help us to identify it in memory later (beginning with E3 84):", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "If we edit the Data file with a hexadecimal editor we will see their values, which will help us to identify it in memory later (beginning with E3 84): ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/03.png) After reading the file from disk, a child process netsh.exe is created.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/03.png)", "sentence_left": "If we edit the Data file with a hexadecimal editor we will see their values, which will help us to identify it in memory later (beginning with E3 84):", "sentence_right": "After reading the file from disk, a child process netsh.exe is created.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "payload", "context_left": "The APIs which were observed for the creation and writing of the remote process are the native APIs NtAllocateVirtualmemory and NtwriteVirtualmemory. First, it creates two segments: 100Kb where the encrypted", "context_right": "is located and which comes from the disc, and another one of 4Kb. In the 4Kb segment we observe how the following string is set (which will be the string used for the decrypting process): ![](https://lab52.io/blog/wp-content/uploads/2022/01/04-1024x292.png)", "_context_left": "First, it creates two segments: 100Kb where the encrypted ", "_context_right": " is located and which comes from the disc, and another one of 4Kb. In the 4Kb segment we observe how the following string is set (which will be the string used for the decrypting process):", "sentence_left": "The APIs which were observed for the creation and writing of the remote process are the native APIs NtAllocateVirtualmemory and NtwriteVirtualmemory.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/04-1024x292.png)", "label": "Payload is the carrying capacity of an aircraft or launch vehicle, usually measured in terms of weight. Depending on the nature of the flight or mission, the payload of a vehicle may include cargo, passengers, flight crew, munitions, scientific instruments or experiments, or other equipment. Extra fuel, when optionally carried, is also considered part of the payload. In a commercial context (i.e., an airline or air freight carrier), payload may refer only to revenue-generating cargo or paying passengers.  For a rocket, the payload can be a satellite, space probe, or spacecraft carrying humans, animals, or cargo. For a ballistic missile, the payload is one or more warheads and related systems; the total weight of these systems is referred to as the throw-weight.  The fraction of payload to the total liftoff weight of the air or spacecraft is known as the \"payload fraction\". When the weight of the payload and fuel are considered together, it is known as the \"useful load fraction\". In spacecraft, \"mass fraction\" is normally used, which is the ratio of payload to everything else, including the rocket structure.", "label_id": 21301, "label_title": "Payload", "label_link": "https://en.wikipedia.org/wiki?curid=41495", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "First, it creates two segments: 100Kb where the encrypted payload is located and which comes from the disc, and another one of 4Kb. In the 4Kb segment we observe how the following string is set (which will be the string used for the decrypting process): ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/04-1024x292.png) The other memory segment of 100Kb contains the following (encrypted content, as we see how it matches the content from Data file on Disk):", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/04-1024x292.png)", "sentence_left": "First, it creates two segments: 100Kb where the encrypted payload is located and which comes from the disc, and another one of 4Kb. In the 4Kb segment we observe how the following string is set (which will be the string used for the decrypting process):", "sentence_right": "The other memory segment of 100Kb contains the following (encrypted content, as we see how it matches the content from Data file on Disk):", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "The other memory segment of 100Kb contains the following (encrypted content, as we see how it matches the content from Data file on Disk): ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/05-1024x784.png) After the creation of these two segments, a third segment is allocated, where it is loaded the absolute memory addresses from several win32 APIs (VirtualAlloc, LoadLibrary, GetProcAddress, the home address of the coded payload, etc.for its later use by the loader:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/05-1024x784.png)", "sentence_left": "The other memory segment of 100Kb contains the following (encrypted content, as we see how it matches the content from Data file on Disk):", "sentence_right": "After the creation of these two segments, a third segment is allocated, where it is loaded the absolute memory addresses from several win32 APIs (VirtualAlloc, LoadLibrary, GetProcAddress, the home address of the coded payload, etc.for its later use by the loader:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "payload", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/05-1024x784.png) After the creation of these two segments, a third segment is allocated, where it is loaded the absolute memory addresses from several win32 APIs (VirtualAlloc, LoadLibrary, GetProcAddress, the home address of the coded", "context_right": ", etc.for its later use by the loader: ![](https://lab52.io/blog/wp-content/uploads/2022/01/06.png)", "_context_left": "After the creation of these two segments, a third segment is allocated, where it is loaded the absolute memory addresses from several win32 APIs (VirtualAlloc, LoadLibrary, GetProcAddress, the home address of the coded ", "_context_right": ", etc.for its later use by the loader:", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/05-1024x784.png)", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/06.png)", "label": "Payload is the carrying capacity of an aircraft or launch vehicle, usually measured in terms of weight. Depending on the nature of the flight or mission, the payload of a vehicle may include cargo, passengers, flight crew, munitions, scientific instruments or experiments, or other equipment. Extra fuel, when optionally carried, is also considered part of the payload. In a commercial context (i.e., an airline or air freight carrier), payload may refer only to revenue-generating cargo or paying passengers.  For a rocket, the payload can be a satellite, space probe, or spacecraft carrying humans, animals, or cargo. For a ballistic missile, the payload is one or more warheads and related systems; the total weight of these systems is referred to as the throw-weight.  The fraction of payload to the total liftoff weight of the air or spacecraft is known as the \"payload fraction\". When the weight of the payload and fuel are considered together, it is known as the \"useful load fraction\". In spacecraft, \"mass fraction\" is normally used, which is the ratio of payload to everything else, including the rocket structure.", "label_id": 21301, "label_title": "Payload", "label_link": "https://en.wikipedia.org/wiki?curid=41495", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "After the creation of these two segments, a third segment is allocated, where it is loaded the absolute memory addresses from several win32 APIs (VirtualAlloc, LoadLibrary, GetProcAddress, the home address of the coded payload, etc.for its later use by the loader: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/06.png) We can notice how the segment will have the memory addresses (starting from 123.exe they are located in netsh.exe segment through the version.dll code):", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/06.png)", "sentence_left": "After the creation of these two segments, a third segment is allocated, where it is loaded the absolute memory addresses from several win32 APIs (VirtualAlloc, LoadLibrary, GetProcAddress, the home address of the coded payload, etc.for its later use by the loader:", "sentence_right": "We can notice how the segment will have the memory addresses (starting from 123.exe they are located in netsh.exe segment through the version.dll code):", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "We can notice how the segment will have the memory addresses (starting from 123.exe they are located in netsh.exe segment through the version.dll code): ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/07-1024x131.png) Then, another segment of 4Kb is created where it loads the code that will decrypt and load the final payload.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/07-1024x131.png)", "sentence_left": "We can notice how the segment will have the memory addresses (starting from 123.exe they are located in netsh.exe segment through the version.dll code):", "sentence_right": "Then, another segment of 4Kb is created where it loads the code that will decrypt and load the final payload.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "payload", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/07-1024x131.png) Then, another segment of 4Kb is created where it loads the code that will decrypt and load the final", "context_right": ". ![](https://lab52.io/blog/wp-content/uploads/2022/01/08.png)", "_context_left": "Then, another segment of 4Kb is created where it loads the code that will decrypt and load the final ", "_context_right": ".", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/07-1024x131.png)", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/08.png)", "label": "Payload is the carrying capacity of an aircraft or launch vehicle, usually measured in terms of weight. Depending on the nature of the flight or mission, the payload of a vehicle may include cargo, passengers, flight crew, munitions, scientific instruments or experiments, or other equipment. Extra fuel, when optionally carried, is also considered part of the payload. In a commercial context (i.e., an airline or air freight carrier), payload may refer only to revenue-generating cargo or paying passengers.  For a rocket, the payload can be a satellite, space probe, or spacecraft carrying humans, animals, or cargo. For a ballistic missile, the payload is one or more warheads and related systems; the total weight of these systems is referred to as the throw-weight.  The fraction of payload to the total liftoff weight of the air or spacecraft is known as the \"payload fraction\". When the weight of the payload and fuel are considered together, it is known as the \"useful load fraction\". In spacecraft, \"mass fraction\" is normally used, which is the ratio of payload to everything else, including the rocket structure.", "label_id": 21301, "label_title": "Payload", "label_link": "https://en.wikipedia.org/wiki?curid=41495", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "Then, another segment of 4Kb is created where it loads the code that will decrypt and load the final payload. ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/08.png) Finally, the “TokyoX” loader runs from the DLL (version.dll) in netsh.exe through the API NtcreateThreadEx and we see the start of the last page created in the stack:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/08.png)", "sentence_left": "Then, another segment of 4Kb is created where it loads the code that will decrypt and load the final payload.", "sentence_right": "Finally, the “TokyoX” loader runs from the DLL (version.dll) in netsh.exe through the API NtcreateThreadEx and we see the start of the last page created in the stack:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "Finally, the “TokyoX” loader runs from the DLL (version.dll) in netsh.exe through the API NtcreateThreadEx and we see the start of the last page created in the stack: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/09-1024x476.png) After the execution of NtCreateThreadEx, as indicated, the loader is initiated in netsh.exe in the segment:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/09-1024x476.png)", "sentence_left": "Finally, the “TokyoX” loader runs from the DLL (version.dll) in netsh.exe through the API NtcreateThreadEx and we see the start of the last page created in the stack:", "sentence_right": "After the execution of NtCreateThreadEx, as indicated, the loader is initiated in netsh.exe in the segment:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "After the execution of NtCreateThreadEx, as indicated, the loader is initiated in netsh.exe in the segment: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/10.png) Once the execution is moved to the netsh.exe process, it takes the string located in the initial 4Kb segment, copies it into the stack and replicates it (0x100, 256 bytes) to match the specific block size of 256bytes.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/10.png)", "sentence_left": "After the execution of NtCreateThreadEx, as indicated, the loader is initiated in netsh.exe in the segment:", "sentence_right": "Once the execution is moved to the netsh.exe process, it takes the string located in the initial 4Kb segment, copies it into the stack and replicates it (0x100, 256 bytes) to match the specific block size of 256bytes.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "when it reaches the value 0x100 in hexadecimal. ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/11.png) ![](https://lab52.io/blog/wp-content/uploads/2022/01/12.png)", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/11.png)", "sentence_left": "when it reaches the value 0x100 in hexadecimal.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/12.png)", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/11.png) ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/12.png) After the block is created with the replicated string, the values from 00 to FF are found and used for the decrypting process.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/12.png)", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/11.png)", "sentence_right": "After the block is created with the replicated string, the values from 00 to FF are found and used for the decrypting process.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "After the block is created with the replicated string, the values from 00 to FF are found and used for the decrypting process. ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/13.png) At this point, the loader transforms the 00-FF block with a series of additions combining the replicated string’s block with the 00-FF block, as we can see:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/13.png)", "sentence_left": "After the block is created with the replicated string, the values from 00 to FF are found and used for the decrypting process.", "sentence_right": "At this point, the loader transforms the 00-FF block with a series of additions combining the replicated string’s block with the 00-FF block, as we can see:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "At this point, the loader transforms the 00-FF block with a series of additions combining the replicated string’s block with the 00-FF block, as we can see: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/14.png) The combination of the blue block (in following image) and the 00-FF block (pointed in red in previous image) results in the following block in memory, marked in red in the image:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/14.png)", "sentence_left": "At this point, the loader transforms the 00-FF block with a series of additions combining the replicated string’s block with the 00-FF block, as we can see:", "sentence_right": "The combination of the blue block (in following image) and the 00-FF block (pointed in red in previous image) results in the following block in memory, marked in red in the image:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "The combination of the blue block (in following image) and the 00-FF block (pointed in red in previous image) results in the following block in memory, marked in red in the image: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/15.png) On the next step, the loader reads the initial argument, arg0, whose value is 0x900000 and points at the 4Kb block, which stores the absolute addresses to different API from Win32:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/15.png)", "sentence_left": "The combination of the blue block (in following image) and the 00-FF block (pointed in red in previous image) results in the following block in memory, marked in red in the image:", "sentence_right": "On the next step, the loader reads the initial argument, arg0, whose value is 0x900000 and points at the 4Kb block, which stores the absolute addresses to different API from Win32:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "On the next step, the loader reads the initial argument, arg0, whose value is 0x900000 and points at the 4Kb block, which stores the absolute addresses to different API from Win32: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/16.png) After this, the decrypting process for the final payload begins.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/16.png)", "sentence_left": "On the next step, the loader reads the initial argument, arg0, whose value is 0x900000 and points at the 4Kb block, which stores the absolute addresses to different API from Win32:", "sentence_right": "After this, the decrypting process for the final payload begins.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "This description of the decryption algorythm has been identified as the **RC4 algorythm**. ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/17.png) After the decryption process, we find a PE binary, as seen in the following image.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/17.png)", "sentence_left": "This description of the decryption algorythm has been identified as the **RC4 algorythm**.", "sentence_right": "After the decryption process, we find a PE binary, as seen in the following image.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "payload", "context_left": "After the decryption process, we find a PE binary, as seen in the following image. In this case, the", "context_right": "does not start with the traditional MZ header but the string “tokyo”: ![](https://lab52.io/blog/wp-content/uploads/2022/01/18.png)", "_context_left": "In this case, the ", "_context_right": " does not start with the traditional MZ header but the string “tokyo”:", "sentence_left": "After the decryption process, we find a PE binary, as seen in the following image.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/18.png)", "label": "Payload is the carrying capacity of an aircraft or launch vehicle, usually measured in terms of weight. Depending on the nature of the flight or mission, the payload of a vehicle may include cargo, passengers, flight crew, munitions, scientific instruments or experiments, or other equipment. Extra fuel, when optionally carried, is also considered part of the payload. In a commercial context (i.e., an airline or air freight carrier), payload may refer only to revenue-generating cargo or paying passengers.  For a rocket, the payload can be a satellite, space probe, or spacecraft carrying humans, animals, or cargo. For a ballistic missile, the payload is one or more warheads and related systems; the total weight of these systems is referred to as the throw-weight.  The fraction of payload to the total liftoff weight of the air or spacecraft is known as the \"payload fraction\". When the weight of the payload and fuel are considered together, it is known as the \"useful load fraction\". In spacecraft, \"mass fraction\" is normally used, which is the ratio of payload to everything else, including the rocket structure.", "label_id": 21301, "label_title": "Payload", "label_link": "https://en.wikipedia.org/wiki?curid=41495", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "In this case, the payload does not start with the traditional MZ header but the string “tokyo”: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/18.png) Then, we see how it loads the VirtualAlloc absolute address (0x77211856) from the segment previously created:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/18.png)", "sentence_left": "In this case, the payload does not start with the traditional MZ header but the string “tokyo”:", "sentence_right": "Then, we see how it loads the VirtualAlloc absolute address (0x77211856) from the segment previously created:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "Then, we see how it loads the VirtualAlloc absolute address (0x77211856) from the segment previously created: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/Screenshot-from-2022-01-10-16-37-59-1024x307.png) This creates another memory segment in the process netsh.exe with RWX licenses (that of 116Kb) which will be used to load the PE:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/Screenshot-from-2022-01-10-16-37-59-1024x307.png)", "sentence_left": "Then, we see how it loads the VirtualAlloc absolute address (0x77211856) from the segment previously created:", "sentence_right": "This creates another memory segment in the process netsh.exe with RWX licenses (that of 116Kb) which will be used to load the PE:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "This creates another memory segment in the process netsh.exe with RWX licenses (that of 116Kb) which will be used to load the PE: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/20-1024x89.png) In this new segment, it maps the binary using the virtual addresses as the regular Windows PE loader would do.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/20-1024x89.png)", "sentence_left": "This creates another memory segment in the process netsh.exe with RWX licenses (that of 116Kb) which will be used to load the PE:", "sentence_right": "In this new segment, it maps the binary using the virtual addresses as the regular Windows PE loader would do.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "Then, it calls the API LoadLibraryA (it has the address since the DLL saved it in the memory segment) of the strings located in the mapped block: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/21-3-1024x363.png) Then it calls GetProcAddress() to get the addresses of certain functions:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/21-3-1024x363.png)", "sentence_left": "Then, it calls the API LoadLibraryA (it has the address since the DLL saved it in the memory segment) of the strings located in the mapped block:", "sentence_right": "Then it calls GetProcAddress() to get the addresses of certain functions:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "Then it calls GetProcAddress() to get the addresses of certain functions: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/22-1024x441.png) ![](https://lab52.io/blog/wp-content/uploads/2022/01/23.png)", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/22-1024x441.png)", "sentence_left": "Then it calls GetProcAddress() to get the addresses of certain functions:", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/23.png)", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/22-1024x441.png) ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/23.png) Next, the libraries and functions block may be appreciated:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/23.png)", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/22-1024x441.png)", "sentence_right": "Next, the libraries and functions block may be appreciated:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "Next, the libraries and functions block may be appreciated: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/24.png) After the correct mapping and having loaded the necessary libraries for its proper functioning, it calls EAX to run the decrypted and mapped payload:", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/24.png)", "sentence_left": "Next, the libraries and functions block may be appreciated:", "sentence_right": "After the correct mapping and having loaded the necessary libraries for its proper functioning, it calls EAX to run the decrypted and mapped payload:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "payload", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/24.png) After the correct mapping and having loaded the necessary libraries for its proper functioning, it calls EAX to run the decrypted and mapped", "context_right": ": ![](https://lab52.io/blog/wp-content/uploads/2022/01/25-1024x452.png)", "_context_left": "After the correct mapping and having loaded the necessary libraries for its proper functioning, it calls EAX to run the decrypted and mapped ", "_context_right": ":", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/24.png)", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/25-1024x452.png)", "label": "Payload is the carrying capacity of an aircraft or launch vehicle, usually measured in terms of weight. Depending on the nature of the flight or mission, the payload of a vehicle may include cargo, passengers, flight crew, munitions, scientific instruments or experiments, or other equipment. Extra fuel, when optionally carried, is also considered part of the payload. In a commercial context (i.e., an airline or air freight carrier), payload may refer only to revenue-generating cargo or paying passengers.  For a rocket, the payload can be a satellite, space probe, or spacecraft carrying humans, animals, or cargo. For a ballistic missile, the payload is one or more warheads and related systems; the total weight of these systems is referred to as the throw-weight.  The fraction of payload to the total liftoff weight of the air or spacecraft is known as the \"payload fraction\". When the weight of the payload and fuel are considered together, it is known as the \"useful load fraction\". In spacecraft, \"mass fraction\" is normally used, which is the ratio of payload to everything else, including the rocket structure.", "label_id": 21301, "label_title": "Payload", "label_link": "https://en.wikipedia.org/wiki?curid=41495", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "After the correct mapping and having loaded the necessary libraries for its proper functioning, it calls EAX to run the decrypted and mapped payload: ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/25-1024x452.png) ![](https://lab52.io/blog/wp-content/uploads/2022/01/26.png)", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/25-1024x452.png)", "sentence_left": "After the correct mapping and having loaded the necessary libraries for its proper functioning, it calls EAX to run the decrypted and mapped payload:", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/26.png)", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/25-1024x452.png) ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/26.png) To summarize, this article goes through the process followed in memory after executing the Creative Cloud application until deploying TokyoX in memory.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/26.png)", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/25-1024x452.png)", "sentence_right": "To summarize, this article goes through the process followed in memory after executing the Creative Cloud application until deploying TokyoX in memory.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "China", "context_left": "To summarize, this article goes through the process followed in memory after executing the Creative Cloud application until deploying TokyoX in memory. This DLL sideloading style is often linked to APT groups whose attribution is also linked to", "context_right": ", however being a known technique as it is, we are not able to consider any feasible attribution at the moment. As reviewed at the beginning of the article, what we have named as “TokyoX” has not been identified as a known malware so far (at least, with the sources that we have).", "_context_left": "This DLL sideloading style is often linked to APT groups whose attribution is also linked to ", "_context_right": ", however being a known technique as it is, we are not able to consider any feasible attribution at the moment.", "sentence_left": "To summarize, this article goes through the process followed in memory after executing the Creative Cloud application until deploying TokyoX in memory.", "sentence_right": "As reviewed at the beginning of the article, what we have named as “TokyoX” has not been identified as a known malware so far (at least, with the sources that we have).", "label": "China (; lit. \"Middle Kingdom\"), officially the People's Republic of China (PRC), is a country in East Asia and the world's most populous country, with a population of around /1e9 round 3 billion. Covering approximately , it is the fourth largest country by total area. Governed by the Communist Party of China, the state exercises jurisdiction over 22 provinces, five autonomous regions, four direct-controlled municipalities (Beijing, Tianjin, Shanghai, and Chongqing), and the special administrative regions of Hong Kong and Macau.  China emerged as one of the world's earliest civilizations, in the fertile basin of the Yellow River in the North China Plain. For millennia, China's political system was based on hereditary monarchies, or dynasties, beginning with the semi-legendary Xia dynasty in 21st century BCE. Since then, China has expanded, fractured, and re-unified numerous times. In the 3rd century BCE, the Qin reunited core China and established the first Chinese empire. The succeeding Han dynasty, which ruled from 206 BC until 220 AD, saw some of the most advanced technology at that time, including papermaking and the compass, along with agricultural and medical improvements. The invention of gunpowder and movable type in the Tang dynasty (618–907) and Northern Song (960–1127) completed the Four Great Inventions. Tang culture spread widely in Asia, as the new Silk Route brought traders to as far as Mesopotamia and the Horn of Africa. Dynastic rule ended in 1912 with the Xinhai Revolution, when the republic replaced the Qing dynasty. China as a whole was ravaged by Japan during World War II,", "label_id": 2397, "label_title": "China", "label_link": "https://en.wikipedia.org/wiki?curid=5405", "entity_class": "NE", "entity_type": "LOC", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "APT", "context_left": "To summarize, this article goes through the process followed in memory after executing the Creative Cloud application until deploying TokyoX in memory. This DLL sideloading style is often linked to", "context_right": "groups whose attribution is also linked to China, however being a known technique as it is, we are not able to consider any feasible attribution at the moment. As reviewed at the beginning of the article, what we have named as “TokyoX” has not been identified as a known malware so far (at least, with the sources that we have).", "_context_left": "This DLL sideloading style is often linked to ", "_context_right": " groups whose attribution is also linked to China, however being a known technique as it is, we are not able to consider any feasible attribution at the moment.", "sentence_left": "To summarize, this article goes through the process followed in memory after executing the Creative Cloud application until deploying TokyoX in memory.", "sentence_right": "As reviewed at the beginning of the article, what we have named as “TokyoX” has not been identified as a known malware so far (at least, with the sources that we have).", "label": "An advanced persistent threat (APT) is a stealthy computer network attack in which a person or group gains unauthorized access to a network and remains undetected for an extended period. The term's definition was traditionally associated with state sponsorship, but over the last few years there have been multiple examples of non-state sponsored groups conducting large-scale targeted intrusions for specific goals.  An APT may have either business or political motives. APT processes require a high degree of covertness over a long period of time. The \"advanced\" process signifies sophisticated techniques using malware to exploit vulnerabilities in systems. The \"persistent\" process suggests that an external command and control system is continuously monitoring and extracting data from a specific target. The \"threat\" process indicates human involvement in orchestrating the attack.  APT usually refers to a group, such as a government, with both the capability and the intent to target, persistently and effectively, a specific entity. The term is commonly used to refer to cyber threats, in particular that of Internet-enabled espionage using a variety of intelligence gathering techniques to access sensitive information, but applies equally to other threats such as that of traditional espionage or attacks. Other recognized attack vectors include infected media, supply chain compromise, and human intelligence and deception. The purpose of these attacks is to place custom malicious code on one or multiple computers for specific tasks and to remain undetected for the longest possible period. Knowing the attacker artifacts, such as file names, can help a professional make a network-wide search", "label_id": 3008833, "label_title": "Advanced persistent threat", "label_link": "https://en.wikipedia.org/wiki?curid=25874360", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "chinese", "context_left": "Additionally, at some point of the analysis we identified a tool used by this group for the creation of version.dll, which pretends to be a Windows DLL located in SysWOW/System32. The string “AheadLib” found among the code of the malicious version.dll drew our attention, and we quickly found two", "context_right": "(casually or not) GitHub repositories with the source code of some tool called AheadLib. ![](https://lab52.io/blog/wp-content/uploads/2022/01/27.png)", "_context_left": "The string “AheadLib” found among the code of the malicious version.dll drew our attention, and we quickly found two ", "_context_right": " (casually or not) GitHub repositories with the source code of some tool called AheadLib.", "sentence_left": "Additionally, at some point of the analysis we identified a tool used by this group for the creation of version.dll, which pretends to be a Windows DLL located in SysWOW/System32.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/27.png)", "label": "China (; lit. \"Middle Kingdom\"), officially the People's Republic of China (PRC), is a country in East Asia and the world's most populous country, with a population of around /1e9 round 3 billion. Covering approximately , it is the fourth largest country by total area. Governed by the Communist Party of China, the state exercises jurisdiction over 22 provinces, five autonomous regions, four direct-controlled municipalities (Beijing, Tianjin, Shanghai, and Chongqing), and the special administrative regions of Hong Kong and Macau.  China emerged as one of the world's earliest civilizations, in the fertile basin of the Yellow River in the North China Plain. For millennia, China's political system was based on hereditary monarchies, or dynasties, beginning with the semi-legendary Xia dynasty in 21st century BCE. Since then, China has expanded, fractured, and re-unified numerous times. In the 3rd century BCE, the Qin reunited core China and established the first Chinese empire. The succeeding Han dynasty, which ruled from 206 BC until 220 AD, saw some of the most advanced technology at that time, including papermaking and the compass, along with agricultural and medical improvements. The invention of gunpowder and movable type in the Tang dynasty (618–907) and Northern Song (960–1127) completed the Four Great Inventions. Tang culture spread widely in Asia, as the new Silk Route brought traders to as far as Mesopotamia and the Horn of Africa. Dynastic rule ended in 1912 with the Xinhai Revolution, when the republic replaced the Qing dynasty. China as a whole was ravaged by Japan during World War II,", "label_id": 2397, "label_title": "China", "label_link": "https://en.wikipedia.org/wiki?curid=5405", "entity_class": "NE", "entity_type": "LOC", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "GitHub", "context_left": "Additionally, at some point of the analysis we identified a tool used by this group for the creation of version.dll, which pretends to be a Windows DLL located in SysWOW/System32. The string “AheadLib” found among the code of the malicious version.dll drew our attention, and we quickly found two chinese (casually or not)", "context_right": "repositories with the source code of some tool called AheadLib. ![](https://lab52.io/blog/wp-content/uploads/2022/01/27.png)", "_context_left": "The string “AheadLib” found among the code of the malicious version.dll drew our attention, and we quickly found two chinese (casually or not) ", "_context_right": " repositories with the source code of some tool called AheadLib.", "sentence_left": "Additionally, at some point of the analysis we identified a tool used by this group for the creation of version.dll, which pretends to be a Windows DLL located in SysWOW/System32.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/27.png)", "label": "GitHub is an American company that provides hosting for software development version control using Git. It is a subsidiary of Microsoft, which acquired the company in 2018 for $7.5 billion. It offers all of the distributed version control and source code management (SCM) functionality of Git as well as adding its own features. It provides access control and several collaboration features such as bug tracking, feature requests, task management, and wikis for every project.  GitHub offers plans for free, professional, and enterprise accounts. Free GitHub accounts are commonly used to host open source projects. As of January 2019, GitHub offers unlimited private repositories to all plans, including free accounts. As of May 2019, GitHub reports having over 37 million users and more than 100 million repositories (including at least 28 million public repositories), making it the largest host of source code in the world.", "label_id": 2294705, "label_title": "GitHub", "label_link": "https://en.wikipedia.org/wiki?curid=18545292", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "The string “AheadLib” found among the code of the malicious version.dll drew our attention, and we quickly found two chinese (casually or not) GitHub repositories with the source code of some tool called AheadLib. ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/27.png) ![](https://lab52.io/blog/wp-content/uploads/2022/01/28.png)", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/27.png)", "sentence_left": "The string “AheadLib” found among the code of the malicious version.dll drew our attention, and we quickly found two chinese (casually or not) GitHub repositories with the source code of some tool called AheadLib.", "sentence_right": "![](https://lab52.io/blog/wp-content/uploads/2022/01/28.png)", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/27.png) ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/28.png) Basically, this tool will allow you to create a C++ source code file, implementing a DLL with the same exported functions as a given DLL.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/28.png)", "sentence_left": "![](https://lab52.io/blog/wp-content/uploads/2022/01/27.png)", "sentence_right": "Basically, this tool will allow you to create a C++ source code file, implementing a DLL with the same exported functions as a given DLL.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "For the purpose of the current analysis we generated a source code file using this tool and giving the legitimate version.dll as input. ![](https://", "context_right": ".io/blog/wp-content/uploads/2022/01/29.png) In the shown screenshot we can see on the left side the pseudocode generated by IDA Pro while analyzing the malicious version.dll sample.", "_context_left": "![](https://", "_context_right": ".io/blog/wp-content/uploads/2022/01/29.png)", "sentence_left": "For the purpose of the current analysis we generated a source code file using this tool and giving the legitimate version.dll as input.", "sentence_right": "In the shown screenshot we can see on the left side the pseudocode generated by IDA Pro while analyzing the malicious version.dll sample.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "Even though the exported functions are not shown in the previous image, we can appreciate how there is a perfect match between both snippets. Read the second part of the analysis of the final “TokyoX” RAT and its capacities [here](https://", "context_right": ".io/blog/tokyox-dll-side-loading-an-unknown-artifact-part-2/). **IOCs**", "_context_left": "Read the second part of the analysis of the final “TokyoX” RAT and its capacities [here](https://", "_context_right": ".io/blog/tokyox-dll-side-loading-an-unknown-artifact-part-2/).", "sentence_left": "Even though the exported functions are not shown in the previous image, we can appreciate how there is a perfect match between both snippets.", "sentence_right": "**IOCs**", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "Lab52", "context_left": "* 31.192.107[.]187:443 Customers with", "context_right": "’s APT intelligence private feed service already have more tools and means of detection for this campaign. In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied.", "_context_left": "Customers with ", "_context_right": "’s APT intelligence private feed service already have more tools and means of detection for this campaign.", "sentence_left": "* 31.192.107[.]187:443", "sentence_right": "In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "APT", "context_left": "* 31.192.107[.]187:443 Customers with Lab52’s", "context_right": "intelligence private feed service already have more tools and means of detection for this campaign. In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied.", "_context_left": "Customers with Lab52’s ", "_context_right": " intelligence private feed service already have more tools and means of detection for this campaign.", "sentence_left": "* 31.192.107[.]187:443", "sentence_right": "In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied.", "label": "An advanced persistent threat (APT) is a stealthy computer network attack in which a person or group gains unauthorized access to a network and remains undetected for an extended period. The term's definition was traditionally associated with state sponsorship, but over the last few years there have been multiple examples of non-state sponsored groups conducting large-scale targeted intrusions for specific goals.  An APT may have either business or political motives. APT processes require a high degree of covertness over a long period of time. The \"advanced\" process signifies sophisticated techniques using malware to exploit vulnerabilities in systems. The \"persistent\" process suggests that an external command and control system is continuously monitoring and extracting data from a specific target. The \"threat\" process indicates human involvement in orchestrating the attack.  APT usually refers to a group, such as a government, with both the capability and the intent to target, persistently and effectively, a specific entity. The term is commonly used to refer to cyber threats, in particular that of Internet-enabled espionage using a variety of intelligence gathering techniques to access sensitive information, but applies equally to other threats such as that of traditional espionage or attacks. Other recognized attack vectors include infected media, supply chain compromise, and human intelligence and deception. The purpose of these attacks is to place custom malicious code on one or multiple computers for specific tasks and to remain undetected for the longest possible period. Knowing the attacker artifacts, such as file names, can help a professional make a network-wide search", "label_id": 3008833, "label_title": "Advanced persistent threat", "label_link": "https://en.wikipedia.org/wiki?curid=25874360", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "S2Grupo", "context_left": "Customers with Lab52’s APT intelligence private feed service already have more tools and means of detection for this campaign. In case of having threat hunting service or being client of", "context_right": "CERT, this intelligence has already been applied. If you need more information about Lab52’s private APT intelligence feed service, you can contact us through the [following link](https://lab52.io/contact)", "_context_left": "In case of having threat hunting service or being client of ", "_context_right": " CERT, this intelligence has already been applied.", "sentence_left": "Customers with Lab52’s APT intelligence private feed service already have more tools and means of detection for this campaign.", "sentence_right": "If you need more information about Lab52’s private APT intelligence feed service, you can contact us through the [following link](https://lab52.io/contact)", "label": "Grupo Bimbo, S.A.B. de C.V., known as Bimbo, is a Mexican multinational bakery product manufacturing company headquartered in Mexico City, Mexico. It is the world's largest baking company and operates the largest bakeries in the United States, Mexico, Canada, Chile, Peru and Spain, and has some of the widest distribution networks in Mexico and the United States. It was also the ninth largest company of Mexico by revenues in 2013.  Bimbo reported revenues of US$14.1 billion for 2014. It has more than 129,000 employees, 165 manufacturing plants and 2.5 million sales centers located in 32 countries in America, Europe and Asia. It operates more than 100 trademarks, among which are Bimbo, Tia Rosa, Marinela, Wonder (in Mexico only), Barcel, Sara Lee, Mrs Baird's and Oroweat. Bimbo has one of the widest distribution networks in the world, surpassing 52,000 routes Bimbo operates under a scheme of recurrent sales channels views, making three daily visits to the same establishment.  Bimbo has been listed on the Mexican Stock Exchange since 1980 and is a constituent of the IPC, the main benchmark index of Mexican stocks. In 2016, Forbes magazine ranked Grupo Bimbo at #986 on the Forbes Global 2000, an annual ranking of the top 2,000 public companies in the world.", "label_id": 575198, "label_title": "Grupo Bimbo", "label_link": "https://en.wikipedia.org/wiki?curid=2204087", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "Lab52", "context_left": "In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied. If you need more information about", "context_right": "’s private APT intelligence feed service, you can contact us through the [following link](https://lab52.io/contact)", "_context_left": "If you need more information about ", "_context_right": "’s private APT intelligence feed service, you can contact us through the [following link](https://lab52.io/contact)", "sentence_left": "In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied.", "sentence_right": "", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "lab52", "context_left": "In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied. If you need more information about Lab52’s private APT intelligence feed service, you can contact us through the [following link](https://", "context_right": ".io/contact)", "_context_left": "If you need more information about Lab52’s private APT intelligence feed service, you can contact us through the [following link](https://", "_context_right": ".io/contact)", "sentence_left": "In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied.", "sentence_right": "", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}
{"mention": "APT", "context_left": "In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied. If you need more information about Lab52’s private", "context_right": "intelligence feed service, you can contact us through the [following link](https://lab52.io/contact)", "_context_left": "If you need more information about Lab52’s private ", "_context_right": " intelligence feed service, you can contact us through the [following link](https://lab52.io/contact)", "sentence_left": "In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied.", "sentence_right": "", "label": "An advanced persistent threat (APT) is a stealthy computer network attack in which a person or group gains unauthorized access to a network and remains undetected for an extended period. The term's definition was traditionally associated with state sponsorship, but over the last few years there have been multiple examples of non-state sponsored groups conducting large-scale targeted intrusions for specific goals.  An APT may have either business or political motives. APT processes require a high degree of covertness over a long period of time. The \"advanced\" process signifies sophisticated techniques using malware to exploit vulnerabilities in systems. The \"persistent\" process suggests that an external command and control system is continuously monitoring and extracting data from a specific target. The \"threat\" process indicates human involvement in orchestrating the attack.  APT usually refers to a group, such as a government, with both the capability and the intent to target, persistently and effectively, a specific entity. The term is commonly used to refer to cyber threats, in particular that of Internet-enabled espionage using a variety of intelligence gathering techniques to access sensitive information, but applies equally to other threats such as that of traditional espionage or attacks. Other recognized attack vectors include infected media, supply chain compromise, and human intelligence and deception. The purpose of these attacks is to place custom malicious code on one or multiple computers for specific tasks and to remain undetected for the longest possible period. Knowing the attacker artifacts, such as file names, can help a professional make a network-wide search", "label_id": 3008833, "label_title": "Advanced persistent threat", "label_link": "https://en.wikipedia.org/wiki?curid=25874360", "entity_class": "CE", "entity_type": "CON", "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}