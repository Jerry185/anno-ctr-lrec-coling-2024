{"mention": "Symantec", "context_left": "April 02, 2019 The OrangeWorm group was named and described by the", "context_right": "Company in different blog entries [[1]](https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia)", "_context_left": "The OrangeWorm group was named and described by the ", "_context_right": " Company in different blog entries", "sentence_left": "April 02, 2019", "sentence_right": "[[1]](https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia)", "label": "Symantec Corporation (; commonly known as Symantec) is an American software company headquartered in Mountain View, California, United States. The company provides cybersecurity software and services. Symantec is a Fortune 500 company and a member of the S&P 500 stock-market index. The company also has development centers in Pune, Chennai and Bengaluru (India).  On October 9, 2014, Symantec declared it would split into two independent publicly traded companies by the end of 2015. One company would focus on security, the other on information management. On January 29, 2016, Symantec sold its information-management subsidiary, named Veritas Technologies (which Symantec had acquired in 2004) to The Carlyle Group.  The name \"\"Symantec\"\" is a portmanteau of the words \"syntax\" and \"semantics\" with \"technology\".", "label_id": 156916, "label_title": "Symantec", "label_link": "https://en.wikipedia.org/wiki?curid=354414", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Symantec", "context_left": "We would highlight from these entries that it is a group that has been operational since 2015 and is focused on attacking the **health**, pharmaceutical, technological, manufacturing and logistics sectors. The sector most affected is **healthcare** as described by", "context_right": ". Based on this information, Lab52 has carried out an in-depth study of the Kwampirs tool (OrangeWorm’s main tool) used by this group.", "_context_left": "The sector most affected is **healthcare** as described by ", "_context_right": ".", "sentence_left": "We would highlight from these entries that it is a group that has been operational since 2015 and is focused on attacking the **health**, pharmaceutical, technological, manufacturing and logistics sectors.", "sentence_right": "Based on this information, Lab52 has carried out an in-depth study of the Kwampirs tool (OrangeWorm’s main tool) used by this group.", "label": "Symantec Corporation (; commonly known as Symantec) is an American software company headquartered in Mountain View, California, United States. The company provides cybersecurity software and services. Symantec is a Fortune 500 company and a member of the S&P 500 stock-market index. The company also has development centers in Pune, Chennai and Bengaluru (India).  On October 9, 2014, Symantec declared it would split into two independent publicly traded companies by the end of 2015. One company would focus on security, the other on information management. On January 29, 2016, Symantec sold its information-management subsidiary, named Veritas Technologies (which Symantec had acquired in 2004) to The Carlyle Group.  The name \"\"Symantec\"\" is a portmanteau of the words \"syntax\" and \"semantics\" with \"technology\".", "label_id": 156916, "label_title": "Symantec", "label_link": "https://en.wikipedia.org/wiki?curid=354414", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Lab52", "context_left": "The sector most affected is **healthcare** as described by Symantec. Based on this information,", "context_right": "has carried out an in-depth study of the Kwampirs tool (OrangeWorm’s main tool) used by this group. Next, the RAT (Remote Administration Tool) in Dll format and the main binary or orchestrator of the infection will be analyzed.", "_context_left": "Based on this information, ", "_context_right": " has carried out an in-depth study of the Kwampirs tool (OrangeWorm’s main tool) used by this group.", "sentence_left": "The sector most affected is **healthcare** as described by Symantec.", "sentence_right": "Next, the RAT (Remote Administration Tool) in Dll format and the main binary or orchestrator of the infection will be analyzed.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "One of which consists of the DLL with RAT capabilities encrypted with an XOR key that in each execution extracts, decrypts and executes: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img01.png) This threat has a first execution block, in charge of decrypting all the text strings that it will use and which are encrypted in its “.data” section with a relatively obfuscated XOR algorithm in order to make detection and decryption difficult.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img01.png)", "sentence_left": "One of which consists of the DLL with RAT capabilities encrypted with an XOR key that in each execution extracts, decrypts and executes:", "sentence_right": "This threat has a first execution block, in charge of decrypting all the text strings that it will use and which are encrypted in its “.data” section with a relatively obfuscated XOR algorithm in order to make detection and decryption difficult.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "If it does not exist and has sufficient privileges, it creates the persistence service. ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img02.png) This service generates it with a hardcoded name and data in the strings that it has decrypted at the beginning of its execution, and emphasizes that it points to an executable with the name it has at that moment, but in %System32% even though it has not been observed that it copies itself to that route at any time.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img02.png)", "sentence_left": "If it does not exist and has sufficient privileges, it creates the persistence service.", "sentence_right": "This service generates it with a hardcoded name and data in the strings that it has decrypted at the beginning of its execution, and emphasizes that it points to an executable with the name it has at that moment, but in %System32% even though it has not been observed that it copies itself to that route at any time.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "Finally, it creates the file called ie11.PNF in which it writes 66 random bytes: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img03.png) In the previous capture, you can see how it creates a buffer of 66Bytes, which it fills with random bytes, and passes it as a parameter to a function that we have called “CreateFileWith2tmp” along with a string, which in this case contains “C:\\Windows\\inf\\ie11.PNF”.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img03.png)", "sentence_left": "Finally, it creates the file called ie11.PNF in which it writes 66 random bytes:", "sentence_right": "In the previous capture, you can see how it creates a buffer of 66Bytes, which it fills with random bytes, and passes it as a parameter to a function that we have called “CreateFileWith2tmp” along with a string, which in this case contains “C:\\Windows\\inf\\ie11.PNF”.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "The function “CreateFileWith2tmp” uses it constantly for the creation of each one of the files related to this threat, and is in charge of generating two temporary files, in one it stores the first Byte of the buffer it receives as the second parameter, in the second file it stores the rest of the buffer, after which, it executes the following command to concatenate the content of both, and store it in a new file with the name that it has received as the third parameter. ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img04-1.png) After generating this file, it finishes its execution, having started another instance of its own, as a service, and without parameters.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img04-1.png)", "sentence_left": "The function “CreateFileWith2tmp” uses it constantly for the creation of each one of the files related to this threat, and is in charge of generating two temporary files, in one it stores the first Byte of the buffer it receives as the second parameter, in the second file it stores the rest of the buffer, after which, it executes the following command to concatenate the content of both, and store it in a new file with the name that it has received as the third parameter.", "sentence_right": "After generating this file, it finishes its execution, having started another instance of its own, as a service, and without parameters.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Microsoft", "context_left": "**Execution without parameters** When the threat starts without parameters, after its first string decryption block and collection of system information, it makes a call to the", "context_right": "API “StartServiceCtrlDispatcherW” responsible for initiating the logic of a Windows service, after which it ends. Therefore, if it is not started as a service, it is not able to perform any action.", "_context_left": "When the threat starts without parameters, after its first string decryption block and collection of system information, it makes a call to the ", "_context_right": " API “StartServiceCtrlDispatcherW” responsible for initiating the logic of a Windows service, after which it ends.", "sentence_left": "**Execution without parameters**", "sentence_right": "Therefore, if it is not started as a service, it is not able to perform any action.", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "Therefore, if it is not started as a service, it is not able to perform any action. ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img05.png) If it is loaded as a service, after a first execution of its binary with a parameter, for example, the API “StartServiceCtrlDispatcherW” passes the execution flow of the application to a function of the binary.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img05.png)", "sentence_left": "Therefore, if it is not started as a service, it is not able to perform any action.", "sentence_right": "If it is loaded as a service, after a first execution of its binary with a parameter, for example, the API “StartServiceCtrlDispatcherW” passes the execution flow of the application to a function of the binary.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "This function consists in a first verification of the existence and capacity of access to the file “C:\\Windows\\inf\\mtmndkb32.PNF” if it finds a recent and accessible version of this one, it continues its normal execution, in case of not finding it or having problems of access to it, it goes through the processes in search of the copies of itself that it generates to run with 2 and 3 parameters, and in search of its modules to finish these processes and later, to eliminate these executables, as a cleanup. ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img06.png) Regardless of whether it finds the PNF file or not, it enters an infinite “while (.0)” loop, which is in charge of keeping its module in DLL format running and maintaining a copy of itself, running with two parameters, which is in charge of the lateral movement by SMB of the threat.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img06.png)", "sentence_left": "This function consists in a first verification of the existence and capacity of access to the file “C:\\Windows\\inf\\mtmndkb32.PNF” if it finds a recent and accessible version of this one, it continues its normal execution, in case of not finding it or having problems of access to it, it goes through the processes in search of the copies of itself that it generates to run with 2 and 3 parameters, and in search of its modules to finish these processes and later, to eliminate these executables, as a cleanup.", "sentence_right": "Regardless of whether it finds the PNF file or not, it enters an infinite “while (.0)” loop, which is in charge of keeping its module in DLL format running and maintaining a copy of itself, running with two parameters, which is in charge of the lateral movement by SMB of the threat.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "Regardless of whether it finds the PNF file or not, it enters an infinite “while (.0)” loop, which is in charge of keeping its module in DLL format running and maintaining a copy of itself, running with two parameters, which is in charge of the lateral movement by SMB of the threat. ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img07.png) The infinite loop, first, looks for instances of its module in DLL format in execution, in case of not finding it, it calls a function that takes charge of extracting from its resources the image mentioned at the beginning of the report, trimming the corrupt section, decrypting it with an XOR key of 16Bytes, using the following algorithm:", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img07.png)", "sentence_left": "Regardless of whether it finds the PNF file or not, it enters an infinite “while (.0)” loop, which is in charge of keeping its module in DLL format running and maintaining a copy of itself, running with two parameters, which is in charge of the lateral movement by SMB of the threat.", "sentence_right": "The infinite loop, first, looks for instances of its module in DLL format in execution, in case of not finding it, it calls a function that takes charge of extracting from its resources the image mentioned at the beginning of the report, trimming the corrupt section, decrypting it with an XOR key of 16Bytes, using the following algorithm:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "The infinite loop, first, looks for instances of its module in DLL format in execution, in case of not finding it, it calls a function that takes charge of extracting from its resources the image mentioned at the beginning of the report, trimming the corrupt section, decrypting it with an XOR key of 16Bytes, using the following algorithm: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img08.png) and store the result in System32 with one of the following names with extension “.dll”:", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img08.png)", "sentence_left": "The infinite loop, first, looks for instances of its module in DLL format in execution, in case of not finding it, it calls a function that takes charge of extracting from its resources the image mentioned at the beginning of the report, trimming the corrupt section, decrypting it with an XOR key of 16Bytes, using the following algorithm:", "sentence_right": "and store the result in System32 with one of the following names with extension “.dll”:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "and store the result in System32 with one of the following names with extension “.dll”: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img09.png) Once you have the module on disk, run it through Microsoft executable “rundll32.exe” passing the following parameters:", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img09.png)", "sentence_left": "and store the result in System32 with one of the following names with extension “.dll”:", "sentence_right": "Once you have the module on disk, run it through Microsoft executable “rundll32.exe” passing the following parameters:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Microsoft", "context_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img09.png) Once you have the module on disk, run it through", "context_right": "executable “rundll32.exe” passing the following parameters: ![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img10.png)", "_context_left": "Once you have the module on disk, run it through ", "_context_right": " executable “rundll32.exe” passing the following parameters:", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img09.png)", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img10.png)", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "Once you have the module on disk, run it through Microsoft executable “rundll32.exe” passing the following parameters: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img10.png) It then calls a function whose sole purpose is to call a one-minute “Sleep” 20 times, causing his execution to pause for a period of 20 minutes.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img10.png)", "sentence_left": "Once you have the module on disk, run it through Microsoft executable “rundll32.exe” passing the following parameters:", "sentence_right": "It then calls a function whose sole purpose is to call a one-minute “Sleep” 20 times, causing his execution to pause for a period of 20 minutes.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "After 20 minutes, it makes a call to a function that if it does not find an instance of itself running with 2 parameters, it makes a copy of its own binary with one of the following names: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img01-1.png) And it executes it with two parameters using the Microsoft API CreateProcessAsUserW, which allows it to add the token of the current user as the creator of the process, so that the process is executed in its session:", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img01-1.png)", "sentence_left": "After 20 minutes, it makes a call to a function that if it does not find an instance of itself running with 2 parameters, it makes a copy of its own binary with one of the following names:", "sentence_right": "And it executes it with two parameters using the Microsoft API CreateProcessAsUserW, which allows it to add the token of the current user as the creator of the process, so that the process is executed in its session:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Microsoft", "context_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img01-1.png) And it executes it with two parameters using the", "context_right": "API CreateProcessAsUserW, which allows it to add the token of the current user as the creator of the process, so that the process is executed in its session: ![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img12.png)", "_context_left": "And it executes it with two parameters using the ", "_context_right": " API CreateProcessAsUserW, which allows it to add the token of the current user as the creator of the process, so that the process is executed in its session:", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img01-1.png)", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img12.png)", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "And it executes it with two parameters using the Microsoft API CreateProcessAsUserW, which allows it to add the token of the current user as the creator of the process, so that the process is executed in its session: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img12.png) After this, it performs a Sleep with a random value between 1 and 3 minutes, and repeats the same execution flow, thus ensuring that both its module in DLL format and its replica running with two parameters are kept running.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img12.png)", "sentence_left": "And it executes it with two parameters using the Microsoft API CreateProcessAsUserW, which allows it to add the token of the current user as the creator of the process, so that the process is executed in its session:", "sentence_right": "After this, it performs a Sleep with a random value between 1 and 3 minutes, and repeats the same execution flow, thus ensuring that both its module in DLL format and its replica running with two parameters are kept running.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "At this point, we are running the process of the main Kwampirs dropper, loaded as System by the persistence service, an instance of rundll32, also as System generated by the process itself without parameters, and a second instance of the executable, this time with the credentials of the user who has logged in, thanks to the use of the “CreateProcessAsUserW” API for its creation: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img13-1024x280.png) **Execution with 2 parameters**", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img13-1024x280.png)", "sentence_left": "At this point, we are running the process of the main Kwampirs dropper, loaded as System by the persistence service, an instance of rundll32, also as System generated by the process itself without parameters, and a second instance of the executable, this time with the credentials of the user who has logged in, thanks to the use of the “CreateProcessAsUserW” API for its creation:", "sentence_right": "**Execution with 2 parameters**", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Microsoft", "context_left": "When the threat is executed with two parameters, after its first string decryption block and collection of system information, it goes directly to a function in charge of scanning private IPs, which it tries to access by SMB in order to check its access and infection capacity. To do this, it first generates a Thread, which through the", "context_right": "API “GetTcpTable” obtains the list of IPv4 connections of the system, from which it filters all those that are through ports 445 and 138, so it is able to isolate those related to SMB traffic, afterwards it tries to infect these IPs directly. To make sure it does not miss any computer to which the user has access, but which is not found on the table, the main thread of the threat scans the entire subnet of the computer, trying to infect all its possible IP addresses.", "_context_left": "To do this, it first generates a Thread, which through the ", "_context_right": " API “GetTcpTable” obtains the list of IPv4 connections of the system, from which it filters all those that are through ports 445 and 138, so it is able to isolate those related to SMB traffic, afterwards it tries to infect these IPs directly.", "sentence_left": "When the threat is executed with two parameters, after its first string decryption block and collection of system information, it goes directly to a function in charge of scanning private IPs, which it tries to access by SMB in order to check its access and infection capacity.", "sentence_right": "To make sure it does not miss any computer to which the user has access, but which is not found on the table, the main thread of the threat scans the entire subnet of the computer, trying to infect all its possible IP addresses.", "label": "Microsoft Corporation is an American multinational technology company with headquarters in Redmond, Washington. It develops, manufactures, licenses, supports and sells computer software, consumer electronics, personal computers, and related services. Its best known software products are the Microsoft Windows line of operating systems, the Microsoft Office suite, and the Internet Explorer and Edge Web browsers. Its flagship hardware products are the Xbox video game consoles and the Microsoft Surface lineup of touchscreen personal computers. As of 2016, it is the world's largest software maker by revenue, and one of the world's most valuable companies. The word \"Microsoft\" is a portmanteau of \"microcomputer\" and \"software\". Microsoft is ranked No. 30 in the 2018 Fortune 500 rankings of the largest United States corporations by total revenue.  Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions, their largest being the acquisition of LinkedIn for $26.2 billion in December 2016, followed by their acquisition of Skype Technologies for $8.5 billion in May 2011.  , Microsoft is market-dominant in the IBM PC compatible operating system market and the office software suite", "label_id": 9231, "label_title": "Microsoft", "label_link": "https://en.wikipedia.org/wiki?curid=19001", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "To do this, it makes a call to the “CreateFile” API, passing as the file path the IP address to be infected with the following path “[IP]\\ ADMIN $ \\ system32 \\ csrss.exe” replacing the first element after the IP address for each of the strings of the previous list, generating the following network traffic: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img14.png) If it gets access to this file on any computer, it checks the existence of ie11.PNF, to see if it is already infected, otherwise it creates a new one on that computer and gives the date and time extracted from User32.dll :", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img14.png)", "sentence_left": "To do this, it makes a call to the “CreateFile” API, passing as the file path the IP address to be infected with the following path “[IP]\\ ADMIN $ \\ system32 \\ csrss.exe” replacing the first element after the IP address for each of the strings of the previous list, generating the following network traffic:", "sentence_right": "If it gets access to this file on any computer, it checks the existence of ie11.PNF, to see if it is already infected, otherwise it creates a new one on that computer and gives the date and time extracted from User32.dll :", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "If it gets access to this file on any computer, it checks the existence of ie11.PNF, to see if it is already infected, otherwise it creates a new one on that computer and gives the date and time extracted from User32.dll : ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img15.png) If it is able to create that file, it tries to copy itself, for which it chooses some of the hardcoded names it has in its strings:", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img15.png)", "sentence_left": "If it gets access to this file on any computer, it checks the existence of ie11.PNF, to see if it is already infected, otherwise it creates a new one on that computer and gives the date and time extracted from User32.dll :", "sentence_right": "If it is able to create that file, it tries to copy itself, for which it chooses some of the hardcoded names it has in its strings:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "And it generates a copy of itself with that name, on the remote computer through SMB: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img16-1024x315.png) Each time it is able to create both ie11.PNF and the Kwampirs executable, it calls a function that, depending on the SMB scanning routine used to generate it, passes a number to it as a parameter.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img16-1024x315.png)", "sentence_left": "And it generates a copy of itself with that name, on the remote computer through SMB:", "sentence_right": "Each time it is able to create both ie11.PNF and the Kwampirs executable, it calls a function that, depending on the SMB scanning routine used to generate it, passes a number to it as a parameter.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "With this, and the address of the remote computer that has as its first parameter, tries to create and start the service “WmiApSrvEx” on the remote computer, generating traffic like the following: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img17.png) Depending on whether it is capable of generating and executing the service or not, it makes a call to the registration function in the “Lb978YTy.tmp” log of infected remote computers, but this time, the parameter can be a 3 if everything went well, or a 4 if it has not been able to generate or initiate persistence.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img17.png)", "sentence_left": "With this, and the address of the remote computer that has as its first parameter, tries to create and start the service “WmiApSrvEx” on the remote computer, generating traffic like the following:", "sentence_right": "Depending on whether it is capable of generating and executing the service or not, it makes a call to the registration function in the “Lb978YTy.tmp” log of infected remote computers, but this time, the parameter can be a 3 if everything went well, or a 4 if it has not been able to generate or initiate persistence.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "This device has the following static characteristics: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_cod01.png) In all the samples analyzed the ControlTrace () function is exported.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_cod01.png)", "sentence_left": "This device has the following static characteristics:", "sentence_right": "In all the samples analyzed the ControlTrace () function is exported.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Symantec", "context_left": "In all the samples analyzed the ControlTrace () function is exported. This has not changed since the", "context_right": "report. Kwampirs RAT depending on the number of parameters will have a different behavior.", "_context_left": "This has not changed since the ", "_context_right": " report.", "sentence_left": "In all the samples analyzed the ControlTrace () function is exported.", "sentence_right": "Kwampirs RAT depending on the number of parameters will have a different behavior.", "label": "Symantec Corporation (; commonly known as Symantec) is an American software company headquartered in Mountain View, California, United States. The company provides cybersecurity software and services. Symantec is a Fortune 500 company and a member of the S&P 500 stock-market index. The company also has development centers in Pune, Chennai and Bengaluru (India).  On October 9, 2014, Symantec declared it would split into two independent publicly traded companies by the end of 2015. One company would focus on security, the other on information management. On January 29, 2016, Symantec sold its information-management subsidiary, named Veritas Technologies (which Symantec had acquired in 2004) to The Carlyle Group.  The name \"\"Symantec\"\" is a portmanteau of the words \"syntax\" and \"semantics\" with \"technology\".", "label_id": 156916, "label_title": "Symantec", "label_link": "https://en.wikipedia.org/wiki?curid=354414", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "The possibilities implemented on this occasion are two, when **three** parameters and when **four** parameters are passed to the function. ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_cod02.png) The analysis will describe the behavior of Kwampirs RAT in each of the two existing execution branches:", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_cod02.png)", "sentence_left": "The possibilities implemented on this occasion are two, when **three** parameters and when **four** parameters are passed to the function.", "sentence_right": "The analysis will describe the behavior of Kwampirs RAT in each of the two existing execution branches:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "Symantec", "context_left": "In each execution (Kwampirs Dropper as Kwampirs RAT) it checks the exact date the file was created and if not enough time has passed since the file was created, it does not run again. This is already described by", "context_right": "in its report and the “current” samples have not changed their behavior. 4.In the event that Kwampirs RAT is downloaded, a module interacts with the **mkdiawb3.PNF** file before entering the network communication execution flow.", "_context_left": "This is already described by ", "_context_right": " in its report and the “current” samples have not changed their behavior.", "sentence_left": "In each execution (Kwampirs Dropper as Kwampirs RAT) it checks the exact date the file was created and if not enough time has passed since the file was created, it does not run again.", "sentence_right": "4.In the event that Kwampirs RAT is downloaded, a module interacts with the **mkdiawb3.PNF** file before entering the network communication execution flow.", "label": "Symantec Corporation (; commonly known as Symantec) is an American software company headquartered in Mountain View, California, United States. The company provides cybersecurity software and services. Symantec is a Fortune 500 company and a member of the S&P 500 stock-market index. The company also has development centers in Pune, Chennai and Bengaluru (India).  On October 9, 2014, Symantec declared it would split into two independent publicly traded companies by the end of 2015. One company would focus on security, the other on information management. On January 29, 2016, Symantec sold its information-management subsidiary, named Veritas Technologies (which Symantec had acquired in 2004) to The Carlyle Group.  The name \"\"Symantec\"\" is a portmanteau of the words \"syntax\" and \"semantics\" with \"technology\".", "label_id": 156916, "label_title": "Symantec", "label_link": "https://en.wikipedia.org/wiki?curid=354414", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "In this case Kwampirs RAT will try to boot the malware with the CreateProcessAsUser () function as follows: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img34.png) It looks like there are two instances of Kwampirs, but one with the user SYSTEM and another with the user Lucas.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img34.png)", "sentence_left": "In this case Kwampirs RAT will try to boot the malware with the CreateProcessAsUser () function as follows:", "sentence_right": "It looks like there are two instances of Kwampirs, but one with the user SYSTEM and another with the user Lucas.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "The pipe handlers (in decimal) are stored in a file created in C:\\Windows\\Temp: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img35.png) * 232 = E8", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img35.png)", "sentence_left": "The pipe handlers (in decimal) are stored in a file created in C:\\Windows\\Temp:", "sentence_right": "* 232 = E8", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "The handles of the process show that e8 and e4 are File handles: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img36.png) This mode of operation, as seen during the analysis, is used to communicate the Kwampirs RAT process started as SYSTEM (starting with the service) with the process started as the user owner of the current session of the machine.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img36.png)", "sentence_left": "The handles of the process show that e8 and e4 are File handles:", "sentence_right": "This mode of operation, as seen during the analysis, is used to communicate the Kwampirs RAT process started as SYSTEM (starting with the service) with the process started as the user owner of the current session of the machine.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "This mode of operation, as seen during the analysis, is used to communicate the Kwampirs RAT process started as SYSTEM (starting with the service) with the process started as the user owner of the current session of the machine. ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img37.png) In the previous screenshot you can see how the process rundll32.exe (starting with SYSTEM, in this case it would be the master) that could not go to the internet is about to write in a pipe to send the data to the process that has been created with the CreateProcessAsUser () function.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img37.png)", "sentence_left": "This mode of operation, as seen during the analysis, is used to communicate the Kwampirs RAT process started as SYSTEM (starting with the service) with the process started as the user owner of the current session of the machine.", "sentence_right": "In the previous screenshot you can see how the process rundll32.exe (starting with SYSTEM, in this case it would be the master) that could not go to the internet is about to write in a pipe to send the data to the process that has been created with the CreateProcessAsUser () function.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "Named Pipe: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img38.png) ![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img39.png)", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img38.png)", "sentence_left": "Named Pipe:", "sentence_right": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img39.png)", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img38.png) ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img39.png) If the handles of the rundll32 master process are opened with a tool like ProcessHacker, it will be seen how it has an open handle on the rundll32 process, created with the user without privileges (from now on rundll32 slave):", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img39.png)", "sentence_left": "![](https://lab52.es/blog/wp-content/uploads/2019/04/Orangeworm_img38.png)", "sentence_right": "If the handles of the rundll32 master process are opened with a tool like ProcessHacker, it will be seen how it has an open handle on the rundll32 process, created with the user without privileges (from now on rundll32 slave):", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "This is done with the OpenProcess () api and then OpenProcessToken () in order to obtain the token from the explorer.exe process (normally the owner of this process is the authenticated user and is the one most likely to have the configured proxy): ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img40.png) The following is a description of the entire sequence of actions carried out for the rundll32 master process to send information to the rundll32 slave after having seen some peculiarities previously.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img40.png)", "sentence_left": "This is done with the OpenProcess () api and then OpenProcessToken () in order to obtain the token from the explorer.exe process (normally the owner of this process is the authenticated user and is the one most likely to have the configured proxy):", "sentence_right": "The following is a description of the entire sequence of actions carried out for the rundll32 master process to send information to the rundll32 slave after having seen some peculiarities previously.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "The following image shows the master process rundll32.exe that just opened the slave process with the OpenProcess and will open a temporary file with wfopen: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img41.png) The temporary file contains the identifiers of the handles created in the rundll32 SLAVE process:", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img41.png)", "sentence_left": "The following image shows the master process rundll32.exe that just opened the slave process with the OpenProcess and will open a temporary file with wfopen:", "sentence_right": "The temporary file contains the identifiers of the handles created in the rundll32 SLAVE process:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "The temporary file contains the identifiers of the handles created in the rundll32 SLAVE process: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img42.png) In memory of the master process we will find those handles in their hexadecimal value:", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img42.png)", "sentence_left": "The temporary file contains the identifiers of the handles created in the rundll32 SLAVE process:", "sentence_right": "In memory of the master process we will find those handles in their hexadecimal value:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "In memory of the master process we will find those handles in their hexadecimal value: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img43.png) Once these handles are located, the master intends to duplicate them in order to obtain access to those handles in their process and that correspond to those of the slave process to communicate with each other:", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img43.png)", "sentence_left": "In memory of the master process we will find those handles in their hexadecimal value:", "sentence_right": "Once these handles are located, the master intends to duplicate them in order to obtain access to those handles in their process and that correspond to those of the slave process to communicate with each other:", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "Once these handles are located, the master intends to duplicate them in order to obtain access to those handles in their process and that correspond to those of the slave process to communicate with each other: ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img44.png) In this execution, the value of lpTargetHandle was 0x290 and it is linked (or duplicated) with one of the rundll32.exe slave processes that it just read from the temporary file.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img44.png)", "sentence_left": "Once these handles are located, the master intends to duplicate them in order to obtain access to those handles in their process and that correspond to those of the slave process to communicate with each other:", "sentence_right": "In this execution, the value of lpTargetHandle was 0x290 and it is linked (or duplicated) with one of the rundll32.exe slave processes that it just read from the temporary file.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}
{"mention": "lab52", "context_left": "In this execution, the value of lpTargetHandle was 0x290 and it is linked (or duplicated) with one of the rundll32.exe slave processes that it just read from the temporary file. ![](https://", "context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img45.png) Summing up the operation, the master rundll32.exe opens the slave process.", "_context_left": "![](https://", "_context_right": ".es/blog/wp-content/uploads/2019/04/Orangeworm_img45.png)", "sentence_left": "In this execution, the value of lpTargetHandle was 0x290 and it is linked (or duplicated) with one of the rundll32.exe slave processes that it just read from the temporary file.", "sentence_right": "Summing up the operation, the master rundll32.exe opens the slave process.", "label": "A company, abbreviated as co., is a legal entity made up of an association of people, be they natural, legal, or a mixture of both, for carrying on a commercial or industrial enterprise. Company members share a common purpose, and unite to focus their various talents and organize their collectively available skills or resources to achieve specific, declared goals. Companies take various forms, such as:   A company or association of persons can be created at law as a legal person so that the company in itself can accept limited liability for civil responsibility and taxation incurred as members perform (or fail to discharge) their duty within the publicly declared \"\"birth certificate\"\" or published policy.  Companies as legal persons may associate and register themselves collectively as other companies – often known as a corporate group. When a company closes, it may need a \"\"death certificate\"\" to avoid further legal obligations.", "label_id": 986634, "label_title": "Company", "label_link": "https://en.wikipedia.org/wiki?curid=4918223", "entity_class": "NE", "entity_type": "ORG", "document": "lab52_2019-04-02_orangeworm-group-kwampirs-analysis-update"}