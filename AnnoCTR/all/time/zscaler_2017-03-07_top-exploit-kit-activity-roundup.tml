<?xml version="1.0"?>
<TimeML xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://timeml.org/timeMLdocs/TimeML_1.2.1.xsd">
<DCT><TIMEX3 functionInDocument="CREATION_TIME" temporalFunction="false" tid="t0" type="DATE" value="2017-03-07">2017-03-07</TIMEX3></DCT>
<TEXT>
Top Exploit Kit Activity Roundup - Winter <TIMEX3 tid="t1" type="DATE" value="2017">2017</TIMEX3>   <TIMEX3 tid="t2" type="DATE" value="2017-03-07">March 07, 2017</TIMEX3>       Overview  --------  This is the fourth in a series of posts in which we're examining recent activity of the current top exploit kits.  An exploit kit (EK) is a rapidly deployable software package designed to leverage vulnerabilities in web browsers to deliver a malicious payload to a victim’s computer.  Authors of EKs offer their services for a fee, distributing malware for other malicious actors.  Notable changes have been observed this quarter in several EKs, including a limited return of Neutrino, a new KaiXin campaign, and changes to Sundown URL schemes.  You can find our previous roundup [here](/blogs/research/top-exploit-kit-activity-roundup-fall-2016).  RIG Exploit Kit  ---------------  Throughout <TIMEX3 tid="t3" type="DATE" value="2016">late 2016</TIMEX3> and <TIMEX3 tid="t4" type="DATE" value="2017">early 2017</TIMEX3>, RIG has remained the most active exploit kit, although overall activity has decreased in comparison to our previous review.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-0-1501493027.png)  *Figure 1: RIG hits, <TIMEX3 tid="t5" type="DATE" value="2016-12">December 2016</TIMEX3> – <TIMEX3 tid="t6" type="DATE" value="2017-02">February 2017</TIMEX3>*  Last fall, RIG took over as the primary distributor of CryptXXX ransomware, and became the EK of choice for the EITest and pseudoDarkleach campaigns, after the Neutrino EK was presumably shut down in <TIMEX3 tid="t7" type="DATE" value="2016-09">September 2016</TIMEX3>.  RIG continues to drop various ransomware payloads: CryptoShield, Cerber, Locky, and others.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-1-1501493027.png)  *Figure 2: RIG heat map*  We have seen new RIG gates and landing pages hosted in South America, Southeast Asia, and Australia.  Previously, RIG hosts were mainly limited to Western Europe, North America, and Russia.  These new hosts indicate an effort to increase the target demographics and potential victim pool worldwide for RIG-distributed ransomware.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-2-1501493028.png)  *Figure 3: RIG compromised site injection*  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-3-1501493028.png)  *Figure 4: RIG landing page*  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-4-1501493028.png)  *Figure 5: RIG gate fingerprinting script*  Some recent RIG gates have included a browser fingerprinting script.  This script supports the identification of several common browsers by version, but only redirects to a landing page if Internet Explorer is detected.  ~~BEPS, Xer, Sundown,~~ Nebula.  -------------------------------  The Sundown EK has been carving out a niche in the shadow of RIG for the last two years, but as we have noted before, the developers are putting continuous work into the kit to add (or steal) exploits.  Recently, authors have been making significant changes to the Sundown landing page patterns, apparently rebranding the EK as "Nebula.  Where .xyz domains had been the primary choice for hosting landing pages, since <TIMEX3 tid="t8" type="DATE" value="2017-02-09">February 9, 2017</TIMEX3>, the YBN has been registering domains with many other generic top-level domains (gTLDs) in the name of Brian Krebs.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-5-1501493029.png)  *Figure 6: Brian Krebs Fan Club registration*  In addition to changing the hostname patterns, the YBN has been changing URL path styles.  Initially dropping the "index.php" component of the path, some of the Nebula Sundown cycles we are seeing utilize randomized formats that attempt to appear like mundane traffic patterns.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-6-1501493029.png)  *Figure 7: Trouble getting the landing page with the new-style URLs from Nebula Sundown*  While the URL patterns have changed, the landing page used by the latest version of Sundown looks the same as landing pages seen from previous .xyz domains.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-7-1501493029.png)  *Figure 8: Nebula Sundown landing page*  As quickly as the Nebula Sundown strain gained attention, it seems to have dissipated, with typical Sundown cycles showing up once again since <TIMEX3 tid="t9" type="DATE" value="2017-03-06">March 6, 2017</TIMEX3>.  Sundown has primarily been dropping banker trojans, including the newly popular DiamondFox.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-8-1501493030.png)  *Figure 9: No more Nebula Sundown; back to classic Sundown URLs*  KaiXin Exploit Kit  ------------------  KaiXin is a smaller exploit kit first identified in <TIMEX3 tid="t10" type="DATE" value="2012">2012</TIMEX3>.  KaiXin typically targets Asian sites, and has been delivered via banner ads and JavaScript injection on compromised sites.  In our previous EK roundup, we discussed KaiXin’s swell in activity and updates to its exploit chain.  This KaiXin campaign tapered off after activity in early <TIMEX3 tid="t11" type="DATE" value="2016-12">December 2016</TIMEX3>.  At the end of <TIMEX3 tid="t12" type="DATE" value="2017-02">February</TIMEX3>, a new KaiXin campaign was observed reusing patterns from the summer of <TIMEX3 tid="t13" type="DATE" value="2016">2016</TIMEX3>.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-9-1501493030.png)  *Figure 10: KaiXin script injection*  This KaiXin campaign includes an older antivirus (AV) fingerprinting script that was absent in the fall CNZZ campaign.  This script attempts to detect the presence of several personal security products on the client filesystem before continuing execution.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-10-1501493030.png)  *Figure 11: Deobfuscated KaiXin AV fingerprinting script*  After the AV check passes, several layers of obfuscated scripts are loaded via iframes.  This campaign uses a browser cookie to prevent repeated access to the exploit, and tries to block web crawler bots that self-identify in their user agent string.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-11-1501493031.png)  *Figure 12: KaiXin cookie, crawler check*  The final script in the exploit kit chain performs browser and runtime version checks, and serves the appropriate exploit file.  Unlike the KaiXin campaign we analyzed in our last roundup, which performed browser fingerprinting on several browsers, this campaign only targets Internet Explorer.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-12-1501493031.png)  *Figure 13: Deobfuscated KaiXin exploit delivery script*  The *KaiXin*campaign offers exploits for Java, Flash, and Silverlight.  Separate Java JAR exploits are included for JRE versions 1.7.0.6-11, 1.7.0.0-1.7.0.7, and versions older than 1.6.0.27.  Two Flash exploits target versions 16,0,0,100-296 and 17,0,0,100-134, or Flash 11-15.  Silverlight 4.0.50401.0 to 5.1.10411.0 is targeted, excluding 5.0.60818.0.  The URL for the infection payload is not hardcoded in the exploit packages; instead, it is passed as a parameter (“ckurl” in the example above) to the embedded object.  Like previous KaiXin campaigns, successful exploitation delivers a downloader payload, which installs various Chinese adware packages.  The payloads in this campaign use the names of Windows system binaries, such as “csrss.exe,” “dwm.exe,” and “svchost.exe.  Malware Traffic Analysis recently [published](http://www.malware-traffic-analysis.net/2017/03/04/index.html) a capture of a similar infection cycle for the same campaign.  Neutrino Exploit Kit  --------------------  Propagation of the Neutrino EK abruptly shut down in <TIMEX3 tid="t14" type="DATE" value="2016-09">September 2016</TIMEX3>.  After several weeks, and then months, of no observed activity, security researchers considered Neutrino defunct.  The RIG EK took over Neutrino’s role as the primary distributor of CryptXXX ransomware.  A low-volume Neutrino variant dubbed Neutrino-v appeared in <TIMEX3 tid="t15" type="DATE" value="2016">late 2016</TIMEX3>, but was mainly confined to targets in South Korea and Taiwan.  In <TIMEX3 tid="t16" type="DATE" value="2017-01">January 2017</TIMEX3>, researchers began observing occasional hits of active Neutrino landing pages dropping ransomware payloads.  It appears that Neutrino has returned in a limited capacity, likely restricted to privately commissioned EKs.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-13-1501493031.png)  *Figure 14: Neutrino cycle featuring fake jquery gate and HTTPS redirector*  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-14-1501493032.png)  *Figure 15: Neutrino exploit chain*  We have observed a Neutrino campaign using a .space TLD gate.  The landing page, exploit, and payload URLs follow typical Neutrino patterns.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-15-1501493032.png)  *Figure 16: Neutrino script injection*  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-16-1501493033.png)  *Figure 17: Neutrino landing page*  This landing page in the .space gate campaign also keeps with the “space” theme, and displays a blurb about space and a dummy HTML form while serving the Flash exploit.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-17-1501493033.png)  *Figure 18: Neutrino landing page in browser*  Terror Exploit Kit  ------------------  The Terror EK is a newer exploit kit that appears to be cobbled together from pieces of Metasploit payloads as well as other EKs, most notably Sundown and Hunter.  It primarily relies on recent Sundown exploits and dropper payloads to install ccminer, a cryptocurrency mining program, on infected computers.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-18-1501493033.png)  *Figure 19: Recent Terror EK cycle*  We've continued tracking the development of this kit since we first spotted it, and have watched developers transition to new domains with stolen identities, with traffic coming from the PopAds advertising network.  The landing page is more sophisticated, but remains a patchwork of stolen exploits and obfuscation routines.  Magnitude Exploit Kit  ---------------------  The Magnitude EK continues to operate at low volume, with restricted regional distribution.  We typically observe Magnitude affecting Southeast Asian users who visit illegal streaming sites.  Malicious ads are distributed via ad networks such as PopAds, and vulnerable users are infected with Cerber.  ![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/downloads/blog-image-19-1501493034.png)  *Figure 20: Magnitude cycle coming from advertising rotators*  Conclusion  ----------  Exploit kits pose a significant threat to users during simple web browsing.  In the case of ransomware infections, the result could be the inability of users to access their files.  The techniques exploit kit authors use to hide their activities are frequently changing, and security researchers work hard to analyze and block these new threats.  To help avoid infections such as those delivered by way of exploit kits, users should always block untrusted third-party scripts and resources, and avoid clicking on suspicious advertisements.  The ThreatLabZ research team has confirmed coverage for these top exploit kits and subsequent payloads, ensuring protection for organizations using [Zscaler cloud-delivered Internet security](/products/security-as-a-service).  *Researched by Ed Miles and Derek Gooley*  
</TEXT>
</TimeML>