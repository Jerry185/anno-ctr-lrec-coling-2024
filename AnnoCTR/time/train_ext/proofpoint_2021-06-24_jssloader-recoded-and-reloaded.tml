<?xml version="1.0"?>
<TimeML xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://timeml.org/timeMLdocs/TimeML_1.2.1.xsd">
<DCT><TIMEX3 functionInDocument="CREATION_TIME" temporalFunction="false" tid="t0" type="DATE" value="2021-06-24">2021-06-24</TIMEX3></DCT>
<TEXT>
JSSLoader: Recoded and Reloaded    <TIMEX3 tid="t1" type="DATE" value="2021-06-24">June 24, 2021</TIMEX3>  ### Key Takeaways  * After a months-long absence, the malware loader JSSLoader returned in <TIMEX3 tid="t2" type="DATE" value="2021-06">June 2021</TIMEX3> campaigns rewritten from the .NET programming language to C++.  * Rewriting the [malware](https://www.proofpoint.com/us/threat-reference/malware) could be an effort by threat actors to evade current detections.  * Current TA543 campaigns delivering JSSLoader are using similar lures to those observed by Proofpoint researchers in <TIMEX3 tid="t3" type="DATE" value="2019">2019</TIMEX3> and the emails continue to contain links to a TDS landing page.  ### Overview  In <TIMEX3 tid="t4" type="DATE" value="2021-06">June 2021</TIMEX3>, Proofpoint researchers observed a new variant of the downloader JSSLoader in several campaigns impacting a variety of organizations.  This version of the malware loader was rewritten from .NET to the C++ programming language.  This change, while not unheard of, is not a common occurrence and could be an effort by the threat actors utilizing JSSLoader to evade current detections.  JSSLoader is often dropped in the first or second stage of a campaign and has the functionality to profile infected machines and load additional payloads.  The campaigns are ongoing and use similar lures to those initially observed by Proofpoint researchers in <TIMEX3 tid="t5" type="DATE" value="2019">2019</TIMEX3>.  According to our data, the recent campaigns have attempted to target as many as several hundred organizations at a time across a wide range of industries, including finance, manufacturing, technology, retail, healthcare, education, and transportation.  ### Malware Analysis  Proofpoint researchers initially observed [JSSLoader](https://malpedia.caad.fkie.fraunhofer.de/details/win.jssloader) in <TIMEX3 tid="t6" type="DATE" value="2019-09">September 2019</TIMEX3>.  It was written in .NET at the time and being actively developed.  Fast forward nearly two years and Proofpoint has now identified this latest variant of the malware loader written in C++.  It has much of the same functionality as previous iterations.  The following provides a more in-depth look at that early version and the changes the loader has undergone since <TIMEX3 tid="t7" type="DATE" value="2019">2019</TIMEX3>.  #### <TIMEX3 tid="t8" type="DATE" value="2019">2019</TIMEX3> Version of JSSLoader (.NET)  JSSLoader is an initial access malware that was written in .NET and was named after its “JSS” namespace and “jssAdmin” command and control (C&C) panel login page:   ![Graphical user interface, application, website  Description automatically generated](data:image;base64_removed,)   *Figure 1. JSSLoader C&C panel login page from <TIMEX3 tid="t9" type="DATE" value="2019-09-27">September 27, 2019</TIMEX3> version.*  Its C&C used HTTPS requests with base64-encoded data:   ![A picture containing text Description automatically generated](data:image;base64_removed,)   *Figure 2. Example C&C request from <TIMEX3 tid="t10" type="DATE" value="2019-09-27">September 27, 2019 </TIMEX3>version.*  The initial C&C beacon contained verbose system information:   ![Table Description automatically generated](data:image;base64_removed,)   *Figure 3. Example system information (trimmed for readability) from <TIMEX3 tid="t11" type="DATE" value="2019-09-27">September 27, 2019</TIMEX3> version.*  Its commands and functionality focused on executing a next stage executable or JavaScript:   ![Text Description automatically generated](data:image;base64_removed,)   *Figure 4. Commands from <TIMEX3 tid="t12" type="DATE" value="2019-09-27">September 27, 2019 </TIMEX3>version.*  #### <TIMEX3 tid="t13" type="DATE" value="2020">2020</TIMEX3>-<TIMEX3 tid="t14" type="DATE" value="2021">2021</TIMEX3> JSSLoader Changes (.NET)  Since the initial version of JSSLoader, there have been gradual changes and improvements to the malware in successive campaigns.  Morphisec wrote about some of these in a <TIMEX3 tid="t15" type="DATE" value="2021-01">January 2021</TIMEX3> paper titled “[Threat Profile the Evolution of the FIN7 JSSLoader (PDF)](https://www.morphisec.com/hubfs/eBooks_and_Whitepapers/FIN7%20JSSLOADER%20FINAL%20WEB.pdf).  Two of the most visible changes were a switch from the verbose system information to a JSON object and the addition of new commands.  For example, the JSSLoader used in a <TIMEX3 tid="t16" type="DATE" value="2020-12-14">December 14, 2020</TIMEX3> email-based campaign sent the following system information:   ![Text, letter Description automatically generated](data:image;base64_removed,)   *Figure 5. Example system information (formatted and trimmed for readability) from <TIMEX3 tid="t17" type="DATE" value="2020-12-14">December 14, 2020</TIMEX3> version.*  While the formatting changed, the beacon contained much of the same information as the original version.  In addition to the changes in the C&C protocol, several new commands were added.  The focus of the new commands was still on executing a next stage:   ![Text Description automatically generated](data:image;base64_removed,)   *Figure 6. Commands from <TIMEX3 tid="t18" type="DATE" value="2020-12-14">December 14, 2020</TIMEX3> version.*  After this <TIMEX3 tid="t19" type="DATE" value="2020-12">December 2020</TIMEX3> campaign, activity paused and the malware went through a redevelopment phase, according to Proofpoint’s visibility.  #### <TIMEX3 tid="t20" type="DATE" value="2021-06">June 2021</TIMEX3> JSSLoader (C++)  In <TIMEX3 tid="t21" type="DATE" value="2021-06">June 2021</TIMEX3>, email campaigns resumed, but the JSSLoader malware had been redeveloped from using the .NET programming language to C++ (this change was also [noticed on infosec Twitter](https://twitter.com/Arkbird_SOLG/status/1400845449515372555)).  It is not common for a malware to be redeveloped in a different programming language, but it does happen occasionally.  Proofpoint recently [documented](https://www.proofpoint.com/us/blog/threat-insight/new-variant-buer-loader-written-rust) another initial access malware known as “Buer Loader” that was redeveloped from the C programming language to Rust.  As noted in that blog post, rewriting a malware can enable threat actors to better evade existing detection capabilities.  The C++ version of JSSLoader analyzed here is from a <TIMEX3 tid="t22" type="DATE" value="2021-06-08">June 8, 2021</TIMEX3> email-based campaign.  It sets up “registry run” persistence using a value name of “AppJSSLoader” and has similar style of system information beacon as the later .NET versions:   ![Text, letter Description automatically generated](data:image;base64_removed,)   *Figure 7. Example system information (formatted and trimmed for readability) from <TIMEX3 tid="t23" type="DATE" value="2021-06-08">June 8, 2021 </TIMEX3>C++ version.*  The C++ version also has similar command functionality, though they switched from the “Cmd” prefix of the later .NET versions back to the “Task” prefix seen in the earlier .NET samples:   ![Graphical user interface Description automatically generated with medium confidence](data:image;base64_removed,)   *Figure 8. Commands from <TIMEX3 tid="t24" type="DATE" value="2021-06-08">June 8, 2021</TIMEX3> C++ version.*  C&C protocol and command similarity was likely a choice to remain backwards compatible with the existing .NET version’s C&C panel software.  ### Campaign Details  JSSLoader appears to be exclusive to several threat actors.  In fact, Proofpoint has only observed two actors using it since the first email campaign in <TIMEX3 tid="t25" type="DATE" value="2019">2019</TIMEX3>.  Most of the campaigns were attributed to the threat actor tracked by Proofpoint as TA543.  They are characterized by their widespread distribution with opportunistic targeting.  A typical campaign contains thousands of email messages and targets several hundred organizations.  The lures used by TA543 typically focus on invoices and delivery information of packages.  The following sections describe and compare the original campaigns observed by Proofpoint in <TIMEX3 tid="t26" type="DATE" value="2019">2019</TIMEX3> to the <TIMEX3 tid="t27" type="DATE" value="2021-06">June 2021</TIMEX3> campaigns.  #### <TIMEX3 tid="t28" type="DATE" value="2019-09">September 2019</TIMEX3> Campaign Example  On <TIMEX3 tid="t29" type="DATE" value="2019-09-27">September 27, 2019</TIMEX3> Proofpoint analysts observed a TA543 campaign spoofing Intuit branding.  The threat actor used a likely compromised account for an email marketing service to send the malicious emails that purported to be invoices and contained URLs linking to a landing page hosting BlackTDS. The TDS would direct the user to the download another file, a VBS downloader, hosted on SharePoint.  The VBS downloader would then download JSSLoader.  During our analysis of JSSLoader, it additionally loaded a Griffon payload which is historically associated with another actor, TA3546, also known as FIN7 or Carbanak.  In the following months Proofpoint analysts observed TA543 shift to primarily delivering JSSLoader and/or other loaders that were often observed downloading other TA3546-associated payloads.  ![Graphical user interface, application, Teams Description automatically generated](data:image;base64_removed,)   *Figure 9. TA543 email that leads to the download of JSSLoader.*  #### <TIMEX3 tid="t30" type="DATE" value="2021-06">June 2021</TIMEX3> Campaign Example  On <TIMEX3 tid="t31" type="DATE" value="2021-06-08">June 8, 2021</TIMEX3>, Proofpoint analysts observed a TA543 campaign spoofing UPS branding (Figure 10).  The email contained URLs linking to a Keitaro TDS landing.  In turn, the landing linked to the download of a Windows Scripting File (WSF) hosted on SharePoint.  If executed, it downloaded an intermediate script, which then downloaded and executed the C++ version of JSSLoader.  ![Graphical user interface, application Description automatically generated](data:image;base64_removed,)   *Figure 10. TA543 email sample from <TIMEX3 tid="t32" type="DATE" value="2021-06-08">June 8, 2021</TIMEX3>, that leads to the download of JSSLoader.*  ### Conclusion  The threat actors behind JSSLoader have continuously made modifications since its debut in <TIMEX3 tid="t33" type="DATE" value="2019">2019</TIMEX3> and are likely to continue doing so using the <TIMEX3 tid="t34" type="DATE" value="2021">2021</TIMEX3> variant.  With the redevelopment of the malware into C++, which was possibly done to evade current detections and make analysis more difficult, Proofpoint researchers have not seen the .NET version in play.  Instead, researchers anticipate seeing small refinements being made to the <TIMEX3 tid="t35" type="DATE" value="2021">2021</TIMEX3> version in future campaigns, keeping in line with the evolution of the .NET version over the past two years.  **Indicators of Compromise**  | **Indicator** | **Type** | **Notes** |  | dd86898c784342fc11c42bea4c815cb536455ee709e7522fb64622d9171c465d  | SHA256  | <TIMEX3 tid="t36" type="DATE" value="2019-09-27">September 27, 2019</TIMEX3> JSSLoader Sample  |  | bikweb\.com  | Hostname  | <TIMEX3 tid="t37" type="DATE" value="2019-09-27">September 27, 2019</TIMEX3> JSSLoader C&C  |  | a062a71a6268af048e474c80133f84494d06a34573c491725599fe62b25be044  | SHA256  | <TIMEX3 tid="t38" type="DATE" value="2020-12-14">December 14, 2020</TIMEX3> JSSLoader sample  |  | monusorge\.com  | Hostname  | <TIMEX3 tid="t39" type="DATE" value="2020-12-14">December 14, 2020</TIMEX3> JSSLoader C&C  |  | 7a17ef218eebfdd4d3e70add616adcd5b78105becd6616c88b79b261d1a78fdf  | SHA256  | <TIMEX3 tid="t40" type="DATE" value="2021-06-08">June 8, 2021</TIMEX3> JSSLoader Sample  |  | injuryless\.com  | Hostname  | <TIMEX3 tid="t41" type="DATE" value="2021-06-08">June 8, 2021</TIMEX3> JSSLoader C&C  |  **ET Signatures**  2033072 - ET TROJAN FIN7 JSSLoader Variant Activity (POST)    2033074 - ET TROJAN FIN7 JSSLoader Variant Activity (GET)    2838606 - ETPRO TROJAN Win32/jssLoader CnC Activity    2838607 - ETPRO TROJAN Win32/jssLoader CnC Checkin    2842028 - ETPRO TROJAN JSSLoader CnC Host Checkin    
</TEXT>
</TimeML>